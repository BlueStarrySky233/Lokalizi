(function(_l,$o){typeof exports=="object"&&typeof module<"u"?module.exports=$o():typeof define=="function"&&define.amd?define($o):(_l=typeof globalThis<"u"?globalThis:_l||self,_l.StreetViewVN_Viewer=$o())})(this,function(){"use strict";var Dae=Object.defineProperty;var Oae=(_l,$o,Om)=>$o in _l?Dae(_l,$o,{enumerable:!0,configurable:!0,writable:!0,value:Om}):_l[$o]=Om;var yn=(_l,$o,Om)=>Oae(_l,typeof $o!="symbol"?$o+"":$o,Om);function _l(t,e){for(var n=0;n<e.length;n++){const i=e[n];if(typeof i!="string"&&!Array.isArray(i)){for(const r in i)if(r!=="default"&&!(r in t)){const a=Object.getOwnPropertyDescriptor(i,r);a&&Object.defineProperty(t,r,a.get?a:{enumerable:!0,get:()=>i[r]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}/**
 * @license
 * Copyright 2010-2024 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const $o="167",Om=0,dL=1,A9=2,fL=1,P9=2,Gu=3,ed=0,ua=1,Wu=2,td=0,Fm=1,pL=2,mL=3,gL=4,I9=5,qf=100,R9=101,L9=102,k9=103,D9=104,O9=200,F9=201,z9=202,N9=203,YE=204,KE=205,B9=206,U9=207,V9=208,$9=209,H9=210,G9=211,W9=212,j9=213,q9=214,X9=0,Z9=1,Y9=2,s1=3,K9=4,J9=5,Q9=6,eV=7,vL=0,tV=1,nV=2,nd=0,iV=1,rV=2,sV=3,oV=4,aV=5,lV=6,cV=7,yL=300,zm=301,Nm=302,JE=303,QE=304,o1=306,eM=1e3,Xf=1001,tM=1002,xl=1003,uV=1004,a1=1005,bl=1006,nM=1007,id=1008,ju=1009,_L=1010,xL=1011,K0=1012,iM=1013,Zf=1014,qu=1015,J0=1016,rM=1017,sM=1018,Bm=1020,bL=35902,wL=1021,SL=1022,tc=1023,EL=1024,ML=1025,Um=1026,Vm=1027,CL=1028,oM=1029,TL=1030,aM=1031,lM=1033,l1=33776,c1=33777,u1=33778,h1=33779,cM=35840,uM=35841,hM=35842,dM=35843,fM=36196,pM=37492,mM=37496,gM=37808,vM=37809,yM=37810,_M=37811,xM=37812,bM=37813,wM=37814,SM=37815,EM=37816,MM=37817,CM=37818,TM=37819,AM=37820,PM=37821,d1=36492,IM=36494,RM=36495,AL=36283,LM=36284,kM=36285,DM=36286,hV=3200,dV=3201,fV=0,pV=1,rd="",jc="srgb",Xu="srgb-linear",OM="display-p3",f1="display-p3-linear",p1="linear",Mr="srgb",m1="rec709",g1="p3",$m=7680,PL=519,mV=512,gV=513,vV=514,IL=515,yV=516,_V=517,xV=518,bV=519,RL=35044,LL="300 es",Zu=2e3,v1=2001;let Hm=class{addEventListener(e,n){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(n)===-1&&i[e].push(n)}hasEventListener(e,n){if(this._listeners===void 0)return!1;const i=this._listeners;return i[e]!==void 0&&i[e].indexOf(n)!==-1}removeEventListener(e,n){if(this._listeners===void 0)return;const r=this._listeners[e];if(r!==void 0){const a=r.indexOf(n);a!==-1&&r.splice(a,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const i=this._listeners[e.type];if(i!==void 0){e.target=this;const r=i.slice(0);for(let a=0,u=r.length;a<u;a++)r[a].call(this,e);e.target=null}}};const So=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let kL=1234567;const Q0=Math.PI/180,ey=180/Math.PI;function Gm(){const t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,n=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(So[t&255]+So[t>>8&255]+So[t>>16&255]+So[t>>24&255]+"-"+So[e&255]+So[e>>8&255]+"-"+So[e>>16&15|64]+So[e>>24&255]+"-"+So[n&63|128]+So[n>>8&255]+"-"+So[n>>16&255]+So[n>>24&255]+So[i&255]+So[i>>8&255]+So[i>>16&255]+So[i>>24&255]).toLowerCase()}function io(t,e,n){return Math.max(e,Math.min(n,t))}function FM(t,e){return(t%e+e)%e}function wV(t,e,n,i,r){return i+(t-e)*(r-i)/(n-e)}function SV(t,e,n){return t!==e?(n-t)/(e-t):0}function ty(t,e,n){return(1-n)*t+n*e}function EV(t,e,n,i){return ty(t,e,1-Math.exp(-n*i))}function MV(t,e=1){return e-Math.abs(FM(t,e*2)-e)}function CV(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*(3-2*t))}function TV(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*t*(t*(t*6-15)+10))}function AV(t,e){return t+Math.floor(Math.random()*(e-t+1))}function PV(t,e){return t+Math.random()*(e-t)}function IV(t){return t*(.5-Math.random())}function RV(t){t!==void 0&&(kL=t);let e=kL+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function LV(t){return t*Q0}function kV(t){return t*ey}function DV(t){return(t&t-1)===0&&t!==0}function OV(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function FV(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}function zV(t,e,n,i,r){const a=Math.cos,u=Math.sin,l=a(n/2),f=u(n/2),g=a((e+i)/2),y=u((e+i)/2),S=a((e-i)/2),b=u((e-i)/2),A=a((i-e)/2),I=u((i-e)/2);switch(r){case"XYX":t.set(l*y,f*S,f*b,l*g);break;case"YZY":t.set(f*b,l*y,f*S,l*g);break;case"ZXZ":t.set(f*S,f*b,l*y,l*g);break;case"XZX":t.set(l*y,f*I,f*A,l*g);break;case"YXY":t.set(f*A,l*y,f*I,l*g);break;case"ZYZ":t.set(f*I,f*A,l*y,l*g);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function Wm(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return t/4294967295;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int32Array:return Math.max(t/2147483647,-1);case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}function Ho(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return Math.round(t*4294967295);case Uint16Array:return Math.round(t*65535);case Uint8Array:return Math.round(t*255);case Int32Array:return Math.round(t*2147483647);case Int16Array:return Math.round(t*32767);case Int8Array:return Math.round(t*127);default:throw new Error("Invalid component type.")}}const Yr={DEG2RAD:Q0,RAD2DEG:ey,generateUUID:Gm,clamp:io,euclideanModulo:FM,mapLinear:wV,inverseLerp:SV,lerp:ty,damp:EV,pingpong:MV,smoothstep:CV,smootherstep:TV,randInt:AV,randFloat:PV,randFloatSpread:IV,seededRandom:RV,degToRad:LV,radToDeg:kV,isPowerOfTwo:DV,ceilPowerOfTwo:OV,floorPowerOfTwo:FV,setQuaternionFromProperEuler:zV,normalize:Ho,denormalize:Wm};let Ui=class $8{constructor(e=0,n=0){$8.prototype.isVector2=!0,this.x=e,this.y=n}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,n){return this.x=e,this.y=n,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const n=this.x,i=this.y,r=e.elements;return this.x=r[0]*n+r[3]*i+r[6],this.y=r[1]*n+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(n,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const i=this.dot(e)/n;return Math.acos(io(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,i=this.y-e.y;return n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this}rotateAround(e,n){const i=Math.cos(n),r=Math.sin(n),a=this.x-e.x,u=this.y-e.y;return this.x=a*i-u*r+e.x,this.y=a*r+u*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},Si=class H8{constructor(e,n,i,r,a,u,l,f,g){H8.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,n,i,r,a,u,l,f,g)}set(e,n,i,r,a,u,l,f,g){const y=this.elements;return y[0]=e,y[1]=r,y[2]=l,y[3]=n,y[4]=a,y[5]=f,y[6]=i,y[7]=u,y[8]=g,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const n=this.elements,i=e.elements;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],this}extractBasis(e,n,i){return e.setFromMatrix3Column(this,0),n.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const n=e.elements;return this.set(n[0],n[4],n[8],n[1],n[5],n[9],n[2],n[6],n[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const i=e.elements,r=n.elements,a=this.elements,u=i[0],l=i[3],f=i[6],g=i[1],y=i[4],S=i[7],b=i[2],A=i[5],I=i[8],D=r[0],L=r[3],P=r[6],N=r[1],B=r[4],$=r[7],K=r[2],q=r[5],W=r[8];return a[0]=u*D+l*N+f*K,a[3]=u*L+l*B+f*q,a[6]=u*P+l*$+f*W,a[1]=g*D+y*N+S*K,a[4]=g*L+y*B+S*q,a[7]=g*P+y*$+S*W,a[2]=b*D+A*N+I*K,a[5]=b*L+A*B+I*q,a[8]=b*P+A*$+I*W,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=e,n[4]*=e,n[7]*=e,n[2]*=e,n[5]*=e,n[8]*=e,this}determinant(){const e=this.elements,n=e[0],i=e[1],r=e[2],a=e[3],u=e[4],l=e[5],f=e[6],g=e[7],y=e[8];return n*u*y-n*l*g-i*a*y+i*l*f+r*a*g-r*u*f}invert(){const e=this.elements,n=e[0],i=e[1],r=e[2],a=e[3],u=e[4],l=e[5],f=e[6],g=e[7],y=e[8],S=y*u-l*g,b=l*f-y*a,A=g*a-u*f,I=n*S+i*b+r*A;if(I===0)return this.set(0,0,0,0,0,0,0,0,0);const D=1/I;return e[0]=S*D,e[1]=(r*g-y*i)*D,e[2]=(l*i-r*u)*D,e[3]=b*D,e[4]=(y*n-r*f)*D,e[5]=(r*a-l*n)*D,e[6]=A*D,e[7]=(i*f-g*n)*D,e[8]=(u*n-i*a)*D,this}transpose(){let e;const n=this.elements;return e=n[1],n[1]=n[3],n[3]=e,e=n[2],n[2]=n[6],n[6]=e,e=n[5],n[5]=n[7],n[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const n=this.elements;return e[0]=n[0],e[1]=n[3],e[2]=n[6],e[3]=n[1],e[4]=n[4],e[5]=n[7],e[6]=n[2],e[7]=n[5],e[8]=n[8],this}setUvTransform(e,n,i,r,a,u,l){const f=Math.cos(a),g=Math.sin(a);return this.set(i*f,i*g,-i*(f*u+g*l)+u+e,-r*g,r*f,-r*(-g*u+f*l)+l+n,0,0,1),this}scale(e,n){return this.premultiply(zM.makeScale(e,n)),this}rotate(e){return this.premultiply(zM.makeRotation(-e)),this}translate(e,n){return this.premultiply(zM.makeTranslation(e,n)),this}makeTranslation(e,n){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,n,0,0,1),this}makeRotation(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,-i,0,i,n,0,0,0,1),this}makeScale(e,n){return this.set(e,0,0,0,n,0,0,0,1),this}equals(e){const n=this.elements,i=e.elements;for(let r=0;r<9;r++)if(n[r]!==i[r])return!1;return!0}fromArray(e,n=0){for(let i=0;i<9;i++)this.elements[i]=e[i+n];return this}toArray(e=[],n=0){const i=this.elements;return e[n]=i[0],e[n+1]=i[1],e[n+2]=i[2],e[n+3]=i[3],e[n+4]=i[4],e[n+5]=i[5],e[n+6]=i[6],e[n+7]=i[7],e[n+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}};const zM=new Si;function DL(t){for(let e=t.length-1;e>=0;--e)if(t[e]>=65535)return!0;return!1}function y1(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}function NV(){const t=y1("canvas");return t.style.display="block",t}const OL={};function ny(t){t in OL||(OL[t]=!0,console.warn(t))}function BV(t,e,n){return new Promise(function(i,r){function a(){switch(t.clientWaitSync(e,t.SYNC_FLUSH_COMMANDS_BIT,0)){case t.WAIT_FAILED:r();break;case t.TIMEOUT_EXPIRED:setTimeout(a,n);break;default:i()}}setTimeout(a,n)})}const FL=new Si().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),zL=new Si().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),iy={[Xu]:{transfer:p1,primaries:m1,luminanceCoefficients:[.2126,.7152,.0722],toReference:t=>t,fromReference:t=>t},[jc]:{transfer:Mr,primaries:m1,luminanceCoefficients:[.2126,.7152,.0722],toReference:t=>t.convertSRGBToLinear(),fromReference:t=>t.convertLinearToSRGB()},[f1]:{transfer:p1,primaries:g1,luminanceCoefficients:[.2289,.6917,.0793],toReference:t=>t.applyMatrix3(zL),fromReference:t=>t.applyMatrix3(FL)},[OM]:{transfer:Mr,primaries:g1,luminanceCoefficients:[.2289,.6917,.0793],toReference:t=>t.convertSRGBToLinear().applyMatrix3(zL),fromReference:t=>t.applyMatrix3(FL).convertLinearToSRGB()}},UV=new Set([Xu,f1]),Ki={enabled:!0,_workingColorSpace:Xu,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(t){if(!UV.has(t))throw new Error(`Unsupported working color space, "${t}".`);this._workingColorSpace=t},convert:function(t,e,n){if(this.enabled===!1||e===n||!e||!n)return t;const i=iy[e].toReference,r=iy[n].fromReference;return r(i(t))},fromWorkingColorSpace:function(t,e){return this.convert(t,this._workingColorSpace,e)},toWorkingColorSpace:function(t,e){return this.convert(t,e,this._workingColorSpace)},getPrimaries:function(t){return iy[t].primaries},getTransfer:function(t){return t===rd?p1:iy[t].transfer},getLuminanceCoefficients:function(t,e=this._workingColorSpace){return t.fromArray(iy[e].luminanceCoefficients)}};function jm(t){return t<.04045?t*.0773993808:Math.pow(t*.9478672986+.0521327014,2.4)}function NM(t){return t<.0031308?t*12.92:1.055*Math.pow(t,.41666)-.055}let qm,VV=class{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let n;if(e instanceof HTMLCanvasElement)n=e;else{qm===void 0&&(qm=y1("canvas")),qm.width=e.width,qm.height=e.height;const i=qm.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),n=qm}return n.width>2048||n.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),n.toDataURL("image/jpeg",.6)):n.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const n=y1("canvas");n.width=e.width,n.height=e.height;const i=n.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),a=r.data;for(let u=0;u<a.length;u++)a[u]=jm(a[u]/255)*255;return i.putImageData(r,0,0),n}else if(e.data){const n=e.data.slice(0);for(let i=0;i<n.length;i++)n instanceof Uint8Array||n instanceof Uint8ClampedArray?n[i]=Math.floor(jm(n[i]/255)*255):n[i]=jm(n[i]);return{data:n,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}},$V=0,NL=class{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:$V++}),this.uuid=Gm(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(r!==null){let a;if(Array.isArray(r)){a=[];for(let u=0,l=r.length;u<l;u++)r[u].isDataTexture?a.push(BM(r[u].image)):a.push(BM(r[u]))}else a=BM(r);i.url=a}return n||(e.images[this.uuid]=i),i}};function BM(t){return typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap?VV.getDataURL(t):t.data?{data:Array.from(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let HV=0,nc=class XE extends Hm{constructor(e=XE.DEFAULT_IMAGE,n=XE.DEFAULT_MAPPING,i=Xf,r=Xf,a=bl,u=id,l=tc,f=ju,g=XE.DEFAULT_ANISOTROPY,y=rd){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:HV++}),this.uuid=Gm(),this.name="",this.source=new NL(e),this.mipmaps=[],this.mapping=n,this.channel=0,this.wrapS=i,this.wrapT=r,this.magFilter=a,this.minFilter=u,this.anisotropy=g,this.format=l,this.internalFormat=null,this.type=f,this.offset=new Ui(0,0),this.repeat=new Ui(1,1),this.center=new Ui(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Si,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=y,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const i={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),n||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==yL)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case eM:e.x=e.x-Math.floor(e.x);break;case Xf:e.x=e.x<0?0:1;break;case tM:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case eM:e.y=e.y-Math.floor(e.y);break;case Xf:e.y=e.y<0?0:1;break;case tM:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}};nc.DEFAULT_IMAGE=null,nc.DEFAULT_MAPPING=yL,nc.DEFAULT_ANISOTROPY=1;class Us{constructor(e=0,n=0,i=0,r=1){Us.prototype.isVector4=!0,this.x=e,this.y=n,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,n,i,r){return this.x=e,this.y=n,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;case 3:this.w=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this.w=e.w+n.w,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this.w+=e.w*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this.w=e.w-n.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const n=this.x,i=this.y,r=this.z,a=this.w,u=e.elements;return this.x=u[0]*n+u[4]*i+u[8]*r+u[12]*a,this.y=u[1]*n+u[5]*i+u[9]*r+u[13]*a,this.z=u[2]*n+u[6]*i+u[10]*r+u[14]*a,this.w=u[3]*n+u[7]*i+u[11]*r+u[15]*a,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const n=Math.sqrt(1-e.w*e.w);return n<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/n,this.y=e.y/n,this.z=e.z/n),this}setAxisAngleFromRotationMatrix(e){let n,i,r,a;const f=e.elements,g=f[0],y=f[4],S=f[8],b=f[1],A=f[5],I=f[9],D=f[2],L=f[6],P=f[10];if(Math.abs(y-b)<.01&&Math.abs(S-D)<.01&&Math.abs(I-L)<.01){if(Math.abs(y+b)<.1&&Math.abs(S+D)<.1&&Math.abs(I+L)<.1&&Math.abs(g+A+P-3)<.1)return this.set(1,0,0,0),this;n=Math.PI;const B=(g+1)/2,$=(A+1)/2,K=(P+1)/2,q=(y+b)/4,W=(S+D)/4,ie=(I+L)/4;return B>$&&B>K?B<.01?(i=0,r=.707106781,a=.707106781):(i=Math.sqrt(B),r=q/i,a=W/i):$>K?$<.01?(i=.707106781,r=0,a=.707106781):(r=Math.sqrt($),i=q/r,a=ie/r):K<.01?(i=.707106781,r=.707106781,a=0):(a=Math.sqrt(K),i=W/a,r=ie/a),this.set(i,r,a,n),this}let N=Math.sqrt((L-I)*(L-I)+(S-D)*(S-D)+(b-y)*(b-y));return Math.abs(N)<.001&&(N=1),this.x=(L-I)/N,this.y=(S-D)/N,this.z=(b-y)/N,this.w=Math.acos((g+A+P-1)/2),this}setFromMatrixPosition(e){const n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this.w=n[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this.z=Math.max(e.z,Math.min(n.z,this.z)),this.w=Math.max(e.w,Math.min(n.w,this.w)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this.z=Math.max(e,Math.min(n,this.z)),this.w=Math.max(e,Math.min(n,this.w)),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(n,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this.w+=(e.w-this.w)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this.z=e.z+(n.z-e.z)*i,this.w=e.w+(n.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this.w=e[n+3],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e[n+3]=this.w,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this.w=e.getW(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class GV extends Hm{constructor(e=1,n=1,i={}){super(),this.isRenderTarget=!0,this.width=e,this.height=n,this.depth=1,this.scissor=new Us(0,0,e,n),this.scissorTest=!1,this.viewport=new Us(0,0,e,n);const r={width:e,height:n,depth:1};i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:bl,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},i);const a=new nc(r,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace);a.flipY=!1,a.generateMipmaps=i.generateMipmaps,a.internalFormat=i.internalFormat,this.textures=[];const u=i.count;for(let l=0;l<u;l++)this.textures[l]=a.clone(),this.textures[l].isRenderTargetTexture=!0;this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.resolveDepthBuffer=i.resolveDepthBuffer,this.resolveStencilBuffer=i.resolveStencilBuffer,this.depthTexture=i.depthTexture,this.samples=i.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}setSize(e,n,i=1){if(this.width!==e||this.height!==n||this.depth!==i){this.width=e,this.height=n,this.depth=i;for(let r=0,a=this.textures.length;r<a;r++)this.textures[r].image.width=e,this.textures[r].image.height=n,this.textures[r].image.depth=i;this.dispose()}this.viewport.set(0,0,e,n),this.scissor.set(0,0,e,n)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let i=0,r=e.textures.length;i<r;i++)this.textures[i]=e.textures[i].clone(),this.textures[i].isRenderTargetTexture=!0;const n=Object.assign({},e.texture.image);return this.texture.source=new NL(n),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class sd extends GV{constructor(e=1,n=1,i={}){super(e,n,i),this.isWebGLRenderTarget=!0}}class BL extends nc{constructor(e=null,n=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:n,height:i,depth:r},this.magFilter=xl,this.minFilter=xl,this.wrapR=Xf,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class WV extends nc{constructor(e=null,n=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:n,height:i,depth:r},this.magFilter=xl,this.minFilter=xl,this.wrapR=Xf,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}let Xm=class{constructor(e=0,n=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=n,this._z=i,this._w=r}static slerpFlat(e,n,i,r,a,u,l){let f=i[r+0],g=i[r+1],y=i[r+2],S=i[r+3];const b=a[u+0],A=a[u+1],I=a[u+2],D=a[u+3];if(l===0){e[n+0]=f,e[n+1]=g,e[n+2]=y,e[n+3]=S;return}if(l===1){e[n+0]=b,e[n+1]=A,e[n+2]=I,e[n+3]=D;return}if(S!==D||f!==b||g!==A||y!==I){let L=1-l;const P=f*b+g*A+y*I+S*D,N=P>=0?1:-1,B=1-P*P;if(B>Number.EPSILON){const K=Math.sqrt(B),q=Math.atan2(K,P*N);L=Math.sin(L*q)/K,l=Math.sin(l*q)/K}const $=l*N;if(f=f*L+b*$,g=g*L+A*$,y=y*L+I*$,S=S*L+D*$,L===1-l){const K=1/Math.sqrt(f*f+g*g+y*y+S*S);f*=K,g*=K,y*=K,S*=K}}e[n]=f,e[n+1]=g,e[n+2]=y,e[n+3]=S}static multiplyQuaternionsFlat(e,n,i,r,a,u){const l=i[r],f=i[r+1],g=i[r+2],y=i[r+3],S=a[u],b=a[u+1],A=a[u+2],I=a[u+3];return e[n]=l*I+y*S+f*A-g*b,e[n+1]=f*I+y*b+g*S-l*A,e[n+2]=g*I+y*A+l*b-f*S,e[n+3]=y*I-l*S-f*b-g*A,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,n,i,r){return this._x=e,this._y=n,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,n=!0){const i=e._x,r=e._y,a=e._z,u=e._order,l=Math.cos,f=Math.sin,g=l(i/2),y=l(r/2),S=l(a/2),b=f(i/2),A=f(r/2),I=f(a/2);switch(u){case"XYZ":this._x=b*y*S+g*A*I,this._y=g*A*S-b*y*I,this._z=g*y*I+b*A*S,this._w=g*y*S-b*A*I;break;case"YXZ":this._x=b*y*S+g*A*I,this._y=g*A*S-b*y*I,this._z=g*y*I-b*A*S,this._w=g*y*S+b*A*I;break;case"ZXY":this._x=b*y*S-g*A*I,this._y=g*A*S+b*y*I,this._z=g*y*I+b*A*S,this._w=g*y*S-b*A*I;break;case"ZYX":this._x=b*y*S-g*A*I,this._y=g*A*S+b*y*I,this._z=g*y*I-b*A*S,this._w=g*y*S+b*A*I;break;case"YZX":this._x=b*y*S+g*A*I,this._y=g*A*S+b*y*I,this._z=g*y*I-b*A*S,this._w=g*y*S-b*A*I;break;case"XZY":this._x=b*y*S-g*A*I,this._y=g*A*S-b*y*I,this._z=g*y*I+b*A*S,this._w=g*y*S+b*A*I;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+u)}return n===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,n){const i=n/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const n=e.elements,i=n[0],r=n[4],a=n[8],u=n[1],l=n[5],f=n[9],g=n[2],y=n[6],S=n[10],b=i+l+S;if(b>0){const A=.5/Math.sqrt(b+1);this._w=.25/A,this._x=(y-f)*A,this._y=(a-g)*A,this._z=(u-r)*A}else if(i>l&&i>S){const A=2*Math.sqrt(1+i-l-S);this._w=(y-f)/A,this._x=.25*A,this._y=(r+u)/A,this._z=(a+g)/A}else if(l>S){const A=2*Math.sqrt(1+l-i-S);this._w=(a-g)/A,this._x=(r+u)/A,this._y=.25*A,this._z=(f+y)/A}else{const A=2*Math.sqrt(1+S-i-l);this._w=(u-r)/A,this._x=(a+g)/A,this._y=(f+y)/A,this._z=.25*A}return this._onChangeCallback(),this}setFromUnitVectors(e,n){let i=e.dot(n)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*n.z-e.z*n.y,this._y=e.z*n.x-e.x*n.z,this._z=e.x*n.y-e.y*n.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(io(this.dot(e),-1,1)))}rotateTowards(e,n){const i=this.angleTo(e);if(i===0)return this;const r=Math.min(1,n/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,n){const i=e._x,r=e._y,a=e._z,u=e._w,l=n._x,f=n._y,g=n._z,y=n._w;return this._x=i*y+u*l+r*g-a*f,this._y=r*y+u*f+a*l-i*g,this._z=a*y+u*g+i*f-r*l,this._w=u*y-i*l-r*f-a*g,this._onChangeCallback(),this}slerp(e,n){if(n===0)return this;if(n===1)return this.copy(e);const i=this._x,r=this._y,a=this._z,u=this._w;let l=u*e._w+i*e._x+r*e._y+a*e._z;if(l<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,l=-l):this.copy(e),l>=1)return this._w=u,this._x=i,this._y=r,this._z=a,this;const f=1-l*l;if(f<=Number.EPSILON){const A=1-n;return this._w=A*u+n*this._w,this._x=A*i+n*this._x,this._y=A*r+n*this._y,this._z=A*a+n*this._z,this.normalize(),this}const g=Math.sqrt(f),y=Math.atan2(g,l),S=Math.sin((1-n)*y)/g,b=Math.sin(n*y)/g;return this._w=u*S+this._w*b,this._x=i*S+this._x*b,this._y=r*S+this._y*b,this._z=a*S+this._z*b,this._onChangeCallback(),this}slerpQuaternions(e,n,i){return this.copy(e).slerp(n,i)}random(){const e=2*Math.PI*Math.random(),n=2*Math.PI*Math.random(),i=Math.random(),r=Math.sqrt(1-i),a=Math.sqrt(i);return this.set(r*Math.sin(e),r*Math.cos(e),a*Math.sin(n),a*Math.cos(n))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,n=0){return this._x=e[n],this._y=e[n+1],this._z=e[n+2],this._w=e[n+3],this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._w,e}fromBufferAttribute(e,n){return this._x=e.getX(n),this._y=e.getY(n),this._z=e.getZ(n),this._w=e.getW(n),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},pt=class G8{constructor(e=0,n=0,i=0){G8.prototype.isVector3=!0,this.x=e,this.y=n,this.z=i}set(e,n,i){return i===void 0&&(i=this.z),this.x=e,this.y=n,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,n){return this.x=e.x*n.x,this.y=e.y*n.y,this.z=e.z*n.z,this}applyEuler(e){return this.applyQuaternion(UL.setFromEuler(e))}applyAxisAngle(e,n){return this.applyQuaternion(UL.setFromAxisAngle(e,n))}applyMatrix3(e){const n=this.x,i=this.y,r=this.z,a=e.elements;return this.x=a[0]*n+a[3]*i+a[6]*r,this.y=a[1]*n+a[4]*i+a[7]*r,this.z=a[2]*n+a[5]*i+a[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const n=this.x,i=this.y,r=this.z,a=e.elements,u=1/(a[3]*n+a[7]*i+a[11]*r+a[15]);return this.x=(a[0]*n+a[4]*i+a[8]*r+a[12])*u,this.y=(a[1]*n+a[5]*i+a[9]*r+a[13])*u,this.z=(a[2]*n+a[6]*i+a[10]*r+a[14])*u,this}applyQuaternion(e){const n=this.x,i=this.y,r=this.z,a=e.x,u=e.y,l=e.z,f=e.w,g=2*(u*r-l*i),y=2*(l*n-a*r),S=2*(a*i-u*n);return this.x=n+f*g+u*S-l*y,this.y=i+f*y+l*g-a*S,this.z=r+f*S+a*y-u*g,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const n=this.x,i=this.y,r=this.z,a=e.elements;return this.x=a[0]*n+a[4]*i+a[8]*r,this.y=a[1]*n+a[5]*i+a[9]*r,this.z=a[2]*n+a[6]*i+a[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this.z=Math.max(e.z,Math.min(n.z,this.z)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this.z=Math.max(e,Math.min(n,this.z)),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(n,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this.z=e.z+(n.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,n){const i=e.x,r=e.y,a=e.z,u=n.x,l=n.y,f=n.z;return this.x=r*f-a*l,this.y=a*u-i*f,this.z=i*l-r*u,this}projectOnVector(e){const n=e.lengthSq();if(n===0)return this.set(0,0,0);const i=e.dot(this)/n;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return UM.copy(this).projectOnVector(e),this.sub(UM)}reflect(e){return this.sub(UM.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const i=this.dot(e)/n;return Math.acos(io(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return n*n+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,n,i){const r=Math.sin(n)*e;return this.x=r*Math.sin(i),this.y=Math.cos(n)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,n,i){return this.x=e*Math.sin(n),this.y=i,this.z=e*Math.cos(n),this}setFromMatrixPosition(e){const n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this}setFromMatrixScale(e){const n=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=n,this.y=i,this.z=r,this}setFromMatrixColumn(e,n){return this.fromArray(e.elements,n*4)}setFromMatrix3Column(e,n){return this.fromArray(e.elements,n*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,n=Math.random()*2-1,i=Math.sqrt(1-n*n);return this.x=i*Math.cos(e),this.y=n,this.z=i*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}};const UM=new pt,UL=new Xm;let Zm=class{constructor(e=new pt(1/0,1/0,1/0),n=new pt(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromArray(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n+=3)this.expandByPoint(ic.fromArray(e,n));return this}setFromBufferAttribute(e){this.makeEmpty();for(let n=0,i=e.count;n<i;n++)this.expandByPoint(ic.fromBufferAttribute(e,n));return this}setFromPoints(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){const i=ic.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,n=!1){return this.makeEmpty(),this.expandByObject(e,n)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,n=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(i!==void 0){const a=i.getAttribute("position");if(n===!0&&a!==void 0&&e.isInstancedMesh!==!0)for(let u=0,l=a.count;u<l;u++)e.isMesh===!0?e.getVertexPosition(u,ic):ic.fromBufferAttribute(a,u),ic.applyMatrix4(e.matrixWorld),this.expandByPoint(ic);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),_1.copy(e.boundingBox)):(i.boundingBox===null&&i.computeBoundingBox(),_1.copy(i.boundingBox)),_1.applyMatrix4(e.matrixWorld),this.union(_1)}const r=e.children;for(let a=0,u=r.length;a<u;a++)this.expandByObject(r[a],n);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,ic),ic.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let n,i;return e.normal.x>0?(n=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(n=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(n+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(n+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(n+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(n+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),n<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(ry),x1.subVectors(this.max,ry),Ym.subVectors(e.a,ry),Km.subVectors(e.b,ry),Jm.subVectors(e.c,ry),od.subVectors(Km,Ym),ad.subVectors(Jm,Km),Yf.subVectors(Ym,Jm);let n=[0,-od.z,od.y,0,-ad.z,ad.y,0,-Yf.z,Yf.y,od.z,0,-od.x,ad.z,0,-ad.x,Yf.z,0,-Yf.x,-od.y,od.x,0,-ad.y,ad.x,0,-Yf.y,Yf.x,0];return!VM(n,Ym,Km,Jm,x1)||(n=[1,0,0,0,1,0,0,0,1],!VM(n,Ym,Km,Jm,x1))?!1:(b1.crossVectors(od,ad),n=[b1.x,b1.y,b1.z],VM(n,Ym,Km,Jm,x1))}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,ic).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(ic).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Yu[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Yu[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Yu[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Yu[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Yu[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Yu[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Yu[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Yu[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Yu),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}};const Yu=[new pt,new pt,new pt,new pt,new pt,new pt,new pt,new pt],ic=new pt,_1=new Zm,Ym=new pt,Km=new pt,Jm=new pt,od=new pt,ad=new pt,Yf=new pt,ry=new pt,x1=new pt,b1=new pt,Kf=new pt;function VM(t,e,n,i,r){for(let a=0,u=t.length-3;a<=u;a+=3){Kf.fromArray(t,a);const l=r.x*Math.abs(Kf.x)+r.y*Math.abs(Kf.y)+r.z*Math.abs(Kf.z),f=e.dot(Kf),g=n.dot(Kf),y=i.dot(Kf);if(Math.max(-Math.max(f,g,y),Math.min(f,g,y))>l)return!1}return!0}const jV=new Zm,sy=new pt,$M=new pt;let HM=class{constructor(e=new pt,n=-1){this.isSphere=!0,this.center=e,this.radius=n}set(e,n){return this.center.copy(e),this.radius=n,this}setFromPoints(e,n){const i=this.center;n!==void 0?i.copy(n):jV.setFromPoints(e).getCenter(i);let r=0;for(let a=0,u=e.length;a<u;a++)r=Math.max(r,i.distanceToSquared(e[a]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const n=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=n*n}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,n){const i=this.center.distanceToSquared(e);return n.copy(e),i>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;sy.subVectors(e,this.center);const n=sy.lengthSq();if(n>this.radius*this.radius){const i=Math.sqrt(n),r=(i-this.radius)*.5;this.center.addScaledVector(sy,r/i),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):($M.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(sy.copy(e.center).add($M)),this.expandByPoint(sy.copy(e.center).sub($M))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}};const Ku=new pt,GM=new pt,w1=new pt,ld=new pt,WM=new pt,S1=new pt,jM=new pt;let VL=class{constructor(e=new pt,n=new pt(0,0,-1)){this.origin=e,this.direction=n}set(e,n){return this.origin.copy(e),this.direction.copy(n),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,n){return n.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Ku)),this}closestPointToPoint(e,n){n.subVectors(e,this.origin);const i=n.dot(this.direction);return i<0?n.copy(this.origin):n.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const n=Ku.subVectors(e,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(e):(Ku.copy(this.origin).addScaledVector(this.direction,n),Ku.distanceToSquared(e))}distanceSqToSegment(e,n,i,r){GM.copy(e).add(n).multiplyScalar(.5),w1.copy(n).sub(e).normalize(),ld.copy(this.origin).sub(GM);const a=e.distanceTo(n)*.5,u=-this.direction.dot(w1),l=ld.dot(this.direction),f=-ld.dot(w1),g=ld.lengthSq(),y=Math.abs(1-u*u);let S,b,A,I;if(y>0)if(S=u*f-l,b=u*l-f,I=a*y,S>=0)if(b>=-I)if(b<=I){const D=1/y;S*=D,b*=D,A=S*(S+u*b+2*l)+b*(u*S+b+2*f)+g}else b=a,S=Math.max(0,-(u*b+l)),A=-S*S+b*(b+2*f)+g;else b=-a,S=Math.max(0,-(u*b+l)),A=-S*S+b*(b+2*f)+g;else b<=-I?(S=Math.max(0,-(-u*a+l)),b=S>0?-a:Math.min(Math.max(-a,-f),a),A=-S*S+b*(b+2*f)+g):b<=I?(S=0,b=Math.min(Math.max(-a,-f),a),A=b*(b+2*f)+g):(S=Math.max(0,-(u*a+l)),b=S>0?a:Math.min(Math.max(-a,-f),a),A=-S*S+b*(b+2*f)+g);else b=u>0?-a:a,S=Math.max(0,-(u*b+l)),A=-S*S+b*(b+2*f)+g;return i&&i.copy(this.origin).addScaledVector(this.direction,S),r&&r.copy(GM).addScaledVector(w1,b),A}intersectSphere(e,n){Ku.subVectors(e.center,this.origin);const i=Ku.dot(this.direction),r=Ku.dot(Ku)-i*i,a=e.radius*e.radius;if(r>a)return null;const u=Math.sqrt(a-r),l=i-u,f=i+u;return f<0?null:l<0?this.at(f,n):this.at(l,n)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const n=e.normal.dot(this.direction);if(n===0)return e.distanceToPoint(this.origin)===0?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/n;return i>=0?i:null}intersectPlane(e,n){const i=this.distanceToPlane(e);return i===null?null:this.at(i,n)}intersectsPlane(e){const n=e.distanceToPoint(this.origin);return n===0||e.normal.dot(this.direction)*n<0}intersectBox(e,n){let i,r,a,u,l,f;const g=1/this.direction.x,y=1/this.direction.y,S=1/this.direction.z,b=this.origin;return g>=0?(i=(e.min.x-b.x)*g,r=(e.max.x-b.x)*g):(i=(e.max.x-b.x)*g,r=(e.min.x-b.x)*g),y>=0?(a=(e.min.y-b.y)*y,u=(e.max.y-b.y)*y):(a=(e.max.y-b.y)*y,u=(e.min.y-b.y)*y),i>u||a>r||((a>i||isNaN(i))&&(i=a),(u<r||isNaN(r))&&(r=u),S>=0?(l=(e.min.z-b.z)*S,f=(e.max.z-b.z)*S):(l=(e.max.z-b.z)*S,f=(e.min.z-b.z)*S),i>f||l>r)||((l>i||i!==i)&&(i=l),(f<r||r!==r)&&(r=f),r<0)?null:this.at(i>=0?i:r,n)}intersectsBox(e){return this.intersectBox(e,Ku)!==null}intersectTriangle(e,n,i,r,a){WM.subVectors(n,e),S1.subVectors(i,e),jM.crossVectors(WM,S1);let u=this.direction.dot(jM),l;if(u>0){if(r)return null;l=1}else if(u<0)l=-1,u=-u;else return null;ld.subVectors(this.origin,e);const f=l*this.direction.dot(S1.crossVectors(ld,S1));if(f<0)return null;const g=l*this.direction.dot(WM.cross(ld));if(g<0||f+g>u)return null;const y=-l*ld.dot(jM);return y<0?null:this.at(y/u,a)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}},Es=class hL{constructor(e,n,i,r,a,u,l,f,g,y,S,b,A,I,D,L){hL.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,n,i,r,a,u,l,f,g,y,S,b,A,I,D,L)}set(e,n,i,r,a,u,l,f,g,y,S,b,A,I,D,L){const P=this.elements;return P[0]=e,P[4]=n,P[8]=i,P[12]=r,P[1]=a,P[5]=u,P[9]=l,P[13]=f,P[2]=g,P[6]=y,P[10]=S,P[14]=b,P[3]=A,P[7]=I,P[11]=D,P[15]=L,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new hL().fromArray(this.elements)}copy(e){const n=this.elements,i=e.elements;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],n[9]=i[9],n[10]=i[10],n[11]=i[11],n[12]=i[12],n[13]=i[13],n[14]=i[14],n[15]=i[15],this}copyPosition(e){const n=this.elements,i=e.elements;return n[12]=i[12],n[13]=i[13],n[14]=i[14],this}setFromMatrix3(e){const n=e.elements;return this.set(n[0],n[3],n[6],0,n[1],n[4],n[7],0,n[2],n[5],n[8],0,0,0,0,1),this}extractBasis(e,n,i){return e.setFromMatrixColumn(this,0),n.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,n,i){return this.set(e.x,n.x,i.x,0,e.y,n.y,i.y,0,e.z,n.z,i.z,0,0,0,0,1),this}extractRotation(e){const n=this.elements,i=e.elements,r=1/Qm.setFromMatrixColumn(e,0).length(),a=1/Qm.setFromMatrixColumn(e,1).length(),u=1/Qm.setFromMatrixColumn(e,2).length();return n[0]=i[0]*r,n[1]=i[1]*r,n[2]=i[2]*r,n[3]=0,n[4]=i[4]*a,n[5]=i[5]*a,n[6]=i[6]*a,n[7]=0,n[8]=i[8]*u,n[9]=i[9]*u,n[10]=i[10]*u,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromEuler(e){const n=this.elements,i=e.x,r=e.y,a=e.z,u=Math.cos(i),l=Math.sin(i),f=Math.cos(r),g=Math.sin(r),y=Math.cos(a),S=Math.sin(a);if(e.order==="XYZ"){const b=u*y,A=u*S,I=l*y,D=l*S;n[0]=f*y,n[4]=-f*S,n[8]=g,n[1]=A+I*g,n[5]=b-D*g,n[9]=-l*f,n[2]=D-b*g,n[6]=I+A*g,n[10]=u*f}else if(e.order==="YXZ"){const b=f*y,A=f*S,I=g*y,D=g*S;n[0]=b+D*l,n[4]=I*l-A,n[8]=u*g,n[1]=u*S,n[5]=u*y,n[9]=-l,n[2]=A*l-I,n[6]=D+b*l,n[10]=u*f}else if(e.order==="ZXY"){const b=f*y,A=f*S,I=g*y,D=g*S;n[0]=b-D*l,n[4]=-u*S,n[8]=I+A*l,n[1]=A+I*l,n[5]=u*y,n[9]=D-b*l,n[2]=-u*g,n[6]=l,n[10]=u*f}else if(e.order==="ZYX"){const b=u*y,A=u*S,I=l*y,D=l*S;n[0]=f*y,n[4]=I*g-A,n[8]=b*g+D,n[1]=f*S,n[5]=D*g+b,n[9]=A*g-I,n[2]=-g,n[6]=l*f,n[10]=u*f}else if(e.order==="YZX"){const b=u*f,A=u*g,I=l*f,D=l*g;n[0]=f*y,n[4]=D-b*S,n[8]=I*S+A,n[1]=S,n[5]=u*y,n[9]=-l*y,n[2]=-g*y,n[6]=A*S+I,n[10]=b-D*S}else if(e.order==="XZY"){const b=u*f,A=u*g,I=l*f,D=l*g;n[0]=f*y,n[4]=-S,n[8]=g*y,n[1]=b*S+D,n[5]=u*y,n[9]=A*S-I,n[2]=I*S-A,n[6]=l*y,n[10]=D*S+b}return n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromQuaternion(e){return this.compose(qV,e,XV)}lookAt(e,n,i){const r=this.elements;return Oa.subVectors(e,n),Oa.lengthSq()===0&&(Oa.z=1),Oa.normalize(),cd.crossVectors(i,Oa),cd.lengthSq()===0&&(Math.abs(i.z)===1?Oa.x+=1e-4:Oa.z+=1e-4,Oa.normalize(),cd.crossVectors(i,Oa)),cd.normalize(),E1.crossVectors(Oa,cd),r[0]=cd.x,r[4]=E1.x,r[8]=Oa.x,r[1]=cd.y,r[5]=E1.y,r[9]=Oa.y,r[2]=cd.z,r[6]=E1.z,r[10]=Oa.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const i=e.elements,r=n.elements,a=this.elements,u=i[0],l=i[4],f=i[8],g=i[12],y=i[1],S=i[5],b=i[9],A=i[13],I=i[2],D=i[6],L=i[10],P=i[14],N=i[3],B=i[7],$=i[11],K=i[15],q=r[0],W=r[4],ie=r[8],Z=r[12],X=r[1],se=r[5],De=r[9],Se=r[13],Me=r[2],Ye=r[6],ye=r[10],Ce=r[14],ge=r[3],Be=r[7],Ze=r[11],je=r[15];return a[0]=u*q+l*X+f*Me+g*ge,a[4]=u*W+l*se+f*Ye+g*Be,a[8]=u*ie+l*De+f*ye+g*Ze,a[12]=u*Z+l*Se+f*Ce+g*je,a[1]=y*q+S*X+b*Me+A*ge,a[5]=y*W+S*se+b*Ye+A*Be,a[9]=y*ie+S*De+b*ye+A*Ze,a[13]=y*Z+S*Se+b*Ce+A*je,a[2]=I*q+D*X+L*Me+P*ge,a[6]=I*W+D*se+L*Ye+P*Be,a[10]=I*ie+D*De+L*ye+P*Ze,a[14]=I*Z+D*Se+L*Ce+P*je,a[3]=N*q+B*X+$*Me+K*ge,a[7]=N*W+B*se+$*Ye+K*Be,a[11]=N*ie+B*De+$*ye+K*Ze,a[15]=N*Z+B*Se+$*Ce+K*je,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[4]*=e,n[8]*=e,n[12]*=e,n[1]*=e,n[5]*=e,n[9]*=e,n[13]*=e,n[2]*=e,n[6]*=e,n[10]*=e,n[14]*=e,n[3]*=e,n[7]*=e,n[11]*=e,n[15]*=e,this}determinant(){const e=this.elements,n=e[0],i=e[4],r=e[8],a=e[12],u=e[1],l=e[5],f=e[9],g=e[13],y=e[2],S=e[6],b=e[10],A=e[14],I=e[3],D=e[7],L=e[11],P=e[15];return I*(+a*f*S-r*g*S-a*l*b+i*g*b+r*l*A-i*f*A)+D*(+n*f*A-n*g*b+a*u*b-r*u*A+r*g*y-a*f*y)+L*(+n*g*S-n*l*A-a*u*S+i*u*A+a*l*y-i*g*y)+P*(-r*l*y-n*f*S+n*l*b+r*u*S-i*u*b+i*f*y)}transpose(){const e=this.elements;let n;return n=e[1],e[1]=e[4],e[4]=n,n=e[2],e[2]=e[8],e[8]=n,n=e[6],e[6]=e[9],e[9]=n,n=e[3],e[3]=e[12],e[12]=n,n=e[7],e[7]=e[13],e[13]=n,n=e[11],e[11]=e[14],e[14]=n,this}setPosition(e,n,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=n,r[14]=i),this}invert(){const e=this.elements,n=e[0],i=e[1],r=e[2],a=e[3],u=e[4],l=e[5],f=e[6],g=e[7],y=e[8],S=e[9],b=e[10],A=e[11],I=e[12],D=e[13],L=e[14],P=e[15],N=S*L*g-D*b*g+D*f*A-l*L*A-S*f*P+l*b*P,B=I*b*g-y*L*g-I*f*A+u*L*A+y*f*P-u*b*P,$=y*D*g-I*S*g+I*l*A-u*D*A-y*l*P+u*S*P,K=I*S*f-y*D*f-I*l*b+u*D*b+y*l*L-u*S*L,q=n*N+i*B+r*$+a*K;if(q===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const W=1/q;return e[0]=N*W,e[1]=(D*b*a-S*L*a-D*r*A+i*L*A+S*r*P-i*b*P)*W,e[2]=(l*L*a-D*f*a+D*r*g-i*L*g-l*r*P+i*f*P)*W,e[3]=(S*f*a-l*b*a-S*r*g+i*b*g+l*r*A-i*f*A)*W,e[4]=B*W,e[5]=(y*L*a-I*b*a+I*r*A-n*L*A-y*r*P+n*b*P)*W,e[6]=(I*f*a-u*L*a-I*r*g+n*L*g+u*r*P-n*f*P)*W,e[7]=(u*b*a-y*f*a+y*r*g-n*b*g-u*r*A+n*f*A)*W,e[8]=$*W,e[9]=(I*S*a-y*D*a-I*i*A+n*D*A+y*i*P-n*S*P)*W,e[10]=(u*D*a-I*l*a+I*i*g-n*D*g-u*i*P+n*l*P)*W,e[11]=(y*l*a-u*S*a-y*i*g+n*S*g+u*i*A-n*l*A)*W,e[12]=K*W,e[13]=(y*D*r-I*S*r+I*i*b-n*D*b-y*i*L+n*S*L)*W,e[14]=(I*l*r-u*D*r-I*i*f+n*D*f+u*i*L-n*l*L)*W,e[15]=(u*S*r-y*l*r+y*i*f-n*S*f-u*i*b+n*l*b)*W,this}scale(e){const n=this.elements,i=e.x,r=e.y,a=e.z;return n[0]*=i,n[4]*=r,n[8]*=a,n[1]*=i,n[5]*=r,n[9]*=a,n[2]*=i,n[6]*=r,n[10]*=a,n[3]*=i,n[7]*=r,n[11]*=a,this}getMaxScaleOnAxis(){const e=this.elements,n=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(n,i,r))}makeTranslation(e,n,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,n,0,0,1,i,0,0,0,1),this}makeRotationX(e){const n=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,n,-i,0,0,i,n,0,0,0,0,1),this}makeRotationY(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,0,i,0,0,1,0,0,-i,0,n,0,0,0,0,1),this}makeRotationZ(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,-i,0,0,i,n,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,n){const i=Math.cos(n),r=Math.sin(n),a=1-i,u=e.x,l=e.y,f=e.z,g=a*u,y=a*l;return this.set(g*u+i,g*l-r*f,g*f+r*l,0,g*l+r*f,y*l+i,y*f-r*u,0,g*f-r*l,y*f+r*u,a*f*f+i,0,0,0,0,1),this}makeScale(e,n,i){return this.set(e,0,0,0,0,n,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,n,i,r,a,u){return this.set(1,i,a,0,e,1,u,0,n,r,1,0,0,0,0,1),this}compose(e,n,i){const r=this.elements,a=n._x,u=n._y,l=n._z,f=n._w,g=a+a,y=u+u,S=l+l,b=a*g,A=a*y,I=a*S,D=u*y,L=u*S,P=l*S,N=f*g,B=f*y,$=f*S,K=i.x,q=i.y,W=i.z;return r[0]=(1-(D+P))*K,r[1]=(A+$)*K,r[2]=(I-B)*K,r[3]=0,r[4]=(A-$)*q,r[5]=(1-(b+P))*q,r[6]=(L+N)*q,r[7]=0,r[8]=(I+B)*W,r[9]=(L-N)*W,r[10]=(1-(b+D))*W,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,n,i){const r=this.elements;let a=Qm.set(r[0],r[1],r[2]).length();const u=Qm.set(r[4],r[5],r[6]).length(),l=Qm.set(r[8],r[9],r[10]).length();this.determinant()<0&&(a=-a),e.x=r[12],e.y=r[13],e.z=r[14],rc.copy(this);const g=1/a,y=1/u,S=1/l;return rc.elements[0]*=g,rc.elements[1]*=g,rc.elements[2]*=g,rc.elements[4]*=y,rc.elements[5]*=y,rc.elements[6]*=y,rc.elements[8]*=S,rc.elements[9]*=S,rc.elements[10]*=S,n.setFromRotationMatrix(rc),i.x=a,i.y=u,i.z=l,this}makePerspective(e,n,i,r,a,u,l=Zu){const f=this.elements,g=2*a/(n-e),y=2*a/(i-r),S=(n+e)/(n-e),b=(i+r)/(i-r);let A,I;if(l===Zu)A=-(u+a)/(u-a),I=-2*u*a/(u-a);else if(l===v1)A=-u/(u-a),I=-u*a/(u-a);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+l);return f[0]=g,f[4]=0,f[8]=S,f[12]=0,f[1]=0,f[5]=y,f[9]=b,f[13]=0,f[2]=0,f[6]=0,f[10]=A,f[14]=I,f[3]=0,f[7]=0,f[11]=-1,f[15]=0,this}makeOrthographic(e,n,i,r,a,u,l=Zu){const f=this.elements,g=1/(n-e),y=1/(i-r),S=1/(u-a),b=(n+e)*g,A=(i+r)*y;let I,D;if(l===Zu)I=(u+a)*S,D=-2*S;else if(l===v1)I=a*S,D=-1*S;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+l);return f[0]=2*g,f[4]=0,f[8]=0,f[12]=-b,f[1]=0,f[5]=2*y,f[9]=0,f[13]=-A,f[2]=0,f[6]=0,f[10]=D,f[14]=-I,f[3]=0,f[7]=0,f[11]=0,f[15]=1,this}equals(e){const n=this.elements,i=e.elements;for(let r=0;r<16;r++)if(n[r]!==i[r])return!1;return!0}fromArray(e,n=0){for(let i=0;i<16;i++)this.elements[i]=e[i+n];return this}toArray(e=[],n=0){const i=this.elements;return e[n]=i[0],e[n+1]=i[1],e[n+2]=i[2],e[n+3]=i[3],e[n+4]=i[4],e[n+5]=i[5],e[n+6]=i[6],e[n+7]=i[7],e[n+8]=i[8],e[n+9]=i[9],e[n+10]=i[10],e[n+11]=i[11],e[n+12]=i[12],e[n+13]=i[13],e[n+14]=i[14],e[n+15]=i[15],e}};const Qm=new pt,rc=new Es,qV=new pt(0,0,0),XV=new pt(1,1,1),cd=new pt,E1=new pt,Oa=new pt,$L=new Es,HL=new Xm;let ud=class W8{constructor(e=0,n=0,i=0,r=W8.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=n,this._z=i,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,n,i,r=this._order){return this._x=e,this._y=n,this._z=i,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,n=this._order,i=!0){const r=e.elements,a=r[0],u=r[4],l=r[8],f=r[1],g=r[5],y=r[9],S=r[2],b=r[6],A=r[10];switch(n){case"XYZ":this._y=Math.asin(io(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-y,A),this._z=Math.atan2(-u,a)):(this._x=Math.atan2(b,g),this._z=0);break;case"YXZ":this._x=Math.asin(-io(y,-1,1)),Math.abs(y)<.9999999?(this._y=Math.atan2(l,A),this._z=Math.atan2(f,g)):(this._y=Math.atan2(-S,a),this._z=0);break;case"ZXY":this._x=Math.asin(io(b,-1,1)),Math.abs(b)<.9999999?(this._y=Math.atan2(-S,A),this._z=Math.atan2(-u,g)):(this._y=0,this._z=Math.atan2(f,a));break;case"ZYX":this._y=Math.asin(-io(S,-1,1)),Math.abs(S)<.9999999?(this._x=Math.atan2(b,A),this._z=Math.atan2(f,a)):(this._x=0,this._z=Math.atan2(-u,g));break;case"YZX":this._z=Math.asin(io(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(-y,g),this._y=Math.atan2(-S,a)):(this._x=0,this._y=Math.atan2(l,A));break;case"XZY":this._z=Math.asin(-io(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(b,g),this._y=Math.atan2(l,a)):(this._x=Math.atan2(-y,A),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,n,i){return $L.makeRotationFromQuaternion(e),this.setFromRotationMatrix($L,n,i)}setFromVector3(e,n=this._order){return this.set(e.x,e.y,e.z,n)}reorder(e){return HL.setFromEuler(this),this.setFromQuaternion(HL,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}};ud.DEFAULT_ORDER="XYZ";let qM=class{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}},ZV=0;const GL=new pt,eg=new Xm,Ju=new Es,M1=new pt,oy=new pt,YV=new pt,KV=new Xm,WL=new pt(1,0,0),jL=new pt(0,1,0),qL=new pt(0,0,1),XL={type:"added"},JV={type:"removed"},tg={type:"childadded",child:null},XM={type:"childremoved",child:null};let Qu=class ZE extends Hm{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:ZV++}),this.uuid=Gm(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=ZE.DEFAULT_UP.clone();const e=new pt,n=new ud,i=new Xm,r=new pt(1,1,1);function a(){i.setFromEuler(n,!1)}function u(){n.setFromQuaternion(i,void 0,!1)}n._onChange(a),i._onChange(u),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new Es},normalMatrix:{value:new Si}}),this.matrix=new Es,this.matrixWorld=new Es,this.matrixAutoUpdate=ZE.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=ZE.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new qM,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,n){this.quaternion.setFromAxisAngle(e,n)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,n){return eg.setFromAxisAngle(e,n),this.quaternion.multiply(eg),this}rotateOnWorldAxis(e,n){return eg.setFromAxisAngle(e,n),this.quaternion.premultiply(eg),this}rotateX(e){return this.rotateOnAxis(WL,e)}rotateY(e){return this.rotateOnAxis(jL,e)}rotateZ(e){return this.rotateOnAxis(qL,e)}translateOnAxis(e,n){return GL.copy(e).applyQuaternion(this.quaternion),this.position.add(GL.multiplyScalar(n)),this}translateX(e){return this.translateOnAxis(WL,e)}translateY(e){return this.translateOnAxis(jL,e)}translateZ(e){return this.translateOnAxis(qL,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Ju.copy(this.matrixWorld).invert())}lookAt(e,n,i){e.isVector3?M1.copy(e):M1.set(e,n,i);const r=this.parent;this.updateWorldMatrix(!0,!1),oy.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Ju.lookAt(oy,M1,this.up):Ju.lookAt(M1,oy,this.up),this.quaternion.setFromRotationMatrix(Ju),r&&(Ju.extractRotation(r.matrixWorld),eg.setFromRotationMatrix(Ju),this.quaternion.premultiply(eg.invert()))}add(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(XL),tg.child=e,this.dispatchEvent(tg),tg.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const n=this.children.indexOf(e);return n!==-1&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(JV),XM.child=e,this.dispatchEvent(XM),XM.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),Ju.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Ju.multiply(e.parent.matrixWorld)),e.applyMatrix4(Ju),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(XL),tg.child=e,this.dispatchEvent(tg),tg.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,n){if(this[e]===n)return this;for(let i=0,r=this.children.length;i<r;i++){const u=this.children[i].getObjectByProperty(e,n);if(u!==void 0)return u}}getObjectsByProperty(e,n,i=[]){this[e]===n&&i.push(this);const r=this.children;for(let a=0,u=r.length;a<u;a++)r[a].getObjectsByProperty(e,n,i);return i}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(oy,e,YV),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(oy,KV,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return e.set(n[8],n[9],n[10]).normalize()}raycast(){}traverse(e){e(this);const n=this.children;for(let i=0,r=n.length;i<r;i++)n[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const n=this.children;for(let i=0,r=n.length;i<r;i++)n[i].traverseVisible(e)}traverseAncestors(e){const n=this.parent;n!==null&&(e(n),n.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const n=this.children;for(let i=0,r=n.length;i<r;i++)n[i].updateMatrixWorld(e)}updateWorldMatrix(e,n){const i=this.parent;if(e===!0&&i!==null&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),n===!0){const r=this.children;for(let a=0,u=r.length;a<u;a++)r[a].updateWorldMatrix(!1,!0)}}toJSON(e){const n=e===void 0||typeof e=="string",i={};n&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.visibility=this._visibility,r.active=this._active,r.bounds=this._bounds.map(l=>({boxInitialized:l.boxInitialized,boxMin:l.box.min.toArray(),boxMax:l.box.max.toArray(),sphereInitialized:l.sphereInitialized,sphereRadius:l.sphere.radius,sphereCenter:l.sphere.center.toArray()})),r.maxInstanceCount=this._maxInstanceCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.geometryCount=this._geometryCount,r.matricesTexture=this._matricesTexture.toJSON(e),this._colorsTexture!==null&&(r.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(r.boundingSphere={center:r.boundingSphere.center.toArray(),radius:r.boundingSphere.radius}),this.boundingBox!==null&&(r.boundingBox={min:r.boundingBox.min.toArray(),max:r.boundingBox.max.toArray()}));function a(l,f){return l[f.uuid]===void 0&&(l[f.uuid]=f.toJSON(e)),f.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=a(e.geometries,this.geometry);const l=this.geometry.parameters;if(l!==void 0&&l.shapes!==void 0){const f=l.shapes;if(Array.isArray(f))for(let g=0,y=f.length;g<y;g++){const S=f[g];a(e.shapes,S)}else a(e.shapes,f)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(a(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const l=[];for(let f=0,g=this.material.length;f<g;f++)l.push(a(e.materials,this.material[f]));r.material=l}else r.material=a(e.materials,this.material);if(this.children.length>0){r.children=[];for(let l=0;l<this.children.length;l++)r.children.push(this.children[l].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let l=0;l<this.animations.length;l++){const f=this.animations[l];r.animations.push(a(e.animations,f))}}if(n){const l=u(e.geometries),f=u(e.materials),g=u(e.textures),y=u(e.images),S=u(e.shapes),b=u(e.skeletons),A=u(e.animations),I=u(e.nodes);l.length>0&&(i.geometries=l),f.length>0&&(i.materials=f),g.length>0&&(i.textures=g),y.length>0&&(i.images=y),S.length>0&&(i.shapes=S),b.length>0&&(i.skeletons=b),A.length>0&&(i.animations=A),I.length>0&&(i.nodes=I)}return i.object=r,i;function u(l){const f=[];for(const g in l){const y=l[g];delete y.metadata,f.push(y)}return f}}clone(e){return new this.constructor().copy(this,e)}copy(e,n=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),n===!0)for(let i=0;i<e.children.length;i++){const r=e.children[i];this.add(r.clone())}return this}};Qu.DEFAULT_UP=new pt(0,1,0),Qu.DEFAULT_MATRIX_AUTO_UPDATE=!0,Qu.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const sc=new pt,eh=new pt,ZM=new pt,th=new pt,ng=new pt,ig=new pt,ZL=new pt,YM=new pt,KM=new pt,JM=new pt;let C1=class Y0{constructor(e=new pt,n=new pt,i=new pt){this.a=e,this.b=n,this.c=i}static getNormal(e,n,i,r){r.subVectors(i,n),sc.subVectors(e,n),r.cross(sc);const a=r.lengthSq();return a>0?r.multiplyScalar(1/Math.sqrt(a)):r.set(0,0,0)}static getBarycoord(e,n,i,r,a){sc.subVectors(r,n),eh.subVectors(i,n),ZM.subVectors(e,n);const u=sc.dot(sc),l=sc.dot(eh),f=sc.dot(ZM),g=eh.dot(eh),y=eh.dot(ZM),S=u*g-l*l;if(S===0)return a.set(0,0,0),null;const b=1/S,A=(g*f-l*y)*b,I=(u*y-l*f)*b;return a.set(1-A-I,I,A)}static containsPoint(e,n,i,r){return this.getBarycoord(e,n,i,r,th)===null?!1:th.x>=0&&th.y>=0&&th.x+th.y<=1}static getInterpolation(e,n,i,r,a,u,l,f){return this.getBarycoord(e,n,i,r,th)===null?(f.x=0,f.y=0,"z"in f&&(f.z=0),"w"in f&&(f.w=0),null):(f.setScalar(0),f.addScaledVector(a,th.x),f.addScaledVector(u,th.y),f.addScaledVector(l,th.z),f)}static isFrontFacing(e,n,i,r){return sc.subVectors(i,n),eh.subVectors(e,n),sc.cross(eh).dot(r)<0}set(e,n,i){return this.a.copy(e),this.b.copy(n),this.c.copy(i),this}setFromPointsAndIndices(e,n,i,r){return this.a.copy(e[n]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,n,i,r){return this.a.fromBufferAttribute(e,n),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return sc.subVectors(this.c,this.b),eh.subVectors(this.a,this.b),sc.cross(eh).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Y0.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,n){return Y0.getBarycoord(e,this.a,this.b,this.c,n)}getInterpolation(e,n,i,r,a){return Y0.getInterpolation(e,this.a,this.b,this.c,n,i,r,a)}containsPoint(e){return Y0.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Y0.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,n){const i=this.a,r=this.b,a=this.c;let u,l;ng.subVectors(r,i),ig.subVectors(a,i),YM.subVectors(e,i);const f=ng.dot(YM),g=ig.dot(YM);if(f<=0&&g<=0)return n.copy(i);KM.subVectors(e,r);const y=ng.dot(KM),S=ig.dot(KM);if(y>=0&&S<=y)return n.copy(r);const b=f*S-y*g;if(b<=0&&f>=0&&y<=0)return u=f/(f-y),n.copy(i).addScaledVector(ng,u);JM.subVectors(e,a);const A=ng.dot(JM),I=ig.dot(JM);if(I>=0&&A<=I)return n.copy(a);const D=A*g-f*I;if(D<=0&&g>=0&&I<=0)return l=g/(g-I),n.copy(i).addScaledVector(ig,l);const L=y*I-A*S;if(L<=0&&S-y>=0&&A-I>=0)return ZL.subVectors(a,r),l=(S-y)/(S-y+(A-I)),n.copy(r).addScaledVector(ZL,l);const P=1/(L+D+b);return u=D*P,l=b*P,n.copy(i).addScaledVector(ng,u).addScaledVector(ig,l)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}};const YL={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},hd={h:0,s:0,l:0},T1={h:0,s:0,l:0};function QM(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*6*(2/3-n):t}let pr=class{constructor(e,n,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,n,i)}set(e,n,i){if(n===void 0&&i===void 0){const r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,n,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,n=jc){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Ki.toWorkingColorSpace(this,n),this}setRGB(e,n,i,r=Ki.workingColorSpace){return this.r=e,this.g=n,this.b=i,Ki.toWorkingColorSpace(this,r),this}setHSL(e,n,i,r=Ki.workingColorSpace){if(e=FM(e,1),n=io(n,0,1),i=io(i,0,1),n===0)this.r=this.g=this.b=i;else{const a=i<=.5?i*(1+n):i+n-i*n,u=2*i-a;this.r=QM(u,a,e+1/3),this.g=QM(u,a,e),this.b=QM(u,a,e-1/3)}return Ki.toWorkingColorSpace(this,r),this}setStyle(e,n=jc){function i(a){a!==void 0&&parseFloat(a)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let a;const u=r[1],l=r[2];switch(u){case"rgb":case"rgba":if(a=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return i(a[4]),this.setRGB(Math.min(255,parseInt(a[1],10))/255,Math.min(255,parseInt(a[2],10))/255,Math.min(255,parseInt(a[3],10))/255,n);if(a=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return i(a[4]),this.setRGB(Math.min(100,parseInt(a[1],10))/100,Math.min(100,parseInt(a[2],10))/100,Math.min(100,parseInt(a[3],10))/100,n);break;case"hsl":case"hsla":if(a=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return i(a[4]),this.setHSL(parseFloat(a[1])/360,parseFloat(a[2])/100,parseFloat(a[3])/100,n);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const a=r[1],u=a.length;if(u===3)return this.setRGB(parseInt(a.charAt(0),16)/15,parseInt(a.charAt(1),16)/15,parseInt(a.charAt(2),16)/15,n);if(u===6)return this.setHex(parseInt(a,16),n);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,n);return this}setColorName(e,n=jc){const i=YL[e.toLowerCase()];return i!==void 0?this.setHex(i,n):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=jm(e.r),this.g=jm(e.g),this.b=jm(e.b),this}copyLinearToSRGB(e){return this.r=NM(e.r),this.g=NM(e.g),this.b=NM(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=jc){return Ki.fromWorkingColorSpace(Eo.copy(this),e),Math.round(io(Eo.r*255,0,255))*65536+Math.round(io(Eo.g*255,0,255))*256+Math.round(io(Eo.b*255,0,255))}getHexString(e=jc){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,n=Ki.workingColorSpace){Ki.fromWorkingColorSpace(Eo.copy(this),n);const i=Eo.r,r=Eo.g,a=Eo.b,u=Math.max(i,r,a),l=Math.min(i,r,a);let f,g;const y=(l+u)/2;if(l===u)f=0,g=0;else{const S=u-l;switch(g=y<=.5?S/(u+l):S/(2-u-l),u){case i:f=(r-a)/S+(r<a?6:0);break;case r:f=(a-i)/S+2;break;case a:f=(i-r)/S+4;break}f/=6}return e.h=f,e.s=g,e.l=y,e}getRGB(e,n=Ki.workingColorSpace){return Ki.fromWorkingColorSpace(Eo.copy(this),n),e.r=Eo.r,e.g=Eo.g,e.b=Eo.b,e}getStyle(e=jc){Ki.fromWorkingColorSpace(Eo.copy(this),e);const n=Eo.r,i=Eo.g,r=Eo.b;return e!==jc?`color(${e} ${n.toFixed(3)} ${i.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(n*255)},${Math.round(i*255)},${Math.round(r*255)})`}offsetHSL(e,n,i){return this.getHSL(hd),this.setHSL(hd.h+e,hd.s+n,hd.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,n){return this.r=e.r+n.r,this.g=e.g+n.g,this.b=e.b+n.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,n){return this.r+=(e.r-this.r)*n,this.g+=(e.g-this.g)*n,this.b+=(e.b-this.b)*n,this}lerpColors(e,n,i){return this.r=e.r+(n.r-e.r)*i,this.g=e.g+(n.g-e.g)*i,this.b=e.b+(n.b-e.b)*i,this}lerpHSL(e,n){this.getHSL(hd),e.getHSL(T1);const i=ty(hd.h,T1.h,n),r=ty(hd.s,T1.s,n),a=ty(hd.l,T1.l,n);return this.setHSL(i,r,a),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const n=this.r,i=this.g,r=this.b,a=e.elements;return this.r=a[0]*n+a[3]*i+a[6]*r,this.g=a[1]*n+a[4]*i+a[7]*r,this.b=a[2]*n+a[5]*i+a[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,n=0){return this.r=e[n],this.g=e[n+1],this.b=e[n+2],this}toArray(e=[],n=0){return e[n]=this.r,e[n+1]=this.g,e[n+2]=this.b,e}fromBufferAttribute(e,n){return this.r=e.getX(n),this.g=e.getY(n),this.b=e.getZ(n),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};const Eo=new pr;pr.NAMES=YL;let QV=0,A1=class extends Hm{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:QV++}),this.uuid=Gm(),this.name="",this.type="Material",this.blending=Fm,this.side=ed,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=YE,this.blendDst=KE,this.blendEquation=qf,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new pr(0,0,0),this.blendAlpha=0,this.depthFunc=s1,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=PL,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=$m,this.stencilZFail=$m,this.stencilZPass=$m,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const n in e){const i=e[n];if(i===void 0){console.warn(`THREE.Material: parameter '${n}' has value of undefined.`);continue}const r=this[n];if(r===void 0){console.warn(`THREE.Material: '${n}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[n]=i}}toJSON(e){const n=e===void 0||typeof e=="string";n&&(e={textures:{},images:{}});const i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(i.dispersion=this.dispersion),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(i.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapRotation!==void 0&&(i.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==Fm&&(i.blending=this.blending),this.side!==ed&&(i.side=this.side),this.vertexColors===!0&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=!0),this.blendSrc!==YE&&(i.blendSrc=this.blendSrc),this.blendDst!==KE&&(i.blendDst=this.blendDst),this.blendEquation!==qf&&(i.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(i.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(i.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(i.blendAlpha=this.blendAlpha),this.depthFunc!==s1&&(i.depthFunc=this.depthFunc),this.depthTest===!1&&(i.depthTest=this.depthTest),this.depthWrite===!1&&(i.depthWrite=this.depthWrite),this.colorWrite===!1&&(i.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(i.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==PL&&(i.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(i.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==$m&&(i.stencilFail=this.stencilFail),this.stencilZFail!==$m&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==$m&&(i.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(i.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaHash===!0&&(i.alphaHash=!0),this.alphaToCoverage===!0&&(i.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=!0),this.forceSinglePass===!0&&(i.forceSinglePass=!0),this.wireframe===!0&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=!0),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function r(a){const u=[];for(const l in a){const f=a[l];delete f.metadata,u.push(f)}return u}if(n){const a=r(e.textures),u=r(e.images);a.length>0&&(i.textures=a),u.length>0&&(i.images=u)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const n=e.clippingPlanes;let i=null;if(n!==null){const r=n.length;i=new Array(r);for(let a=0;a!==r;++a)i[a]=n[a].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}onBeforeRender(){console.warn("Material: onBeforeRender() has been removed.")}},P1=class extends A1{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new pr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ud,this.combine=vL,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}};const hs=new pt,I1=new Ui;let qc=class{constructor(e,n,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=n,this.count=e!==void 0?e.length/n:0,this.normalized=i,this.usage=RL,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=qu,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return ny("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,n){this.updateRanges.push({start:e,count:n})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,n,i){e*=this.itemSize,i*=n.itemSize;for(let r=0,a=this.itemSize;r<a;r++)this.array[e+r]=n.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let n=0,i=this.count;n<i;n++)I1.fromBufferAttribute(this,n),I1.applyMatrix3(e),this.setXY(n,I1.x,I1.y);else if(this.itemSize===3)for(let n=0,i=this.count;n<i;n++)hs.fromBufferAttribute(this,n),hs.applyMatrix3(e),this.setXYZ(n,hs.x,hs.y,hs.z);return this}applyMatrix4(e){for(let n=0,i=this.count;n<i;n++)hs.fromBufferAttribute(this,n),hs.applyMatrix4(e),this.setXYZ(n,hs.x,hs.y,hs.z);return this}applyNormalMatrix(e){for(let n=0,i=this.count;n<i;n++)hs.fromBufferAttribute(this,n),hs.applyNormalMatrix(e),this.setXYZ(n,hs.x,hs.y,hs.z);return this}transformDirection(e){for(let n=0,i=this.count;n<i;n++)hs.fromBufferAttribute(this,n),hs.transformDirection(e),this.setXYZ(n,hs.x,hs.y,hs.z);return this}set(e,n=0){return this.array.set(e,n),this}getComponent(e,n){let i=this.array[e*this.itemSize+n];return this.normalized&&(i=Wm(i,this.array)),i}setComponent(e,n,i){return this.normalized&&(i=Ho(i,this.array)),this.array[e*this.itemSize+n]=i,this}getX(e){let n=this.array[e*this.itemSize];return this.normalized&&(n=Wm(n,this.array)),n}setX(e,n){return this.normalized&&(n=Ho(n,this.array)),this.array[e*this.itemSize]=n,this}getY(e){let n=this.array[e*this.itemSize+1];return this.normalized&&(n=Wm(n,this.array)),n}setY(e,n){return this.normalized&&(n=Ho(n,this.array)),this.array[e*this.itemSize+1]=n,this}getZ(e){let n=this.array[e*this.itemSize+2];return this.normalized&&(n=Wm(n,this.array)),n}setZ(e,n){return this.normalized&&(n=Ho(n,this.array)),this.array[e*this.itemSize+2]=n,this}getW(e){let n=this.array[e*this.itemSize+3];return this.normalized&&(n=Wm(n,this.array)),n}setW(e,n){return this.normalized&&(n=Ho(n,this.array)),this.array[e*this.itemSize+3]=n,this}setXY(e,n,i){return e*=this.itemSize,this.normalized&&(n=Ho(n,this.array),i=Ho(i,this.array)),this.array[e+0]=n,this.array[e+1]=i,this}setXYZ(e,n,i,r){return e*=this.itemSize,this.normalized&&(n=Ho(n,this.array),i=Ho(i,this.array),r=Ho(r,this.array)),this.array[e+0]=n,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,n,i,r,a){return e*=this.itemSize,this.normalized&&(n=Ho(n,this.array),i=Ho(i,this.array),r=Ho(r,this.array),a=Ho(a,this.array)),this.array[e+0]=n,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=a,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==RL&&(e.usage=this.usage),e}},KL=class extends qc{constructor(e,n,i){super(new Uint16Array(e),n,i)}},JL=class extends qc{constructor(e,n,i){super(new Uint32Array(e),n,i)}},Xc=class extends qc{constructor(e,n,i){super(new Float32Array(e),n,i)}},e7=0;const wl=new Es,eC=new Qu,rg=new pt,Fa=new Zm,ay=new Zm,Vs=new pt;let sg=class j8 extends Hm{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:e7++}),this.uuid=Gm(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(DL(e)?JL:KL)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,n){return this.attributes[e]=n,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,n,i=0){this.groups.push({start:e,count:n,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,n){this.drawRange.start=e,this.drawRange.count=n}applyMatrix4(e){const n=this.attributes.position;n!==void 0&&(n.applyMatrix4(e),n.needsUpdate=!0);const i=this.attributes.normal;if(i!==void 0){const a=new Si().getNormalMatrix(e);i.applyNormalMatrix(a),i.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return wl.makeRotationFromQuaternion(e),this.applyMatrix4(wl),this}rotateX(e){return wl.makeRotationX(e),this.applyMatrix4(wl),this}rotateY(e){return wl.makeRotationY(e),this.applyMatrix4(wl),this}rotateZ(e){return wl.makeRotationZ(e),this.applyMatrix4(wl),this}translate(e,n,i){return wl.makeTranslation(e,n,i),this.applyMatrix4(wl),this}scale(e,n,i){return wl.makeScale(e,n,i),this.applyMatrix4(wl),this}lookAt(e){return eC.lookAt(e),eC.updateMatrix(),this.applyMatrix4(eC.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(rg).negate(),this.translate(rg.x,rg.y,rg.z),this}setFromPoints(e){const n=[];for(let i=0,r=e.length;i<r;i++){const a=e[i];n.push(a.x,a.y,a.z||0)}return this.setAttribute("position",new Xc(n,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Zm);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new pt(-1/0,-1/0,-1/0),new pt(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),n)for(let i=0,r=n.length;i<r;i++){const a=n[i];Fa.setFromBufferAttribute(a),this.morphTargetsRelative?(Vs.addVectors(this.boundingBox.min,Fa.min),this.boundingBox.expandByPoint(Vs),Vs.addVectors(this.boundingBox.max,Fa.max),this.boundingBox.expandByPoint(Vs)):(this.boundingBox.expandByPoint(Fa.min),this.boundingBox.expandByPoint(Fa.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new HM);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new pt,1/0);return}if(e){const i=this.boundingSphere.center;if(Fa.setFromBufferAttribute(e),n)for(let a=0,u=n.length;a<u;a++){const l=n[a];ay.setFromBufferAttribute(l),this.morphTargetsRelative?(Vs.addVectors(Fa.min,ay.min),Fa.expandByPoint(Vs),Vs.addVectors(Fa.max,ay.max),Fa.expandByPoint(Vs)):(Fa.expandByPoint(ay.min),Fa.expandByPoint(ay.max))}Fa.getCenter(i);let r=0;for(let a=0,u=e.count;a<u;a++)Vs.fromBufferAttribute(e,a),r=Math.max(r,i.distanceToSquared(Vs));if(n)for(let a=0,u=n.length;a<u;a++){const l=n[a],f=this.morphTargetsRelative;for(let g=0,y=l.count;g<y;g++)Vs.fromBufferAttribute(l,g),f&&(rg.fromBufferAttribute(e,g),Vs.add(rg)),r=Math.max(r,i.distanceToSquared(Vs))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,n=this.attributes;if(e===null||n.position===void 0||n.normal===void 0||n.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const i=n.position,r=n.normal,a=n.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new qc(new Float32Array(4*i.count),4));const u=this.getAttribute("tangent"),l=[],f=[];for(let ie=0;ie<i.count;ie++)l[ie]=new pt,f[ie]=new pt;const g=new pt,y=new pt,S=new pt,b=new Ui,A=new Ui,I=new Ui,D=new pt,L=new pt;function P(ie,Z,X){g.fromBufferAttribute(i,ie),y.fromBufferAttribute(i,Z),S.fromBufferAttribute(i,X),b.fromBufferAttribute(a,ie),A.fromBufferAttribute(a,Z),I.fromBufferAttribute(a,X),y.sub(g),S.sub(g),A.sub(b),I.sub(b);const se=1/(A.x*I.y-I.x*A.y);isFinite(se)&&(D.copy(y).multiplyScalar(I.y).addScaledVector(S,-A.y).multiplyScalar(se),L.copy(S).multiplyScalar(A.x).addScaledVector(y,-I.x).multiplyScalar(se),l[ie].add(D),l[Z].add(D),l[X].add(D),f[ie].add(L),f[Z].add(L),f[X].add(L))}let N=this.groups;N.length===0&&(N=[{start:0,count:e.count}]);for(let ie=0,Z=N.length;ie<Z;++ie){const X=N[ie],se=X.start,De=X.count;for(let Se=se,Me=se+De;Se<Me;Se+=3)P(e.getX(Se+0),e.getX(Se+1),e.getX(Se+2))}const B=new pt,$=new pt,K=new pt,q=new pt;function W(ie){K.fromBufferAttribute(r,ie),q.copy(K);const Z=l[ie];B.copy(Z),B.sub(K.multiplyScalar(K.dot(Z))).normalize(),$.crossVectors(q,Z);const se=$.dot(f[ie])<0?-1:1;u.setXYZW(ie,B.x,B.y,B.z,se)}for(let ie=0,Z=N.length;ie<Z;++ie){const X=N[ie],se=X.start,De=X.count;for(let Se=se,Me=se+De;Se<Me;Se+=3)W(e.getX(Se+0)),W(e.getX(Se+1)),W(e.getX(Se+2))}}computeVertexNormals(){const e=this.index,n=this.getAttribute("position");if(n!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new qc(new Float32Array(n.count*3),3),this.setAttribute("normal",i);else for(let b=0,A=i.count;b<A;b++)i.setXYZ(b,0,0,0);const r=new pt,a=new pt,u=new pt,l=new pt,f=new pt,g=new pt,y=new pt,S=new pt;if(e)for(let b=0,A=e.count;b<A;b+=3){const I=e.getX(b+0),D=e.getX(b+1),L=e.getX(b+2);r.fromBufferAttribute(n,I),a.fromBufferAttribute(n,D),u.fromBufferAttribute(n,L),y.subVectors(u,a),S.subVectors(r,a),y.cross(S),l.fromBufferAttribute(i,I),f.fromBufferAttribute(i,D),g.fromBufferAttribute(i,L),l.add(y),f.add(y),g.add(y),i.setXYZ(I,l.x,l.y,l.z),i.setXYZ(D,f.x,f.y,f.z),i.setXYZ(L,g.x,g.y,g.z)}else for(let b=0,A=n.count;b<A;b+=3)r.fromBufferAttribute(n,b+0),a.fromBufferAttribute(n,b+1),u.fromBufferAttribute(n,b+2),y.subVectors(u,a),S.subVectors(r,a),y.cross(S),i.setXYZ(b+0,y.x,y.y,y.z),i.setXYZ(b+1,y.x,y.y,y.z),i.setXYZ(b+2,y.x,y.y,y.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let n=0,i=e.count;n<i;n++)Vs.fromBufferAttribute(e,n),Vs.normalize(),e.setXYZ(n,Vs.x,Vs.y,Vs.z)}toNonIndexed(){function e(l,f){const g=l.array,y=l.itemSize,S=l.normalized,b=new g.constructor(f.length*y);let A=0,I=0;for(let D=0,L=f.length;D<L;D++){l.isInterleavedBufferAttribute?A=f[D]*l.data.stride+l.offset:A=f[D]*y;for(let P=0;P<y;P++)b[I++]=g[A++]}return new qc(b,y,S)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const n=new j8,i=this.index.array,r=this.attributes;for(const l in r){const f=r[l],g=e(f,i);n.setAttribute(l,g)}const a=this.morphAttributes;for(const l in a){const f=[],g=a[l];for(let y=0,S=g.length;y<S;y++){const b=g[y],A=e(b,i);f.push(A)}n.morphAttributes[l]=f}n.morphTargetsRelative=this.morphTargetsRelative;const u=this.groups;for(let l=0,f=u.length;l<f;l++){const g=u[l];n.addGroup(g.start,g.count,g.materialIndex)}return n}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const f=this.parameters;for(const g in f)f[g]!==void 0&&(e[g]=f[g]);return e}e.data={attributes:{}};const n=this.index;n!==null&&(e.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)});const i=this.attributes;for(const f in i){const g=i[f];e.data.attributes[f]=g.toJSON(e.data)}const r={};let a=!1;for(const f in this.morphAttributes){const g=this.morphAttributes[f],y=[];for(let S=0,b=g.length;S<b;S++){const A=g[S];y.push(A.toJSON(e.data))}y.length>0&&(r[f]=y,a=!0)}a&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const u=this.groups;u.length>0&&(e.data.groups=JSON.parse(JSON.stringify(u)));const l=this.boundingSphere;return l!==null&&(e.data.boundingSphere={center:l.center.toArray(),radius:l.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const n={};this.name=e.name;const i=e.index;i!==null&&this.setIndex(i.clone(n));const r=e.attributes;for(const g in r){const y=r[g];this.setAttribute(g,y.clone(n))}const a=e.morphAttributes;for(const g in a){const y=[],S=a[g];for(let b=0,A=S.length;b<A;b++)y.push(S[b].clone(n));this.morphAttributes[g]=y}this.morphTargetsRelative=e.morphTargetsRelative;const u=e.groups;for(let g=0,y=u.length;g<y;g++){const S=u[g];this.addGroup(S.start,S.count,S.materialIndex)}const l=e.boundingBox;l!==null&&(this.boundingBox=l.clone());const f=e.boundingSphere;return f!==null&&(this.boundingSphere=f.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}};const QL=new Es,Jf=new VL,R1=new HM,ek=new pt,og=new pt,ag=new pt,lg=new pt,tC=new pt,L1=new pt,k1=new Ui,D1=new Ui,O1=new Ui,tk=new pt,nk=new pt,ik=new pt,F1=new pt,z1=new pt;let oc=class extends Qu{constructor(e=new sg,n=new P1){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=n,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){const r=n[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,u=r.length;a<u;a++){const l=r[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=a}}}}getVertexPosition(e,n){const i=this.geometry,r=i.attributes.position,a=i.morphAttributes.position,u=i.morphTargetsRelative;n.fromBufferAttribute(r,e);const l=this.morphTargetInfluences;if(a&&l){L1.set(0,0,0);for(let f=0,g=a.length;f<g;f++){const y=l[f],S=a[f];y!==0&&(tC.fromBufferAttribute(S,e),u?L1.addScaledVector(tC,y):L1.addScaledVector(tC.sub(n),y))}n.add(L1)}return n}raycast(e,n){const i=this.geometry,r=this.material,a=this.matrixWorld;r!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),R1.copy(i.boundingSphere),R1.applyMatrix4(a),Jf.copy(e.ray).recast(e.near),!(R1.containsPoint(Jf.origin)===!1&&(Jf.intersectSphere(R1,ek)===null||Jf.origin.distanceToSquared(ek)>(e.far-e.near)**2))&&(QL.copy(a).invert(),Jf.copy(e.ray).applyMatrix4(QL),!(i.boundingBox!==null&&Jf.intersectsBox(i.boundingBox)===!1)&&this._computeIntersections(e,n,Jf)))}_computeIntersections(e,n,i){let r;const a=this.geometry,u=this.material,l=a.index,f=a.attributes.position,g=a.attributes.uv,y=a.attributes.uv1,S=a.attributes.normal,b=a.groups,A=a.drawRange;if(l!==null)if(Array.isArray(u))for(let I=0,D=b.length;I<D;I++){const L=b[I],P=u[L.materialIndex],N=Math.max(L.start,A.start),B=Math.min(l.count,Math.min(L.start+L.count,A.start+A.count));for(let $=N,K=B;$<K;$+=3){const q=l.getX($),W=l.getX($+1),ie=l.getX($+2);r=N1(this,P,e,i,g,y,S,q,W,ie),r&&(r.faceIndex=Math.floor($/3),r.face.materialIndex=L.materialIndex,n.push(r))}}else{const I=Math.max(0,A.start),D=Math.min(l.count,A.start+A.count);for(let L=I,P=D;L<P;L+=3){const N=l.getX(L),B=l.getX(L+1),$=l.getX(L+2);r=N1(this,u,e,i,g,y,S,N,B,$),r&&(r.faceIndex=Math.floor(L/3),n.push(r))}}else if(f!==void 0)if(Array.isArray(u))for(let I=0,D=b.length;I<D;I++){const L=b[I],P=u[L.materialIndex],N=Math.max(L.start,A.start),B=Math.min(f.count,Math.min(L.start+L.count,A.start+A.count));for(let $=N,K=B;$<K;$+=3){const q=$,W=$+1,ie=$+2;r=N1(this,P,e,i,g,y,S,q,W,ie),r&&(r.faceIndex=Math.floor($/3),r.face.materialIndex=L.materialIndex,n.push(r))}}else{const I=Math.max(0,A.start),D=Math.min(f.count,A.start+A.count);for(let L=I,P=D;L<P;L+=3){const N=L,B=L+1,$=L+2;r=N1(this,u,e,i,g,y,S,N,B,$),r&&(r.faceIndex=Math.floor(L/3),n.push(r))}}}};function t7(t,e,n,i,r,a,u,l){let f;if(e.side===ua?f=i.intersectTriangle(u,a,r,!0,l):f=i.intersectTriangle(r,a,u,e.side===ed,l),f===null)return null;z1.copy(l),z1.applyMatrix4(t.matrixWorld);const g=n.ray.origin.distanceTo(z1);return g<n.near||g>n.far?null:{distance:g,point:z1.clone(),object:t}}function N1(t,e,n,i,r,a,u,l,f,g){t.getVertexPosition(l,og),t.getVertexPosition(f,ag),t.getVertexPosition(g,lg);const y=t7(t,e,n,i,og,ag,lg,F1);if(y){r&&(k1.fromBufferAttribute(r,l),D1.fromBufferAttribute(r,f),O1.fromBufferAttribute(r,g),y.uv=C1.getInterpolation(F1,og,ag,lg,k1,D1,O1,new Ui)),a&&(k1.fromBufferAttribute(a,l),D1.fromBufferAttribute(a,f),O1.fromBufferAttribute(a,g),y.uv1=C1.getInterpolation(F1,og,ag,lg,k1,D1,O1,new Ui)),u&&(tk.fromBufferAttribute(u,l),nk.fromBufferAttribute(u,f),ik.fromBufferAttribute(u,g),y.normal=C1.getInterpolation(F1,og,ag,lg,tk,nk,ik,new pt),y.normal.dot(i.direction)>0&&y.normal.multiplyScalar(-1));const S={a:l,b:f,c:g,normal:new pt,materialIndex:0};C1.getNormal(og,ag,lg,S.normal),y.face=S}return y}class ly extends sg{constructor(e=1,n=1,i=1,r=1,a=1,u=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:n,depth:i,widthSegments:r,heightSegments:a,depthSegments:u};const l=this;r=Math.floor(r),a=Math.floor(a),u=Math.floor(u);const f=[],g=[],y=[],S=[];let b=0,A=0;I("z","y","x",-1,-1,i,n,e,u,a,0),I("z","y","x",1,-1,i,n,-e,u,a,1),I("x","z","y",1,1,e,i,n,r,u,2),I("x","z","y",1,-1,e,i,-n,r,u,3),I("x","y","z",1,-1,e,n,i,r,a,4),I("x","y","z",-1,-1,e,n,-i,r,a,5),this.setIndex(f),this.setAttribute("position",new Xc(g,3)),this.setAttribute("normal",new Xc(y,3)),this.setAttribute("uv",new Xc(S,2));function I(D,L,P,N,B,$,K,q,W,ie,Z){const X=$/W,se=K/ie,De=$/2,Se=K/2,Me=q/2,Ye=W+1,ye=ie+1;let Ce=0,ge=0;const Be=new pt;for(let Ze=0;Ze<ye;Ze++){const je=Ze*se-Se;for(let wt=0;wt<Ye;wt++){const Xt=wt*X-De;Be[D]=Xt*N,Be[L]=je*B,Be[P]=Me,g.push(Be.x,Be.y,Be.z),Be[D]=0,Be[L]=0,Be[P]=q>0?1:-1,y.push(Be.x,Be.y,Be.z),S.push(wt/W),S.push(1-Ze/ie),Ce+=1}}for(let Ze=0;Ze<ie;Ze++)for(let je=0;je<W;je++){const wt=b+je+Ye*Ze,Xt=b+je+Ye*(Ze+1),Ke=b+(je+1)+Ye*(Ze+1),_t=b+(je+1)+Ye*Ze;f.push(wt,Xt,_t),f.push(Xt,Ke,_t),ge+=6}l.addGroup(A,ge,Z),A+=ge,b+=Ce}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ly(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function cg(t){const e={};for(const n in t){e[n]={};for(const i in t[n]){const r=t[n][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[n][i]=null):e[n][i]=r.clone():Array.isArray(r)?e[n][i]=r.slice():e[n][i]=r}}return e}function Go(t){const e={};for(let n=0;n<t.length;n++){const i=cg(t[n]);for(const r in i)e[r]=i[r]}return e}function n7(t){const e=[];for(let n=0;n<t.length;n++)e.push(t[n].clone());return e}function rk(t){const e=t.getRenderTarget();return e===null?t.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:Ki.workingColorSpace}const i7={clone:cg,merge:Go};var r7=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,s7=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class dd extends A1{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=r7,this.fragmentShader=s7,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=cg(e.uniforms),this.uniformsGroups=n7(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const n=super.toJSON(e);n.glslVersion=this.glslVersion,n.uniforms={};for(const r in this.uniforms){const u=this.uniforms[r].value;u&&u.isTexture?n.uniforms[r]={type:"t",value:u.toJSON(e).uuid}:u&&u.isColor?n.uniforms[r]={type:"c",value:u.getHex()}:u&&u.isVector2?n.uniforms[r]={type:"v2",value:u.toArray()}:u&&u.isVector3?n.uniforms[r]={type:"v3",value:u.toArray()}:u&&u.isVector4?n.uniforms[r]={type:"v4",value:u.toArray()}:u&&u.isMatrix3?n.uniforms[r]={type:"m3",value:u.toArray()}:u&&u.isMatrix4?n.uniforms[r]={type:"m4",value:u.toArray()}:n.uniforms[r]={value:u}}Object.keys(this.defines).length>0&&(n.defines=this.defines),n.vertexShader=this.vertexShader,n.fragmentShader=this.fragmentShader,n.lights=this.lights,n.clipping=this.clipping;const i={};for(const r in this.extensions)this.extensions[r]===!0&&(i[r]=!0);return Object.keys(i).length>0&&(n.extensions=i),n}}let sk=class extends Qu{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Es,this.projectionMatrix=new Es,this.projectionMatrixInverse=new Es,this.coordinateSystem=Zu}copy(e,n){return super.copy(e,n),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,n){super.updateWorldMatrix(e,n),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}};const fd=new pt,ok=new Ui,ak=new Ui;let Sl=class extends sk{constructor(e=50,n=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=n,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const n=.5*this.getFilmHeight()/e;this.fov=ey*2*Math.atan(n),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(Q0*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return ey*2*Math.atan(Math.tan(Q0*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,n,i){fd.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(fd.x,fd.y).multiplyScalar(-e/fd.z),fd.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),i.set(fd.x,fd.y).multiplyScalar(-e/fd.z)}getViewSize(e,n){return this.getViewBounds(e,ok,ak),n.subVectors(ak,ok)}setViewOffset(e,n,i,r,a,u){this.aspect=e/n,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=i,this.view.offsetY=r,this.view.width=a,this.view.height=u,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let n=e*Math.tan(Q0*.5*this.fov)/this.zoom,i=2*n,r=this.aspect*i,a=-.5*r;const u=this.view;if(this.view!==null&&this.view.enabled){const f=u.fullWidth,g=u.fullHeight;a+=u.offsetX*r/f,n-=u.offsetY*i/g,r*=u.width/f,i*=u.height/g}const l=this.filmOffset;l!==0&&(a+=e*l/this.getFilmWidth()),this.projectionMatrix.makePerspective(a,a+r,n,n-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.fov=this.fov,n.object.zoom=this.zoom,n.object.near=this.near,n.object.far=this.far,n.object.focus=this.focus,n.object.aspect=this.aspect,this.view!==null&&(n.object.view=Object.assign({},this.view)),n.object.filmGauge=this.filmGauge,n.object.filmOffset=this.filmOffset,n}};const ug=-90,hg=1;class o7 extends Qu{constructor(e,n,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new Sl(ug,hg,e,n);r.layers=this.layers,this.add(r);const a=new Sl(ug,hg,e,n);a.layers=this.layers,this.add(a);const u=new Sl(ug,hg,e,n);u.layers=this.layers,this.add(u);const l=new Sl(ug,hg,e,n);l.layers=this.layers,this.add(l);const f=new Sl(ug,hg,e,n);f.layers=this.layers,this.add(f);const g=new Sl(ug,hg,e,n);g.layers=this.layers,this.add(g)}updateCoordinateSystem(){const e=this.coordinateSystem,n=this.children.concat(),[i,r,a,u,l,f]=n;for(const g of n)this.remove(g);if(e===Zu)i.up.set(0,1,0),i.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),a.up.set(0,0,-1),a.lookAt(0,1,0),u.up.set(0,0,1),u.lookAt(0,-1,0),l.up.set(0,1,0),l.lookAt(0,0,1),f.up.set(0,1,0),f.lookAt(0,0,-1);else if(e===v1)i.up.set(0,-1,0),i.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),a.up.set(0,0,1),a.lookAt(0,1,0),u.up.set(0,0,-1),u.lookAt(0,-1,0),l.up.set(0,-1,0),l.lookAt(0,0,1),f.up.set(0,-1,0),f.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const g of n)this.add(g),g.updateMatrixWorld()}update(e,n){this.parent===null&&this.updateMatrixWorld();const{renderTarget:i,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[a,u,l,f,g,y]=this.children,S=e.getRenderTarget(),b=e.getActiveCubeFace(),A=e.getActiveMipmapLevel(),I=e.xr.enabled;e.xr.enabled=!1;const D=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,r),e.render(n,a),e.setRenderTarget(i,1,r),e.render(n,u),e.setRenderTarget(i,2,r),e.render(n,l),e.setRenderTarget(i,3,r),e.render(n,f),e.setRenderTarget(i,4,r),e.render(n,g),i.texture.generateMipmaps=D,e.setRenderTarget(i,5,r),e.render(n,y),e.setRenderTarget(S,b,A),e.xr.enabled=I,i.texture.needsPMREMUpdate=!0}}class lk extends nc{constructor(e,n,i,r,a,u,l,f,g,y){e=e!==void 0?e:[],n=n!==void 0?n:zm,super(e,n,i,r,a,u,l,f,g,y),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class a7 extends sd{constructor(e=1,n={}){super(e,e,n),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1},r=[i,i,i,i,i,i];this.texture=new lk(r,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=n.generateMipmaps!==void 0?n.generateMipmaps:!1,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:bl}fromEquirectangularTexture(e,n){this.texture.type=n.type,this.texture.colorSpace=n.colorSpace,this.texture.generateMipmaps=n.generateMipmaps,this.texture.minFilter=n.minFilter,this.texture.magFilter=n.magFilter;const i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new ly(5,5,5),a=new dd({name:"CubemapFromEquirect",uniforms:cg(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:ua,blending:td});a.uniforms.tEquirect.value=n;const u=new oc(r,a),l=n.minFilter;return n.minFilter===id&&(n.minFilter=bl),new o7(1,10,this).update(e,u),n.minFilter=l,u.geometry.dispose(),u.material.dispose(),this}clear(e,n,i,r){const a=e.getRenderTarget();for(let u=0;u<6;u++)e.setRenderTarget(this,u),e.clear(n,i,r);e.setRenderTarget(a)}}const nC=new pt,l7=new pt,c7=new Si;class Qf{constructor(e=new pt(1,0,0),n=0){this.isPlane=!0,this.normal=e,this.constant=n}set(e,n){return this.normal.copy(e),this.constant=n,this}setComponents(e,n,i,r){return this.normal.set(e,n,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,n){return this.normal.copy(e),this.constant=-n.dot(this.normal),this}setFromCoplanarPoints(e,n,i){const r=nC.subVectors(i,n).cross(l7.subVectors(e,n)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,n){return n.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,n){const i=e.delta(nC),r=this.normal.dot(i);if(r===0)return this.distanceToPoint(e.start)===0?n.copy(e.start):null;const a=-(e.start.dot(this.normal)+this.constant)/r;return a<0||a>1?null:n.copy(e.start).addScaledVector(i,a)}intersectsLine(e){const n=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return n<0&&i>0||i<0&&n>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,n){const i=n||c7.getNormalMatrix(e),r=this.coplanarPoint(nC).applyMatrix4(e),a=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(a),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const ep=new HM,B1=new pt;class iC{constructor(e=new Qf,n=new Qf,i=new Qf,r=new Qf,a=new Qf,u=new Qf){this.planes=[e,n,i,r,a,u]}set(e,n,i,r,a,u){const l=this.planes;return l[0].copy(e),l[1].copy(n),l[2].copy(i),l[3].copy(r),l[4].copy(a),l[5].copy(u),this}copy(e){const n=this.planes;for(let i=0;i<6;i++)n[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,n=Zu){const i=this.planes,r=e.elements,a=r[0],u=r[1],l=r[2],f=r[3],g=r[4],y=r[5],S=r[6],b=r[7],A=r[8],I=r[9],D=r[10],L=r[11],P=r[12],N=r[13],B=r[14],$=r[15];if(i[0].setComponents(f-a,b-g,L-A,$-P).normalize(),i[1].setComponents(f+a,b+g,L+A,$+P).normalize(),i[2].setComponents(f+u,b+y,L+I,$+N).normalize(),i[3].setComponents(f-u,b-y,L-I,$-N).normalize(),i[4].setComponents(f-l,b-S,L-D,$-B).normalize(),n===Zu)i[5].setComponents(f+l,b+S,L+D,$+B).normalize();else if(n===v1)i[5].setComponents(l,S,D,B).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+n);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),ep.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const n=e.geometry;n.boundingSphere===null&&n.computeBoundingSphere(),ep.copy(n.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(ep)}intersectsSprite(e){return ep.center.set(0,0,0),ep.radius=.7071067811865476,ep.applyMatrix4(e.matrixWorld),this.intersectsSphere(ep)}intersectsSphere(e){const n=this.planes,i=e.center,r=-e.radius;for(let a=0;a<6;a++)if(n[a].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const n=this.planes;for(let i=0;i<6;i++){const r=n[i];if(B1.x=r.normal.x>0?e.max.x:e.min.x,B1.y=r.normal.y>0?e.max.y:e.min.y,B1.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(B1)<0)return!1}return!0}containsPoint(e){const n=this.planes;for(let i=0;i<6;i++)if(n[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function ck(){let t=null,e=!1,n=null,i=null;function r(a,u){n(a,u),i=t.requestAnimationFrame(r)}return{start:function(){e!==!0&&n!==null&&(i=t.requestAnimationFrame(r),e=!0)},stop:function(){t.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(a){n=a},setContext:function(a){t=a}}}function u7(t){const e=new WeakMap;function n(l,f){const g=l.array,y=l.usage,S=g.byteLength,b=t.createBuffer();t.bindBuffer(f,b),t.bufferData(f,g,y),l.onUploadCallback();let A;if(g instanceof Float32Array)A=t.FLOAT;else if(g instanceof Uint16Array)l.isFloat16BufferAttribute?A=t.HALF_FLOAT:A=t.UNSIGNED_SHORT;else if(g instanceof Int16Array)A=t.SHORT;else if(g instanceof Uint32Array)A=t.UNSIGNED_INT;else if(g instanceof Int32Array)A=t.INT;else if(g instanceof Int8Array)A=t.BYTE;else if(g instanceof Uint8Array)A=t.UNSIGNED_BYTE;else if(g instanceof Uint8ClampedArray)A=t.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+g);return{buffer:b,type:A,bytesPerElement:g.BYTES_PER_ELEMENT,version:l.version,size:S}}function i(l,f,g){const y=f.array,S=f._updateRange,b=f.updateRanges;if(t.bindBuffer(g,l),S.count===-1&&b.length===0&&t.bufferSubData(g,0,y),b.length!==0){for(let A=0,I=b.length;A<I;A++){const D=b[A];t.bufferSubData(g,D.start*y.BYTES_PER_ELEMENT,y,D.start,D.count)}f.clearUpdateRanges()}S.count!==-1&&(t.bufferSubData(g,S.offset*y.BYTES_PER_ELEMENT,y,S.offset,S.count),S.count=-1),f.onUploadCallback()}function r(l){return l.isInterleavedBufferAttribute&&(l=l.data),e.get(l)}function a(l){l.isInterleavedBufferAttribute&&(l=l.data);const f=e.get(l);f&&(t.deleteBuffer(f.buffer),e.delete(l))}function u(l,f){if(l.isInterleavedBufferAttribute&&(l=l.data),l.isGLBufferAttribute){const y=e.get(l);(!y||y.version<l.version)&&e.set(l,{buffer:l.buffer,type:l.type,bytesPerElement:l.elementSize,version:l.version});return}const g=e.get(l);if(g===void 0)e.set(l,n(l,f));else if(g.version<l.version){if(g.size!==l.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");i(g.buffer,l,f),g.version=l.version}}return{get:r,remove:a,update:u}}class U1 extends sg{constructor(e=1,n=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:n,widthSegments:i,heightSegments:r};const a=e/2,u=n/2,l=Math.floor(i),f=Math.floor(r),g=l+1,y=f+1,S=e/l,b=n/f,A=[],I=[],D=[],L=[];for(let P=0;P<y;P++){const N=P*b-u;for(let B=0;B<g;B++){const $=B*S-a;I.push($,-N,0),D.push(0,0,1),L.push(B/l),L.push(1-P/f)}}for(let P=0;P<f;P++)for(let N=0;N<l;N++){const B=N+g*P,$=N+g*(P+1),K=N+1+g*(P+1),q=N+1+g*P;A.push(B,$,q),A.push($,K,q)}this.setIndex(A),this.setAttribute("position",new Xc(I,3)),this.setAttribute("normal",new Xc(D,3)),this.setAttribute("uv",new Xc(L,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new U1(e.width,e.height,e.widthSegments,e.heightSegments)}}var h7=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,d7=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,f7=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,p7=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,m7=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,g7=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,v7=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,y7=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,_7=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,x7=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,b7=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,w7=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,S7=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,E7=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,M7=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,C7=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,T7=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,A7=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,P7=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,I7=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,R7=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,L7=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,k7=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,D7=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,O7=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,F7=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,z7=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,N7=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,B7=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,U7=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,V7="gl_FragColor = linearToOutputTexel( gl_FragColor );",$7=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,H7=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,G7=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,W7=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,j7=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,q7=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,X7=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,Z7=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,Y7=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,K7=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,J7=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,Q7=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,e$=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,t$=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,n$=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,i$=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,r$=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,s$=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,o$=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,a$=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,l$=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,c$=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,u$=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,h$=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,d$=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,f$=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,p$=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,m$=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,g$=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,v$=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,y$=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,_$=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,x$=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,b$=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,w$=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,S$=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,E$=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,M$=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,C$=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,T$=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,A$=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,P$=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,I$=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,R$=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,L$=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,k$=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,D$=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,O$=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,F$=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,z$=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,N$=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,B$=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,U$=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,V$=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,$$=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,H$=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,G$=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,W$=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,j$=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,q$=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,X$=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,Z$=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,Y$=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,K$=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,J$=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,Q$=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,eH=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,tH=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,nH=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,iH=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,rH=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,sH=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
		
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
		
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		
		#else
		
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,oH=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,aH=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,lH=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,cH=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const vi={alphahash_fragment:h7,alphahash_pars_fragment:d7,alphamap_fragment:f7,alphamap_pars_fragment:p7,alphatest_fragment:m7,alphatest_pars_fragment:g7,aomap_fragment:v7,aomap_pars_fragment:y7,batching_pars_vertex:_7,batching_vertex:x7,begin_vertex:b7,beginnormal_vertex:w7,bsdfs:S7,iridescence_fragment:E7,bumpmap_pars_fragment:M7,clipping_planes_fragment:C7,clipping_planes_pars_fragment:T7,clipping_planes_pars_vertex:A7,clipping_planes_vertex:P7,color_fragment:I7,color_pars_fragment:R7,color_pars_vertex:L7,color_vertex:k7,common:D7,cube_uv_reflection_fragment:O7,defaultnormal_vertex:F7,displacementmap_pars_vertex:z7,displacementmap_vertex:N7,emissivemap_fragment:B7,emissivemap_pars_fragment:U7,colorspace_fragment:V7,colorspace_pars_fragment:$7,envmap_fragment:H7,envmap_common_pars_fragment:G7,envmap_pars_fragment:W7,envmap_pars_vertex:j7,envmap_physical_pars_fragment:i$,envmap_vertex:q7,fog_vertex:X7,fog_pars_vertex:Z7,fog_fragment:Y7,fog_pars_fragment:K7,gradientmap_pars_fragment:J7,lightmap_pars_fragment:Q7,lights_lambert_fragment:e$,lights_lambert_pars_fragment:t$,lights_pars_begin:n$,lights_toon_fragment:r$,lights_toon_pars_fragment:s$,lights_phong_fragment:o$,lights_phong_pars_fragment:a$,lights_physical_fragment:l$,lights_physical_pars_fragment:c$,lights_fragment_begin:u$,lights_fragment_maps:h$,lights_fragment_end:d$,logdepthbuf_fragment:f$,logdepthbuf_pars_fragment:p$,logdepthbuf_pars_vertex:m$,logdepthbuf_vertex:g$,map_fragment:v$,map_pars_fragment:y$,map_particle_fragment:_$,map_particle_pars_fragment:x$,metalnessmap_fragment:b$,metalnessmap_pars_fragment:w$,morphinstance_vertex:S$,morphcolor_vertex:E$,morphnormal_vertex:M$,morphtarget_pars_vertex:C$,morphtarget_vertex:T$,normal_fragment_begin:A$,normal_fragment_maps:P$,normal_pars_fragment:I$,normal_pars_vertex:R$,normal_vertex:L$,normalmap_pars_fragment:k$,clearcoat_normal_fragment_begin:D$,clearcoat_normal_fragment_maps:O$,clearcoat_pars_fragment:F$,iridescence_pars_fragment:z$,opaque_fragment:N$,packing:B$,premultiplied_alpha_fragment:U$,project_vertex:V$,dithering_fragment:$$,dithering_pars_fragment:H$,roughnessmap_fragment:G$,roughnessmap_pars_fragment:W$,shadowmap_pars_fragment:j$,shadowmap_pars_vertex:q$,shadowmap_vertex:X$,shadowmask_pars_fragment:Z$,skinbase_vertex:Y$,skinning_pars_vertex:K$,skinning_vertex:J$,skinnormal_vertex:Q$,specularmap_fragment:eH,specularmap_pars_fragment:tH,tonemapping_fragment:nH,tonemapping_pars_fragment:iH,transmission_fragment:rH,transmission_pars_fragment:sH,uv_pars_fragment:oH,uv_pars_vertex:aH,uv_vertex:lH,worldpos_vertex:cH,background_vert:`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,background_frag:`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,backgroundCube_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,backgroundCube_frag:`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,cube_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,cube_frag:`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,depth_vert:`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,depth_frag:`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,distanceRGBA_vert:`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,distanceRGBA_frag:`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,equirect_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,equirect_frag:`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,linedashed_vert:`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,linedashed_frag:`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,meshbasic_vert:`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,meshbasic_frag:`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshlambert_vert:`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshlambert_frag:`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshmatcap_vert:`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,meshmatcap_frag:`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshnormal_vert:`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,meshnormal_frag:`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,meshphong_vert:`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshphong_frag:`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshphysical_vert:`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,meshphysical_frag:`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshtoon_vert:`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshtoon_frag:`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,points_vert:`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,points_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,shadow_vert:`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,shadow_frag:`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,sprite_vert:`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,sprite_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`},gn={common:{diffuse:{value:new pr(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Si},alphaMap:{value:null},alphaMapTransform:{value:new Si},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Si}},envmap:{envMap:{value:null},envMapRotation:{value:new Si},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Si}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Si}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Si},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Si},normalScale:{value:new Ui(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Si},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Si}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Si}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Si}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new pr(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new pr(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Si},alphaTest:{value:0},uvTransform:{value:new Si}},sprite:{diffuse:{value:new pr(16777215)},opacity:{value:1},center:{value:new Ui(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Si},alphaMap:{value:null},alphaMapTransform:{value:new Si},alphaTest:{value:0}}},Zc={basic:{uniforms:Go([gn.common,gn.specularmap,gn.envmap,gn.aomap,gn.lightmap,gn.fog]),vertexShader:vi.meshbasic_vert,fragmentShader:vi.meshbasic_frag},lambert:{uniforms:Go([gn.common,gn.specularmap,gn.envmap,gn.aomap,gn.lightmap,gn.emissivemap,gn.bumpmap,gn.normalmap,gn.displacementmap,gn.fog,gn.lights,{emissive:{value:new pr(0)}}]),vertexShader:vi.meshlambert_vert,fragmentShader:vi.meshlambert_frag},phong:{uniforms:Go([gn.common,gn.specularmap,gn.envmap,gn.aomap,gn.lightmap,gn.emissivemap,gn.bumpmap,gn.normalmap,gn.displacementmap,gn.fog,gn.lights,{emissive:{value:new pr(0)},specular:{value:new pr(1118481)},shininess:{value:30}}]),vertexShader:vi.meshphong_vert,fragmentShader:vi.meshphong_frag},standard:{uniforms:Go([gn.common,gn.envmap,gn.aomap,gn.lightmap,gn.emissivemap,gn.bumpmap,gn.normalmap,gn.displacementmap,gn.roughnessmap,gn.metalnessmap,gn.fog,gn.lights,{emissive:{value:new pr(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:vi.meshphysical_vert,fragmentShader:vi.meshphysical_frag},toon:{uniforms:Go([gn.common,gn.aomap,gn.lightmap,gn.emissivemap,gn.bumpmap,gn.normalmap,gn.displacementmap,gn.gradientmap,gn.fog,gn.lights,{emissive:{value:new pr(0)}}]),vertexShader:vi.meshtoon_vert,fragmentShader:vi.meshtoon_frag},matcap:{uniforms:Go([gn.common,gn.bumpmap,gn.normalmap,gn.displacementmap,gn.fog,{matcap:{value:null}}]),vertexShader:vi.meshmatcap_vert,fragmentShader:vi.meshmatcap_frag},points:{uniforms:Go([gn.points,gn.fog]),vertexShader:vi.points_vert,fragmentShader:vi.points_frag},dashed:{uniforms:Go([gn.common,gn.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:vi.linedashed_vert,fragmentShader:vi.linedashed_frag},depth:{uniforms:Go([gn.common,gn.displacementmap]),vertexShader:vi.depth_vert,fragmentShader:vi.depth_frag},normal:{uniforms:Go([gn.common,gn.bumpmap,gn.normalmap,gn.displacementmap,{opacity:{value:1}}]),vertexShader:vi.meshnormal_vert,fragmentShader:vi.meshnormal_frag},sprite:{uniforms:Go([gn.sprite,gn.fog]),vertexShader:vi.sprite_vert,fragmentShader:vi.sprite_frag},background:{uniforms:{uvTransform:{value:new Si},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:vi.background_vert,fragmentShader:vi.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Si}},vertexShader:vi.backgroundCube_vert,fragmentShader:vi.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:vi.cube_vert,fragmentShader:vi.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:vi.equirect_vert,fragmentShader:vi.equirect_frag},distanceRGBA:{uniforms:Go([gn.common,gn.displacementmap,{referencePosition:{value:new pt},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:vi.distanceRGBA_vert,fragmentShader:vi.distanceRGBA_frag},shadow:{uniforms:Go([gn.lights,gn.fog,{color:{value:new pr(0)},opacity:{value:1}}]),vertexShader:vi.shadow_vert,fragmentShader:vi.shadow_frag}};Zc.physical={uniforms:Go([Zc.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Si},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Si},clearcoatNormalScale:{value:new Ui(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Si},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Si},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Si},sheen:{value:0},sheenColor:{value:new pr(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Si},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Si},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Si},transmissionSamplerSize:{value:new Ui},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Si},attenuationDistance:{value:0},attenuationColor:{value:new pr(0)},specularColor:{value:new pr(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Si},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Si},anisotropyVector:{value:new Ui},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Si}}]),vertexShader:vi.meshphysical_vert,fragmentShader:vi.meshphysical_frag};const V1={r:0,b:0,g:0},tp=new ud,uH=new Es;function hH(t,e,n,i,r,a,u){const l=new pr(0);let f=a===!0?0:1,g,y,S=null,b=0,A=null;function I(N){let B=N.isScene===!0?N.background:null;return B&&B.isTexture&&(B=(N.backgroundBlurriness>0?n:e).get(B)),B}function D(N){let B=!1;const $=I(N);$===null?P(l,f):$&&$.isColor&&(P($,1),B=!0);const K=t.xr.getEnvironmentBlendMode();K==="additive"?i.buffers.color.setClear(0,0,0,1,u):K==="alpha-blend"&&i.buffers.color.setClear(0,0,0,0,u),(t.autoClear||B)&&(i.buffers.depth.setTest(!0),i.buffers.depth.setMask(!0),i.buffers.color.setMask(!0),t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil))}function L(N,B){const $=I(B);$&&($.isCubeTexture||$.mapping===o1)?(y===void 0&&(y=new oc(new ly(1,1,1),new dd({name:"BackgroundCubeMaterial",uniforms:cg(Zc.backgroundCube.uniforms),vertexShader:Zc.backgroundCube.vertexShader,fragmentShader:Zc.backgroundCube.fragmentShader,side:ua,depthTest:!1,depthWrite:!1,fog:!1})),y.geometry.deleteAttribute("normal"),y.geometry.deleteAttribute("uv"),y.onBeforeRender=function(K,q,W){this.matrixWorld.copyPosition(W.matrixWorld)},Object.defineProperty(y.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(y)),tp.copy(B.backgroundRotation),tp.x*=-1,tp.y*=-1,tp.z*=-1,$.isCubeTexture&&$.isRenderTargetTexture===!1&&(tp.y*=-1,tp.z*=-1),y.material.uniforms.envMap.value=$,y.material.uniforms.flipEnvMap.value=$.isCubeTexture&&$.isRenderTargetTexture===!1?-1:1,y.material.uniforms.backgroundBlurriness.value=B.backgroundBlurriness,y.material.uniforms.backgroundIntensity.value=B.backgroundIntensity,y.material.uniforms.backgroundRotation.value.setFromMatrix4(uH.makeRotationFromEuler(tp)),y.material.toneMapped=Ki.getTransfer($.colorSpace)!==Mr,(S!==$||b!==$.version||A!==t.toneMapping)&&(y.material.needsUpdate=!0,S=$,b=$.version,A=t.toneMapping),y.layers.enableAll(),N.unshift(y,y.geometry,y.material,0,0,null)):$&&$.isTexture&&(g===void 0&&(g=new oc(new U1(2,2),new dd({name:"BackgroundMaterial",uniforms:cg(Zc.background.uniforms),vertexShader:Zc.background.vertexShader,fragmentShader:Zc.background.fragmentShader,side:ed,depthTest:!1,depthWrite:!1,fog:!1})),g.geometry.deleteAttribute("normal"),Object.defineProperty(g.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(g)),g.material.uniforms.t2D.value=$,g.material.uniforms.backgroundIntensity.value=B.backgroundIntensity,g.material.toneMapped=Ki.getTransfer($.colorSpace)!==Mr,$.matrixAutoUpdate===!0&&$.updateMatrix(),g.material.uniforms.uvTransform.value.copy($.matrix),(S!==$||b!==$.version||A!==t.toneMapping)&&(g.material.needsUpdate=!0,S=$,b=$.version,A=t.toneMapping),g.layers.enableAll(),N.unshift(g,g.geometry,g.material,0,0,null))}function P(N,B){N.getRGB(V1,rk(t)),i.buffers.color.setClear(V1.r,V1.g,V1.b,B,u)}return{getClearColor:function(){return l},setClearColor:function(N,B=1){l.set(N),f=B,P(l,f)},getClearAlpha:function(){return f},setClearAlpha:function(N){f=N,P(l,f)},render:D,addToRenderList:L}}function dH(t,e){const n=t.getParameter(t.MAX_VERTEX_ATTRIBS),i={},r=b(null);let a=r,u=!1;function l(X,se,De,Se,Me){let Ye=!1;const ye=S(Se,De,se);a!==ye&&(a=ye,g(a.object)),Ye=A(X,Se,De,Me),Ye&&I(X,Se,De,Me),Me!==null&&e.update(Me,t.ELEMENT_ARRAY_BUFFER),(Ye||u)&&(u=!1,$(X,se,De,Se),Me!==null&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e.get(Me).buffer))}function f(){return t.createVertexArray()}function g(X){return t.bindVertexArray(X)}function y(X){return t.deleteVertexArray(X)}function S(X,se,De){const Se=De.wireframe===!0;let Me=i[X.id];Me===void 0&&(Me={},i[X.id]=Me);let Ye=Me[se.id];Ye===void 0&&(Ye={},Me[se.id]=Ye);let ye=Ye[Se];return ye===void 0&&(ye=b(f()),Ye[Se]=ye),ye}function b(X){const se=[],De=[],Se=[];for(let Me=0;Me<n;Me++)se[Me]=0,De[Me]=0,Se[Me]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:se,enabledAttributes:De,attributeDivisors:Se,object:X,attributes:{},index:null}}function A(X,se,De,Se){const Me=a.attributes,Ye=se.attributes;let ye=0;const Ce=De.getAttributes();for(const ge in Ce)if(Ce[ge].location>=0){const Ze=Me[ge];let je=Ye[ge];if(je===void 0&&(ge==="instanceMatrix"&&X.instanceMatrix&&(je=X.instanceMatrix),ge==="instanceColor"&&X.instanceColor&&(je=X.instanceColor)),Ze===void 0||Ze.attribute!==je||je&&Ze.data!==je.data)return!0;ye++}return a.attributesNum!==ye||a.index!==Se}function I(X,se,De,Se){const Me={},Ye=se.attributes;let ye=0;const Ce=De.getAttributes();for(const ge in Ce)if(Ce[ge].location>=0){let Ze=Ye[ge];Ze===void 0&&(ge==="instanceMatrix"&&X.instanceMatrix&&(Ze=X.instanceMatrix),ge==="instanceColor"&&X.instanceColor&&(Ze=X.instanceColor));const je={};je.attribute=Ze,Ze&&Ze.data&&(je.data=Ze.data),Me[ge]=je,ye++}a.attributes=Me,a.attributesNum=ye,a.index=Se}function D(){const X=a.newAttributes;for(let se=0,De=X.length;se<De;se++)X[se]=0}function L(X){P(X,0)}function P(X,se){const De=a.newAttributes,Se=a.enabledAttributes,Me=a.attributeDivisors;De[X]=1,Se[X]===0&&(t.enableVertexAttribArray(X),Se[X]=1),Me[X]!==se&&(t.vertexAttribDivisor(X,se),Me[X]=se)}function N(){const X=a.newAttributes,se=a.enabledAttributes;for(let De=0,Se=se.length;De<Se;De++)se[De]!==X[De]&&(t.disableVertexAttribArray(De),se[De]=0)}function B(X,se,De,Se,Me,Ye,ye){ye===!0?t.vertexAttribIPointer(X,se,De,Me,Ye):t.vertexAttribPointer(X,se,De,Se,Me,Ye)}function $(X,se,De,Se){D();const Me=Se.attributes,Ye=De.getAttributes(),ye=se.defaultAttributeValues;for(const Ce in Ye){const ge=Ye[Ce];if(ge.location>=0){let Be=Me[Ce];if(Be===void 0&&(Ce==="instanceMatrix"&&X.instanceMatrix&&(Be=X.instanceMatrix),Ce==="instanceColor"&&X.instanceColor&&(Be=X.instanceColor)),Be!==void 0){const Ze=Be.normalized,je=Be.itemSize,wt=e.get(Be);if(wt===void 0)continue;const Xt=wt.buffer,Ke=wt.type,_t=wt.bytesPerElement,zt=Ke===t.INT||Ke===t.UNSIGNED_INT||Be.gpuType===iM;if(Be.isInterleavedBufferAttribute){const Rt=Be.data,fn=Rt.stride,Mn=Be.offset;if(Rt.isInstancedInterleavedBuffer){for(let Bt=0;Bt<ge.locationSize;Bt++)P(ge.location+Bt,Rt.meshPerAttribute);X.isInstancedMesh!==!0&&Se._maxInstanceCount===void 0&&(Se._maxInstanceCount=Rt.meshPerAttribute*Rt.count)}else for(let Bt=0;Bt<ge.locationSize;Bt++)L(ge.location+Bt);t.bindBuffer(t.ARRAY_BUFFER,Xt);for(let Bt=0;Bt<ge.locationSize;Bt++)B(ge.location+Bt,je/ge.locationSize,Ke,Ze,fn*_t,(Mn+je/ge.locationSize*Bt)*_t,zt)}else{if(Be.isInstancedBufferAttribute){for(let Rt=0;Rt<ge.locationSize;Rt++)P(ge.location+Rt,Be.meshPerAttribute);X.isInstancedMesh!==!0&&Se._maxInstanceCount===void 0&&(Se._maxInstanceCount=Be.meshPerAttribute*Be.count)}else for(let Rt=0;Rt<ge.locationSize;Rt++)L(ge.location+Rt);t.bindBuffer(t.ARRAY_BUFFER,Xt);for(let Rt=0;Rt<ge.locationSize;Rt++)B(ge.location+Rt,je/ge.locationSize,Ke,Ze,je*_t,je/ge.locationSize*Rt*_t,zt)}}else if(ye!==void 0){const Ze=ye[Ce];if(Ze!==void 0)switch(Ze.length){case 2:t.vertexAttrib2fv(ge.location,Ze);break;case 3:t.vertexAttrib3fv(ge.location,Ze);break;case 4:t.vertexAttrib4fv(ge.location,Ze);break;default:t.vertexAttrib1fv(ge.location,Ze)}}}}N()}function K(){ie();for(const X in i){const se=i[X];for(const De in se){const Se=se[De];for(const Me in Se)y(Se[Me].object),delete Se[Me];delete se[De]}delete i[X]}}function q(X){if(i[X.id]===void 0)return;const se=i[X.id];for(const De in se){const Se=se[De];for(const Me in Se)y(Se[Me].object),delete Se[Me];delete se[De]}delete i[X.id]}function W(X){for(const se in i){const De=i[se];if(De[X.id]===void 0)continue;const Se=De[X.id];for(const Me in Se)y(Se[Me].object),delete Se[Me];delete De[X.id]}}function ie(){Z(),u=!0,a!==r&&(a=r,g(a.object))}function Z(){r.geometry=null,r.program=null,r.wireframe=!1}return{setup:l,reset:ie,resetDefaultState:Z,dispose:K,releaseStatesOfGeometry:q,releaseStatesOfProgram:W,initAttributes:D,enableAttribute:L,disableUnusedAttributes:N}}function fH(t,e,n){let i;function r(g){i=g}function a(g,y){t.drawArrays(i,g,y),n.update(y,i,1)}function u(g,y,S){S!==0&&(t.drawArraysInstanced(i,g,y,S),n.update(y,i,S))}function l(g,y,S){if(S===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(i,g,0,y,0,S);let A=0;for(let I=0;I<S;I++)A+=y[I];n.update(A,i,1)}function f(g,y,S,b){if(S===0)return;const A=e.get("WEBGL_multi_draw");if(A===null)for(let I=0;I<g.length;I++)u(g[I],y[I],b[I]);else{A.multiDrawArraysInstancedWEBGL(i,g,0,y,0,b,0,S);let I=0;for(let D=0;D<S;D++)I+=y[D];for(let D=0;D<b.length;D++)n.update(I,i,b[D])}}this.setMode=r,this.render=a,this.renderInstances=u,this.renderMultiDraw=l,this.renderMultiDrawInstances=f}function pH(t,e,n,i){let r;function a(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){const q=e.get("EXT_texture_filter_anisotropic");r=t.getParameter(q.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function u(q){return!(q!==tc&&i.convert(q)!==t.getParameter(t.IMPLEMENTATION_COLOR_READ_FORMAT))}function l(q){const W=q===J0&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(q!==ju&&i.convert(q)!==t.getParameter(t.IMPLEMENTATION_COLOR_READ_TYPE)&&q!==qu&&!W)}function f(q){if(q==="highp"){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";q="mediump"}return q==="mediump"&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let g=n.precision!==void 0?n.precision:"highp";const y=f(g);y!==g&&(console.warn("THREE.WebGLRenderer:",g,"not supported, using",y,"instead."),g=y);const S=n.logarithmicDepthBuffer===!0,b=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),A=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),I=t.getParameter(t.MAX_TEXTURE_SIZE),D=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),L=t.getParameter(t.MAX_VERTEX_ATTRIBS),P=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),N=t.getParameter(t.MAX_VARYING_VECTORS),B=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),$=A>0,K=t.getParameter(t.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:a,getMaxPrecision:f,textureFormatReadable:u,textureTypeReadable:l,precision:g,logarithmicDepthBuffer:S,maxTextures:b,maxVertexTextures:A,maxTextureSize:I,maxCubemapSize:D,maxAttributes:L,maxVertexUniforms:P,maxVaryings:N,maxFragmentUniforms:B,vertexTextures:$,maxSamples:K}}function mH(t){const e=this;let n=null,i=0,r=!1,a=!1;const u=new Qf,l=new Si,f={value:null,needsUpdate:!1};this.uniform=f,this.numPlanes=0,this.numIntersection=0,this.init=function(S,b){const A=S.length!==0||b||i!==0||r;return r=b,i=S.length,A},this.beginShadows=function(){a=!0,y(null)},this.endShadows=function(){a=!1},this.setGlobalState=function(S,b){n=y(S,b,0)},this.setState=function(S,b,A){const I=S.clippingPlanes,D=S.clipIntersection,L=S.clipShadows,P=t.get(S);if(!r||I===null||I.length===0||a&&!L)a?y(null):g();else{const N=a?0:i,B=N*4;let $=P.clippingState||null;f.value=$,$=y(I,b,B,A);for(let K=0;K!==B;++K)$[K]=n[K];P.clippingState=$,this.numIntersection=D?this.numPlanes:0,this.numPlanes+=N}};function g(){f.value!==n&&(f.value=n,f.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function y(S,b,A,I){const D=S!==null?S.length:0;let L=null;if(D!==0){if(L=f.value,I!==!0||L===null){const P=A+D*4,N=b.matrixWorldInverse;l.getNormalMatrix(N),(L===null||L.length<P)&&(L=new Float32Array(P));for(let B=0,$=A;B!==D;++B,$+=4)u.copy(S[B]).applyMatrix4(N,l),u.normal.toArray(L,$),L[$+3]=u.constant}f.value=L,f.needsUpdate=!0}return e.numPlanes=D,e.numIntersection=0,L}}function gH(t){let e=new WeakMap;function n(u,l){return l===JE?u.mapping=zm:l===QE&&(u.mapping=Nm),u}function i(u){if(u&&u.isTexture){const l=u.mapping;if(l===JE||l===QE)if(e.has(u)){const f=e.get(u).texture;return n(f,u.mapping)}else{const f=u.image;if(f&&f.height>0){const g=new a7(f.height);return g.fromEquirectangularTexture(t,u),e.set(u,g),u.addEventListener("dispose",r),n(g.texture,u.mapping)}else return null}}return u}function r(u){const l=u.target;l.removeEventListener("dispose",r);const f=e.get(l);f!==void 0&&(e.delete(l),f.dispose())}function a(){e=new WeakMap}return{get:i,dispose:a}}class vH extends sk{constructor(e=-1,n=1,i=1,r=-1,a=.1,u=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=n,this.top=i,this.bottom=r,this.near=a,this.far=u,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,n,i,r,a,u){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=i,this.view.offsetY=r,this.view.width=a,this.view.height=u,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),n=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let a=i-e,u=i+e,l=r+n,f=r-n;if(this.view!==null&&this.view.enabled){const g=(this.right-this.left)/this.view.fullWidth/this.zoom,y=(this.top-this.bottom)/this.view.fullHeight/this.zoom;a+=g*this.view.offsetX,u=a+g*this.view.width,l-=y*this.view.offsetY,f=l-y*this.view.height}this.projectionMatrix.makeOrthographic(a,u,l,f,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.zoom=this.zoom,n.object.left=this.left,n.object.right=this.right,n.object.top=this.top,n.object.bottom=this.bottom,n.object.near=this.near,n.object.far=this.far,this.view!==null&&(n.object.view=Object.assign({},this.view)),n}}const dg=4,uk=[.125,.215,.35,.446,.526,.582],np=20,rC=new vH,hk=new pr;let sC=null,oC=0,aC=0,lC=!1;const ip=(1+Math.sqrt(5))/2,fg=1/ip,dk=[new pt(-ip,fg,0),new pt(ip,fg,0),new pt(-fg,0,ip),new pt(fg,0,ip),new pt(0,ip,-fg),new pt(0,ip,fg),new pt(-1,1,-1),new pt(1,1,-1),new pt(-1,1,1),new pt(1,1,1)];class fk{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,n=0,i=.1,r=100){sC=this._renderer.getRenderTarget(),oC=this._renderer.getActiveCubeFace(),aC=this._renderer.getActiveMipmapLevel(),lC=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(256);const a=this._allocateTargets();return a.depthBuffer=!0,this._sceneToCubeUV(e,i,r,a),n>0&&this._blur(a,0,0,n),this._applyPMREM(a),this._cleanup(a),a}fromEquirectangular(e,n=null){return this._fromTexture(e,n)}fromCubemap(e,n=null){return this._fromTexture(e,n)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=gk(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=mk(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(sC,oC,aC),this._renderer.xr.enabled=lC,e.scissorTest=!1,$1(e,0,0,e.width,e.height)}_fromTexture(e,n){e.mapping===zm||e.mapping===Nm?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),sC=this._renderer.getRenderTarget(),oC=this._renderer.getActiveCubeFace(),aC=this._renderer.getActiveMipmapLevel(),lC=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const i=n||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),n=4*this._cubeSize,i={magFilter:bl,minFilter:bl,generateMipmaps:!1,type:J0,format:tc,colorSpace:Xu,depthBuffer:!1},r=pk(e,n,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==n){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=pk(e,n,i);const{_lodMax:a}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=yH(a)),this._blurMaterial=_H(a,e,n)}return r}_compileMaterial(e){const n=new oc(this._lodPlanes[0],e);this._renderer.compile(n,rC)}_sceneToCubeUV(e,n,i,r){const l=new Sl(90,1,n,i),f=[1,-1,1,1,1,1],g=[1,1,1,-1,-1,-1],y=this._renderer,S=y.autoClear,b=y.toneMapping;y.getClearColor(hk),y.toneMapping=nd,y.autoClear=!1;const A=new P1({name:"PMREM.Background",side:ua,depthWrite:!1,depthTest:!1}),I=new oc(new ly,A);let D=!1;const L=e.background;L?L.isColor&&(A.color.copy(L),e.background=null,D=!0):(A.color.copy(hk),D=!0);for(let P=0;P<6;P++){const N=P%3;N===0?(l.up.set(0,f[P],0),l.lookAt(g[P],0,0)):N===1?(l.up.set(0,0,f[P]),l.lookAt(0,g[P],0)):(l.up.set(0,f[P],0),l.lookAt(0,0,g[P]));const B=this._cubeSize;$1(r,N*B,P>2?B:0,B,B),y.setRenderTarget(r),D&&y.render(I,l),y.render(e,l)}I.geometry.dispose(),I.material.dispose(),y.toneMapping=b,y.autoClear=S,e.background=L}_textureToCubeUV(e,n){const i=this._renderer,r=e.mapping===zm||e.mapping===Nm;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=gk()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=mk());const a=r?this._cubemapMaterial:this._equirectMaterial,u=new oc(this._lodPlanes[0],a),l=a.uniforms;l.envMap.value=e;const f=this._cubeSize;$1(n,0,0,3*f,2*f),i.setRenderTarget(n),i.render(u,rC)}_applyPMREM(e){const n=this._renderer,i=n.autoClear;n.autoClear=!1;const r=this._lodPlanes.length;for(let a=1;a<r;a++){const u=Math.sqrt(this._sigmas[a]*this._sigmas[a]-this._sigmas[a-1]*this._sigmas[a-1]),l=dk[(r-a-1)%dk.length];this._blur(e,a-1,a,u,l)}n.autoClear=i}_blur(e,n,i,r,a){const u=this._pingPongRenderTarget;this._halfBlur(e,u,n,i,r,"latitudinal",a),this._halfBlur(u,e,i,i,r,"longitudinal",a)}_halfBlur(e,n,i,r,a,u,l){const f=this._renderer,g=this._blurMaterial;u!=="latitudinal"&&u!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const y=3,S=new oc(this._lodPlanes[r],g),b=g.uniforms,A=this._sizeLods[i]-1,I=isFinite(a)?Math.PI/(2*A):2*Math.PI/(2*np-1),D=a/I,L=isFinite(a)?1+Math.floor(y*D):np;L>np&&console.warn(`sigmaRadians, ${a}, is too large and will clip, as it requested ${L} samples when the maximum is set to ${np}`);const P=[];let N=0;for(let W=0;W<np;++W){const ie=W/D,Z=Math.exp(-ie*ie/2);P.push(Z),W===0?N+=Z:W<L&&(N+=2*Z)}for(let W=0;W<P.length;W++)P[W]=P[W]/N;b.envMap.value=e.texture,b.samples.value=L,b.weights.value=P,b.latitudinal.value=u==="latitudinal",l&&(b.poleAxis.value=l);const{_lodMax:B}=this;b.dTheta.value=I,b.mipInt.value=B-i;const $=this._sizeLods[r],K=3*$*(r>B-dg?r-B+dg:0),q=4*(this._cubeSize-$);$1(n,K,q,3*$,2*$),f.setRenderTarget(n),f.render(S,rC)}}function yH(t){const e=[],n=[],i=[];let r=t;const a=t-dg+1+uk.length;for(let u=0;u<a;u++){const l=Math.pow(2,r);n.push(l);let f=1/l;u>t-dg?f=uk[u-t+dg-1]:u===0&&(f=0),i.push(f);const g=1/(l-2),y=-g,S=1+g,b=[y,y,S,y,S,S,y,y,S,S,y,S],A=6,I=6,D=3,L=2,P=1,N=new Float32Array(D*I*A),B=new Float32Array(L*I*A),$=new Float32Array(P*I*A);for(let q=0;q<A;q++){const W=q%3*2/3-1,ie=q>2?0:-1,Z=[W,ie,0,W+2/3,ie,0,W+2/3,ie+1,0,W,ie,0,W+2/3,ie+1,0,W,ie+1,0];N.set(Z,D*I*q),B.set(b,L*I*q);const X=[q,q,q,q,q,q];$.set(X,P*I*q)}const K=new sg;K.setAttribute("position",new qc(N,D)),K.setAttribute("uv",new qc(B,L)),K.setAttribute("faceIndex",new qc($,P)),e.push(K),r>dg&&r--}return{lodPlanes:e,sizeLods:n,sigmas:i}}function pk(t,e,n){const i=new sd(t,e,n);return i.texture.mapping=o1,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function $1(t,e,n,i,r){t.viewport.set(e,n,i,r),t.scissor.set(e,n,i,r)}function _H(t,e,n){const i=new Float32Array(np),r=new pt(0,1,0);return new dd({name:"SphericalGaussianBlur",defines:{n:np,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${t}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:cC(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:td,depthTest:!1,depthWrite:!1})}function mk(){return new dd({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:cC(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:td,depthTest:!1,depthWrite:!1})}function gk(){return new dd({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:cC(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:td,depthTest:!1,depthWrite:!1})}function cC(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function xH(t){let e=new WeakMap,n=null;function i(l){if(l&&l.isTexture){const f=l.mapping,g=f===JE||f===QE,y=f===zm||f===Nm;if(g||y){let S=e.get(l);const b=S!==void 0?S.texture.pmremVersion:0;if(l.isRenderTargetTexture&&l.pmremVersion!==b)return n===null&&(n=new fk(t)),S=g?n.fromEquirectangular(l,S):n.fromCubemap(l,S),S.texture.pmremVersion=l.pmremVersion,e.set(l,S),S.texture;if(S!==void 0)return S.texture;{const A=l.image;return g&&A&&A.height>0||y&&A&&r(A)?(n===null&&(n=new fk(t)),S=g?n.fromEquirectangular(l):n.fromCubemap(l),S.texture.pmremVersion=l.pmremVersion,e.set(l,S),l.addEventListener("dispose",a),S.texture):null}}}return l}function r(l){let f=0;const g=6;for(let y=0;y<g;y++)l[y]!==void 0&&f++;return f===g}function a(l){const f=l.target;f.removeEventListener("dispose",a);const g=e.get(f);g!==void 0&&(e.delete(f),g.dispose())}function u(){e=new WeakMap,n!==null&&(n.dispose(),n=null)}return{get:i,dispose:u}}function bH(t){const e={};function n(i){if(e[i]!==void 0)return e[i];let r;switch(i){case"WEBGL_depth_texture":r=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=t.getExtension(i)}return e[i]=r,r}return{has:function(i){return n(i)!==null},init:function(){n("EXT_color_buffer_float"),n("WEBGL_clip_cull_distance"),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture"),n("WEBGL_render_shared_exponent")},get:function(i){const r=n(i);return r===null&&ny("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function wH(t,e,n,i){const r={},a=new WeakMap;function u(S){const b=S.target;b.index!==null&&e.remove(b.index);for(const I in b.attributes)e.remove(b.attributes[I]);for(const I in b.morphAttributes){const D=b.morphAttributes[I];for(let L=0,P=D.length;L<P;L++)e.remove(D[L])}b.removeEventListener("dispose",u),delete r[b.id];const A=a.get(b);A&&(e.remove(A),a.delete(b)),i.releaseStatesOfGeometry(b),b.isInstancedBufferGeometry===!0&&delete b._maxInstanceCount,n.memory.geometries--}function l(S,b){return r[b.id]===!0||(b.addEventListener("dispose",u),r[b.id]=!0,n.memory.geometries++),b}function f(S){const b=S.attributes;for(const I in b)e.update(b[I],t.ARRAY_BUFFER);const A=S.morphAttributes;for(const I in A){const D=A[I];for(let L=0,P=D.length;L<P;L++)e.update(D[L],t.ARRAY_BUFFER)}}function g(S){const b=[],A=S.index,I=S.attributes.position;let D=0;if(A!==null){const N=A.array;D=A.version;for(let B=0,$=N.length;B<$;B+=3){const K=N[B+0],q=N[B+1],W=N[B+2];b.push(K,q,q,W,W,K)}}else if(I!==void 0){const N=I.array;D=I.version;for(let B=0,$=N.length/3-1;B<$;B+=3){const K=B+0,q=B+1,W=B+2;b.push(K,q,q,W,W,K)}}else return;const L=new(DL(b)?JL:KL)(b,1);L.version=D;const P=a.get(S);P&&e.remove(P),a.set(S,L)}function y(S){const b=a.get(S);if(b){const A=S.index;A!==null&&b.version<A.version&&g(S)}else g(S);return a.get(S)}return{get:l,update:f,getWireframeAttribute:y}}function SH(t,e,n){let i;function r(b){i=b}let a,u;function l(b){a=b.type,u=b.bytesPerElement}function f(b,A){t.drawElements(i,A,a,b*u),n.update(A,i,1)}function g(b,A,I){I!==0&&(t.drawElementsInstanced(i,A,a,b*u,I),n.update(A,i,I))}function y(b,A,I){if(I===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(i,A,0,a,b,0,I);let L=0;for(let P=0;P<I;P++)L+=A[P];n.update(L,i,1)}function S(b,A,I,D){if(I===0)return;const L=e.get("WEBGL_multi_draw");if(L===null)for(let P=0;P<b.length;P++)g(b[P]/u,A[P],D[P]);else{L.multiDrawElementsInstancedWEBGL(i,A,0,a,b,0,D,0,I);let P=0;for(let N=0;N<I;N++)P+=A[N];for(let N=0;N<D.length;N++)n.update(P,i,D[N])}}this.setMode=r,this.setIndex=l,this.render=f,this.renderInstances=g,this.renderMultiDraw=y,this.renderMultiDrawInstances=S}function EH(t){const e={geometries:0,textures:0},n={frame:0,calls:0,triangles:0,points:0,lines:0};function i(a,u,l){switch(n.calls++,u){case t.TRIANGLES:n.triangles+=l*(a/3);break;case t.LINES:n.lines+=l*(a/2);break;case t.LINE_STRIP:n.lines+=l*(a-1);break;case t.LINE_LOOP:n.lines+=l*a;break;case t.POINTS:n.points+=l*a;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",u);break}}function r(){n.calls=0,n.triangles=0,n.points=0,n.lines=0}return{memory:e,render:n,programs:null,autoReset:!0,reset:r,update:i}}function MH(t,e,n){const i=new WeakMap,r=new Us;function a(u,l,f){const g=u.morphTargetInfluences,y=l.morphAttributes.position||l.morphAttributes.normal||l.morphAttributes.color,S=y!==void 0?y.length:0;let b=i.get(l);if(b===void 0||b.count!==S){let Z=function(){W.dispose(),i.delete(l),l.removeEventListener("dispose",Z)};b!==void 0&&b.texture.dispose();const A=l.morphAttributes.position!==void 0,I=l.morphAttributes.normal!==void 0,D=l.morphAttributes.color!==void 0,L=l.morphAttributes.position||[],P=l.morphAttributes.normal||[],N=l.morphAttributes.color||[];let B=0;A===!0&&(B=1),I===!0&&(B=2),D===!0&&(B=3);let $=l.attributes.position.count*B,K=1;$>e.maxTextureSize&&(K=Math.ceil($/e.maxTextureSize),$=e.maxTextureSize);const q=new Float32Array($*K*4*S),W=new BL(q,$,K,S);W.type=qu,W.needsUpdate=!0;const ie=B*4;for(let X=0;X<S;X++){const se=L[X],De=P[X],Se=N[X],Me=$*K*4*X;for(let Ye=0;Ye<se.count;Ye++){const ye=Ye*ie;A===!0&&(r.fromBufferAttribute(se,Ye),q[Me+ye+0]=r.x,q[Me+ye+1]=r.y,q[Me+ye+2]=r.z,q[Me+ye+3]=0),I===!0&&(r.fromBufferAttribute(De,Ye),q[Me+ye+4]=r.x,q[Me+ye+5]=r.y,q[Me+ye+6]=r.z,q[Me+ye+7]=0),D===!0&&(r.fromBufferAttribute(Se,Ye),q[Me+ye+8]=r.x,q[Me+ye+9]=r.y,q[Me+ye+10]=r.z,q[Me+ye+11]=Se.itemSize===4?r.w:1)}}b={count:S,texture:W,size:new Ui($,K)},i.set(l,b),l.addEventListener("dispose",Z)}if(u.isInstancedMesh===!0&&u.morphTexture!==null)f.getUniforms().setValue(t,"morphTexture",u.morphTexture,n);else{let A=0;for(let D=0;D<g.length;D++)A+=g[D];const I=l.morphTargetsRelative?1:1-A;f.getUniforms().setValue(t,"morphTargetBaseInfluence",I),f.getUniforms().setValue(t,"morphTargetInfluences",g)}f.getUniforms().setValue(t,"morphTargetsTexture",b.texture,n),f.getUniforms().setValue(t,"morphTargetsTextureSize",b.size)}return{update:a}}function CH(t,e,n,i){let r=new WeakMap;function a(f){const g=i.render.frame,y=f.geometry,S=e.get(f,y);if(r.get(S)!==g&&(e.update(S),r.set(S,g)),f.isInstancedMesh&&(f.hasEventListener("dispose",l)===!1&&f.addEventListener("dispose",l),r.get(f)!==g&&(n.update(f.instanceMatrix,t.ARRAY_BUFFER),f.instanceColor!==null&&n.update(f.instanceColor,t.ARRAY_BUFFER),r.set(f,g))),f.isSkinnedMesh){const b=f.skeleton;r.get(b)!==g&&(b.update(),r.set(b,g))}return S}function u(){r=new WeakMap}function l(f){const g=f.target;g.removeEventListener("dispose",l),n.remove(g.instanceMatrix),g.instanceColor!==null&&n.remove(g.instanceColor)}return{update:a,dispose:u}}let vk=class extends nc{constructor(e,n,i,r,a,u,l,f,g,y=Um){if(y!==Um&&y!==Vm)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&y===Um&&(i=Zf),i===void 0&&y===Vm&&(i=Bm),super(null,r,a,u,l,f,y,i,g),this.isDepthTexture=!0,this.image={width:e,height:n},this.magFilter=l!==void 0?l:xl,this.minFilter=f!==void 0?f:xl,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const n=super.toJSON(e);return this.compareFunction!==null&&(n.compareFunction=this.compareFunction),n}};const yk=new nc,_k=new vk(1,1),xk=new BL,bk=new WV,wk=new lk,Sk=[],Ek=[],Mk=new Float32Array(16),Ck=new Float32Array(9),Tk=new Float32Array(4);function pg(t,e,n){const i=t[0];if(i<=0||i>0)return t;const r=e*n;let a=Sk[r];if(a===void 0&&(a=new Float32Array(r),Sk[r]=a),e!==0){i.toArray(a,0);for(let u=1,l=0;u!==e;++u)l+=n,t[u].toArray(a,l)}return a}function Ms(t,e){if(t.length!==e.length)return!1;for(let n=0,i=t.length;n<i;n++)if(t[n]!==e[n])return!1;return!0}function Cs(t,e){for(let n=0,i=e.length;n<i;n++)t[n]=e[n]}function H1(t,e){let n=Ek[e];n===void 0&&(n=new Int32Array(e),Ek[e]=n);for(let i=0;i!==e;++i)n[i]=t.allocateTextureUnit();return n}function TH(t,e){const n=this.cache;n[0]!==e&&(t.uniform1f(this.addr,e),n[0]=e)}function AH(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Ms(n,e))return;t.uniform2fv(this.addr,e),Cs(n,e)}}function PH(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(e.r!==void 0)(n[0]!==e.r||n[1]!==e.g||n[2]!==e.b)&&(t.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(Ms(n,e))return;t.uniform3fv(this.addr,e),Cs(n,e)}}function IH(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Ms(n,e))return;t.uniform4fv(this.addr,e),Cs(n,e)}}function RH(t,e){const n=this.cache,i=e.elements;if(i===void 0){if(Ms(n,e))return;t.uniformMatrix2fv(this.addr,!1,e),Cs(n,e)}else{if(Ms(n,i))return;Tk.set(i),t.uniformMatrix2fv(this.addr,!1,Tk),Cs(n,i)}}function LH(t,e){const n=this.cache,i=e.elements;if(i===void 0){if(Ms(n,e))return;t.uniformMatrix3fv(this.addr,!1,e),Cs(n,e)}else{if(Ms(n,i))return;Ck.set(i),t.uniformMatrix3fv(this.addr,!1,Ck),Cs(n,i)}}function kH(t,e){const n=this.cache,i=e.elements;if(i===void 0){if(Ms(n,e))return;t.uniformMatrix4fv(this.addr,!1,e),Cs(n,e)}else{if(Ms(n,i))return;Mk.set(i),t.uniformMatrix4fv(this.addr,!1,Mk),Cs(n,i)}}function DH(t,e){const n=this.cache;n[0]!==e&&(t.uniform1i(this.addr,e),n[0]=e)}function OH(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2i(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Ms(n,e))return;t.uniform2iv(this.addr,e),Cs(n,e)}}function FH(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3i(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(Ms(n,e))return;t.uniform3iv(this.addr,e),Cs(n,e)}}function zH(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4i(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Ms(n,e))return;t.uniform4iv(this.addr,e),Cs(n,e)}}function NH(t,e){const n=this.cache;n[0]!==e&&(t.uniform1ui(this.addr,e),n[0]=e)}function BH(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2ui(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Ms(n,e))return;t.uniform2uiv(this.addr,e),Cs(n,e)}}function UH(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3ui(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(Ms(n,e))return;t.uniform3uiv(this.addr,e),Cs(n,e)}}function VH(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4ui(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Ms(n,e))return;t.uniform4uiv(this.addr,e),Cs(n,e)}}function $H(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r);let a;this.type===t.SAMPLER_2D_SHADOW?(_k.compareFunction=IL,a=_k):a=yk,n.setTexture2D(e||a,r)}function HH(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture3D(e||bk,r)}function GH(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTextureCube(e||wk,r)}function WH(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture2DArray(e||xk,r)}function jH(t){switch(t){case 5126:return TH;case 35664:return AH;case 35665:return PH;case 35666:return IH;case 35674:return RH;case 35675:return LH;case 35676:return kH;case 5124:case 35670:return DH;case 35667:case 35671:return OH;case 35668:case 35672:return FH;case 35669:case 35673:return zH;case 5125:return NH;case 36294:return BH;case 36295:return UH;case 36296:return VH;case 35678:case 36198:case 36298:case 36306:case 35682:return $H;case 35679:case 36299:case 36307:return HH;case 35680:case 36300:case 36308:case 36293:return GH;case 36289:case 36303:case 36311:case 36292:return WH}}function qH(t,e){t.uniform1fv(this.addr,e)}function XH(t,e){const n=pg(e,this.size,2);t.uniform2fv(this.addr,n)}function ZH(t,e){const n=pg(e,this.size,3);t.uniform3fv(this.addr,n)}function YH(t,e){const n=pg(e,this.size,4);t.uniform4fv(this.addr,n)}function KH(t,e){const n=pg(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,n)}function JH(t,e){const n=pg(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,n)}function QH(t,e){const n=pg(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,n)}function eG(t,e){t.uniform1iv(this.addr,e)}function tG(t,e){t.uniform2iv(this.addr,e)}function nG(t,e){t.uniform3iv(this.addr,e)}function iG(t,e){t.uniform4iv(this.addr,e)}function rG(t,e){t.uniform1uiv(this.addr,e)}function sG(t,e){t.uniform2uiv(this.addr,e)}function oG(t,e){t.uniform3uiv(this.addr,e)}function aG(t,e){t.uniform4uiv(this.addr,e)}function lG(t,e,n){const i=this.cache,r=e.length,a=H1(n,r);Ms(i,a)||(t.uniform1iv(this.addr,a),Cs(i,a));for(let u=0;u!==r;++u)n.setTexture2D(e[u]||yk,a[u])}function cG(t,e,n){const i=this.cache,r=e.length,a=H1(n,r);Ms(i,a)||(t.uniform1iv(this.addr,a),Cs(i,a));for(let u=0;u!==r;++u)n.setTexture3D(e[u]||bk,a[u])}function uG(t,e,n){const i=this.cache,r=e.length,a=H1(n,r);Ms(i,a)||(t.uniform1iv(this.addr,a),Cs(i,a));for(let u=0;u!==r;++u)n.setTextureCube(e[u]||wk,a[u])}function hG(t,e,n){const i=this.cache,r=e.length,a=H1(n,r);Ms(i,a)||(t.uniform1iv(this.addr,a),Cs(i,a));for(let u=0;u!==r;++u)n.setTexture2DArray(e[u]||xk,a[u])}function dG(t){switch(t){case 5126:return qH;case 35664:return XH;case 35665:return ZH;case 35666:return YH;case 35674:return KH;case 35675:return JH;case 35676:return QH;case 5124:case 35670:return eG;case 35667:case 35671:return tG;case 35668:case 35672:return nG;case 35669:case 35673:return iG;case 5125:return rG;case 36294:return sG;case 36295:return oG;case 36296:return aG;case 35678:case 36198:case 36298:case 36306:case 35682:return lG;case 35679:case 36299:case 36307:return cG;case 35680:case 36300:case 36308:case 36293:return uG;case 36289:case 36303:case 36311:case 36292:return hG}}class fG{constructor(e,n,i){this.id=e,this.addr=i,this.cache=[],this.type=n.type,this.setValue=jH(n.type)}}class pG{constructor(e,n,i){this.id=e,this.addr=i,this.cache=[],this.type=n.type,this.size=n.size,this.setValue=dG(n.type)}}class mG{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,n,i){const r=this.seq;for(let a=0,u=r.length;a!==u;++a){const l=r[a];l.setValue(e,n[l.id],i)}}}const uC=/(\w+)(\])?(\[|\.)?/g;function Ak(t,e){t.seq.push(e),t.map[e.id]=e}function gG(t,e,n){const i=t.name,r=i.length;for(uC.lastIndex=0;;){const a=uC.exec(i),u=uC.lastIndex;let l=a[1];const f=a[2]==="]",g=a[3];if(f&&(l=l|0),g===void 0||g==="["&&u+2===r){Ak(n,g===void 0?new fG(l,t,e):new pG(l,t,e));break}else{let S=n.map[l];S===void 0&&(S=new mG(l),Ak(n,S)),n=S}}}class G1{constructor(e,n){this.seq=[],this.map={};const i=e.getProgramParameter(n,e.ACTIVE_UNIFORMS);for(let r=0;r<i;++r){const a=e.getActiveUniform(n,r),u=e.getUniformLocation(n,a.name);gG(a,u,this)}}setValue(e,n,i,r){const a=this.map[n];a!==void 0&&a.setValue(e,i,r)}setOptional(e,n,i){const r=n[i];r!==void 0&&this.setValue(e,i,r)}static upload(e,n,i,r){for(let a=0,u=n.length;a!==u;++a){const l=n[a],f=i[l.id];f.needsUpdate!==!1&&l.setValue(e,f.value,r)}}static seqWithValue(e,n){const i=[];for(let r=0,a=e.length;r!==a;++r){const u=e[r];u.id in n&&i.push(u)}return i}}function Pk(t,e,n){const i=t.createShader(e);return t.shaderSource(i,n),t.compileShader(i),i}const vG=37297;let yG=0;function _G(t,e){const n=t.split(`
`),i=[],r=Math.max(e-6,0),a=Math.min(e+6,n.length);for(let u=r;u<a;u++){const l=u+1;i.push(`${l===e?">":" "} ${l}: ${n[u]}`)}return i.join(`
`)}function xG(t){const e=Ki.getPrimaries(Ki.workingColorSpace),n=Ki.getPrimaries(t);let i;switch(e===n?i="":e===g1&&n===m1?i="LinearDisplayP3ToLinearSRGB":e===m1&&n===g1&&(i="LinearSRGBToLinearDisplayP3"),t){case Xu:case f1:return[i,"LinearTransferOETF"];case jc:case OM:return[i,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",t),[i,"LinearTransferOETF"]}}function Ik(t,e,n){const i=t.getShaderParameter(e,t.COMPILE_STATUS),r=t.getShaderInfoLog(e).trim();if(i&&r==="")return"";const a=/ERROR: 0:(\d+)/.exec(r);if(a){const u=parseInt(a[1]);return n.toUpperCase()+`

`+r+`

`+_G(t.getShaderSource(e),u)}else return r}function bG(t,e){const n=xG(e);return`vec4 ${t}( vec4 value ) { return ${n[0]}( ${n[1]}( value ) ); }`}function wG(t,e){let n;switch(e){case iV:n="Linear";break;case rV:n="Reinhard";break;case sV:n="OptimizedCineon";break;case oV:n="ACESFilmic";break;case lV:n="AgX";break;case cV:n="Neutral";break;case aV:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),n="Linear"}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}const W1=new pt;function SG(){Ki.getLuminanceCoefficients(W1);const t=W1.x.toFixed(4),e=W1.y.toFixed(4),n=W1.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${t}, ${e}, ${n} );`,"	return dot( weights, rgb );","}"].join(`
`)}function EG(t){return[t.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",t.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(cy).join(`
`)}function MG(t){const e=[];for(const n in t){const i=t[n];i!==!1&&e.push("#define "+n+" "+i)}return e.join(`
`)}function CG(t,e){const n={},i=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){const a=t.getActiveAttrib(e,r),u=a.name;let l=1;a.type===t.FLOAT_MAT2&&(l=2),a.type===t.FLOAT_MAT3&&(l=3),a.type===t.FLOAT_MAT4&&(l=4),n[u]={type:a.type,location:t.getAttribLocation(e,u),locationSize:l}}return n}function cy(t){return t!==""}function Rk(t,e){const n=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function Lk(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const TG=/^[ \t]*#include +<([\w\d./]+)>/gm;function hC(t){return t.replace(TG,PG)}const AG=new Map;function PG(t,e){let n=vi[e];if(n===void 0){const i=AG.get(e);if(i!==void 0)n=vi[i],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i);else throw new Error("Can not resolve #include <"+e+">")}return hC(n)}const IG=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function kk(t){return t.replace(IG,RG)}function RG(t,e,n,i){let r="";for(let a=parseInt(e);a<parseInt(n);a++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return r}function Dk(t){let e=`precision ${t.precision} float;
	precision ${t.precision} int;
	precision ${t.precision} sampler2D;
	precision ${t.precision} samplerCube;
	precision ${t.precision} sampler3D;
	precision ${t.precision} sampler2DArray;
	precision ${t.precision} sampler2DShadow;
	precision ${t.precision} samplerCubeShadow;
	precision ${t.precision} sampler2DArrayShadow;
	precision ${t.precision} isampler2D;
	precision ${t.precision} isampler3D;
	precision ${t.precision} isamplerCube;
	precision ${t.precision} isampler2DArray;
	precision ${t.precision} usampler2D;
	precision ${t.precision} usampler3D;
	precision ${t.precision} usamplerCube;
	precision ${t.precision} usampler2DArray;
	`;return t.precision==="highp"?e+=`
#define HIGH_PRECISION`:t.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:t.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function LG(t){let e="SHADOWMAP_TYPE_BASIC";return t.shadowMapType===fL?e="SHADOWMAP_TYPE_PCF":t.shadowMapType===P9?e="SHADOWMAP_TYPE_PCF_SOFT":t.shadowMapType===Gu&&(e="SHADOWMAP_TYPE_VSM"),e}function kG(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case zm:case Nm:e="ENVMAP_TYPE_CUBE";break;case o1:e="ENVMAP_TYPE_CUBE_UV";break}return e}function DG(t){let e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case Nm:e="ENVMAP_MODE_REFRACTION";break}return e}function OG(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case vL:e="ENVMAP_BLENDING_MULTIPLY";break;case tV:e="ENVMAP_BLENDING_MIX";break;case nV:e="ENVMAP_BLENDING_ADD";break}return e}function FG(t){const e=t.envMapCubeUVHeight;if(e===null)return null;const n=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,n),7*16)),texelHeight:i,maxMip:n}}function zG(t,e,n,i){const r=t.getContext(),a=n.defines;let u=n.vertexShader,l=n.fragmentShader;const f=LG(n),g=kG(n),y=DG(n),S=OG(n),b=FG(n),A=EG(n),I=MG(a),D=r.createProgram();let L,P,N=n.glslVersion?"#version "+n.glslVersion+`
`:"";n.isRawShaderMaterial?(L=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,I].filter(cy).join(`
`),L.length>0&&(L+=`
`),P=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,I].filter(cy).join(`
`),P.length>0&&(P+=`
`)):(L=[Dk(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,I,n.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",n.batching?"#define USE_BATCHING":"",n.batchingColor?"#define USE_BATCHING_COLOR":"",n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.instancingMorph?"#define USE_INSTANCING_MORPH":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+y:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.displacementMap?"#define USE_DISPLACEMENTMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.mapUv?"#define MAP_UV "+n.mapUv:"",n.alphaMapUv?"#define ALPHAMAP_UV "+n.alphaMapUv:"",n.lightMapUv?"#define LIGHTMAP_UV "+n.lightMapUv:"",n.aoMapUv?"#define AOMAP_UV "+n.aoMapUv:"",n.emissiveMapUv?"#define EMISSIVEMAP_UV "+n.emissiveMapUv:"",n.bumpMapUv?"#define BUMPMAP_UV "+n.bumpMapUv:"",n.normalMapUv?"#define NORMALMAP_UV "+n.normalMapUv:"",n.displacementMapUv?"#define DISPLACEMENTMAP_UV "+n.displacementMapUv:"",n.metalnessMapUv?"#define METALNESSMAP_UV "+n.metalnessMapUv:"",n.roughnessMapUv?"#define ROUGHNESSMAP_UV "+n.roughnessMapUv:"",n.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+n.anisotropyMapUv:"",n.clearcoatMapUv?"#define CLEARCOATMAP_UV "+n.clearcoatMapUv:"",n.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+n.clearcoatNormalMapUv:"",n.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+n.clearcoatRoughnessMapUv:"",n.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+n.iridescenceMapUv:"",n.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+n.iridescenceThicknessMapUv:"",n.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+n.sheenColorMapUv:"",n.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+n.sheenRoughnessMapUv:"",n.specularMapUv?"#define SPECULARMAP_UV "+n.specularMapUv:"",n.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+n.specularColorMapUv:"",n.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+n.specularIntensityMapUv:"",n.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+n.transmissionMapUv:"",n.thicknessMapUv?"#define THICKNESSMAP_UV "+n.thicknessMapUv:"",n.vertexTangents&&n.flatShading===!1?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&n.flatShading===!1?"#define USE_MORPHNORMALS":"",n.morphColors?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+f:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(cy).join(`
`),P=[Dk(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,I,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+g:"",n.envMap?"#define "+y:"",n.envMap?"#define "+S:"",b?"#define CUBEUV_TEXEL_WIDTH "+b.texelWidth:"",b?"#define CUBEUV_TEXEL_HEIGHT "+b.texelHeight:"",b?"#define CUBEUV_MAX_MIP "+b.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.dispersion?"#define USE_DISPERSION":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents&&n.flatShading===!1?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor||n.batchingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+f:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==nd?"#define TONE_MAPPING":"",n.toneMapping!==nd?vi.tonemapping_pars_fragment:"",n.toneMapping!==nd?wG("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",vi.colorspace_pars_fragment,bG("linearToOutputTexel",n.outputColorSpace),SG(),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"",`
`].filter(cy).join(`
`)),u=hC(u),u=Rk(u,n),u=Lk(u,n),l=hC(l),l=Rk(l,n),l=Lk(l,n),u=kk(u),l=kk(l),n.isRawShaderMaterial!==!0&&(N=`#version 300 es
`,L=[A,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+L,P=["#define varying in",n.glslVersion===LL?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===LL?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+P);const B=N+L+u,$=N+P+l,K=Pk(r,r.VERTEX_SHADER,B),q=Pk(r,r.FRAGMENT_SHADER,$);r.attachShader(D,K),r.attachShader(D,q),n.index0AttributeName!==void 0?r.bindAttribLocation(D,0,n.index0AttributeName):n.morphTargets===!0&&r.bindAttribLocation(D,0,"position"),r.linkProgram(D);function W(se){if(t.debug.checkShaderErrors){const De=r.getProgramInfoLog(D).trim(),Se=r.getShaderInfoLog(K).trim(),Me=r.getShaderInfoLog(q).trim();let Ye=!0,ye=!0;if(r.getProgramParameter(D,r.LINK_STATUS)===!1)if(Ye=!1,typeof t.debug.onShaderError=="function")t.debug.onShaderError(r,D,K,q);else{const Ce=Ik(r,K,"vertex"),ge=Ik(r,q,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(D,r.VALIDATE_STATUS)+`

Material Name: `+se.name+`
Material Type: `+se.type+`

Program Info Log: `+De+`
`+Ce+`
`+ge)}else De!==""?console.warn("THREE.WebGLProgram: Program Info Log:",De):(Se===""||Me==="")&&(ye=!1);ye&&(se.diagnostics={runnable:Ye,programLog:De,vertexShader:{log:Se,prefix:L},fragmentShader:{log:Me,prefix:P}})}r.deleteShader(K),r.deleteShader(q),ie=new G1(r,D),Z=CG(r,D)}let ie;this.getUniforms=function(){return ie===void 0&&W(this),ie};let Z;this.getAttributes=function(){return Z===void 0&&W(this),Z};let X=n.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return X===!1&&(X=r.getProgramParameter(D,vG)),X},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(D),this.program=void 0},this.type=n.shaderType,this.name=n.shaderName,this.id=yG++,this.cacheKey=e,this.usedTimes=1,this.program=D,this.vertexShader=K,this.fragmentShader=q,this}let NG=0;class BG{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const n=e.vertexShader,i=e.fragmentShader,r=this._getShaderStage(n),a=this._getShaderStage(i),u=this._getShaderCacheForMaterial(e);return u.has(r)===!1&&(u.add(r),r.usedTimes++),u.has(a)===!1&&(u.add(a),a.usedTimes++),this}remove(e){const n=this.materialCache.get(e);for(const i of n)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const n=this.materialCache;let i=n.get(e);return i===void 0&&(i=new Set,n.set(e,i)),i}_getShaderStage(e){const n=this.shaderCache;let i=n.get(e);return i===void 0&&(i=new UG(e),n.set(e,i)),i}}class UG{constructor(e){this.id=NG++,this.code=e,this.usedTimes=0}}function VG(t,e,n,i,r,a,u){const l=new qM,f=new BG,g=new Set,y=[],S=r.logarithmicDepthBuffer,b=r.vertexTextures;let A=r.precision;const I={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function D(Z){return g.add(Z),Z===0?"uv":`uv${Z}`}function L(Z,X,se,De,Se){const Me=De.fog,Ye=Se.geometry,ye=Z.isMeshStandardMaterial?De.environment:null,Ce=(Z.isMeshStandardMaterial?n:e).get(Z.envMap||ye),ge=Ce&&Ce.mapping===o1?Ce.image.height:null,Be=I[Z.type];Z.precision!==null&&(A=r.getMaxPrecision(Z.precision),A!==Z.precision&&console.warn("THREE.WebGLProgram.getParameters:",Z.precision,"not supported, using",A,"instead."));const Ze=Ye.morphAttributes.position||Ye.morphAttributes.normal||Ye.morphAttributes.color,je=Ze!==void 0?Ze.length:0;let wt=0;Ye.morphAttributes.position!==void 0&&(wt=1),Ye.morphAttributes.normal!==void 0&&(wt=2),Ye.morphAttributes.color!==void 0&&(wt=3);let Xt,Ke,_t,zt;if(Be){const we=Zc[Be];Xt=we.vertexShader,Ke=we.fragmentShader}else Xt=Z.vertexShader,Ke=Z.fragmentShader,f.update(Z),_t=f.getVertexShaderID(Z),zt=f.getFragmentShaderID(Z);const Rt=t.getRenderTarget(),fn=Se.isInstancedMesh===!0,Mn=Se.isBatchedMesh===!0,Bt=!!Z.map,Kn=!!Z.matcap,Re=!!Ce,Jn=!!Z.aoMap,Ln=!!Z.lightMap,Cn=!!Z.bumpMap,Ue=!!Z.normalMap,xt=!!Z.displacementMap,Pt=!!Z.emissiveMap,mt=!!Z.metalnessMap,ve=!!Z.roughnessMap,re=Z.anisotropy>0,Xe=Z.clearcoat>0,Ge=Z.dispersion>0,st=Z.iridescence>0,ft=Z.sheen>0,Ht=Z.transmission>0,$t=re&&!!Z.anisotropyMap,it=Xe&&!!Z.clearcoatMap,On=Xe&&!!Z.clearcoatNormalMap,Nt=Xe&&!!Z.clearcoatRoughnessMap,on=st&&!!Z.iridescenceMap,Wn=st&&!!Z.iridescenceThicknessMap,yt=ft&&!!Z.sheenColorMap,Tt=ft&&!!Z.sheenRoughnessMap,Vt=!!Z.specularMap,kn=!!Z.specularColorMap,ii=!!Z.specularIntensityMap,Ne=Ht&&!!Z.transmissionMap,Gt=Ht&&!!Z.thicknessMap,Et=!!Z.gradientMap,Ct=!!Z.alphaMap,Zt=Z.alphaTest>0,xe=!!Z.alphaHash,te=!!Z.extensions;let ne=nd;Z.toneMapped&&(Rt===null||Rt.isXRRenderTarget===!0)&&(ne=t.toneMapping);const de={shaderID:Be,shaderType:Z.type,shaderName:Z.name,vertexShader:Xt,fragmentShader:Ke,defines:Z.defines,customVertexShaderID:_t,customFragmentShaderID:zt,isRawShaderMaterial:Z.isRawShaderMaterial===!0,glslVersion:Z.glslVersion,precision:A,batching:Mn,batchingColor:Mn&&Se._colorsTexture!==null,instancing:fn,instancingColor:fn&&Se.instanceColor!==null,instancingMorph:fn&&Se.morphTexture!==null,supportsVertexTextures:b,outputColorSpace:Rt===null?t.outputColorSpace:Rt.isXRRenderTarget===!0?Rt.texture.colorSpace:Xu,alphaToCoverage:!!Z.alphaToCoverage,map:Bt,matcap:Kn,envMap:Re,envMapMode:Re&&Ce.mapping,envMapCubeUVHeight:ge,aoMap:Jn,lightMap:Ln,bumpMap:Cn,normalMap:Ue,displacementMap:b&&xt,emissiveMap:Pt,normalMapObjectSpace:Ue&&Z.normalMapType===pV,normalMapTangentSpace:Ue&&Z.normalMapType===fV,metalnessMap:mt,roughnessMap:ve,anisotropy:re,anisotropyMap:$t,clearcoat:Xe,clearcoatMap:it,clearcoatNormalMap:On,clearcoatRoughnessMap:Nt,dispersion:Ge,iridescence:st,iridescenceMap:on,iridescenceThicknessMap:Wn,sheen:ft,sheenColorMap:yt,sheenRoughnessMap:Tt,specularMap:Vt,specularColorMap:kn,specularIntensityMap:ii,transmission:Ht,transmissionMap:Ne,thicknessMap:Gt,gradientMap:Et,opaque:Z.transparent===!1&&Z.blending===Fm&&Z.alphaToCoverage===!1,alphaMap:Ct,alphaTest:Zt,alphaHash:xe,combine:Z.combine,mapUv:Bt&&D(Z.map.channel),aoMapUv:Jn&&D(Z.aoMap.channel),lightMapUv:Ln&&D(Z.lightMap.channel),bumpMapUv:Cn&&D(Z.bumpMap.channel),normalMapUv:Ue&&D(Z.normalMap.channel),displacementMapUv:xt&&D(Z.displacementMap.channel),emissiveMapUv:Pt&&D(Z.emissiveMap.channel),metalnessMapUv:mt&&D(Z.metalnessMap.channel),roughnessMapUv:ve&&D(Z.roughnessMap.channel),anisotropyMapUv:$t&&D(Z.anisotropyMap.channel),clearcoatMapUv:it&&D(Z.clearcoatMap.channel),clearcoatNormalMapUv:On&&D(Z.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Nt&&D(Z.clearcoatRoughnessMap.channel),iridescenceMapUv:on&&D(Z.iridescenceMap.channel),iridescenceThicknessMapUv:Wn&&D(Z.iridescenceThicknessMap.channel),sheenColorMapUv:yt&&D(Z.sheenColorMap.channel),sheenRoughnessMapUv:Tt&&D(Z.sheenRoughnessMap.channel),specularMapUv:Vt&&D(Z.specularMap.channel),specularColorMapUv:kn&&D(Z.specularColorMap.channel),specularIntensityMapUv:ii&&D(Z.specularIntensityMap.channel),transmissionMapUv:Ne&&D(Z.transmissionMap.channel),thicknessMapUv:Gt&&D(Z.thicknessMap.channel),alphaMapUv:Ct&&D(Z.alphaMap.channel),vertexTangents:!!Ye.attributes.tangent&&(Ue||re),vertexColors:Z.vertexColors,vertexAlphas:Z.vertexColors===!0&&!!Ye.attributes.color&&Ye.attributes.color.itemSize===4,pointsUvs:Se.isPoints===!0&&!!Ye.attributes.uv&&(Bt||Ct),fog:!!Me,useFog:Z.fog===!0,fogExp2:!!Me&&Me.isFogExp2,flatShading:Z.flatShading===!0,sizeAttenuation:Z.sizeAttenuation===!0,logarithmicDepthBuffer:S,skinning:Se.isSkinnedMesh===!0,morphTargets:Ye.morphAttributes.position!==void 0,morphNormals:Ye.morphAttributes.normal!==void 0,morphColors:Ye.morphAttributes.color!==void 0,morphTargetsCount:je,morphTextureStride:wt,numDirLights:X.directional.length,numPointLights:X.point.length,numSpotLights:X.spot.length,numSpotLightMaps:X.spotLightMap.length,numRectAreaLights:X.rectArea.length,numHemiLights:X.hemi.length,numDirLightShadows:X.directionalShadowMap.length,numPointLightShadows:X.pointShadowMap.length,numSpotLightShadows:X.spotShadowMap.length,numSpotLightShadowsWithMaps:X.numSpotLightShadowsWithMaps,numLightProbes:X.numLightProbes,numClippingPlanes:u.numPlanes,numClipIntersection:u.numIntersection,dithering:Z.dithering,shadowMapEnabled:t.shadowMap.enabled&&se.length>0,shadowMapType:t.shadowMap.type,toneMapping:ne,decodeVideoTexture:Bt&&Z.map.isVideoTexture===!0&&Ki.getTransfer(Z.map.colorSpace)===Mr,premultipliedAlpha:Z.premultipliedAlpha,doubleSided:Z.side===Wu,flipSided:Z.side===ua,useDepthPacking:Z.depthPacking>=0,depthPacking:Z.depthPacking||0,index0AttributeName:Z.index0AttributeName,extensionClipCullDistance:te&&Z.extensions.clipCullDistance===!0&&i.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(te&&Z.extensions.multiDraw===!0||Mn)&&i.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:Z.customProgramCacheKey()};return de.vertexUv1s=g.has(1),de.vertexUv2s=g.has(2),de.vertexUv3s=g.has(3),g.clear(),de}function P(Z){const X=[];if(Z.shaderID?X.push(Z.shaderID):(X.push(Z.customVertexShaderID),X.push(Z.customFragmentShaderID)),Z.defines!==void 0)for(const se in Z.defines)X.push(se),X.push(Z.defines[se]);return Z.isRawShaderMaterial===!1&&(N(X,Z),B(X,Z),X.push(t.outputColorSpace)),X.push(Z.customProgramCacheKey),X.join()}function N(Z,X){Z.push(X.precision),Z.push(X.outputColorSpace),Z.push(X.envMapMode),Z.push(X.envMapCubeUVHeight),Z.push(X.mapUv),Z.push(X.alphaMapUv),Z.push(X.lightMapUv),Z.push(X.aoMapUv),Z.push(X.bumpMapUv),Z.push(X.normalMapUv),Z.push(X.displacementMapUv),Z.push(X.emissiveMapUv),Z.push(X.metalnessMapUv),Z.push(X.roughnessMapUv),Z.push(X.anisotropyMapUv),Z.push(X.clearcoatMapUv),Z.push(X.clearcoatNormalMapUv),Z.push(X.clearcoatRoughnessMapUv),Z.push(X.iridescenceMapUv),Z.push(X.iridescenceThicknessMapUv),Z.push(X.sheenColorMapUv),Z.push(X.sheenRoughnessMapUv),Z.push(X.specularMapUv),Z.push(X.specularColorMapUv),Z.push(X.specularIntensityMapUv),Z.push(X.transmissionMapUv),Z.push(X.thicknessMapUv),Z.push(X.combine),Z.push(X.fogExp2),Z.push(X.sizeAttenuation),Z.push(X.morphTargetsCount),Z.push(X.morphAttributeCount),Z.push(X.numDirLights),Z.push(X.numPointLights),Z.push(X.numSpotLights),Z.push(X.numSpotLightMaps),Z.push(X.numHemiLights),Z.push(X.numRectAreaLights),Z.push(X.numDirLightShadows),Z.push(X.numPointLightShadows),Z.push(X.numSpotLightShadows),Z.push(X.numSpotLightShadowsWithMaps),Z.push(X.numLightProbes),Z.push(X.shadowMapType),Z.push(X.toneMapping),Z.push(X.numClippingPlanes),Z.push(X.numClipIntersection),Z.push(X.depthPacking)}function B(Z,X){l.disableAll(),X.supportsVertexTextures&&l.enable(0),X.instancing&&l.enable(1),X.instancingColor&&l.enable(2),X.instancingMorph&&l.enable(3),X.matcap&&l.enable(4),X.envMap&&l.enable(5),X.normalMapObjectSpace&&l.enable(6),X.normalMapTangentSpace&&l.enable(7),X.clearcoat&&l.enable(8),X.iridescence&&l.enable(9),X.alphaTest&&l.enable(10),X.vertexColors&&l.enable(11),X.vertexAlphas&&l.enable(12),X.vertexUv1s&&l.enable(13),X.vertexUv2s&&l.enable(14),X.vertexUv3s&&l.enable(15),X.vertexTangents&&l.enable(16),X.anisotropy&&l.enable(17),X.alphaHash&&l.enable(18),X.batching&&l.enable(19),X.dispersion&&l.enable(20),X.batchingColor&&l.enable(21),Z.push(l.mask),l.disableAll(),X.fog&&l.enable(0),X.useFog&&l.enable(1),X.flatShading&&l.enable(2),X.logarithmicDepthBuffer&&l.enable(3),X.skinning&&l.enable(4),X.morphTargets&&l.enable(5),X.morphNormals&&l.enable(6),X.morphColors&&l.enable(7),X.premultipliedAlpha&&l.enable(8),X.shadowMapEnabled&&l.enable(9),X.doubleSided&&l.enable(10),X.flipSided&&l.enable(11),X.useDepthPacking&&l.enable(12),X.dithering&&l.enable(13),X.transmission&&l.enable(14),X.sheen&&l.enable(15),X.opaque&&l.enable(16),X.pointsUvs&&l.enable(17),X.decodeVideoTexture&&l.enable(18),X.alphaToCoverage&&l.enable(19),Z.push(l.mask)}function $(Z){const X=I[Z.type];let se;if(X){const De=Zc[X];se=i7.clone(De.uniforms)}else se=Z.uniforms;return se}function K(Z,X){let se;for(let De=0,Se=y.length;De<Se;De++){const Me=y[De];if(Me.cacheKey===X){se=Me,++se.usedTimes;break}}return se===void 0&&(se=new zG(t,X,Z,a),y.push(se)),se}function q(Z){if(--Z.usedTimes===0){const X=y.indexOf(Z);y[X]=y[y.length-1],y.pop(),Z.destroy()}}function W(Z){f.remove(Z)}function ie(){f.dispose()}return{getParameters:L,getProgramCacheKey:P,getUniforms:$,acquireProgram:K,releaseProgram:q,releaseShaderCache:W,programs:y,dispose:ie}}function $G(){let t=new WeakMap;function e(a){let u=t.get(a);return u===void 0&&(u={},t.set(a,u)),u}function n(a){t.delete(a)}function i(a,u,l){t.get(a)[u]=l}function r(){t=new WeakMap}return{get:e,remove:n,update:i,dispose:r}}function HG(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function Ok(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function Fk(){const t=[];let e=0;const n=[],i=[],r=[];function a(){e=0,n.length=0,i.length=0,r.length=0}function u(S,b,A,I,D,L){let P=t[e];return P===void 0?(P={id:S.id,object:S,geometry:b,material:A,groupOrder:I,renderOrder:S.renderOrder,z:D,group:L},t[e]=P):(P.id=S.id,P.object=S,P.geometry=b,P.material=A,P.groupOrder=I,P.renderOrder=S.renderOrder,P.z=D,P.group=L),e++,P}function l(S,b,A,I,D,L){const P=u(S,b,A,I,D,L);A.transmission>0?i.push(P):A.transparent===!0?r.push(P):n.push(P)}function f(S,b,A,I,D,L){const P=u(S,b,A,I,D,L);A.transmission>0?i.unshift(P):A.transparent===!0?r.unshift(P):n.unshift(P)}function g(S,b){n.length>1&&n.sort(S||HG),i.length>1&&i.sort(b||Ok),r.length>1&&r.sort(b||Ok)}function y(){for(let S=e,b=t.length;S<b;S++){const A=t[S];if(A.id===null)break;A.id=null,A.object=null,A.geometry=null,A.material=null,A.group=null}}return{opaque:n,transmissive:i,transparent:r,init:a,push:l,unshift:f,finish:y,sort:g}}function GG(){let t=new WeakMap;function e(i,r){const a=t.get(i);let u;return a===void 0?(u=new Fk,t.set(i,[u])):r>=a.length?(u=new Fk,a.push(u)):u=a[r],u}function n(){t=new WeakMap}return{get:e,dispose:n}}function WG(){const t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let n;switch(e.type){case"DirectionalLight":n={direction:new pt,color:new pr};break;case"SpotLight":n={position:new pt,direction:new pt,color:new pr,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new pt,color:new pr,distance:0,decay:0};break;case"HemisphereLight":n={direction:new pt,skyColor:new pr,groundColor:new pr};break;case"RectAreaLight":n={color:new pr,position:new pt,halfWidth:new pt,halfHeight:new pt};break}return t[e.id]=n,n}}}function jG(){const t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let n;switch(e.type){case"DirectionalLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ui};break;case"SpotLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ui};break;case"PointLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ui,shadowCameraNear:1,shadowCameraFar:1e3};break}return t[e.id]=n,n}}}let qG=0;function XG(t,e){return(e.castShadow?2:0)-(t.castShadow?2:0)+(e.map?1:0)-(t.map?1:0)}function ZG(t){const e=new WG,n=jG(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let g=0;g<9;g++)i.probe.push(new pt);const r=new pt,a=new Es,u=new Es;function l(g){let y=0,S=0,b=0;for(let Z=0;Z<9;Z++)i.probe[Z].set(0,0,0);let A=0,I=0,D=0,L=0,P=0,N=0,B=0,$=0,K=0,q=0,W=0;g.sort(XG);for(let Z=0,X=g.length;Z<X;Z++){const se=g[Z],De=se.color,Se=se.intensity,Me=se.distance,Ye=se.shadow&&se.shadow.map?se.shadow.map.texture:null;if(se.isAmbientLight)y+=De.r*Se,S+=De.g*Se,b+=De.b*Se;else if(se.isLightProbe){for(let ye=0;ye<9;ye++)i.probe[ye].addScaledVector(se.sh.coefficients[ye],Se);W++}else if(se.isDirectionalLight){const ye=e.get(se);if(ye.color.copy(se.color).multiplyScalar(se.intensity),se.castShadow){const Ce=se.shadow,ge=n.get(se);ge.shadowIntensity=Ce.intensity,ge.shadowBias=Ce.bias,ge.shadowNormalBias=Ce.normalBias,ge.shadowRadius=Ce.radius,ge.shadowMapSize=Ce.mapSize,i.directionalShadow[A]=ge,i.directionalShadowMap[A]=Ye,i.directionalShadowMatrix[A]=se.shadow.matrix,N++}i.directional[A]=ye,A++}else if(se.isSpotLight){const ye=e.get(se);ye.position.setFromMatrixPosition(se.matrixWorld),ye.color.copy(De).multiplyScalar(Se),ye.distance=Me,ye.coneCos=Math.cos(se.angle),ye.penumbraCos=Math.cos(se.angle*(1-se.penumbra)),ye.decay=se.decay,i.spot[D]=ye;const Ce=se.shadow;if(se.map&&(i.spotLightMap[K]=se.map,K++,Ce.updateMatrices(se),se.castShadow&&q++),i.spotLightMatrix[D]=Ce.matrix,se.castShadow){const ge=n.get(se);ge.shadowIntensity=Ce.intensity,ge.shadowBias=Ce.bias,ge.shadowNormalBias=Ce.normalBias,ge.shadowRadius=Ce.radius,ge.shadowMapSize=Ce.mapSize,i.spotShadow[D]=ge,i.spotShadowMap[D]=Ye,$++}D++}else if(se.isRectAreaLight){const ye=e.get(se);ye.color.copy(De).multiplyScalar(Se),ye.halfWidth.set(se.width*.5,0,0),ye.halfHeight.set(0,se.height*.5,0),i.rectArea[L]=ye,L++}else if(se.isPointLight){const ye=e.get(se);if(ye.color.copy(se.color).multiplyScalar(se.intensity),ye.distance=se.distance,ye.decay=se.decay,se.castShadow){const Ce=se.shadow,ge=n.get(se);ge.shadowIntensity=Ce.intensity,ge.shadowBias=Ce.bias,ge.shadowNormalBias=Ce.normalBias,ge.shadowRadius=Ce.radius,ge.shadowMapSize=Ce.mapSize,ge.shadowCameraNear=Ce.camera.near,ge.shadowCameraFar=Ce.camera.far,i.pointShadow[I]=ge,i.pointShadowMap[I]=Ye,i.pointShadowMatrix[I]=se.shadow.matrix,B++}i.point[I]=ye,I++}else if(se.isHemisphereLight){const ye=e.get(se);ye.skyColor.copy(se.color).multiplyScalar(Se),ye.groundColor.copy(se.groundColor).multiplyScalar(Se),i.hemi[P]=ye,P++}}L>0&&(t.has("OES_texture_float_linear")===!0?(i.rectAreaLTC1=gn.LTC_FLOAT_1,i.rectAreaLTC2=gn.LTC_FLOAT_2):(i.rectAreaLTC1=gn.LTC_HALF_1,i.rectAreaLTC2=gn.LTC_HALF_2)),i.ambient[0]=y,i.ambient[1]=S,i.ambient[2]=b;const ie=i.hash;(ie.directionalLength!==A||ie.pointLength!==I||ie.spotLength!==D||ie.rectAreaLength!==L||ie.hemiLength!==P||ie.numDirectionalShadows!==N||ie.numPointShadows!==B||ie.numSpotShadows!==$||ie.numSpotMaps!==K||ie.numLightProbes!==W)&&(i.directional.length=A,i.spot.length=D,i.rectArea.length=L,i.point.length=I,i.hemi.length=P,i.directionalShadow.length=N,i.directionalShadowMap.length=N,i.pointShadow.length=B,i.pointShadowMap.length=B,i.spotShadow.length=$,i.spotShadowMap.length=$,i.directionalShadowMatrix.length=N,i.pointShadowMatrix.length=B,i.spotLightMatrix.length=$+K-q,i.spotLightMap.length=K,i.numSpotLightShadowsWithMaps=q,i.numLightProbes=W,ie.directionalLength=A,ie.pointLength=I,ie.spotLength=D,ie.rectAreaLength=L,ie.hemiLength=P,ie.numDirectionalShadows=N,ie.numPointShadows=B,ie.numSpotShadows=$,ie.numSpotMaps=K,ie.numLightProbes=W,i.version=qG++)}function f(g,y){let S=0,b=0,A=0,I=0,D=0;const L=y.matrixWorldInverse;for(let P=0,N=g.length;P<N;P++){const B=g[P];if(B.isDirectionalLight){const $=i.directional[S];$.direction.setFromMatrixPosition(B.matrixWorld),r.setFromMatrixPosition(B.target.matrixWorld),$.direction.sub(r),$.direction.transformDirection(L),S++}else if(B.isSpotLight){const $=i.spot[A];$.position.setFromMatrixPosition(B.matrixWorld),$.position.applyMatrix4(L),$.direction.setFromMatrixPosition(B.matrixWorld),r.setFromMatrixPosition(B.target.matrixWorld),$.direction.sub(r),$.direction.transformDirection(L),A++}else if(B.isRectAreaLight){const $=i.rectArea[I];$.position.setFromMatrixPosition(B.matrixWorld),$.position.applyMatrix4(L),u.identity(),a.copy(B.matrixWorld),a.premultiply(L),u.extractRotation(a),$.halfWidth.set(B.width*.5,0,0),$.halfHeight.set(0,B.height*.5,0),$.halfWidth.applyMatrix4(u),$.halfHeight.applyMatrix4(u),I++}else if(B.isPointLight){const $=i.point[b];$.position.setFromMatrixPosition(B.matrixWorld),$.position.applyMatrix4(L),b++}else if(B.isHemisphereLight){const $=i.hemi[D];$.direction.setFromMatrixPosition(B.matrixWorld),$.direction.transformDirection(L),D++}}}return{setup:l,setupView:f,state:i}}function zk(t){const e=new ZG(t),n=[],i=[];function r(y){g.camera=y,n.length=0,i.length=0}function a(y){n.push(y)}function u(y){i.push(y)}function l(){e.setup(n)}function f(y){e.setupView(n,y)}const g={lightsArray:n,shadowsArray:i,camera:null,lights:e,transmissionRenderTarget:{}};return{init:r,state:g,setupLights:l,setupLightsView:f,pushLight:a,pushShadow:u}}function YG(t){let e=new WeakMap;function n(r,a=0){const u=e.get(r);let l;return u===void 0?(l=new zk(t),e.set(r,[l])):a>=u.length?(l=new zk(t),u.push(l)):l=u[a],l}function i(){e=new WeakMap}return{get:n,dispose:i}}class KG extends A1{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=hV,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class JG extends A1{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const QG=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,eW=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function tW(t,e,n){let i=new iC;const r=new Ui,a=new Ui,u=new Us,l=new KG({depthPacking:dV}),f=new JG,g={},y=n.maxTextureSize,S={[ed]:ua,[ua]:ed,[Wu]:Wu},b=new dd({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Ui},radius:{value:4}},vertexShader:QG,fragmentShader:eW}),A=b.clone();A.defines.HORIZONTAL_PASS=1;const I=new sg;I.setAttribute("position",new qc(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const D=new oc(I,b),L=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=fL;let P=this.type;this.render=function(q,W,ie){if(L.enabled===!1||L.autoUpdate===!1&&L.needsUpdate===!1||q.length===0)return;const Z=t.getRenderTarget(),X=t.getActiveCubeFace(),se=t.getActiveMipmapLevel(),De=t.state;De.setBlending(td),De.buffers.color.setClear(1,1,1,1),De.buffers.depth.setTest(!0),De.setScissorTest(!1);const Se=P!==Gu&&this.type===Gu,Me=P===Gu&&this.type!==Gu;for(let Ye=0,ye=q.length;Ye<ye;Ye++){const Ce=q[Ye],ge=Ce.shadow;if(ge===void 0){console.warn("THREE.WebGLShadowMap:",Ce,"has no shadow.");continue}if(ge.autoUpdate===!1&&ge.needsUpdate===!1)continue;r.copy(ge.mapSize);const Be=ge.getFrameExtents();if(r.multiply(Be),a.copy(ge.mapSize),(r.x>y||r.y>y)&&(r.x>y&&(a.x=Math.floor(y/Be.x),r.x=a.x*Be.x,ge.mapSize.x=a.x),r.y>y&&(a.y=Math.floor(y/Be.y),r.y=a.y*Be.y,ge.mapSize.y=a.y)),ge.map===null||Se===!0||Me===!0){const je=this.type!==Gu?{minFilter:xl,magFilter:xl}:{};ge.map!==null&&ge.map.dispose(),ge.map=new sd(r.x,r.y,je),ge.map.texture.name=Ce.name+".shadowMap",ge.camera.updateProjectionMatrix()}t.setRenderTarget(ge.map),t.clear();const Ze=ge.getViewportCount();for(let je=0;je<Ze;je++){const wt=ge.getViewport(je);u.set(a.x*wt.x,a.y*wt.y,a.x*wt.z,a.y*wt.w),De.viewport(u),ge.updateMatrices(Ce,je),i=ge.getFrustum(),$(W,ie,ge.camera,Ce,this.type)}ge.isPointLightShadow!==!0&&this.type===Gu&&N(ge,ie),ge.needsUpdate=!1}P=this.type,L.needsUpdate=!1,t.setRenderTarget(Z,X,se)};function N(q,W){const ie=e.update(D);b.defines.VSM_SAMPLES!==q.blurSamples&&(b.defines.VSM_SAMPLES=q.blurSamples,A.defines.VSM_SAMPLES=q.blurSamples,b.needsUpdate=!0,A.needsUpdate=!0),q.mapPass===null&&(q.mapPass=new sd(r.x,r.y)),b.uniforms.shadow_pass.value=q.map.texture,b.uniforms.resolution.value=q.mapSize,b.uniforms.radius.value=q.radius,t.setRenderTarget(q.mapPass),t.clear(),t.renderBufferDirect(W,null,ie,b,D,null),A.uniforms.shadow_pass.value=q.mapPass.texture,A.uniforms.resolution.value=q.mapSize,A.uniforms.radius.value=q.radius,t.setRenderTarget(q.map),t.clear(),t.renderBufferDirect(W,null,ie,A,D,null)}function B(q,W,ie,Z){let X=null;const se=ie.isPointLight===!0?q.customDistanceMaterial:q.customDepthMaterial;if(se!==void 0)X=se;else if(X=ie.isPointLight===!0?f:l,t.localClippingEnabled&&W.clipShadows===!0&&Array.isArray(W.clippingPlanes)&&W.clippingPlanes.length!==0||W.displacementMap&&W.displacementScale!==0||W.alphaMap&&W.alphaTest>0||W.map&&W.alphaTest>0){const De=X.uuid,Se=W.uuid;let Me=g[De];Me===void 0&&(Me={},g[De]=Me);let Ye=Me[Se];Ye===void 0&&(Ye=X.clone(),Me[Se]=Ye,W.addEventListener("dispose",K)),X=Ye}if(X.visible=W.visible,X.wireframe=W.wireframe,Z===Gu?X.side=W.shadowSide!==null?W.shadowSide:W.side:X.side=W.shadowSide!==null?W.shadowSide:S[W.side],X.alphaMap=W.alphaMap,X.alphaTest=W.alphaTest,X.map=W.map,X.clipShadows=W.clipShadows,X.clippingPlanes=W.clippingPlanes,X.clipIntersection=W.clipIntersection,X.displacementMap=W.displacementMap,X.displacementScale=W.displacementScale,X.displacementBias=W.displacementBias,X.wireframeLinewidth=W.wireframeLinewidth,X.linewidth=W.linewidth,ie.isPointLight===!0&&X.isMeshDistanceMaterial===!0){const De=t.properties.get(X);De.light=ie}return X}function $(q,W,ie,Z,X){if(q.visible===!1)return;if(q.layers.test(W.layers)&&(q.isMesh||q.isLine||q.isPoints)&&(q.castShadow||q.receiveShadow&&X===Gu)&&(!q.frustumCulled||i.intersectsObject(q))){q.modelViewMatrix.multiplyMatrices(ie.matrixWorldInverse,q.matrixWorld);const Se=e.update(q),Me=q.material;if(Array.isArray(Me)){const Ye=Se.groups;for(let ye=0,Ce=Ye.length;ye<Ce;ye++){const ge=Ye[ye],Be=Me[ge.materialIndex];if(Be&&Be.visible){const Ze=B(q,Be,Z,X);q.onBeforeShadow(t,q,W,ie,Se,Ze,ge),t.renderBufferDirect(ie,null,Se,Ze,q,ge),q.onAfterShadow(t,q,W,ie,Se,Ze,ge)}}}else if(Me.visible){const Ye=B(q,Me,Z,X);q.onBeforeShadow(t,q,W,ie,Se,Ye,null),t.renderBufferDirect(ie,null,Se,Ye,q,null),q.onAfterShadow(t,q,W,ie,Se,Ye,null)}}const De=q.children;for(let Se=0,Me=De.length;Se<Me;Se++)$(De[Se],W,ie,Z,X)}function K(q){q.target.removeEventListener("dispose",K);for(const ie in g){const Z=g[ie],X=q.target.uuid;X in Z&&(Z[X].dispose(),delete Z[X])}}}function nW(t){function e(){let Ne=!1;const Gt=new Us;let Et=null;const Ct=new Us(0,0,0,0);return{setMask:function(Zt){Et!==Zt&&!Ne&&(t.colorMask(Zt,Zt,Zt,Zt),Et=Zt)},setLocked:function(Zt){Ne=Zt},setClear:function(Zt,xe,te,ne,de){de===!0&&(Zt*=ne,xe*=ne,te*=ne),Gt.set(Zt,xe,te,ne),Ct.equals(Gt)===!1&&(t.clearColor(Zt,xe,te,ne),Ct.copy(Gt))},reset:function(){Ne=!1,Et=null,Ct.set(-1,0,0,0)}}}function n(){let Ne=!1,Gt=null,Et=null,Ct=null;return{setTest:function(Zt){Zt?zt(t.DEPTH_TEST):Rt(t.DEPTH_TEST)},setMask:function(Zt){Gt!==Zt&&!Ne&&(t.depthMask(Zt),Gt=Zt)},setFunc:function(Zt){if(Et!==Zt){switch(Zt){case X9:t.depthFunc(t.NEVER);break;case Z9:t.depthFunc(t.ALWAYS);break;case Y9:t.depthFunc(t.LESS);break;case s1:t.depthFunc(t.LEQUAL);break;case K9:t.depthFunc(t.EQUAL);break;case J9:t.depthFunc(t.GEQUAL);break;case Q9:t.depthFunc(t.GREATER);break;case eV:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}Et=Zt}},setLocked:function(Zt){Ne=Zt},setClear:function(Zt){Ct!==Zt&&(t.clearDepth(Zt),Ct=Zt)},reset:function(){Ne=!1,Gt=null,Et=null,Ct=null}}}function i(){let Ne=!1,Gt=null,Et=null,Ct=null,Zt=null,xe=null,te=null,ne=null,de=null;return{setTest:function(we){Ne||(we?zt(t.STENCIL_TEST):Rt(t.STENCIL_TEST))},setMask:function(we){Gt!==we&&!Ne&&(t.stencilMask(we),Gt=we)},setFunc:function(we,Fe,He){(Et!==we||Ct!==Fe||Zt!==He)&&(t.stencilFunc(we,Fe,He),Et=we,Ct=Fe,Zt=He)},setOp:function(we,Fe,He){(xe!==we||te!==Fe||ne!==He)&&(t.stencilOp(we,Fe,He),xe=we,te=Fe,ne=He)},setLocked:function(we){Ne=we},setClear:function(we){de!==we&&(t.clearStencil(we),de=we)},reset:function(){Ne=!1,Gt=null,Et=null,Ct=null,Zt=null,xe=null,te=null,ne=null,de=null}}}const r=new e,a=new n,u=new i,l=new WeakMap,f=new WeakMap;let g={},y={},S=new WeakMap,b=[],A=null,I=!1,D=null,L=null,P=null,N=null,B=null,$=null,K=null,q=new pr(0,0,0),W=0,ie=!1,Z=null,X=null,se=null,De=null,Se=null;const Me=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let Ye=!1,ye=0;const Ce=t.getParameter(t.VERSION);Ce.indexOf("WebGL")!==-1?(ye=parseFloat(/^WebGL (\d)/.exec(Ce)[1]),Ye=ye>=1):Ce.indexOf("OpenGL ES")!==-1&&(ye=parseFloat(/^OpenGL ES (\d)/.exec(Ce)[1]),Ye=ye>=2);let ge=null,Be={};const Ze=t.getParameter(t.SCISSOR_BOX),je=t.getParameter(t.VIEWPORT),wt=new Us().fromArray(Ze),Xt=new Us().fromArray(je);function Ke(Ne,Gt,Et,Ct){const Zt=new Uint8Array(4),xe=t.createTexture();t.bindTexture(Ne,xe),t.texParameteri(Ne,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(Ne,t.TEXTURE_MAG_FILTER,t.NEAREST);for(let te=0;te<Et;te++)Ne===t.TEXTURE_3D||Ne===t.TEXTURE_2D_ARRAY?t.texImage3D(Gt,0,t.RGBA,1,1,Ct,0,t.RGBA,t.UNSIGNED_BYTE,Zt):t.texImage2D(Gt+te,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,Zt);return xe}const _t={};_t[t.TEXTURE_2D]=Ke(t.TEXTURE_2D,t.TEXTURE_2D,1),_t[t.TEXTURE_CUBE_MAP]=Ke(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),_t[t.TEXTURE_2D_ARRAY]=Ke(t.TEXTURE_2D_ARRAY,t.TEXTURE_2D_ARRAY,1,1),_t[t.TEXTURE_3D]=Ke(t.TEXTURE_3D,t.TEXTURE_3D,1,1),r.setClear(0,0,0,1),a.setClear(1),u.setClear(0),zt(t.DEPTH_TEST),a.setFunc(s1),Cn(!1),Ue(dL),zt(t.CULL_FACE),Jn(td);function zt(Ne){g[Ne]!==!0&&(t.enable(Ne),g[Ne]=!0)}function Rt(Ne){g[Ne]!==!1&&(t.disable(Ne),g[Ne]=!1)}function fn(Ne,Gt){return y[Ne]!==Gt?(t.bindFramebuffer(Ne,Gt),y[Ne]=Gt,Ne===t.DRAW_FRAMEBUFFER&&(y[t.FRAMEBUFFER]=Gt),Ne===t.FRAMEBUFFER&&(y[t.DRAW_FRAMEBUFFER]=Gt),!0):!1}function Mn(Ne,Gt){let Et=b,Ct=!1;if(Ne){Et=S.get(Gt),Et===void 0&&(Et=[],S.set(Gt,Et));const Zt=Ne.textures;if(Et.length!==Zt.length||Et[0]!==t.COLOR_ATTACHMENT0){for(let xe=0,te=Zt.length;xe<te;xe++)Et[xe]=t.COLOR_ATTACHMENT0+xe;Et.length=Zt.length,Ct=!0}}else Et[0]!==t.BACK&&(Et[0]=t.BACK,Ct=!0);Ct&&t.drawBuffers(Et)}function Bt(Ne){return A!==Ne?(t.useProgram(Ne),A=Ne,!0):!1}const Kn={[qf]:t.FUNC_ADD,[R9]:t.FUNC_SUBTRACT,[L9]:t.FUNC_REVERSE_SUBTRACT};Kn[k9]=t.MIN,Kn[D9]=t.MAX;const Re={[O9]:t.ZERO,[F9]:t.ONE,[z9]:t.SRC_COLOR,[YE]:t.SRC_ALPHA,[H9]:t.SRC_ALPHA_SATURATE,[V9]:t.DST_COLOR,[B9]:t.DST_ALPHA,[N9]:t.ONE_MINUS_SRC_COLOR,[KE]:t.ONE_MINUS_SRC_ALPHA,[$9]:t.ONE_MINUS_DST_COLOR,[U9]:t.ONE_MINUS_DST_ALPHA,[G9]:t.CONSTANT_COLOR,[W9]:t.ONE_MINUS_CONSTANT_COLOR,[j9]:t.CONSTANT_ALPHA,[q9]:t.ONE_MINUS_CONSTANT_ALPHA};function Jn(Ne,Gt,Et,Ct,Zt,xe,te,ne,de,we){if(Ne===td){I===!0&&(Rt(t.BLEND),I=!1);return}if(I===!1&&(zt(t.BLEND),I=!0),Ne!==I9){if(Ne!==D||we!==ie){if((L!==qf||B!==qf)&&(t.blendEquation(t.FUNC_ADD),L=qf,B=qf),we)switch(Ne){case Fm:t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case pL:t.blendFunc(t.ONE,t.ONE);break;case mL:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case gL:t.blendFuncSeparate(t.ZERO,t.SRC_COLOR,t.ZERO,t.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",Ne);break}else switch(Ne){case Fm:t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case pL:t.blendFunc(t.SRC_ALPHA,t.ONE);break;case mL:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case gL:t.blendFunc(t.ZERO,t.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",Ne);break}P=null,N=null,$=null,K=null,q.set(0,0,0),W=0,D=Ne,ie=we}return}Zt=Zt||Gt,xe=xe||Et,te=te||Ct,(Gt!==L||Zt!==B)&&(t.blendEquationSeparate(Kn[Gt],Kn[Zt]),L=Gt,B=Zt),(Et!==P||Ct!==N||xe!==$||te!==K)&&(t.blendFuncSeparate(Re[Et],Re[Ct],Re[xe],Re[te]),P=Et,N=Ct,$=xe,K=te),(ne.equals(q)===!1||de!==W)&&(t.blendColor(ne.r,ne.g,ne.b,de),q.copy(ne),W=de),D=Ne,ie=!1}function Ln(Ne,Gt){Ne.side===Wu?Rt(t.CULL_FACE):zt(t.CULL_FACE);let Et=Ne.side===ua;Gt&&(Et=!Et),Cn(Et),Ne.blending===Fm&&Ne.transparent===!1?Jn(td):Jn(Ne.blending,Ne.blendEquation,Ne.blendSrc,Ne.blendDst,Ne.blendEquationAlpha,Ne.blendSrcAlpha,Ne.blendDstAlpha,Ne.blendColor,Ne.blendAlpha,Ne.premultipliedAlpha),a.setFunc(Ne.depthFunc),a.setTest(Ne.depthTest),a.setMask(Ne.depthWrite),r.setMask(Ne.colorWrite);const Ct=Ne.stencilWrite;u.setTest(Ct),Ct&&(u.setMask(Ne.stencilWriteMask),u.setFunc(Ne.stencilFunc,Ne.stencilRef,Ne.stencilFuncMask),u.setOp(Ne.stencilFail,Ne.stencilZFail,Ne.stencilZPass)),Pt(Ne.polygonOffset,Ne.polygonOffsetFactor,Ne.polygonOffsetUnits),Ne.alphaToCoverage===!0?zt(t.SAMPLE_ALPHA_TO_COVERAGE):Rt(t.SAMPLE_ALPHA_TO_COVERAGE)}function Cn(Ne){Z!==Ne&&(Ne?t.frontFace(t.CW):t.frontFace(t.CCW),Z=Ne)}function Ue(Ne){Ne!==Om?(zt(t.CULL_FACE),Ne!==X&&(Ne===dL?t.cullFace(t.BACK):Ne===A9?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):Rt(t.CULL_FACE),X=Ne}function xt(Ne){Ne!==se&&(Ye&&t.lineWidth(Ne),se=Ne)}function Pt(Ne,Gt,Et){Ne?(zt(t.POLYGON_OFFSET_FILL),(De!==Gt||Se!==Et)&&(t.polygonOffset(Gt,Et),De=Gt,Se=Et)):Rt(t.POLYGON_OFFSET_FILL)}function mt(Ne){Ne?zt(t.SCISSOR_TEST):Rt(t.SCISSOR_TEST)}function ve(Ne){Ne===void 0&&(Ne=t.TEXTURE0+Me-1),ge!==Ne&&(t.activeTexture(Ne),ge=Ne)}function re(Ne,Gt,Et){Et===void 0&&(ge===null?Et=t.TEXTURE0+Me-1:Et=ge);let Ct=Be[Et];Ct===void 0&&(Ct={type:void 0,texture:void 0},Be[Et]=Ct),(Ct.type!==Ne||Ct.texture!==Gt)&&(ge!==Et&&(t.activeTexture(Et),ge=Et),t.bindTexture(Ne,Gt||_t[Ne]),Ct.type=Ne,Ct.texture=Gt)}function Xe(){const Ne=Be[ge];Ne!==void 0&&Ne.type!==void 0&&(t.bindTexture(Ne.type,null),Ne.type=void 0,Ne.texture=void 0)}function Ge(){try{t.compressedTexImage2D.apply(t,arguments)}catch(Ne){console.error("THREE.WebGLState:",Ne)}}function st(){try{t.compressedTexImage3D.apply(t,arguments)}catch(Ne){console.error("THREE.WebGLState:",Ne)}}function ft(){try{t.texSubImage2D.apply(t,arguments)}catch(Ne){console.error("THREE.WebGLState:",Ne)}}function Ht(){try{t.texSubImage3D.apply(t,arguments)}catch(Ne){console.error("THREE.WebGLState:",Ne)}}function $t(){try{t.compressedTexSubImage2D.apply(t,arguments)}catch(Ne){console.error("THREE.WebGLState:",Ne)}}function it(){try{t.compressedTexSubImage3D.apply(t,arguments)}catch(Ne){console.error("THREE.WebGLState:",Ne)}}function On(){try{t.texStorage2D.apply(t,arguments)}catch(Ne){console.error("THREE.WebGLState:",Ne)}}function Nt(){try{t.texStorage3D.apply(t,arguments)}catch(Ne){console.error("THREE.WebGLState:",Ne)}}function on(){try{t.texImage2D.apply(t,arguments)}catch(Ne){console.error("THREE.WebGLState:",Ne)}}function Wn(){try{t.texImage3D.apply(t,arguments)}catch(Ne){console.error("THREE.WebGLState:",Ne)}}function yt(Ne){wt.equals(Ne)===!1&&(t.scissor(Ne.x,Ne.y,Ne.z,Ne.w),wt.copy(Ne))}function Tt(Ne){Xt.equals(Ne)===!1&&(t.viewport(Ne.x,Ne.y,Ne.z,Ne.w),Xt.copy(Ne))}function Vt(Ne,Gt){let Et=f.get(Gt);Et===void 0&&(Et=new WeakMap,f.set(Gt,Et));let Ct=Et.get(Ne);Ct===void 0&&(Ct=t.getUniformBlockIndex(Gt,Ne.name),Et.set(Ne,Ct))}function kn(Ne,Gt){const Ct=f.get(Gt).get(Ne);l.get(Gt)!==Ct&&(t.uniformBlockBinding(Gt,Ct,Ne.__bindingPointIndex),l.set(Gt,Ct))}function ii(){t.disable(t.BLEND),t.disable(t.CULL_FACE),t.disable(t.DEPTH_TEST),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SCISSOR_TEST),t.disable(t.STENCIL_TEST),t.disable(t.SAMPLE_ALPHA_TO_COVERAGE),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ZERO),t.blendFuncSeparate(t.ONE,t.ZERO,t.ONE,t.ZERO),t.blendColor(0,0,0,0),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(t.LESS),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(t.ALWAYS,0,4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.clearStencil(0),t.cullFace(t.BACK),t.frontFace(t.CCW),t.polygonOffset(0,0),t.activeTexture(t.TEXTURE0),t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),t.bindFramebuffer(t.READ_FRAMEBUFFER,null),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),g={},ge=null,Be={},y={},S=new WeakMap,b=[],A=null,I=!1,D=null,L=null,P=null,N=null,B=null,$=null,K=null,q=new pr(0,0,0),W=0,ie=!1,Z=null,X=null,se=null,De=null,Se=null,wt.set(0,0,t.canvas.width,t.canvas.height),Xt.set(0,0,t.canvas.width,t.canvas.height),r.reset(),a.reset(),u.reset()}return{buffers:{color:r,depth:a,stencil:u},enable:zt,disable:Rt,bindFramebuffer:fn,drawBuffers:Mn,useProgram:Bt,setBlending:Jn,setMaterial:Ln,setFlipSided:Cn,setCullFace:Ue,setLineWidth:xt,setPolygonOffset:Pt,setScissorTest:mt,activeTexture:ve,bindTexture:re,unbindTexture:Xe,compressedTexImage2D:Ge,compressedTexImage3D:st,texImage2D:on,texImage3D:Wn,updateUBOMapping:Vt,uniformBlockBinding:kn,texStorage2D:On,texStorage3D:Nt,texSubImage2D:ft,texSubImage3D:Ht,compressedTexSubImage2D:$t,compressedTexSubImage3D:it,scissor:yt,viewport:Tt,reset:ii}}function Nk(t,e,n,i){const r=iW(i);switch(n){case wL:return t*e;case EL:return t*e;case ML:return t*e*2;case CL:return t*e/r.components*r.byteLength;case oM:return t*e/r.components*r.byteLength;case TL:return t*e*2/r.components*r.byteLength;case aM:return t*e*2/r.components*r.byteLength;case SL:return t*e*3/r.components*r.byteLength;case tc:return t*e*4/r.components*r.byteLength;case lM:return t*e*4/r.components*r.byteLength;case l1:case c1:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*8;case u1:case h1:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case uM:case dM:return Math.max(t,16)*Math.max(e,8)/4;case cM:case hM:return Math.max(t,8)*Math.max(e,8)/2;case fM:case pM:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*8;case mM:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case gM:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case vM:return Math.floor((t+4)/5)*Math.floor((e+3)/4)*16;case yM:return Math.floor((t+4)/5)*Math.floor((e+4)/5)*16;case _M:return Math.floor((t+5)/6)*Math.floor((e+4)/5)*16;case xM:return Math.floor((t+5)/6)*Math.floor((e+5)/6)*16;case bM:return Math.floor((t+7)/8)*Math.floor((e+4)/5)*16;case wM:return Math.floor((t+7)/8)*Math.floor((e+5)/6)*16;case SM:return Math.floor((t+7)/8)*Math.floor((e+7)/8)*16;case EM:return Math.floor((t+9)/10)*Math.floor((e+4)/5)*16;case MM:return Math.floor((t+9)/10)*Math.floor((e+5)/6)*16;case CM:return Math.floor((t+9)/10)*Math.floor((e+7)/8)*16;case TM:return Math.floor((t+9)/10)*Math.floor((e+9)/10)*16;case AM:return Math.floor((t+11)/12)*Math.floor((e+9)/10)*16;case PM:return Math.floor((t+11)/12)*Math.floor((e+11)/12)*16;case d1:case IM:case RM:return Math.ceil(t/4)*Math.ceil(e/4)*16;case AL:case LM:return Math.ceil(t/4)*Math.ceil(e/4)*8;case kM:case DM:return Math.ceil(t/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${n} format.`)}function iW(t){switch(t){case ju:case _L:return{byteLength:1,components:1};case K0:case xL:case J0:return{byteLength:2,components:1};case rM:case sM:return{byteLength:2,components:4};case Zf:case iM:case qu:return{byteLength:4,components:1};case bL:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${t}.`)}function rW(t,e,n,i,r,a,u){const l=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,f=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),g=new Ui,y=new WeakMap;let S;const b=new WeakMap;let A=!1;try{A=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function I(ve,re){return A?new OffscreenCanvas(ve,re):y1("canvas")}function D(ve,re,Xe){let Ge=1;const st=mt(ve);if((st.width>Xe||st.height>Xe)&&(Ge=Xe/Math.max(st.width,st.height)),Ge<1)if(typeof HTMLImageElement<"u"&&ve instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&ve instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&ve instanceof ImageBitmap||typeof VideoFrame<"u"&&ve instanceof VideoFrame){const ft=Math.floor(Ge*st.width),Ht=Math.floor(Ge*st.height);S===void 0&&(S=I(ft,Ht));const $t=re?I(ft,Ht):S;return $t.width=ft,$t.height=Ht,$t.getContext("2d").drawImage(ve,0,0,ft,Ht),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+st.width+"x"+st.height+") to ("+ft+"x"+Ht+")."),$t}else return"data"in ve&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+st.width+"x"+st.height+")."),ve;return ve}function L(ve){return ve.generateMipmaps&&ve.minFilter!==xl&&ve.minFilter!==bl}function P(ve){t.generateMipmap(ve)}function N(ve,re,Xe,Ge,st=!1){if(ve!==null){if(t[ve]!==void 0)return t[ve];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+ve+"'")}let ft=re;if(re===t.RED&&(Xe===t.FLOAT&&(ft=t.R32F),Xe===t.HALF_FLOAT&&(ft=t.R16F),Xe===t.UNSIGNED_BYTE&&(ft=t.R8)),re===t.RED_INTEGER&&(Xe===t.UNSIGNED_BYTE&&(ft=t.R8UI),Xe===t.UNSIGNED_SHORT&&(ft=t.R16UI),Xe===t.UNSIGNED_INT&&(ft=t.R32UI),Xe===t.BYTE&&(ft=t.R8I),Xe===t.SHORT&&(ft=t.R16I),Xe===t.INT&&(ft=t.R32I)),re===t.RG&&(Xe===t.FLOAT&&(ft=t.RG32F),Xe===t.HALF_FLOAT&&(ft=t.RG16F),Xe===t.UNSIGNED_BYTE&&(ft=t.RG8)),re===t.RG_INTEGER&&(Xe===t.UNSIGNED_BYTE&&(ft=t.RG8UI),Xe===t.UNSIGNED_SHORT&&(ft=t.RG16UI),Xe===t.UNSIGNED_INT&&(ft=t.RG32UI),Xe===t.BYTE&&(ft=t.RG8I),Xe===t.SHORT&&(ft=t.RG16I),Xe===t.INT&&(ft=t.RG32I)),re===t.RGB&&Xe===t.UNSIGNED_INT_5_9_9_9_REV&&(ft=t.RGB9_E5),re===t.RGBA){const Ht=st?p1:Ki.getTransfer(Ge);Xe===t.FLOAT&&(ft=t.RGBA32F),Xe===t.HALF_FLOAT&&(ft=t.RGBA16F),Xe===t.UNSIGNED_BYTE&&(ft=Ht===Mr?t.SRGB8_ALPHA8:t.RGBA8),Xe===t.UNSIGNED_SHORT_4_4_4_4&&(ft=t.RGBA4),Xe===t.UNSIGNED_SHORT_5_5_5_1&&(ft=t.RGB5_A1)}return(ft===t.R16F||ft===t.R32F||ft===t.RG16F||ft===t.RG32F||ft===t.RGBA16F||ft===t.RGBA32F)&&e.get("EXT_color_buffer_float"),ft}function B(ve,re){let Xe;return ve?re===null||re===Zf||re===Bm?Xe=t.DEPTH24_STENCIL8:re===qu?Xe=t.DEPTH32F_STENCIL8:re===K0&&(Xe=t.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):re===null||re===Zf||re===Bm?Xe=t.DEPTH_COMPONENT24:re===qu?Xe=t.DEPTH_COMPONENT32F:re===K0&&(Xe=t.DEPTH_COMPONENT16),Xe}function $(ve,re){return L(ve)===!0||ve.isFramebufferTexture&&ve.minFilter!==xl&&ve.minFilter!==bl?Math.log2(Math.max(re.width,re.height))+1:ve.mipmaps!==void 0&&ve.mipmaps.length>0?ve.mipmaps.length:ve.isCompressedTexture&&Array.isArray(ve.image)?re.mipmaps.length:1}function K(ve){const re=ve.target;re.removeEventListener("dispose",K),W(re),re.isVideoTexture&&y.delete(re)}function q(ve){const re=ve.target;re.removeEventListener("dispose",q),Z(re)}function W(ve){const re=i.get(ve);if(re.__webglInit===void 0)return;const Xe=ve.source,Ge=b.get(Xe);if(Ge){const st=Ge[re.__cacheKey];st.usedTimes--,st.usedTimes===0&&ie(ve),Object.keys(Ge).length===0&&b.delete(Xe)}i.remove(ve)}function ie(ve){const re=i.get(ve);t.deleteTexture(re.__webglTexture);const Xe=ve.source,Ge=b.get(Xe);delete Ge[re.__cacheKey],u.memory.textures--}function Z(ve){const re=i.get(ve);if(ve.depthTexture&&ve.depthTexture.dispose(),ve.isWebGLCubeRenderTarget)for(let Ge=0;Ge<6;Ge++){if(Array.isArray(re.__webglFramebuffer[Ge]))for(let st=0;st<re.__webglFramebuffer[Ge].length;st++)t.deleteFramebuffer(re.__webglFramebuffer[Ge][st]);else t.deleteFramebuffer(re.__webglFramebuffer[Ge]);re.__webglDepthbuffer&&t.deleteRenderbuffer(re.__webglDepthbuffer[Ge])}else{if(Array.isArray(re.__webglFramebuffer))for(let Ge=0;Ge<re.__webglFramebuffer.length;Ge++)t.deleteFramebuffer(re.__webglFramebuffer[Ge]);else t.deleteFramebuffer(re.__webglFramebuffer);if(re.__webglDepthbuffer&&t.deleteRenderbuffer(re.__webglDepthbuffer),re.__webglMultisampledFramebuffer&&t.deleteFramebuffer(re.__webglMultisampledFramebuffer),re.__webglColorRenderbuffer)for(let Ge=0;Ge<re.__webglColorRenderbuffer.length;Ge++)re.__webglColorRenderbuffer[Ge]&&t.deleteRenderbuffer(re.__webglColorRenderbuffer[Ge]);re.__webglDepthRenderbuffer&&t.deleteRenderbuffer(re.__webglDepthRenderbuffer)}const Xe=ve.textures;for(let Ge=0,st=Xe.length;Ge<st;Ge++){const ft=i.get(Xe[Ge]);ft.__webglTexture&&(t.deleteTexture(ft.__webglTexture),u.memory.textures--),i.remove(Xe[Ge])}i.remove(ve)}let X=0;function se(){X=0}function De(){const ve=X;return ve>=r.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+ve+" texture units while this GPU supports only "+r.maxTextures),X+=1,ve}function Se(ve){const re=[];return re.push(ve.wrapS),re.push(ve.wrapT),re.push(ve.wrapR||0),re.push(ve.magFilter),re.push(ve.minFilter),re.push(ve.anisotropy),re.push(ve.internalFormat),re.push(ve.format),re.push(ve.type),re.push(ve.generateMipmaps),re.push(ve.premultiplyAlpha),re.push(ve.flipY),re.push(ve.unpackAlignment),re.push(ve.colorSpace),re.join()}function Me(ve,re){const Xe=i.get(ve);if(ve.isVideoTexture&&xt(ve),ve.isRenderTargetTexture===!1&&ve.version>0&&Xe.__version!==ve.version){const Ge=ve.image;if(Ge===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(Ge.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{Xt(Xe,ve,re);return}}n.bindTexture(t.TEXTURE_2D,Xe.__webglTexture,t.TEXTURE0+re)}function Ye(ve,re){const Xe=i.get(ve);if(ve.version>0&&Xe.__version!==ve.version){Xt(Xe,ve,re);return}n.bindTexture(t.TEXTURE_2D_ARRAY,Xe.__webglTexture,t.TEXTURE0+re)}function ye(ve,re){const Xe=i.get(ve);if(ve.version>0&&Xe.__version!==ve.version){Xt(Xe,ve,re);return}n.bindTexture(t.TEXTURE_3D,Xe.__webglTexture,t.TEXTURE0+re)}function Ce(ve,re){const Xe=i.get(ve);if(ve.version>0&&Xe.__version!==ve.version){Ke(Xe,ve,re);return}n.bindTexture(t.TEXTURE_CUBE_MAP,Xe.__webglTexture,t.TEXTURE0+re)}const ge={[eM]:t.REPEAT,[Xf]:t.CLAMP_TO_EDGE,[tM]:t.MIRRORED_REPEAT},Be={[xl]:t.NEAREST,[uV]:t.NEAREST_MIPMAP_NEAREST,[a1]:t.NEAREST_MIPMAP_LINEAR,[bl]:t.LINEAR,[nM]:t.LINEAR_MIPMAP_NEAREST,[id]:t.LINEAR_MIPMAP_LINEAR},Ze={[mV]:t.NEVER,[bV]:t.ALWAYS,[gV]:t.LESS,[IL]:t.LEQUAL,[vV]:t.EQUAL,[xV]:t.GEQUAL,[yV]:t.GREATER,[_V]:t.NOTEQUAL};function je(ve,re){if(re.type===qu&&e.has("OES_texture_float_linear")===!1&&(re.magFilter===bl||re.magFilter===nM||re.magFilter===a1||re.magFilter===id||re.minFilter===bl||re.minFilter===nM||re.minFilter===a1||re.minFilter===id)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),t.texParameteri(ve,t.TEXTURE_WRAP_S,ge[re.wrapS]),t.texParameteri(ve,t.TEXTURE_WRAP_T,ge[re.wrapT]),(ve===t.TEXTURE_3D||ve===t.TEXTURE_2D_ARRAY)&&t.texParameteri(ve,t.TEXTURE_WRAP_R,ge[re.wrapR]),t.texParameteri(ve,t.TEXTURE_MAG_FILTER,Be[re.magFilter]),t.texParameteri(ve,t.TEXTURE_MIN_FILTER,Be[re.minFilter]),re.compareFunction&&(t.texParameteri(ve,t.TEXTURE_COMPARE_MODE,t.COMPARE_REF_TO_TEXTURE),t.texParameteri(ve,t.TEXTURE_COMPARE_FUNC,Ze[re.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(re.magFilter===xl||re.minFilter!==a1&&re.minFilter!==id||re.type===qu&&e.has("OES_texture_float_linear")===!1)return;if(re.anisotropy>1||i.get(re).__currentAnisotropy){const Xe=e.get("EXT_texture_filter_anisotropic");t.texParameterf(ve,Xe.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(re.anisotropy,r.getMaxAnisotropy())),i.get(re).__currentAnisotropy=re.anisotropy}}}function wt(ve,re){let Xe=!1;ve.__webglInit===void 0&&(ve.__webglInit=!0,re.addEventListener("dispose",K));const Ge=re.source;let st=b.get(Ge);st===void 0&&(st={},b.set(Ge,st));const ft=Se(re);if(ft!==ve.__cacheKey){st[ft]===void 0&&(st[ft]={texture:t.createTexture(),usedTimes:0},u.memory.textures++,Xe=!0),st[ft].usedTimes++;const Ht=st[ve.__cacheKey];Ht!==void 0&&(st[ve.__cacheKey].usedTimes--,Ht.usedTimes===0&&ie(re)),ve.__cacheKey=ft,ve.__webglTexture=st[ft].texture}return Xe}function Xt(ve,re,Xe){let Ge=t.TEXTURE_2D;(re.isDataArrayTexture||re.isCompressedArrayTexture)&&(Ge=t.TEXTURE_2D_ARRAY),re.isData3DTexture&&(Ge=t.TEXTURE_3D);const st=wt(ve,re),ft=re.source;n.bindTexture(Ge,ve.__webglTexture,t.TEXTURE0+Xe);const Ht=i.get(ft);if(ft.version!==Ht.__version||st===!0){n.activeTexture(t.TEXTURE0+Xe);const $t=Ki.getPrimaries(Ki.workingColorSpace),it=re.colorSpace===rd?null:Ki.getPrimaries(re.colorSpace),On=re.colorSpace===rd||$t===it?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,re.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,re.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,re.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,On);let Nt=D(re.image,!1,r.maxTextureSize);Nt=Pt(re,Nt);const on=a.convert(re.format,re.colorSpace),Wn=a.convert(re.type);let yt=N(re.internalFormat,on,Wn,re.colorSpace,re.isVideoTexture);je(Ge,re);let Tt;const Vt=re.mipmaps,kn=re.isVideoTexture!==!0,ii=Ht.__version===void 0||st===!0,Ne=ft.dataReady,Gt=$(re,Nt);if(re.isDepthTexture)yt=B(re.format===Vm,re.type),ii&&(kn?n.texStorage2D(t.TEXTURE_2D,1,yt,Nt.width,Nt.height):n.texImage2D(t.TEXTURE_2D,0,yt,Nt.width,Nt.height,0,on,Wn,null));else if(re.isDataTexture)if(Vt.length>0){kn&&ii&&n.texStorage2D(t.TEXTURE_2D,Gt,yt,Vt[0].width,Vt[0].height);for(let Et=0,Ct=Vt.length;Et<Ct;Et++)Tt=Vt[Et],kn?Ne&&n.texSubImage2D(t.TEXTURE_2D,Et,0,0,Tt.width,Tt.height,on,Wn,Tt.data):n.texImage2D(t.TEXTURE_2D,Et,yt,Tt.width,Tt.height,0,on,Wn,Tt.data);re.generateMipmaps=!1}else kn?(ii&&n.texStorage2D(t.TEXTURE_2D,Gt,yt,Nt.width,Nt.height),Ne&&n.texSubImage2D(t.TEXTURE_2D,0,0,0,Nt.width,Nt.height,on,Wn,Nt.data)):n.texImage2D(t.TEXTURE_2D,0,yt,Nt.width,Nt.height,0,on,Wn,Nt.data);else if(re.isCompressedTexture)if(re.isCompressedArrayTexture){kn&&ii&&n.texStorage3D(t.TEXTURE_2D_ARRAY,Gt,yt,Vt[0].width,Vt[0].height,Nt.depth);for(let Et=0,Ct=Vt.length;Et<Ct;Et++)if(Tt=Vt[Et],re.format!==tc)if(on!==null)if(kn){if(Ne)if(re.layerUpdates.size>0){const Zt=Nk(Tt.width,Tt.height,re.format,re.type);for(const xe of re.layerUpdates){const te=Tt.data.subarray(xe*Zt/Tt.data.BYTES_PER_ELEMENT,(xe+1)*Zt/Tt.data.BYTES_PER_ELEMENT);n.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,Et,0,0,xe,Tt.width,Tt.height,1,on,te,0,0)}re.clearLayerUpdates()}else n.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,Et,0,0,0,Tt.width,Tt.height,Nt.depth,on,Tt.data,0,0)}else n.compressedTexImage3D(t.TEXTURE_2D_ARRAY,Et,yt,Tt.width,Tt.height,Nt.depth,0,Tt.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else kn?Ne&&n.texSubImage3D(t.TEXTURE_2D_ARRAY,Et,0,0,0,Tt.width,Tt.height,Nt.depth,on,Wn,Tt.data):n.texImage3D(t.TEXTURE_2D_ARRAY,Et,yt,Tt.width,Tt.height,Nt.depth,0,on,Wn,Tt.data)}else{kn&&ii&&n.texStorage2D(t.TEXTURE_2D,Gt,yt,Vt[0].width,Vt[0].height);for(let Et=0,Ct=Vt.length;Et<Ct;Et++)Tt=Vt[Et],re.format!==tc?on!==null?kn?Ne&&n.compressedTexSubImage2D(t.TEXTURE_2D,Et,0,0,Tt.width,Tt.height,on,Tt.data):n.compressedTexImage2D(t.TEXTURE_2D,Et,yt,Tt.width,Tt.height,0,Tt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):kn?Ne&&n.texSubImage2D(t.TEXTURE_2D,Et,0,0,Tt.width,Tt.height,on,Wn,Tt.data):n.texImage2D(t.TEXTURE_2D,Et,yt,Tt.width,Tt.height,0,on,Wn,Tt.data)}else if(re.isDataArrayTexture)if(kn){if(ii&&n.texStorage3D(t.TEXTURE_2D_ARRAY,Gt,yt,Nt.width,Nt.height,Nt.depth),Ne)if(re.layerUpdates.size>0){const Et=Nk(Nt.width,Nt.height,re.format,re.type);for(const Ct of re.layerUpdates){const Zt=Nt.data.subarray(Ct*Et/Nt.data.BYTES_PER_ELEMENT,(Ct+1)*Et/Nt.data.BYTES_PER_ELEMENT);n.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,Ct,Nt.width,Nt.height,1,on,Wn,Zt)}re.clearLayerUpdates()}else n.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,0,Nt.width,Nt.height,Nt.depth,on,Wn,Nt.data)}else n.texImage3D(t.TEXTURE_2D_ARRAY,0,yt,Nt.width,Nt.height,Nt.depth,0,on,Wn,Nt.data);else if(re.isData3DTexture)kn?(ii&&n.texStorage3D(t.TEXTURE_3D,Gt,yt,Nt.width,Nt.height,Nt.depth),Ne&&n.texSubImage3D(t.TEXTURE_3D,0,0,0,0,Nt.width,Nt.height,Nt.depth,on,Wn,Nt.data)):n.texImage3D(t.TEXTURE_3D,0,yt,Nt.width,Nt.height,Nt.depth,0,on,Wn,Nt.data);else if(re.isFramebufferTexture){if(ii)if(kn)n.texStorage2D(t.TEXTURE_2D,Gt,yt,Nt.width,Nt.height);else{let Et=Nt.width,Ct=Nt.height;for(let Zt=0;Zt<Gt;Zt++)n.texImage2D(t.TEXTURE_2D,Zt,yt,Et,Ct,0,on,Wn,null),Et>>=1,Ct>>=1}}else if(Vt.length>0){if(kn&&ii){const Et=mt(Vt[0]);n.texStorage2D(t.TEXTURE_2D,Gt,yt,Et.width,Et.height)}for(let Et=0,Ct=Vt.length;Et<Ct;Et++)Tt=Vt[Et],kn?Ne&&n.texSubImage2D(t.TEXTURE_2D,Et,0,0,on,Wn,Tt):n.texImage2D(t.TEXTURE_2D,Et,yt,on,Wn,Tt);re.generateMipmaps=!1}else if(kn){if(ii){const Et=mt(Nt);n.texStorage2D(t.TEXTURE_2D,Gt,yt,Et.width,Et.height)}Ne&&n.texSubImage2D(t.TEXTURE_2D,0,0,0,on,Wn,Nt)}else n.texImage2D(t.TEXTURE_2D,0,yt,on,Wn,Nt);L(re)&&P(Ge),Ht.__version=ft.version,re.onUpdate&&re.onUpdate(re)}ve.__version=re.version}function Ke(ve,re,Xe){if(re.image.length!==6)return;const Ge=wt(ve,re),st=re.source;n.bindTexture(t.TEXTURE_CUBE_MAP,ve.__webglTexture,t.TEXTURE0+Xe);const ft=i.get(st);if(st.version!==ft.__version||Ge===!0){n.activeTexture(t.TEXTURE0+Xe);const Ht=Ki.getPrimaries(Ki.workingColorSpace),$t=re.colorSpace===rd?null:Ki.getPrimaries(re.colorSpace),it=re.colorSpace===rd||Ht===$t?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,re.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,re.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,re.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,it);const On=re.isCompressedTexture||re.image[0].isCompressedTexture,Nt=re.image[0]&&re.image[0].isDataTexture,on=[];for(let Ct=0;Ct<6;Ct++)!On&&!Nt?on[Ct]=D(re.image[Ct],!0,r.maxCubemapSize):on[Ct]=Nt?re.image[Ct].image:re.image[Ct],on[Ct]=Pt(re,on[Ct]);const Wn=on[0],yt=a.convert(re.format,re.colorSpace),Tt=a.convert(re.type),Vt=N(re.internalFormat,yt,Tt,re.colorSpace),kn=re.isVideoTexture!==!0,ii=ft.__version===void 0||Ge===!0,Ne=st.dataReady;let Gt=$(re,Wn);je(t.TEXTURE_CUBE_MAP,re);let Et;if(On){kn&&ii&&n.texStorage2D(t.TEXTURE_CUBE_MAP,Gt,Vt,Wn.width,Wn.height);for(let Ct=0;Ct<6;Ct++){Et=on[Ct].mipmaps;for(let Zt=0;Zt<Et.length;Zt++){const xe=Et[Zt];re.format!==tc?yt!==null?kn?Ne&&n.compressedTexSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Ct,Zt,0,0,xe.width,xe.height,yt,xe.data):n.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Ct,Zt,Vt,xe.width,xe.height,0,xe.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):kn?Ne&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Ct,Zt,0,0,xe.width,xe.height,yt,Tt,xe.data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Ct,Zt,Vt,xe.width,xe.height,0,yt,Tt,xe.data)}}}else{if(Et=re.mipmaps,kn&&ii){Et.length>0&&Gt++;const Ct=mt(on[0]);n.texStorage2D(t.TEXTURE_CUBE_MAP,Gt,Vt,Ct.width,Ct.height)}for(let Ct=0;Ct<6;Ct++)if(Nt){kn?Ne&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Ct,0,0,0,on[Ct].width,on[Ct].height,yt,Tt,on[Ct].data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Ct,0,Vt,on[Ct].width,on[Ct].height,0,yt,Tt,on[Ct].data);for(let Zt=0;Zt<Et.length;Zt++){const te=Et[Zt].image[Ct].image;kn?Ne&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Ct,Zt+1,0,0,te.width,te.height,yt,Tt,te.data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Ct,Zt+1,Vt,te.width,te.height,0,yt,Tt,te.data)}}else{kn?Ne&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Ct,0,0,0,yt,Tt,on[Ct]):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Ct,0,Vt,yt,Tt,on[Ct]);for(let Zt=0;Zt<Et.length;Zt++){const xe=Et[Zt];kn?Ne&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Ct,Zt+1,0,0,yt,Tt,xe.image[Ct]):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Ct,Zt+1,Vt,yt,Tt,xe.image[Ct])}}}L(re)&&P(t.TEXTURE_CUBE_MAP),ft.__version=st.version,re.onUpdate&&re.onUpdate(re)}ve.__version=re.version}function _t(ve,re,Xe,Ge,st,ft){const Ht=a.convert(Xe.format,Xe.colorSpace),$t=a.convert(Xe.type),it=N(Xe.internalFormat,Ht,$t,Xe.colorSpace);if(!i.get(re).__hasExternalTextures){const Nt=Math.max(1,re.width>>ft),on=Math.max(1,re.height>>ft);st===t.TEXTURE_3D||st===t.TEXTURE_2D_ARRAY?n.texImage3D(st,ft,it,Nt,on,re.depth,0,Ht,$t,null):n.texImage2D(st,ft,it,Nt,on,0,Ht,$t,null)}n.bindFramebuffer(t.FRAMEBUFFER,ve),Ue(re)?l.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,Ge,st,i.get(Xe).__webglTexture,0,Cn(re)):(st===t.TEXTURE_2D||st>=t.TEXTURE_CUBE_MAP_POSITIVE_X&&st<=t.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&t.framebufferTexture2D(t.FRAMEBUFFER,Ge,st,i.get(Xe).__webglTexture,ft),n.bindFramebuffer(t.FRAMEBUFFER,null)}function zt(ve,re,Xe){if(t.bindRenderbuffer(t.RENDERBUFFER,ve),re.depthBuffer){const Ge=re.depthTexture,st=Ge&&Ge.isDepthTexture?Ge.type:null,ft=B(re.stencilBuffer,st),Ht=re.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,$t=Cn(re);Ue(re)?l.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,$t,ft,re.width,re.height):Xe?t.renderbufferStorageMultisample(t.RENDERBUFFER,$t,ft,re.width,re.height):t.renderbufferStorage(t.RENDERBUFFER,ft,re.width,re.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,Ht,t.RENDERBUFFER,ve)}else{const Ge=re.textures;for(let st=0;st<Ge.length;st++){const ft=Ge[st],Ht=a.convert(ft.format,ft.colorSpace),$t=a.convert(ft.type),it=N(ft.internalFormat,Ht,$t,ft.colorSpace),On=Cn(re);Xe&&Ue(re)===!1?t.renderbufferStorageMultisample(t.RENDERBUFFER,On,it,re.width,re.height):Ue(re)?l.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,On,it,re.width,re.height):t.renderbufferStorage(t.RENDERBUFFER,it,re.width,re.height)}}t.bindRenderbuffer(t.RENDERBUFFER,null)}function Rt(ve,re){if(re&&re.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(t.FRAMEBUFFER,ve),!(re.depthTexture&&re.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(re.depthTexture).__webglTexture||re.depthTexture.image.width!==re.width||re.depthTexture.image.height!==re.height)&&(re.depthTexture.image.width=re.width,re.depthTexture.image.height=re.height,re.depthTexture.needsUpdate=!0),Me(re.depthTexture,0);const Ge=i.get(re.depthTexture).__webglTexture,st=Cn(re);if(re.depthTexture.format===Um)Ue(re)?l.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,Ge,0,st):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,Ge,0);else if(re.depthTexture.format===Vm)Ue(re)?l.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,Ge,0,st):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,Ge,0);else throw new Error("Unknown depthTexture format")}function fn(ve){const re=i.get(ve),Xe=ve.isWebGLCubeRenderTarget===!0;if(ve.depthTexture&&!re.__autoAllocateDepthBuffer){if(Xe)throw new Error("target.depthTexture not supported in Cube render targets");Rt(re.__webglFramebuffer,ve)}else if(Xe){re.__webglDepthbuffer=[];for(let Ge=0;Ge<6;Ge++)n.bindFramebuffer(t.FRAMEBUFFER,re.__webglFramebuffer[Ge]),re.__webglDepthbuffer[Ge]=t.createRenderbuffer(),zt(re.__webglDepthbuffer[Ge],ve,!1)}else n.bindFramebuffer(t.FRAMEBUFFER,re.__webglFramebuffer),re.__webglDepthbuffer=t.createRenderbuffer(),zt(re.__webglDepthbuffer,ve,!1);n.bindFramebuffer(t.FRAMEBUFFER,null)}function Mn(ve,re,Xe){const Ge=i.get(ve);re!==void 0&&_t(Ge.__webglFramebuffer,ve,ve.texture,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,0),Xe!==void 0&&fn(ve)}function Bt(ve){const re=ve.texture,Xe=i.get(ve),Ge=i.get(re);ve.addEventListener("dispose",q);const st=ve.textures,ft=ve.isWebGLCubeRenderTarget===!0,Ht=st.length>1;if(Ht||(Ge.__webglTexture===void 0&&(Ge.__webglTexture=t.createTexture()),Ge.__version=re.version,u.memory.textures++),ft){Xe.__webglFramebuffer=[];for(let $t=0;$t<6;$t++)if(re.mipmaps&&re.mipmaps.length>0){Xe.__webglFramebuffer[$t]=[];for(let it=0;it<re.mipmaps.length;it++)Xe.__webglFramebuffer[$t][it]=t.createFramebuffer()}else Xe.__webglFramebuffer[$t]=t.createFramebuffer()}else{if(re.mipmaps&&re.mipmaps.length>0){Xe.__webglFramebuffer=[];for(let $t=0;$t<re.mipmaps.length;$t++)Xe.__webglFramebuffer[$t]=t.createFramebuffer()}else Xe.__webglFramebuffer=t.createFramebuffer();if(Ht)for(let $t=0,it=st.length;$t<it;$t++){const On=i.get(st[$t]);On.__webglTexture===void 0&&(On.__webglTexture=t.createTexture(),u.memory.textures++)}if(ve.samples>0&&Ue(ve)===!1){Xe.__webglMultisampledFramebuffer=t.createFramebuffer(),Xe.__webglColorRenderbuffer=[],n.bindFramebuffer(t.FRAMEBUFFER,Xe.__webglMultisampledFramebuffer);for(let $t=0;$t<st.length;$t++){const it=st[$t];Xe.__webglColorRenderbuffer[$t]=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,Xe.__webglColorRenderbuffer[$t]);const On=a.convert(it.format,it.colorSpace),Nt=a.convert(it.type),on=N(it.internalFormat,On,Nt,it.colorSpace,ve.isXRRenderTarget===!0),Wn=Cn(ve);t.renderbufferStorageMultisample(t.RENDERBUFFER,Wn,on,ve.width,ve.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+$t,t.RENDERBUFFER,Xe.__webglColorRenderbuffer[$t])}t.bindRenderbuffer(t.RENDERBUFFER,null),ve.depthBuffer&&(Xe.__webglDepthRenderbuffer=t.createRenderbuffer(),zt(Xe.__webglDepthRenderbuffer,ve,!0)),n.bindFramebuffer(t.FRAMEBUFFER,null)}}if(ft){n.bindTexture(t.TEXTURE_CUBE_MAP,Ge.__webglTexture),je(t.TEXTURE_CUBE_MAP,re);for(let $t=0;$t<6;$t++)if(re.mipmaps&&re.mipmaps.length>0)for(let it=0;it<re.mipmaps.length;it++)_t(Xe.__webglFramebuffer[$t][it],ve,re,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+$t,it);else _t(Xe.__webglFramebuffer[$t],ve,re,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+$t,0);L(re)&&P(t.TEXTURE_CUBE_MAP),n.unbindTexture()}else if(Ht){for(let $t=0,it=st.length;$t<it;$t++){const On=st[$t],Nt=i.get(On);n.bindTexture(t.TEXTURE_2D,Nt.__webglTexture),je(t.TEXTURE_2D,On),_t(Xe.__webglFramebuffer,ve,On,t.COLOR_ATTACHMENT0+$t,t.TEXTURE_2D,0),L(On)&&P(t.TEXTURE_2D)}n.unbindTexture()}else{let $t=t.TEXTURE_2D;if((ve.isWebGL3DRenderTarget||ve.isWebGLArrayRenderTarget)&&($t=ve.isWebGL3DRenderTarget?t.TEXTURE_3D:t.TEXTURE_2D_ARRAY),n.bindTexture($t,Ge.__webglTexture),je($t,re),re.mipmaps&&re.mipmaps.length>0)for(let it=0;it<re.mipmaps.length;it++)_t(Xe.__webglFramebuffer[it],ve,re,t.COLOR_ATTACHMENT0,$t,it);else _t(Xe.__webglFramebuffer,ve,re,t.COLOR_ATTACHMENT0,$t,0);L(re)&&P($t),n.unbindTexture()}ve.depthBuffer&&fn(ve)}function Kn(ve){const re=ve.textures;for(let Xe=0,Ge=re.length;Xe<Ge;Xe++){const st=re[Xe];if(L(st)){const ft=ve.isWebGLCubeRenderTarget?t.TEXTURE_CUBE_MAP:t.TEXTURE_2D,Ht=i.get(st).__webglTexture;n.bindTexture(ft,Ht),P(ft),n.unbindTexture()}}}const Re=[],Jn=[];function Ln(ve){if(ve.samples>0){if(Ue(ve)===!1){const re=ve.textures,Xe=ve.width,Ge=ve.height;let st=t.COLOR_BUFFER_BIT;const ft=ve.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,Ht=i.get(ve),$t=re.length>1;if($t)for(let it=0;it<re.length;it++)n.bindFramebuffer(t.FRAMEBUFFER,Ht.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+it,t.RENDERBUFFER,null),n.bindFramebuffer(t.FRAMEBUFFER,Ht.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+it,t.TEXTURE_2D,null,0);n.bindFramebuffer(t.READ_FRAMEBUFFER,Ht.__webglMultisampledFramebuffer),n.bindFramebuffer(t.DRAW_FRAMEBUFFER,Ht.__webglFramebuffer);for(let it=0;it<re.length;it++){if(ve.resolveDepthBuffer&&(ve.depthBuffer&&(st|=t.DEPTH_BUFFER_BIT),ve.stencilBuffer&&ve.resolveStencilBuffer&&(st|=t.STENCIL_BUFFER_BIT)),$t){t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,Ht.__webglColorRenderbuffer[it]);const On=i.get(re[it]).__webglTexture;t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,On,0)}t.blitFramebuffer(0,0,Xe,Ge,0,0,Xe,Ge,st,t.NEAREST),f===!0&&(Re.length=0,Jn.length=0,Re.push(t.COLOR_ATTACHMENT0+it),ve.depthBuffer&&ve.resolveDepthBuffer===!1&&(Re.push(ft),Jn.push(ft),t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,Jn)),t.invalidateFramebuffer(t.READ_FRAMEBUFFER,Re))}if(n.bindFramebuffer(t.READ_FRAMEBUFFER,null),n.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),$t)for(let it=0;it<re.length;it++){n.bindFramebuffer(t.FRAMEBUFFER,Ht.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+it,t.RENDERBUFFER,Ht.__webglColorRenderbuffer[it]);const On=i.get(re[it]).__webglTexture;n.bindFramebuffer(t.FRAMEBUFFER,Ht.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+it,t.TEXTURE_2D,On,0)}n.bindFramebuffer(t.DRAW_FRAMEBUFFER,Ht.__webglMultisampledFramebuffer)}else if(ve.depthBuffer&&ve.resolveDepthBuffer===!1&&f){const re=ve.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,[re])}}}function Cn(ve){return Math.min(r.maxSamples,ve.samples)}function Ue(ve){const re=i.get(ve);return ve.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&re.__useRenderToTexture!==!1}function xt(ve){const re=u.render.frame;y.get(ve)!==re&&(y.set(ve,re),ve.update())}function Pt(ve,re){const Xe=ve.colorSpace,Ge=ve.format,st=ve.type;return ve.isCompressedTexture===!0||ve.isVideoTexture===!0||Xe!==Xu&&Xe!==rd&&(Ki.getTransfer(Xe)===Mr?(Ge!==tc||st!==ju)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",Xe)),re}function mt(ve){return typeof HTMLImageElement<"u"&&ve instanceof HTMLImageElement?(g.width=ve.naturalWidth||ve.width,g.height=ve.naturalHeight||ve.height):typeof VideoFrame<"u"&&ve instanceof VideoFrame?(g.width=ve.displayWidth,g.height=ve.displayHeight):(g.width=ve.width,g.height=ve.height),g}this.allocateTextureUnit=De,this.resetTextureUnits=se,this.setTexture2D=Me,this.setTexture2DArray=Ye,this.setTexture3D=ye,this.setTextureCube=Ce,this.rebindTextures=Mn,this.setupRenderTarget=Bt,this.updateRenderTargetMipmap=Kn,this.updateMultisampleRenderTarget=Ln,this.setupDepthRenderbuffer=fn,this.setupFrameBufferTexture=_t,this.useMultisampledRTT=Ue}function sW(t,e){function n(i,r=rd){let a;const u=Ki.getTransfer(r);if(i===ju)return t.UNSIGNED_BYTE;if(i===rM)return t.UNSIGNED_SHORT_4_4_4_4;if(i===sM)return t.UNSIGNED_SHORT_5_5_5_1;if(i===bL)return t.UNSIGNED_INT_5_9_9_9_REV;if(i===_L)return t.BYTE;if(i===xL)return t.SHORT;if(i===K0)return t.UNSIGNED_SHORT;if(i===iM)return t.INT;if(i===Zf)return t.UNSIGNED_INT;if(i===qu)return t.FLOAT;if(i===J0)return t.HALF_FLOAT;if(i===wL)return t.ALPHA;if(i===SL)return t.RGB;if(i===tc)return t.RGBA;if(i===EL)return t.LUMINANCE;if(i===ML)return t.LUMINANCE_ALPHA;if(i===Um)return t.DEPTH_COMPONENT;if(i===Vm)return t.DEPTH_STENCIL;if(i===CL)return t.RED;if(i===oM)return t.RED_INTEGER;if(i===TL)return t.RG;if(i===aM)return t.RG_INTEGER;if(i===lM)return t.RGBA_INTEGER;if(i===l1||i===c1||i===u1||i===h1)if(u===Mr)if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(i===l1)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(i===c1)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(i===u1)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(i===h1)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=e.get("WEBGL_compressed_texture_s3tc"),a!==null){if(i===l1)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(i===c1)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(i===u1)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(i===h1)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(i===cM||i===uM||i===hM||i===dM)if(a=e.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(i===cM)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(i===uM)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(i===hM)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(i===dM)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(i===fM||i===pM||i===mM)if(a=e.get("WEBGL_compressed_texture_etc"),a!==null){if(i===fM||i===pM)return u===Mr?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(i===mM)return u===Mr?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(i===gM||i===vM||i===yM||i===_M||i===xM||i===bM||i===wM||i===SM||i===EM||i===MM||i===CM||i===TM||i===AM||i===PM)if(a=e.get("WEBGL_compressed_texture_astc"),a!==null){if(i===gM)return u===Mr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(i===vM)return u===Mr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(i===yM)return u===Mr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(i===_M)return u===Mr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(i===xM)return u===Mr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(i===bM)return u===Mr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(i===wM)return u===Mr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(i===SM)return u===Mr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(i===EM)return u===Mr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(i===MM)return u===Mr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(i===CM)return u===Mr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(i===TM)return u===Mr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(i===AM)return u===Mr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(i===PM)return u===Mr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(i===d1||i===IM||i===RM)if(a=e.get("EXT_texture_compression_bptc"),a!==null){if(i===d1)return u===Mr?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(i===IM)return a.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(i===RM)return a.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(i===AL||i===LM||i===kM||i===DM)if(a=e.get("EXT_texture_compression_rgtc"),a!==null){if(i===d1)return a.COMPRESSED_RED_RGTC1_EXT;if(i===LM)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(i===kM)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(i===DM)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return i===Bm?t.UNSIGNED_INT_24_8:t[i]!==void 0?t[i]:null}return{convert:n}}class oW extends Sl{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class mg extends Qu{constructor(){super(),this.isGroup=!0,this.type="Group"}}const aW={type:"move"};class dC{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new mg,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new mg,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new pt,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new pt),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new mg,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new pt,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new pt),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const n=this._hand;if(n)for(const i of e.hand.values())this._getHandJoint(n,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,n,i){let r=null,a=null,u=null;const l=this._targetRay,f=this._grip,g=this._hand;if(e&&n.session.visibilityState!=="visible-blurred"){if(g&&e.hand){u=!0;for(const D of e.hand.values()){const L=n.getJointPose(D,i),P=this._getHandJoint(g,D);L!==null&&(P.matrix.fromArray(L.transform.matrix),P.matrix.decompose(P.position,P.rotation,P.scale),P.matrixWorldNeedsUpdate=!0,P.jointRadius=L.radius),P.visible=L!==null}const y=g.joints["index-finger-tip"],S=g.joints["thumb-tip"],b=y.position.distanceTo(S.position),A=.02,I=.005;g.inputState.pinching&&b>A+I?(g.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!g.inputState.pinching&&b<=A-I&&(g.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else f!==null&&e.gripSpace&&(a=n.getPose(e.gripSpace,i),a!==null&&(f.matrix.fromArray(a.transform.matrix),f.matrix.decompose(f.position,f.rotation,f.scale),f.matrixWorldNeedsUpdate=!0,a.linearVelocity?(f.hasLinearVelocity=!0,f.linearVelocity.copy(a.linearVelocity)):f.hasLinearVelocity=!1,a.angularVelocity?(f.hasAngularVelocity=!0,f.angularVelocity.copy(a.angularVelocity)):f.hasAngularVelocity=!1));l!==null&&(r=n.getPose(e.targetRaySpace,i),r===null&&a!==null&&(r=a),r!==null&&(l.matrix.fromArray(r.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,r.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(r.linearVelocity)):l.hasLinearVelocity=!1,r.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(r.angularVelocity)):l.hasAngularVelocity=!1,this.dispatchEvent(aW)))}return l!==null&&(l.visible=r!==null),f!==null&&(f.visible=a!==null),g!==null&&(g.visible=u!==null),this}_getHandJoint(e,n){if(e.joints[n.jointName]===void 0){const i=new mg;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[n.jointName]=i,e.add(i)}return e.joints[n.jointName]}}const lW=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,cW=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class uW{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,n,i){if(this.texture===null){const r=new nc,a=e.properties.get(r);a.__webglTexture=n.texture,(n.depthNear!=i.depthNear||n.depthFar!=i.depthFar)&&(this.depthNear=n.depthNear,this.depthFar=n.depthFar),this.texture=r}}getMesh(e){if(this.texture!==null&&this.mesh===null){const n=e.cameras[0].viewport,i=new dd({vertexShader:lW,fragmentShader:cW,uniforms:{depthColor:{value:this.texture},depthWidth:{value:n.z},depthHeight:{value:n.w}}});this.mesh=new oc(new U1(20,20),i)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class hW extends Hm{constructor(e,n){super();const i=this;let r=null,a=1,u=null,l="local-floor",f=1,g=null,y=null,S=null,b=null,A=null,I=null;const D=new uW,L=n.getContextAttributes();let P=null,N=null;const B=[],$=[],K=new Ui;let q=null;const W=new Sl;W.layers.enable(1),W.viewport=new Us;const ie=new Sl;ie.layers.enable(2),ie.viewport=new Us;const Z=[W,ie],X=new oW;X.layers.enable(1),X.layers.enable(2);let se=null,De=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(Ke){let _t=B[Ke];return _t===void 0&&(_t=new dC,B[Ke]=_t),_t.getTargetRaySpace()},this.getControllerGrip=function(Ke){let _t=B[Ke];return _t===void 0&&(_t=new dC,B[Ke]=_t),_t.getGripSpace()},this.getHand=function(Ke){let _t=B[Ke];return _t===void 0&&(_t=new dC,B[Ke]=_t),_t.getHandSpace()};function Se(Ke){const _t=$.indexOf(Ke.inputSource);if(_t===-1)return;const zt=B[_t];zt!==void 0&&(zt.update(Ke.inputSource,Ke.frame,g||u),zt.dispatchEvent({type:Ke.type,data:Ke.inputSource}))}function Me(){r.removeEventListener("select",Se),r.removeEventListener("selectstart",Se),r.removeEventListener("selectend",Se),r.removeEventListener("squeeze",Se),r.removeEventListener("squeezestart",Se),r.removeEventListener("squeezeend",Se),r.removeEventListener("end",Me),r.removeEventListener("inputsourceschange",Ye);for(let Ke=0;Ke<B.length;Ke++){const _t=$[Ke];_t!==null&&($[Ke]=null,B[Ke].disconnect(_t))}se=null,De=null,D.reset(),e.setRenderTarget(P),A=null,b=null,S=null,r=null,N=null,Xt.stop(),i.isPresenting=!1,e.setPixelRatio(q),e.setSize(K.width,K.height,!1),i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(Ke){a=Ke,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Ke){l=Ke,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return g||u},this.setReferenceSpace=function(Ke){g=Ke},this.getBaseLayer=function(){return b!==null?b:A},this.getBinding=function(){return S},this.getFrame=function(){return I},this.getSession=function(){return r},this.setSession=async function(Ke){if(r=Ke,r!==null){if(P=e.getRenderTarget(),r.addEventListener("select",Se),r.addEventListener("selectstart",Se),r.addEventListener("selectend",Se),r.addEventListener("squeeze",Se),r.addEventListener("squeezestart",Se),r.addEventListener("squeezeend",Se),r.addEventListener("end",Me),r.addEventListener("inputsourceschange",Ye),L.xrCompatible!==!0&&await n.makeXRCompatible(),q=e.getPixelRatio(),e.getSize(K),r.renderState.layers===void 0){const _t={antialias:L.antialias,alpha:!0,depth:L.depth,stencil:L.stencil,framebufferScaleFactor:a};A=new XRWebGLLayer(r,n,_t),r.updateRenderState({baseLayer:A}),e.setPixelRatio(1),e.setSize(A.framebufferWidth,A.framebufferHeight,!1),N=new sd(A.framebufferWidth,A.framebufferHeight,{format:tc,type:ju,colorSpace:e.outputColorSpace,stencilBuffer:L.stencil})}else{let _t=null,zt=null,Rt=null;L.depth&&(Rt=L.stencil?n.DEPTH24_STENCIL8:n.DEPTH_COMPONENT24,_t=L.stencil?Vm:Um,zt=L.stencil?Bm:Zf);const fn={colorFormat:n.RGBA8,depthFormat:Rt,scaleFactor:a};S=new XRWebGLBinding(r,n),b=S.createProjectionLayer(fn),r.updateRenderState({layers:[b]}),e.setPixelRatio(1),e.setSize(b.textureWidth,b.textureHeight,!1),N=new sd(b.textureWidth,b.textureHeight,{format:tc,type:ju,depthTexture:new vk(b.textureWidth,b.textureHeight,zt,void 0,void 0,void 0,void 0,void 0,void 0,_t),stencilBuffer:L.stencil,colorSpace:e.outputColorSpace,samples:L.antialias?4:0,resolveDepthBuffer:b.ignoreDepthValues===!1})}N.isXRRenderTarget=!0,this.setFoveation(f),g=null,u=await r.requestReferenceSpace(l),Xt.setContext(r),Xt.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(r!==null)return r.environmentBlendMode},this.getDepthTexture=function(){return D.getDepthTexture()};function Ye(Ke){for(let _t=0;_t<Ke.removed.length;_t++){const zt=Ke.removed[_t],Rt=$.indexOf(zt);Rt>=0&&($[Rt]=null,B[Rt].disconnect(zt))}for(let _t=0;_t<Ke.added.length;_t++){const zt=Ke.added[_t];let Rt=$.indexOf(zt);if(Rt===-1){for(let Mn=0;Mn<B.length;Mn++)if(Mn>=$.length){$.push(zt),Rt=Mn;break}else if($[Mn]===null){$[Mn]=zt,Rt=Mn;break}if(Rt===-1)break}const fn=B[Rt];fn&&fn.connect(zt)}}const ye=new pt,Ce=new pt;function ge(Ke,_t,zt){ye.setFromMatrixPosition(_t.matrixWorld),Ce.setFromMatrixPosition(zt.matrixWorld);const Rt=ye.distanceTo(Ce),fn=_t.projectionMatrix.elements,Mn=zt.projectionMatrix.elements,Bt=fn[14]/(fn[10]-1),Kn=fn[14]/(fn[10]+1),Re=(fn[9]+1)/fn[5],Jn=(fn[9]-1)/fn[5],Ln=(fn[8]-1)/fn[0],Cn=(Mn[8]+1)/Mn[0],Ue=Bt*Ln,xt=Bt*Cn,Pt=Rt/(-Ln+Cn),mt=Pt*-Ln;_t.matrixWorld.decompose(Ke.position,Ke.quaternion,Ke.scale),Ke.translateX(mt),Ke.translateZ(Pt),Ke.matrixWorld.compose(Ke.position,Ke.quaternion,Ke.scale),Ke.matrixWorldInverse.copy(Ke.matrixWorld).invert();const ve=Bt+Pt,re=Kn+Pt,Xe=Ue-mt,Ge=xt+(Rt-mt),st=Re*Kn/re*ve,ft=Jn*Kn/re*ve;Ke.projectionMatrix.makePerspective(Xe,Ge,st,ft,ve,re),Ke.projectionMatrixInverse.copy(Ke.projectionMatrix).invert()}function Be(Ke,_t){_t===null?Ke.matrixWorld.copy(Ke.matrix):Ke.matrixWorld.multiplyMatrices(_t.matrixWorld,Ke.matrix),Ke.matrixWorldInverse.copy(Ke.matrixWorld).invert()}this.updateCamera=function(Ke){if(r===null)return;D.texture!==null&&(Ke.near=D.depthNear,Ke.far=D.depthFar),X.near=ie.near=W.near=Ke.near,X.far=ie.far=W.far=Ke.far,(se!==X.near||De!==X.far)&&(r.updateRenderState({depthNear:X.near,depthFar:X.far}),se=X.near,De=X.far,W.near=se,W.far=De,ie.near=se,ie.far=De,W.updateProjectionMatrix(),ie.updateProjectionMatrix(),Ke.updateProjectionMatrix());const _t=Ke.parent,zt=X.cameras;Be(X,_t);for(let Rt=0;Rt<zt.length;Rt++)Be(zt[Rt],_t);zt.length===2?ge(X,W,ie):X.projectionMatrix.copy(W.projectionMatrix),Ze(Ke,X,_t)};function Ze(Ke,_t,zt){zt===null?Ke.matrix.copy(_t.matrixWorld):(Ke.matrix.copy(zt.matrixWorld),Ke.matrix.invert(),Ke.matrix.multiply(_t.matrixWorld)),Ke.matrix.decompose(Ke.position,Ke.quaternion,Ke.scale),Ke.updateMatrixWorld(!0),Ke.projectionMatrix.copy(_t.projectionMatrix),Ke.projectionMatrixInverse.copy(_t.projectionMatrixInverse),Ke.isPerspectiveCamera&&(Ke.fov=ey*2*Math.atan(1/Ke.projectionMatrix.elements[5]),Ke.zoom=1)}this.getCamera=function(){return X},this.getFoveation=function(){if(!(b===null&&A===null))return f},this.setFoveation=function(Ke){f=Ke,b!==null&&(b.fixedFoveation=Ke),A!==null&&A.fixedFoveation!==void 0&&(A.fixedFoveation=Ke)},this.hasDepthSensing=function(){return D.texture!==null},this.getDepthSensingMesh=function(){return D.getMesh(X)};let je=null;function wt(Ke,_t){if(y=_t.getViewerPose(g||u),I=_t,y!==null){const zt=y.views;A!==null&&(e.setRenderTargetFramebuffer(N,A.framebuffer),e.setRenderTarget(N));let Rt=!1;zt.length!==X.cameras.length&&(X.cameras.length=0,Rt=!0);for(let Mn=0;Mn<zt.length;Mn++){const Bt=zt[Mn];let Kn=null;if(A!==null)Kn=A.getViewport(Bt);else{const Jn=S.getViewSubImage(b,Bt);Kn=Jn.viewport,Mn===0&&(e.setRenderTargetTextures(N,Jn.colorTexture,b.ignoreDepthValues?void 0:Jn.depthStencilTexture),e.setRenderTarget(N))}let Re=Z[Mn];Re===void 0&&(Re=new Sl,Re.layers.enable(Mn),Re.viewport=new Us,Z[Mn]=Re),Re.matrix.fromArray(Bt.transform.matrix),Re.matrix.decompose(Re.position,Re.quaternion,Re.scale),Re.projectionMatrix.fromArray(Bt.projectionMatrix),Re.projectionMatrixInverse.copy(Re.projectionMatrix).invert(),Re.viewport.set(Kn.x,Kn.y,Kn.width,Kn.height),Mn===0&&(X.matrix.copy(Re.matrix),X.matrix.decompose(X.position,X.quaternion,X.scale)),Rt===!0&&X.cameras.push(Re)}const fn=r.enabledFeatures;if(fn&&fn.includes("depth-sensing")){const Mn=S.getDepthInformation(zt[0]);Mn&&Mn.isValid&&Mn.texture&&D.init(e,Mn,r.renderState)}}for(let zt=0;zt<B.length;zt++){const Rt=$[zt],fn=B[zt];Rt!==null&&fn!==void 0&&fn.update(Rt,_t,g||u)}je&&je(Ke,_t),_t.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:_t}),I=null}const Xt=new ck;Xt.setAnimationLoop(wt),this.setAnimationLoop=function(Ke){je=Ke},this.dispose=function(){}}}const rp=new ud,dW=new Es;function fW(t,e){function n(L,P){L.matrixAutoUpdate===!0&&L.updateMatrix(),P.value.copy(L.matrix)}function i(L,P){P.color.getRGB(L.fogColor.value,rk(t)),P.isFog?(L.fogNear.value=P.near,L.fogFar.value=P.far):P.isFogExp2&&(L.fogDensity.value=P.density)}function r(L,P,N,B,$){P.isMeshBasicMaterial||P.isMeshLambertMaterial?a(L,P):P.isMeshToonMaterial?(a(L,P),S(L,P)):P.isMeshPhongMaterial?(a(L,P),y(L,P)):P.isMeshStandardMaterial?(a(L,P),b(L,P),P.isMeshPhysicalMaterial&&A(L,P,$)):P.isMeshMatcapMaterial?(a(L,P),I(L,P)):P.isMeshDepthMaterial?a(L,P):P.isMeshDistanceMaterial?(a(L,P),D(L,P)):P.isMeshNormalMaterial?a(L,P):P.isLineBasicMaterial?(u(L,P),P.isLineDashedMaterial&&l(L,P)):P.isPointsMaterial?f(L,P,N,B):P.isSpriteMaterial?g(L,P):P.isShadowMaterial?(L.color.value.copy(P.color),L.opacity.value=P.opacity):P.isShaderMaterial&&(P.uniformsNeedUpdate=!1)}function a(L,P){L.opacity.value=P.opacity,P.color&&L.diffuse.value.copy(P.color),P.emissive&&L.emissive.value.copy(P.emissive).multiplyScalar(P.emissiveIntensity),P.map&&(L.map.value=P.map,n(P.map,L.mapTransform)),P.alphaMap&&(L.alphaMap.value=P.alphaMap,n(P.alphaMap,L.alphaMapTransform)),P.bumpMap&&(L.bumpMap.value=P.bumpMap,n(P.bumpMap,L.bumpMapTransform),L.bumpScale.value=P.bumpScale,P.side===ua&&(L.bumpScale.value*=-1)),P.normalMap&&(L.normalMap.value=P.normalMap,n(P.normalMap,L.normalMapTransform),L.normalScale.value.copy(P.normalScale),P.side===ua&&L.normalScale.value.negate()),P.displacementMap&&(L.displacementMap.value=P.displacementMap,n(P.displacementMap,L.displacementMapTransform),L.displacementScale.value=P.displacementScale,L.displacementBias.value=P.displacementBias),P.emissiveMap&&(L.emissiveMap.value=P.emissiveMap,n(P.emissiveMap,L.emissiveMapTransform)),P.specularMap&&(L.specularMap.value=P.specularMap,n(P.specularMap,L.specularMapTransform)),P.alphaTest>0&&(L.alphaTest.value=P.alphaTest);const N=e.get(P),B=N.envMap,$=N.envMapRotation;B&&(L.envMap.value=B,rp.copy($),rp.x*=-1,rp.y*=-1,rp.z*=-1,B.isCubeTexture&&B.isRenderTargetTexture===!1&&(rp.y*=-1,rp.z*=-1),L.envMapRotation.value.setFromMatrix4(dW.makeRotationFromEuler(rp)),L.flipEnvMap.value=B.isCubeTexture&&B.isRenderTargetTexture===!1?-1:1,L.reflectivity.value=P.reflectivity,L.ior.value=P.ior,L.refractionRatio.value=P.refractionRatio),P.lightMap&&(L.lightMap.value=P.lightMap,L.lightMapIntensity.value=P.lightMapIntensity,n(P.lightMap,L.lightMapTransform)),P.aoMap&&(L.aoMap.value=P.aoMap,L.aoMapIntensity.value=P.aoMapIntensity,n(P.aoMap,L.aoMapTransform))}function u(L,P){L.diffuse.value.copy(P.color),L.opacity.value=P.opacity,P.map&&(L.map.value=P.map,n(P.map,L.mapTransform))}function l(L,P){L.dashSize.value=P.dashSize,L.totalSize.value=P.dashSize+P.gapSize,L.scale.value=P.scale}function f(L,P,N,B){L.diffuse.value.copy(P.color),L.opacity.value=P.opacity,L.size.value=P.size*N,L.scale.value=B*.5,P.map&&(L.map.value=P.map,n(P.map,L.uvTransform)),P.alphaMap&&(L.alphaMap.value=P.alphaMap,n(P.alphaMap,L.alphaMapTransform)),P.alphaTest>0&&(L.alphaTest.value=P.alphaTest)}function g(L,P){L.diffuse.value.copy(P.color),L.opacity.value=P.opacity,L.rotation.value=P.rotation,P.map&&(L.map.value=P.map,n(P.map,L.mapTransform)),P.alphaMap&&(L.alphaMap.value=P.alphaMap,n(P.alphaMap,L.alphaMapTransform)),P.alphaTest>0&&(L.alphaTest.value=P.alphaTest)}function y(L,P){L.specular.value.copy(P.specular),L.shininess.value=Math.max(P.shininess,1e-4)}function S(L,P){P.gradientMap&&(L.gradientMap.value=P.gradientMap)}function b(L,P){L.metalness.value=P.metalness,P.metalnessMap&&(L.metalnessMap.value=P.metalnessMap,n(P.metalnessMap,L.metalnessMapTransform)),L.roughness.value=P.roughness,P.roughnessMap&&(L.roughnessMap.value=P.roughnessMap,n(P.roughnessMap,L.roughnessMapTransform)),P.envMap&&(L.envMapIntensity.value=P.envMapIntensity)}function A(L,P,N){L.ior.value=P.ior,P.sheen>0&&(L.sheenColor.value.copy(P.sheenColor).multiplyScalar(P.sheen),L.sheenRoughness.value=P.sheenRoughness,P.sheenColorMap&&(L.sheenColorMap.value=P.sheenColorMap,n(P.sheenColorMap,L.sheenColorMapTransform)),P.sheenRoughnessMap&&(L.sheenRoughnessMap.value=P.sheenRoughnessMap,n(P.sheenRoughnessMap,L.sheenRoughnessMapTransform))),P.clearcoat>0&&(L.clearcoat.value=P.clearcoat,L.clearcoatRoughness.value=P.clearcoatRoughness,P.clearcoatMap&&(L.clearcoatMap.value=P.clearcoatMap,n(P.clearcoatMap,L.clearcoatMapTransform)),P.clearcoatRoughnessMap&&(L.clearcoatRoughnessMap.value=P.clearcoatRoughnessMap,n(P.clearcoatRoughnessMap,L.clearcoatRoughnessMapTransform)),P.clearcoatNormalMap&&(L.clearcoatNormalMap.value=P.clearcoatNormalMap,n(P.clearcoatNormalMap,L.clearcoatNormalMapTransform),L.clearcoatNormalScale.value.copy(P.clearcoatNormalScale),P.side===ua&&L.clearcoatNormalScale.value.negate())),P.dispersion>0&&(L.dispersion.value=P.dispersion),P.iridescence>0&&(L.iridescence.value=P.iridescence,L.iridescenceIOR.value=P.iridescenceIOR,L.iridescenceThicknessMinimum.value=P.iridescenceThicknessRange[0],L.iridescenceThicknessMaximum.value=P.iridescenceThicknessRange[1],P.iridescenceMap&&(L.iridescenceMap.value=P.iridescenceMap,n(P.iridescenceMap,L.iridescenceMapTransform)),P.iridescenceThicknessMap&&(L.iridescenceThicknessMap.value=P.iridescenceThicknessMap,n(P.iridescenceThicknessMap,L.iridescenceThicknessMapTransform))),P.transmission>0&&(L.transmission.value=P.transmission,L.transmissionSamplerMap.value=N.texture,L.transmissionSamplerSize.value.set(N.width,N.height),P.transmissionMap&&(L.transmissionMap.value=P.transmissionMap,n(P.transmissionMap,L.transmissionMapTransform)),L.thickness.value=P.thickness,P.thicknessMap&&(L.thicknessMap.value=P.thicknessMap,n(P.thicknessMap,L.thicknessMapTransform)),L.attenuationDistance.value=P.attenuationDistance,L.attenuationColor.value.copy(P.attenuationColor)),P.anisotropy>0&&(L.anisotropyVector.value.set(P.anisotropy*Math.cos(P.anisotropyRotation),P.anisotropy*Math.sin(P.anisotropyRotation)),P.anisotropyMap&&(L.anisotropyMap.value=P.anisotropyMap,n(P.anisotropyMap,L.anisotropyMapTransform))),L.specularIntensity.value=P.specularIntensity,L.specularColor.value.copy(P.specularColor),P.specularColorMap&&(L.specularColorMap.value=P.specularColorMap,n(P.specularColorMap,L.specularColorMapTransform)),P.specularIntensityMap&&(L.specularIntensityMap.value=P.specularIntensityMap,n(P.specularIntensityMap,L.specularIntensityMapTransform))}function I(L,P){P.matcap&&(L.matcap.value=P.matcap)}function D(L,P){const N=e.get(P).light;L.referencePosition.value.setFromMatrixPosition(N.matrixWorld),L.nearDistance.value=N.shadow.camera.near,L.farDistance.value=N.shadow.camera.far}return{refreshFogUniforms:i,refreshMaterialUniforms:r}}function pW(t,e,n,i){let r={},a={},u=[];const l=t.getParameter(t.MAX_UNIFORM_BUFFER_BINDINGS);function f(N,B){const $=B.program;i.uniformBlockBinding(N,$)}function g(N,B){let $=r[N.id];$===void 0&&(I(N),$=y(N),r[N.id]=$,N.addEventListener("dispose",L));const K=B.program;i.updateUBOMapping(N,K);const q=e.render.frame;a[N.id]!==q&&(b(N),a[N.id]=q)}function y(N){const B=S();N.__bindingPointIndex=B;const $=t.createBuffer(),K=N.__size,q=N.usage;return t.bindBuffer(t.UNIFORM_BUFFER,$),t.bufferData(t.UNIFORM_BUFFER,K,q),t.bindBuffer(t.UNIFORM_BUFFER,null),t.bindBufferBase(t.UNIFORM_BUFFER,B,$),$}function S(){for(let N=0;N<l;N++)if(u.indexOf(N)===-1)return u.push(N),N;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function b(N){const B=r[N.id],$=N.uniforms,K=N.__cache;t.bindBuffer(t.UNIFORM_BUFFER,B);for(let q=0,W=$.length;q<W;q++){const ie=Array.isArray($[q])?$[q]:[$[q]];for(let Z=0,X=ie.length;Z<X;Z++){const se=ie[Z];if(A(se,q,Z,K)===!0){const De=se.__offset,Se=Array.isArray(se.value)?se.value:[se.value];let Me=0;for(let Ye=0;Ye<Se.length;Ye++){const ye=Se[Ye],Ce=D(ye);typeof ye=="number"||typeof ye=="boolean"?(se.__data[0]=ye,t.bufferSubData(t.UNIFORM_BUFFER,De+Me,se.__data)):ye.isMatrix3?(se.__data[0]=ye.elements[0],se.__data[1]=ye.elements[1],se.__data[2]=ye.elements[2],se.__data[3]=0,se.__data[4]=ye.elements[3],se.__data[5]=ye.elements[4],se.__data[6]=ye.elements[5],se.__data[7]=0,se.__data[8]=ye.elements[6],se.__data[9]=ye.elements[7],se.__data[10]=ye.elements[8],se.__data[11]=0):(ye.toArray(se.__data,Me),Me+=Ce.storage/Float32Array.BYTES_PER_ELEMENT)}t.bufferSubData(t.UNIFORM_BUFFER,De,se.__data)}}}t.bindBuffer(t.UNIFORM_BUFFER,null)}function A(N,B,$,K){const q=N.value,W=B+"_"+$;if(K[W]===void 0)return typeof q=="number"||typeof q=="boolean"?K[W]=q:K[W]=q.clone(),!0;{const ie=K[W];if(typeof q=="number"||typeof q=="boolean"){if(ie!==q)return K[W]=q,!0}else if(ie.equals(q)===!1)return ie.copy(q),!0}return!1}function I(N){const B=N.uniforms;let $=0;const K=16;for(let W=0,ie=B.length;W<ie;W++){const Z=Array.isArray(B[W])?B[W]:[B[W]];for(let X=0,se=Z.length;X<se;X++){const De=Z[X],Se=Array.isArray(De.value)?De.value:[De.value];for(let Me=0,Ye=Se.length;Me<Ye;Me++){const ye=Se[Me],Ce=D(ye),ge=$%K,Be=ge%Ce.boundary,Ze=ge+Be;$+=Be,Ze!==0&&K-Ze<Ce.storage&&($+=K-Ze),De.__data=new Float32Array(Ce.storage/Float32Array.BYTES_PER_ELEMENT),De.__offset=$,$+=Ce.storage}}}const q=$%K;return q>0&&($+=K-q),N.__size=$,N.__cache={},this}function D(N){const B={boundary:0,storage:0};return typeof N=="number"||typeof N=="boolean"?(B.boundary=4,B.storage=4):N.isVector2?(B.boundary=8,B.storage=8):N.isVector3||N.isColor?(B.boundary=16,B.storage=12):N.isVector4?(B.boundary=16,B.storage=16):N.isMatrix3?(B.boundary=48,B.storage=48):N.isMatrix4?(B.boundary=64,B.storage=64):N.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",N),B}function L(N){const B=N.target;B.removeEventListener("dispose",L);const $=u.indexOf(B.__bindingPointIndex);u.splice($,1),t.deleteBuffer(r[B.id]),delete r[B.id],delete a[B.id]}function P(){for(const N in r)t.deleteBuffer(r[N]);u=[],r={},a={}}return{bind:f,update:g,dispose:P}}class mW{constructor(e={}){const{canvas:n=NV(),context:i=null,depth:r=!0,stencil:a=!1,alpha:u=!1,antialias:l=!1,premultipliedAlpha:f=!0,preserveDrawingBuffer:g=!1,powerPreference:y="default",failIfMajorPerformanceCaveat:S=!1}=e;this.isWebGLRenderer=!0;let b;if(i!==null){if(typeof WebGLRenderingContext<"u"&&i instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");b=i.getContextAttributes().alpha}else b=u;const A=new Uint32Array(4),I=new Int32Array(4);let D=null,L=null;const P=[],N=[];this.domElement=n,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=jc,this.toneMapping=nd,this.toneMappingExposure=1;const B=this;let $=!1,K=0,q=0,W=null,ie=-1,Z=null;const X=new Us,se=new Us;let De=null;const Se=new pr(0);let Me=0,Ye=n.width,ye=n.height,Ce=1,ge=null,Be=null;const Ze=new Us(0,0,Ye,ye),je=new Us(0,0,Ye,ye);let wt=!1;const Xt=new iC;let Ke=!1,_t=!1;const zt=new Es,Rt=new pt,fn=new Us,Mn={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let Bt=!1;function Kn(){return W===null?Ce:1}let Re=i;function Jn(me,$e){return n.getContext(me,$e)}try{const me={alpha:!0,depth:r,stencil:a,antialias:l,premultipliedAlpha:f,preserveDrawingBuffer:g,powerPreference:y,failIfMajorPerformanceCaveat:S};if("setAttribute"in n&&n.setAttribute("data-engine",`three.js r${$o}`),n.addEventListener("webglcontextlost",Et,!1),n.addEventListener("webglcontextrestored",Ct,!1),n.addEventListener("webglcontextcreationerror",Zt,!1),Re===null){const $e="webgl2";if(Re=Jn($e,me),Re===null)throw Jn($e)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(me){throw console.error("THREE.WebGLRenderer: "+me.message),me}let Ln,Cn,Ue,xt,Pt,mt,ve,re,Xe,Ge,st,ft,Ht,$t,it,On,Nt,on,Wn,yt,Tt,Vt,kn,ii;function Ne(){Ln=new bH(Re),Ln.init(),Vt=new sW(Re,Ln),Cn=new pH(Re,Ln,e,Vt),Ue=new nW(Re),xt=new EH(Re),Pt=new $G,mt=new rW(Re,Ln,Ue,Pt,Cn,Vt,xt),ve=new gH(B),re=new xH(B),Xe=new u7(Re),kn=new dH(Re,Xe),Ge=new wH(Re,Xe,xt,kn),st=new CH(Re,Ge,Xe,xt),Wn=new MH(Re,Cn,mt),On=new mH(Pt),ft=new VG(B,ve,re,Ln,Cn,kn,On),Ht=new fW(B,Pt),$t=new GG,it=new YG(Ln),on=new hH(B,ve,re,Ue,st,b,f),Nt=new tW(B,st,Cn),ii=new pW(Re,xt,Cn,Ue),yt=new fH(Re,Ln,xt),Tt=new SH(Re,Ln,xt),xt.programs=ft.programs,B.capabilities=Cn,B.extensions=Ln,B.properties=Pt,B.renderLists=$t,B.shadowMap=Nt,B.state=Ue,B.info=xt}Ne();const Gt=new hW(B,Re);this.xr=Gt,this.getContext=function(){return Re},this.getContextAttributes=function(){return Re.getContextAttributes()},this.forceContextLoss=function(){const me=Ln.get("WEBGL_lose_context");me&&me.loseContext()},this.forceContextRestore=function(){const me=Ln.get("WEBGL_lose_context");me&&me.restoreContext()},this.getPixelRatio=function(){return Ce},this.setPixelRatio=function(me){me!==void 0&&(Ce=me,this.setSize(Ye,ye,!1))},this.getSize=function(me){return me.set(Ye,ye)},this.setSize=function(me,$e,ot=!0){if(Gt.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}Ye=me,ye=$e,n.width=Math.floor(me*Ce),n.height=Math.floor($e*Ce),ot===!0&&(n.style.width=me+"px",n.style.height=$e+"px"),this.setViewport(0,0,me,$e)},this.getDrawingBufferSize=function(me){return me.set(Ye*Ce,ye*Ce).floor()},this.setDrawingBufferSize=function(me,$e,ot){Ye=me,ye=$e,Ce=ot,n.width=Math.floor(me*ot),n.height=Math.floor($e*ot),this.setViewport(0,0,me,$e)},this.getCurrentViewport=function(me){return me.copy(X)},this.getViewport=function(me){return me.copy(Ze)},this.setViewport=function(me,$e,ot,lt){me.isVector4?Ze.set(me.x,me.y,me.z,me.w):Ze.set(me,$e,ot,lt),Ue.viewport(X.copy(Ze).multiplyScalar(Ce).round())},this.getScissor=function(me){return me.copy(je)},this.setScissor=function(me,$e,ot,lt){me.isVector4?je.set(me.x,me.y,me.z,me.w):je.set(me,$e,ot,lt),Ue.scissor(se.copy(je).multiplyScalar(Ce).round())},this.getScissorTest=function(){return wt},this.setScissorTest=function(me){Ue.setScissorTest(wt=me)},this.setOpaqueSort=function(me){ge=me},this.setTransparentSort=function(me){Be=me},this.getClearColor=function(me){return me.copy(on.getClearColor())},this.setClearColor=function(){on.setClearColor.apply(on,arguments)},this.getClearAlpha=function(){return on.getClearAlpha()},this.setClearAlpha=function(){on.setClearAlpha.apply(on,arguments)},this.clear=function(me=!0,$e=!0,ot=!0){let lt=0;if(me){let Je=!1;if(W!==null){const jt=W.texture.format;Je=jt===lM||jt===aM||jt===oM}if(Je){const jt=W.texture.type,en=jt===ju||jt===Zf||jt===K0||jt===Bm||jt===rM||jt===sM,En=on.getClearColor(),Yt=on.getClearAlpha(),jn=En.r,Zn=En.g,In=En.b;en?(A[0]=jn,A[1]=Zn,A[2]=In,A[3]=Yt,Re.clearBufferuiv(Re.COLOR,0,A)):(I[0]=jn,I[1]=Zn,I[2]=In,I[3]=Yt,Re.clearBufferiv(Re.COLOR,0,I))}else lt|=Re.COLOR_BUFFER_BIT}$e&&(lt|=Re.DEPTH_BUFFER_BIT),ot&&(lt|=Re.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),Re.clear(lt)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){n.removeEventListener("webglcontextlost",Et,!1),n.removeEventListener("webglcontextrestored",Ct,!1),n.removeEventListener("webglcontextcreationerror",Zt,!1),$t.dispose(),it.dispose(),Pt.dispose(),ve.dispose(),re.dispose(),st.dispose(),kn.dispose(),ii.dispose(),ft.dispose(),Gt.dispose(),Gt.removeEventListener("sessionstart",He),Gt.removeEventListener("sessionend",nt),Ie.stop()};function Et(me){me.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),$=!0}function Ct(){console.log("THREE.WebGLRenderer: Context Restored."),$=!1;const me=xt.autoReset,$e=Nt.enabled,ot=Nt.autoUpdate,lt=Nt.needsUpdate,Je=Nt.type;Ne(),xt.autoReset=me,Nt.enabled=$e,Nt.autoUpdate=ot,Nt.needsUpdate=lt,Nt.type=Je}function Zt(me){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",me.statusMessage)}function xe(me){const $e=me.target;$e.removeEventListener("dispose",xe),te($e)}function te(me){ne(me),Pt.remove(me)}function ne(me){const $e=Pt.get(me).programs;$e!==void 0&&($e.forEach(function(ot){ft.releaseProgram(ot)}),me.isShaderMaterial&&ft.releaseShaderCache(me))}this.renderBufferDirect=function(me,$e,ot,lt,Je,jt){$e===null&&($e=Mn);const en=Je.isMesh&&Je.matrixWorld.determinant()<0,En=Vn(me,$e,ot,lt,Je);Ue.setMaterial(lt,en);let Yt=ot.index,jn=1;if(lt.wireframe===!0){if(Yt=Ge.getWireframeAttribute(ot),Yt===void 0)return;jn=2}const Zn=ot.drawRange,In=ot.attributes.position;let ri=Zn.start*jn,ur=(Zn.start+Zn.count)*jn;jt!==null&&(ri=Math.max(ri,jt.start*jn),ur=Math.min(ur,(jt.start+jt.count)*jn)),Yt!==null?(ri=Math.max(ri,0),ur=Math.min(ur,Yt.count)):In!=null&&(ri=Math.max(ri,0),ur=Math.min(ur,In.count));const mi=ur-ri;if(mi<0||mi===1/0)return;kn.setup(Je,lt,En,ot,Yt);let Ni,wi=yt;if(Yt!==null&&(Ni=Xe.get(Yt),wi=Tt,wi.setIndex(Ni)),Je.isMesh)lt.wireframe===!0?(Ue.setLineWidth(lt.wireframeLinewidth*Kn()),wi.setMode(Re.LINES)):wi.setMode(Re.TRIANGLES);else if(Je.isLine){let Fn=lt.linewidth;Fn===void 0&&(Fn=1),Ue.setLineWidth(Fn*Kn()),Je.isLineSegments?wi.setMode(Re.LINES):Je.isLineLoop?wi.setMode(Re.LINE_LOOP):wi.setMode(Re.LINE_STRIP)}else Je.isPoints?wi.setMode(Re.POINTS):Je.isSprite&&wi.setMode(Re.TRIANGLES);if(Je.isBatchedMesh)if(Je._multiDrawInstances!==null)wi.renderMultiDrawInstances(Je._multiDrawStarts,Je._multiDrawCounts,Je._multiDrawCount,Je._multiDrawInstances);else if(Ln.get("WEBGL_multi_draw"))wi.renderMultiDraw(Je._multiDrawStarts,Je._multiDrawCounts,Je._multiDrawCount);else{const Fn=Je._multiDrawStarts,di=Je._multiDrawCounts,li=Je._multiDrawCount,Or=Yt?Xe.get(Yt).bytesPerElement:1,$i=Pt.get(lt).currentProgram.getUniforms();for(let Fr=0;Fr<li;Fr++)$i.setValue(Re,"_gl_DrawID",Fr),wi.render(Fn[Fr]/Or,di[Fr])}else if(Je.isInstancedMesh)wi.renderInstances(ri,mi,Je.count);else if(ot.isInstancedBufferGeometry){const Fn=ot._maxInstanceCount!==void 0?ot._maxInstanceCount:1/0,di=Math.min(ot.instanceCount,Fn);wi.renderInstances(ri,mi,di)}else wi.render(ri,mi)};function de(me,$e,ot){me.transparent===!0&&me.side===Wu&&me.forceSinglePass===!1?(me.side=ua,me.needsUpdate=!0,Sn(me,$e,ot),me.side=ed,me.needsUpdate=!0,Sn(me,$e,ot),me.side=Wu):Sn(me,$e,ot)}this.compile=function(me,$e,ot=null){ot===null&&(ot=me),L=it.get(ot),L.init($e),N.push(L),ot.traverseVisible(function(Je){Je.isLight&&Je.layers.test($e.layers)&&(L.pushLight(Je),Je.castShadow&&L.pushShadow(Je))}),me!==ot&&me.traverseVisible(function(Je){Je.isLight&&Je.layers.test($e.layers)&&(L.pushLight(Je),Je.castShadow&&L.pushShadow(Je))}),L.setupLights();const lt=new Set;return me.traverse(function(Je){const jt=Je.material;if(jt)if(Array.isArray(jt))for(let en=0;en<jt.length;en++){const En=jt[en];de(En,ot,Je),lt.add(En)}else de(jt,ot,Je),lt.add(jt)}),N.pop(),L=null,lt},this.compileAsync=function(me,$e,ot=null){const lt=this.compile(me,$e,ot);return new Promise(Je=>{function jt(){if(lt.forEach(function(en){Pt.get(en).currentProgram.isReady()&&lt.delete(en)}),lt.size===0){Je(me);return}setTimeout(jt,10)}Ln.get("KHR_parallel_shader_compile")!==null?jt():setTimeout(jt,10)})};let we=null;function Fe(me){we&&we(me)}function He(){Ie.stop()}function nt(){Ie.start()}const Ie=new ck;Ie.setAnimationLoop(Fe),typeof self<"u"&&Ie.setContext(self),this.setAnimationLoop=function(me){we=me,Gt.setAnimationLoop(me),me===null?Ie.stop():Ie.start()},Gt.addEventListener("sessionstart",He),Gt.addEventListener("sessionend",nt),this.render=function(me,$e){if($e!==void 0&&$e.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if($===!0)return;if(me.matrixWorldAutoUpdate===!0&&me.updateMatrixWorld(),$e.parent===null&&$e.matrixWorldAutoUpdate===!0&&$e.updateMatrixWorld(),Gt.enabled===!0&&Gt.isPresenting===!0&&(Gt.cameraAutoUpdate===!0&&Gt.updateCamera($e),$e=Gt.getCamera()),me.isScene===!0&&me.onBeforeRender(B,me,$e,W),L=it.get(me,N.length),L.init($e),N.push(L),zt.multiplyMatrices($e.projectionMatrix,$e.matrixWorldInverse),Xt.setFromProjectionMatrix(zt),_t=this.localClippingEnabled,Ke=On.init(this.clippingPlanes,_t),D=$t.get(me,P.length),D.init(),P.push(D),Gt.enabled===!0&&Gt.isPresenting===!0){const jt=B.xr.getDepthSensingMesh();jt!==null&&ut(jt,$e,-1/0,B.sortObjects)}ut(me,$e,0,B.sortObjects),D.finish(),B.sortObjects===!0&&D.sort(ge,Be),Bt=Gt.enabled===!1||Gt.isPresenting===!1||Gt.hasDepthSensing()===!1,Bt&&on.addToRenderList(D,me),this.info.render.frame++,Ke===!0&&On.beginShadows();const ot=L.state.shadowsArray;Nt.render(ot,me,$e),Ke===!0&&On.endShadows(),this.info.autoReset===!0&&this.info.reset();const lt=D.opaque,Je=D.transmissive;if(L.setupLights(),$e.isArrayCamera){const jt=$e.cameras;if(Je.length>0)for(let en=0,En=jt.length;en<En;en++){const Yt=jt[en];ct(lt,Je,me,Yt)}Bt&&on.render(me);for(let en=0,En=jt.length;en<En;en++){const Yt=jt[en];bt(D,me,Yt,Yt.viewport)}}else Je.length>0&&ct(lt,Je,me,$e),Bt&&on.render(me),bt(D,me,$e);W!==null&&(mt.updateMultisampleRenderTarget(W),mt.updateRenderTargetMipmap(W)),me.isScene===!0&&me.onAfterRender(B,me,$e),kn.resetDefaultState(),ie=-1,Z=null,N.pop(),N.length>0?(L=N[N.length-1],Ke===!0&&On.setGlobalState(B.clippingPlanes,L.state.camera)):L=null,P.pop(),P.length>0?D=P[P.length-1]:D=null};function ut(me,$e,ot,lt){if(me.visible===!1)return;if(me.layers.test($e.layers)){if(me.isGroup)ot=me.renderOrder;else if(me.isLOD)me.autoUpdate===!0&&me.update($e);else if(me.isLight)L.pushLight(me),me.castShadow&&L.pushShadow(me);else if(me.isSprite){if(!me.frustumCulled||Xt.intersectsSprite(me)){lt&&fn.setFromMatrixPosition(me.matrixWorld).applyMatrix4(zt);const en=st.update(me),En=me.material;En.visible&&D.push(me,en,En,ot,fn.z,null)}}else if((me.isMesh||me.isLine||me.isPoints)&&(!me.frustumCulled||Xt.intersectsObject(me))){const en=st.update(me),En=me.material;if(lt&&(me.boundingSphere!==void 0?(me.boundingSphere===null&&me.computeBoundingSphere(),fn.copy(me.boundingSphere.center)):(en.boundingSphere===null&&en.computeBoundingSphere(),fn.copy(en.boundingSphere.center)),fn.applyMatrix4(me.matrixWorld).applyMatrix4(zt)),Array.isArray(En)){const Yt=en.groups;for(let jn=0,Zn=Yt.length;jn<Zn;jn++){const In=Yt[jn],ri=En[In.materialIndex];ri&&ri.visible&&D.push(me,en,ri,ot,fn.z,In)}}else En.visible&&D.push(me,en,En,ot,fn.z,null)}}const jt=me.children;for(let en=0,En=jt.length;en<En;en++)ut(jt[en],$e,ot,lt)}function bt(me,$e,ot,lt){const Je=me.opaque,jt=me.transmissive,en=me.transparent;L.setupLightsView(ot),Ke===!0&&On.setGlobalState(B.clippingPlanes,ot),lt&&Ue.viewport(X.copy(lt)),Je.length>0&&Wt(Je,$e,ot),jt.length>0&&Wt(jt,$e,ot),en.length>0&&Wt(en,$e,ot),Ue.buffers.depth.setTest(!0),Ue.buffers.depth.setMask(!0),Ue.buffers.color.setMask(!0),Ue.setPolygonOffset(!1)}function ct(me,$e,ot,lt){if((ot.isScene===!0?ot.overrideMaterial:null)!==null)return;L.state.transmissionRenderTarget[lt.id]===void 0&&(L.state.transmissionRenderTarget[lt.id]=new sd(1,1,{generateMipmaps:!0,type:Ln.has("EXT_color_buffer_half_float")||Ln.has("EXT_color_buffer_float")?J0:ju,minFilter:id,samples:4,stencilBuffer:a,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:Ki.workingColorSpace}));const jt=L.state.transmissionRenderTarget[lt.id],en=lt.viewport||X;jt.setSize(en.z,en.w);const En=B.getRenderTarget();B.setRenderTarget(jt),B.getClearColor(Se),Me=B.getClearAlpha(),Me<1&&B.setClearColor(16777215,.5),B.clear(),Bt&&on.render(ot);const Yt=B.toneMapping;B.toneMapping=nd;const jn=lt.viewport;if(lt.viewport!==void 0&&(lt.viewport=void 0),L.setupLightsView(lt),Ke===!0&&On.setGlobalState(B.clippingPlanes,lt),Wt(me,ot,lt),mt.updateMultisampleRenderTarget(jt),mt.updateRenderTargetMipmap(jt),Ln.has("WEBGL_multisampled_render_to_texture")===!1){let Zn=!1;for(let In=0,ri=$e.length;In<ri;In++){const ur=$e[In],mi=ur.object,Ni=ur.geometry,wi=ur.material,Fn=ur.group;if(wi.side===Wu&&mi.layers.test(lt.layers)){const di=wi.side;wi.side=ua,wi.needsUpdate=!0,bn(mi,ot,lt,Ni,wi,Fn),wi.side=di,wi.needsUpdate=!0,Zn=!0}}Zn===!0&&(mt.updateMultisampleRenderTarget(jt),mt.updateRenderTargetMipmap(jt))}B.setRenderTarget(En),B.setClearColor(Se,Me),jn!==void 0&&(lt.viewport=jn),B.toneMapping=Yt}function Wt(me,$e,ot){const lt=$e.isScene===!0?$e.overrideMaterial:null;for(let Je=0,jt=me.length;Je<jt;Je++){const en=me[Je],En=en.object,Yt=en.geometry,jn=lt===null?en.material:lt,Zn=en.group;En.layers.test(ot.layers)&&bn(En,$e,ot,Yt,jn,Zn)}}function bn(me,$e,ot,lt,Je,jt){me.onBeforeRender(B,$e,ot,lt,Je,jt),me.modelViewMatrix.multiplyMatrices(ot.matrixWorldInverse,me.matrixWorld),me.normalMatrix.getNormalMatrix(me.modelViewMatrix),Je.transparent===!0&&Je.side===Wu&&Je.forceSinglePass===!1?(Je.side=ua,Je.needsUpdate=!0,B.renderBufferDirect(ot,$e,lt,Je,me,jt),Je.side=ed,Je.needsUpdate=!0,B.renderBufferDirect(ot,$e,lt,Je,me,jt),Je.side=Wu):B.renderBufferDirect(ot,$e,lt,Je,me,jt),me.onAfterRender(B,$e,ot,lt,Je,jt)}function Sn(me,$e,ot){$e.isScene!==!0&&($e=Mn);const lt=Pt.get(me),Je=L.state.lights,jt=L.state.shadowsArray,en=Je.state.version,En=ft.getParameters(me,Je.state,jt,$e,ot),Yt=ft.getProgramCacheKey(En);let jn=lt.programs;lt.environment=me.isMeshStandardMaterial?$e.environment:null,lt.fog=$e.fog,lt.envMap=(me.isMeshStandardMaterial?re:ve).get(me.envMap||lt.environment),lt.envMapRotation=lt.environment!==null&&me.envMap===null?$e.environmentRotation:me.envMapRotation,jn===void 0&&(me.addEventListener("dispose",xe),jn=new Map,lt.programs=jn);let Zn=jn.get(Yt);if(Zn!==void 0){if(lt.currentProgram===Zn&&lt.lightsStateVersion===en)return ui(me,En),Zn}else En.uniforms=ft.getUniforms(me),me.onBeforeCompile(En,B),Zn=ft.acquireProgram(En,Yt),jn.set(Yt,Zn),lt.uniforms=En.uniforms;const In=lt.uniforms;return(!me.isShaderMaterial&&!me.isRawShaderMaterial||me.clipping===!0)&&(In.clippingPlanes=On.uniform),ui(me,En),lt.needsLights=qi(me),lt.lightsStateVersion=en,lt.needsLights&&(In.ambientLightColor.value=Je.state.ambient,In.lightProbe.value=Je.state.probe,In.directionalLights.value=Je.state.directional,In.directionalLightShadows.value=Je.state.directionalShadow,In.spotLights.value=Je.state.spot,In.spotLightShadows.value=Je.state.spotShadow,In.rectAreaLights.value=Je.state.rectArea,In.ltc_1.value=Je.state.rectAreaLTC1,In.ltc_2.value=Je.state.rectAreaLTC2,In.pointLights.value=Je.state.point,In.pointLightShadows.value=Je.state.pointShadow,In.hemisphereLights.value=Je.state.hemi,In.directionalShadowMap.value=Je.state.directionalShadowMap,In.directionalShadowMatrix.value=Je.state.directionalShadowMatrix,In.spotShadowMap.value=Je.state.spotShadowMap,In.spotLightMatrix.value=Je.state.spotLightMatrix,In.spotLightMap.value=Je.state.spotLightMap,In.pointShadowMap.value=Je.state.pointShadowMap,In.pointShadowMatrix.value=Je.state.pointShadowMatrix),lt.currentProgram=Zn,lt.uniformsList=null,Zn}function Bn(me){if(me.uniformsList===null){const $e=me.currentProgram.getUniforms();me.uniformsList=G1.seqWithValue($e.seq,me.uniforms)}return me.uniformsList}function ui(me,$e){const ot=Pt.get(me);ot.outputColorSpace=$e.outputColorSpace,ot.batching=$e.batching,ot.batchingColor=$e.batchingColor,ot.instancing=$e.instancing,ot.instancingColor=$e.instancingColor,ot.instancingMorph=$e.instancingMorph,ot.skinning=$e.skinning,ot.morphTargets=$e.morphTargets,ot.morphNormals=$e.morphNormals,ot.morphColors=$e.morphColors,ot.morphTargetsCount=$e.morphTargetsCount,ot.numClippingPlanes=$e.numClippingPlanes,ot.numIntersection=$e.numClipIntersection,ot.vertexAlphas=$e.vertexAlphas,ot.vertexTangents=$e.vertexTangents,ot.toneMapping=$e.toneMapping}function Vn(me,$e,ot,lt,Je){$e.isScene!==!0&&($e=Mn),mt.resetTextureUnits();const jt=$e.fog,en=lt.isMeshStandardMaterial?$e.environment:null,En=W===null?B.outputColorSpace:W.isXRRenderTarget===!0?W.texture.colorSpace:Xu,Yt=(lt.isMeshStandardMaterial?re:ve).get(lt.envMap||en),jn=lt.vertexColors===!0&&!!ot.attributes.color&&ot.attributes.color.itemSize===4,Zn=!!ot.attributes.tangent&&(!!lt.normalMap||lt.anisotropy>0),In=!!ot.morphAttributes.position,ri=!!ot.morphAttributes.normal,ur=!!ot.morphAttributes.color;let mi=nd;lt.toneMapped&&(W===null||W.isXRRenderTarget===!0)&&(mi=B.toneMapping);const Ni=ot.morphAttributes.position||ot.morphAttributes.normal||ot.morphAttributes.color,wi=Ni!==void 0?Ni.length:0,Fn=Pt.get(lt),di=L.state.lights;if(Ke===!0&&(_t===!0||me!==Z)){const Qr=me===Z&&lt.id===ie;On.setState(lt,me,Qr)}let li=!1;lt.version===Fn.__version?(Fn.needsLights&&Fn.lightsStateVersion!==di.state.version||Fn.outputColorSpace!==En||Je.isBatchedMesh&&Fn.batching===!1||!Je.isBatchedMesh&&Fn.batching===!0||Je.isBatchedMesh&&Fn.batchingColor===!0&&Je.colorTexture===null||Je.isBatchedMesh&&Fn.batchingColor===!1&&Je.colorTexture!==null||Je.isInstancedMesh&&Fn.instancing===!1||!Je.isInstancedMesh&&Fn.instancing===!0||Je.isSkinnedMesh&&Fn.skinning===!1||!Je.isSkinnedMesh&&Fn.skinning===!0||Je.isInstancedMesh&&Fn.instancingColor===!0&&Je.instanceColor===null||Je.isInstancedMesh&&Fn.instancingColor===!1&&Je.instanceColor!==null||Je.isInstancedMesh&&Fn.instancingMorph===!0&&Je.morphTexture===null||Je.isInstancedMesh&&Fn.instancingMorph===!1&&Je.morphTexture!==null||Fn.envMap!==Yt||lt.fog===!0&&Fn.fog!==jt||Fn.numClippingPlanes!==void 0&&(Fn.numClippingPlanes!==On.numPlanes||Fn.numIntersection!==On.numIntersection)||Fn.vertexAlphas!==jn||Fn.vertexTangents!==Zn||Fn.morphTargets!==In||Fn.morphNormals!==ri||Fn.morphColors!==ur||Fn.toneMapping!==mi||Fn.morphTargetsCount!==wi)&&(li=!0):(li=!0,Fn.__version=lt.version);let Or=Fn.currentProgram;li===!0&&(Or=Sn(lt,$e,Je));let $i=!1,Fr=!1,vs=!1;const Qi=Or.getUniforms(),zr=Fn.uniforms;if(Ue.useProgram(Or.program)&&($i=!0,Fr=!0,vs=!0),lt.id!==ie&&(ie=lt.id,Fr=!0),$i||Z!==me){Qi.setValue(Re,"projectionMatrix",me.projectionMatrix),Qi.setValue(Re,"viewMatrix",me.matrixWorldInverse);const Qr=Qi.map.cameraPosition;Qr!==void 0&&Qr.setValue(Re,Rt.setFromMatrixPosition(me.matrixWorld)),Cn.logarithmicDepthBuffer&&Qi.setValue(Re,"logDepthBufFC",2/(Math.log(me.far+1)/Math.LN2)),(lt.isMeshPhongMaterial||lt.isMeshToonMaterial||lt.isMeshLambertMaterial||lt.isMeshBasicMaterial||lt.isMeshStandardMaterial||lt.isShaderMaterial)&&Qi.setValue(Re,"isOrthographic",me.isOrthographicCamera===!0),Z!==me&&(Z=me,Fr=!0,vs=!0)}if(Je.isSkinnedMesh){Qi.setOptional(Re,Je,"bindMatrix"),Qi.setOptional(Re,Je,"bindMatrixInverse");const Qr=Je.skeleton;Qr&&(Qr.boneTexture===null&&Qr.computeBoneTexture(),Qi.setValue(Re,"boneTexture",Qr.boneTexture,mt))}Je.isBatchedMesh&&(Qi.setOptional(Re,Je,"batchingTexture"),Qi.setValue(Re,"batchingTexture",Je._matricesTexture,mt),Qi.setOptional(Re,Je,"batchingIdTexture"),Qi.setValue(Re,"batchingIdTexture",Je._indirectTexture,mt),Qi.setOptional(Re,Je,"batchingColorTexture"),Je._colorsTexture!==null&&Qi.setValue(Re,"batchingColorTexture",Je._colorsTexture,mt));const Ol=ot.morphAttributes;if((Ol.position!==void 0||Ol.normal!==void 0||Ol.color!==void 0)&&Wn.update(Je,ot,Or),(Fr||Fn.receiveShadow!==Je.receiveShadow)&&(Fn.receiveShadow=Je.receiveShadow,Qi.setValue(Re,"receiveShadow",Je.receiveShadow)),lt.isMeshGouraudMaterial&&lt.envMap!==null&&(zr.envMap.value=Yt,zr.flipEnvMap.value=Yt.isCubeTexture&&Yt.isRenderTargetTexture===!1?-1:1),lt.isMeshStandardMaterial&&lt.envMap===null&&$e.environment!==null&&(zr.envMapIntensity.value=$e.environmentIntensity),Fr&&(Qi.setValue(Re,"toneMappingExposure",B.toneMappingExposure),Fn.needsLights&&Di(zr,vs),jt&&lt.fog===!0&&Ht.refreshFogUniforms(zr,jt),Ht.refreshMaterialUniforms(zr,lt,Ce,ye,L.state.transmissionRenderTarget[me.id]),G1.upload(Re,Bn(Fn),zr,mt)),lt.isShaderMaterial&&lt.uniformsNeedUpdate===!0&&(G1.upload(Re,Bn(Fn),zr,mt),lt.uniformsNeedUpdate=!1),lt.isSpriteMaterial&&Qi.setValue(Re,"center",Je.center),Qi.setValue(Re,"modelViewMatrix",Je.modelViewMatrix),Qi.setValue(Re,"normalMatrix",Je.normalMatrix),Qi.setValue(Re,"modelMatrix",Je.matrixWorld),lt.isShaderMaterial||lt.isRawShaderMaterial){const Qr=lt.uniformsGroups;for(let uo=0,yi=Qr.length;uo<yi;uo++){const il=Qr[uo];ii.update(il,Or),ii.bind(il,Or)}}return Or}function Di(me,$e){me.ambientLightColor.needsUpdate=$e,me.lightProbe.needsUpdate=$e,me.directionalLights.needsUpdate=$e,me.directionalLightShadows.needsUpdate=$e,me.pointLights.needsUpdate=$e,me.pointLightShadows.needsUpdate=$e,me.spotLights.needsUpdate=$e,me.spotLightShadows.needsUpdate=$e,me.rectAreaLights.needsUpdate=$e,me.hemisphereLights.needsUpdate=$e}function qi(me){return me.isMeshLambertMaterial||me.isMeshToonMaterial||me.isMeshPhongMaterial||me.isMeshStandardMaterial||me.isShadowMaterial||me.isShaderMaterial&&me.lights===!0}this.getActiveCubeFace=function(){return K},this.getActiveMipmapLevel=function(){return q},this.getRenderTarget=function(){return W},this.setRenderTargetTextures=function(me,$e,ot){Pt.get(me.texture).__webglTexture=$e,Pt.get(me.depthTexture).__webglTexture=ot;const lt=Pt.get(me);lt.__hasExternalTextures=!0,lt.__autoAllocateDepthBuffer=ot===void 0,lt.__autoAllocateDepthBuffer||Ln.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),lt.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(me,$e){const ot=Pt.get(me);ot.__webglFramebuffer=$e,ot.__useDefaultFramebuffer=$e===void 0},this.setRenderTarget=function(me,$e=0,ot=0){W=me,K=$e,q=ot;let lt=!0,Je=null,jt=!1,en=!1;if(me){const Yt=Pt.get(me);Yt.__useDefaultFramebuffer!==void 0?(Ue.bindFramebuffer(Re.FRAMEBUFFER,null),lt=!1):Yt.__webglFramebuffer===void 0?mt.setupRenderTarget(me):Yt.__hasExternalTextures&&mt.rebindTextures(me,Pt.get(me.texture).__webglTexture,Pt.get(me.depthTexture).__webglTexture);const jn=me.texture;(jn.isData3DTexture||jn.isDataArrayTexture||jn.isCompressedArrayTexture)&&(en=!0);const Zn=Pt.get(me).__webglFramebuffer;me.isWebGLCubeRenderTarget?(Array.isArray(Zn[$e])?Je=Zn[$e][ot]:Je=Zn[$e],jt=!0):me.samples>0&&mt.useMultisampledRTT(me)===!1?Je=Pt.get(me).__webglMultisampledFramebuffer:Array.isArray(Zn)?Je=Zn[ot]:Je=Zn,X.copy(me.viewport),se.copy(me.scissor),De=me.scissorTest}else X.copy(Ze).multiplyScalar(Ce).floor(),se.copy(je).multiplyScalar(Ce).floor(),De=wt;if(Ue.bindFramebuffer(Re.FRAMEBUFFER,Je)&&lt&&Ue.drawBuffers(me,Je),Ue.viewport(X),Ue.scissor(se),Ue.setScissorTest(De),jt){const Yt=Pt.get(me.texture);Re.framebufferTexture2D(Re.FRAMEBUFFER,Re.COLOR_ATTACHMENT0,Re.TEXTURE_CUBE_MAP_POSITIVE_X+$e,Yt.__webglTexture,ot)}else if(en){const Yt=Pt.get(me.texture),jn=$e||0;Re.framebufferTextureLayer(Re.FRAMEBUFFER,Re.COLOR_ATTACHMENT0,Yt.__webglTexture,ot||0,jn)}ie=-1},this.readRenderTargetPixels=function(me,$e,ot,lt,Je,jt,en){if(!(me&&me.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let En=Pt.get(me).__webglFramebuffer;if(me.isWebGLCubeRenderTarget&&en!==void 0&&(En=En[en]),En){Ue.bindFramebuffer(Re.FRAMEBUFFER,En);try{const Yt=me.texture,jn=Yt.format,Zn=Yt.type;if(!Cn.textureFormatReadable(jn)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!Cn.textureTypeReadable(Zn)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}$e>=0&&$e<=me.width-lt&&ot>=0&&ot<=me.height-Je&&Re.readPixels($e,ot,lt,Je,Vt.convert(jn),Vt.convert(Zn),jt)}finally{const Yt=W!==null?Pt.get(W).__webglFramebuffer:null;Ue.bindFramebuffer(Re.FRAMEBUFFER,Yt)}}},this.readRenderTargetPixelsAsync=async function(me,$e,ot,lt,Je,jt,en){if(!(me&&me.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let En=Pt.get(me).__webglFramebuffer;if(me.isWebGLCubeRenderTarget&&en!==void 0&&(En=En[en]),En){Ue.bindFramebuffer(Re.FRAMEBUFFER,En);try{const Yt=me.texture,jn=Yt.format,Zn=Yt.type;if(!Cn.textureFormatReadable(jn))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!Cn.textureTypeReadable(Zn))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");if($e>=0&&$e<=me.width-lt&&ot>=0&&ot<=me.height-Je){const In=Re.createBuffer();Re.bindBuffer(Re.PIXEL_PACK_BUFFER,In),Re.bufferData(Re.PIXEL_PACK_BUFFER,jt.byteLength,Re.STREAM_READ),Re.readPixels($e,ot,lt,Je,Vt.convert(jn),Vt.convert(Zn),0),Re.flush();const ri=Re.fenceSync(Re.SYNC_GPU_COMMANDS_COMPLETE,0);await BV(Re,ri,4);try{Re.bindBuffer(Re.PIXEL_PACK_BUFFER,In),Re.getBufferSubData(Re.PIXEL_PACK_BUFFER,0,jt)}finally{Re.deleteBuffer(In),Re.deleteSync(ri)}return jt}}finally{const Yt=W!==null?Pt.get(W).__webglFramebuffer:null;Ue.bindFramebuffer(Re.FRAMEBUFFER,Yt)}}},this.copyFramebufferToTexture=function(me,$e=null,ot=0){me.isTexture!==!0&&(ny("WebGLRenderer: copyFramebufferToTexture function signature has changed."),$e=arguments[0]||null,me=arguments[1]);const lt=Math.pow(2,-ot),Je=Math.floor(me.image.width*lt),jt=Math.floor(me.image.height*lt),en=$e!==null?$e.x:0,En=$e!==null?$e.y:0;mt.setTexture2D(me,0),Re.copyTexSubImage2D(Re.TEXTURE_2D,ot,0,0,en,En,Je,jt),Ue.unbindTexture()},this.copyTextureToTexture=function(me,$e,ot=null,lt=null,Je=0){me.isTexture!==!0&&(ny("WebGLRenderer: copyTextureToTexture function signature has changed."),lt=arguments[0]||null,me=arguments[1],$e=arguments[2],Je=arguments[3]||0,ot=null);let jt,en,En,Yt,jn,Zn;ot!==null?(jt=ot.max.x-ot.min.x,en=ot.max.y-ot.min.y,En=ot.min.x,Yt=ot.min.y):(jt=me.image.width,en=me.image.height,En=0,Yt=0),lt!==null?(jn=lt.x,Zn=lt.y):(jn=0,Zn=0);const In=Vt.convert($e.format),ri=Vt.convert($e.type);mt.setTexture2D($e,0),Re.pixelStorei(Re.UNPACK_FLIP_Y_WEBGL,$e.flipY),Re.pixelStorei(Re.UNPACK_PREMULTIPLY_ALPHA_WEBGL,$e.premultiplyAlpha),Re.pixelStorei(Re.UNPACK_ALIGNMENT,$e.unpackAlignment);const ur=Re.getParameter(Re.UNPACK_ROW_LENGTH),mi=Re.getParameter(Re.UNPACK_IMAGE_HEIGHT),Ni=Re.getParameter(Re.UNPACK_SKIP_PIXELS),wi=Re.getParameter(Re.UNPACK_SKIP_ROWS),Fn=Re.getParameter(Re.UNPACK_SKIP_IMAGES),di=me.isCompressedTexture?me.mipmaps[Je]:me.image;Re.pixelStorei(Re.UNPACK_ROW_LENGTH,di.width),Re.pixelStorei(Re.UNPACK_IMAGE_HEIGHT,di.height),Re.pixelStorei(Re.UNPACK_SKIP_PIXELS,En),Re.pixelStorei(Re.UNPACK_SKIP_ROWS,Yt),me.isDataTexture?Re.texSubImage2D(Re.TEXTURE_2D,Je,jn,Zn,jt,en,In,ri,di.data):me.isCompressedTexture?Re.compressedTexSubImage2D(Re.TEXTURE_2D,Je,jn,Zn,di.width,di.height,In,di.data):Re.texSubImage2D(Re.TEXTURE_2D,Je,jn,Zn,jt,en,In,ri,di),Re.pixelStorei(Re.UNPACK_ROW_LENGTH,ur),Re.pixelStorei(Re.UNPACK_IMAGE_HEIGHT,mi),Re.pixelStorei(Re.UNPACK_SKIP_PIXELS,Ni),Re.pixelStorei(Re.UNPACK_SKIP_ROWS,wi),Re.pixelStorei(Re.UNPACK_SKIP_IMAGES,Fn),Je===0&&$e.generateMipmaps&&Re.generateMipmap(Re.TEXTURE_2D),Ue.unbindTexture()},this.copyTextureToTexture3D=function(me,$e,ot=null,lt=null,Je=0){me.isTexture!==!0&&(ny("WebGLRenderer: copyTextureToTexture3D function signature has changed."),ot=arguments[0]||null,lt=arguments[1]||null,me=arguments[2],$e=arguments[3],Je=arguments[4]||0);let jt,en,En,Yt,jn,Zn,In,ri,ur;const mi=me.isCompressedTexture?me.mipmaps[Je]:me.image;ot!==null?(jt=ot.max.x-ot.min.x,en=ot.max.y-ot.min.y,En=ot.max.z-ot.min.z,Yt=ot.min.x,jn=ot.min.y,Zn=ot.min.z):(jt=mi.width,en=mi.height,En=mi.depth,Yt=0,jn=0,Zn=0),lt!==null?(In=lt.x,ri=lt.y,ur=lt.z):(In=0,ri=0,ur=0);const Ni=Vt.convert($e.format),wi=Vt.convert($e.type);let Fn;if($e.isData3DTexture)mt.setTexture3D($e,0),Fn=Re.TEXTURE_3D;else if($e.isDataArrayTexture||$e.isCompressedArrayTexture)mt.setTexture2DArray($e,0),Fn=Re.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}Re.pixelStorei(Re.UNPACK_FLIP_Y_WEBGL,$e.flipY),Re.pixelStorei(Re.UNPACK_PREMULTIPLY_ALPHA_WEBGL,$e.premultiplyAlpha),Re.pixelStorei(Re.UNPACK_ALIGNMENT,$e.unpackAlignment);const di=Re.getParameter(Re.UNPACK_ROW_LENGTH),li=Re.getParameter(Re.UNPACK_IMAGE_HEIGHT),Or=Re.getParameter(Re.UNPACK_SKIP_PIXELS),$i=Re.getParameter(Re.UNPACK_SKIP_ROWS),Fr=Re.getParameter(Re.UNPACK_SKIP_IMAGES);Re.pixelStorei(Re.UNPACK_ROW_LENGTH,mi.width),Re.pixelStorei(Re.UNPACK_IMAGE_HEIGHT,mi.height),Re.pixelStorei(Re.UNPACK_SKIP_PIXELS,Yt),Re.pixelStorei(Re.UNPACK_SKIP_ROWS,jn),Re.pixelStorei(Re.UNPACK_SKIP_IMAGES,Zn),me.isDataTexture||me.isData3DTexture?Re.texSubImage3D(Fn,Je,In,ri,ur,jt,en,En,Ni,wi,mi.data):$e.isCompressedArrayTexture?Re.compressedTexSubImage3D(Fn,Je,In,ri,ur,jt,en,En,Ni,mi.data):Re.texSubImage3D(Fn,Je,In,ri,ur,jt,en,En,Ni,wi,mi),Re.pixelStorei(Re.UNPACK_ROW_LENGTH,di),Re.pixelStorei(Re.UNPACK_IMAGE_HEIGHT,li),Re.pixelStorei(Re.UNPACK_SKIP_PIXELS,Or),Re.pixelStorei(Re.UNPACK_SKIP_ROWS,$i),Re.pixelStorei(Re.UNPACK_SKIP_IMAGES,Fr),Je===0&&$e.generateMipmaps&&Re.generateMipmap(Fn),Ue.unbindTexture()},this.initRenderTarget=function(me){Pt.get(me).__webglFramebuffer===void 0&&mt.setupRenderTarget(me)},this.initTexture=function(me){me.isCubeTexture?mt.setTextureCube(me,0):me.isData3DTexture?mt.setTexture3D(me,0):me.isDataArrayTexture||me.isCompressedArrayTexture?mt.setTexture2DArray(me,0):mt.setTexture2D(me,0),Ue.unbindTexture()},this.resetState=function(){K=0,q=0,W=null,Ue.reset(),kn.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Zu}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const n=this.getContext();n.drawingBufferColorSpace=e===OM?"display-p3":"srgb",n.unpackColorSpace=Ki.workingColorSpace===f1?"display-p3":"srgb"}}let Bk=class extends Qu{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new ud,this.environmentIntensity=1,this.environmentRotation=new ud,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,n){return super.copy(e,n),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const n=super.toJSON(e);return this.fog!==null&&(n.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(n.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(n.object.backgroundIntensity=this.backgroundIntensity),n.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(n.object.environmentIntensity=this.environmentIntensity),n.object.environmentRotation=this.environmentRotation.toArray(),n}};class gW{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,n){const i=this.getUtoTmapping(e);return this.getPoint(i,n)}getPoints(e=5){const n=[];for(let i=0;i<=e;i++)n.push(this.getPoint(i/e));return n}getSpacedPoints(e=5){const n=[];for(let i=0;i<=e;i++)n.push(this.getPointAt(i/e));return n}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const n=[];let i,r=this.getPoint(0),a=0;n.push(0);for(let u=1;u<=e;u++)i=this.getPoint(u/e),a+=i.distanceTo(r),n.push(a),r=i;return this.cacheArcLengths=n,n}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,n){const i=this.getLengths();let r=0;const a=i.length;let u;n?u=n:u=e*i[a-1];let l=0,f=a-1,g;for(;l<=f;)if(r=Math.floor(l+(f-l)/2),g=i[r]-u,g<0)l=r+1;else if(g>0)f=r-1;else{f=r;break}if(r=f,i[r]===u)return r/(a-1);const y=i[r],b=i[r+1]-y,A=(u-y)/b;return(r+A)/(a-1)}getTangent(e,n){let r=e-1e-4,a=e+1e-4;r<0&&(r=0),a>1&&(a=1);const u=this.getPoint(r),l=this.getPoint(a),f=n||(u.isVector2?new Ui:new pt);return f.copy(l).sub(u).normalize(),f}getTangentAt(e,n){const i=this.getUtoTmapping(e);return this.getTangent(i,n)}computeFrenetFrames(e,n){const i=new pt,r=[],a=[],u=[],l=new pt,f=new Es;for(let A=0;A<=e;A++){const I=A/e;r[A]=this.getTangentAt(I,new pt)}a[0]=new pt,u[0]=new pt;let g=Number.MAX_VALUE;const y=Math.abs(r[0].x),S=Math.abs(r[0].y),b=Math.abs(r[0].z);y<=g&&(g=y,i.set(1,0,0)),S<=g&&(g=S,i.set(0,1,0)),b<=g&&i.set(0,0,1),l.crossVectors(r[0],i).normalize(),a[0].crossVectors(r[0],l),u[0].crossVectors(r[0],a[0]);for(let A=1;A<=e;A++){if(a[A]=a[A-1].clone(),u[A]=u[A-1].clone(),l.crossVectors(r[A-1],r[A]),l.length()>Number.EPSILON){l.normalize();const I=Math.acos(io(r[A-1].dot(r[A]),-1,1));a[A].applyMatrix4(f.makeRotationAxis(l,I))}u[A].crossVectors(r[A],a[A])}if(n===!0){let A=Math.acos(io(a[0].dot(a[e]),-1,1));A/=e,r[0].dot(l.crossVectors(a[0],a[e]))>0&&(A=-A);for(let I=1;I<=e;I++)a[I].applyMatrix4(f.makeRotationAxis(r[I],A*I)),u[I].crossVectors(r[I],a[I])}return{tangents:r,normals:a,binormals:u}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}function Uk(t,e,n,i,r){const a=(i-e)*.5,u=(r-n)*.5,l=t*t,f=t*l;return(2*n-2*i+a+u)*f+(-3*n+3*i-2*a-u)*l+a*t+n}class vW extends gW{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,n=new Ui){const i=n,r=this.points,a=(r.length-1)*e,u=Math.floor(a),l=a-u,f=r[u===0?u:u-1],g=r[u],y=r[u>r.length-2?r.length-1:u+1],S=r[u>r.length-3?r.length-1:u+2];return i.set(Uk(l,f.x,g.x,y.x,S.x),Uk(l,f.y,g.y,y.y,S.y)),i}copy(e){super.copy(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const r=e.points[n];this.points.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let n=0,i=this.points.length;n<i;n++){const r=this.points[n];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const r=e.points[n];this.points.push(new Ui().fromArray(r))}return this}}let Vk=class q8 extends sg{constructor(e=1,n=32,i=16,r=0,a=Math.PI*2,u=0,l=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:n,heightSegments:i,phiStart:r,phiLength:a,thetaStart:u,thetaLength:l},n=Math.max(3,Math.floor(n)),i=Math.max(2,Math.floor(i));const f=Math.min(u+l,Math.PI);let g=0;const y=[],S=new pt,b=new pt,A=[],I=[],D=[],L=[];for(let P=0;P<=i;P++){const N=[],B=P/i;let $=0;P===0&&u===0?$=.5/n:P===i&&f===Math.PI&&($=-.5/n);for(let K=0;K<=n;K++){const q=K/n;S.x=-e*Math.cos(r+q*a)*Math.sin(u+B*l),S.y=e*Math.cos(u+B*l),S.z=e*Math.sin(r+q*a)*Math.sin(u+B*l),I.push(S.x,S.y,S.z),b.copy(S).normalize(),D.push(b.x,b.y,b.z),L.push(q+$,1-B),N.push(g++)}y.push(N)}for(let P=0;P<i;P++)for(let N=0;N<n;N++){const B=y[P][N+1],$=y[P][N],K=y[P+1][N],q=y[P+1][N+1];(P!==0||u>0)&&A.push(B,$,q),(P!==i-1||f<Math.PI)&&A.push($,K,q)}this.setIndex(A),this.setAttribute("position",new Xc(I,3)),this.setAttribute("normal",new Xc(D,3)),this.setAttribute("uv",new Xc(L,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new q8(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}};const fC={enabled:!1};class yW{constructor(e,n,i){const r=this;let a=!1,u=0,l=0,f;const g=[];this.onStart=void 0,this.onLoad=e,this.onProgress=n,this.onError=i,this.itemStart=function(y){l++,a===!1&&r.onStart!==void 0&&r.onStart(y,u,l),a=!0},this.itemEnd=function(y){u++,r.onProgress!==void 0&&r.onProgress(y,u,l),u===l&&(a=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(y){r.onError!==void 0&&r.onError(y)},this.resolveURL=function(y){return f?f(y):y},this.setURLModifier=function(y){return f=y,this},this.addHandler=function(y,S){return g.push(y,S),this},this.removeHandler=function(y){const S=g.indexOf(y);return S!==-1&&g.splice(S,2),this},this.getHandler=function(y){for(let S=0,b=g.length;S<b;S+=2){const A=g[S],I=g[S+1];if(A.global&&(A.lastIndex=0),A.test(y))return I}return null}}}const _W=new yW;let pC=class{constructor(e){this.manager=e!==void 0?e:_W,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,n){const i=this;return new Promise(function(r,a){i.load(e,r,n,a)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}};pC.DEFAULT_MATERIAL_NAME="__DEFAULT";const $k=new Es;class xW{constructor(e,n,i=0,r=1/0){this.ray=new VL(e,n),this.near=i,this.far=r,this.camera=null,this.layers=new qM,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,n){this.ray.set(e,n)}setFromCamera(e,n){n.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(n.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(n).sub(this.ray.origin).normalize(),this.camera=n):n.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(n.near+n.far)/(n.near-n.far)).unproject(n),this.ray.direction.set(0,0,-1).transformDirection(n.matrixWorld),this.camera=n):console.error("THREE.Raycaster: Unsupported camera type: "+n.type)}setFromXRController(e){return $k.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4($k),this}intersectObject(e,n=!0,i=[]){return mC(e,this,i,n),i.sort(Hk),i}intersectObjects(e,n=!0,i=[]){for(let r=0,a=e.length;r<a;r++)mC(e[r],this,i,n);return i.sort(Hk),i}}function Hk(t,e){return t.distance-e.distance}function mC(t,e,n,i){let r=!0;if(t.layers.test(e.layers)&&t.raycast(e,n)===!1&&(r=!1),r===!0&&i===!0){const a=t.children;for(let u=0,l=a.length;u<l;u++)mC(a[u],e,n,!0)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:$o}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=$o);/*!
 * Photo Sphere Viewer 5.10.0
 * @copyright 2014-2015 Jrmy Heleine
 * @copyright 2015-2024 Damien "Mistic" Sorel
 * @licence MIT (https://opensource.org/licenses/MIT)
 */var bW=Object.defineProperty,gC=(t,e)=>{for(var n in e)bW(t,n,{get:e[n],enumerable:!0})},pd={};gC(pd,{ACTIONS:()=>Yk,ANIMATION_MIN_DURATION:()=>vC,CAPTURE_EVENTS_CLASS:()=>uy,CTRLZOOM_TIMEOUT:()=>Zk,DBLCLICK_DELAY:()=>jk,DEFAULT_TRANSITION:()=>Gk,EASINGS:()=>j1,ICONS:()=>ac,IDS:()=>ro,INERTIA_WINDOW:()=>yC,KEY_CODES:()=>$s,LONGTOUCH_DELAY:()=>qk,MOVE_THRESHOLD:()=>Wk,SPHERE_RADIUS:()=>gg,TWOFINGERSOVERLAY_DELAY:()=>Xk,VIEWER_DATA:()=>md});var wW=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="40 40 432 432"><g transform="rotate(0, 256, 256)"><path fill="currentColor" d="M425.23 210.55H227.39a5 5 0 01-3.53-8.53l56.56-56.57a45.5 45.5 0 000-64.28 45.15 45.15 0 00-32.13-13.3 45.15 45.15 0 00-32.14 13.3L41.32 256l174.83 174.83a45.15 45.15 0 0032.14 13.3 45.15 45.15 0 0032.13-13.3 45.5 45.5 0 000-64.28l-56.57-56.57a5 5 0 013.54-8.53h197.84c25.06 0 45.45-20.39 45.45-45.45s-20.4-45.45-45.45-45.45z"/></g><!-- Created by Flatart from the Noun Project --></svg>
`,SW='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><g fill="currentColor" transform=" translate(50, 50) rotate(45)"><rect x="-5" y="-65" width="10" height="130"/><rect x="-65" y="-5" width="130" height="10"/></g></svg>',EW=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M83.3 35.6h-17V3H32.2v32.6H16.6l33.6 32.7 33-32.7z"/><path fill="currentColor" d="M83.3 64.2v16.3H16.6V64.2H-.1v32.6H100V64.2H83.3z"/><!--Created by Michael Zenaty from the Noun Project--></svg>
`,MW=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M100 40H87.1V18.8h-21V6H100zM100 93.2H66V80.3h21.1v-21H100zM34 93.2H0v-34h12.9v21.1h21zM12.9 40H0V6h34v12.9H12.8z"/><!--Created by Garrett Knoll from the Noun Project--></svg>
`,CW=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M66 7h13v21h21v13H66zM66 60.3h34v12.9H79v21H66zM0 60.3h34v34H21V73.1H0zM21 7h13v34H0V28h21z"/><!--Created by Garrett Knoll from the Noun Project--></svg>
`,TW=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64"><path fill="currentColor" d="M28.3 26.1c-1 2.6-1.9 4.8-2.6 7-2.5 7.4-5 14.7-7.2 22-1.3 4.4.5 7.2 4.3 7.8 1.3.2 2.8.2 4.2-.1 8.2-2 11.9-8.6 15.7-15.2l-2.2 2a18.8 18.8 0 0 1-7.4 5.2 2 2 0 0 1-1.6-.2c-.2-.1 0-1 0-1.4l.8-1.8L41.9 28c.5-1.4.9-3 .7-4.4-.2-2.6-3-4.4-6.3-4.4-8.8.2-15 4.5-19.5 11.8-.2.3-.2.6-.3 1.3 3.7-2.8 6.8-6.1 11.8-6.2z"/><circle fill="currentColor" cx="39.3" cy="9.2" r="8.2"/><!--Created by Arafat Uddin from the Noun Project--></svg>
`,AW=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="10 10 80 80"><g fill="currentColor"><circle r="10" cx="20" cy="20"/><circle r="10" cx="50" cy="20"/><circle r="10" cx="80" cy="20"/><circle r="10" cx="20" cy="50"/><circle r="10" cx="50" cy="50"/><circle r="10" cx="80" cy="50"/><circle r="10" cx="20" cy="80"/><circle r="10" cx="50" cy="80"/><circle r="10" cx="80" cy="80"/></g><!-- Created by Richard Kunk from the Noun Project--></svg>
`,PW=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill="currentColor" d="M14.043 12.22a7.738 7.738 0 1 0-1.823 1.822l4.985 4.985c.503.504 1.32.504 1.822 0a1.285 1.285 0 0 0 0-1.822l-4.984-4.985zm-6.305 1.043a5.527 5.527 0 1 1 0-11.053 5.527 5.527 0 0 1 0 11.053z"/><path fill="currentColor" d="M8.728 4.009H6.744v2.737H4.006V8.73h2.738v2.736h1.984V8.73h2.737V6.746H8.728z"/><!--Created by Ryan Canning from the Noun Project--></svg>
`,IW=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill="currentColor" d="M14.043 12.22a7.738 7.738 0 1 0-1.823 1.822l4.985 4.985c.503.504 1.32.504 1.822 0a1.285 1.285 0 0 0 0-1.822l-4.984-4.985zm-6.305 1.043a5.527 5.527 0 1 1 0-11.053 5.527 5.527 0 0 1 0 11.053z"/><path fill="currentColor" d="M4.006 6.746h7.459V8.73H4.006z"/><!--Created by Ryan Canning from the Noun Project--></svg>
`,Gk=1500,vC=500,Wk=4,jk=300,qk=500,Xk=100,Zk=2e3,yC=300,gg=10,md="photoSphereViewer",uy="psv--capture-event",Yk=(t=>(t.ROTATE_UP="ROTATE_UP",t.ROTATE_DOWN="ROTATE_DOWN",t.ROTATE_RIGHT="ROTATE_RIGHT",t.ROTATE_LEFT="ROTATE_LEFT",t.ZOOM_IN="ZOOM_IN",t.ZOOM_OUT="ZOOM_OUT",t))(Yk||{}),ro={MENU:"menu",TWO_FINGERS:"twoFingers",CTRL_ZOOM:"ctrlZoom",ERROR:"error",DESCRIPTION:"description"},$s={Enter:"Enter",Control:"Control",Escape:"Escape",Space:" ",PageUp:"PageUp",PageDown:"PageDown",ArrowLeft:"ArrowLeft",ArrowUp:"ArrowUp",ArrowRight:"ArrowRight",ArrowDown:"ArrowDown",Delete:"Delete",Plus:"+",Minus:"-"},ac={arrow:wW,close:SW,download:EW,fullscreenIn:MW,fullscreenOut:CW,info:TW,menu:AW,zoomIn:PW,zoomOut:IW},j1={linear:t=>t,inQuad:t=>t*t,outQuad:t=>t*(2-t),inOutQuad:t=>t<.5?2*t*t:-1+(4-2*t)*t,inCubic:t=>t*t*t,outCubic:t=>--t*t*t+1,inOutCubic:t=>t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1,inQuart:t=>t*t*t*t,outQuart:t=>1- --t*t*t*t,inOutQuart:t=>t<.5?8*t*t*t*t:1-8*--t*t*t*t,inQuint:t=>t*t*t*t*t,outQuint:t=>1+--t*t*t*t*t,inOutQuint:t=>t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t,inSine:t=>1-Math.cos(t*(Math.PI/2)),outSine:t=>Math.sin(t*(Math.PI/2)),inOutSine:t=>.5-.5*Math.cos(Math.PI*t),inExpo:t=>Math.pow(2,10*(t-1)),outExpo:t=>1-Math.pow(2,-10*t),inOutExpo:t=>(t=t*2-1)<0?.5*Math.pow(2,10*t):1-.5*Math.pow(2,-10*t),inCirc:t=>1-Math.sqrt(1-t*t),outCirc:t=>Math.sqrt(1-(t-1)*(t-1)),inOutCirc:t=>(t*=2)<1?.5-.5*Math.sqrt(1-t*t):.5+.5*Math.sqrt(1-(t-=2)*t)},zn={};gC(zn,{Animation:()=>dy,Dynamic:()=>fy,MultiDynamic:()=>_4,PressHandler:()=>tb,Slider:()=>b4,SliderDirection:()=>x4,addClasses:()=>xC,angle:()=>Kk,applyEulerInverse:()=>IC,checkClosedShadowDom:()=>y4,checkStylesheet:()=>v4,checkVersion:()=>RC,cleanCssPosition:()=>p4,clone:()=>Y1,createTexture:()=>PC,cssPositionIsOrdered:()=>TC,dasherize:()=>OW,deepEqual:()=>c4,deepmerge:()=>a4,distance:()=>_C,exitFullscreen:()=>o4,firstNonNull:()=>Kc,getAbortError:()=>MC,getAngle:()=>Qk,getClosest:()=>t4,getConfigParser:()=>eb,getElement:()=>e4,getEventTarget:()=>X1,getMatchingTarget:()=>n4,getPosition:()=>i4,getShortestArc:()=>Jk,getStyleProperty:()=>Yc,getTouchData:()=>bC,getXMPValue:()=>za,greatArcDistance:()=>LW,hasParent:()=>DW,invertResolvableBoolean:()=>K1,isAbortError:()=>h4,isEmpty:()=>l4,isExtendedPosition:()=>CC,isFullscreenEnabled:()=>r4,isNil:()=>Hs,isPlainObject:()=>SC,logWarn:()=>Vr,parseAngle:()=>Jc,parsePoint:()=>FW,parseSpeed:()=>m4,removeClasses:()=>kW,requestFullscreen:()=>s4,resolveBoolean:()=>EC,speedToDuration:()=>AC,sum:()=>RW,throttle:()=>wC,toggleClass:()=>q1,wrap:()=>hy});function hy(t,e){let n=t%e;return n<0&&(n+=e),n}function RW(t){return t.reduce((e,n)=>e+n,0)}function _C(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function Kk(t,e){return Math.atan2(e.y-t.y,e.x-t.x)}function Jk(t,e){return[0,Math.PI*2,-Math.PI*2].reduce((i,r)=>{const a=e-t+r;return Math.abs(a)<Math.abs(i)?a:i},1/0)}function Qk(t,e){return Math.acos(Math.cos(t.pitch)*Math.cos(e.pitch)*Math.cos(t.yaw-e.yaw)+Math.sin(t.pitch)*Math.sin(e.pitch))}function LW([t,e],[n,i]){t-n>Math.PI?t-=2*Math.PI:t-n<-Math.PI&&(t+=2*Math.PI);const r=(n-t)*Math.cos((e+i)/2),a=i-e;return Math.sqrt(r*r+a*a)}function e4(t){return typeof t=="string"?t.match(/^[a-z]/i)?document.getElementById(t):document.querySelector(t):t}function q1(t,e,n){n===void 0?t.classList.toggle(e):n?t.classList.add(e):n||t.classList.remove(e)}function xC(t,e){t.classList.add(...e.split(" ").filter(n=>!!n))}function kW(t,e){t.classList.remove(...e.split(" ").filter(n=>!!n))}function DW(t,e){let n=t;do{if(n===e)return!0;n=n.parentElement}while(n);return!1}function t4(t,e){if(!(t!=null&&t.matches))return null;let n=t;do{if(n.matches(e))return n;n=n.parentElement}while(n);return null}function X1(t){return(t==null?void 0:t.composedPath()[0])||null}function n4(t,e){return t?t.composedPath().find(n=>!(n instanceof HTMLElement)&&!(n instanceof SVGElement)?!1:n.matches(e)):null}function i4(t){let e=0,n=0,i=t;for(;i;)e+=i.offsetLeft-i.scrollLeft+i.clientLeft,n+=i.offsetTop-i.scrollTop+i.clientTop,i=i.offsetParent;return e-=window.scrollX,n-=window.scrollY,{x:e,y:n}}function Yc(t,e){return window.getComputedStyle(t).getPropertyValue(e)}function bC(t){if(t.touches.length<2)return null;const e={x:t.touches[0].clientX,y:t.touches[0].clientY},n={x:t.touches[1].clientX,y:t.touches[1].clientY};return{distance:_C(e,n),angle:Kk(e,n),center:{x:(e.x+n.x)/2,y:(e.y+n.y)/2}}}var Z1;function r4(t,e=!1){return e?t===Z1:document.fullscreenElement===t}function s4(t,e=!1){e?(Z1=t,t.classList.add("psv-fullscreen-emulation"),document.dispatchEvent(new Event("fullscreenchange"))):t.requestFullscreen()}function o4(t=!1){t?(Z1.classList.remove("psv-fullscreen-emulation"),Z1=null,document.dispatchEvent(new Event("fullscreenchange"))):document.exitFullscreen()}function OW(t){return t.replace(/[A-Z](?:(?=[^A-Z])|[A-Z]*(?=[A-Z][^A-Z]|$))/g,(e,n)=>(n>0?"-":"")+e.toLowerCase())}function wC(t,e){let n=!1;return function(...i){n||(n=!0,setTimeout(()=>{t.apply(this,i),n=!1},e))}}function SC(t){if(typeof t!="object"||t===null||Object.prototype.toString.call(t)!=="[object Object]")return!1;if(Object.getPrototypeOf(t)===null)return!0;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}function a4(t,e){const n=e;return function i(r,a){return Array.isArray(a)?(!r||!Array.isArray(r)?r=[]:r.length=0,a.forEach((u,l)=>{r[l]=i(null,u)})):typeof a=="object"?((!r||Array.isArray(r))&&(r={}),Object.keys(a).forEach(u=>{typeof a[u]!="object"||!a[u]||!SC(a[u])?r[u]=a[u]:a[u]!==n&&(r[u]?i(r[u],a[u]):r[u]=i(null,a[u]))})):r=a,r}(t,e)}function Y1(t){return a4(null,t)}function l4(t){return!t||Object.keys(t).length===0&&t.constructor===Object}function Hs(t){return t==null}function Kc(...t){for(const e of t)if(!Hs(e))return e;return null}function c4(t,e){if(t===e)return!0;if(u4(t)&&u4(e)){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n of Object.keys(t))if(!c4(t[n],e[n]))return!1;return!0}else return!1}function u4(t){return typeof t=="object"&&t!==null}var qn=class X8 extends Error{constructor(e,n){var i;super(n&&n instanceof Error?`${e}: ${n.message}`:e),this.name="PSVError",(i=Error.captureStackTrace)==null||i.call(Error,this,X8)}};function EC(t,e){SC(t)?(e(t.initial,!0),t.promise.then(n=>e(n,!1))):e(t,!0)}function K1(t){return{initial:!t.initial,promise:t.promise.then(e=>!e)}}function MC(){const t=new Error("Loading was aborted.");return t.name="AbortError",t}function h4(t){return(t==null?void 0:t.name)==="AbortError"}function Vr(t){console.warn(`PhotoSphereViewer: ${t}`)}function CC(t){return!t||Array.isArray(t)?!1:[["textureX","textureY"],["yaw","pitch"]].some(([e,n])=>t[e]!==void 0&&t[n]!==void 0)}function za(t,e,n=!0){let i=t.match("<GPano:"+e+">(.*)</GPano:"+e+">");if(i!==null){const r=n?parseInt(i[1],10):parseFloat(i[1]);return isNaN(r)?null:r}if(i=t.match("GPano:"+e+'="(.*?)"'),i!==null){const r=n?parseInt(i[1],10):parseFloat(i[1]);return isNaN(r)?null:r}return null}var d4={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},J1=["left","center","right"],Q1=["top","center","bottom"],f4=[...J1,...Q1],El="center";function FW(t){if(!t)return{x:.5,y:.5};if(typeof t=="object")return t;let e=t.toLocaleLowerCase().split(" ").slice(0,2);e.length===1&&(d4[e[0]]?e=[e[0],El]:e=[e[0],e[0]]);const n=e[1]!=="left"&&e[1]!=="right"&&e[0]!=="top"&&e[0]!=="bottom";e=e.map(r=>d4[r]||r),n||e.reverse();const i=e.join(" ").match(/^([0-9.]+)% ([0-9.]+)%$/);return i?{x:parseFloat(i[1])/100,y:parseFloat(i[2])/100}:{x:.5,y:.5}}function p4(t,{allowCenter:e,cssOrder:n}={allowCenter:!0,cssOrder:!0}){return t?(typeof t=="string"&&(t=t.split(" ")),t.length===1&&(t[0]===El?t=[El,El]:J1.indexOf(t[0])!==-1?t=[El,t[0]]:Q1.indexOf(t[0])!==-1&&(t=[t[0],El])),t.length!==2||f4.indexOf(t[0])===-1||f4.indexOf(t[1])===-1?(Vr(`Unparsable position ${t}`),null):!e&&t[0]===El&&t[1]===El?(Vr("Invalid position center center"),null):(n&&!TC(t)&&(t=[t[1],t[0]]),t[1]===El&&J1.indexOf(t[0])!==-1&&(t=[El,t[0]]),t[0]===El&&Q1.indexOf(t[1])!==-1&&(t=[t[1],El]),t)):null}function TC(t){return Q1.indexOf(t[0])!==-1&&J1.indexOf(t[1])!==-1}function m4(t){let e;if(typeof t=="string"){const n=t.toString().trim();let i=parseFloat(n.replace(/^(-?[0-9]+(?:\.[0-9]*)?).*$/,"$1"));const r=n.replace(/^-?[0-9]+(?:\.[0-9]*)?(.*)$/,"$1").trim();switch(r.match(/(pm|per minute)$/)&&(i/=60),r){case"dpm":case"degrees per minute":case"dps":case"degrees per second":e=Yr.degToRad(i);break;case"rdpm":case"radians per minute":case"rdps":case"radians per second":e=i;break;case"rpm":case"revolutions per minute":case"rps":case"revolutions per second":e=i*Math.PI*2;break;default:throw new qn(`Unknown speed unit "${r}"`)}}else e=t;return e}function AC(t,e){if(typeof t!="number"){const n=m4(t);return e/Math.abs(n)*1e3}else return Math.abs(t)}function Jc(t,e=!1,n=e){let i;if(typeof t=="string"){const r=t.toLowerCase().trim().match(/^(-?[0-9]+(?:\.[0-9]*)?)(.*)$/);if(!r)throw new qn(`Unknown angle "${t}"`);const a=parseFloat(r[1]),u=r[2];if(u)switch(u){case"deg":case"degs":i=Yr.degToRad(a);break;case"rad":case"rads":i=a;break;default:throw new qn(`Unknown angle unit "${u}"`)}else i=a}else if(typeof t=="number"&&!isNaN(t))i=t;else throw new qn(`Unknown angle "${t}"`);return i=hy(e?i+Math.PI:i,Math.PI*2),e?Yr.clamp(i-Math.PI,-Math.PI/(n?2:1),Math.PI/(n?2:1)):i}function PC(t,e=!1){const n=new nc(t);return n.needsUpdate=!0,n.minFilter=e?id:bl,n.generateMipmaps=e,n.anisotropy=e?2:1,n}var g4=new Xm;function IC(t,e){g4.setFromEuler(e).invert(),t.applyQuaternion(g4)}function eb(t,e){const n=function(i){const r=Y1({...t,...i}),a={};for(let[u,l]of Object.entries(r)){if(e&&u in e)l=e[u](l,{rawConfig:r,defValue:t[u]});else if(!(u in t)){Vr(`Unknown option ${u}`);continue}a[u]=l}return a};return n.defaults=t,n.parsers=e||{},n}function v4(t,e){Yc(t,`--psv-${e}-loaded`)!=="true"&&console.error(`PhotoSphereViewer: stylesheet "@photo-sphere-viewer/${e}/index.css" is not loaded`)}function RC(t,e,n){e&&e!==n&&console.error(`PhotoSphereViewer: @photo-sphere-viewer/${t} is in version ${e} but @photo-sphere-viewer/core is in version ${n}`)}function y4(t){do{if(t instanceof ShadowRoot&&t.mode==="closed"){console.error("PhotoSphereViewer: closed shadow DOM detected, the viewer might not work as expected");return}t=t.parentNode}while(t)}var dy=class{constructor(t){this.easing=j1.linear,this.callbacks=[],this.resolved=!1,this.cancelled=!1,this.options=t,t?(t.easing&&(this.easing=typeof t.easing=="function"?t.easing:j1[t.easing]||j1.linear),this.delayTimeout=setTimeout(()=>{this.delayTimeout=void 0,this.animationFrame=window.requestAnimationFrame(e=>this.__run(e))},t.delay||0)):this.resolved=!0}__run(t){if(this.cancelled)return;this.start||(this.start=t);const e=(t-this.start)/this.options.duration,n={};if(e<1){for(const[i,r]of Object.entries(this.options.properties))if(r){const a=r.start+(r.end-r.start)*this.easing(e);n[i]=a}this.options.onTick(n,e),this.animationFrame=window.requestAnimationFrame(i=>this.__run(i))}else{for(const[i,r]of Object.entries(this.options.properties))r&&(n[i]=r.end);this.options.onTick(n,1),this.__resolve(!0),this.animationFrame=void 0}}__resolve(t){t?this.resolved=!0:this.cancelled=!0,this.callbacks.forEach(e=>e(t)),this.callbacks.length=0}then(t){return this.resolved||this.cancelled?Promise.resolve(this.resolved).then(t):new Promise(e=>{this.callbacks.push(e)}).then(t)}cancel(){!this.cancelled&&!this.resolved&&(this.__resolve(!1),this.delayTimeout&&(window.clearTimeout(this.delayTimeout),this.delayTimeout=void 0),this.animationFrame&&(window.cancelAnimationFrame(this.animationFrame),this.animationFrame=void 0))}},fy=class{constructor(t,e){if(this.fn=t,this.mode=0,this.speed=0,this.speedMult=0,this.currentSpeed=0,this.target=0,this.__current=0,this.min=e.min,this.max=e.max,this.wrap=e.wrap,this.current=e.defaultValue,this.wrap&&this.min!==0)throw new qn("invalid config");this.fn&&this.fn(this.current)}get current(){return this.__current}set current(t){this.__current=t}setSpeed(t){this.speed=t}goto(t,e=1){this.mode=2,this.target=this.wrap?hy(t,this.max):Yr.clamp(t,this.min,this.max),this.speedMult=e}step(t,e=1){e===0?this.setValue(this.current+t):(this.mode!==2&&(this.target=this.current),this.goto(this.target+t,e))}roll(t=!1,e=1){this.mode=1,this.target=t?-1/0:1/0,this.speedMult=e}stop(){this.mode=0}setValue(t){return this.target=this.wrap?hy(t,this.max):Yr.clamp(t,this.min,this.max),this.mode=0,this.currentSpeed=0,this.target!==this.current?(this.current=this.target,this.fn&&this.fn(this.current),!0):!1}update(t){if(this.mode===2){this.wrap&&Math.abs(this.target-this.current)>this.max/2&&(this.current=this.current<this.target?this.current+this.max:this.current-this.max);const i=this.currentSpeed*this.currentSpeed/(this.speed*this.speedMult*4);Math.abs(this.target-this.current)<=i&&(this.mode=0)}let e=this.mode===0?0:this.speed*this.speedMult;this.target<this.current&&(e=-e),this.currentSpeed<e?this.currentSpeed=Math.min(e,this.currentSpeed+t/1e3*this.speed*this.speedMult*2):this.currentSpeed>e&&(this.currentSpeed=Math.max(e,this.currentSpeed-t/1e3*this.speed*this.speedMult*2));let n=null;return this.current>this.target&&this.currentSpeed?n=Math.max(this.target,this.current+this.currentSpeed*t/1e3):this.current<this.target&&this.currentSpeed&&(n=Math.min(this.target,this.current+this.currentSpeed*t/1e3)),n!==null&&(n=this.wrap?hy(n,this.max):Yr.clamp(n,this.min,this.max),n!==this.current)?(this.current=n,this.fn&&this.fn(this.current),!0):!1}},_4=class{constructor(t,e){this.fn=t,this.dynamics=e,this.fn&&this.fn(this.current)}get current(){return Object.entries(this.dynamics).reduce((t,[e,n])=>(t[e]=n.current,t),{})}setSpeed(t){for(const e of Object.values(this.dynamics))e.setSpeed(t)}goto(t,e=1){for(const[n,i]of Object.entries(t))this.dynamics[n].goto(i,e)}step(t,e=1){if(e===0)this.setValue(Object.keys(t).reduce((n,i)=>(n[i]=t[i]+this.dynamics[i].current,n),{}));else for(const[n,i]of Object.entries(t))this.dynamics[n].step(i,e)}roll(t,e=1){for(const[n,i]of Object.entries(t))this.dynamics[n].roll(i,e)}stop(){for(const t of Object.values(this.dynamics))t.stop()}setValue(t){let e=!1;for(const[n,i]of Object.entries(t))e=this.dynamics[n].setValue(i)||e;return e&&this.fn&&this.fn(this.current),e}update(t){let e=!1;for(const n of Object.values(this.dynamics))e=n.update(t)||e;return e&&this.fn&&this.fn(this.current),e}},tb=class{constructor(t=200){this.delay=t,this.time=0,this.delay=t}get pending(){return this.time!==0}down(){this.timeout&&(clearTimeout(this.timeout),this.timeout=void 0),this.time=new Date().getTime()}up(t){if(!this.time)return;Date.now()-this.time<this.delay?this.timeout=setTimeout(()=>{t(),this.timeout=void 0,this.time=0},this.delay):(t(),this.time=0)}},x4=(t=>(t.VERTICAL="VERTICAL",t.HORIZONTAL="HORIZONTAL",t))(x4||{}),b4=class{constructor(t,e,n){this.container=t,this.direction=e,this.listener=n,this.mousedown=!1,this.mouseover=!1,this.container.addEventListener("click",this),this.container.addEventListener("mousedown",this),this.container.addEventListener("mouseenter",this),this.container.addEventListener("mouseleave",this),this.container.addEventListener("touchstart",this),this.container.addEventListener("mousemove",this,!0),this.container.addEventListener("touchmove",this,!0),window.addEventListener("mouseup",this),window.addEventListener("touchend",this)}get isVertical(){return this.direction==="VERTICAL"}get isHorizontal(){return this.direction==="HORIZONTAL"}destroy(){window.removeEventListener("mouseup",this),window.removeEventListener("touchend",this)}handleEvent(t){switch(t.type){case"click":t.stopPropagation();break;case"mousedown":this.__onMouseDown(t);break;case"mouseenter":this.__onMouseEnter(t);break;case"mouseleave":this.__onMouseLeave(t);break;case"touchstart":this.__onTouchStart(t);break;case"mousemove":this.__onMouseMove(t);break;case"touchmove":this.__onTouchMove(t);break;case"mouseup":this.__onMouseUp(t);break;case"touchend":this.__onTouchEnd(t);break}}__onMouseDown(t){this.mousedown=!0,this.__update(t.clientX,t.clientY,!0)}__onMouseEnter(t){this.mouseover=!0,this.__update(t.clientX,t.clientY,!0)}__onTouchStart(t){this.mouseover=!0,this.mousedown=!0;const e=t.changedTouches[0];this.__update(e.clientX,e.clientY,!0)}__onMouseMove(t){(this.mousedown||this.mouseover)&&(t.stopPropagation(),this.__update(t.clientX,t.clientY,!0))}__onTouchMove(t){if(this.mousedown||this.mouseover){t.stopPropagation();const e=t.changedTouches[0];this.__update(e.clientX,e.clientY,!0)}}__onMouseUp(t){this.mousedown&&(this.mousedown=!1,this.__update(t.clientX,t.clientY,!1))}__onMouseLeave(t){this.mouseover&&(this.mouseover=!1,this.__update(t.clientX,t.clientY,!0))}__onTouchEnd(t){if(this.mousedown){this.mouseover=!1,this.mousedown=!1;const e=t.changedTouches[0];this.__update(e.clientX,e.clientY,!1)}}__update(t,e,n){const i=this.container.getBoundingClientRect(),r=this.isVertical?e:t,a=i[this.isVertical?"bottom":"left"],u=i[this.isVertical?"height":"width"],l=Math.abs((a-r)/u);this.listener({value:l,click:!n,mousedown:this.mousedown,mouseover:this.mouseover,cursor:{clientX:t,clientY:e}})}},Pi={};gC(Pi,{BeforeAnimateEvent:()=>LC,BeforeRenderEvent:()=>M4,BeforeRotateEvent:()=>T4,ClickEvent:()=>P4,ConfigChangedEvent:()=>ha,DoubleClickEvent:()=>L4,FullscreenEvent:()=>py,HideNotificationEvent:()=>my,HideOverlayEvent:()=>F4,HidePanelEvent:()=>gd,HideTooltipEvent:()=>B4,KeypressEvent:()=>vd,LoadProgressEvent:()=>$4,ObjectEnterEvent:()=>uD,ObjectEvent:()=>ib,ObjectHoverEvent:()=>fD,ObjectLeaveEvent:()=>DC,PanoramaErrorEvent:()=>q4,PanoramaLoadEvent:()=>G4,PanoramaLoadedEvent:()=>kC,PositionUpdatedEvent:()=>gy,ReadyEvent:()=>yy,RenderEvent:()=>J4,RollUpdatedEvent:()=>vy,ShowNotificationEvent:()=>_y,ShowOverlayEvent:()=>tD,ShowPanelEvent:()=>yd,ShowTooltipEvent:()=>rD,SizeUpdatedEvent:()=>xy,StopAllEvent:()=>aD,ViewerEvent:()=>or,ZoomUpdatedEvent:()=>nh});var nb=class extends Event{constructor(t,e=!1){super(t,{cancelable:e})}},w4=class extends EventTarget{dispatchEvent(t){return super.dispatchEvent(t)}addEventListener(t,e,n){super.addEventListener(t,e,n)}removeEventListener(t,e,n){super.removeEventListener(t,e,n)}},or=class extends nb{},S4=class Z8 extends or{constructor(e,n){super(Z8.type,!0),this.position=e,this.zoomLevel=n}};S4.type="before-animate";var LC=S4,E4=class Y8 extends or{constructor(e,n){super(Y8.type),this.timestamp=e,this.elapsed=n}};E4.type="before-render";var M4=E4,C4=class K8 extends or{constructor(e){super(K8.type,!0),this.position=e}};C4.type="before-rotate";var T4=C4,A4=class J8 extends or{constructor(e){super(J8.type),this.data=e}};A4.type="click";var P4=A4,I4=class Q8 extends or{constructor(e){super(Q8.type),this.options=e}containsOptions(...e){return e.some(n=>this.options.includes(n))}};I4.type="config-changed";var ha=I4,R4=class e9 extends or{constructor(e){super(e9.type),this.data=e}};R4.type="dblclick";var L4=R4,k4=class t9 extends or{constructor(e){super(t9.type),this.fullscreenEnabled=e}};k4.type="fullscreen";var py=k4,D4=class n9 extends or{constructor(e){super(n9.type),this.notificationId=e}};D4.type="hide-notification";var my=D4,O4=class i9 extends or{constructor(e){super(i9.type),this.overlayId=e}};O4.type="hide-overlay";var F4=O4,z4=class r9 extends or{constructor(e){super(r9.type),this.panelId=e}};z4.type="hide-panel";var gd=z4,N4=class s9 extends or{constructor(e){super(s9.type),this.tooltipData=e}};N4.type="hide-tooltip";var B4=N4,U4=class o9 extends or{constructor(e){super(o9.type,!0),this.key=e}};U4.type="key-press";var vd=U4,V4=class a9 extends or{constructor(e){super(a9.type),this.progress=e}};V4.type="load-progress";var $4=V4,H4=class l9 extends or{constructor(e){super(l9.type),this.panorama=e}};H4.type="panorama-load";var G4=H4,W4=class c9 extends or{constructor(e){super(c9.type),this.data=e}};W4.type="panorama-loaded";var kC=W4,j4=class u9 extends or{constructor(e,n){super(u9.type),this.panorama=e,this.error=n}};j4.type="panorama-error";var q4=j4,X4=class h9 extends or{constructor(e){super(h9.type),this.position=e}};X4.type="position-updated";var gy=X4,Z4=class d9 extends or{constructor(e){super(d9.type),this.roll=e}};Z4.type="roll-updated";var vy=Z4,Y4=class f9 extends or{constructor(){super(f9.type)}};Y4.type="ready";var yy=Y4,K4=class p9 extends or{constructor(){super(p9.type)}};K4.type="render";var J4=K4,Q4=class m9 extends or{constructor(e){super(m9.type),this.notificationId=e}};Q4.type="show-notification";var _y=Q4,eD=class g9 extends or{constructor(e){super(g9.type),this.overlayId=e}};eD.type="show-overlay";var tD=eD,nD=class v9 extends or{constructor(e){super(v9.type),this.panelId=e}};nD.type="show-panel";var yd=nD,iD=class y9 extends or{constructor(e,n){super(y9.type),this.tooltip=e,this.tooltipData=n}};iD.type="show-tooltip";var rD=iD,sD=class _9 extends or{constructor(e){super(_9.type),this.size=e}};sD.type="size-updated";var xy=sD,oD=class x9 extends or{constructor(){super(x9.type)}};oD.type="stop-all";var aD=oD,lD=class b9 extends or{constructor(e){super(b9.type),this.zoomLevel=e}};lD.type="zoom-updated";var nh=lD,ib=class extends or{constructor(t,e,n,i,r){super(t),this.originalEvent=e,this.object=n,this.viewerPoint=i,this.userDataKey=r}},cD=class w9 extends ib{constructor(e,n,i,r){super(w9.type,e,n,i,r)}};cD.type="enter-object";var uD=cD,hD=class S9 extends ib{constructor(e,n,i,r){super(S9.type,e,n,i,r)}};hD.type="leave-object";var DC=hD,dD=class E9 extends ib{constructor(e,n,i,r){super(E9.type,e,n,i,r)}};dD.type="hover-object";var fD=dD,rb=class{constructor(t){this.viewer=t}init(){}destroy(){}supportsTransition(t){return!1}supportsPreload(t){return!1}textureCoordsToSphericalCoords(t,e){throw new qn("Current adapter does not support texture coordinates.")}sphericalCoordsToTextureCoords(t,e){throw new qn("Current adapter does not support texture coordinates.")}};rb.supportsDownload=!1;function pD(t){if(t){for(const[,e]of[["_",t],...Object.entries(t)])if(e.prototype instanceof rb)return RC(e.id,e.VERSION,"5.10.0"),e}return null}var by=`${md}_touchSupport`,Ts={loaded:!1,pixelRatio:1,isWebGLSupported:!1,maxTextureWidth:0,isTouchEnabled:null,__maxCanvasWidth:null,isIphone:!1,get maxCanvasWidth(){return this.__maxCanvasWidth===null&&(this.__maxCanvasWidth=BW(this.maxTextureWidth)),this.__maxCanvasWidth},load(){if(!this.loaded){const t=zW();this.pixelRatio=window.devicePixelRatio||1,this.isWebGLSupported=!!t,this.maxTextureWidth=t?t.getParameter(t.MAX_TEXTURE_SIZE):0,this.isTouchEnabled=NW(),this.isIphone=/iPhone/i.test(navigator.userAgent),this.loaded=!0}if(!Ts.isWebGLSupported)throw new qn("WebGL 2 is not supported.");if(Ts.maxTextureWidth===0)throw new qn("Unable to detect system capabilities")}};function zW(){try{return document.createElement("canvas").getContext("webgl2")}catch{return null}}function NW(){let t="ontouchstart"in window||navigator.maxTouchPoints>0;by in localStorage&&(t=localStorage[by]==="true");const e=new Promise(n=>{const i=()=>{window.removeEventListener("mousedown",r),window.removeEventListener("touchstart",a),clearTimeout(l)},r=()=>{i(),localStorage[by]=!1,n(!1)},a=()=>{i(),localStorage[by]=!0,n(!0)},u=()=>{i(),localStorage[by]=t,n(t)};window.addEventListener("mousedown",r,!1),window.addEventListener("touchstart",a,!1);const l=setTimeout(u,1e4)});return{initial:t,promise:e}}function BW(t){let e=t,n=!1;for(;e>1024&&!n;){const i=document.createElement("canvas"),r=i.getContext("2d");i.width=e,i.height=e/2,r.fillStyle="white",r.fillRect(0,0,1,1);try{r.getImageData(0,0,1,1).data[0]>0&&(n=!0)}catch{}i.width=0,i.height=0,n||(e/=2)}if(n)return e;throw new qn("Unable to detect system capabilities")}function UW(){self.onmessage=a=>{const u=a.data.panoData,l=new OffscreenCanvas(u.fullWidth,u.fullHeight),f=l.getContext("2d",{willReadFrequently:!0}),g=new OffscreenCanvas(u.croppedWidth,u.croppedHeight);g.getContext("2d").putImageData(a.data.image,0,0),t(l,g,u),postMessage(f.getImageData(0,0,l.width,l.height))};function t(a,u,l){const f=l.fullHeight-l.croppedHeight-l.croppedY,g=l.fullWidth-l.croppedWidth-l.croppedX,y=l.croppedY+l.croppedHeight/2,S=a.width/32,b=S,A=10,I=`blur(${S}px)`,D=a.getContext("2d");if(D.drawImage(u,l.croppedX,l.croppedY,l.croppedWidth,l.croppedHeight),l.croppedY>0){if(l.croppedX>0||g>0){D.filter="none";const L=r(D,l.croppedX,l.croppedY,A,A,2),P=r(D,a.width-g-11,l.croppedY,A,A,2),N=n(L,P);l.croppedX>0&&(D.fillStyle=i(D,0,l.croppedX,N,L),D.fillRect(-b,-b,l.croppedX+b*2,y+b)),g>0&&(D.fillStyle=i(D,a.width-g,a.width,P,N),D.fillRect(a.width-g-b,-b,g+b*2,y+b))}D.filter=I,D.drawImage(u,0,0,u.width,A,l.croppedX,-b,l.croppedWidth,l.croppedY+b*2),D.fillStyle=e(r(D,0,0,a.width,A,A)),D.fillRect(-b,-b,a.width+b*2,b*2)}if(f>0){if(l.croppedX>0||g>0){D.filter="none";const L=r(D,l.croppedX,a.height-f-1-A,A,A,2),P=r(D,a.width-g-1-A,a.height-f-1-A,A,A,2),N=n(L,P);l.croppedX>0&&(D.fillStyle=i(D,0,l.croppedX,N,L),D.fillRect(-b,y,l.croppedX+b*2,a.height-y+b)),g>0&&(D.fillStyle=i(D,a.width-g,a.width,P,N),D.fillRect(a.width-g-b,y,g+b*2,a.height-y+b))}D.filter=I,D.drawImage(u,0,u.height-A,u.width,A,l.croppedX,a.height-f-b,l.croppedWidth,f+b*2),D.fillStyle=e(r(D,0,a.height-1-A,a.width,A,A)),D.fillRect(-b,a.height-b,a.width+b*2,b*2)}l.croppedX>0&&(D.filter=I,D.drawImage(u,u.width-A,0,A,u.height,-b,l.croppedY,b*2,l.croppedHeight),D.drawImage(u,0,0,A,u.height,0,l.croppedY,l.croppedX+b,l.croppedHeight)),g>0&&(D.filter=I,D.drawImage(u,0,0,A,u.height,a.width-b,l.croppedY,b*2,l.croppedHeight),D.drawImage(u,u.width-A,0,A,u.height,a.width-g-b,l.croppedY,g+b,l.croppedHeight)),D.filter="none",D.drawImage(u,l.croppedX,l.croppedY,l.croppedWidth,l.croppedHeight)}function e(a){return`rgb(${a.r}, ${a.g}, ${a.b})`}function n(a,u){return{r:Math.round(a.r/2+u.r/2),g:Math.round(a.g/2+u.g/2),b:Math.round(a.b/2+u.b/2)}}function i(a,u,l,f,g){const y=a.createLinearGradient(u,0,l,0);return y.addColorStop(0,e(f)),y.addColorStop(1,e(g)),y}function r(a,u,l,f,g,y){y=Math.round(y);let S=0,b=0,A=0,I=0;const D=a.getImageData(u,l,f,g);for(let L=0;L<g;L+=y)for(let P=0;P<f;P+=y){const N=4*(L*f+P);S+=D.data[N],b+=D.data[N+1],A+=D.data[N+2],I++}return S=Math.round(S/I),b=Math.round(b/I),A=Math.round(A/I),{r:S,g:b,b:A}}}var VW=URL.createObjectURL(new Blob(["(",UW.toString(),")()"],{type:"application/javascript"})),$W=eb({backgroundColor:"#000",interpolateBackground:!1,resolution:64,useXmpData:!0,blur:!1},{resolution:t=>{if(!t||!Yr.isPowerOfTwo(t))throw new qn("EquirectangularAdapter resolution must be power of two");return t}}),vg=class extends rb{constructor(t,e){super(t),this.config=$W(e),this.config.interpolateBackground&&(window.Worker?this.interpolationWorker=new Worker(VW,{name:"photo-sphere-viewer-interpolation"}):(Vr("Web Worker API not available"),this.config.interpolateBackground=!1)),this.SPHERE_SEGMENTS=this.config.resolution,this.SPHERE_HORIZONTAL_SEGMENTS=this.SPHERE_SEGMENTS/2}supportsTransition(){return!0}supportsPreload(){return!0}destroy(){var t;(t=this.interpolationWorker)==null||t.terminate(),super.destroy()}textureCoordsToSphericalCoords(t,e){if(Hs(t.textureX)||Hs(t.textureY))throw new qn("Texture position is missing 'textureX' or 'textureY'");const n=(t.textureX+e.croppedX)/e.fullWidth*Math.PI*2,i=(t.textureY+e.croppedY)/e.fullHeight*Math.PI;return{yaw:n>=Math.PI?n-Math.PI:n+Math.PI,pitch:Math.PI/2-i}}sphericalCoordsToTextureCoords(t,e){const n=t.yaw/Math.PI/2*e.fullWidth,i=t.pitch/Math.PI*e.fullHeight;return{textureX:Math.round(t.yaw<Math.PI?n+e.fullWidth/2:n-e.fullWidth/2)-e.croppedX,textureY:Math.round(e.fullHeight/2-i)-e.croppedY}}async loadTexture(t,e=!0,n,i=this.config.useXmpData){if(typeof t!="string")return Promise.reject(new qn("Invalid panorama url, are you using the right adapter?"));const r=await this.viewer.textureLoader.loadFile(t,e?g=>this.viewer.loader.setProgress(g):null,t),a=i?await this.loadXMP(r):null,u=await this.viewer.textureLoader.blobToImage(r);typeof n=="function"&&(n=n(u,a)),!n&&!a&&(n=this.__defaultPanoData(u));const l={isEquirectangular:!0,fullWidth:Kc(n==null?void 0:n.fullWidth,a==null?void 0:a.fullWidth,u.width),fullHeight:Kc(n==null?void 0:n.fullHeight,a==null?void 0:a.fullHeight,u.height),croppedWidth:Kc(n==null?void 0:n.croppedWidth,a==null?void 0:a.croppedWidth,u.width),croppedHeight:Kc(n==null?void 0:n.croppedHeight,a==null?void 0:a.croppedHeight,u.height),croppedX:Kc(n==null?void 0:n.croppedX,a==null?void 0:a.croppedX,0),croppedY:Kc(n==null?void 0:n.croppedY,a==null?void 0:a.croppedY,0),poseHeading:Kc(n==null?void 0:n.poseHeading,a==null?void 0:a.poseHeading,0),posePitch:Kc(n==null?void 0:n.posePitch,a==null?void 0:a.posePitch,0),poseRoll:Kc(n==null?void 0:n.poseRoll,a==null?void 0:a.poseRoll,0),initialHeading:a==null?void 0:a.initialHeading,initialPitch:a==null?void 0:a.initialPitch,initialFov:a==null?void 0:a.initialFov};(l.croppedWidth!==u.width||l.croppedHeight!==u.height)&&Vr(`Invalid panoData, croppedWidth/croppedHeight is not coherent with the loaded image.
            panoData: ${l.croppedWidth}x${l.croppedHeight}, image: ${u.width}x${u.height}`),Math.abs(l.fullWidth-l.fullHeight*2)>1&&(Vr("Invalid panoData, fullWidth should be twice fullHeight"),l.fullWidth=l.fullHeight*2),l.croppedX+l.croppedWidth>l.fullWidth&&(Vr("Invalid panoData, croppedX + croppedWidth > fullWidth"),l.croppedX=l.fullWidth-l.croppedWidth),l.croppedY+l.croppedHeight>l.fullHeight&&(Vr("Invalid panoData, croppedY + croppedHeight > fullHeight"),l.croppedY=l.fullHeight-l.croppedHeight);const f=this.createEquirectangularTexture(u,l);return{panorama:t,texture:f,panoData:l,cacheKey:t}}async loadXMP(t){const e=await this.loadBlobAsString(t),n=e.indexOf("<x:xmpmeta"),i=e.indexOf("</x:xmpmeta>"),r=e.substring(n,i);return n!==-1&&i!==-1&&r.includes("GPano:")?{isEquirectangular:!0,fullWidth:za(r,"FullPanoWidthPixels"),fullHeight:za(r,"FullPanoHeightPixels"),croppedWidth:za(r,"CroppedAreaImageWidthPixels"),croppedHeight:za(r,"CroppedAreaImageHeightPixels"),croppedX:za(r,"CroppedAreaLeftPixels"),croppedY:za(r,"CroppedAreaTopPixels"),poseHeading:za(r,"PoseHeadingDegrees",!1),posePitch:za(r,"PosePitchDegrees",!1),poseRoll:za(r,"PoseRollDegrees",!1),initialHeading:za(r,"InitialViewHeadingDegrees",!1),initialPitch:za(r,"InitialViewPitchDegrees",!1),initialFov:za(r,"InitialHorizontalFOVDegrees",!1)}:null}loadBlobAsString(t){return new Promise((e,n)=>{const i=new FileReader;i.onload=()=>e(i.result),i.onerror=n,i.readAsText(t)})}createEquirectangularTexture(t,e){if(this.config.blur||e.fullWidth>Ts.maxTextureWidth||e.croppedWidth!==e.fullWidth||e.croppedHeight!==e.fullHeight){const n=Math.min(1,Ts.maxCanvasWidth/e.fullWidth),i={fullWidth:e.fullWidth*n,fullHeight:e.fullHeight*n,croppedWidth:e.croppedWidth*n,croppedHeight:e.croppedHeight*n,croppedX:e.croppedX*n,croppedY:e.croppedY*n},r=document.createElement("canvas");r.width=i.fullWidth,r.height=i.fullHeight;const a=r.getContext("2d");if(this.config.backgroundColor&&(a.fillStyle=this.config.backgroundColor,a.fillRect(0,0,r.width,r.height)),this.config.blur){const l=r.width/2048,f=Math.ceil(l*2);i.croppedWidth===r.width&&(a.drawImage(t,0,0,f/n,t.height,0,i.croppedY,f,i.croppedHeight),a.drawImage(t,t.width-f/n,0,f/n,t.height,r.width-f,i.croppedY,f,i.croppedHeight)),i.croppedHeight===r.height&&(a.drawImage(t,0,0,1,1,i.croppedX,0,i.croppedWidth,f),a.drawImage(t,0,t.height-1,1,1,i.croppedX,r.height-f,i.croppedWidth,f)),a.filter=`blur(${l}px)`}a.drawImage(t,i.croppedX,i.croppedY,i.croppedWidth,i.croppedHeight);const u=PC(r);return this.config.interpolateBackground&&i.fullWidth<=8096&&(e.croppedWidth!==e.fullWidth||e.croppedHeight!==e.fullHeight)&&(this.interpolationWorker.postMessage({image:a.getImageData(i.croppedX,i.croppedY,i.croppedWidth,i.croppedHeight),panoData:i}),this.interpolationWorker.onmessage=l=>{a.putImageData(l.data,0,0),u.needsUpdate=!0,this.viewer.needsUpdate()}),u}return PC(t)}createMesh(){const t=new Vk(gg,this.SPHERE_SEGMENTS,this.SPHERE_HORIZONTAL_SEGMENTS,-Math.PI/2).scale(-1,1,1);return new oc(t)}setTexture(t,e,n){const i=new P1;i.map=e.texture,n&&(i.depthTest=!1,i.depthWrite=!1),t.material=i}setTextureOpacity(t,e){t.material.opacity=e,t.material.transparent=e<1}disposeTexture(t){var e;(e=t.texture)==null||e.dispose()}__defaultPanoData(t){const e=Math.max(t.width,t.height*2),n=Math.round(e/2),i=Math.round((e-t.width)/2),r=Math.round((n-t.height)/2);return{isEquirectangular:!0,fullWidth:e,fullHeight:n,croppedWidth:t.width,croppedHeight:t.height,croppedX:i,croppedY:r}}};vg.id="equirectangular",vg.VERSION="5.10.0",vg.supportsDownload=!0;var mD=class extends vg{constructor(t,e){super(t,{resolution:(e==null?void 0:e.resolution)??64,interpolateBackground:!1,useXmpData:!1})}async loadTexture(t,e){const n=await super.loadTexture(t,e,null,!1);return n.panoData=null,n}createMesh(){const t=new Vk(gg,this.SPHERE_SEGMENTS,this.SPHERE_HORIZONTAL_SEGMENTS).scale(-1,1,1).toNonIndexed(),e=t.getAttribute("uv"),n=t.getAttribute("normal");for(let i=0;i<e.count;i++)for(let r=0;r<3;r++){const a=i*3+r,u=n.getX(a),l=n.getY(a),f=n.getZ(a),g=.947;if(i<e.count/6){const y=u===0&&f===0?1:Math.acos(l)/Math.sqrt(u*u+f*f)*(2/Math.PI);e.setXY(a,u*(g/4)*y+1/4,f*(g/2)*y+1/2)}else{const y=u===0&&f===0?1:Math.acos(-l)/Math.sqrt(u*u+f*f)*(2/Math.PI);e.setXY(a,-u*(g/4)*y+3/4,f*(g/2)*y+1/2)}}return t.rotateX(-Math.PI/2),t.rotateY(Math.PI),new oc(t,new P1)}};mD.id="dual-fisheye",mD.VERSION="5.10.0";var da=class M9{constructor(e,n){this.parent=e,this.children=[],this.container=document.createElement("div"),this.state={visible:!0},this.viewer=e instanceof M9?e.viewer:e,this.container.className=n.className||"",this.parent.children.push(this),this.parent.container.appendChild(this.container)}destroy(){this.parent.container.removeChild(this.container);const e=this.parent.children.indexOf(this);e!==-1&&this.parent.children.splice(e,1),this.children.slice().forEach(n=>n.destroy()),this.children.length=0}toggle(e=!this.isVisible()){e?this.show():this.hide()}hide(e){this.container.style.display="none",this.state.visible=!1}show(e){this.container.style.display="",this.state.visible=!0}isVisible(){return this.state.visible}},HW=eb({id:null,className:null,title:null,hoverScale:!1,collapsable:!1,tabbable:!0,icon:null,iconActive:null}),Na=class extends da{constructor(t,e){super(t,{className:`psv-button ${e.hoverScale?"psv-button--hover-scale":""} ${e.className||""}`}),this.state={visible:!0,enabled:!0,supported:!0,collapsed:!1,active:!1,width:0},this.config=HW(e),this.config.id=this.constructor.id,e.icon&&this.__setIcon(e.icon),this.state.width=this.container.offsetWidth,this.config.title?this.container.title=this.config.title:this.id&&this.id in this.viewer.config.lang&&(this.container.title=this.viewer.config.lang[this.id]),e.tabbable&&(this.container.tabIndex=0),this.container.addEventListener("click",n=>{this.state.enabled&&this.onClick(),n.stopPropagation()}),this.container.addEventListener("keydown",n=>{n.key===$s.Enter&&this.state.enabled&&(this.onClick(),n.stopPropagation())})}get id(){return this.config.id}get title(){return this.container.title}get content(){return this.container.innerHTML}get width(){return this.state.width}get collapsable(){return this.config.collapsable}show(t=!0){this.isVisible()||(this.state.visible=!0,this.state.collapsed||(this.container.style.display=""),t&&this.viewer.navbar.autoSize())}hide(t=!0){this.isVisible()&&(this.state.visible=!1,this.container.style.display="none",t&&this.viewer.navbar.autoSize())}checkSupported(){EC(this.isSupported(),(t,e)=>{this.state&&(this.state.supported=t,e?t||this.hide():this.toggle(t))})}autoSize(){}isSupported(){return!0}toggleActive(t=!this.state.active){t!==this.state.active&&(this.state.active=t,q1(this.container,"psv-button--active",this.state.active),this.config.iconActive&&this.__setIcon(this.state.active?this.config.iconActive:this.config.icon))}disable(){this.container.classList.add("psv-button--disabled"),this.state.enabled=!1}enable(){this.container.classList.remove("psv-button--disabled"),this.state.enabled=!0}collapse(){this.state.collapsed=!0,this.container.style.display="none"}uncollapse(){this.state.collapsed=!1,this.state.visible&&(this.container.style.display="")}__setIcon(t){this.container.innerHTML=t,xC(this.container.querySelector("svg"),"psv-button-svg")}},GW=class extends Na{constructor(t,e){var n,i;super(t,{className:`psv-custom-button ${e.className||""}`,hoverScale:!1,collapsable:e.collapsable!==!1,tabbable:e.tabbable!==!1,title:e.title}),this.customOnClick=e.onClick,e.id?this.config.id=e.id:this.config.id="psvButton-"+Math.random().toString(36).substring(2),e.content&&(typeof e.content=="string"?this.container.innerHTML=e.content:(this.container.classList.add("psv-custom-button--no-padding"),e.content.style.height="100%",(i=(n=e.content).attachViewer)==null||i.call(n,this.viewer),this.container.appendChild(e.content))),this.state.width=this.container.offsetWidth,e.disabled&&this.disable(),e.visible===!1&&this.hide()}onClick(){var t;(t=this.customOnClick)==null||t.call(this,this.viewer)}},wy=class extends Na{constructor(t){super(t,{className:"psv-description-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:ac.info}),this.mode=0,this.viewer.addEventListener(my.type,this),this.viewer.addEventListener(_y.type,this),this.viewer.addEventListener(gd.type,this),this.viewer.addEventListener(yd.type,this),this.viewer.addEventListener(ha.type,this)}destroy(){this.viewer.removeEventListener(my.type,this),this.viewer.removeEventListener(_y.type,this),this.viewer.removeEventListener(gd.type,this),this.viewer.removeEventListener(yd.type,this),this.viewer.removeEventListener(ha.type,this),super.destroy()}handleEvent(t){if(t instanceof ha){t.containsOptions("description")&&this.autoSize(!0);return}if(!this.mode)return;let e=!1;t instanceof my?e=this.mode===1:t instanceof _y?e=this.mode===1&&t.notificationId!==ro.DESCRIPTION:t instanceof gd?e=this.mode===2:t instanceof yd&&(e=this.mode===2&&t.panelId!==ro.DESCRIPTION),e&&(this.toggleActive(!1),this.mode=0)}onClick(){this.mode?this.__close():this.__open()}hide(t){super.hide(t),this.mode&&this.__close()}autoSize(t=!1){if(t){const e=this.viewer.navbar.getButton("caption",!1),n=e&&!e.isVisible(),i=!!this.viewer.config.description;n||i?this.show(!1):this.hide(!1)}}__close(){switch(this.mode){case 1:this.viewer.notification.hide(ro.DESCRIPTION);break;case 2:this.viewer.panel.hide(ro.DESCRIPTION);break}}__open(){this.toggleActive(!0),this.viewer.config.description?(this.mode=2,this.viewer.panel.show({id:ro.DESCRIPTION,content:(this.viewer.config.caption?`<p>${this.viewer.config.caption}</p>`:"")+this.viewer.config.description})):(this.mode=1,this.viewer.notification.show({id:ro.DESCRIPTION,content:this.viewer.config.caption}))}};wy.id="description";var gD=class extends Na{constructor(t){super(t,{className:"psv-download-button",hoverScale:!0,collapsable:!0,tabbable:!0,icon:ac.download}),this.viewer.addEventListener(ha.type,this)}destroy(){this.viewer.removeEventListener(ha.type,this),super.destroy()}handleEvent(t){t instanceof ha&&t.containsOptions("downloadUrl")&&this.checkSupported()}onClick(){const t=document.createElement("a");t.href=this.viewer.config.downloadUrl||this.viewer.config.panorama,t.href.startsWith("data:")&&!this.viewer.config.downloadName?t.download="panorama."+t.href.substring(0,t.href.indexOf(";")).split("/").pop():t.download=this.viewer.config.downloadName||t.href.split("/").pop(),t.target="_blank",this.viewer.container.appendChild(t),t.click(),setTimeout(()=>{this.viewer.container.removeChild(t)},100)}checkSupported(){this.viewer.adapter.constructor.supportsDownload||this.viewer.config.downloadUrl?this.show():this.hide()}};gD.id="download";var vD=class extends Na{constructor(t){super(t,{className:"psv-fullscreen-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:ac.fullscreenIn,iconActive:ac.fullscreenOut}),this.viewer.addEventListener(py.type,this)}destroy(){this.viewer.removeEventListener(py.type,this),super.destroy()}handleEvent(t){t instanceof py&&this.toggleActive(t.fullscreenEnabled)}onClick(){this.viewer.toggleFullscreen()}};vD.id="fullscreen";var WW="psvButton",jW=(t,e)=>`
<div class="psv-panel-menu psv-panel-menu--stripped">
  <h1 class="psv-panel-menu-title">${ac.menu} ${e}</h1>
  <ul class="psv-panel-menu-list">
    ${t.map(n=>`
    <li data-psv-button="${n.id}" class="psv-panel-menu-item" tabindex="0">
      <span class="psv-panel-menu-item-icon">${n.content}</span>
      <span class="psv-panel-menu-item-label">${n.title}</span>
    </li>
    `).join("")}
  </ul>
</div>
`,sb=class extends Na{constructor(t){super(t,{className:"psv-menu-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:ac.menu}),this.viewer.addEventListener(yd.type,this),this.viewer.addEventListener(gd.type,this),super.hide()}destroy(){this.viewer.removeEventListener(yd.type,this),this.viewer.removeEventListener(gd.type,this),super.destroy()}handleEvent(t){t instanceof yd?this.toggleActive(t.panelId===ro.MENU):t instanceof gd&&this.toggleActive(!1)}onClick(){this.state.active?this.__hideMenu():this.__showMenu()}hide(t){super.hide(t),this.__hideMenu()}show(t){super.show(t),this.state.active&&this.__showMenu()}__showMenu(){this.viewer.panel.show({id:ro.MENU,content:jW(this.viewer.navbar.collapsed,this.viewer.config.lang.menu),noMargin:!0,clickHandler:t=>{const e=t?t4(t,".psv-panel-menu-item"):void 0,n=e?e.dataset[WW]:void 0;n&&(this.viewer.navbar.getButton(n).onClick(),this.__hideMenu())}})}__hideMenu(){this.viewer.panel.hide(ro.MENU)}};sb.id="menu";function qW(t){let e=0;switch(t){case 0:e=90;break;case 1:e=-90;break;case 3:e=180;break;default:e=0;break}return ac.arrow.replace("rotate(0",`rotate(${e}`)}var Sy=class extends Na{constructor(t,e){super(t,{className:"psv-move-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:qW(e)}),this.direction=e,this.handler=new tb,this.container.addEventListener("mousedown",this),this.container.addEventListener("keydown",this),this.container.addEventListener("keyup",this),this.viewer.container.addEventListener("mouseup",this),this.viewer.container.addEventListener("touchend",this)}destroy(){this.__onMouseUp(),this.viewer.container.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchend",this),super.destroy()}handleEvent(t){switch(t.type){case"mousedown":this.__onMouseDown();break;case"mouseup":this.__onMouseUp();break;case"touchend":this.__onMouseUp();break;case"keydown":t.key===$s.Enter&&this.__onMouseDown();break;case"keyup":t.key===$s.Enter&&this.__onMouseUp();break}}onClick(){}isSupported(){return K1(Ts.isTouchEnabled)}__onMouseDown(){if(!this.state.enabled)return;const t={};switch(this.direction){case 0:t.pitch=!1;break;case 1:t.pitch=!0;break;case 3:t.yaw=!1;break;default:t.yaw=!0;break}this.viewer.stopAll(),this.viewer.dynamics.position.roll(t),this.handler.down()}__onMouseUp(){this.state.enabled&&this.handler.up(()=>{this.viewer.dynamics.position.stop(),this.viewer.resetIdleTimer()})}};Sy.groupId="move";var yD=class extends Sy{constructor(t){super(t,1)}};yD.id="moveDown";var _D=class extends Sy{constructor(t){super(t,2)}};_D.id="moveLeft";var xD=class extends Sy{constructor(t){super(t,3)}};xD.id="moveRight";var bD=class extends Sy{constructor(t){super(t,0)}};bD.id="moveUp";var OC=class extends Na{constructor(t,e,n){super(t,{className:"psv-zoom-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:e}),this.direction=n,this.handler=new tb,this.container.addEventListener("mousedown",this),this.container.addEventListener("keydown",this),this.container.addEventListener("keyup",this),this.viewer.container.addEventListener("mouseup",this),this.viewer.container.addEventListener("touchend",this)}destroy(){this.__onMouseUp(),this.viewer.container.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchend",this),super.destroy()}handleEvent(t){switch(t.type){case"mousedown":this.__onMouseDown();break;case"mouseup":this.__onMouseUp();break;case"touchend":this.__onMouseUp();break;case"keydown":t.key===$s.Enter&&this.__onMouseDown();break;case"keyup":t.key===$s.Enter&&this.__onMouseUp();break}}onClick(){}isSupported(){return K1(Ts.isTouchEnabled)}__onMouseDown(){this.state.enabled&&(this.viewer.dynamics.zoom.roll(this.direction===1),this.handler.down())}__onMouseUp(){this.state.enabled&&this.handler.up(()=>this.viewer.dynamics.zoom.stop())}};OC.groupId="zoom";var wD=class extends OC{constructor(t){super(t,ac.zoomIn,0)}};wD.id="zoomIn";var SD=class extends OC{constructor(t){super(t,ac.zoomOut,1)}};SD.id="zoomOut";var FC=class extends Na{constructor(t){super(t,{className:"psv-zoom-range",hoverScale:!1,collapsable:!1,tabbable:!1}),this.zoomRange=document.createElement("div"),this.zoomRange.className="psv-zoom-range-line",this.container.appendChild(this.zoomRange),this.zoomValue=document.createElement("div"),this.zoomValue.className="psv-zoom-range-handle",this.zoomRange.appendChild(this.zoomValue),this.slider=new b4(this.container,"HORIZONTAL",e=>this.__onSliderUpdate(e)),this.mediaMinWidth=parseInt(Yc(this.container,"max-width"),10),this.viewer.addEventListener(nh.type,this),this.viewer.state.ready?this.__moveZoomValue(this.viewer.getZoomLevel()):this.viewer.addEventListener(yy.type,this)}destroy(){this.slider.destroy(),this.viewer.removeEventListener(nh.type,this),this.viewer.removeEventListener(yy.type,this),super.destroy()}handleEvent(t){t instanceof nh?this.__moveZoomValue(t.zoomLevel):t instanceof yy&&this.__moveZoomValue(this.viewer.getZoomLevel())}onClick(){}isSupported(){return K1(Ts.isTouchEnabled)}autoSize(){this.state.supported&&(this.viewer.state.size.width<=this.mediaMinWidth&&this.state.visible?this.hide(!1):this.viewer.state.size.width>this.mediaMinWidth&&!this.state.visible&&this.show(!1))}__moveZoomValue(t){this.zoomValue.style.left=t/100*this.zoomRange.offsetWidth-this.zoomValue.offsetWidth/2+"px"}__onSliderUpdate(t){t.mousedown&&this.viewer.zoom(t.value*100)}};FC.id="zoomRange",FC.groupId="zoom";var ED=class extends w4{constructor(t){super(),this.viewer=t}init(){}destroy(){}},sp=class extends ED{constructor(t,e){super(t),this.config=this.constructor.configParser(e)}setOption(t,e){this.setOptions({[t]:e})}setOptions(t){const e={...this.config,...t},n=this.constructor,i=n.configParser,r=n.readonlyOptions,a=n.id;for(let[u,l]of Object.entries(t)){if(!(u in i.defaults)){Vr(`${a}: Unknown option "${u}"`);continue}if(r.includes(u)){Vr(`${a}: Option "${u}" cannot be updated`);continue}u in i.parsers&&(l=i.parsers[u](l,{rawConfig:e,defValue:i.defaults[u]})),this.config[u]=l}}};sp.readonlyOptions=[];function zC(t){if(t){for(const[,e]of[["_",t],...Object.entries(t)])if(e.prototype instanceof ED)return RC(e.id,e.VERSION,"5.10.0"),e}return null}var Qc={panorama:null,container:null,adapter:[vg,null],plugins:[],caption:null,description:null,downloadUrl:null,downloadName:null,loadingImg:null,loadingTxt:"",size:null,fisheye:0,minFov:30,maxFov:90,defaultZoomLvl:50,defaultYaw:0,defaultPitch:0,sphereCorrection:null,moveSpeed:1,zoomSpeed:1,moveInertia:!0,mousewheel:!0,mousemove:!0,mousewheelCtrlKey:!1,touchmoveTwoFingers:!1,panoData:null,requestHeaders:null,rendererParameters:{alpha:!0,antialias:!0},withCredentials:!1,navbar:["zoom","move","download","description","caption","fullscreen"],lang:{zoom:"Zoom",zoomOut:"Zoom out",zoomIn:"Zoom in",moveUp:"Move up",moveDown:"Move down",moveLeft:"Move left",moveRight:"Move right",description:"Description",download:"Download",fullscreen:"Fullscreen",loading:"Loading...",menu:"Menu",close:"Close",twoFingers:"Use two fingers to navigate",ctrlZoom:"Use ctrl + scroll to zoom the image",loadError:"The panorama cannot be loaded",webglError:"Your browser does not seem to support WebGL"},keyboard:"fullscreen",keyboardActions:{[$s.ArrowUp]:"ROTATE_UP",[$s.ArrowDown]:"ROTATE_DOWN",[$s.ArrowRight]:"ROTATE_RIGHT",[$s.ArrowLeft]:"ROTATE_LEFT",[$s.PageUp]:"ZOOM_IN",[$s.PageDown]:"ZOOM_OUT",[$s.Plus]:"ZOOM_IN",[$s.Minus]:"ZOOM_OUT"}},MD={panorama:"Use setPanorama method to change the panorama",panoData:"Use setPanorama method to change the panorama",container:"Cannot change viewer container",adapter:"Cannot change adapter",plugins:"Cannot change plugins"},NC={container:t=>{if(!t)throw new qn("No value given for container.");return t},adapter:(t,{defValue:e})=>{if(t?Array.isArray(t)?t=[pD(t[0]),t[1]]:t=[pD(t),null]:t=e,!t[0])throw new qn("An undefined value was given for adapter.");if(!t[0].id)throw new qn("Adapter has no id.");return t[0].id==="little-planet"&&(Vr("LittlePlanetAdapter support has been removed, use `{ fisheye: 2, maxFov: 130 }` to achieve similar effect."),t=e),t},defaultYaw:t=>Jc(t),defaultPitch:t=>Jc(t,!0),defaultZoomLvl:t=>Yr.clamp(t,0,100),minFov:(t,{rawConfig:e})=>(e.maxFov<t&&(Vr("maxFov cannot be lower than minFov"),t=e.maxFov),Yr.clamp(t,1,179)),maxFov:(t,{rawConfig:e})=>(t<e.minFov&&(t=e.minFov),Yr.clamp(t,1,179)),lang:t=>({...Qc.lang,...t}),keyboard:t=>t?typeof t=="object"?(Vr("Use keyboardActions to configure the keyboard actions, keyboard option must be either true, false, 'fullscreen' or 'always'"),"fullscreen"):t==="always"?"always":"fullscreen":!1,keyboardActions:(t,{rawConfig:e})=>e.keyboard&&typeof e.keyboard=="object"?e.keyboard:t,fisheye:t=>t===!0?1:t===!1?0:t,requestHeaders:t=>t&&typeof t=="object"?()=>t:typeof t=="function"?t:null,rendererParameters:(t,{defValue:e})=>({...t,...e}),plugins:t=>t.map((e,n)=>{if(Array.isArray(e)?e=[zC(e[0]),e[1]]:e=[zC(e),null],!e[0])throw new qn(`An undefined value was given for plugin ${n}.`);if(!e[0].id)throw new qn(`Plugin ${n} has no id.`);return e}),navbar:t=>t===!1?null:t===!0?Y1(Qc.navbar):typeof t=="string"?t.split(/[ ,]/):t},XW=eb(Qc,NC),yg=class extends Na{constructor(t){super(t,{className:"psv-caption",hoverScale:!1,collapsable:!1,tabbable:!0}),this.contentWidth=0,this.state.width=0,this.contentElt=document.createElement("div"),this.contentElt.className="psv-caption-content",this.container.appendChild(this.contentElt),this.setCaption(this.viewer.config.caption)}hide(){this.contentElt.style.display="none",this.state.visible=!1}show(){this.contentElt.style.display="",this.state.visible=!0}onClick(){}setCaption(t){this.show(),this.contentElt.innerHTML=t??"",this.contentElt.innerHTML?this.contentWidth=this.contentElt.offsetWidth:this.contentWidth=0,this.autoSize()}autoSize(){this.toggle(this.container.offsetWidth>=this.contentWidth),this.__refreshButton()}__refreshButton(){var t;(t=this.viewer.navbar.getButton(wy.id,!1))==null||t.autoSize(!0)}};yg.id="caption";var BC={},ob={};function ZW(t,e){if(!t.id)throw new qn("Button id is required");BC[t.id]=t,t.groupId&&(ob[t.groupId]=ob[t.groupId]||[]).push(t)}[SD,FC,wD,wy,yg,gD,vD,_D,xD,bD,yD].forEach(t=>ZW(t));var YW=class extends da{constructor(t){super(t,{className:`psv-navbar ${uy}`}),this.collapsed=[],this.state.visible=!1}show(){this.viewer.container.classList.add("psv--has-navbar"),this.container.classList.add("psv-navbar--open"),this.state.visible=!0}hide(){this.viewer.container.classList.remove("psv--has-navbar"),this.container.classList.remove("psv-navbar--open"),this.state.visible=!1}setButtons(t){this.children.slice().forEach(e=>e.destroy()),this.children.length=0,t.indexOf(yg.id)!==-1&&t.indexOf(wy.id)===-1&&t.splice(t.indexOf(yg.id),0,wy.id),t.forEach(e=>{typeof e=="object"?new GW(this,e):BC[e]?new BC[e](this):ob[e]?ob[e].forEach(n=>{new n(this)}):Vr(`Unknown button ${e}`)}),new sb(this),this.children.forEach(e=>{e instanceof Na&&e.checkSupported()}),this.autoSize()}setCaption(t){this.children.some(e=>e instanceof yg?(e.setCaption(t),!0):!1)}getButton(t,e=!0){const n=this.children.find(i=>i instanceof Na&&i.id===t);return!n&&e&&Vr(`button "${t}" not found in the navbar`),n}autoSize(){var i;this.children.forEach(r=>{r instanceof Na&&r.autoSize()});const t=this.container.offsetWidth;let e=0;const n=[];this.children.forEach(r=>{r.isVisible()&&r instanceof Na&&(e+=r.width,r.collapsable&&n.push(r))}),e!==0&&(t<e&&n.length>0?(n.forEach(r=>r.collapse()),this.collapsed=n,this.getButton(sb.id).show(!1)):t>=e&&this.collapsed.length>0&&(this.collapsed.forEach(r=>r.uncollapse()),this.collapsed=[],this.getButton(sb.id).hide(!1)),(i=this.getButton(yg.id,!1))==null||i.autoSize())}};fC.enabled=!1;var _g={enabled:!0,maxItems:10,ttl:10*60,items:{},purgeInterval:null,init(){fC.enabled&&(Vr("ThreeJS cache should be disabled"),fC.enabled=!1),!this.purgeInterval&&this.enabled&&(this.purgeInterval=setInterval(()=>this.purge(),60*1e3))},add(t,e,n){this.enabled&&e&&(this.items[e]=this.items[e]??{files:{},lastAccess:null},this.items[e].files[t]=n,this.items[e].lastAccess=Date.now())},get(t,e){if(this.enabled&&e&&this.items[e])return this.items[e].lastAccess=Date.now(),this.items[e].files[t]},remove(t,e){this.enabled&&e&&this.items[e]&&(delete this.items[e].files[t],Object.keys(this.items[e].files).length===0&&delete this.items[e])},purge(){Object.entries(this.items).sort(([,t],[,e])=>e.lastAccess-t.lastAccess).forEach(([t,{lastAccess:e}],n)=>{n>0&&(Date.now()-e>=this.ttl*1e3||n>=this.maxItems)&&delete this.items[t]})}},KW=class extends da{constructor(t){super(t,{className:"psv-loader-container"}),this.loader=document.createElement("div"),this.loader.className="psv-loader",this.container.appendChild(this.loader),this.size=this.loader.offsetWidth,this.canvas=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.canvas.setAttribute("class","psv-loader-canvas"),this.canvas.setAttribute("viewBox",`0 0 ${this.size} ${this.size}`),this.loader.appendChild(this.canvas),this.textColor=Yc(this.loader,"color"),this.color=Yc(this.canvas,"color"),this.border=parseInt(Yc(this.loader,"--psv-loader-border"),10),this.thickness=parseInt(Yc(this.loader,"--psv-loader-tickness"),10),this.viewer.addEventListener(ha.type,this),this.__updateContent(),this.hide()}destroy(){this.viewer.removeEventListener(ha.type,this),super.destroy()}handleEvent(t){t instanceof ha&&t.containsOptions("loadingImg","loadingTxt")&&this.__updateContent()}setProgress(t){const e=Math.min(t,99.999)/100*Math.PI*2,n=this.size/2,i=n,r=this.thickness/2+this.border,a=(this.size-this.thickness)/2-this.border,u=Math.sin(e)*a+n,l=-Math.cos(e)*a+n,f=t>50?"1":"0";this.canvas.innerHTML=`
            <circle cx="${n}" cy="${n}" r="${n}" fill="${this.color}"/>
            <path d="M ${i} ${r} A ${a} ${a} 0 ${f} 1 ${u} ${l}" 
                  fill="none" stroke="${this.textColor}" stroke-width="${this.thickness}" stroke-linecap="round"/>
        `,this.viewer.dispatchEvent(new $4(Math.round(t)))}__updateContent(){const t=this.loader.querySelector(".psv-loader-image, .psv-loader-text");t&&this.loader.removeChild(t);let e;if(this.viewer.config.loadingImg?(e=document.createElement("img"),e.className="psv-loader-image",e.src=this.viewer.config.loadingImg):this.viewer.config.loadingTxt!==null&&(e=document.createElement("div"),e.className="psv-loader-text",e.innerHTML=this.viewer.config.loadingTxt||this.viewer.config.lang.loading),e){const n=Math.round(Math.sqrt(2*Math.pow(this.size/2-this.thickness/2-this.border,2)));e.style.maxWidth=n+"px",e.style.maxHeight=n+"px",this.loader.appendChild(e)}}},JW=class extends da{constructor(t){super(t,{className:"psv-notification"}),this.state={visible:!1,contentId:null,timeout:null},this.content=document.createElement("div"),this.content.className="psv-notification-content",this.container.appendChild(this.content),this.content.addEventListener("click",()=>this.hide())}isVisible(t){return this.state.visible&&(!t||!this.state.contentId||this.state.contentId===t)}toggle(){throw new qn("Notification cannot be toggled")}show(t){this.state.timeout&&(clearTimeout(this.state.timeout),this.state.timeout=null),typeof t=="string"&&(t={content:t}),this.state.contentId=t.id||null,this.content.innerHTML=t.content,this.container.classList.add("psv-notification--visible"),this.state.visible=!0,this.viewer.dispatchEvent(new _y(t.id)),t.timeout&&(this.state.timeout=setTimeout(()=>this.hide(this.state.contentId),t.timeout))}hide(t){if(this.isVisible(t)){const e=this.state.contentId;this.container.classList.remove("psv-notification--visible"),this.state.visible=!1,this.state.contentId=null,this.viewer.dispatchEvent(new my(e))}}},QW=class extends da{constructor(t){super(t,{className:`psv-overlay ${uy}`}),this.state={visible:!1,contentId:null,dissmisable:!0},this.image=document.createElement("div"),this.image.className="psv-overlay-image",this.container.appendChild(this.image),this.title=document.createElement("div"),this.title.className="psv-overlay-title",this.container.appendChild(this.title),this.text=document.createElement("div"),this.text.className="psv-overlay-text",this.container.appendChild(this.text),this.container.addEventListener("click",this),this.viewer.addEventListener(vd.type,this),super.hide()}destroy(){this.viewer.removeEventListener(vd.type,this),super.destroy()}handleEvent(t){t.type==="click"?this.isVisible()&&this.state.dissmisable&&(this.hide(),t.stopPropagation()):t instanceof vd&&this.isVisible()&&this.state.dissmisable&&t.key===$s.Escape&&(this.hide(),t.preventDefault())}isVisible(t){return this.state.visible&&(!t||!this.state.contentId||this.state.contentId===t)}toggle(){throw new qn("Overlay cannot be toggled")}show(t){typeof t=="string"&&(t={title:t}),this.state.contentId=t.id||null,this.state.dissmisable=t.dissmisable!==!1,this.image.innerHTML=t.image||"",this.title.innerHTML=t.title||"",this.text.innerHTML=t.text||"",super.show(),this.viewer.dispatchEvent(new tD(t.id))}hide(t){if(this.isVisible(t)){const e=this.state.contentId;super.hide(),this.state.contentId=null,this.viewer.dispatchEvent(new F4(e))}}},ej=200,UC="psv-panel-content--no-interaction",tj=class extends da{constructor(e){super(e,{className:`psv-panel ${uy}`}),this.state={visible:!1,contentId:null,mouseX:0,mouseY:0,mousedown:!1,clickHandler:null,keyHandler:null,width:{}};const n=document.createElement("div");n.className="psv-panel-resizer",this.container.appendChild(n);const i=document.createElement("div");i.className="psv-panel-close-button",i.innerHTML=ac.close,i.title=e.config.lang.close,this.container.appendChild(i),this.content=document.createElement("div"),this.content.className="psv-panel-content",this.container.appendChild(this.content),this.container.addEventListener("wheel",r=>r.stopPropagation()),i.addEventListener("click",()=>this.hide()),n.addEventListener("mousedown",this),n.addEventListener("touchstart",this),this.viewer.container.addEventListener("mouseup",this),this.viewer.container.addEventListener("touchend",this),this.viewer.container.addEventListener("mousemove",this),this.viewer.container.addEventListener("touchmove",this),this.viewer.addEventListener(vd.type,this)}destroy(){this.viewer.removeEventListener(vd.type,this),this.viewer.container.removeEventListener("mousemove",this),this.viewer.container.removeEventListener("touchmove",this),this.viewer.container.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchend",this),super.destroy()}handleEvent(e){switch(e.type){case"mousedown":this.__onMouseDown(e);break;case"touchstart":this.__onTouchStart(e);break;case"mousemove":this.__onMouseMove(e);break;case"touchmove":this.__onTouchMove(e);break;case"mouseup":this.__onMouseUp(e);break;case"touchend":this.__onTouchEnd(e);break;case vd.type:this.__onKeyPress(e);break}}isVisible(e){return this.state.visible&&(!e||!this.state.contentId||this.state.contentId===e)}toggle(){throw new qn("Panel cannot be toggled")}show(e){typeof e=="string"&&(e={content:e});const n=this.isVisible(e.id);this.state.contentId=e.id||null,this.state.visible=!0,this.state.clickHandler&&(this.content.removeEventListener("click",this.state.clickHandler),this.content.removeEventListener("keydown",this.state.keyHandler),this.state.clickHandler=null,this.state.keyHandler=null),e.id&&this.state.width[e.id]?this.container.style.width=this.state.width[e.id]:e.width?this.container.style.width=e.width:this.container.style.width=null,this.content.innerHTML=e.content,this.content.scrollTop=0,this.container.classList.add("psv-panel--open"),q1(this.content,"psv-panel-content--no-margin",e.noMargin===!0),e.clickHandler&&(this.state.clickHandler=i=>{e.clickHandler(X1(i))},this.state.keyHandler=i=>{i.key===$s.Enter&&e.clickHandler(X1(i))},this.content.addEventListener("click",this.state.clickHandler),this.content.addEventListener("keydown",this.state.keyHandler),n||setTimeout(()=>{var i;(i=this.content.querySelector("a,button,[tabindex]"))==null||i.focus()},300)),this.viewer.dispatchEvent(new yd(e.id))}hide(e){if(this.isVisible(e)){const n=this.state.contentId;this.state.visible=!1,this.state.contentId=null,this.content.innerHTML=null,this.container.classList.remove("psv-panel--open"),this.state.clickHandler&&(this.content.removeEventListener("click",this.state.clickHandler),this.state.clickHandler=null),this.viewer.dispatchEvent(new gd(n))}}__onMouseDown(e){e.stopPropagation(),this.__startResize(e.clientX,e.clientY)}__onTouchStart(e){if(e.stopPropagation(),e.touches.length===1){const n=e.touches[0];this.__startResize(n.clientX,n.clientY)}}__onMouseUp(e){this.state.mousedown&&(e.stopPropagation(),this.state.mousedown=!1,this.content.classList.remove(UC))}__onTouchEnd(e){this.state.mousedown&&(e.stopPropagation(),e.touches.length===0&&(this.state.mousedown=!1,this.content.classList.remove(UC)))}__onMouseMove(e){this.state.mousedown&&(e.stopPropagation(),this.__resize(e.clientX,e.clientY))}__onTouchMove(e){if(this.state.mousedown){const n=e.touches[0];this.__resize(n.clientX,n.clientY)}}__onKeyPress(e){this.isVisible()&&e.key===$s.Escape&&(this.hide(),e.preventDefault())}__startResize(e,n){this.state.mouseX=e,this.state.mouseY=n,this.state.mousedown=!0,this.content.classList.add(UC)}__resize(e,n){const i=e,r=n,a=Math.max(ej,this.container.offsetWidth-(i-this.state.mouseX))+"px";this.state.contentId&&(this.state.width[this.state.contentId]=a),this.container.style.width=a,this.state.mouseX=i,this.state.mouseY=r}},nj=class extends da{constructor(t,e){super(t,{className:"psv-tooltip"}),this.state={visible:!0,arrow:0,border:0,state:0,width:0,height:0,pos:"",config:null,data:null,hideTimeout:null},this.content=document.createElement("div"),this.content.className="psv-tooltip-content",this.container.appendChild(this.content),this.arrow=document.createElement("div"),this.arrow.className="psv-tooltip-arrow",this.container.appendChild(this.arrow),this.container.addEventListener("transitionend",this),this.container.addEventListener("touchdown",n=>n.stopPropagation()),this.container.addEventListener("mousedown",n=>n.stopPropagation()),this.container.style.top="-1000px",this.container.style.left="-1000px",this.show(e)}handleEvent(t){t.type==="transitionend"&&this.__onTransitionEnd(t)}destroy(){clearTimeout(this.state.hideTimeout),delete this.state.data,super.destroy()}toggle(){throw new qn("Tooltip cannot be toggled")}show(t){if(this.state.state!==0)throw new qn("Initialized tooltip cannot be re-initialized");t.className&&xC(this.container,t.className),t.style&&Object.assign(this.container.style,t.style),this.state.state=3,this.update(t.content,t),this.state.data=t.data,this.state.state=1,this.viewer.dispatchEvent(new rD(this,this.state.data)),this.__waitImages()}update(t,e){this.content.innerHTML=t;const n=this.container.getBoundingClientRect();this.state.width=n.right-n.left,this.state.height=n.bottom-n.top,this.state.arrow=parseInt(Yc(this.arrow,"border-top-width"),10),this.state.border=parseInt(Yc(this.container,"border-top-left-radius"),10),this.move(e??this.state.config),this.__waitImages()}move(t){var l;if(this.state.state!==1&&this.state.state!==3)throw new qn("Uninitialized tooltip cannot be moved");t.box=t.box??((l=this.state.config)==null?void 0:l.box)??{width:0,height:0},this.state.config=t;const e=this.container,n=this.arrow,i={posClass:p4(t.position,{allowCenter:!1,cssOrder:!1})||["top","center"],width:this.state.width,height:this.state.height,top:0,left:0,arrowTop:0,arrowLeft:0};this.__computeTooltipPosition(i,t);let r=null,a=null;if(i.top<0?r="bottom":i.top+i.height>this.viewer.state.size.height&&(r="top"),i.left<0?a="right":i.left+i.width>this.viewer.state.size.width&&(a="left"),a||r){const f=TC(i.posClass);r&&(i.posClass[f?0:1]=r),a&&(i.posClass[f?1:0]=a),this.__computeTooltipPosition(i,t)}e.style.top=i.top+"px",e.style.left=i.left+"px",n.style.top=i.arrowTop+"px",n.style.left=i.arrowLeft+"px";const u=i.posClass.join("-");u!==this.state.pos&&(e.classList.remove(`psv-tooltip--${this.state.pos}`),this.state.pos=u,e.classList.add(`psv-tooltip--${this.state.pos}`))}hide(){this.container.classList.remove("psv-tooltip--visible"),this.state.state=2,this.viewer.dispatchEvent(new B4(this.state.data));const t=parseFloat(Yc(this.container,"transition-duration"));this.state.hideTimeout=setTimeout(()=>{this.destroy()},t*2)}__onTransitionEnd(t){if(t.propertyName==="transform")switch(this.state.state){case 1:this.container.classList.add("psv-tooltip--visible"),this.state.state=3;break;case 2:this.state.state=0,this.destroy();break}}__computeTooltipPosition(t,e){const n=this.state.arrow,i=e.top,r=t.height,a=e.left,u=t.width,l=n+this.state.border,f=e.box.width/2+n*2,g=e.box.height/2+n*2;switch(t.posClass.join("-")){case"top-left":t.top=i-g-r,t.left=a+l-u,t.arrowTop=r,t.arrowLeft=u-l-n;break;case"top-center":t.top=i-g-r,t.left=a-u/2,t.arrowTop=r,t.arrowLeft=u/2-n;break;case"top-right":t.top=i-g-r,t.left=a-l,t.arrowTop=r,t.arrowLeft=n;break;case"bottom-left":t.top=i+g,t.left=a+l-u,t.arrowTop=-n*2,t.arrowLeft=u-l-n;break;case"bottom-center":t.top=i+g,t.left=a-u/2,t.arrowTop=-n*2,t.arrowLeft=u/2-n;break;case"bottom-right":t.top=i+g,t.left=a-l,t.arrowTop=-n*2,t.arrowLeft=n;break;case"left-top":t.top=i+l-r,t.left=a-f-u,t.arrowTop=r-l-n,t.arrowLeft=u;break;case"center-left":t.top=i-r/2,t.left=a-f-u,t.arrowTop=r/2-n,t.arrowLeft=u;break;case"left-bottom":t.top=i-l,t.left=a-f-u,t.arrowTop=n,t.arrowLeft=u;break;case"right-top":t.top=i+l-r,t.left=a+f,t.arrowTop=r-l-n,t.arrowLeft=-n*2;break;case"center-right":t.top=i-r/2,t.left=a+f,t.arrowTop=r/2-n,t.arrowLeft=-n*2;break;case"right-bottom":t.top=i-l,t.left=a+f,t.arrowTop=n,t.arrowLeft=-n*2;break}}__waitImages(){const t=this.content.querySelectorAll("img");if(t.length>0){const e=[];t.forEach(n=>{n.complete||e.push(new Promise(i=>{n.onload=i,n.onerror=i}))}),e.length&&Promise.all(e).then(()=>{if(this.state.state===1||this.state.state===3){const n=this.container.getBoundingClientRect();this.state.width=n.right-n.left,this.state.height=n.bottom-n.top,this.move(this.state.config)}})}}},ij=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="15 15 70 70"><path fill="currentColor" d="M50,16.2c-18.6,0-33.8,15.1-33.8,33.8S31.4,83.7,50,83.7S83.8,68.6,83.8,50S68.6,16.2,50,16.2z M50,80.2c-16.7,0-30.2-13.6-30.2-30.2S33.3,19.7,50,19.7S80.3,33.3,80.3,50S66.7,80.2,50,80.2z"/><rect fill="currentColor" x="48" y="31.7" width="4" height="28"/><rect fill="currentColor" x="48" y="63.2" width="4" height="5"/><!--Created by Shastry from the Noun Project--></svg>
`,Ey=class{constructor(t){this.viewer=t,this.config=t.config,this.state=t.state}destroy(){}},lc=new pt,ab=new ud(0,0,0,"ZXY"),rj=class extends Ey{constructor(t){super(t)}fovToZoomLevel(t){const e=Math.round((t-this.config.minFov)/(this.config.maxFov-this.config.minFov)*100);return Yr.clamp(e-2*(e-50),0,100)}zoomLevelToFov(t){return this.config.maxFov+t/100*(this.config.minFov-this.config.maxFov)}vFovToHFov(t){return Yr.radToDeg(2*Math.atan(Math.tan(Yr.degToRad(t)/2)*this.state.aspect))}hFovToVFov(t){return Yr.radToDeg(2*Math.atan(Math.tan(Yr.degToRad(t)/2)/this.state.aspect))}getAnimationProperties(t,e,n){const i=!Hs(e),r=!Hs(n),a={};let u=null;if(i){const l=this.viewer.getPosition(),f=Jk(l.yaw,e.yaw);a.yaw={start:l.yaw,end:l.yaw+f},a.pitch={start:l.pitch,end:e.pitch},u=AC(t,Qk(l,e))}if(r){const l=this.viewer.getZoomLevel(),f=Math.abs(n-l);a.zoom={start:l,end:n},u===null&&(u=AC(t,Math.PI/4*f/100))}return u===null?typeof t=="number"?u=t:u=vC:u=Math.max(vC,u),{duration:u,properties:a}}textureCoordsToSphericalCoords(t){var n;if(!((n=this.state.textureData)!=null&&n.panoData))throw new qn("Current adapter does not support texture coordinates or no texture has been loaded");const e=this.viewer.adapter.textureCoordsToSphericalCoords(t,this.state.textureData.panoData);return!ab.equals(this.viewer.renderer.panoramaPose)||!ab.equals(this.viewer.renderer.sphereCorrection)?(this.sphericalCoordsToVector3(e,lc),lc.applyEuler(this.viewer.renderer.panoramaPose),lc.applyEuler(this.viewer.renderer.sphereCorrection),this.vector3ToSphericalCoords(lc)):e}sphericalCoordsToTextureCoords(t){var e;if(!((e=this.state.textureData)!=null&&e.panoData))throw new qn("Current adapter does not support texture coordinates or no texture has been loaded");return(!ab.equals(this.viewer.renderer.panoramaPose)||!ab.equals(this.viewer.renderer.sphereCorrection))&&(this.sphericalCoordsToVector3(t,lc),IC(lc,this.viewer.renderer.sphereCorrection),IC(lc,this.viewer.renderer.panoramaPose),t=this.vector3ToSphericalCoords(lc)),this.viewer.adapter.sphericalCoordsToTextureCoords(t,this.state.textureData.panoData)}sphericalCoordsToVector3(t,e,n=gg){return e||(e=new pt),e.x=n*-Math.cos(t.pitch)*Math.sin(t.yaw),e.y=n*Math.sin(t.pitch),e.z=n*Math.cos(t.pitch)*Math.cos(t.yaw),e}vector3ToSphericalCoords(t){const e=Math.acos(t.y/Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z)),n=Math.atan2(t.x,t.z);return{yaw:n<0?-n:Math.PI*2-n,pitch:Math.PI/2-e}}viewerCoordsToVector3(t){const e=this.viewer.renderer.getIntersections(t).filter(n=>n.object.userData[md]);return e.length?e[0].point:null}viewerCoordsToSphericalCoords(t){const e=this.viewerCoordsToVector3(t);return e?this.vector3ToSphericalCoords(e):null}vector3ToViewerCoords(t){const e=t.clone();return e.project(this.viewer.renderer.camera),{x:Math.round((e.x+1)/2*this.state.size.width),y:Math.round((1-e.y)/2*this.state.size.height)}}sphericalCoordsToViewerCoords(t){return this.sphericalCoordsToVector3(t,lc),this.vector3ToViewerCoords(lc)}isPointVisible(t){let e,n;if(t instanceof pt)e=t,n=this.vector3ToViewerCoords(t);else if(CC(t))e=this.sphericalCoordsToVector3(t,lc),n=this.vector3ToViewerCoords(e);else return!1;return e.dot(this.viewer.state.direction)>0&&n.x>=0&&n.x<=this.viewer.state.size.width&&n.y>=0&&n.y<=this.viewer.state.size.height}cleanPosition(t){if("yaw"in t||"pitch"in t){if(!("yaw"in t)||!("pitch"in t))throw new qn("Position is missing 'yaw' or 'pitch'");return{yaw:Jc(t.yaw),pitch:Jc(t.pitch,!0)}}else return this.textureCoordsToSphericalCoords(t)}cleanSphereCorrection(t){return{pan:Jc((t==null?void 0:t.pan)||0),tilt:Jc((t==null?void 0:t.tilt)||0,!0),roll:Jc((t==null?void 0:t.roll)||0,!0,!1)}}cleanPanoramaPose(t){return{pan:Yr.degToRad((t==null?void 0:t.poseHeading)||0),tilt:Yr.degToRad((t==null?void 0:t.posePitch)||0),roll:Yr.degToRad((t==null?void 0:t.poseRoll)||0)}}cleanPanoramaOptions(t,e){return e!=null&&e.isEquirectangular&&(Hs(t.zoom)&&!Hs(e.initialFov)&&(t={...t,zoom:this.fovToZoomLevel(this.hFovToVFov(e.initialFov))}),Hs(t.position)&&!Hs(e.initialHeading)&&!Hs(e.initialPitch)&&(t={...t,position:{yaw:Jc(e.initialHeading),pitch:Jc(e.initialPitch,!0)}})),t}},sj=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M33.38 33.2a1.96 1.96 0 0 0 1.5-3.23 10.61 10.61 0 0 1 7.18-17.51c.7-.06 1.31-.49 1.61-1.12a13.02 13.02 0 0 1 11.74-7.43c7.14 0 12.96 5.8 12.96 12.9 0 3.07-1.1 6.05-3.1 8.38-.7.82-.61 2.05.21 2.76.83.7 2.07.6 2.78-.22a16.77 16.77 0 0 0 4.04-10.91C72.3 7.54 64.72 0 55.4 0a16.98 16.98 0 0 0-14.79 8.7 14.6 14.6 0 0 0-12.23 14.36c0 3.46 1.25 6.82 3.5 9.45.4.45.94.69 1.5.69m45.74 43.55a22.13 22.13 0 0 1-5.23 12.4c-4 4.55-9.53 6.86-16.42 6.86-12.6 0-20.1-10.8-20.17-10.91a1.82 1.82 0 0 0-.08-.1c-5.3-6.83-14.55-23.82-17.27-28.87-.05-.1 0-.21.02-.23a6.3 6.3 0 0 1 8.24 1.85l9.38 12.59a1.97 1.97 0 0 0 3.54-1.17V25.34a4 4 0 0 1 1.19-2.87 3.32 3.32 0 0 1 2.4-.95c1.88.05 3.4 1.82 3.4 3.94v24.32a1.96 1.96 0 0 0 3.93 0v-33.1a3.5 3.5 0 0 1 7 0v35.39a1.96 1.96 0 0 0 3.93 0v-.44c.05-2.05 1.6-3.7 3.49-3.7 1.93 0 3.5 1.7 3.5 3.82v5.63c0 .24.04.48.13.71l.1.26a1.97 1.97 0 0 0 3.76-.37c.33-1.78 1.77-3.07 3.43-3.07 1.9 0 3.45 1.67 3.5 3.74l-1.77 18.1zM77.39 51c-1.25 0-2.45.32-3.5.9v-.15c0-4.27-3.33-7.74-7.42-7.74-1.26 0-2.45.33-3.5.9V16.69a7.42 7.42 0 0 0-14.85 0v1.86a7 7 0 0 0-3.28-.94 7.21 7.21 0 0 0-5.26 2.07 7.92 7.92 0 0 0-2.38 5.67v37.9l-5.83-7.82a10.2 10.2 0 0 0-13.35-2.92 4.1 4.1 0 0 0-1.53 5.48C20 64.52 28.74 80.45 34.07 87.34c.72 1.04 9.02 12.59 23.4 12.59 7.96 0 14.66-2.84 19.38-8.2a26.06 26.06 0 0 0 6.18-14.6l1.78-18.2v-.2c0-4.26-3.32-7.73-7.42-7.73z"/><!--Created by AomAm from the Noun Project--></svg>
`,oj=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="10 17 79 79"><path fill="currentColor" d="M38.1 29.27c-.24 0-.44.2-.44.45v10.7a.45.45 0 00.9 0v-10.7c0-.25-.2-.45-.45-.45zm10.2 26.66a11.54 11.54 0 01-8.48-6.14.45.45 0 10-.8.41 12.45 12.45 0 009.22 6.62.45.45 0 00.07-.9zm24.55-13.08a23.04 23.04 0 00-22.56-23v7.07l-.01.05a2.83 2.83 0 012.39 2.78v14.03l.09-.02h8.84v-9.22a.45.45 0 11.9 0v9.22h10.35v-.9zm0 27.33V44.66H62.5c-.02 2.01-.52 4-1.47 5.76a.45.45 0 01-.61.18.45.45 0 01-.19-.61 11.54 11.54 0 001.36-5.33h-8.83l-.1-.01a2.83 2.83 0 01-2.83 2.84h-.04-.04a2.83 2.83 0 01-2.83-2.83v-14.9a2.82 2.82 0 012.47-2.8v-7.11a23.04 23.04 0 00-22.57 23v.91h14.72V29.88a8.2 8.2 0 015.02-7.57c.22-.1.5.01.59.24.1.23-.01.5-.24.6a7.3 7.3 0 00-4.47 6.73v13.88h3.9a.45.45 0 110 .9h-3.9v.15a7.32 7.32 0 0011.23 6.17.45.45 0 01.49.76 8.22 8.22 0 01-12.62-6.93v-.15H26.82v25.52a23.04 23.04 0 0023.01 23.01 23.04 23.04 0 0023.02-23.01zm1.8-27.33v27.33A24.85 24.85 0 0149.84 95a24.85 24.85 0 01-24.82-24.82V42.85a24.85 24.85 0 0124.82-24.82 24.85 24.85 0 0124.83 24.82zM57.98 29.88v9.36a.45.45 0 11-.9 0v-9.36a7.28 7.28 0 00-3.4-6.17.45.45 0 01.49-.76 8.18 8.18 0 013.8 6.93z"/><!-- Created by Icon Island from the Noun Project --></svg>
`,My=class C9{constructor(){this.$=C9.IDLE}is(...e){return e.some(n=>this.$&n)}set(e){this.$=e}add(e){this.$|=e}remove(e){this.$&=~e}};My.IDLE=0,My.CLICK=1,My.MOVING=2,My.INERTIA=4;var kr=My,aj=class extends Ey{constructor(t){super(t),this.data={startMouseX:0,startMouseY:0,mouseX:0,mouseY:0,mouseHistory:[],pinchDist:0,ctrlKeyDown:!1,dblclickData:null,dblclickTimeout:null,longtouchTimeout:null,twofingersTimeout:null,ctrlZoomTimeout:null},this.step=new kr,this.keyHandler=new tb,this.resizeObserver=new ResizeObserver(wC(()=>this.viewer.autoSize(),50)),this.moveThreshold=Wk*Ts.pixelRatio}init(){window.addEventListener("keydown",this,{passive:!1}),window.addEventListener("keyup",this),this.viewer.container.addEventListener("mousedown",this),window.addEventListener("mousemove",this,{passive:!1}),window.addEventListener("mouseup",this),this.viewer.container.addEventListener("touchstart",this,{passive:!1}),window.addEventListener("touchmove",this,{passive:!1}),window.addEventListener("touchend",this,{passive:!1}),this.viewer.container.addEventListener("wheel",this,{passive:!1}),document.addEventListener("fullscreenchange",this),this.resizeObserver.observe(this.viewer.container)}destroy(){window.removeEventListener("keydown",this),window.removeEventListener("keyup",this),this.viewer.container.removeEventListener("mousedown",this),window.removeEventListener("mousemove",this),window.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchstart",this),window.removeEventListener("touchmove",this),window.removeEventListener("touchend",this),this.viewer.container.removeEventListener("wheel",this),document.removeEventListener("fullscreenchange",this),this.resizeObserver.disconnect(),clearTimeout(this.data.dblclickTimeout),clearTimeout(this.data.longtouchTimeout),clearTimeout(this.data.twofingersTimeout),clearTimeout(this.data.ctrlZoomTimeout),super.destroy()}handleEvent(t){switch(t.type){case"keydown":this.__onKeyDown(t);break;case"keyup":this.__onKeyUp();break;case"mousemove":this.__onMouseMove(t);break;case"mouseup":this.__onMouseUp(t);break;case"touchmove":this.__onTouchMove(t);break;case"touchend":this.__onTouchEnd(t);break;case"fullscreenchange":this.__onFullscreenChange();break}if(!n4(t,"."+uy))switch(t.type){case"mousedown":this.__onMouseDown(t);break;case"touchstart":this.__onTouchStart(t);break;case"wheel":this.__onMouseWheel(t);break}}__onKeyDown(t){var n;if(this.config.mousewheelCtrlKey&&(this.data.ctrlKeyDown=t.key===$s.Control,this.data.ctrlKeyDown&&(clearTimeout(this.data.ctrlZoomTimeout),this.viewer.overlay.hide(ro.CTRL_ZOOM))),!this.viewer.dispatchEvent(new vd(t.key))||!this.state.keyboardEnabled)return;const e=(n=this.config.keyboardActions)==null?void 0:n[t.key];if(typeof e=="function")e(this.viewer),t.preventDefault();else if(e&&!this.keyHandler.pending){switch(e!=="ZOOM_IN"&&e!=="ZOOM_OUT"&&this.viewer.stopAll(),e){case"ROTATE_UP":this.viewer.dynamics.position.roll({pitch:!1});break;case"ROTATE_DOWN":this.viewer.dynamics.position.roll({pitch:!0});break;case"ROTATE_RIGHT":this.viewer.dynamics.position.roll({yaw:!1});break;case"ROTATE_LEFT":this.viewer.dynamics.position.roll({yaw:!0});break;case"ZOOM_IN":this.viewer.dynamics.zoom.roll(!1);break;case"ZOOM_OUT":this.viewer.dynamics.zoom.roll(!0);break}this.keyHandler.down(),t.preventDefault()}}__onKeyUp(){this.data.ctrlKeyDown=!1,this.state.keyboardEnabled&&this.keyHandler.up(()=>{this.viewer.dynamics.position.stop(),this.viewer.dynamics.zoom.stop(),this.viewer.resetIdleTimer()})}__onMouseDown(t){this.step.add(kr.CLICK),this.data.startMouseX=t.clientX,this.data.startMouseY=t.clientY}__onMouseUp(t){this.step.is(kr.CLICK,kr.MOVING)&&this.__stopMove(t.clientX,t.clientY,t,t.button===2)}__onMouseMove(t){this.config.mousemove&&this.step.is(kr.CLICK,kr.MOVING)&&(t.preventDefault(),this.__doMove(t.clientX,t.clientY)),this.__handleObjectsEvents(t)}__onTouchStart(t){t.touches.length===1?(this.step.add(kr.CLICK),this.data.startMouseX=t.touches[0].clientX,this.data.startMouseY=t.touches[0].clientY,this.data.longtouchTimeout||(this.data.longtouchTimeout=setTimeout(()=>{const e=t.touches[0];this.__stopMove(e.clientX,e.clientY,t,!0),this.data.longtouchTimeout=null},qk))):t.touches.length===2&&(this.step.set(kr.IDLE),this.__cancelLongTouch(),this.config.mousemove&&(this.__cancelTwoFingersOverlay(),this.__startMoveZoom(t),t.preventDefault()))}__onTouchEnd(t){if(this.__cancelLongTouch(),this.step.is(kr.CLICK,kr.MOVING)){if(t.preventDefault(),this.__cancelTwoFingersOverlay(),t.touches.length===1)this.__stopMove(this.data.mouseX,this.data.mouseY);else if(t.touches.length===0){const e=t.changedTouches[0];this.__stopMove(e.clientX,e.clientY,t)}}}__onTouchMove(t){if(this.__cancelLongTouch(),!!this.config.mousemove)if(t.touches.length===1){if(this.config.touchmoveTwoFingers)this.step.is(kr.CLICK)&&!this.data.twofingersTimeout&&(this.data.twofingersTimeout=setTimeout(()=>{this.viewer.overlay.show({id:ro.TWO_FINGERS,image:sj,title:this.config.lang.twoFingers})},Xk));else if(this.step.is(kr.CLICK,kr.MOVING)){t.preventDefault();const e=t.touches[0];this.__doMove(e.clientX,e.clientY)}}else this.__doMoveZoom(t),this.__cancelTwoFingersOverlay()}__cancelLongTouch(){this.data.longtouchTimeout&&(clearTimeout(this.data.longtouchTimeout),this.data.longtouchTimeout=null)}__cancelTwoFingersOverlay(){this.config.touchmoveTwoFingers&&(this.data.twofingersTimeout&&(clearTimeout(this.data.twofingersTimeout),this.data.twofingersTimeout=null),this.viewer.overlay.hide(ro.TWO_FINGERS))}__onMouseWheel(t){if(!this.config.mousewheel||!t.deltaY)return;if(this.config.mousewheelCtrlKey&&!this.data.ctrlKeyDown){this.viewer.overlay.show({id:ro.CTRL_ZOOM,image:oj,title:this.config.lang.ctrlZoom}),clearTimeout(this.data.ctrlZoomTimeout),this.data.ctrlZoomTimeout=setTimeout(()=>this.viewer.overlay.hide(ro.CTRL_ZOOM),Zk);return}t.preventDefault(),t.stopPropagation();const e=t.deltaY/Math.abs(t.deltaY)*5*this.config.zoomSpeed;e!==0&&this.viewer.dynamics.zoom.step(-e,5)}__onFullscreenChange(){const t=this.viewer.isFullscreenEnabled();this.config.keyboard==="fullscreen"&&(t?this.viewer.startKeyboardControl():this.viewer.stopKeyboardControl()),this.viewer.dispatchEvent(new py(t))}__resetMove(){this.step.set(kr.IDLE),this.data.mouseX=0,this.data.mouseY=0,this.data.startMouseX=0,this.data.startMouseY=0,this.data.mouseHistory.length=0}__startMoveZoom(t){this.viewer.stopAll(),this.__resetMove();const e=bC(t);this.step.set(kr.MOVING),{distance:this.data.pinchDist,center:{x:this.data.mouseX,y:this.data.mouseY}}=e,this.__logMouseMove(this.data.mouseX,this.data.mouseY)}__stopMove(t,e,n,i=!1){this.step.is(kr.MOVING)?this.config.moveInertia?(this.__logMouseMove(t,e),this.__stopMoveInertia(t,e)):(this.__resetMove(),this.viewer.resetIdleTimer()):(this.step.is(kr.CLICK)&&!this.__moveThresholdReached(t,e)&&this.__doClick(t,e,n,i),this.step.remove(kr.CLICK),this.step.is(kr.INERTIA)||(this.__resetMove(),this.viewer.resetIdleTimer()))}__stopMoveInertia(t,e){const i=new vW(this.data.mouseHistory.map(([,l,f])=>new Ui(l,f))).getTangent(1),r=this.data.mouseHistory.reduce(({total:l,prev:f},g)=>({total:f?l+_C({x:f[1],y:f[2]},{x:g[1],y:g[2]})/(g[0]-f[0]):0,prev:g}),{total:0,prev:null}).total/this.data.mouseHistory.length;if(!r){this.__resetMove(),this.viewer.resetIdleTimer();return}this.step.set(kr.INERTIA);let a=t,u=e;this.state.animation=new dy({properties:{speed:{start:r,end:0}},duration:1e3,easing:"outQuad",onTick:l=>{a+=l.speed*i.x*3*Ts.pixelRatio,u+=l.speed*i.y*3*Ts.pixelRatio,this.__applyMove(a,u)}}),this.state.animation.then(l=>{this.state.animation=null,l&&(this.__resetMove(),this.viewer.resetIdleTimer())})}__doClick(t,e,n,i=!1){const r=this.viewer.container.getBoundingClientRect(),a=t-r.left,u=e-r.top,l=this.viewer.renderer.getIntersections({x:a,y:u}),f=l.find(g=>g.object.userData[md]);if(f){const g=this.viewer.dataHelper.vector3ToSphericalCoords(f.point),y={rightclick:i,originalEvent:n,target:X1(n),clientX:t,clientY:e,viewerX:a,viewerY:u,yaw:g.yaw,pitch:g.pitch,objects:l.map(S=>S.object).filter(S=>!S.userData[md])};try{const S=this.viewer.dataHelper.sphericalCoordsToTextureCoords(y);Object.assign(y,S)}catch{}this.data.dblclickTimeout?(Math.abs(this.data.dblclickData.clientX-y.clientX)<this.moveThreshold&&Math.abs(this.data.dblclickData.clientY-y.clientY)<this.moveThreshold&&this.viewer.dispatchEvent(new L4(this.data.dblclickData)),clearTimeout(this.data.dblclickTimeout),this.data.dblclickTimeout=null,this.data.dblclickData=null):(this.viewer.dispatchEvent(new P4(y)),this.data.dblclickData=Y1(y),this.data.dblclickTimeout=setTimeout(()=>{this.data.dblclickTimeout=null,this.data.dblclickData=null},jk))}}__handleObjectsEvents(t){if(!l4(this.state.objectsObservers)&&t.composedPath().includes(this.viewer.container)){const e=i4(this.viewer.container),n={x:t.clientX-e.x,y:t.clientY-e.y},i=this.viewer.renderer.getIntersections(n),r=(a,u,l)=>{this.viewer.dispatchEvent(new l(t,a,n,u))};for(const[a,u]of Object.entries(this.state.objectsObservers)){const l=i.find(f=>f.object.userData[a]);l?(u&&l.object!==u&&(r(u,a,DC),this.state.objectsObservers[a]=null),u?r(l.object,a,fD):(this.state.objectsObservers[a]=l.object,r(l.object,a,uD))):u&&(r(u,a,DC),this.state.objectsObservers[a]=null)}}}__doMove(t,e){this.step.is(kr.CLICK)&&this.__moveThresholdReached(t,e)?(this.viewer.stopAll(),this.__resetMove(),this.step.set(kr.MOVING),this.data.mouseX=t,this.data.mouseY=e,this.__logMouseMove(t,e)):this.step.is(kr.MOVING)&&(this.__applyMove(t,e),this.__logMouseMove(t,e))}__moveThresholdReached(t,e){return Math.abs(t-this.data.startMouseX)>=this.moveThreshold||Math.abs(e-this.data.startMouseY)>=this.moveThreshold}__applyMove(t,e){const n=(t-this.data.mouseX)*Math.cos(this.state.roll)-(e-this.data.mouseY)*Math.sin(this.state.roll),i=(e-this.data.mouseY)*Math.cos(this.state.roll)+(t-this.data.mouseX)*Math.sin(this.state.roll),r={yaw:this.config.moveSpeed*(n/this.state.size.width)*Yr.degToRad(this.state.hFov),pitch:this.config.moveSpeed*(i/this.state.size.height)*Yr.degToRad(this.state.vFov)},a=this.viewer.getPosition();this.viewer.rotate({yaw:a.yaw-r.yaw,pitch:a.pitch+r.pitch}),this.data.mouseX=t,this.data.mouseY=e}__doMoveZoom(t){if(this.step.is(kr.MOVING)){t.preventDefault();const e=bC(t),n=(e.distance-this.data.pinchDist)/Ts.pixelRatio*this.config.zoomSpeed;this.viewer.zoom(this.viewer.getZoomLevel()+n),this.__doMove(e.center.x,e.center.y),this.data.pinchDist=e.distance}}__logMouseMove(t,e){const n=Date.now(),i=this.data.mouseHistory.length?this.data.mouseHistory[this.data.mouseHistory.length-1]:[0,-1,-1];i[1]===t&&i[2]===e?i[0]=n:n===i[0]?(i[1]=t,i[2]=e):this.data.mouseHistory.push([n,t,e]);let r=null;for(let a=0;a<this.data.mouseHistory.length;)this.data.mouseHistory[a][0]<n-yC?this.data.mouseHistory.splice(a,1):r&&this.data.mouseHistory[a][0]-r>yC/10?(this.data.mouseHistory.splice(0,a),a=0,r=this.data.mouseHistory[a][0]):(r=this.data.mouseHistory[a][0],a++)}};Ki.enabled=!1;var lb=new Ui,CD=new Es,TD=new Zm,lj=class extends Ey{constructor(t){super(t),this.frustumNeedsUpdate=!0,this.renderer=new mW(this.config.rendererParameters),this.renderer.setPixelRatio(Ts.pixelRatio),this.renderer.outputColorSpace=Xu,this.renderer.domElement.className="psv-canvas",this.scene=new Bk,this.camera=new Sl(50,16/9,.1,2*gg),this.camera.matrixAutoUpdate=!1,this.mesh=this.viewer.adapter.createMesh(),this.mesh.userData={[md]:!0},this.meshContainer=new mg,this.meshContainer.add(this.mesh),this.scene.add(this.meshContainer),this.raycaster=new xW,this.frustum=new iC,this.container=document.createElement("div"),this.container.className="psv-canvas-container",this.container.appendChild(this.renderer.domElement),this.viewer.container.appendChild(this.container),this.viewer.addEventListener(xy.type,this),this.viewer.addEventListener(nh.type,this),this.viewer.addEventListener(gy.type,this),this.viewer.addEventListener(vy.type,this),this.viewer.addEventListener(ha.type,this),this.hide()}get panoramaPose(){return this.mesh.rotation}get sphereCorrection(){return this.meshContainer.rotation}init(){this.show(),this.renderer.setAnimationLoop(t=>this.__renderLoop(t))}destroy(){this.renderer.setAnimationLoop(null),this.cleanScene(this.scene),this.viewer.container.removeChild(this.container),this.viewer.removeEventListener(xy.type,this),this.viewer.removeEventListener(nh.type,this),this.viewer.removeEventListener(gy.type,this),this.viewer.removeEventListener(vy.type,this),this.viewer.removeEventListener(ha.type,this),super.destroy()}handleEvent(t){switch(t.type){case xy.type:this.__onSizeUpdated();break;case nh.type:this.__onZoomUpdated();break;case gy.type:this.__onPositionUpdated();break;case vy.type:this.__onPositionUpdated();break;case ha.type:t.containsOptions("fisheye")&&this.__onPositionUpdated();break}}hide(){this.container.style.opacity="0"}show(){this.container.style.opacity="1"}setCustomRenderer(t){t?this.customRenderer=t(this.renderer):this.customRenderer=null,this.viewer.needsUpdate()}__onSizeUpdated(){this.renderer.setSize(this.state.size.width,this.state.size.height),this.camera.aspect=this.state.aspect,this.camera.updateProjectionMatrix(),this.viewer.needsUpdate(),this.frustumNeedsUpdate=!0}__onZoomUpdated(){this.camera.fov=this.state.vFov,this.camera.updateProjectionMatrix(),this.viewer.needsUpdate(),this.frustumNeedsUpdate=!0}__onPositionUpdated(){this.camera.position.set(0,0,0),this.camera.lookAt(this.state.direction),this.config.fisheye&&this.camera.position.copy(this.state.direction).multiplyScalar(this.config.fisheye/2).negate(),this.camera.rotateZ(-this.state.roll),this.camera.updateMatrix(),this.camera.updateMatrixWorld(),this.viewer.needsUpdate(),this.frustumNeedsUpdate=!0}__renderLoop(t){const e=this.timestamp?t-this.timestamp:0;this.timestamp=t,this.viewer.dispatchEvent(new M4(t,e)),this.viewer.dynamics.update(e),(this.state.needsUpdate||this.state.continuousUpdateCount>0)&&(this.state.needsUpdate=!1,(this.customRenderer||this.renderer).render(this.scene,this.camera),this.viewer.dispatchEvent(new J4))}setTexture(t){this.state.textureData&&this.viewer.adapter.disposeTexture(this.state.textureData),this.state.textureData=t,this.viewer.adapter.setTexture(this.mesh,t),this.viewer.needsUpdate()}setPanoramaPose(t,e=this.mesh){const n=this.viewer.dataHelper.cleanPanoramaPose(t),i=(n.pan?1:0)+(n.tilt?1:0)+(n.roll?1:0);!xg.useNewAnglesOrder&&i>1&&(Vr("'panoData' Euler angles will change in version 5.11.0."),Vr("Set 'Viewer.useNewAnglesOrder = true;' to remove this warning (you might have to adapt your poseHeading/posePitch/poseRoll parameters).")),xg.useNewAnglesOrder?e.rotation.set(n.tilt,n.pan,n.roll,"YXZ"):e.rotation.set(-n.tilt,-n.pan,-n.roll,"ZXY")}setSphereCorrection(t,e=this.meshContainer){const n=this.viewer.dataHelper.cleanSphereCorrection(t),i=(n.pan?1:0)+(n.tilt?1:0)+(n.roll?1:0);!xg.useNewAnglesOrder&&i>1&&(Vr("'sphereCorrection' Euler angles will change in version 5.11.0."),Vr("Set 'Viewer.useNewAnglesOrder = true;' to remove this warning (you might have to adapt your pan/tilt/roll parameters).")),xg.useNewAnglesOrder?e.rotation.set(n.tilt,n.pan,n.roll,"YXZ"):e.rotation.set(n.tilt,n.pan,n.roll,"ZXY")}transition(t,e){const n=!Hs(e.position),i=!Hs(e.zoom),r=new LC(n?this.viewer.dataHelper.cleanPosition(e.position):void 0,e.zoom);this.viewer.dispatchEvent(r);const a=new mg,u=this.viewer.adapter.createMesh();if(this.viewer.adapter.setTexture(u,t,!0),this.viewer.adapter.setTextureOpacity(u,0),this.setPanoramaPose(t.panoData,u),this.setSphereCorrection(e.sphereCorrection,a),n&&e.transition==="fade-only"){const y=this.viewer.getPosition(),S=new pt(0,1,0);a.rotateOnWorldAxis(S,r.position.yaw-y.yaw);const b=new pt(0,1,0).cross(this.camera.getWorldDirection(new pt)).normalize();a.rotateOnWorldAxis(b,r.position.pitch-y.pitch)}a.add(u),this.scene.add(a),this.renderer.setRenderTarget(new sd),this.renderer.render(this.scene,this.camera),this.renderer.setRenderTarget(null);const{duration:l,properties:f}=this.viewer.dataHelper.getAnimationProperties(e.speed,e.transition===!0?r.position:null,r.zoomLevel),g=new dy({properties:{...f,opacity:{start:0,end:1}},duration:l,easing:"inOutCubic",onTick:y=>{this.viewer.adapter.setTextureOpacity(u,y.opacity),n&&e.transition===!0&&this.viewer.dynamics.position.setValue({yaw:y.yaw,pitch:y.pitch}),i&&this.viewer.dynamics.zoom.setValue(y.zoom),this.viewer.needsUpdate()}});return g.then(y=>{y?(this.setTexture(t),this.viewer.adapter.setTextureOpacity(this.mesh,1),this.setPanoramaPose(t.panoData),this.setSphereCorrection(e.sphereCorrection),n&&e.transition==="fade-only"&&this.viewer.rotate(e.position)):this.viewer.adapter.disposeTexture(t),this.scene.remove(a),u.geometry.dispose(),u.geometry=null}),g}getIntersections(t){var n;lb.x=2*t.x/this.state.size.width-1,lb.y=-2*t.y/this.state.size.height+1,this.raycaster.setFromCamera(lb,this.camera);const e=this.raycaster.intersectObjects(this.scene.children,!0).filter(i=>i.object.visible).filter(i=>i.object.isMesh&&!!i.object.userData);return(n=this.customRenderer)!=null&&n.getIntersections&&e.push(...this.customRenderer.getIntersections(this.raycaster,lb)),e}isObjectVisible(t){if(!t)return!1;if(this.frustumNeedsUpdate&&(CD.multiplyMatrices(this.camera.projectionMatrix,this.camera.matrixWorldInverse),this.frustum.setFromProjectionMatrix(CD),this.frustumNeedsUpdate=!1),t.isVector3)return this.frustum.containsPoint(t);if(t.isMesh&&t.geometry){const e=t;return e.geometry.boundingBox||e.geometry.computeBoundingBox(),TD.copy(e.geometry.boundingBox).applyMatrix4(e.matrixWorld),this.frustum.intersectsBox(TD)}else return t.isObject3D?this.frustum.intersectsObject(t):!1}addObject(t){this.scene.add(t)}removeObject(t){this.scene.remove(t)}cleanScene(t){const e=n=>{var i;(i=n.map)==null||i.dispose(),n.uniforms&&Object.values(n.uniforms).forEach(r=>{var a,u;(u=(a=r.value)==null?void 0:a.dispose)==null||u.call(a)}),n.dispose()};t.traverse(n=>{var i,r;(i=n.geometry)==null||i.dispose(),n.material&&(Array.isArray(n.material)?n.material.forEach(a=>{e(a)}):e(n.material)),n instanceof Bk||(r=n.dispose)==null||r.call(n),n!==t&&this.cleanScene(n)})}},cj=class extends pC{load(t,e,n,i,r){const a=new Request(t,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"});fetch(a,{signal:r}).then(u=>{if(u.status===200||u.status===0){const l=u.body.getReader(),f=u.headers.get("Content-Length")||u.headers.get("X-File-Size"),g=f?parseInt(f):0,y=g!==0;let S=0;const b=new ReadableStream({start(A){I();function I(){l.read().then(({done:D,value:L})=>{if(D)A.close();else{S+=L.byteLength;const P=new ProgressEvent("progress",{lengthComputable:y,loaded:S,total:g});n(P),A.enqueue(L),I()}}).catch(D=>{i(D)})}}});return new Response(b)}else throw new Error(`fetch for "${u.url}" responded with ${u.status}: ${u.statusText}`)}).then(u=>u.blob()).then(u=>{e(u)}).catch(u=>{i(u)})}},uj=class extends pC{load(t,e,n,i){const r=document.createElement("img");function a(){f(),e(this)}function u(g){if(f(),i!=null&&i.aborted){const y=new Error;y.name="AbortError",y.message="The operation was aborted.",n(y)}else n(g)}function l(){r.src=""}function f(){r.removeEventListener("load",a,!1),r.removeEventListener("error",u,!1),i==null||i.removeEventListener("abort",l,!1)}return r.addEventListener("load",a,!1),r.addEventListener("error",u,!1),i==null||i.addEventListener("abort",l,!1),!t.startsWith("data:")&&this.crossOrigin!==void 0&&(r.crossOrigin=this.crossOrigin),r.src=t,r}},hj=class extends Ey{constructor(t){super(t),this.abortCtrl={},this.fileLoader=new cj,this.imageLoader=new uj,this.config.withCredentials&&(this.fileLoader.setWithCredentials(!0),this.imageLoader.setCrossOrigin("use-credentials"))}destroy(){this.abortLoading(),super.destroy()}abortLoading(){Object.values(this.abortCtrl).forEach(t=>t.abort()),this.abortCtrl={}}loadFile(t,e,n){const i=_g.get(t,n);if(i){if(i instanceof Blob)return e==null||e(100),Promise.resolve(i);_g.remove(t,n)}return this.config.requestHeaders&&this.fileLoader.setRequestHeader(this.config.requestHeaders(t)),new Promise((r,a)=>{let u=0;e==null||e(u),this.fileLoader.load(t,l=>{u=100,e==null||e(u),_g.add(t,n,l),r(l)},l=>{if(l.lengthComputable){const f=l.loaded/l.total*100;f>u&&(u=f,e==null||e(u))}},l=>{a(l)},this.__getAbortSignal(n))})}loadImage(t,e,n){const i=_g.get(t,n);return i?(e==null||e(100),i instanceof Blob?this.blobToImage(i):Promise.resolve(i)):!e&&!this.config.requestHeaders?new Promise((r,a)=>{this.imageLoader.load(t,u=>{_g.add(t,n,u),r(u)},u=>{a(u)},this.__getAbortSignal(n))}):this.loadFile(t,e,n).then(r=>this.blobToImage(r))}blobToImage(t){return new Promise((e,n)=>{const i=document.createElement("img");i.onload=()=>{URL.revokeObjectURL(i.src),e(i)},i.onerror=n,i.src=URL.createObjectURL(t)})}preloadPanorama(t){return this.viewer.adapter.supportsPreload(t)?this.viewer.adapter.loadTexture(t,!1):Promise.reject(new qn("Current adapter does not support preload"))}__getAbortSignal(t){var e;return t?((e=this.abortCtrl[t])!=null&&e.signal.aborted&&delete this.abortCtrl[t],this.abortCtrl[t]||(this.abortCtrl[t]=new AbortController),this.abortCtrl[t].signal):null}},dj=class extends Ey{constructor(t){super(t),this.zoom=new fy(e=>{this.viewer.state.vFov=this.viewer.dataHelper.zoomLevelToFov(e),this.viewer.state.hFov=this.viewer.dataHelper.vFovToHFov(this.viewer.state.vFov),this.viewer.dispatchEvent(new nh(e))},{defaultValue:this.viewer.config.defaultZoomLvl,min:0,max:100,wrap:!1}),this.position=new _4(e=>{this.viewer.dataHelper.sphericalCoordsToVector3(e,this.viewer.state.direction),this.viewer.dispatchEvent(new gy(e))},{yaw:new fy(null,{defaultValue:this.config.defaultYaw,min:0,max:2*Math.PI,wrap:!0}),pitch:new fy(null,{defaultValue:this.config.defaultPitch,min:-Math.PI/2,max:Math.PI/2,wrap:!1})}),this.roll=new fy(e=>{this.viewer.state.roll=e,this.viewer.dispatchEvent(new vy(e))},{defaultValue:0,min:-Math.PI,max:Math.PI,wrap:!1}),this.updateSpeeds()}updateSpeeds(){this.zoom.setSpeed(this.config.zoomSpeed*50),this.position.setSpeed(Yr.degToRad(this.config.moveSpeed*50)),this.roll.setSpeed(Yr.degToRad(this.config.moveSpeed*50))}update(t){this.zoom.update(t),this.position.update(t),this.roll.update(t)}},fj=class{constructor(){this.ready=!1,this.needsUpdate=!1,this.continuousUpdateCount=0,this.keyboardEnabled=!1,this.direction=new pt(0,0,gg),this.roll=0,this.vFov=60,this.hFov=60,this.aspect=1,this.animation=null,this.transitionAnimation=null,this.loadingPromise=null,this.idleTime=-1,this.objectsObservers={},this.size={width:0,height:0}}},xg=class extends w4{constructor(t){var e,n,i;if(super(),this.plugins={},this.children=[],this.onResize=wC(()=>this.navbar.autoSize(),500),this.parent=e4(t.container),!this.parent)throw new qn('"container" element not found.');this.parent[md]=this,this.container=document.createElement("div"),this.container.classList.add("psv-container"),this.parent.appendChild(this.container),y4(this.parent),v4(this.container,"core"),this.state=new fj,this.config=XW(t),this.__setSize(this.config.size),this.overlay=new QW(this);try{Ts.load()}catch(r){console.error(r),this.showError(this.config.lang.webglError);return}_g.init(),this.adapter=new this.config.adapter[0](this,this.config.adapter[1]),this.renderer=new lj(this),this.textureLoader=new hj(this),this.eventsHandler=new aj(this),this.dataHelper=new rj(this),this.dynamics=new dj(this),(n=(e=this.adapter).init)==null||n.call(e),this.loader=new KW(this),this.navbar=new YW(this),this.panel=new tj(this),this.notification=new JW(this),this.autoSize(),this.setCursor(null),EC(Ts.isTouchEnabled,r=>{q1(this.container,"psv--is-touch",r)}),this.config.plugins.forEach(([r,a])=>{this.plugins[r.id]=new r(this,a)});for(const r of Object.values(this.plugins))(i=r.init)==null||i.call(r);this.config.navbar&&this.navbar.setButtons(this.config.navbar),this.state.loadingPromise||(this.config.panorama?this.setPanorama(this.config.panorama):this.loader.show())}destroy(){var t,e,n,i,r,a;this.stopAll(),this.stopKeyboardControl(),this.exitFullscreen();for(const[u,l]of Object.entries(this.plugins))l.destroy(),delete this.plugins[u];this.children.slice().forEach(u=>u.destroy()),this.children.length=0,(t=this.eventsHandler)==null||t.destroy(),(e=this.renderer)==null||e.destroy(),(n=this.textureLoader)==null||n.destroy(),(i=this.dataHelper)==null||i.destroy(),(r=this.adapter)==null||r.destroy(),(a=this.dynamics)==null||a.destroy(),this.parent.removeChild(this.container),delete this.parent[md]}init(){this.eventsHandler.init(),this.renderer.init(),this.config.navbar&&this.navbar.show(),this.config.keyboard==="always"&&this.startKeyboardControl(),this.resetIdleTimer(),this.state.ready=!0,this.dispatchEvent(new yy)}resetIdleTimer(){this.state.idleTime=performance.now()}disableIdleTimer(){this.state.idleTime=-1}getPlugin(t){if(typeof t=="string")return this.plugins[t];{const e=zC(t);return e?this.plugins[e.id]:null}}getPosition(){return this.dataHelper.cleanPosition(this.dynamics.position.current)}getZoomLevel(){return this.dynamics.zoom.current}getSize(){return{...this.state.size}}isFullscreenEnabled(){return r4(this.parent,Ts.isIphone)}needsUpdate(){this.state.needsUpdate=!0}needsContinuousUpdate(t){t?this.state.continuousUpdateCount++:this.state.continuousUpdateCount>0&&this.state.continuousUpdateCount--}autoSize(){(this.container.clientWidth!==this.state.size.width||this.container.clientHeight!==this.state.size.height)&&(this.state.size.width=Math.round(this.container.clientWidth),this.state.size.height=Math.round(this.container.clientHeight),this.state.aspect=this.state.size.width/this.state.size.height,this.state.hFov=this.dataHelper.vFovToHFov(this.state.vFov),this.dispatchEvent(new xy(this.getSize())),this.onResize())}setPanorama(t,e={}){var r;this.textureLoader.abortLoading(),(r=this.state.transitionAnimation)==null||r.cancel(),this.state.ready||["sphereCorrection","panoData"].forEach(a=>{a in e||(e[a]=this.config[a])}),e.transition===void 0&&(e.transition=!0),e.speed===void 0&&(e.speed=Gk),e.showLoader===void 0&&(e.showLoader=!0),e.caption===void 0&&(e.caption=this.config.caption),e.description===void 0&&(e.description=this.config.description),!e.panoData&&typeof this.config.panoData=="function"&&(e.panoData=this.config.panoData),this.hideError(),this.resetIdleTimer(),this.config.panorama=t,this.config.caption=e.caption,this.config.description=e.description;const n=a=>{if(h4(a))return!1;if(this.loader.hide(),this.state.loadingPromise=null,a)throw this.navbar.setCaption(""),this.showError(this.config.lang.loadError),console.error(a),this.dispatchEvent(new q4(t,a)),a;return this.navbar.setCaption(this.config.caption),!0};this.navbar.setCaption(`<em>${this.config.lang.loading}</em>`),(e.showLoader||!this.state.ready)&&this.loader.show(),this.dispatchEvent(new G4(t));const i=this.adapter.loadTexture(this.config.panorama,!0,e.panoData).then(a=>{if(a.panorama!==this.config.panorama)throw this.adapter.disposeTexture(a),MC();const u=this.dataHelper.cleanPanoramaOptions(e,a.panoData);return(!Hs(u.zoom)||!Hs(u.position))&&this.stopAll(),{textureData:a,cleanOptions:u}});return!e.transition||!this.state.ready||!this.adapter.supportsTransition(this.config.panorama)?this.state.loadingPromise=i.then(({textureData:a,cleanOptions:u})=>{this.renderer.show(),this.renderer.setTexture(a),this.renderer.setPanoramaPose(a.panoData),this.renderer.setSphereCorrection(e.sphereCorrection),this.state.ready||this.init(),this.dispatchEvent(new kC(a)),Hs(u.zoom)||this.zoom(u.zoom),Hs(u.position)||this.rotate(u.position)}).then(()=>n(),a=>n(a)):this.state.loadingPromise=i.then(({textureData:a,cleanOptions:u})=>(this.loader.hide(),this.dispatchEvent(new kC(a)),this.state.transitionAnimation=this.renderer.transition(a,u),this.state.transitionAnimation)).then(a=>{if(this.state.transitionAnimation=null,!a)throw MC()}).then(()=>n(),a=>n(a)),this.state.loadingPromise}setOptions(t){const e={...this.config,...t};for(let[n,i]of Object.entries(t)){if(!(n in Qc)){Vr(`Unknown option ${n}`);continue}if(n in MD){Vr(MD[n]);continue}switch(n in NC&&(i=NC[n](i,{rawConfig:e,defValue:Qc[n]})),this.config[n]=i,n){case"mousemove":this.state.cursorOverride||this.setCursor(null);break;case"caption":this.navbar.setCaption(this.config.caption);break;case"size":this.resize(this.config.size);break;case"sphereCorrection":this.renderer.setSphereCorrection(this.config.sphereCorrection);break;case"navbar":case"lang":this.navbar.setButtons(this.config.navbar);break;case"moveSpeed":case"zoomSpeed":this.dynamics.updateSpeeds();break;case"minFov":case"maxFov":this.dynamics.zoom.setValue(this.dataHelper.fovToZoomLevel(this.state.vFov)),this.dispatchEvent(new nh(this.getZoomLevel()));break;case"keyboard":this.config.keyboard==="always"?this.startKeyboardControl():this.stopKeyboardControl();break}}this.needsUpdate(),this.dispatchEvent(new ha(Object.keys(t)))}setOption(t,e){this.setOptions({[t]:e})}showError(t){this.overlay.show({id:ro.ERROR,image:ij,title:t,dissmisable:!1})}hideError(){this.overlay.hide(ro.ERROR)}rotate(t){const e=new T4(this.dataHelper.cleanPosition(t));this.dispatchEvent(e),!e.defaultPrevented&&this.dynamics.position.setValue(e.position)}zoom(t){this.dynamics.zoom.setValue(t)}zoomIn(t=1){this.dynamics.zoom.step(t)}zoomOut(t=1){this.dynamics.zoom.step(-t)}animate(t){const e=CC(t),n=!Hs(t.zoom),i=new LC(e?this.dataHelper.cleanPosition(t):void 0,t.zoom);if(this.dispatchEvent(i),i.defaultPrevented)return;this.stopAll();const{duration:r,properties:a}=this.dataHelper.getAnimationProperties(t.speed,i.position,i.zoomLevel);return r?(this.state.animation=new dy({properties:a,duration:r,easing:t.easing||"inOutSine",onTick:u=>{e&&this.dynamics.position.setValue({yaw:u.yaw,pitch:u.pitch}),n&&this.dynamics.zoom.setValue(u.zoom)}}),this.state.animation.then(()=>{this.state.animation=null,this.resetIdleTimer()}),this.state.animation):(e&&this.rotate(i.position),n&&this.zoom(i.zoomLevel),new dy(null))}stopAnimation(){return this.state.animation?(this.state.animation.cancel(),this.state.animation):Promise.resolve()}resize(t){this.__setSize(t),this.autoSize()}__setSize(t){const e=t;["width","height"].forEach(n=>{t&&e[n]&&(/^[0-9.]+$/.test(e[n])&&(e[n]+="px"),this.parent.style[n]=e[n])})}enterFullscreen(){this.isFullscreenEnabled()||s4(this.parent,Ts.isIphone)}exitFullscreen(){this.isFullscreenEnabled()&&o4(Ts.isIphone)}toggleFullscreen(){this.isFullscreenEnabled()?this.exitFullscreen():this.enterFullscreen()}startKeyboardControl(){this.state.keyboardEnabled=!0}stopKeyboardControl(){this.state.keyboardEnabled=!1}createTooltip(t){return new nj(this,t)}setCursor(t){this.state.cursorOverride=t,t?this.container.style.cursor=t:this.container.style.cursor=this.config.mousemove?"move":"default"}observeObjects(t){this.state.objectsObservers[t]||(this.state.objectsObservers[t]=null)}unobserveObjects(t){delete this.state.objectsObservers[t]}stopAll(){return this.dispatchEvent(new aD),this.disableIdleTimer(),this.stopAnimation()}};xg.useNewAnglesOrder=!1;var Dn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function cb(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function pj(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function i(){return this instanceof i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(i){var r=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(n,i,r.get?r:{enumerable:!0,get:function(){return t[i]}})}),n}var AD={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v4.5.2/LICENSE.txt
 */(function(t,e){(function(n,i){t.exports=i()})(Dn,function(){var n={},i={};function r(u,l,f){if(i[u]=f,u==="index"){var g="var sharedModule = {}; ("+i.shared+")(sharedModule); ("+i.worker+")(sharedModule);",y={};return i.shared(y),i.index(n,y),typeof window<"u"&&n.setWorkerUrl(window.URL.createObjectURL(new Blob([g],{type:"text/javascript"}))),n}}r("shared",["exports"],function(u){function l(c,s,h,p){return new(h||(h=Promise))(function(x,C){function T(U){try{F(p.next(U))}catch(G){C(G)}}function R(U){try{F(p.throw(U))}catch(G){C(G)}}function F(U){var G;U.done?x(U.value):(G=U.value,G instanceof h?G:new h(function(Y){Y(G)})).then(T,R)}F((p=p.apply(c,s||[])).next())})}function f(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}typeof SuppressedError=="function"&&SuppressedError;var g=y;function y(c,s){this.x=c,this.y=s}y.prototype={clone:function(){return new y(this.x,this.y)},add:function(c){return this.clone()._add(c)},sub:function(c){return this.clone()._sub(c)},multByPoint:function(c){return this.clone()._multByPoint(c)},divByPoint:function(c){return this.clone()._divByPoint(c)},mult:function(c){return this.clone()._mult(c)},div:function(c){return this.clone()._div(c)},rotate:function(c){return this.clone()._rotate(c)},rotateAround:function(c,s){return this.clone()._rotateAround(c,s)},matMult:function(c){return this.clone()._matMult(c)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(c){return this.x===c.x&&this.y===c.y},dist:function(c){return Math.sqrt(this.distSqr(c))},distSqr:function(c){var s=c.x-this.x,h=c.y-this.y;return s*s+h*h},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(c){return Math.atan2(this.y-c.y,this.x-c.x)},angleWith:function(c){return this.angleWithSep(c.x,c.y)},angleWithSep:function(c,s){return Math.atan2(this.x*s-this.y*c,this.x*c+this.y*s)},_matMult:function(c){var s=c[2]*this.x+c[3]*this.y;return this.x=c[0]*this.x+c[1]*this.y,this.y=s,this},_add:function(c){return this.x+=c.x,this.y+=c.y,this},_sub:function(c){return this.x-=c.x,this.y-=c.y,this},_mult:function(c){return this.x*=c,this.y*=c,this},_div:function(c){return this.x/=c,this.y/=c,this},_multByPoint:function(c){return this.x*=c.x,this.y*=c.y,this},_divByPoint:function(c){return this.x/=c.x,this.y/=c.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var c=this.y;return this.y=this.x,this.x=-c,this},_rotate:function(c){var s=Math.cos(c),h=Math.sin(c),p=h*this.x+s*this.y;return this.x=s*this.x-h*this.y,this.y=p,this},_rotateAround:function(c,s){var h=Math.cos(c),p=Math.sin(c),x=s.y+p*(this.x-s.x)+h*(this.y-s.y);return this.x=s.x+h*(this.x-s.x)-p*(this.y-s.y),this.y=x,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},y.convert=function(c){return c instanceof y?c:Array.isArray(c)?new y(c[0],c[1]):c};var S=f(g),b=A;function A(c,s,h,p){this.cx=3*c,this.bx=3*(h-c)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*s,this.by=3*(p-s)-this.cy,this.ay=1-this.cy-this.by,this.p1x=c,this.p1y=s,this.p2x=h,this.p2y=p}A.prototype={sampleCurveX:function(c){return((this.ax*c+this.bx)*c+this.cx)*c},sampleCurveY:function(c){return((this.ay*c+this.by)*c+this.cy)*c},sampleCurveDerivativeX:function(c){return(3*this.ax*c+2*this.bx)*c+this.cx},solveCurveX:function(c,s){if(s===void 0&&(s=1e-6),c<0)return 0;if(c>1)return 1;for(var h=c,p=0;p<8;p++){var x=this.sampleCurveX(h)-c;if(Math.abs(x)<s)return h;var C=this.sampleCurveDerivativeX(h);if(Math.abs(C)<1e-6)break;h-=x/C}var T=0,R=1;for(h=c,p=0;p<20&&(x=this.sampleCurveX(h),!(Math.abs(x-c)<s));p++)c>x?T=h:R=h,h=.5*(R-T)+T;return h},solve:function(c,s){return this.sampleCurveY(this.solveCurveX(c,s))}};var I=f(b);let D,L;function P(){return D==null&&(D=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),D}function N(){if(L==null&&(L=!1,P())){const s=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(s){for(let p=0;p<5*5;p++){const x=4*p;s.fillStyle=`rgb(${x},${x+1},${x+2})`,s.fillRect(p%5,Math.floor(p/5),1,1)}const h=s.getImageData(0,0,5,5).data;for(let p=0;p<5*5*4;p++)if(p%4!=3&&h[p]!==p){L=!0;break}}}return L||!1}function B(c,s,h,p){const x=new I(c,s,h,p);return C=>x.solve(C)}const $=B(.25,.1,.25,1);function K(c,s,h){return Math.min(h,Math.max(s,c))}function q(c,s,h){const p=h-s,x=((c-s)%p+p)%p+s;return x===s?h:x}function W(c,...s){for(const h of s)for(const p in h)c[p]=h[p];return c}let ie=1;function Z(c,s,h){const p={};for(const x in c)p[x]=s.call(this,c[x],x,c);return p}function X(c,s,h){const p={};for(const x in c)s.call(this,c[x],x,c)&&(p[x]=c[x]);return p}function se(c){return Array.isArray(c)?c.map(se):typeof c=="object"&&c?Z(c,se):c}const De={};function Se(c){De[c]||(typeof console<"u"&&console.warn(c),De[c]=!0)}function Me(c,s,h){return(h.y-c.y)*(s.x-c.x)>(s.y-c.y)*(h.x-c.x)}function Ye(c){return typeof WorkerGlobalScope<"u"&&c!==void 0&&c instanceof WorkerGlobalScope}let ye=null;function Ce(c){return typeof ImageBitmap<"u"&&c instanceof ImageBitmap}const ge="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Be(c,s,h,p,x){return l(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const C=new VideoFrame(c,{timestamp:0});try{const T=C==null?void 0:C.format;if(!T||!T.startsWith("BGR")&&!T.startsWith("RGB"))throw new Error(`Unrecognized format ${T}`);const R=T.startsWith("BGR"),F=new Uint8ClampedArray(p*x*4);if(yield C.copyTo(F,function(U,G,Y,ee,ae){const ue=4*Math.max(-G,0),pe=(Math.max(0,Y)-Y)*ee*4+ue,Ae=4*ee,Oe=Math.max(0,G),tt=Math.max(0,Y);return{rect:{x:Oe,y:tt,width:Math.min(U.width,G+ee)-Oe,height:Math.min(U.height,Y+ae)-tt},layout:[{offset:pe,stride:Ae}]}}(c,s,h,p,x)),R)for(let U=0;U<F.length;U+=4){const G=F[U];F[U]=F[U+2],F[U+2]=G}return F}finally{C.close()}})}let Ze,je;const wt="AbortError";function Xt(){return new Error(wt)}const Ke={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function _t(c){return Ke.REGISTERED_PROTOCOLS[c.substring(0,c.indexOf("://"))]}const zt="global-dispatcher";class Rt extends Error{constructor(s,h,p,x){super(`AJAXError: ${h} (${s}): ${p}`),this.status=s,this.statusText=h,this.url=p,this.body=x}}const fn=()=>Ye(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Mn=function(c,s){if(/:\/\//.test(c.url)&&!/^https?:|^file:/.test(c.url)){const p=_t(c.url);if(p)return p(c,s);if(Ye(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:c,targetMapId:zt},s)}if(!(/^file:/.test(h=c.url)||/^file:/.test(fn())&&!/^\w+:/.test(h))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(p,x){return l(this,void 0,void 0,function*(){const C=new Request(p.url,{method:p.method||"GET",body:p.body,credentials:p.credentials,headers:p.headers,cache:p.cache,referrer:fn(),signal:x.signal});p.type!=="json"||C.headers.has("Accept")||C.headers.set("Accept","application/json");const T=yield fetch(C);if(!T.ok){const U=yield T.blob();throw new Rt(T.status,T.statusText,p.url,U)}let R;R=p.type==="arrayBuffer"||p.type==="image"?T.arrayBuffer():p.type==="json"?T.json():T.text();const F=yield R;if(x.signal.aborted)throw Xt();return{data:F,cacheControl:T.headers.get("Cache-Control"),expires:T.headers.get("Expires")}})}(c,s);if(Ye(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:c,mustQueue:!0,targetMapId:zt},s)}var h;return function(p,x){return new Promise((C,T)=>{var R;const F=new XMLHttpRequest;F.open(p.method||"GET",p.url,!0),p.type!=="arrayBuffer"&&p.type!=="image"||(F.responseType="arraybuffer");for(const U in p.headers)F.setRequestHeader(U,p.headers[U]);p.type==="json"&&(F.responseType="text",!((R=p.headers)===null||R===void 0)&&R.Accept||F.setRequestHeader("Accept","application/json")),F.withCredentials=p.credentials==="include",F.onerror=()=>{T(new Error(F.statusText))},F.onload=()=>{if(!x.signal.aborted)if((F.status>=200&&F.status<300||F.status===0)&&F.response!==null){let U=F.response;if(p.type==="json")try{U=JSON.parse(F.response)}catch(G){return void T(G)}C({data:U,cacheControl:F.getResponseHeader("Cache-Control"),expires:F.getResponseHeader("Expires")})}else{const U=new Blob([F.response],{type:F.getResponseHeader("Content-Type")});T(new Rt(F.status,F.statusText,p.url,U))}},x.signal.addEventListener("abort",()=>{F.abort(),T(Xt())}),F.send(p.body)})}(c,s)};function Bt(c){if(!c||c.indexOf("://")<=0||c.indexOf("data:image/")===0||c.indexOf("blob:")===0)return!0;const s=new URL(c),h=window.location;return s.protocol===h.protocol&&s.host===h.host}function Kn(c,s,h){h[c]&&h[c].indexOf(s)!==-1||(h[c]=h[c]||[],h[c].push(s))}function Re(c,s,h){if(h&&h[c]){const p=h[c].indexOf(s);p!==-1&&h[c].splice(p,1)}}class Jn{constructor(s,h={}){W(this,h),this.type=s}}class Ln extends Jn{constructor(s,h={}){super("error",W({error:s},h))}}class Cn{on(s,h){return this._listeners=this._listeners||{},Kn(s,h,this._listeners),this}off(s,h){return Re(s,h,this._listeners),Re(s,h,this._oneTimeListeners),this}once(s,h){return h?(this._oneTimeListeners=this._oneTimeListeners||{},Kn(s,h,this._oneTimeListeners),this):new Promise(p=>this.once(s,p))}fire(s,h){typeof s=="string"&&(s=new Jn(s,h||{}));const p=s.type;if(this.listens(p)){s.target=this;const x=this._listeners&&this._listeners[p]?this._listeners[p].slice():[];for(const R of x)R.call(this,s);const C=this._oneTimeListeners&&this._oneTimeListeners[p]?this._oneTimeListeners[p].slice():[];for(const R of C)Re(p,R,this._oneTimeListeners),R.call(this,s);const T=this._eventedParent;T&&(W(s,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),T.fire(s))}else s instanceof Ln&&console.error(s.error);return this}listens(s){return this._listeners&&this._listeners[s]&&this._listeners[s].length>0||this._oneTimeListeners&&this._oneTimeListeners[s]&&this._oneTimeListeners[s].length>0||this._eventedParent&&this._eventedParent.listens(s)}setEventedParent(s,h){return this._eventedParent=s,this._eventedParentData=h,this}}var Ue={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"enum",default:"mercator",values:{mercator:{},globe:{}}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const xt=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Pt(c,s){const h={};for(const p in c)p!=="ref"&&(h[p]=c[p]);return xt.forEach(p=>{p in s&&(h[p]=s[p])}),h}function mt(c,s){if(Array.isArray(c)){if(!Array.isArray(s)||c.length!==s.length)return!1;for(let h=0;h<c.length;h++)if(!mt(c[h],s[h]))return!1;return!0}if(typeof c=="object"&&c!==null&&s!==null){if(typeof s!="object"||Object.keys(c).length!==Object.keys(s).length)return!1;for(const h in c)if(!mt(c[h],s[h]))return!1;return!0}return c===s}function ve(c,s){c.push(s)}function re(c,s,h){ve(h,{command:"addSource",args:[c,s[c]]})}function Xe(c,s,h){ve(s,{command:"removeSource",args:[c]}),h[c]=!0}function Ge(c,s,h,p){Xe(c,h,p),re(c,s,h)}function st(c,s,h){let p;for(p in c[h])if(Object.prototype.hasOwnProperty.call(c[h],p)&&p!=="data"&&!mt(c[h][p],s[h][p]))return!1;for(p in s[h])if(Object.prototype.hasOwnProperty.call(s[h],p)&&p!=="data"&&!mt(c[h][p],s[h][p]))return!1;return!0}function ft(c,s,h,p,x,C){c=c||{},s=s||{};for(const T in c)Object.prototype.hasOwnProperty.call(c,T)&&(mt(c[T],s[T])||h.push({command:C,args:[p,T,s[T],x]}));for(const T in s)Object.prototype.hasOwnProperty.call(s,T)&&!Object.prototype.hasOwnProperty.call(c,T)&&(mt(c[T],s[T])||h.push({command:C,args:[p,T,s[T],x]}))}function Ht(c){return c.id}function $t(c,s){return c[s.id]=s,c}class it{constructor(s,h,p,x){this.message=(s?`${s}: `:"")+p,x&&(this.identifier=x),h!=null&&h.__line__&&(this.line=h.__line__)}}function On(c,...s){for(const h of s)for(const p in h)c[p]=h[p];return c}class Nt extends Error{constructor(s,h){super(h),this.message=h,this.key=s}}class on{constructor(s,h=[]){this.parent=s,this.bindings={};for(const[p,x]of h)this.bindings[p]=x}concat(s){return new on(this,s)}get(s){if(this.bindings[s])return this.bindings[s];if(this.parent)return this.parent.get(s);throw new Error(`${s} not found in scope.`)}has(s){return!!this.bindings[s]||!!this.parent&&this.parent.has(s)}}const Wn={kind:"null"},yt={kind:"number"},Tt={kind:"string"},Vt={kind:"boolean"},kn={kind:"color"},ii={kind:"object"},Ne={kind:"value"},Gt={kind:"collator"},Et={kind:"formatted"},Ct={kind:"padding"},Zt={kind:"resolvedImage"},xe={kind:"variableAnchorOffsetCollection"};function te(c,s){return{kind:"array",itemType:c,N:s}}function ne(c){if(c.kind==="array"){const s=ne(c.itemType);return typeof c.N=="number"?`array<${s}, ${c.N}>`:c.itemType.kind==="value"?"array":`array<${s}>`}return c.kind}const de=[Wn,yt,Tt,Vt,kn,Et,ii,te(Ne),Ct,Zt,xe];function we(c,s){if(s.kind==="error")return null;if(c.kind==="array"){if(s.kind==="array"&&(s.N===0&&s.itemType.kind==="value"||!we(c.itemType,s.itemType))&&(typeof c.N!="number"||c.N===s.N))return null}else{if(c.kind===s.kind)return null;if(c.kind==="value"){for(const h of de)if(!we(h,s))return null}}return`Expected ${ne(c)} but found ${ne(s)} instead.`}function Fe(c,s){return s.some(h=>h.kind===c.kind)}function He(c,s){return s.some(h=>h==="null"?c===null:h==="array"?Array.isArray(c):h==="object"?c&&!Array.isArray(c)&&typeof c=="object":h===typeof c)}function nt(c,s){return c.kind==="array"&&s.kind==="array"?c.itemType.kind===s.itemType.kind&&typeof c.N=="number":c.kind===s.kind}const Ie=.96422,ut=.82521,bt=4/29,ct=6/29,Wt=3*ct*ct,bn=ct*ct*ct,Sn=Math.PI/180,Bn=180/Math.PI;function ui(c){return(c%=360)<0&&(c+=360),c}function Vn([c,s,h,p]){let x,C;const T=qi((.2225045*(c=Di(c))+.7168786*(s=Di(s))+.0606169*(h=Di(h)))/1);c===s&&s===h?x=C=T:(x=qi((.4360747*c+.3850649*s+.1430804*h)/Ie),C=qi((.0139322*c+.0971045*s+.7141733*h)/ut));const R=116*T-16;return[R<0?0:R,500*(x-T),200*(T-C),p]}function Di(c){return c<=.04045?c/12.92:Math.pow((c+.055)/1.055,2.4)}function qi(c){return c>bn?Math.pow(c,1/3):c/Wt+bt}function me([c,s,h,p]){let x=(c+16)/116,C=isNaN(s)?x:x+s/500,T=isNaN(h)?x:x-h/200;return x=1*ot(x),C=Ie*ot(C),T=ut*ot(T),[$e(3.1338561*C-1.6168667*x-.4906146*T),$e(-.9787684*C+1.9161415*x+.033454*T),$e(.0719453*C-.2289914*x+1.4052427*T),p]}function $e(c){return(c=c<=.00304?12.92*c:1.055*Math.pow(c,1/2.4)-.055)<0?0:c>1?1:c}function ot(c){return c>ct?c*c*c:Wt*(c-bt)}function lt(c){return parseInt(c.padEnd(2,c),16)/255}function Je(c,s){return jt(s?c/100:c,0,1)}function jt(c,s,h){return Math.min(Math.max(s,c),h)}function en(c){return!c.some(Number.isNaN)}const En={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class Yt{constructor(s,h,p,x=1,C=!0){this.r=s,this.g=h,this.b=p,this.a=x,C||(this.r*=x,this.g*=x,this.b*=x,x||this.overwriteGetter("rgb",[s,h,p,x]))}static parse(s){if(s instanceof Yt)return s;if(typeof s!="string")return;const h=function(p){if((p=p.toLowerCase().trim())==="transparent")return[0,0,0,0];const x=En[p];if(x){const[T,R,F]=x;return[T/255,R/255,F/255,1]}if(p.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(p)){const T=p.length<6?1:2;let R=1;return[lt(p.slice(R,R+=T)),lt(p.slice(R,R+=T)),lt(p.slice(R,R+=T)),lt(p.slice(R,R+T)||"ff")]}if(p.startsWith("rgb")){const T=p.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(T){const[R,F,U,G,Y,ee,ae,ue,pe,Ae,Oe,tt]=T,Le=[G||" ",ae||" ",Ae].join("");if(Le==="  "||Le==="  /"||Le===",,"||Le===",,,"){const Qe=[U,ee,pe].join(""),dt=Qe==="%%%"?100:Qe===""?255:0;if(dt){const Ut=[jt(+F/dt,0,1),jt(+Y/dt,0,1),jt(+ue/dt,0,1),Oe?Je(+Oe,tt):1];if(en(Ut))return Ut}}return}}const C=p.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(C){const[T,R,F,U,G,Y,ee,ae,ue]=C,pe=[F||" ",G||" ",ee].join("");if(pe==="  "||pe==="  /"||pe===",,"||pe===",,,"){const Ae=[+R,jt(+U,0,100),jt(+Y,0,100),ae?Je(+ae,ue):1];if(en(Ae))return function([Oe,tt,Le,Qe]){function dt(Ut){const cn=(Ut+Oe/30)%12,nn=tt*Math.min(Le,1-Le);return Le-nn*Math.max(-1,Math.min(cn-3,9-cn,1))}return Oe=ui(Oe),tt/=100,Le/=100,[dt(0),dt(8),dt(4),Qe]}(Ae)}}}(s);return h?new Yt(...h,!1):void 0}get rgb(){const{r:s,g:h,b:p,a:x}=this,C=x||1/0;return this.overwriteGetter("rgb",[s/C,h/C,p/C,x])}get hcl(){return this.overwriteGetter("hcl",function(s){const[h,p,x,C]=Vn(s),T=Math.sqrt(p*p+x*x);return[Math.round(1e4*T)?ui(Math.atan2(x,p)*Bn):NaN,T,h,C]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Vn(this.rgb))}overwriteGetter(s,h){return Object.defineProperty(this,s,{value:h}),h}toString(){const[s,h,p,x]=this.rgb;return`rgba(${[s,h,p].map(C=>Math.round(255*C)).join(",")},${x})`}}Yt.black=new Yt(0,0,0,1),Yt.white=new Yt(1,1,1,1),Yt.transparent=new Yt(0,0,0,0),Yt.red=new Yt(1,0,0,1);class jn{constructor(s,h,p){this.sensitivity=s?h?"variant":"case":h?"accent":"base",this.locale=p,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(s,h){return this.collator.compare(s,h)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Zn{constructor(s,h,p,x,C){this.text=s,this.image=h,this.scale=p,this.fontStack=x,this.textColor=C}}class In{constructor(s){this.sections=s}static fromString(s){return new In([new Zn(s,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(s=>s.text.length!==0||s.image&&s.image.name.length!==0)}static factory(s){return s instanceof In?s:In.fromString(s)}toString(){return this.sections.length===0?"":this.sections.map(s=>s.text).join("")}}class ri{constructor(s){this.values=s.slice()}static parse(s){if(s instanceof ri)return s;if(typeof s=="number")return new ri([s,s,s,s]);if(Array.isArray(s)&&!(s.length<1||s.length>4)){for(const h of s)if(typeof h!="number")return;switch(s.length){case 1:s=[s[0],s[0],s[0],s[0]];break;case 2:s=[s[0],s[1],s[0],s[1]];break;case 3:s=[s[0],s[1],s[2],s[1]]}return new ri(s)}}toString(){return JSON.stringify(this.values)}}const ur=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class mi{constructor(s){this.values=s.slice()}static parse(s){if(s instanceof mi)return s;if(Array.isArray(s)&&!(s.length<1)&&s.length%2==0){for(let h=0;h<s.length;h+=2){const p=s[h],x=s[h+1];if(typeof p!="string"||!ur.has(p)||!Array.isArray(x)||x.length!==2||typeof x[0]!="number"||typeof x[1]!="number")return}return new mi(s)}}toString(){return JSON.stringify(this.values)}}class Ni{constructor(s){this.name=s.name,this.available=s.available}toString(){return this.name}static fromString(s){return s?new Ni({name:s,available:!1}):null}}function wi(c,s,h,p){return typeof c=="number"&&c>=0&&c<=255&&typeof s=="number"&&s>=0&&s<=255&&typeof h=="number"&&h>=0&&h<=255?p===void 0||typeof p=="number"&&p>=0&&p<=1?null:`Invalid rgba value [${[c,s,h,p].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof p=="number"?[c,s,h,p]:[c,s,h]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Fn(c){if(c===null||typeof c=="string"||typeof c=="boolean"||typeof c=="number"||c instanceof Yt||c instanceof jn||c instanceof In||c instanceof ri||c instanceof mi||c instanceof Ni)return!0;if(Array.isArray(c)){for(const s of c)if(!Fn(s))return!1;return!0}if(typeof c=="object"){for(const s in c)if(!Fn(c[s]))return!1;return!0}return!1}function di(c){if(c===null)return Wn;if(typeof c=="string")return Tt;if(typeof c=="boolean")return Vt;if(typeof c=="number")return yt;if(c instanceof Yt)return kn;if(c instanceof jn)return Gt;if(c instanceof In)return Et;if(c instanceof ri)return Ct;if(c instanceof mi)return xe;if(c instanceof Ni)return Zt;if(Array.isArray(c)){const s=c.length;let h;for(const p of c){const x=di(p);if(h){if(h===x)continue;h=Ne;break}h=x}return te(h||Ne,s)}return ii}function li(c){const s=typeof c;return c===null?"":s==="string"||s==="number"||s==="boolean"?String(c):c instanceof Yt||c instanceof In||c instanceof ri||c instanceof mi||c instanceof Ni?c.toString():JSON.stringify(c)}class Or{constructor(s,h){this.type=s,this.value=h}static parse(s,h){if(s.length!==2)return h.error(`'literal' expression requires exactly one argument, but found ${s.length-1} instead.`);if(!Fn(s[1]))return h.error("invalid value");const p=s[1];let x=di(p);const C=h.expectedType;return x.kind!=="array"||x.N!==0||!C||C.kind!=="array"||typeof C.N=="number"&&C.N!==0||(x=C),new Or(x,p)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class $i{constructor(s){this.name="ExpressionEvaluationError",this.message=s}toJSON(){return this.message}}const Fr={string:Tt,number:yt,boolean:Vt,object:ii};class vs{constructor(s,h){this.type=s,this.args=h}static parse(s,h){if(s.length<2)return h.error("Expected at least one argument.");let p,x=1;const C=s[0];if(C==="array"){let R,F;if(s.length>2){const U=s[1];if(typeof U!="string"||!(U in Fr)||U==="object")return h.error('The item type argument of "array" must be one of string, number, boolean',1);R=Fr[U],x++}else R=Ne;if(s.length>3){if(s[2]!==null&&(typeof s[2]!="number"||s[2]<0||s[2]!==Math.floor(s[2])))return h.error('The length argument to "array" must be a positive integer literal',2);F=s[2],x++}p=te(R,F)}else{if(!Fr[C])throw new Error(`Types doesn't contain name = ${C}`);p=Fr[C]}const T=[];for(;x<s.length;x++){const R=h.parse(s[x],x,Ne);if(!R)return null;T.push(R)}return new vs(p,T)}evaluate(s){for(let h=0;h<this.args.length;h++){const p=this.args[h].evaluate(s);if(!we(this.type,di(p)))return p;if(h===this.args.length-1)throw new $i(`Expected value to be of type ${ne(this.type)}, but found ${ne(di(p))} instead.`)}throw new Error}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}}const Qi={"to-boolean":Vt,"to-color":kn,"to-number":yt,"to-string":Tt};class zr{constructor(s,h){this.type=s,this.args=h}static parse(s,h){if(s.length<2)return h.error("Expected at least one argument.");const p=s[0];if(!Qi[p])throw new Error(`Can't parse ${p} as it is not part of the known types`);if((p==="to-boolean"||p==="to-string")&&s.length!==2)return h.error("Expected one argument.");const x=Qi[p],C=[];for(let T=1;T<s.length;T++){const R=h.parse(s[T],T,Ne);if(!R)return null;C.push(R)}return new zr(x,C)}evaluate(s){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(s);case"color":{let h,p;for(const x of this.args){if(h=x.evaluate(s),p=null,h instanceof Yt)return h;if(typeof h=="string"){const C=s.parseColor(h);if(C)return C}else if(Array.isArray(h)&&(p=h.length<3||h.length>4?`Invalid rbga value ${JSON.stringify(h)}: expected an array containing either three or four numeric values.`:wi(h[0],h[1],h[2],h[3]),!p))return new Yt(h[0]/255,h[1]/255,h[2]/255,h[3])}throw new $i(p||`Could not parse color from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"padding":{let h;for(const p of this.args){h=p.evaluate(s);const x=ri.parse(h);if(x)return x}throw new $i(`Could not parse padding from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"variableAnchorOffsetCollection":{let h;for(const p of this.args){h=p.evaluate(s);const x=mi.parse(h);if(x)return x}throw new $i(`Could not parse variableAnchorOffsetCollection from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"number":{let h=null;for(const p of this.args){if(h=p.evaluate(s),h===null)return 0;const x=Number(h);if(!isNaN(x))return x}throw new $i(`Could not convert ${JSON.stringify(h)} to number.`)}case"formatted":return In.fromString(li(this.args[0].evaluate(s)));case"resolvedImage":return Ni.fromString(li(this.args[0].evaluate(s)));default:return li(this.args[0].evaluate(s))}}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}}const Ol=["Unknown","Point","LineString","Polygon"];class Qr{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Ol[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(s){let h=this._parseColorCache[s];return h||(h=this._parseColorCache[s]=Yt.parse(s)),h}}class uo{constructor(s,h,p=[],x,C=new on,T=[]){this.registry=s,this.path=p,this.key=p.map(R=>`[${R}]`).join(""),this.scope=C,this.errors=T,this.expectedType=x,this._isConstant=h}parse(s,h,p,x,C={}){return h?this.concat(h,p,x)._parse(s,C):this._parse(s,C)}_parse(s,h){function p(x,C,T){return T==="assert"?new vs(C,[x]):T==="coerce"?new zr(C,[x]):x}if(s!==null&&typeof s!="string"&&typeof s!="boolean"&&typeof s!="number"||(s=["literal",s]),Array.isArray(s)){if(s.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const x=s[0];if(typeof x!="string")return this.error(`Expression name must be a string, but found ${typeof x} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const C=this.registry[x];if(C){let T=C.parse(s,this);if(!T)return null;if(this.expectedType){const R=this.expectedType,F=T.type;if(R.kind!=="string"&&R.kind!=="number"&&R.kind!=="boolean"&&R.kind!=="object"&&R.kind!=="array"||F.kind!=="value")if(R.kind!=="color"&&R.kind!=="formatted"&&R.kind!=="resolvedImage"||F.kind!=="value"&&F.kind!=="string")if(R.kind!=="padding"||F.kind!=="value"&&F.kind!=="number"&&F.kind!=="array")if(R.kind!=="variableAnchorOffsetCollection"||F.kind!=="value"&&F.kind!=="array"){if(this.checkSubtype(R,F))return null}else T=p(T,R,h.typeAnnotation||"coerce");else T=p(T,R,h.typeAnnotation||"coerce");else T=p(T,R,h.typeAnnotation||"coerce");else T=p(T,R,h.typeAnnotation||"assert")}if(!(T instanceof Or)&&T.type.kind!=="resolvedImage"&&this._isConstant(T)){const R=new Qr;try{T=new Or(T.type,T.evaluate(R))}catch(F){return this.error(F.message),null}}return T}return this.error(`Unknown expression "${x}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(s===void 0?"'undefined' value invalid. Use null instead.":typeof s=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof s} instead.`)}concat(s,h,p){const x=typeof s=="number"?this.path.concat(s):this.path,C=p?this.scope.concat(p):this.scope;return new uo(this.registry,this._isConstant,x,h||null,C,this.errors)}error(s,...h){const p=`${this.key}${h.map(x=>`[${x}]`).join("")}`;this.errors.push(new Nt(p,s))}checkSubtype(s,h){const p=we(s,h);return p&&this.error(p),p}}class yi{constructor(s,h){this.type=h.type,this.bindings=[].concat(s),this.result=h}evaluate(s){return this.result.evaluate(s)}eachChild(s){for(const h of this.bindings)s(h[1]);s(this.result)}static parse(s,h){if(s.length<4)return h.error(`Expected at least 3 arguments, but found ${s.length-1} instead.`);const p=[];for(let C=1;C<s.length-1;C+=2){const T=s[C];if(typeof T!="string")return h.error(`Expected string, but found ${typeof T} instead.`,C);if(/[^a-zA-Z0-9_]/.test(T))return h.error("Variable names must contain only alphanumeric characters or '_'.",C);const R=h.parse(s[C+1],C+1);if(!R)return null;p.push([T,R])}const x=h.parse(s[s.length-1],s.length-1,h.expectedType,p);return x?new yi(p,x):null}outputDefined(){return this.result.outputDefined()}}class il{constructor(s,h){this.type=h.type,this.name=s,this.boundExpression=h}static parse(s,h){if(s.length!==2||typeof s[1]!="string")return h.error("'var' expression requires exactly one string literal argument.");const p=s[1];return h.scope.has(p)?new il(p,h.scope.get(p)):h.error(`Unknown variable "${p}". Make sure "${p}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(s){return this.boundExpression.evaluate(s)}eachChild(){}outputDefined(){return!1}}class zp{constructor(s,h,p){this.type=s,this.index=h,this.input=p}static parse(s,h){if(s.length!==3)return h.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const p=h.parse(s[1],1,yt),x=h.parse(s[2],2,te(h.expectedType||Ne));return p&&x?new zp(x.type.itemType,p,x):null}evaluate(s){const h=this.index.evaluate(s),p=this.input.evaluate(s);if(h<0)throw new $i(`Array index out of bounds: ${h} < 0.`);if(h>=p.length)throw new $i(`Array index out of bounds: ${h} > ${p.length-1}.`);if(h!==Math.floor(h))throw new $i(`Array index must be an integer, but found ${h} instead.`);return p[h]}eachChild(s){s(this.index),s(this.input)}outputDefined(){return!1}}class du{constructor(s,h){this.type=Vt,this.needle=s,this.haystack=h}static parse(s,h){if(s.length!==3)return h.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const p=h.parse(s[1],1,Ne),x=h.parse(s[2],2,Ne);return p&&x?Fe(p.type,[Vt,Tt,yt,Wn,Ne])?new du(p,x):h.error(`Expected first argument to be of type boolean, string, number or null, but found ${ne(p.type)} instead`):null}evaluate(s){const h=this.needle.evaluate(s),p=this.haystack.evaluate(s);if(!p)return!1;if(!He(h,["boolean","string","number","null"]))throw new $i(`Expected first argument to be of type boolean, string, number or null, but found ${ne(di(h))} instead.`);if(!He(p,["string","array"]))throw new $i(`Expected second argument to be of type array or string, but found ${ne(di(p))} instead.`);return p.indexOf(h)>=0}eachChild(s){s(this.needle),s(this.haystack)}outputDefined(){return!0}}class fu{constructor(s,h,p){this.type=yt,this.needle=s,this.haystack=h,this.fromIndex=p}static parse(s,h){if(s.length<=2||s.length>=5)return h.error(`Expected 3 or 4 arguments, but found ${s.length-1} instead.`);const p=h.parse(s[1],1,Ne),x=h.parse(s[2],2,Ne);if(!p||!x)return null;if(!Fe(p.type,[Vt,Tt,yt,Wn,Ne]))return h.error(`Expected first argument to be of type boolean, string, number or null, but found ${ne(p.type)} instead`);if(s.length===4){const C=h.parse(s[3],3,yt);return C?new fu(p,x,C):null}return new fu(p,x)}evaluate(s){const h=this.needle.evaluate(s),p=this.haystack.evaluate(s);if(!He(h,["boolean","string","number","null"]))throw new $i(`Expected first argument to be of type boolean, string, number or null, but found ${ne(di(h))} instead.`);if(!He(p,["string","array"]))throw new $i(`Expected second argument to be of type array or string, but found ${ne(di(p))} instead.`);if(this.fromIndex){const x=this.fromIndex.evaluate(s);return p.indexOf(h,x)}return p.indexOf(h)}eachChild(s){s(this.needle),s(this.haystack),this.fromIndex&&s(this.fromIndex)}outputDefined(){return!1}}class pu{constructor(s,h,p,x,C,T){this.inputType=s,this.type=h,this.input=p,this.cases=x,this.outputs=C,this.otherwise=T}static parse(s,h){if(s.length<5)return h.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if(s.length%2!=1)return h.error("Expected an even number of arguments.");let p,x;h.expectedType&&h.expectedType.kind!=="value"&&(x=h.expectedType);const C={},T=[];for(let U=2;U<s.length-1;U+=2){let G=s[U];const Y=s[U+1];Array.isArray(G)||(G=[G]);const ee=h.concat(U);if(G.length===0)return ee.error("Expected at least one branch label.");for(const ue of G){if(typeof ue!="number"&&typeof ue!="string")return ee.error("Branch labels must be numbers or strings.");if(typeof ue=="number"&&Math.abs(ue)>Number.MAX_SAFE_INTEGER)return ee.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof ue=="number"&&Math.floor(ue)!==ue)return ee.error("Numeric branch labels must be integer values.");if(p){if(ee.checkSubtype(p,di(ue)))return null}else p=di(ue);if(C[String(ue)]!==void 0)return ee.error("Branch labels must be unique.");C[String(ue)]=T.length}const ae=h.parse(Y,U,x);if(!ae)return null;x=x||ae.type,T.push(ae)}const R=h.parse(s[1],1,Ne);if(!R)return null;const F=h.parse(s[s.length-1],s.length-1,x);return F?R.type.kind!=="value"&&h.concat(1).checkSubtype(p,R.type)?null:new pu(p,x,R,C,T,F):null}evaluate(s){const h=this.input.evaluate(s);return(di(h)===this.inputType&&this.outputs[this.cases[h]]||this.otherwise).evaluate(s)}eachChild(s){s(this.input),this.outputs.forEach(s),s(this.otherwise)}outputDefined(){return this.outputs.every(s=>s.outputDefined())&&this.otherwise.outputDefined()}}class rl{constructor(s,h,p){this.type=s,this.branches=h,this.otherwise=p}static parse(s,h){if(s.length<4)return h.error(`Expected at least 3 arguments, but found only ${s.length-1}.`);if(s.length%2!=0)return h.error("Expected an odd number of arguments.");let p;h.expectedType&&h.expectedType.kind!=="value"&&(p=h.expectedType);const x=[];for(let T=1;T<s.length-1;T+=2){const R=h.parse(s[T],T,Vt);if(!R)return null;const F=h.parse(s[T+1],T+1,p);if(!F)return null;x.push([R,F]),p=p||F.type}const C=h.parse(s[s.length-1],s.length-1,p);if(!C)return null;if(!p)throw new Error("Can't infer output type");return new rl(p,x,C)}evaluate(s){for(const[h,p]of this.branches)if(h.evaluate(s))return p.evaluate(s);return this.otherwise.evaluate(s)}eachChild(s){for(const[h,p]of this.branches)s(h),s(p);s(this.otherwise)}outputDefined(){return this.branches.every(([s,h])=>h.outputDefined())&&this.otherwise.outputDefined()}}class Eh{constructor(s,h,p,x){this.type=s,this.input=h,this.beginIndex=p,this.endIndex=x}static parse(s,h){if(s.length<=2||s.length>=5)return h.error(`Expected 3 or 4 arguments, but found ${s.length-1} instead.`);const p=h.parse(s[1],1,Ne),x=h.parse(s[2],2,yt);if(!p||!x)return null;if(!Fe(p.type,[te(Ne),Tt,Ne]))return h.error(`Expected first argument to be of type array or string, but found ${ne(p.type)} instead`);if(s.length===4){const C=h.parse(s[3],3,yt);return C?new Eh(p.type,p,x,C):null}return new Eh(p.type,p,x)}evaluate(s){const h=this.input.evaluate(s),p=this.beginIndex.evaluate(s);if(!He(h,["string","array"]))throw new $i(`Expected first argument to be of type array or string, but found ${ne(di(h))} instead.`);if(this.endIndex){const x=this.endIndex.evaluate(s);return h.slice(p,x)}return h.slice(p)}eachChild(s){s(this.input),s(this.beginIndex),this.endIndex&&s(this.endIndex)}outputDefined(){return!1}}function mu(c,s){const h=c.length-1;let p,x,C=0,T=h,R=0;for(;C<=T;)if(R=Math.floor((C+T)/2),p=c[R],x=c[R+1],p<=s){if(R===h||s<x)return R;C=R+1}else{if(!(p>s))throw new $i("Input is not a number.");T=R-1}return 0}class gu{constructor(s,h,p){this.type=s,this.input=h,this.labels=[],this.outputs=[];for(const[x,C]of p)this.labels.push(x),this.outputs.push(C)}static parse(s,h){if(s.length-1<4)return h.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if((s.length-1)%2!=0)return h.error("Expected an even number of arguments.");const p=h.parse(s[1],1,yt);if(!p)return null;const x=[];let C=null;h.expectedType&&h.expectedType.kind!=="value"&&(C=h.expectedType);for(let T=1;T<s.length;T+=2){const R=T===1?-1/0:s[T],F=s[T+1],U=T,G=T+1;if(typeof R!="number")return h.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',U);if(x.length&&x[x.length-1][0]>=R)return h.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',U);const Y=h.parse(F,G,C);if(!Y)return null;C=C||Y.type,x.push([R,Y])}return new gu(C,p,x)}evaluate(s){const h=this.labels,p=this.outputs;if(h.length===1)return p[0].evaluate(s);const x=this.input.evaluate(s);if(x<=h[0])return p[0].evaluate(s);const C=h.length;return x>=h[C-1]?p[C-1].evaluate(s):p[mu(h,x)].evaluate(s)}eachChild(s){s(this.input);for(const h of this.outputs)s(h)}outputDefined(){return this.outputs.every(s=>s.outputDefined())}}function Gv(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}var Wv=Np;function Np(c,s,h,p){this.cx=3*c,this.bx=3*(h-c)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*s,this.by=3*(p-s)-this.cy,this.ay=1-this.cy-this.by,this.p1x=c,this.p1y=s,this.p2x=h,this.p2y=p}Np.prototype={sampleCurveX:function(c){return((this.ax*c+this.bx)*c+this.cx)*c},sampleCurveY:function(c){return((this.ay*c+this.by)*c+this.cy)*c},sampleCurveDerivativeX:function(c){return(3*this.ax*c+2*this.bx)*c+this.cx},solveCurveX:function(c,s){if(s===void 0&&(s=1e-6),c<0)return 0;if(c>1)return 1;for(var h=c,p=0;p<8;p++){var x=this.sampleCurveX(h)-c;if(Math.abs(x)<s)return h;var C=this.sampleCurveDerivativeX(h);if(Math.abs(C)<1e-6)break;h-=x/C}var T=0,R=1;for(h=c,p=0;p<20&&(x=this.sampleCurveX(h),!(Math.abs(x-c)<s));p++)c>x?T=h:R=h,h=.5*(R-T)+T;return h},solve:function(c,s){return this.sampleCurveY(this.solveCurveX(c,s))}};var jv=Gv(Wv);function Fl(c,s,h){return c+h*(s-c)}function Mh(c,s,h){return c.map((p,x)=>Fl(p,s[x],h))}const ho={number:Fl,color:function(c,s,h,p="rgb"){switch(p){case"rgb":{const[x,C,T,R]=Mh(c.rgb,s.rgb,h);return new Yt(x,C,T,R,!1)}case"hcl":{const[x,C,T,R]=c.hcl,[F,U,G,Y]=s.hcl;let ee,ae;if(isNaN(x)||isNaN(F))isNaN(x)?isNaN(F)?ee=NaN:(ee=F,T!==1&&T!==0||(ae=U)):(ee=x,G!==1&&G!==0||(ae=C));else{let tt=F-x;F>x&&tt>180?tt-=360:F<x&&x-F>180&&(tt+=360),ee=x+h*tt}const[ue,pe,Ae,Oe]=function([tt,Le,Qe,dt]){return tt=isNaN(tt)?0:tt*Sn,me([Qe,Math.cos(tt)*Le,Math.sin(tt)*Le,dt])}([ee,ae??Fl(C,U,h),Fl(T,G,h),Fl(R,Y,h)]);return new Yt(ue,pe,Ae,Oe,!1)}case"lab":{const[x,C,T,R]=me(Mh(c.lab,s.lab,h));return new Yt(x,C,T,R,!1)}}},array:Mh,padding:function(c,s,h){return new ri(Mh(c.values,s.values,h))},variableAnchorOffsetCollection:function(c,s,h){const p=c.values,x=s.values;if(p.length!==x.length)throw new $i(`Cannot interpolate values of different length. from: ${c.toString()}, to: ${s.toString()}`);const C=[];for(let T=0;T<p.length;T+=2){if(p[T]!==x[T])throw new $i(`Cannot interpolate values containing mismatched anchors. from[${T}]: ${p[T]}, to[${T}]: ${x[T]}`);C.push(p[T]);const[R,F]=p[T+1],[U,G]=x[T+1];C.push([Fl(R,U,h),Fl(F,G,h)])}return new mi(C)}};class Xs{constructor(s,h,p,x,C){this.type=s,this.operator=h,this.interpolation=p,this.input=x,this.labels=[],this.outputs=[];for(const[T,R]of C)this.labels.push(T),this.outputs.push(R)}static interpolationFactor(s,h,p,x){let C=0;if(s.name==="exponential")C=Ch(h,s.base,p,x);else if(s.name==="linear")C=Ch(h,1,p,x);else if(s.name==="cubic-bezier"){const T=s.controlPoints;C=new jv(T[0],T[1],T[2],T[3]).solve(Ch(h,1,p,x))}return C}static parse(s,h){let[p,x,C,...T]=s;if(!Array.isArray(x)||x.length===0)return h.error("Expected an interpolation type expression.",1);if(x[0]==="linear")x={name:"linear"};else if(x[0]==="exponential"){const U=x[1];if(typeof U!="number")return h.error("Exponential interpolation requires a numeric base.",1,1);x={name:"exponential",base:U}}else{if(x[0]!=="cubic-bezier")return h.error(`Unknown interpolation type ${String(x[0])}`,1,0);{const U=x.slice(1);if(U.length!==4||U.some(G=>typeof G!="number"||G<0||G>1))return h.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);x={name:"cubic-bezier",controlPoints:U}}}if(s.length-1<4)return h.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if((s.length-1)%2!=0)return h.error("Expected an even number of arguments.");if(C=h.parse(C,2,yt),!C)return null;const R=[];let F=null;p==="interpolate-hcl"||p==="interpolate-lab"?F=kn:h.expectedType&&h.expectedType.kind!=="value"&&(F=h.expectedType);for(let U=0;U<T.length;U+=2){const G=T[U],Y=T[U+1],ee=U+3,ae=U+4;if(typeof G!="number")return h.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',ee);if(R.length&&R[R.length-1][0]>=G)return h.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',ee);const ue=h.parse(Y,ae,F);if(!ue)return null;F=F||ue.type,R.push([G,ue])}return nt(F,yt)||nt(F,kn)||nt(F,Ct)||nt(F,xe)||nt(F,te(yt))?new Xs(F,p,x,C,R):h.error(`Type ${ne(F)} is not interpolatable.`)}evaluate(s){const h=this.labels,p=this.outputs;if(h.length===1)return p[0].evaluate(s);const x=this.input.evaluate(s);if(x<=h[0])return p[0].evaluate(s);const C=h.length;if(x>=h[C-1])return p[C-1].evaluate(s);const T=mu(h,x),R=Xs.interpolationFactor(this.interpolation,x,h[T],h[T+1]),F=p[T].evaluate(s),U=p[T+1].evaluate(s);switch(this.operator){case"interpolate":return ho[this.type.kind](F,U,R);case"interpolate-hcl":return ho.color(F,U,R,"hcl");case"interpolate-lab":return ho.color(F,U,R,"lab")}}eachChild(s){s(this.input);for(const h of this.outputs)s(h)}outputDefined(){return this.outputs.every(s=>s.outputDefined())}}function Ch(c,s,h,p){const x=p-h,C=c-h;return x===0?0:s===1?C/x:(Math.pow(s,C)-1)/(Math.pow(s,x)-1)}class sf{constructor(s,h){this.type=s,this.args=h}static parse(s,h){if(s.length<2)return h.error("Expectected at least one argument.");let p=null;const x=h.expectedType;x&&x.kind!=="value"&&(p=x);const C=[];for(const R of s.slice(1)){const F=h.parse(R,1+C.length,p,void 0,{typeAnnotation:"omit"});if(!F)return null;p=p||F.type,C.push(F)}if(!p)throw new Error("No output type");const T=x&&C.some(R=>we(x,R.type));return new sf(T?Ne:p,C)}evaluate(s){let h,p=null,x=0;for(const C of this.args)if(x++,p=C.evaluate(s),p&&p instanceof Ni&&!p.available&&(h||(h=p.name),p=null,x===this.args.length&&(p=h)),p!==null)break;return p}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}}function qv(c,s){return c==="=="||c==="!="?s.kind==="boolean"||s.kind==="string"||s.kind==="number"||s.kind==="null"||s.kind==="value":s.kind==="string"||s.kind==="number"||s.kind==="value"}function Xv(c,s,h,p){return p.compare(s,h)===0}function sl(c,s,h){const p=c!=="=="&&c!=="!=";return class T9{constructor(C,T,R){this.type=Vt,this.lhs=C,this.rhs=T,this.collator=R,this.hasUntypedArgument=C.type.kind==="value"||T.type.kind==="value"}static parse(C,T){if(C.length!==3&&C.length!==4)return T.error("Expected two or three arguments.");const R=C[0];let F=T.parse(C[1],1,Ne);if(!F)return null;if(!qv(R,F.type))return T.concat(1).error(`"${R}" comparisons are not supported for type '${ne(F.type)}'.`);let U=T.parse(C[2],2,Ne);if(!U)return null;if(!qv(R,U.type))return T.concat(2).error(`"${R}" comparisons are not supported for type '${ne(U.type)}'.`);if(F.type.kind!==U.type.kind&&F.type.kind!=="value"&&U.type.kind!=="value")return T.error(`Cannot compare types '${ne(F.type)}' and '${ne(U.type)}'.`);p&&(F.type.kind==="value"&&U.type.kind!=="value"?F=new vs(U.type,[F]):F.type.kind!=="value"&&U.type.kind==="value"&&(U=new vs(F.type,[U])));let G=null;if(C.length===4){if(F.type.kind!=="string"&&U.type.kind!=="string"&&F.type.kind!=="value"&&U.type.kind!=="value")return T.error("Cannot use collator to compare non-string types.");if(G=T.parse(C[3],3,Gt),!G)return null}return new T9(F,U,G)}evaluate(C){const T=this.lhs.evaluate(C),R=this.rhs.evaluate(C);if(p&&this.hasUntypedArgument){const F=di(T),U=di(R);if(F.kind!==U.kind||F.kind!=="string"&&F.kind!=="number")throw new $i(`Expected arguments for "${c}" to be (string, string) or (number, number), but found (${F.kind}, ${U.kind}) instead.`)}if(this.collator&&!p&&this.hasUntypedArgument){const F=di(T),U=di(R);if(F.kind!=="string"||U.kind!=="string")return s(C,T,R)}return this.collator?h(C,T,R,this.collator.evaluate(C)):s(C,T,R)}eachChild(C){C(this.lhs),C(this.rhs),this.collator&&C(this.collator)}outputDefined(){return!0}}}const Zv=sl("==",function(c,s,h){return s===h},Xv),fx=sl("!=",function(c,s,h){return s!==h},function(c,s,h,p){return!Xv(0,s,h,p)}),px=sl("<",function(c,s,h){return s<h},function(c,s,h,p){return p.compare(s,h)<0}),Yv=sl(">",function(c,s,h){return s>h},function(c,s,h,p){return p.compare(s,h)>0}),Kv=sl("<=",function(c,s,h){return s<=h},function(c,s,h,p){return p.compare(s,h)<=0}),hr=sl(">=",function(c,s,h){return s>=h},function(c,s,h,p){return p.compare(s,h)>=0});class Hi{constructor(s,h,p){this.type=Gt,this.locale=p,this.caseSensitive=s,this.diacriticSensitive=h}static parse(s,h){if(s.length!==2)return h.error("Expected one argument.");const p=s[1];if(typeof p!="object"||Array.isArray(p))return h.error("Collator options argument must be an object.");const x=h.parse(p["case-sensitive"]!==void 0&&p["case-sensitive"],1,Vt);if(!x)return null;const C=h.parse(p["diacritic-sensitive"]!==void 0&&p["diacritic-sensitive"],1,Vt);if(!C)return null;let T=null;return p.locale&&(T=h.parse(p.locale,1,Tt),!T)?null:new Hi(x,C,T)}evaluate(s){return new jn(this.caseSensitive.evaluate(s),this.diacriticSensitive.evaluate(s),this.locale?this.locale.evaluate(s):null)}eachChild(s){s(this.caseSensitive),s(this.diacriticSensitive),this.locale&&s(this.locale)}outputDefined(){return!1}}class Bp{constructor(s,h,p,x,C){this.type=Tt,this.number=s,this.locale=h,this.currency=p,this.minFractionDigits=x,this.maxFractionDigits=C}static parse(s,h){if(s.length!==3)return h.error("Expected two arguments.");const p=h.parse(s[1],1,yt);if(!p)return null;const x=s[2];if(typeof x!="object"||Array.isArray(x))return h.error("NumberFormat options argument must be an object.");let C=null;if(x.locale&&(C=h.parse(x.locale,1,Tt),!C))return null;let T=null;if(x.currency&&(T=h.parse(x.currency,1,Tt),!T))return null;let R=null;if(x["min-fraction-digits"]&&(R=h.parse(x["min-fraction-digits"],1,yt),!R))return null;let F=null;return x["max-fraction-digits"]&&(F=h.parse(x["max-fraction-digits"],1,yt),!F)?null:new Bp(p,C,T,R,F)}evaluate(s){return new Intl.NumberFormat(this.locale?this.locale.evaluate(s):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(s):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(s):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(s):void 0}).format(this.number.evaluate(s))}eachChild(s){s(this.number),this.locale&&s(this.locale),this.currency&&s(this.currency),this.minFractionDigits&&s(this.minFractionDigits),this.maxFractionDigits&&s(this.maxFractionDigits)}outputDefined(){return!1}}class of{constructor(s){this.type=Et,this.sections=s}static parse(s,h){if(s.length<2)return h.error("Expected at least one argument.");const p=s[1];if(!Array.isArray(p)&&typeof p=="object")return h.error("First argument must be an image or text section.");const x=[];let C=!1;for(let T=1;T<=s.length-1;++T){const R=s[T];if(C&&typeof R=="object"&&!Array.isArray(R)){C=!1;let F=null;if(R["font-scale"]&&(F=h.parse(R["font-scale"],1,yt),!F))return null;let U=null;if(R["text-font"]&&(U=h.parse(R["text-font"],1,te(Tt)),!U))return null;let G=null;if(R["text-color"]&&(G=h.parse(R["text-color"],1,kn),!G))return null;const Y=x[x.length-1];Y.scale=F,Y.font=U,Y.textColor=G}else{const F=h.parse(s[T],1,Ne);if(!F)return null;const U=F.type.kind;if(U!=="string"&&U!=="value"&&U!=="null"&&U!=="resolvedImage")return h.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");C=!0,x.push({content:F,scale:null,font:null,textColor:null})}}return new of(x)}evaluate(s){return new In(this.sections.map(h=>{const p=h.content.evaluate(s);return di(p)===Zt?new Zn("",p,null,null,null):new Zn(li(p),null,h.scale?h.scale.evaluate(s):null,h.font?h.font.evaluate(s).join(","):null,h.textColor?h.textColor.evaluate(s):null)}))}eachChild(s){for(const h of this.sections)s(h.content),h.scale&&s(h.scale),h.font&&s(h.font),h.textColor&&s(h.textColor)}outputDefined(){return!1}}class Up{constructor(s){this.type=Zt,this.input=s}static parse(s,h){if(s.length!==2)return h.error("Expected two arguments.");const p=h.parse(s[1],1,Tt);return p?new Up(p):h.error("No image name provided.")}evaluate(s){const h=this.input.evaluate(s),p=Ni.fromString(h);return p&&s.availableImages&&(p.available=s.availableImages.indexOf(h)>-1),p}eachChild(s){s(this.input)}outputDefined(){return!1}}class Vp{constructor(s){this.type=yt,this.input=s}static parse(s,h){if(s.length!==2)return h.error(`Expected 1 argument, but found ${s.length-1} instead.`);const p=h.parse(s[1],1);return p?p.type.kind!=="array"&&p.type.kind!=="string"&&p.type.kind!=="value"?h.error(`Expected argument of type string or array, but found ${ne(p.type)} instead.`):new Vp(p):null}evaluate(s){const h=this.input.evaluate(s);if(typeof h=="string"||Array.isArray(h))return h.length;throw new $i(`Expected value to be of type string or array, but found ${ne(di(h))} instead.`)}eachChild(s){s(this.input)}outputDefined(){return!1}}const ba=8192;function $p(c,s){const h=(180+c[0])/360,p=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c[1]*Math.PI/360)))/360,x=Math.pow(2,s.z);return[Math.round(h*x*ba),Math.round(p*x*ba)]}function Cc(c,s){const h=Math.pow(2,s.z);return[(x=(c[0]/ba+s.x)/h,360*x-180),(p=(c[1]/ba+s.y)/h,360/Math.PI*Math.atan(Math.exp((180-360*p)*Math.PI/180))-90)];var p,x}function _i(c,s){c[0]=Math.min(c[0],s[0]),c[1]=Math.min(c[1],s[1]),c[2]=Math.max(c[2],s[0]),c[3]=Math.max(c[3],s[1])}function Ar(c,s){return!(c[0]<=s[0]||c[2]>=s[2]||c[1]<=s[1]||c[3]>=s[3])}function Hp(c,s,h){const p=c[0]-s[0],x=c[1]-s[1],C=c[0]-h[0],T=c[1]-h[1];return p*T-C*x==0&&p*C<=0&&x*T<=0}function wa(c,s,h,p){return(x=[p[0]-h[0],p[1]-h[1]])[0]*(C=[s[0]-c[0],s[1]-c[1]])[1]-x[1]*C[0]!=0&&!(!Wp(c,s,h,p)||!Wp(h,p,c,s));var x,C}function Jv(c,s,h){for(const p of h)for(let x=0;x<p.length-1;++x)if(wa(c,s,p[x],p[x+1]))return!0;return!1}function zl(c,s,h=!1){let p=!1;for(const R of s)for(let F=0;F<R.length-1;F++){if(Hp(c,R[F],R[F+1]))return h;(C=R[F])[1]>(x=c)[1]!=(T=R[F+1])[1]>x[1]&&x[0]<(T[0]-C[0])*(x[1]-C[1])/(T[1]-C[1])+C[0]&&(p=!p)}var x,C,T;return p}function Lo(c,s){for(const h of s)if(zl(c,h))return!0;return!1}function Gp(c,s){for(const h of c)if(!zl(h,s))return!1;for(let h=0;h<c.length-1;++h)if(Jv(c[h],c[h+1],s))return!1;return!0}function Qv(c,s){for(const h of s)if(Gp(c,h))return!0;return!1}function Wp(c,s,h,p){const x=p[0]-h[0],C=p[1]-h[1],T=(c[0]-h[0])*C-x*(c[1]-h[1]),R=(s[0]-h[0])*C-x*(s[1]-h[1]);return T>0&&R<0||T<0&&R>0}function af(c,s,h){const p=[];for(let x=0;x<c.length;x++){const C=[];for(let T=0;T<c[x].length;T++){const R=$p(c[x][T],h);_i(s,R),C.push(R)}p.push(C)}return p}function jp(c,s,h){const p=[];for(let x=0;x<c.length;x++){const C=af(c[x],s,h);p.push(C)}return p}function qp(c,s,h,p){if(c[0]<h[0]||c[0]>h[2]){const x=.5*p;let C=c[0]-h[0]>x?-p:h[0]-c[0]>x?p:0;C===0&&(C=c[0]-h[2]>x?-p:h[2]-c[0]>x?p:0),c[0]+=C}_i(s,c)}function Zs(c,s,h,p){const x=Math.pow(2,p.z)*ba,C=[p.x*ba,p.y*ba],T=[];for(const R of c)for(const F of R){const U=[F.x+C[0],F.y+C[1]];qp(U,s,h,x),T.push(U)}return T}function e0(c,s,h,p){const x=Math.pow(2,p.z)*ba,C=[p.x*ba,p.y*ba],T=[];for(const F of c){const U=[];for(const G of F){const Y=[G.x+C[0],G.y+C[1]];_i(s,Y),U.push(Y)}T.push(U)}if(s[2]-s[0]<=x/2){(R=s)[0]=R[1]=1/0,R[2]=R[3]=-1/0;for(const F of T)for(const U of F)qp(U,s,h,x)}var R;return T}class es{constructor(s,h){this.type=Vt,this.geojson=s,this.geometries=h}static parse(s,h){if(s.length!==2)return h.error(`'within' expression requires exactly one argument, but found ${s.length-1} instead.`);if(Fn(s[1])){const p=s[1];if(p.type==="FeatureCollection"){const x=[];for(const C of p.features){const{type:T,coordinates:R}=C.geometry;T==="Polygon"&&x.push(R),T==="MultiPolygon"&&x.push(...R)}if(x.length)return new es(p,{type:"MultiPolygon",coordinates:x})}else if(p.type==="Feature"){const x=p.geometry.type;if(x==="Polygon"||x==="MultiPolygon")return new es(p,p.geometry)}else if(p.type==="Polygon"||p.type==="MultiPolygon")return new es(p,p)}return h.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(s){if(s.geometry()!=null&&s.canonicalID()!=null){if(s.geometryType()==="Point")return function(h,p){const x=[1/0,1/0,-1/0,-1/0],C=[1/0,1/0,-1/0,-1/0],T=h.canonicalID();if(p.type==="Polygon"){const R=af(p.coordinates,C,T),F=Zs(h.geometry(),x,C,T);if(!Ar(x,C))return!1;for(const U of F)if(!zl(U,R))return!1}if(p.type==="MultiPolygon"){const R=jp(p.coordinates,C,T),F=Zs(h.geometry(),x,C,T);if(!Ar(x,C))return!1;for(const U of F)if(!Lo(U,R))return!1}return!0}(s,this.geometries);if(s.geometryType()==="LineString")return function(h,p){const x=[1/0,1/0,-1/0,-1/0],C=[1/0,1/0,-1/0,-1/0],T=h.canonicalID();if(p.type==="Polygon"){const R=af(p.coordinates,C,T),F=e0(h.geometry(),x,C,T);if(!Ar(x,C))return!1;for(const U of F)if(!Gp(U,R))return!1}if(p.type==="MultiPolygon"){const R=jp(p.coordinates,C,T),F=e0(h.geometry(),x,C,T);if(!Ar(x,C))return!1;for(const U of F)if(!Qv(U,R))return!1}return!0}(s,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let t0=class{constructor(c=[],s=n0){if(this.data=c,this.length=this.data.length,this.compare=s,this.length>0)for(let h=(this.length>>1)-1;h>=0;h--)this._down(h)}push(c){this.data.push(c),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const c=this.data[0],s=this.data.pop();return this.length--,this.length>0&&(this.data[0]=s,this._down(0)),c}peek(){return this.data[0]}_up(c){const{data:s,compare:h}=this,p=s[c];for(;c>0;){const x=c-1>>1,C=s[x];if(h(p,C)>=0)break;s[c]=C,c=x}s[c]=p}_down(c){const{data:s,compare:h}=this,p=this.length>>1,x=s[c];for(;c<p;){let C=1+(c<<1),T=s[C];const R=C+1;if(R<this.length&&h(s[R],T)<0&&(C=R,T=s[R]),h(T,x)>=0)break;s[c]=T,c=C}s[c]=x}};function n0(c,s){return c<s?-1:c>s?1:0}function Nl(c,s,h,p,x){Th(c,s,h,p||c.length-1,x||gr)}function Th(c,s,h,p,x){for(;p>h;){if(p-h>600){var C=p-h+1,T=s-h+1,R=Math.log(C),F=.5*Math.exp(2*R/3),U=.5*Math.sqrt(R*F*(C-F)/C)*(T-C/2<0?-1:1);Th(c,s,Math.max(h,Math.floor(s-T*F/C+U)),Math.min(p,Math.floor(s+(C-T)*F/C+U)),x)}var G=c[s],Y=h,ee=p;for(Tc(c,h,s),x(c[p],G)>0&&Tc(c,h,p);Y<ee;){for(Tc(c,Y,ee),Y++,ee--;x(c[Y],G)<0;)Y++;for(;x(c[ee],G)>0;)ee--}x(c[h],G)===0?Tc(c,h,ee):Tc(c,++ee,p),ee<=s&&(h=ee+1),s<=ee&&(p=ee-1)}}function Tc(c,s,h){var p=c[s];c[s]=c[h],c[h]=p}function gr(c,s){return c<s?-1:c>s?1:0}function ta(c,s){if(c.length<=1)return[c];const h=[];let p,x;for(const C of c){const T=mx(C);T!==0&&(C.area=Math.abs(T),x===void 0&&(x=T<0),x===T<0?(p&&h.push(p),p=[C]):p.push(C))}if(p&&h.push(p),s>1)for(let C=0;C<h.length;C++)h[C].length<=s||(Nl(h[C],s,1,h[C].length-1,Xp),h[C]=h[C].slice(0,s));return h}function Xp(c,s){return s.area-c.area}function mx(c){let s=0;for(let h,p,x=0,C=c.length,T=C-1;x<C;T=x++)h=c[x],p=c[T],s+=(p.x-h.x)*(h.y+p.y);return s}const lf=1/298.257223563,i0=lf*(2-lf),r0=Math.PI/180;class Zp{constructor(s){const h=6378.137*r0*1e3,p=Math.cos(s*r0),x=1/(1-i0*(1-p*p)),C=Math.sqrt(x);this.kx=h*C*p,this.ky=h*C*x*(1-i0)}distance(s,h){const p=this.wrap(s[0]-h[0])*this.kx,x=(s[1]-h[1])*this.ky;return Math.sqrt(p*p+x*x)}pointOnLine(s,h){let p,x,C,T,R=1/0;for(let F=0;F<s.length-1;F++){let U=s[F][0],G=s[F][1],Y=this.wrap(s[F+1][0]-U)*this.kx,ee=(s[F+1][1]-G)*this.ky,ae=0;Y===0&&ee===0||(ae=(this.wrap(h[0]-U)*this.kx*Y+(h[1]-G)*this.ky*ee)/(Y*Y+ee*ee),ae>1?(U=s[F+1][0],G=s[F+1][1]):ae>0&&(U+=Y/this.kx*ae,G+=ee/this.ky*ae)),Y=this.wrap(h[0]-U)*this.kx,ee=(h[1]-G)*this.ky;const ue=Y*Y+ee*ee;ue<R&&(R=ue,p=U,x=G,C=F,T=ae)}return{point:[p,x],index:C,t:Math.max(0,Math.min(1,T))}}wrap(s){for(;s<-180;)s+=360;for(;s>180;)s-=360;return s}}function Yp(c,s){return s[0]-c[0]}function Ac(c){return c[1]-c[0]+1}function Ys(c,s){return c[1]>=c[0]&&c[1]<s}function Ah(c,s){if(c[0]>c[1])return[null,null];const h=Ac(c);if(s){if(h===2)return[c,null];const x=Math.floor(h/2);return[[c[0],c[0]+x],[c[0]+x,c[1]]]}if(h===1)return[c,null];const p=Math.floor(h/2)-1;return[[c[0],c[0]+p],[c[0]+p+1,c[1]]]}function cf(c,s){if(!Ys(s,c.length))return[1/0,1/0,-1/0,-1/0];const h=[1/0,1/0,-1/0,-1/0];for(let p=s[0];p<=s[1];++p)_i(h,c[p]);return h}function uf(c){const s=[1/0,1/0,-1/0,-1/0];for(const h of c)for(const p of h)_i(s,p);return s}function hf(c){return c[0]!==-1/0&&c[1]!==-1/0&&c[2]!==1/0&&c[3]!==1/0}function Ph(c,s,h){if(!hf(c)||!hf(s))return NaN;let p=0,x=0;return c[2]<s[0]&&(p=s[0]-c[2]),c[0]>s[2]&&(p=c[0]-s[2]),c[1]>s[3]&&(x=c[1]-s[3]),c[3]<s[1]&&(x=s[1]-c[3]),h.distance([0,0],[p,x])}function Xi(c,s,h){const p=h.pointOnLine(s,c);return h.distance(c,p.point)}function Kp(c,s,h,p,x){const C=Math.min(Xi(c,[h,p],x),Xi(s,[h,p],x)),T=Math.min(Xi(h,[c,s],x),Xi(p,[c,s],x));return Math.min(C,T)}function ci(c,s,h,p,x){if(!Ys(s,c.length)||!Ys(p,h.length))return 1/0;let C=1/0;for(let T=s[0];T<s[1];++T){const R=c[T],F=c[T+1];for(let U=p[0];U<p[1];++U){const G=h[U],Y=h[U+1];if(wa(R,F,G,Y))return 0;C=Math.min(C,Kp(R,F,G,Y,x))}}return C}function Ih(c,s,h,p,x){if(!Ys(s,c.length)||!Ys(p,h.length))return NaN;let C=1/0;for(let T=s[0];T<=s[1];++T)for(let R=p[0];R<=p[1];++R)if(C=Math.min(C,x.distance(c[T],h[R])),C===0)return C;return C}function dr(c,s,h){if(zl(c,s,!0))return 0;let p=1/0;for(const x of s){const C=x[0],T=x[x.length-1];if(C!==T&&(p=Math.min(p,Xi(c,[T,C],h)),p===0))return p;const R=h.pointOnLine(x,c);if(p=Math.min(p,h.distance(c,R.point)),p===0)return p}return p}function er(c,s,h,p){if(!Ys(s,c.length))return NaN;for(let C=s[0];C<=s[1];++C)if(zl(c[C],h,!0))return 0;let x=1/0;for(let C=s[0];C<s[1];++C){const T=c[C],R=c[C+1];for(const F of h)for(let U=0,G=F.length,Y=G-1;U<G;Y=U++){const ee=F[Y],ae=F[U];if(wa(T,R,ee,ae))return 0;x=Math.min(x,Kp(T,R,ee,ae,p))}}return x}function as(c,s){for(const h of c)for(const p of h)if(zl(p,s,!0))return!0;return!1}function df(c,s,h,p=1/0){const x=uf(c),C=uf(s);if(p!==1/0&&Ph(x,C,h)>=p)return p;if(Ar(x,C)){if(as(c,s))return 0}else if(as(s,c))return 0;let T=1/0;for(const R of c)for(let F=0,U=R.length,G=U-1;F<U;G=F++){const Y=R[G],ee=R[F];for(const ae of s)for(let ue=0,pe=ae.length,Ae=pe-1;ue<pe;Ae=ue++){const Oe=ae[Ae],tt=ae[ue];if(wa(Y,ee,Oe,tt))return 0;T=Math.min(T,Kp(Y,ee,Oe,tt,h))}}return T}function Pc(c,s,h,p,x,C){if(!C)return;const T=Ph(cf(p,C),x,h);T<s&&c.push([T,C,[0,0]])}function Rh(c,s,h,p,x,C,T){if(!C||!T)return;const R=Ph(cf(p,C),cf(x,T),h);R<s&&c.push([R,C,T])}function Lh(c,s,h,p,x=1/0){let C=Math.min(p.distance(c[0],h[0][0]),x);if(C===0)return C;const T=new t0([[0,[0,c.length-1],[0,0]]],Yp),R=uf(h);for(;T.length>0;){const F=T.pop();if(F[0]>=C)continue;const U=F[1],G=s?50:100;if(Ac(U)<=G){if(!Ys(U,c.length))return NaN;if(s){const Y=er(c,U,h,p);if(isNaN(Y)||Y===0)return Y;C=Math.min(C,Y)}else for(let Y=U[0];Y<=U[1];++Y){const ee=dr(c[Y],h,p);if(C=Math.min(C,ee),C===0)return 0}}else{const Y=Ah(U,s);Pc(T,C,p,c,R,Y[0]),Pc(T,C,p,c,R,Y[1])}}return C}function ff(c,s,h,p,x,C=1/0){let T=Math.min(C,x.distance(c[0],h[0]));if(T===0)return T;const R=new t0([[0,[0,c.length-1],[0,h.length-1]]],Yp);for(;R.length>0;){const F=R.pop();if(F[0]>=T)continue;const U=F[1],G=F[2],Y=s?50:100,ee=p?50:100;if(Ac(U)<=Y&&Ac(G)<=ee){if(!Ys(U,c.length)&&Ys(G,h.length))return NaN;let ae;if(s&&p)ae=ci(c,U,h,G,x),T=Math.min(T,ae);else if(s&&!p){const ue=c.slice(U[0],U[1]+1);for(let pe=G[0];pe<=G[1];++pe)if(ae=Xi(h[pe],ue,x),T=Math.min(T,ae),T===0)return T}else if(!s&&p){const ue=h.slice(G[0],G[1]+1);for(let pe=U[0];pe<=U[1];++pe)if(ae=Xi(c[pe],ue,x),T=Math.min(T,ae),T===0)return T}else ae=Ih(c,U,h,G,x),T=Math.min(T,ae)}else{const ae=Ah(U,s),ue=Ah(G,p);Rh(R,T,x,c,h,ae[0],ue[0]),Rh(R,T,x,c,h,ae[0],ue[1]),Rh(R,T,x,c,h,ae[1],ue[0]),Rh(R,T,x,c,h,ae[1],ue[1])}}return T}function Jp(c){return c.type==="MultiPolygon"?c.coordinates.map(s=>({type:"Polygon",coordinates:s})):c.type==="MultiLineString"?c.coordinates.map(s=>({type:"LineString",coordinates:s})):c.type==="MultiPoint"?c.coordinates.map(s=>({type:"Point",coordinates:s})):[c]}class Bl{constructor(s,h){this.type=yt,this.geojson=s,this.geometries=h}static parse(s,h){if(s.length!==2)return h.error(`'distance' expression requires exactly one argument, but found ${s.length-1} instead.`);if(Fn(s[1])){const p=s[1];if(p.type==="FeatureCollection")return new Bl(p,p.features.map(x=>Jp(x.geometry)).flat());if(p.type==="Feature")return new Bl(p,Jp(p.geometry));if("type"in p&&"coordinates"in p)return new Bl(p,Jp(p))}return h.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(s){if(s.geometry()!=null&&s.canonicalID()!=null){if(s.geometryType()==="Point")return function(h,p){const x=h.geometry(),C=x.flat().map(F=>Cc([F.x,F.y],h.canonical));if(x.length===0)return NaN;const T=new Zp(C[0][1]);let R=1/0;for(const F of p){switch(F.type){case"Point":R=Math.min(R,ff(C,!1,[F.coordinates],!1,T,R));break;case"LineString":R=Math.min(R,ff(C,!1,F.coordinates,!0,T,R));break;case"Polygon":R=Math.min(R,Lh(C,!1,F.coordinates,T,R))}if(R===0)return R}return R}(s,this.geometries);if(s.geometryType()==="LineString")return function(h,p){const x=h.geometry(),C=x.flat().map(F=>Cc([F.x,F.y],h.canonical));if(x.length===0)return NaN;const T=new Zp(C[0][1]);let R=1/0;for(const F of p){switch(F.type){case"Point":R=Math.min(R,ff(C,!0,[F.coordinates],!1,T,R));break;case"LineString":R=Math.min(R,ff(C,!0,F.coordinates,!0,T,R));break;case"Polygon":R=Math.min(R,Lh(C,!0,F.coordinates,T,R))}if(R===0)return R}return R}(s,this.geometries);if(s.geometryType()==="Polygon")return function(h,p){const x=h.geometry();if(x.length===0||x[0].length===0)return NaN;const C=ta(x,0).map(F=>F.map(U=>U.map(G=>Cc([G.x,G.y],h.canonical)))),T=new Zp(C[0][0][0][1]);let R=1/0;for(const F of p)for(const U of C){switch(F.type){case"Point":R=Math.min(R,Lh([F.coordinates],!1,U,T,R));break;case"LineString":R=Math.min(R,Lh(F.coordinates,!0,U,T,R));break;case"Polygon":R=Math.min(R,df(U,F.coordinates,T,R))}if(R===0)return R}return R}(s,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const Ic={"==":Zv,"!=":fx,">":Yv,"<":px,">=":hr,"<=":Kv,array:vs,at:zp,boolean:vs,case:rl,coalesce:sf,collator:Hi,format:of,image:Up,in:du,"index-of":fu,interpolate:Xs,"interpolate-hcl":Xs,"interpolate-lab":Xs,length:Vp,let:yi,literal:Or,match:pu,number:vs,"number-format":Bp,object:vs,slice:Eh,step:gu,string:vs,"to-boolean":zr,"to-color":zr,"to-number":zr,"to-string":zr,var:il,within:es,distance:Bl};class fo{constructor(s,h,p,x){this.name=s,this.type=h,this._evaluate=p,this.args=x}evaluate(s){return this._evaluate(s,this.args)}eachChild(s){this.args.forEach(s)}outputDefined(){return!1}static parse(s,h){const p=s[0],x=fo.definitions[p];if(!x)return h.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0);const C=Array.isArray(x)?x[0]:x.type,T=Array.isArray(x)?[[x[1],x[2]]]:x.overloads,R=T.filter(([U])=>!Array.isArray(U)||U.length===s.length-1);let F=null;for(const[U,G]of R){F=new uo(h.registry,kh,h.path,null,h.scope);const Y=[];let ee=!1;for(let ae=1;ae<s.length;ae++){const ue=s[ae],pe=Array.isArray(U)?U[ae-1]:U.type,Ae=F.parse(ue,1+Y.length,pe);if(!Ae){ee=!0;break}Y.push(Ae)}if(!ee)if(Array.isArray(U)&&U.length!==Y.length)F.error(`Expected ${U.length} arguments, but found ${Y.length} instead.`);else{for(let ae=0;ae<Y.length;ae++){const ue=Array.isArray(U)?U[ae]:U.type,pe=Y[ae];F.concat(ae+1).checkSubtype(ue,pe.type)}if(F.errors.length===0)return new fo(p,C,G,Y)}}if(R.length===1)h.errors.push(...F.errors);else{const U=(R.length?R:T).map(([Y])=>{return ee=Y,Array.isArray(ee)?`(${ee.map(ne).join(", ")})`:`(${ne(ee.type)}...)`;var ee}).join(" | "),G=[];for(let Y=1;Y<s.length;Y++){const ee=h.parse(s[Y],1+G.length);if(!ee)return null;G.push(ne(ee.type))}h.error(`Expected arguments of type ${U}, but found (${G.join(", ")}) instead.`)}return null}static register(s,h){fo.definitions=h;for(const p in h)s[p]=fo}}function Ul(c,[s,h,p,x]){s=s.evaluate(c),h=h.evaluate(c),p=p.evaluate(c);const C=x?x.evaluate(c):1,T=wi(s,h,p,C);if(T)throw new $i(T);return new Yt(s/255,h/255,p/255,C,!1)}function pf(c,s){return c in s}function Qp(c,s){const h=s[c];return h===void 0?null:h}function ol(c){return{type:c}}function kh(c){if(c instanceof il)return kh(c.boundExpression);if(c instanceof fo&&c.name==="error"||c instanceof Hi||c instanceof es||c instanceof Bl)return!1;const s=c instanceof zr||c instanceof vs;let h=!0;return c.eachChild(p=>{h=s?h&&kh(p):h&&p instanceof Or}),!!h&&na(c)&&mf(c,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function na(c){if(c instanceof fo&&(c.name==="get"&&c.args.length===1||c.name==="feature-state"||c.name==="has"&&c.args.length===1||c.name==="properties"||c.name==="geometry-type"||c.name==="id"||/^filter-/.test(c.name))||c instanceof es||c instanceof Bl)return!1;let s=!0;return c.eachChild(h=>{s&&!na(h)&&(s=!1)}),s}function Vl(c){if(c instanceof fo&&c.name==="feature-state")return!1;let s=!0;return c.eachChild(h=>{s&&!Vl(h)&&(s=!1)}),s}function mf(c,s){if(c instanceof fo&&s.indexOf(c.name)>=0)return!1;let h=!0;return c.eachChild(p=>{h&&!mf(p,s)&&(h=!1)}),h}function s0(c){return{result:"success",value:c}}function vu(c){return{result:"error",value:c}}function ko(c){return c["property-type"]==="data-driven"||c["property-type"]==="cross-faded-data-driven"}function po(c){return!!c.expression&&c.expression.parameters.indexOf("zoom")>-1}function Rc(c){return!!c.expression&&c.expression.interpolated}function Ei(c){return c instanceof Number?"number":c instanceof String?"string":c instanceof Boolean?"boolean":Array.isArray(c)?"array":c===null?"null":typeof c}function Dh(c){return typeof c=="object"&&c!==null&&!Array.isArray(c)}function o0(c){return c}function a0(c,s){const h=s.type==="color",p=c.stops&&typeof c.stops[0][0]=="object",x=p||!(p||c.property!==void 0),C=c.type||(Rc(s)?"exponential":"interval");if(h||s.type==="padding"){const G=h?Yt.parse:ri.parse;(c=On({},c)).stops&&(c.stops=c.stops.map(Y=>[Y[0],G(Y[1])])),c.default=G(c.default?c.default:s.default)}if(c.colorSpace&&(T=c.colorSpace)!=="rgb"&&T!=="hcl"&&T!=="lab")throw new Error(`Unknown color space: "${c.colorSpace}"`);var T;let R,F,U;if(C==="exponential")R=Mt;else if(C==="interval")R=et;else if(C==="categorical"){R=al,F=Object.create(null);for(const G of c.stops)F[G[0]]=G[1];U=typeof c.stops[0][0]}else{if(C!=="identity")throw new Error(`Unknown function type "${C}"`);R=gt}if(p){const G={},Y=[];for(let ue=0;ue<c.stops.length;ue++){const pe=c.stops[ue],Ae=pe[0].zoom;G[Ae]===void 0&&(G[Ae]={zoom:Ae,type:c.type,property:c.property,default:c.default,stops:[]},Y.push(Ae)),G[Ae].stops.push([pe[0].value,pe[1]])}const ee=[];for(const ue of Y)ee.push([G[ue].zoom,a0(G[ue],s)]);const ae={name:"linear"};return{kind:"composite",interpolationType:ae,interpolationFactor:Xs.interpolationFactor.bind(void 0,ae),zoomStops:ee.map(ue=>ue[0]),evaluate:({zoom:ue},pe)=>Mt({stops:ee,base:c.base},s,ue).evaluate(ue,pe)}}if(x){const G=C==="exponential"?{name:"exponential",base:c.base!==void 0?c.base:1}:null;return{kind:"camera",interpolationType:G,interpolationFactor:Xs.interpolationFactor.bind(void 0,G),zoomStops:c.stops.map(Y=>Y[0]),evaluate:({zoom:Y})=>R(c,s,Y,F,U)}}return{kind:"source",evaluate(G,Y){const ee=Y&&Y.properties?Y.properties[c.property]:void 0;return ee===void 0?Lc(c.default,s.default):R(c,s,ee,F,U)}}}function Lc(c,s,h){return c!==void 0?c:s!==void 0?s:h!==void 0?h:void 0}function al(c,s,h,p,x){return Lc(typeof h===x?p[h]:void 0,c.default,s.default)}function et(c,s,h){if(Ei(h)!=="number")return Lc(c.default,s.default);const p=c.stops.length;if(p===1||h<=c.stops[0][0])return c.stops[0][1];if(h>=c.stops[p-1][0])return c.stops[p-1][1];const x=mu(c.stops.map(C=>C[0]),h);return c.stops[x][1]}function Mt(c,s,h){const p=c.base!==void 0?c.base:1;if(Ei(h)!=="number")return Lc(c.default,s.default);const x=c.stops.length;if(x===1||h<=c.stops[0][0])return c.stops[0][1];if(h>=c.stops[x-1][0])return c.stops[x-1][1];const C=mu(c.stops.map(G=>G[0]),h),T=function(G,Y,ee,ae){const ue=ae-ee,pe=G-ee;return ue===0?0:Y===1?pe/ue:(Math.pow(Y,pe)-1)/(Math.pow(Y,ue)-1)}(h,p,c.stops[C][0],c.stops[C+1][0]),R=c.stops[C][1],F=c.stops[C+1][1],U=ho[s.type]||o0;return typeof R.evaluate=="function"?{evaluate(...G){const Y=R.evaluate.apply(void 0,G),ee=F.evaluate.apply(void 0,G);if(Y!==void 0&&ee!==void 0)return U(Y,ee,T,c.colorSpace)}}:U(R,F,T,c.colorSpace)}function gt(c,s,h){switch(s.type){case"color":h=Yt.parse(h);break;case"formatted":h=In.fromString(h.toString());break;case"resolvedImage":h=Ni.fromString(h.toString());break;case"padding":h=ri.parse(h);break;default:Ei(h)===s.type||s.type==="enum"&&s.values[h]||(h=void 0)}return Lc(h,c.default,s.default)}fo.register(Ic,{error:[{kind:"error"},[Tt],(c,[s])=>{throw new $i(s.evaluate(c))}],typeof:[Tt,[Ne],(c,[s])=>ne(di(s.evaluate(c)))],"to-rgba":[te(yt,4),[kn],(c,[s])=>{const[h,p,x,C]=s.evaluate(c).rgb;return[255*h,255*p,255*x,C]}],rgb:[kn,[yt,yt,yt],Ul],rgba:[kn,[yt,yt,yt,yt],Ul],has:{type:Vt,overloads:[[[Tt],(c,[s])=>pf(s.evaluate(c),c.properties())],[[Tt,ii],(c,[s,h])=>pf(s.evaluate(c),h.evaluate(c))]]},get:{type:Ne,overloads:[[[Tt],(c,[s])=>Qp(s.evaluate(c),c.properties())],[[Tt,ii],(c,[s,h])=>Qp(s.evaluate(c),h.evaluate(c))]]},"feature-state":[Ne,[Tt],(c,[s])=>Qp(s.evaluate(c),c.featureState||{})],properties:[ii,[],c=>c.properties()],"geometry-type":[Tt,[],c=>c.geometryType()],id:[Ne,[],c=>c.id()],zoom:[yt,[],c=>c.globals.zoom],"heatmap-density":[yt,[],c=>c.globals.heatmapDensity||0],"line-progress":[yt,[],c=>c.globals.lineProgress||0],accumulated:[Ne,[],c=>c.globals.accumulated===void 0?null:c.globals.accumulated],"+":[yt,ol(yt),(c,s)=>{let h=0;for(const p of s)h+=p.evaluate(c);return h}],"*":[yt,ol(yt),(c,s)=>{let h=1;for(const p of s)h*=p.evaluate(c);return h}],"-":{type:yt,overloads:[[[yt,yt],(c,[s,h])=>s.evaluate(c)-h.evaluate(c)],[[yt],(c,[s])=>-s.evaluate(c)]]},"/":[yt,[yt,yt],(c,[s,h])=>s.evaluate(c)/h.evaluate(c)],"%":[yt,[yt,yt],(c,[s,h])=>s.evaluate(c)%h.evaluate(c)],ln2:[yt,[],()=>Math.LN2],pi:[yt,[],()=>Math.PI],e:[yt,[],()=>Math.E],"^":[yt,[yt,yt],(c,[s,h])=>Math.pow(s.evaluate(c),h.evaluate(c))],sqrt:[yt,[yt],(c,[s])=>Math.sqrt(s.evaluate(c))],log10:[yt,[yt],(c,[s])=>Math.log(s.evaluate(c))/Math.LN10],ln:[yt,[yt],(c,[s])=>Math.log(s.evaluate(c))],log2:[yt,[yt],(c,[s])=>Math.log(s.evaluate(c))/Math.LN2],sin:[yt,[yt],(c,[s])=>Math.sin(s.evaluate(c))],cos:[yt,[yt],(c,[s])=>Math.cos(s.evaluate(c))],tan:[yt,[yt],(c,[s])=>Math.tan(s.evaluate(c))],asin:[yt,[yt],(c,[s])=>Math.asin(s.evaluate(c))],acos:[yt,[yt],(c,[s])=>Math.acos(s.evaluate(c))],atan:[yt,[yt],(c,[s])=>Math.atan(s.evaluate(c))],min:[yt,ol(yt),(c,s)=>Math.min(...s.map(h=>h.evaluate(c)))],max:[yt,ol(yt),(c,s)=>Math.max(...s.map(h=>h.evaluate(c)))],abs:[yt,[yt],(c,[s])=>Math.abs(s.evaluate(c))],round:[yt,[yt],(c,[s])=>{const h=s.evaluate(c);return h<0?-Math.round(-h):Math.round(h)}],floor:[yt,[yt],(c,[s])=>Math.floor(s.evaluate(c))],ceil:[yt,[yt],(c,[s])=>Math.ceil(s.evaluate(c))],"filter-==":[Vt,[Tt,Ne],(c,[s,h])=>c.properties()[s.value]===h.value],"filter-id-==":[Vt,[Ne],(c,[s])=>c.id()===s.value],"filter-type-==":[Vt,[Tt],(c,[s])=>c.geometryType()===s.value],"filter-<":[Vt,[Tt,Ne],(c,[s,h])=>{const p=c.properties()[s.value],x=h.value;return typeof p==typeof x&&p<x}],"filter-id-<":[Vt,[Ne],(c,[s])=>{const h=c.id(),p=s.value;return typeof h==typeof p&&h<p}],"filter->":[Vt,[Tt,Ne],(c,[s,h])=>{const p=c.properties()[s.value],x=h.value;return typeof p==typeof x&&p>x}],"filter-id->":[Vt,[Ne],(c,[s])=>{const h=c.id(),p=s.value;return typeof h==typeof p&&h>p}],"filter-<=":[Vt,[Tt,Ne],(c,[s,h])=>{const p=c.properties()[s.value],x=h.value;return typeof p==typeof x&&p<=x}],"filter-id-<=":[Vt,[Ne],(c,[s])=>{const h=c.id(),p=s.value;return typeof h==typeof p&&h<=p}],"filter->=":[Vt,[Tt,Ne],(c,[s,h])=>{const p=c.properties()[s.value],x=h.value;return typeof p==typeof x&&p>=x}],"filter-id->=":[Vt,[Ne],(c,[s])=>{const h=c.id(),p=s.value;return typeof h==typeof p&&h>=p}],"filter-has":[Vt,[Ne],(c,[s])=>s.value in c.properties()],"filter-has-id":[Vt,[],c=>c.id()!==null&&c.id()!==void 0],"filter-type-in":[Vt,[te(Tt)],(c,[s])=>s.value.indexOf(c.geometryType())>=0],"filter-id-in":[Vt,[te(Ne)],(c,[s])=>s.value.indexOf(c.id())>=0],"filter-in-small":[Vt,[Tt,te(Ne)],(c,[s,h])=>h.value.indexOf(c.properties()[s.value])>=0],"filter-in-large":[Vt,[Tt,te(Ne)],(c,[s,h])=>function(p,x,C,T){for(;C<=T;){const R=C+T>>1;if(x[R]===p)return!0;x[R]>p?T=R-1:C=R+1}return!1}(c.properties()[s.value],h.value,0,h.value.length-1)],all:{type:Vt,overloads:[[[Vt,Vt],(c,[s,h])=>s.evaluate(c)&&h.evaluate(c)],[ol(Vt),(c,s)=>{for(const h of s)if(!h.evaluate(c))return!1;return!0}]]},any:{type:Vt,overloads:[[[Vt,Vt],(c,[s,h])=>s.evaluate(c)||h.evaluate(c)],[ol(Vt),(c,s)=>{for(const h of s)if(h.evaluate(c))return!0;return!1}]]},"!":[Vt,[Vt],(c,[s])=>!s.evaluate(c)],"is-supported-script":[Vt,[Tt],(c,[s])=>{const h=c.globals&&c.globals.isSupportedScript;return!h||h(s.evaluate(c))}],upcase:[Tt,[Tt],(c,[s])=>s.evaluate(c).toUpperCase()],downcase:[Tt,[Tt],(c,[s])=>s.evaluate(c).toLowerCase()],concat:[Tt,ol(Ne),(c,s)=>s.map(h=>li(h.evaluate(c))).join("")],"resolved-locale":[Tt,[Gt],(c,[s])=>s.evaluate(c).resolvedLocale()]});class _n{constructor(s,h){var p;this.expression=s,this._warningHistory={},this._evaluator=new Qr,this._defaultValue=h?(p=h).type==="color"&&Dh(p.default)?new Yt(0,0,0,0):p.type==="color"?Yt.parse(p.default)||null:p.type==="padding"?ri.parse(p.default)||null:p.type==="variableAnchorOffsetCollection"?mi.parse(p.default)||null:p.default===void 0?null:p.default:null,this._enumValues=h&&h.type==="enum"?h.values:null}evaluateWithoutErrorHandling(s,h,p,x,C,T){return this._evaluator.globals=s,this._evaluator.feature=h,this._evaluator.featureState=p,this._evaluator.canonical=x,this._evaluator.availableImages=C||null,this._evaluator.formattedSection=T,this.expression.evaluate(this._evaluator)}evaluate(s,h,p,x,C,T){this._evaluator.globals=s,this._evaluator.feature=h||null,this._evaluator.featureState=p||null,this._evaluator.canonical=x,this._evaluator.availableImages=C||null,this._evaluator.formattedSection=T||null;try{const R=this.expression.evaluate(this._evaluator);if(R==null||typeof R=="number"&&R!=R)return this._defaultValue;if(this._enumValues&&!(R in this._enumValues))throw new $i(`Expected value to be one of ${Object.keys(this._enumValues).map(F=>JSON.stringify(F)).join(", ")}, but found ${JSON.stringify(R)} instead.`);return R}catch(R){return this._warningHistory[R.message]||(this._warningHistory[R.message]=!0,typeof console<"u"&&console.warn(R.message)),this._defaultValue}}}function Qn(c){return Array.isArray(c)&&c.length>0&&typeof c[0]=="string"&&c[0]in Ic}function gi(c,s){const h=new uo(Ic,kh,[],s?function(x){const C={color:kn,string:Tt,number:yt,enum:Tt,boolean:Vt,formatted:Et,padding:Ct,resolvedImage:Zt,variableAnchorOffsetCollection:xe};return x.type==="array"?te(C[x.value]||Ne,x.length):C[x.type]}(s):void 0),p=h.parse(c,void 0,void 0,void 0,s&&s.type==="string"?{typeAnnotation:"coerce"}:void 0);return p?s0(new _n(p,s)):vu(h.errors)}class Pr{constructor(s,h){this.kind=s,this._styleExpression=h,this.isStateDependent=s!=="constant"&&!Vl(h.expression)}evaluateWithoutErrorHandling(s,h,p,x,C,T){return this._styleExpression.evaluateWithoutErrorHandling(s,h,p,x,C,T)}evaluate(s,h,p,x,C,T){return this._styleExpression.evaluate(s,h,p,x,C,T)}}class Gi{constructor(s,h,p,x){this.kind=s,this.zoomStops=p,this._styleExpression=h,this.isStateDependent=s!=="camera"&&!Vl(h.expression),this.interpolationType=x}evaluateWithoutErrorHandling(s,h,p,x,C,T){return this._styleExpression.evaluateWithoutErrorHandling(s,h,p,x,C,T)}evaluate(s,h,p,x,C,T){return this._styleExpression.evaluate(s,h,p,x,C,T)}interpolationFactor(s,h,p){return this.interpolationType?Xs.interpolationFactor(this.interpolationType,s,h,p):0}}function gf(c,s){const h=gi(c,s);if(h.result==="error")return h;const p=h.value.expression,x=na(p);if(!x&&!ko(s))return vu([new Nt("","data expressions not supported")]);const C=mf(p,["zoom"]);if(!C&&!po(s))return vu([new Nt("","zoom expressions not supported")]);const T=ks(p);return T||C?T instanceof Nt?vu([T]):T instanceof Xs&&!Rc(s)?vu([new Nt("",'"interpolate" expressions cannot be used with this property')]):s0(T?new Gi(x?"camera":"composite",h.value,T.labels,T instanceof Xs?T.interpolation:void 0):new Pr(x?"constant":"source",h.value)):vu([new Nt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class vf{constructor(s,h){this._parameters=s,this._specification=h,On(this,a0(this._parameters,this._specification))}static deserialize(s){return new vf(s._parameters,s._specification)}static serialize(s){return{_parameters:s._parameters,_specification:s._specification}}}function ks(c){let s=null;if(c instanceof yi)s=ks(c.result);else if(c instanceof sf){for(const h of c.args)if(s=ks(h),s)break}else(c instanceof gu||c instanceof Xs)&&c.input instanceof fo&&c.input.name==="zoom"&&(s=c);return s instanceof Nt||c.eachChild(h=>{const p=ks(h);p instanceof Nt?s=p:!s&&p?s=new Nt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):s&&p&&s!==p&&(s=new Nt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),s}function ll(c){if(c===!0||c===!1)return!0;if(!Array.isArray(c)||c.length===0)return!1;switch(c[0]){case"has":return c.length>=2&&c[1]!=="$id"&&c[1]!=="$type";case"in":return c.length>=3&&(typeof c[1]!="string"||Array.isArray(c[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return c.length!==3||Array.isArray(c[1])||Array.isArray(c[2]);case"any":case"all":for(const s of c.slice(1))if(!ll(s)&&typeof s!="boolean")return!1;return!0;default:return!0}}const yf={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Nr(c){if(c==null)return{filter:()=>!0,needGeometry:!1};ll(c)||(c=Ri(c));const s=gi(c,yf);if(s.result==="error")throw new Error(s.value.map(h=>`${h.key}: ${h.message}`).join(", "));return{filter:(h,p,x)=>s.value.evaluate(h,p,{},x),needGeometry:yu(c)}}function $l(c,s){return c<s?-1:c>s?1:0}function yu(c){if(!Array.isArray(c))return!1;if(c[0]==="within"||c[0]==="distance")return!0;for(let s=1;s<c.length;s++)if(yu(c[s]))return!0;return!1}function Ri(c){if(!c)return!0;const s=c[0];return c.length<=1?s!=="any":s==="=="?em(c[1],c[2],"=="):s==="!="?xu(em(c[1],c[2],"==")):s==="<"||s===">"||s==="<="||s===">="?em(c[1],c[2],s):s==="any"?(h=c.slice(1),["any"].concat(h.map(Ri))):s==="all"?["all"].concat(c.slice(1).map(Ri)):s==="none"?["all"].concat(c.slice(1).map(Ri).map(xu)):s==="in"?kc(c[1],c.slice(2)):s==="!in"?xu(kc(c[1],c.slice(2))):s==="has"?_u(c[1]):s!=="!has"||xu(_u(c[1]));var h}function em(c,s,h){switch(c){case"$type":return[`filter-type-${h}`,s];case"$id":return[`filter-id-${h}`,s];default:return[`filter-${h}`,c,s]}}function kc(c,s){if(s.length===0)return!1;switch(c){case"$type":return["filter-type-in",["literal",s]];case"$id":return["filter-id-in",["literal",s]];default:return s.length>200&&!s.some(h=>typeof h!=typeof s[0])?["filter-in-large",c,["literal",s.sort($l)]]:["filter-in-small",c,["literal",s]]}}function _u(c){switch(c){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",c]}}function xu(c){return["!",c]}function tm(c){const s=typeof c;if(s==="number"||s==="boolean"||s==="string"||c==null)return JSON.stringify(c);if(Array.isArray(c)){let x="[";for(const C of c)x+=`${tm(C)},`;return`${x}]`}const h=Object.keys(c).sort();let p="{";for(let x=0;x<h.length;x++)p+=`${JSON.stringify(h[x])}:${tm(c[h[x]])},`;return`${p}}`}function nm(c){let s="";for(const h of xt)s+=`/${tm(c[h])}`;return s}function Oh(c){const s=c.value;return s?[new it(c.key,s,"constants have been deprecated as of v8")]:[]}function Ti(c){return c instanceof Number||c instanceof String||c instanceof Boolean?c.valueOf():c}function Sa(c){if(Array.isArray(c))return c.map(Sa);if(c instanceof Object&&!(c instanceof Number||c instanceof String||c instanceof Boolean)){const s={};for(const h in c)s[h]=Sa(c[h]);return s}return Ti(c)}function Ds(c){const s=c.key,h=c.value,p=c.valueSpec||{},x=c.objectElementValidators||{},C=c.style,T=c.styleSpec,R=c.validateSpec;let F=[];const U=Ei(h);if(U!=="object")return[new it(s,h,`object expected, ${U} found`)];for(const G in h){const Y=G.split(".")[0],ee=p[Y]||p["*"];let ae;if(x[Y])ae=x[Y];else if(p[Y])ae=R;else if(x["*"])ae=x["*"];else{if(!p["*"]){F.push(new it(s,h[G],`unknown property "${G}"`));continue}ae=R}F=F.concat(ae({key:(s&&`${s}.`)+G,value:h[G],valueSpec:ee,style:C,styleSpec:T,object:h,objectKey:G,validateSpec:R},h))}for(const G in p)x[G]||p[G].required&&p[G].default===void 0&&h[G]===void 0&&F.push(new it(s,h,`missing required property "${G}"`));return F}function Dc(c){const s=c.value,h=c.valueSpec,p=c.style,x=c.styleSpec,C=c.key,T=c.arrayElementValidator||c.validateSpec;if(Ei(s)!=="array")return[new it(C,s,`array expected, ${Ei(s)} found`)];if(h.length&&s.length!==h.length)return[new it(C,s,`array length ${h.length} expected, length ${s.length} found`)];if(h["min-length"]&&s.length<h["min-length"])return[new it(C,s,`array length at least ${h["min-length"]} expected, length ${s.length} found`)];let R={type:h.value,values:h.values};x.$version<7&&(R.function=h.function),Ei(h.value)==="object"&&(R=h.value);let F=[];for(let U=0;U<s.length;U++)F=F.concat(T({array:s,arrayIndex:U,value:s[U],valueSpec:R,validateSpec:c.validateSpec,style:p,styleSpec:x,key:`${C}[${U}]`}));return F}function bu(c){const s=c.key,h=c.value,p=c.valueSpec;let x=Ei(h);return x==="number"&&h!=h&&(x="NaN"),x!=="number"?[new it(s,h,`number expected, ${x} found`)]:"minimum"in p&&h<p.minimum?[new it(s,h,`${h} is less than the minimum value ${p.minimum}`)]:"maximum"in p&&h>p.maximum?[new it(s,h,`${h} is greater than the maximum value ${p.maximum}`)]:[]}function _f(c){const s=c.valueSpec,h=Ti(c.value.type);let p,x,C,T={};const R=h!=="categorical"&&c.value.property===void 0,F=!R,U=Ei(c.value.stops)==="array"&&Ei(c.value.stops[0])==="array"&&Ei(c.value.stops[0][0])==="object",G=Ds({key:c.key,value:c.value,valueSpec:c.styleSpec.function,validateSpec:c.validateSpec,style:c.style,styleSpec:c.styleSpec,objectElementValidators:{stops:function(ae){if(h==="identity")return[new it(ae.key,ae.value,'identity function may not have a "stops" property')];let ue=[];const pe=ae.value;return ue=ue.concat(Dc({key:ae.key,value:pe,valueSpec:ae.valueSpec,validateSpec:ae.validateSpec,style:ae.style,styleSpec:ae.styleSpec,arrayElementValidator:Y})),Ei(pe)==="array"&&pe.length===0&&ue.push(new it(ae.key,pe,"array must have at least one stop")),ue},default:function(ae){return ae.validateSpec({key:ae.key,value:ae.value,valueSpec:s,validateSpec:ae.validateSpec,style:ae.style,styleSpec:ae.styleSpec})}}});return h==="identity"&&R&&G.push(new it(c.key,c.value,'missing required property "property"')),h==="identity"||c.value.stops||G.push(new it(c.key,c.value,'missing required property "stops"')),h==="exponential"&&c.valueSpec.expression&&!Rc(c.valueSpec)&&G.push(new it(c.key,c.value,"exponential functions not supported")),c.styleSpec.$version>=8&&(F&&!ko(c.valueSpec)?G.push(new it(c.key,c.value,"property functions not supported")):R&&!po(c.valueSpec)&&G.push(new it(c.key,c.value,"zoom functions not supported"))),h!=="categorical"&&!U||c.value.property!==void 0||G.push(new it(c.key,c.value,'"property" property is required')),G;function Y(ae){let ue=[];const pe=ae.value,Ae=ae.key;if(Ei(pe)!=="array")return[new it(Ae,pe,`array expected, ${Ei(pe)} found`)];if(pe.length!==2)return[new it(Ae,pe,`array length 2 expected, length ${pe.length} found`)];if(U){if(Ei(pe[0])!=="object")return[new it(Ae,pe,`object expected, ${Ei(pe[0])} found`)];if(pe[0].zoom===void 0)return[new it(Ae,pe,"object stop key must have zoom")];if(pe[0].value===void 0)return[new it(Ae,pe,"object stop key must have value")];if(C&&C>Ti(pe[0].zoom))return[new it(Ae,pe[0].zoom,"stop zoom values must appear in ascending order")];Ti(pe[0].zoom)!==C&&(C=Ti(pe[0].zoom),x=void 0,T={}),ue=ue.concat(Ds({key:`${Ae}[0]`,value:pe[0],valueSpec:{zoom:{}},validateSpec:ae.validateSpec,style:ae.style,styleSpec:ae.styleSpec,objectElementValidators:{zoom:bu,value:ee}}))}else ue=ue.concat(ee({key:`${Ae}[0]`,value:pe[0],validateSpec:ae.validateSpec,style:ae.style,styleSpec:ae.styleSpec},pe));return Qn(Sa(pe[1]))?ue.concat([new it(`${Ae}[1]`,pe[1],"expressions are not allowed in function stops.")]):ue.concat(ae.validateSpec({key:`${Ae}[1]`,value:pe[1],valueSpec:s,validateSpec:ae.validateSpec,style:ae.style,styleSpec:ae.styleSpec}))}function ee(ae,ue){const pe=Ei(ae.value),Ae=Ti(ae.value),Oe=ae.value!==null?ae.value:ue;if(p){if(pe!==p)return[new it(ae.key,Oe,`${pe} stop domain type must match previous stop domain type ${p}`)]}else p=pe;if(pe!=="number"&&pe!=="string"&&pe!=="boolean")return[new it(ae.key,Oe,"stop domain value must be a number, string, or boolean")];if(pe!=="number"&&h!=="categorical"){let tt=`number expected, ${pe} found`;return ko(s)&&h===void 0&&(tt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new it(ae.key,Oe,tt)]}return h!=="categorical"||pe!=="number"||isFinite(Ae)&&Math.floor(Ae)===Ae?h!=="categorical"&&pe==="number"&&x!==void 0&&Ae<x?[new it(ae.key,Oe,"stop domain values must appear in ascending order")]:(x=Ae,h==="categorical"&&Ae in T?[new it(ae.key,Oe,"stop domain values must be unique")]:(T[Ae]=!0,[])):[new it(ae.key,Oe,`integer expected, found ${Ae}`)]}}function Ea(c){const s=(c.expressionContext==="property"?gf:gi)(Sa(c.value),c.valueSpec);if(s.result==="error")return s.value.map(p=>new it(`${c.key}${p.key}`,c.value,p.message));const h=s.value.expression||s.value._styleExpression.expression;if(c.expressionContext==="property"&&c.propertyKey==="text-font"&&!h.outputDefined())return[new it(c.key,c.value,`Invalid data expression for "${c.propertyKey}". Output values must be contained as literals within the expression.`)];if(c.expressionContext==="property"&&c.propertyType==="layout"&&!Vl(h))return[new it(c.key,c.value,'"feature-state" data expressions are not supported with layout properties.')];if(c.expressionContext==="filter"&&!Vl(h))return[new it(c.key,c.value,'"feature-state" data expressions are not supported with filters.')];if(c.expressionContext&&c.expressionContext.indexOf("cluster")===0){if(!mf(h,["zoom","feature-state"]))return[new it(c.key,c.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(c.expressionContext==="cluster-initial"&&!na(h))return[new it(c.key,c.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function wu(c){const s=c.key,h=c.value,p=c.valueSpec,x=[];return Array.isArray(p.values)?p.values.indexOf(Ti(h))===-1&&x.push(new it(s,h,`expected one of [${p.values.join(", ")}], ${JSON.stringify(h)} found`)):Object.keys(p.values).indexOf(Ti(h))===-1&&x.push(new it(s,h,`expected one of [${Object.keys(p.values).join(", ")}], ${JSON.stringify(h)} found`)),x}function cl(c){return ll(Sa(c.value))?Ea(On({},c,{expressionContext:"filter",valueSpec:{value:"boolean"}})):ia(c)}function ia(c){const s=c.value,h=c.key;if(Ei(s)!=="array")return[new it(h,s,`array expected, ${Ei(s)} found`)];const p=c.styleSpec;let x,C=[];if(s.length<1)return[new it(h,s,"filter array must have at least 1 element")];switch(C=C.concat(wu({key:`${h}[0]`,value:s[0],valueSpec:p.filter_operator,style:c.style,styleSpec:c.styleSpec})),Ti(s[0])){case"<":case"<=":case">":case">=":s.length>=2&&Ti(s[1])==="$type"&&C.push(new it(h,s,`"$type" cannot be use with operator "${s[0]}"`));case"==":case"!=":s.length!==3&&C.push(new it(h,s,`filter array for operator "${s[0]}" must have 3 elements`));case"in":case"!in":s.length>=2&&(x=Ei(s[1]),x!=="string"&&C.push(new it(`${h}[1]`,s[1],`string expected, ${x} found`)));for(let T=2;T<s.length;T++)x=Ei(s[T]),Ti(s[1])==="$type"?C=C.concat(wu({key:`${h}[${T}]`,value:s[T],valueSpec:p.geometry_type,style:c.style,styleSpec:c.styleSpec})):x!=="string"&&x!=="number"&&x!=="boolean"&&C.push(new it(`${h}[${T}]`,s[T],`string, number, or boolean expected, ${x} found`));break;case"any":case"all":case"none":for(let T=1;T<s.length;T++)C=C.concat(ia({key:`${h}[${T}]`,value:s[T],style:c.style,styleSpec:c.styleSpec}));break;case"has":case"!has":x=Ei(s[1]),s.length!==2?C.push(new it(h,s,`filter array for "${s[0]}" operator must have 2 elements`)):x!=="string"&&C.push(new it(`${h}[1]`,s[1],`string expected, ${x} found`))}return C}function Su(c,s){const h=c.key,p=c.validateSpec,x=c.style,C=c.styleSpec,T=c.value,R=c.objectKey,F=C[`${s}_${c.layerType}`];if(!F)return[];const U=R.match(/^(.*)-transition$/);if(s==="paint"&&U&&F[U[1]]&&F[U[1]].transition)return p({key:h,value:T,valueSpec:C.transition,style:x,styleSpec:C});const G=c.valueSpec||F[R];if(!G)return[new it(h,T,`unknown property "${R}"`)];let Y;if(Ei(T)==="string"&&ko(G)&&!G.tokens&&(Y=/^{([^}]+)}$/.exec(T)))return[new it(h,T,`"${R}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(Y[1])} }\`.`)];const ee=[];return c.layerType==="symbol"&&(R==="text-field"&&x&&!x.glyphs&&ee.push(new it(h,T,'use of "text-field" requires a style "glyphs" property')),R==="text-font"&&Dh(Sa(T))&&Ti(T.type)==="identity"&&ee.push(new it(h,T,'"text-font" does not support identity functions'))),ee.concat(p({key:c.key,value:T,valueSpec:G,style:x,styleSpec:C,expressionContext:"property",propertyType:s,propertyKey:R}))}function im(c){return Su(c,"paint")}function rm(c){return Su(c,"layout")}function sm(c){let s=[];const h=c.value,p=c.key,x=c.style,C=c.styleSpec;h.type||h.ref||s.push(new it(p,h,'either "type" or "ref" is required'));let T=Ti(h.type);const R=Ti(h.ref);if(h.id){const F=Ti(h.id);for(let U=0;U<c.arrayIndex;U++){const G=x.layers[U];Ti(G.id)===F&&s.push(new it(p,h.id,`duplicate layer id "${h.id}", previously used at line ${G.id.__line__}`))}}if("ref"in h){let F;["type","source","source-layer","filter","layout"].forEach(U=>{U in h&&s.push(new it(p,h[U],`"${U}" is prohibited for ref layers`))}),x.layers.forEach(U=>{Ti(U.id)===R&&(F=U)}),F?F.ref?s.push(new it(p,h.ref,"ref cannot reference another ref layer")):T=Ti(F.type):s.push(new it(p,h.ref,`ref layer "${R}" not found`))}else if(T!=="background")if(h.source){const F=x.sources&&x.sources[h.source],U=F&&Ti(F.type);F?U==="vector"&&T==="raster"?s.push(new it(p,h.source,`layer "${h.id}" requires a raster source`)):U!=="raster-dem"&&T==="hillshade"?s.push(new it(p,h.source,`layer "${h.id}" requires a raster-dem source`)):U==="raster"&&T!=="raster"?s.push(new it(p,h.source,`layer "${h.id}" requires a vector source`)):U!=="vector"||h["source-layer"]?U==="raster-dem"&&T!=="hillshade"?s.push(new it(p,h.source,"raster-dem source can only be used with layer type 'hillshade'.")):T!=="line"||!h.paint||!h.paint["line-gradient"]||U==="geojson"&&F.lineMetrics||s.push(new it(p,h,`layer "${h.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):s.push(new it(p,h,`layer "${h.id}" must specify a "source-layer"`)):s.push(new it(p,h.source,`source "${h.source}" not found`))}else s.push(new it(p,h,'missing required property "source"'));return s=s.concat(Ds({key:p,value:h,valueSpec:C.layer,style:c.style,styleSpec:c.styleSpec,validateSpec:c.validateSpec,objectElementValidators:{"*":()=>[],type:()=>c.validateSpec({key:`${p}.type`,value:h.type,valueSpec:C.layer.type,style:c.style,styleSpec:c.styleSpec,validateSpec:c.validateSpec,object:h,objectKey:"type"}),filter:cl,layout:F=>Ds({layer:h,key:F.key,value:F.value,style:F.style,styleSpec:F.styleSpec,validateSpec:F.validateSpec,objectElementValidators:{"*":U=>rm(On({layerType:T},U))}}),paint:F=>Ds({layer:h,key:F.key,value:F.value,style:F.style,styleSpec:F.styleSpec,validateSpec:F.validateSpec,objectElementValidators:{"*":U=>im(On({layerType:T},U))}})}})),s}function Do(c){const s=c.value,h=c.key,p=Ei(s);return p!=="string"?[new it(h,s,`string expected, ${p} found`)]:[]}const Eu={promoteId:function({key:c,value:s}){if(Ei(s)==="string")return Do({key:c,value:s});{const h=[];for(const p in s)h.push(...Do({key:`${c}.${p}`,value:s[p]}));return h}}};function xf(c){const s=c.value,h=c.key,p=c.styleSpec,x=c.style,C=c.validateSpec;if(!s.type)return[new it(h,s,'"type" is required')];const T=Ti(s.type);let R;switch(T){case"vector":case"raster":return R=Ds({key:h,value:s,valueSpec:p[`source_${T.replace("-","_")}`],style:c.style,styleSpec:p,objectElementValidators:Eu,validateSpec:C}),R;case"raster-dem":return R=function(F){var U;const G=(U=F.sourceName)!==null&&U!==void 0?U:"",Y=F.value,ee=F.styleSpec,ae=ee.source_raster_dem,ue=F.style;let pe=[];const Ae=Ei(Y);if(Y===void 0)return pe;if(Ae!=="object")return pe.push(new it("source_raster_dem",Y,`object expected, ${Ae} found`)),pe;const Oe=Ti(Y.encoding)==="custom",tt=["redFactor","greenFactor","blueFactor","baseShift"],Le=F.value.encoding?`"${F.value.encoding}"`:"Default";for(const Qe in Y)!Oe&&tt.includes(Qe)?pe.push(new it(Qe,Y[Qe],`In "${G}": "${Qe}" is only valid when "encoding" is set to "custom". ${Le} encoding found`)):ae[Qe]?pe=pe.concat(F.validateSpec({key:Qe,value:Y[Qe],valueSpec:ae[Qe],validateSpec:F.validateSpec,style:ue,styleSpec:ee})):pe.push(new it(Qe,Y[Qe],`unknown property "${Qe}"`));return pe}({sourceName:h,value:s,style:c.style,styleSpec:p,validateSpec:C}),R;case"geojson":if(R=Ds({key:h,value:s,valueSpec:p.source_geojson,style:x,styleSpec:p,validateSpec:C,objectElementValidators:Eu}),s.cluster)for(const F in s.clusterProperties){const[U,G]=s.clusterProperties[F],Y=typeof U=="string"?[U,["accumulated"],["get",F]]:U;R.push(...Ea({key:`${h}.${F}.map`,value:G,expressionContext:"cluster-map"})),R.push(...Ea({key:`${h}.${F}.reduce`,value:Y,expressionContext:"cluster-reduce"}))}return R;case"video":return Ds({key:h,value:s,valueSpec:p.source_video,style:x,validateSpec:C,styleSpec:p});case"image":return Ds({key:h,value:s,valueSpec:p.source_image,style:x,validateSpec:C,styleSpec:p});case"canvas":return[new it(h,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return wu({key:`${h}.type`,value:s.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function om(c){const s=c.value,h=c.styleSpec,p=h.light,x=c.style;let C=[];const T=Ei(s);if(s===void 0)return C;if(T!=="object")return C=C.concat([new it("light",s,`object expected, ${T} found`)]),C;for(const R in s){const F=R.match(/^(.*)-transition$/);C=C.concat(F&&p[F[1]]&&p[F[1]].transition?c.validateSpec({key:R,value:s[R],valueSpec:h.transition,validateSpec:c.validateSpec,style:x,styleSpec:h}):p[R]?c.validateSpec({key:R,value:s[R],valueSpec:p[R],validateSpec:c.validateSpec,style:x,styleSpec:h}):[new it(R,s[R],`unknown property "${R}"`)])}return C}function am(c){const s=c.value,h=c.styleSpec,p=h.sky,x=c.style,C=Ei(s);if(s===void 0)return[];if(C!=="object")return[new it("sky",s,`object expected, ${C} found`)];let T=[];for(const R in s)T=T.concat(p[R]?c.validateSpec({key:R,value:s[R],valueSpec:p[R],style:x,styleSpec:h}):[new it(R,s[R],`unknown property "${R}"`)]);return T}function lm(c){const s=c.value,h=c.styleSpec,p=h.terrain,x=c.style;let C=[];const T=Ei(s);if(s===void 0)return C;if(T!=="object")return C=C.concat([new it("terrain",s,`object expected, ${T} found`)]),C;for(const R in s)C=C.concat(p[R]?c.validateSpec({key:R,value:s[R],valueSpec:p[R],validateSpec:c.validateSpec,style:x,styleSpec:h}):[new it(R,s[R],`unknown property "${R}"`)]);return C}function cm(c){let s=[];const h=c.value,p=c.key;if(Array.isArray(h)){const x=[],C=[];for(const T in h)h[T].id&&x.includes(h[T].id)&&s.push(new it(p,h,`all the sprites' ids must be unique, but ${h[T].id} is duplicated`)),x.push(h[T].id),h[T].url&&C.includes(h[T].url)&&s.push(new it(p,h,`all the sprites' URLs must be unique, but ${h[T].url} is duplicated`)),C.push(h[T].url),s=s.concat(Ds({key:`${p}[${T}]`,value:h[T],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:c.validateSpec}));return s}return Do({key:p,value:h})}const Ir={"*":()=>[],array:Dc,boolean:function(c){const s=c.value,h=c.key,p=Ei(s);return p!=="boolean"?[new it(h,s,`boolean expected, ${p} found`)]:[]},number:bu,color:function(c){const s=c.key,h=c.value,p=Ei(h);return p!=="string"?[new it(s,h,`color expected, ${p} found`)]:Yt.parse(String(h))?[]:[new it(s,h,`color expected, "${h}" found`)]},constants:Oh,enum:wu,filter:cl,function:_f,layer:sm,object:Ds,source:xf,light:om,sky:am,terrain:lm,projection:function(c){const s=c.value,h=c.styleSpec,p=h.projection,x=c.style,C=Ei(s);if(s===void 0)return[];if(C!=="object")return[new it("projection",s,`object expected, ${C} found`)];let T=[];for(const R in s)T=T.concat(p[R]?c.validateSpec({key:R,value:s[R],valueSpec:p[R],style:x,styleSpec:h}):[new it(R,s[R],`unknown property "${R}"`)]);return T},string:Do,formatted:function(c){return Do(c).length===0?[]:Ea(c)},resolvedImage:function(c){return Do(c).length===0?[]:Ea(c)},padding:function(c){const s=c.key,h=c.value;if(Ei(h)==="array"){if(h.length<1||h.length>4)return[new it(s,h,`padding requires 1 to 4 values; ${h.length} values found`)];const p={type:"number"};let x=[];for(let C=0;C<h.length;C++)x=x.concat(c.validateSpec({key:`${s}[${C}]`,value:h[C],validateSpec:c.validateSpec,valueSpec:p}));return x}return bu({key:s,value:h,valueSpec:{}})},variableAnchorOffsetCollection:function(c){const s=c.key,h=c.value,p=Ei(h),x=c.styleSpec;if(p!=="array"||h.length<1||h.length%2!=0)return[new it(s,h,"variableAnchorOffsetCollection requires a non-empty array of even length")];let C=[];for(let T=0;T<h.length;T+=2)C=C.concat(wu({key:`${s}[${T}]`,value:h[T],valueSpec:x.layout_symbol["text-anchor"]})),C=C.concat(Dc({key:`${s}[${T+1}]`,value:h[T+1],valueSpec:{length:2,value:"number"},validateSpec:c.validateSpec,style:c.style,styleSpec:x}));return C},sprite:cm};function jr(c){const s=c.value,h=c.valueSpec,p=c.styleSpec;return c.validateSpec=jr,h.expression&&Dh(Ti(s))?_f(c):h.expression&&Qn(Sa(s))?Ea(c):h.type&&Ir[h.type]?Ir[h.type](c):Ds(On({},c,{valueSpec:h.type?p[h.type]:h}))}function l0(c){const s=c.value,h=c.key,p=Do(c);return p.length||(s.indexOf("{fontstack}")===-1&&p.push(new it(h,s,'"glyphs" url must include a "{fontstack}" token')),s.indexOf("{range}")===-1&&p.push(new it(h,s,'"glyphs" url must include a "{range}" token'))),p}function Oo(c,s=Ue){let h=[];return h=h.concat(jr({key:"",value:c,valueSpec:s.$root,styleSpec:s,style:c,validateSpec:jr,objectElementValidators:{glyphs:l0,"*":()=>[]}})),c.constants&&(h=h.concat(Oh({key:"constants",value:c.constants}))),um(h)}function Fo(c){return function(s){return c({...s,validateSpec:jr})}}function um(c){return[].concat(c).sort((s,h)=>s.line-h.line)}function mo(c){return function(...s){return um(c.apply(this,s))}}Oo.source=mo(Fo(xf)),Oo.sprite=mo(Fo(cm)),Oo.glyphs=mo(Fo(l0)),Oo.light=mo(Fo(om)),Oo.sky=mo(Fo(am)),Oo.terrain=mo(Fo(lm)),Oo.layer=mo(Fo(sm)),Oo.filter=mo(Fo(cl)),Oo.paintProperty=mo(Fo(im)),Oo.layoutProperty=mo(Fo(rm));const go=Oo,hm=go.light,Hl=go.sky,Fh=go.paintProperty,zh=go.layoutProperty;function Mu(c,s){let h=!1;if(s&&s.length)for(const p of s)c.fire(new Ln(new Error(p.message))),h=!0;return h}class ra{constructor(s,h,p){const x=this.cells=[];if(s instanceof ArrayBuffer){this.arrayBuffer=s;const T=new Int32Array(this.arrayBuffer);s=T[0],this.d=(h=T[1])+2*(p=T[2]);for(let F=0;F<this.d*this.d;F++){const U=T[3+F],G=T[3+F+1];x.push(U===G?null:T.subarray(U,G))}const R=T[3+x.length+1];this.keys=T.subarray(T[3+x.length],R),this.bboxes=T.subarray(R),this.insert=this._insertReadonly}else{this.d=h+2*p;for(let T=0;T<this.d*this.d;T++)x.push([]);this.keys=[],this.bboxes=[]}this.n=h,this.extent=s,this.padding=p,this.scale=h/s,this.uid=0;const C=p/h*s;this.min=-C,this.max=s+C}insert(s,h,p,x,C){this._forEachCell(h,p,x,C,this._insertCell,this.uid++,void 0,void 0),this.keys.push(s),this.bboxes.push(h),this.bboxes.push(p),this.bboxes.push(x),this.bboxes.push(C)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(s,h,p,x,C,T){this.cells[C].push(T)}query(s,h,p,x,C){const T=this.min,R=this.max;if(s<=T&&h<=T&&R<=p&&R<=x&&!C)return Array.prototype.slice.call(this.keys);{const F=[];return this._forEachCell(s,h,p,x,this._queryCell,F,{},C),F}}_queryCell(s,h,p,x,C,T,R,F){const U=this.cells[C];if(U!==null){const G=this.keys,Y=this.bboxes;for(let ee=0;ee<U.length;ee++){const ae=U[ee];if(R[ae]===void 0){const ue=4*ae;(F?F(Y[ue+0],Y[ue+1],Y[ue+2],Y[ue+3]):s<=Y[ue+2]&&h<=Y[ue+3]&&p>=Y[ue+0]&&x>=Y[ue+1])?(R[ae]=!0,T.push(G[ae])):R[ae]=!1}}}}_forEachCell(s,h,p,x,C,T,R,F){const U=this._convertToCellCoord(s),G=this._convertToCellCoord(h),Y=this._convertToCellCoord(p),ee=this._convertToCellCoord(x);for(let ae=U;ae<=Y;ae++)for(let ue=G;ue<=ee;ue++){const pe=this.d*ue+ae;if((!F||F(this._convertFromCellCoord(ae),this._convertFromCellCoord(ue),this._convertFromCellCoord(ae+1),this._convertFromCellCoord(ue+1)))&&C.call(this,s,h,p,x,pe,T,R,F))return}}_convertFromCellCoord(s){return(s-this.padding)/this.scale}_convertToCellCoord(s){return Math.max(0,Math.min(this.d-1,Math.floor(s*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const s=this.cells,h=3+this.cells.length+1+1;let p=0;for(let T=0;T<this.cells.length;T++)p+=this.cells[T].length;const x=new Int32Array(h+p+this.keys.length+this.bboxes.length);x[0]=this.extent,x[1]=this.n,x[2]=this.padding;let C=h;for(let T=0;T<s.length;T++){const R=s[T];x[3+T]=C,x.set(R,C),C+=R.length}return x[3+s.length]=C,x.set(this.keys,C),C+=this.keys.length,x[3+s.length+1]=C,x.set(this.bboxes,C),C+=this.bboxes.length,x.buffer}static serialize(s,h){const p=s.toArrayBuffer();return h&&h.push(p),{buffer:p}}static deserialize(s){return new ra(s.buffer)}}const Ma={};function dn(c,s,h={}){if(Ma[c])throw new Error(`${c} is already registered.`);Object.defineProperty(s,"_classRegistryKey",{value:c,writeable:!1}),Ma[c]={klass:s,omit:h.omit||[],shallow:h.shallow||[]}}dn("Object",Object),dn("TransferableGridIndex",ra),dn("Color",Yt),dn("Error",Error),dn("AJAXError",Rt),dn("ResolvedImage",Ni),dn("StylePropertyFunction",vf),dn("StyleExpression",_n,{omit:["_evaluator"]}),dn("ZoomDependentExpression",Gi),dn("ZoomConstantExpression",Pr),dn("CompoundExpression",fo,{omit:["_evaluate"]});for(const c in Ic)Ic[c]._classRegistryKey||dn(`Expression_${c}`,Ic[c]);function c0(c){return c&&typeof ArrayBuffer<"u"&&(c instanceof ArrayBuffer||c.constructor&&c.constructor.name==="ArrayBuffer")}function dm(c){return c.$name||c.constructor._classRegistryKey}function u0(c){return!function(s){if(s===null||typeof s!="object")return!1;const h=dm(s);return!(!h||h==="Object")}(c)&&(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp||c instanceof Blob||c instanceof Error||c0(c)||Ce(c)||ArrayBuffer.isView(c)||c instanceof ImageData)}function Gl(c,s){if(u0(c))return(c0(c)||Ce(c))&&s&&s.push(c),ArrayBuffer.isView(c)&&s&&s.push(c.buffer),c instanceof ImageData&&s&&s.push(c.data.buffer),c;if(Array.isArray(c)){const C=[];for(const T of c)C.push(Gl(T,s));return C}if(typeof c!="object")throw new Error("can't serialize object of type "+typeof c);const h=dm(c);if(!h)throw new Error(`can't serialize object of unregistered class ${c.constructor.name}`);if(!Ma[h])throw new Error(`${h} is not registered.`);const{klass:p}=Ma[h],x=p.serialize?p.serialize(c,s):{};if(p.serialize){if(s&&x===s[s.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const C in c){if(!c.hasOwnProperty(C)||Ma[h].omit.indexOf(C)>=0)continue;const T=c[C];x[C]=Ma[h].shallow.indexOf(C)>=0?T:Gl(T,s)}c instanceof Error&&(x.message=c.message)}if(x.$name)throw new Error("$name property is reserved for worker serialization logic.");return h!=="Object"&&(x.$name=h),x}function Ks(c){if(u0(c))return c;if(Array.isArray(c))return c.map(Ks);if(typeof c!="object")throw new Error("can't deserialize object of type "+typeof c);const s=dm(c)||"Object";if(!Ma[s])throw new Error(`can't deserialize unregistered class ${s}`);const{klass:h}=Ma[s];if(!h)throw new Error(`can't deserialize unregistered class ${s}`);if(h.deserialize)return h.deserialize(c);const p=Object.create(h.prototype);for(const x of Object.keys(c)){if(x==="$name")continue;const C=c[x];p[x]=Ma[s].shallow.indexOf(x)>=0?C:Ks(C)}return p}class fm{constructor(){this.first=!0}update(s,h){const p=Math.floor(s);return this.first?(this.first=!1,this.lastIntegerZoom=p,this.lastIntegerZoomTime=0,this.lastZoom=s,this.lastFloorZoom=p,!0):(this.lastFloorZoom>p?(this.lastIntegerZoom=p+1,this.lastIntegerZoomTime=h):this.lastFloorZoom<p&&(this.lastIntegerZoom=p,this.lastIntegerZoomTime=h),s!==this.lastZoom&&(this.lastZoom=s,this.lastFloorZoom=p,!0))}}const oe={"Latin-1 Supplement":c=>c>=128&&c<=255,Arabic:c=>c>=1536&&c<=1791,"Arabic Supplement":c=>c>=1872&&c<=1919,"Arabic Extended-A":c=>c>=2208&&c<=2303,"Hangul Jamo":c=>c>=4352&&c<=4607,"Unified Canadian Aboriginal Syllabics":c=>c>=5120&&c<=5759,Khmer:c=>c>=6016&&c<=6143,"Unified Canadian Aboriginal Syllabics Extended":c=>c>=6320&&c<=6399,"General Punctuation":c=>c>=8192&&c<=8303,"Letterlike Symbols":c=>c>=8448&&c<=8527,"Number Forms":c=>c>=8528&&c<=8591,"Miscellaneous Technical":c=>c>=8960&&c<=9215,"Control Pictures":c=>c>=9216&&c<=9279,"Optical Character Recognition":c=>c>=9280&&c<=9311,"Enclosed Alphanumerics":c=>c>=9312&&c<=9471,"Geometric Shapes":c=>c>=9632&&c<=9727,"Miscellaneous Symbols":c=>c>=9728&&c<=9983,"Miscellaneous Symbols and Arrows":c=>c>=11008&&c<=11263,"CJK Radicals Supplement":c=>c>=11904&&c<=12031,"Kangxi Radicals":c=>c>=12032&&c<=12255,"Ideographic Description Characters":c=>c>=12272&&c<=12287,"CJK Symbols and Punctuation":c=>c>=12288&&c<=12351,Hiragana:c=>c>=12352&&c<=12447,Katakana:c=>c>=12448&&c<=12543,Bopomofo:c=>c>=12544&&c<=12591,"Hangul Compatibility Jamo":c=>c>=12592&&c<=12687,Kanbun:c=>c>=12688&&c<=12703,"Bopomofo Extended":c=>c>=12704&&c<=12735,"CJK Strokes":c=>c>=12736&&c<=12783,"Katakana Phonetic Extensions":c=>c>=12784&&c<=12799,"Enclosed CJK Letters and Months":c=>c>=12800&&c<=13055,"CJK Compatibility":c=>c>=13056&&c<=13311,"CJK Unified Ideographs Extension A":c=>c>=13312&&c<=19903,"Yijing Hexagram Symbols":c=>c>=19904&&c<=19967,"CJK Unified Ideographs":c=>c>=19968&&c<=40959,"Yi Syllables":c=>c>=40960&&c<=42127,"Yi Radicals":c=>c>=42128&&c<=42191,"Hangul Jamo Extended-A":c=>c>=43360&&c<=43391,"Hangul Syllables":c=>c>=44032&&c<=55215,"Hangul Jamo Extended-B":c=>c>=55216&&c<=55295,"Private Use Area":c=>c>=57344&&c<=63743,"CJK Compatibility Ideographs":c=>c>=63744&&c<=64255,"Arabic Presentation Forms-A":c=>c>=64336&&c<=65023,"Vertical Forms":c=>c>=65040&&c<=65055,"CJK Compatibility Forms":c=>c>=65072&&c<=65103,"Small Form Variants":c=>c>=65104&&c<=65135,"Arabic Presentation Forms-B":c=>c>=65136&&c<=65279,"Halfwidth and Fullwidth Forms":c=>c>=65280&&c<=65519};function Wl(c){for(const s of c)if(fi(s.charCodeAt(0)))return!0;return!1}function bf(c){for(const s of c)if(!vo(s.charCodeAt(0)))return!1;return!0}function vo(c){return!(oe.Arabic(c)||oe["Arabic Supplement"](c)||oe["Arabic Extended-A"](c)||oe["Arabic Presentation Forms-A"](c)||oe["Arabic Presentation Forms-B"](c))}function fi(c){return!(c!==746&&c!==747&&(c<4352||!(oe["Bopomofo Extended"](c)||oe.Bopomofo(c)||oe["CJK Compatibility Forms"](c)&&!(c>=65097&&c<=65103)||oe["CJK Compatibility Ideographs"](c)||oe["CJK Compatibility"](c)||oe["CJK Radicals Supplement"](c)||oe["CJK Strokes"](c)||!(!oe["CJK Symbols and Punctuation"](c)||c>=12296&&c<=12305||c>=12308&&c<=12319||c===12336)||oe["CJK Unified Ideographs Extension A"](c)||oe["CJK Unified Ideographs"](c)||oe["Enclosed CJK Letters and Months"](c)||oe["Hangul Compatibility Jamo"](c)||oe["Hangul Jamo Extended-A"](c)||oe["Hangul Jamo Extended-B"](c)||oe["Hangul Jamo"](c)||oe["Hangul Syllables"](c)||oe.Hiragana(c)||oe["Ideographic Description Characters"](c)||oe.Kanbun(c)||oe["Kangxi Radicals"](c)||oe["Katakana Phonetic Extensions"](c)||oe.Katakana(c)&&c!==12540||!(!oe["Halfwidth and Fullwidth Forms"](c)||c===65288||c===65289||c===65293||c>=65306&&c<=65310||c===65339||c===65341||c===65343||c>=65371&&c<=65503||c===65507||c>=65512&&c<=65519)||!(!oe["Small Form Variants"](c)||c>=65112&&c<=65118||c>=65123&&c<=65126)||oe["Unified Canadian Aboriginal Syllabics"](c)||oe["Unified Canadian Aboriginal Syllabics Extended"](c)||oe["Vertical Forms"](c)||oe["Yijing Hexagram Symbols"](c)||oe["Yi Syllables"](c)||oe["Yi Radicals"](c))))}function h0(c){return!(fi(c)||function(s){return!!(oe["Latin-1 Supplement"](s)&&(s===167||s===169||s===174||s===177||s===188||s===189||s===190||s===215||s===247)||oe["General Punctuation"](s)&&(s===8214||s===8224||s===8225||s===8240||s===8241||s===8251||s===8252||s===8258||s===8263||s===8264||s===8265||s===8273)||oe["Letterlike Symbols"](s)||oe["Number Forms"](s)||oe["Miscellaneous Technical"](s)&&(s>=8960&&s<=8967||s>=8972&&s<=8991||s>=8996&&s<=9e3||s===9003||s>=9085&&s<=9114||s>=9150&&s<=9165||s===9167||s>=9169&&s<=9179||s>=9186&&s<=9215)||oe["Control Pictures"](s)&&s!==9251||oe["Optical Character Recognition"](s)||oe["Enclosed Alphanumerics"](s)||oe["Geometric Shapes"](s)||oe["Miscellaneous Symbols"](s)&&!(s>=9754&&s<=9759)||oe["Miscellaneous Symbols and Arrows"](s)&&(s>=11026&&s<=11055||s>=11088&&s<=11097||s>=11192&&s<=11243)||oe["CJK Symbols and Punctuation"](s)||oe.Katakana(s)||oe["Private Use Area"](s)||oe["CJK Compatibility Forms"](s)||oe["Small Form Variants"](s)||oe["Halfwidth and Fullwidth Forms"](s)||s===8734||s===8756||s===8757||s>=9984&&s<=10087||s>=10102&&s<=10131||s===65532||s===65533)}(c))}function jl(c){return c>=1424&&c<=2303||oe["Arabic Presentation Forms-A"](c)||oe["Arabic Presentation Forms-B"](c)}function d0(c,s){return!(!s&&jl(c)||c>=2304&&c<=3583||c>=3840&&c<=4255||oe.Khmer(c))}function ul(c){for(const s of c)if(jl(s.charCodeAt(0)))return!0;return!1}const ql=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(c){this.pluginStatus=c.pluginStatus,this.pluginURL=c.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(c){this.applyArabicShaping=c.applyArabicShaping,this.processBidirectionalText=c.processBidirectionalText,this.processStyledBidirectionalText=c.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class tr{constructor(s,h){this.zoom=s,h?(this.now=h.now,this.fadeDuration=h.fadeDuration,this.zoomHistory=h.zoomHistory,this.transition=h.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new fm,this.transition={})}isSupportedScript(s){return function(h,p){for(const x of h)if(!d0(x.charCodeAt(0),p))return!1;return!0}(s,ql.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const s=this.zoom,h=s-Math.floor(s),p=this.crossFadingFactor();return s>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:h+(1-h)*p}:{fromScale:.5,toScale:1,t:1-(1-p)*h}}}class wf{constructor(s,h){this.property=s,this.value=h,this.expression=function(p,x){if(Dh(p))return new vf(p,x);if(Qn(p)){const C=gf(p,x);if(C.result==="error")throw new Error(C.value.map(T=>`${T.key}: ${T.message}`).join(", "));return C.value}{let C=p;return x.type==="color"&&typeof p=="string"?C=Yt.parse(p):x.type!=="padding"||typeof p!="number"&&!Array.isArray(p)?x.type==="variableAnchorOffsetCollection"&&Array.isArray(p)&&(C=mi.parse(p)):C=ri.parse(p),{kind:"constant",evaluate:()=>C}}}(h===void 0?s.specification.default:h,s.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(s,h,p){return this.property.possiblyEvaluate(this,s,h,p)}}class Cu{constructor(s){this.property=s,this.value=new wf(s,void 0)}transitioned(s,h){return new Ca(this.property,this.value,h,W({},s.transition,this.transition),s.now)}untransitioned(){return new Ca(this.property,this.value,null,{},0)}}class Tu{constructor(s){this._properties=s,this._values=Object.create(s.defaultTransitionablePropertyValues)}getValue(s){return se(this._values[s].value.value)}setValue(s,h){Object.prototype.hasOwnProperty.call(this._values,s)||(this._values[s]=new Cu(this._values[s].property)),this._values[s].value=new wf(this._values[s].property,h===null?void 0:se(h))}getTransition(s){return se(this._values[s].transition)}setTransition(s,h){Object.prototype.hasOwnProperty.call(this._values,s)||(this._values[s]=new Cu(this._values[s].property)),this._values[s].transition=se(h)||void 0}serialize(){const s={};for(const h of Object.keys(this._values)){const p=this.getValue(h);p!==void 0&&(s[h]=p);const x=this.getTransition(h);x!==void 0&&(s[`${h}-transition`]=x)}return s}transitioned(s,h){const p=new pm(this._properties);for(const x of Object.keys(this._values))p._values[x]=this._values[x].transitioned(s,h._values[x]);return p}untransitioned(){const s=new pm(this._properties);for(const h of Object.keys(this._values))s._values[h]=this._values[h].untransitioned();return s}}class Ca{constructor(s,h,p,x,C){this.property=s,this.value=h,this.begin=C+x.delay||0,this.end=this.begin+x.duration||0,s.specification.transition&&(x.delay||x.duration)&&(this.prior=p)}possiblyEvaluate(s,h,p){const x=s.now||0,C=this.value.possiblyEvaluate(s,h,p),T=this.prior;if(T){if(x>this.end)return this.prior=null,C;if(this.value.isDataDriven())return this.prior=null,C;if(x<this.begin)return T.possiblyEvaluate(s,h,p);{const R=(x-this.begin)/(this.end-this.begin);return this.property.interpolate(T.possiblyEvaluate(s,h,p),C,function(F){if(F<=0)return 0;if(F>=1)return 1;const U=F*F,G=U*F;return 4*(F<.5?G:3*(F-U)+G-.75)}(R))}}return C}}class pm{constructor(s){this._properties=s,this._values=Object.create(s.defaultTransitioningPropertyValues)}possiblyEvaluate(s,h,p){const x=new Sf(this._properties);for(const C of Object.keys(this._values))x._values[C]=this._values[C].possiblyEvaluate(s,h,p);return x}hasTransition(){for(const s of Object.keys(this._values))if(this._values[s].prior)return!0;return!1}}class Nh{constructor(s){this._properties=s,this._values=Object.create(s.defaultPropertyValues)}hasValue(s){return this._values[s].value!==void 0}getValue(s){return se(this._values[s].value)}setValue(s,h){this._values[s]=new wf(this._values[s].property,h===null?void 0:se(h))}serialize(){const s={};for(const h of Object.keys(this._values)){const p=this.getValue(h);p!==void 0&&(s[h]=p)}return s}possiblyEvaluate(s,h,p){const x=new Sf(this._properties);for(const C of Object.keys(this._values))x._values[C]=this._values[C].possiblyEvaluate(s,h,p);return x}}class Ta{constructor(s,h,p){this.property=s,this.value=h,this.parameters=p}isConstant(){return this.value.kind==="constant"}constantOr(s){return this.value.kind==="constant"?this.value.value:s}evaluate(s,h,p,x){return this.property.evaluate(this.value,this.parameters,s,h,p,x)}}class Sf{constructor(s){this._properties=s,this._values=Object.create(s.defaultPossiblyEvaluatedValues)}get(s){return this._values[s]}}class Tn{constructor(s){this.specification=s}possiblyEvaluate(s,h){if(s.isDataDriven())throw new Error("Value should not be data driven");return s.expression.evaluate(h)}interpolate(s,h,p){const x=ho[this.specification.type];return x?x(s,h,p):s}}class An{constructor(s,h){this.specification=s,this.overrides=h}possiblyEvaluate(s,h,p,x){return new Ta(this,s.expression.kind==="constant"||s.expression.kind==="camera"?{kind:"constant",value:s.expression.evaluate(h,null,{},p,x)}:s.expression,h)}interpolate(s,h,p){if(s.value.kind!=="constant"||h.value.kind!=="constant")return s;if(s.value.value===void 0||h.value.value===void 0)return new Ta(this,{kind:"constant",value:void 0},s.parameters);const x=ho[this.specification.type];if(x){const C=x(s.value.value,h.value.value,p);return new Ta(this,{kind:"constant",value:C},s.parameters)}return s}evaluate(s,h,p,x,C,T){return s.kind==="constant"?s.value:s.evaluate(h,p,x,C,T)}}class M extends An{possiblyEvaluate(s,h,p,x){if(s.value===void 0)return new Ta(this,{kind:"constant",value:void 0},h);if(s.expression.kind==="constant"){const C=s.expression.evaluate(h,null,{},p,x),T=s.property.specification.type==="resolvedImage"&&typeof C!="string"?C.name:C,R=this._calculate(T,T,T,h);return new Ta(this,{kind:"constant",value:R},h)}if(s.expression.kind==="camera"){const C=this._calculate(s.expression.evaluate({zoom:h.zoom-1}),s.expression.evaluate({zoom:h.zoom}),s.expression.evaluate({zoom:h.zoom+1}),h);return new Ta(this,{kind:"constant",value:C},h)}return new Ta(this,s.expression,h)}evaluate(s,h,p,x,C,T){if(s.kind==="source"){const R=s.evaluate(h,p,x,C,T);return this._calculate(R,R,R,h)}return s.kind==="composite"?this._calculate(s.evaluate({zoom:Math.floor(h.zoom)-1},p,x),s.evaluate({zoom:Math.floor(h.zoom)},p,x),s.evaluate({zoom:Math.floor(h.zoom)+1},p,x),h):s.value}_calculate(s,h,p,x){return x.zoom>x.zoomHistory.lastIntegerZoom?{from:s,to:h}:{from:p,to:h}}interpolate(s){return s}}class o{constructor(s){this.specification=s}possiblyEvaluate(s,h,p,x){if(s.value!==void 0){if(s.expression.kind==="constant"){const C=s.expression.evaluate(h,null,{},p,x);return this._calculate(C,C,C,h)}return this._calculate(s.expression.evaluate(new tr(Math.floor(h.zoom-1),h)),s.expression.evaluate(new tr(Math.floor(h.zoom),h)),s.expression.evaluate(new tr(Math.floor(h.zoom+1),h)),h)}}_calculate(s,h,p,x){return x.zoom>x.zoomHistory.lastIntegerZoom?{from:s,to:h}:{from:p,to:h}}interpolate(s){return s}}class d{constructor(s){this.specification=s}possiblyEvaluate(s,h,p,x){return!!s.expression.evaluate(h,null,{},p,x)}interpolate(){return!1}}class v{constructor(s){this.properties=s,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const h in s){const p=s[h];p.specification.overridable&&this.overridableProperties.push(h);const x=this.defaultPropertyValues[h]=new wf(p,void 0),C=this.defaultTransitionablePropertyValues[h]=new Cu(p);this.defaultTransitioningPropertyValues[h]=C.untransitioned(),this.defaultPossiblyEvaluatedValues[h]=x.possiblyEvaluate({})}}}dn("DataDrivenProperty",An),dn("DataConstantProperty",Tn),dn("CrossFadedDataDrivenProperty",M),dn("CrossFadedProperty",o),dn("ColorRampProperty",d);const _="-transition";class E extends Cn{constructor(s,h){if(super(),this.id=s.id,this.type=s.type,this._featureFilter={filter:()=>!0,needGeometry:!1},s.type!=="custom"&&(this.metadata=s.metadata,this.minzoom=s.minzoom,this.maxzoom=s.maxzoom,s.type!=="background"&&(this.source=s.source,this.sourceLayer=s["source-layer"],this.filter=s.filter),h.layout&&(this._unevaluatedLayout=new Nh(h.layout)),h.paint)){this._transitionablePaint=new Tu(h.paint);for(const p in s.paint)this.setPaintProperty(p,s.paint[p],{validate:!1});for(const p in s.layout)this.setLayoutProperty(p,s.layout[p],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Sf(h.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(s){return s==="visibility"?this.visibility:this._unevaluatedLayout.getValue(s)}setLayoutProperty(s,h,p={}){h!=null&&this._validate(zh,`layers.${this.id}.layout.${s}`,s,h,p)||(s!=="visibility"?this._unevaluatedLayout.setValue(s,h):this.visibility=h)}getPaintProperty(s){return s.endsWith(_)?this._transitionablePaint.getTransition(s.slice(0,-11)):this._transitionablePaint.getValue(s)}setPaintProperty(s,h,p={}){if(h!=null&&this._validate(Fh,`layers.${this.id}.paint.${s}`,s,h,p))return!1;if(s.endsWith(_))return this._transitionablePaint.setTransition(s.slice(0,-11),h||void 0),!1;{const x=this._transitionablePaint._values[s],C=x.property.specification["property-type"]==="cross-faded-data-driven",T=x.value.isDataDriven(),R=x.value;this._transitionablePaint.setValue(s,h),this._handleSpecialPaintPropertyUpdate(s);const F=this._transitionablePaint._values[s].value;return F.isDataDriven()||T||C||this._handleOverridablePaintPropertyUpdate(s,R,F)}}_handleSpecialPaintPropertyUpdate(s){}_handleOverridablePaintPropertyUpdate(s,h,p){return!1}isHidden(s){return!!(this.minzoom&&s<this.minzoom)||!!(this.maxzoom&&s>=this.maxzoom)||this.visibility==="none"}updateTransitions(s){this._transitioningPaint=this._transitionablePaint.transitioned(s,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(s,h){s.getCrossfadeParameters&&(this._crossfadeParameters=s.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(s,void 0,h)),this.paint=this._transitioningPaint.possiblyEvaluate(s,void 0,h)}serialize(){const s={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(s.layout=s.layout||{},s.layout.visibility=this.visibility),X(s,(h,p)=>!(h===void 0||p==="layout"&&!Object.keys(h).length||p==="paint"&&!Object.keys(h).length))}_validate(s,h,p,x,C={}){return(!C||C.validate!==!1)&&Mu(this,s.call(go,{key:h,layerType:this.type,objectKey:p,value:x,styleSpec:Ue,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const s in this.paint._values){const h=this.paint.get(s);if(h instanceof Ta&&ko(h.property.specification)&&(h.value.kind==="source"||h.value.kind==="composite")&&h.value.isStateDependent)return!0}return!1}}const O={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class z{constructor(s,h){this._structArray=s,this._pos1=h*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class V{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(s,h){return s._trim(),h&&(s.isTransferred=!0,h.push(s.arrayBuffer)),{length:s.length,arrayBuffer:s.arrayBuffer}}static deserialize(s){const h=Object.create(this.prototype);return h.arrayBuffer=s.arrayBuffer,h.length=s.length,h.capacity=s.arrayBuffer.byteLength/h.bytesPerElement,h._refreshViews(),h}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(s){this.reserve(s),this.length=s}reserve(s){if(s>this.capacity){this.capacity=Math.max(s,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const h=this.uint8;this._refreshViews(),h&&this.uint8.set(h)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function H(c,s=1){let h=0,p=0;return{members:c.map(x=>{const C=O[x.type].BYTES_PER_ELEMENT,T=h=J(h,Math.max(s,C)),R=x.components||1;return p=Math.max(p,C),h+=C*R,{name:x.name,type:x.type,components:R,offset:T}}),size:J(h,Math.max(p,s)),alignment:s}}function J(c,s){return Math.ceil(c/s)*s}class Q extends V{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,h){const p=this.length;return this.resize(p+1),this.emplace(p,s,h)}emplace(s,h,p){const x=2*s;return this.int16[x+0]=h,this.int16[x+1]=p,s}}Q.prototype.bytesPerElement=4,dn("StructArrayLayout2i4",Q);class ce extends V{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,h,p){const x=this.length;return this.resize(x+1),this.emplace(x,s,h,p)}emplace(s,h,p,x){const C=3*s;return this.int16[C+0]=h,this.int16[C+1]=p,this.int16[C+2]=x,s}}ce.prototype.bytesPerElement=6,dn("StructArrayLayout3i6",ce);class fe extends V{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,h,p,x){const C=this.length;return this.resize(C+1),this.emplace(C,s,h,p,x)}emplace(s,h,p,x,C){const T=4*s;return this.int16[T+0]=h,this.int16[T+1]=p,this.int16[T+2]=x,this.int16[T+3]=C,s}}fe.prototype.bytesPerElement=8,dn("StructArrayLayout4i8",fe);class be extends V{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,h,p,x,C,T){const R=this.length;return this.resize(R+1),this.emplace(R,s,h,p,x,C,T)}emplace(s,h,p,x,C,T,R){const F=6*s;return this.int16[F+0]=h,this.int16[F+1]=p,this.int16[F+2]=x,this.int16[F+3]=C,this.int16[F+4]=T,this.int16[F+5]=R,s}}be.prototype.bytesPerElement=12,dn("StructArrayLayout2i4i12",be);class Pe extends V{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,h,p,x,C,T){const R=this.length;return this.resize(R+1),this.emplace(R,s,h,p,x,C,T)}emplace(s,h,p,x,C,T,R){const F=4*s,U=8*s;return this.int16[F+0]=h,this.int16[F+1]=p,this.uint8[U+4]=x,this.uint8[U+5]=C,this.uint8[U+6]=T,this.uint8[U+7]=R,s}}Pe.prototype.bytesPerElement=8,dn("StructArrayLayout2i4ub8",Pe);class Te extends V{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,h){const p=this.length;return this.resize(p+1),this.emplace(p,s,h)}emplace(s,h,p){const x=2*s;return this.float32[x+0]=h,this.float32[x+1]=p,s}}Te.prototype.bytesPerElement=8,dn("StructArrayLayout2f8",Te);class ke extends V{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,h,p,x,C,T,R,F,U,G){const Y=this.length;return this.resize(Y+1),this.emplace(Y,s,h,p,x,C,T,R,F,U,G)}emplace(s,h,p,x,C,T,R,F,U,G,Y){const ee=10*s;return this.uint16[ee+0]=h,this.uint16[ee+1]=p,this.uint16[ee+2]=x,this.uint16[ee+3]=C,this.uint16[ee+4]=T,this.uint16[ee+5]=R,this.uint16[ee+6]=F,this.uint16[ee+7]=U,this.uint16[ee+8]=G,this.uint16[ee+9]=Y,s}}ke.prototype.bytesPerElement=20,dn("StructArrayLayout10ui20",ke);class Ve extends V{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,h,p,x,C,T,R,F,U,G,Y,ee){const ae=this.length;return this.resize(ae+1),this.emplace(ae,s,h,p,x,C,T,R,F,U,G,Y,ee)}emplace(s,h,p,x,C,T,R,F,U,G,Y,ee,ae){const ue=12*s;return this.int16[ue+0]=h,this.int16[ue+1]=p,this.int16[ue+2]=x,this.int16[ue+3]=C,this.uint16[ue+4]=T,this.uint16[ue+5]=R,this.uint16[ue+6]=F,this.uint16[ue+7]=U,this.int16[ue+8]=G,this.int16[ue+9]=Y,this.int16[ue+10]=ee,this.int16[ue+11]=ae,s}}Ve.prototype.bytesPerElement=24,dn("StructArrayLayout4i4ui4i24",Ve);class Ee extends V{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,h,p){const x=this.length;return this.resize(x+1),this.emplace(x,s,h,p)}emplace(s,h,p,x){const C=3*s;return this.float32[C+0]=h,this.float32[C+1]=p,this.float32[C+2]=x,s}}Ee.prototype.bytesPerElement=12,dn("StructArrayLayout3f12",Ee);class qe extends V{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s){const h=this.length;return this.resize(h+1),this.emplace(h,s)}emplace(s,h){return this.uint32[1*s+0]=h,s}}qe.prototype.bytesPerElement=4,dn("StructArrayLayout1ul4",qe);class rt extends V{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,h,p,x,C,T,R,F,U){const G=this.length;return this.resize(G+1),this.emplace(G,s,h,p,x,C,T,R,F,U)}emplace(s,h,p,x,C,T,R,F,U,G){const Y=10*s,ee=5*s;return this.int16[Y+0]=h,this.int16[Y+1]=p,this.int16[Y+2]=x,this.int16[Y+3]=C,this.int16[Y+4]=T,this.int16[Y+5]=R,this.uint32[ee+3]=F,this.uint16[Y+8]=U,this.uint16[Y+9]=G,s}}rt.prototype.bytesPerElement=20,dn("StructArrayLayout6i1ul2ui20",rt);class ht extends V{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,h,p,x,C,T){const R=this.length;return this.resize(R+1),this.emplace(R,s,h,p,x,C,T)}emplace(s,h,p,x,C,T,R){const F=6*s;return this.int16[F+0]=h,this.int16[F+1]=p,this.int16[F+2]=x,this.int16[F+3]=C,this.int16[F+4]=T,this.int16[F+5]=R,s}}ht.prototype.bytesPerElement=12,dn("StructArrayLayout2i2i2i12",ht);class At extends V{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,h,p,x,C){const T=this.length;return this.resize(T+1),this.emplace(T,s,h,p,x,C)}emplace(s,h,p,x,C,T){const R=4*s,F=8*s;return this.float32[R+0]=h,this.float32[R+1]=p,this.float32[R+2]=x,this.int16[F+6]=C,this.int16[F+7]=T,s}}At.prototype.bytesPerElement=16,dn("StructArrayLayout2f1f2i16",At);class Ft extends V{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,h,p,x,C,T){const R=this.length;return this.resize(R+1),this.emplace(R,s,h,p,x,C,T)}emplace(s,h,p,x,C,T,R){const F=16*s,U=4*s,G=8*s;return this.uint8[F+0]=h,this.uint8[F+1]=p,this.float32[U+1]=x,this.float32[U+2]=C,this.int16[G+6]=T,this.int16[G+7]=R,s}}Ft.prototype.bytesPerElement=16,dn("StructArrayLayout2ub2f2i16",Ft);class an extends V{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,h,p){const x=this.length;return this.resize(x+1),this.emplace(x,s,h,p)}emplace(s,h,p,x){const C=3*s;return this.uint16[C+0]=h,this.uint16[C+1]=p,this.uint16[C+2]=x,s}}an.prototype.bytesPerElement=6,dn("StructArrayLayout3ui6",an);class sn extends V{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,h,p,x,C,T,R,F,U,G,Y,ee,ae,ue,pe,Ae,Oe){const tt=this.length;return this.resize(tt+1),this.emplace(tt,s,h,p,x,C,T,R,F,U,G,Y,ee,ae,ue,pe,Ae,Oe)}emplace(s,h,p,x,C,T,R,F,U,G,Y,ee,ae,ue,pe,Ae,Oe,tt){const Le=24*s,Qe=12*s,dt=48*s;return this.int16[Le+0]=h,this.int16[Le+1]=p,this.uint16[Le+2]=x,this.uint16[Le+3]=C,this.uint32[Qe+2]=T,this.uint32[Qe+3]=R,this.uint32[Qe+4]=F,this.uint16[Le+10]=U,this.uint16[Le+11]=G,this.uint16[Le+12]=Y,this.float32[Qe+7]=ee,this.float32[Qe+8]=ae,this.uint8[dt+36]=ue,this.uint8[dt+37]=pe,this.uint8[dt+38]=Ae,this.uint32[Qe+10]=Oe,this.int16[Le+22]=tt,s}}sn.prototype.bytesPerElement=48,dn("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",sn);class kt extends V{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,h,p,x,C,T,R,F,U,G,Y,ee,ae,ue,pe,Ae,Oe,tt,Le,Qe,dt,Ut,cn,nn,ln,rn,xn,mn){const hn=this.length;return this.resize(hn+1),this.emplace(hn,s,h,p,x,C,T,R,F,U,G,Y,ee,ae,ue,pe,Ae,Oe,tt,Le,Qe,dt,Ut,cn,nn,ln,rn,xn,mn)}emplace(s,h,p,x,C,T,R,F,U,G,Y,ee,ae,ue,pe,Ae,Oe,tt,Le,Qe,dt,Ut,cn,nn,ln,rn,xn,mn,hn){const St=32*s,Pn=16*s;return this.int16[St+0]=h,this.int16[St+1]=p,this.int16[St+2]=x,this.int16[St+3]=C,this.int16[St+4]=T,this.int16[St+5]=R,this.int16[St+6]=F,this.int16[St+7]=U,this.uint16[St+8]=G,this.uint16[St+9]=Y,this.uint16[St+10]=ee,this.uint16[St+11]=ae,this.uint16[St+12]=ue,this.uint16[St+13]=pe,this.uint16[St+14]=Ae,this.uint16[St+15]=Oe,this.uint16[St+16]=tt,this.uint16[St+17]=Le,this.uint16[St+18]=Qe,this.uint16[St+19]=dt,this.uint16[St+20]=Ut,this.uint16[St+21]=cn,this.uint16[St+22]=nn,this.uint32[Pn+12]=ln,this.float32[Pn+13]=rn,this.float32[Pn+14]=xn,this.uint16[St+30]=mn,this.uint16[St+31]=hn,s}}kt.prototype.bytesPerElement=64,dn("StructArrayLayout8i15ui1ul2f2ui64",kt);class Kt extends V{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s){const h=this.length;return this.resize(h+1),this.emplace(h,s)}emplace(s,h){return this.float32[1*s+0]=h,s}}Kt.prototype.bytesPerElement=4,dn("StructArrayLayout1f4",Kt);class pn extends V{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,h,p){const x=this.length;return this.resize(x+1),this.emplace(x,s,h,p)}emplace(s,h,p,x){const C=3*s;return this.uint16[6*s+0]=h,this.float32[C+1]=p,this.float32[C+2]=x,s}}pn.prototype.bytesPerElement=12,dn("StructArrayLayout1ui2f12",pn);class $n extends V{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,h,p){const x=this.length;return this.resize(x+1),this.emplace(x,s,h,p)}emplace(s,h,p,x){const C=4*s;return this.uint32[2*s+0]=h,this.uint16[C+2]=p,this.uint16[C+3]=x,s}}$n.prototype.bytesPerElement=8,dn("StructArrayLayout1ul2ui8",$n);class Jt extends V{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,h){const p=this.length;return this.resize(p+1),this.emplace(p,s,h)}emplace(s,h,p){const x=2*s;return this.uint16[x+0]=h,this.uint16[x+1]=p,s}}Jt.prototype.bytesPerElement=4,dn("StructArrayLayout2ui4",Jt);class tn extends V{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s){const h=this.length;return this.resize(h+1),this.emplace(h,s)}emplace(s,h){return this.uint16[1*s+0]=h,s}}tn.prototype.bytesPerElement=2,dn("StructArrayLayout1ui2",tn);class Un extends V{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,h,p,x){const C=this.length;return this.resize(C+1),this.emplace(C,s,h,p,x)}emplace(s,h,p,x,C){const T=4*s;return this.float32[T+0]=h,this.float32[T+1]=p,this.float32[T+2]=x,this.float32[T+3]=C,s}}Un.prototype.bytesPerElement=16,dn("StructArrayLayout4f16",Un);class rr extends z{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new S(this.anchorPointX,this.anchorPointY)}}rr.prototype.size=20;class ei extends rt{get(s){return new rr(this,s)}}dn("CollisionBoxArray",ei);class hi extends z{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(s){this._structArray.uint8[this._pos1+37]=s}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(s){this._structArray.uint8[this._pos1+38]=s}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(s){this._structArray.uint32[this._pos4+10]=s}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}hi.prototype.size=48;class nr extends sn{get(s){return new hi(this,s)}}dn("PlacedSymbolArray",nr);class Li extends z{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(s){this._structArray.uint32[this._pos4+12]=s}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}Li.prototype.size=64;class yo extends kt{get(s){return new Li(this,s)}}dn("SymbolInstanceArray",yo);class ir extends Kt{getoffsetX(s){return this.float32[1*s+0]}}dn("GlyphOffsetArray",ir);class _r extends ce{getx(s){return this.int16[3*s+0]}gety(s){return this.int16[3*s+1]}gettileUnitDistanceFromAnchor(s){return this.int16[3*s+2]}}dn("SymbolLineVertexArray",_r);class ls extends z{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}ls.prototype.size=12;class qr extends pn{get(s){return new ls(this,s)}}dn("TextAnchorOffsetArray",qr);class wr extends z{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}wr.prototype.size=8;class zo extends $n{get(s){return new wr(this,s)}}dn("FeatureIndexArray",zo);class Rr extends Q{}class Au extends Q{}class Pu extends Q{}class Oc extends be{}class Ef extends Pe{}class Bh extends Te{}class cs extends ke{}class Os extends Ve{}class hl extends Ee{}class Iu extends qe{}class ys extends ht{}class Br extends Ft{}class ts extends an{}class vr extends Jt{}const Xl=H([{name:"a_pos",components:2,type:"Int16"}],4),{members:Mf}=Xl;class Xr{constructor(s=[]){this.segments=s}prepareSegment(s,h,p,x){let C=this.segments[this.segments.length-1];return s>Xr.MAX_VERTEX_ARRAY_LENGTH&&Se(`Max vertices per segment is ${Xr.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${s}`),(!C||C.vertexLength+s>Xr.MAX_VERTEX_ARRAY_LENGTH||C.sortKey!==x)&&(C={vertexOffset:h.length,primitiveOffset:p.length,vertexLength:0,primitiveLength:0},x!==void 0&&(C.sortKey=x),this.segments.push(C)),C}get(){return this.segments}destroy(){for(const s of this.segments)for(const h in s.vaos)s.vaos[h].destroy()}static simpleSegment(s,h,p,x){return new Xr([{vertexOffset:s,primitiveOffset:h,vertexLength:p,primitiveLength:x,vaos:{},sortKey:0}])}}function f0(c,s){return 256*(c=K(Math.floor(c),0,255))+K(Math.floor(s),0,255)}Xr.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,dn("SegmentVector",Xr);const Cf=H([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Uh={exports:{}},Aa={exports:{}};Aa.exports=function(c,s){var h,p,x,C,T,R,F,U;for(p=c.length-(h=3&c.length),x=s,T=3432918353,R=461845907,U=0;U<p;)F=255&c.charCodeAt(U)|(255&c.charCodeAt(++U))<<8|(255&c.charCodeAt(++U))<<16|(255&c.charCodeAt(++U))<<24,++U,x=27492+(65535&(C=5*(65535&(x=(x^=F=(65535&(F=(F=(65535&F)*T+(((F>>>16)*T&65535)<<16)&4294967295)<<15|F>>>17))*R+(((F>>>16)*R&65535)<<16)&4294967295)<<13|x>>>19))+((5*(x>>>16)&65535)<<16)&4294967295))+((58964+(C>>>16)&65535)<<16);switch(F=0,h){case 3:F^=(255&c.charCodeAt(U+2))<<16;case 2:F^=(255&c.charCodeAt(U+1))<<8;case 1:x^=F=(65535&(F=(F=(65535&(F^=255&c.charCodeAt(U)))*T+(((F>>>16)*T&65535)<<16)&4294967295)<<15|F>>>17))*R+(((F>>>16)*R&65535)<<16)&4294967295}return x^=c.length,x=2246822507*(65535&(x^=x>>>16))+((2246822507*(x>>>16)&65535)<<16)&4294967295,x=3266489909*(65535&(x^=x>>>13))+((3266489909*(x>>>16)&65535)<<16)&4294967295,(x^=x>>>16)>>>0};var p0=Aa.exports,Vh={exports:{}};Vh.exports=function(c,s){for(var h,p=c.length,x=s^p,C=0;p>=4;)h=1540483477*(65535&(h=255&c.charCodeAt(C)|(255&c.charCodeAt(++C))<<8|(255&c.charCodeAt(++C))<<16|(255&c.charCodeAt(++C))<<24))+((1540483477*(h>>>16)&65535)<<16),x=1540483477*(65535&x)+((1540483477*(x>>>16)&65535)<<16)^(h=1540483477*(65535&(h^=h>>>24))+((1540483477*(h>>>16)&65535)<<16)),p-=4,++C;switch(p){case 3:x^=(255&c.charCodeAt(C+2))<<16;case 2:x^=(255&c.charCodeAt(C+1))<<8;case 1:x=1540483477*(65535&(x^=255&c.charCodeAt(C)))+((1540483477*(x>>>16)&65535)<<16)}return x=1540483477*(65535&(x^=x>>>13))+((1540483477*(x>>>16)&65535)<<16),(x^=x>>>15)>>>0};var Tf=p0,Af=Vh.exports;Uh.exports=Tf,Uh.exports.murmur3=Tf,Uh.exports.murmur2=Af;var $h=f(Uh.exports);class dl{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(s,h,p,x){this.ids.push(A2(s)),this.positions.push(h,p,x)}getPositions(s){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const h=A2(s);let p=0,x=this.ids.length-1;for(;p<x;){const T=p+x>>1;this.ids[T]>=h?x=T:p=T+1}const C=[];for(;this.ids[p]===h;)C.push({index:this.positions[3*p],start:this.positions[3*p+1],end:this.positions[3*p+2]}),p++;return C}static serialize(s,h){const p=new Float64Array(s.ids),x=new Uint32Array(s.positions);return m0(p,x,0,p.length-1),h&&h.push(p.buffer,x.buffer),{ids:p,positions:x}}static deserialize(s){const h=new dl;return h.ids=s.ids,h.positions=s.positions,h.indexed=!0,h}}function A2(c){const s=+c;return!isNaN(s)&&s<=Number.MAX_SAFE_INTEGER?s:$h(String(c))}function m0(c,s,h,p){for(;h<p;){const x=c[h+p>>1];let C=h-1,T=p+1;for(;;){do C++;while(c[C]<x);do T--;while(c[T]>x);if(C>=T)break;mm(c,C,T),mm(s,3*C,3*T),mm(s,3*C+1,3*T+1),mm(s,3*C+2,3*T+2)}T-h<p-T?(m0(c,s,h,T),h=T+1):(m0(c,s,T+1,p),p=T)}}function mm(c,s,h){const p=c[s];c[s]=c[h],c[h]=p}dn("FeaturePositionMap",dl);class Hh{constructor(s,h){this.gl=s.gl,this.location=h}}class gm extends Hh{constructor(s,h){super(s,h),this.current=0}set(s){this.current!==s&&(this.current=s,this.gl.uniform1f(this.location,s))}}class P2 extends Hh{constructor(s,h){super(s,h),this.current=[0,0,0,0]}set(s){s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]&&s[3]===this.current[3]||(this.current=s,this.gl.uniform4f(this.location,s[0],s[1],s[2],s[3]))}}class g0 extends Hh{constructor(s,h){super(s,h),this.current=Yt.transparent}set(s){s.r===this.current.r&&s.g===this.current.g&&s.b===this.current.b&&s.a===this.current.a||(this.current=s,this.gl.uniform4f(this.location,s.r,s.g,s.b,s.a))}}const I2=new Float32Array(16);function vm(c){return[f0(255*c.r,255*c.g),f0(255*c.b,255*c.a)]}class ym{constructor(s,h,p){this.value=s,this.uniformNames=h.map(x=>`u_${x}`),this.type=p}setUniform(s,h,p){s.set(p.constantOr(this.value))}getBinding(s,h,p){return this.type==="color"?new g0(s,h):new gm(s,h)}}class Ru{constructor(s,h){this.uniformNames=h.map(p=>`u_${p}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(s,h){this.pixelRatioFrom=h.pixelRatio,this.pixelRatioTo=s.pixelRatio,this.patternFrom=h.tlbr,this.patternTo=s.tlbr}setUniform(s,h,p,x){const C=x==="u_pattern_to"?this.patternTo:x==="u_pattern_from"?this.patternFrom:x==="u_pixel_ratio_to"?this.pixelRatioTo:x==="u_pixel_ratio_from"?this.pixelRatioFrom:null;C&&s.set(C)}getBinding(s,h,p){return p.substr(0,9)==="u_pattern"?new P2(s,h):new gm(s,h)}}class si{constructor(s,h,p,x){this.expression=s,this.type=p,this.maxValue=0,this.paintVertexAttributes=h.map(C=>({name:`a_${C}`,type:"Float32",components:p==="color"?2:1,offset:0})),this.paintVertexArray=new x}populatePaintArray(s,h,p,x,C){const T=this.paintVertexArray.length,R=this.expression.evaluate(new tr(0),h,{},x,[],C);this.paintVertexArray.resize(s),this._setPaintValue(T,s,R)}updatePaintArray(s,h,p,x){const C=this.expression.evaluate({zoom:0},p,x);this._setPaintValue(s,h,C)}_setPaintValue(s,h,p){if(this.type==="color"){const x=vm(p);for(let C=s;C<h;C++)this.paintVertexArray.emplace(C,x[0],x[1])}else{for(let x=s;x<h;x++)this.paintVertexArray.emplace(x,p);this.maxValue=Math.max(this.maxValue,Math.abs(p))}}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class fl{constructor(s,h,p,x,C,T){this.expression=s,this.uniformNames=h.map(R=>`u_${R}_t`),this.type=p,this.useIntegerZoom=x,this.zoom=C,this.maxValue=0,this.paintVertexAttributes=h.map(R=>({name:`a_${R}`,type:"Float32",components:p==="color"?4:2,offset:0})),this.paintVertexArray=new T}populatePaintArray(s,h,p,x,C){const T=this.expression.evaluate(new tr(this.zoom),h,{},x,[],C),R=this.expression.evaluate(new tr(this.zoom+1),h,{},x,[],C),F=this.paintVertexArray.length;this.paintVertexArray.resize(s),this._setPaintValue(F,s,T,R)}updatePaintArray(s,h,p,x){const C=this.expression.evaluate({zoom:this.zoom},p,x),T=this.expression.evaluate({zoom:this.zoom+1},p,x);this._setPaintValue(s,h,C,T)}_setPaintValue(s,h,p,x){if(this.type==="color"){const C=vm(p),T=vm(x);for(let R=s;R<h;R++)this.paintVertexArray.emplace(R,C[0],C[1],T[0],T[1])}else{for(let C=s;C<h;C++)this.paintVertexArray.emplace(C,p,x);this.maxValue=Math.max(this.maxValue,Math.abs(p),Math.abs(x))}}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(s,h){const p=this.useIntegerZoom?Math.floor(h.zoom):h.zoom,x=K(this.expression.interpolationFactor(p,this.zoom,this.zoom+1),0,1);s.set(x)}getBinding(s,h,p){return new gm(s,h)}}class Lu{constructor(s,h,p,x,C,T){this.expression=s,this.type=h,this.useIntegerZoom=p,this.zoom=x,this.layerId=T,this.zoomInPaintVertexArray=new C,this.zoomOutPaintVertexArray=new C}populatePaintArray(s,h,p){const x=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(s),this.zoomOutPaintVertexArray.resize(s),this._setPaintValues(x,s,h.patterns&&h.patterns[this.layerId],p)}updatePaintArray(s,h,p,x,C){this._setPaintValues(s,h,p.patterns&&p.patterns[this.layerId],C)}_setPaintValues(s,h,p,x){if(!x||!p)return;const{min:C,mid:T,max:R}=p,F=x[C],U=x[T],G=x[R];if(F&&U&&G)for(let Y=s;Y<h;Y++)this.zoomInPaintVertexArray.emplace(Y,U.tl[0],U.tl[1],U.br[0],U.br[1],F.tl[0],F.tl[1],F.br[0],F.br[1],U.pixelRatio,F.pixelRatio),this.zoomOutPaintVertexArray.emplace(Y,U.tl[0],U.tl[1],U.br[0],U.br[1],G.tl[0],G.tl[1],G.br[0],G.br[1],U.pixelRatio,G.pixelRatio)}upload(s){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=s.createVertexBuffer(this.zoomInPaintVertexArray,Cf.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=s.createVertexBuffer(this.zoomOutPaintVertexArray,Cf.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Pf{constructor(s,h,p){this.binders={},this._buffers=[];const x=[];for(const C in s.paint._values){if(!p(C))continue;const T=s.paint.get(C);if(!(T instanceof Ta&&ko(T.property.specification)))continue;const R=JI(C,s.type),F=T.value,U=T.property.specification.type,G=T.property.useIntegerZoom,Y=T.property.specification["property-type"],ee=Y==="cross-faded"||Y==="cross-faded-data-driven";if(F.kind==="constant")this.binders[C]=ee?new Ru(F.value,R):new ym(F.value,R,U),x.push(`/u_${C}`);else if(F.kind==="source"||ee){const ae=R2(C,U,"source");this.binders[C]=ee?new Lu(F,U,G,h,ae,s.id):new si(F,R,U,ae),x.push(`/a_${C}`)}else{const ae=R2(C,U,"composite");this.binders[C]=new fl(F,R,U,G,h,ae),x.push(`/z_${C}`)}}this.cacheKey=x.sort().join("")}getMaxValue(s){const h=this.binders[s];return h instanceof si||h instanceof fl?h.maxValue:0}populatePaintArrays(s,h,p,x,C){for(const T in this.binders){const R=this.binders[T];(R instanceof si||R instanceof fl||R instanceof Lu)&&R.populatePaintArray(s,h,p,x,C)}}setConstantPatternPositions(s,h){for(const p in this.binders){const x=this.binders[p];x instanceof Ru&&x.setConstantPatternPositions(s,h)}}updatePaintArrays(s,h,p,x,C){let T=!1;for(const R in s){const F=h.getPositions(R);for(const U of F){const G=p.feature(U.index);for(const Y in this.binders){const ee=this.binders[Y];if((ee instanceof si||ee instanceof fl||ee instanceof Lu)&&ee.expression.isStateDependent===!0){const ae=x.paint.get(Y);ee.expression=ae.value,ee.updatePaintArray(U.start,U.end,G,s[R],C),T=!0}}}}return T}defines(){const s=[];for(const h in this.binders){const p=this.binders[h];(p instanceof ym||p instanceof Ru)&&s.push(...p.uniformNames.map(x=>`#define HAS_UNIFORM_${x}`))}return s}getBinderAttributes(){const s=[];for(const h in this.binders){const p=this.binders[h];if(p instanceof si||p instanceof fl)for(let x=0;x<p.paintVertexAttributes.length;x++)s.push(p.paintVertexAttributes[x].name);else if(p instanceof Lu)for(let x=0;x<Cf.members.length;x++)s.push(Cf.members[x].name)}return s}getBinderUniforms(){const s=[];for(const h in this.binders){const p=this.binders[h];if(p instanceof ym||p instanceof Ru||p instanceof fl)for(const x of p.uniformNames)s.push(x)}return s}getPaintVertexBuffers(){return this._buffers}getUniforms(s,h){const p=[];for(const x in this.binders){const C=this.binders[x];if(C instanceof ym||C instanceof Ru||C instanceof fl){for(const T of C.uniformNames)if(h[T]){const R=C.getBinding(s,h[T],T);p.push({name:T,property:x,binding:R})}}}return p}setUniforms(s,h,p,x){for(const{name:C,property:T,binding:R}of h)this.binders[T].setUniform(R,x,p.get(T),C)}updatePaintBuffers(s){this._buffers=[];for(const h in this.binders){const p=this.binders[h];if(s&&p instanceof Lu){const x=s.fromScale===2?p.zoomInPaintVertexBuffer:p.zoomOutPaintVertexBuffer;x&&this._buffers.push(x)}else(p instanceof si||p instanceof fl)&&p.paintVertexBuffer&&this._buffers.push(p.paintVertexBuffer)}}upload(s){for(const h in this.binders){const p=this.binders[h];(p instanceof si||p instanceof fl||p instanceof Lu)&&p.upload(s)}this.updatePaintBuffers()}destroy(){for(const s in this.binders){const h=this.binders[s];(h instanceof si||h instanceof fl||h instanceof Lu)&&h.destroy()}}}class ku{constructor(s,h,p=()=>!0){this.programConfigurations={};for(const x of s)this.programConfigurations[x.id]=new Pf(x,h,p);this.needsUpload=!1,this._featureMap=new dl,this._bufferOffset=0}populatePaintArrays(s,h,p,x,C,T){for(const R in this.programConfigurations)this.programConfigurations[R].populatePaintArrays(s,h,x,C,T);h.id!==void 0&&this._featureMap.add(h.id,p,this._bufferOffset,s),this._bufferOffset=s,this.needsUpload=!0}updatePaintArrays(s,h,p,x){for(const C of p)this.needsUpload=this.programConfigurations[C.id].updatePaintArrays(s,this._featureMap,h,C,x)||this.needsUpload}get(s){return this.programConfigurations[s]}upload(s){if(this.needsUpload){for(const h in this.programConfigurations)this.programConfigurations[h].upload(s);this.needsUpload=!1}}destroy(){for(const s in this.programConfigurations)this.programConfigurations[s].destroy()}}function JI(c,s){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[c]||[c.replace(`${s}-`,"").replace(/-/g,"_")]}function R2(c,s,h){const p={color:{source:Te,composite:Un},number:{source:Kt,composite:Te}},x=function(C){return{"line-pattern":{source:cs,composite:cs},"fill-pattern":{source:cs,composite:cs},"fill-extrusion-pattern":{source:cs,composite:cs}}[C]}(c);return x&&x[h]||p[s][h]}dn("ConstantBinder",ym),dn("CrossFadedConstantBinder",Ru),dn("SourceExpressionBinder",si),dn("CrossFadedCompositeBinder",Lu),dn("CompositeExpressionBinder",fl),dn("ProgramConfiguration",Pf,{omit:["_buffers"]}),dn("ProgramConfigurationSet",ku);const Oi=8192,gx=Math.pow(2,14)-1,_m=-gx-1;function Fc(c){const s=Oi/c.extent,h=c.loadGeometry();for(let p=0;p<h.length;p++){const x=h[p];for(let C=0;C<x.length;C++){const T=x[C],R=Math.round(T.x*s),F=Math.round(T.y*s);T.x=K(R,_m,gx),T.y=K(F,_m,gx),(R<T.x||R>T.x+1||F<T.y||F>T.y+1)&&Se("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return h}function Du(c,s){return{type:c.type,id:c.id,properties:c.properties,geometry:s?Fc(c):[]}}function xm(c,s,h,p,x){c.emplaceBack(2*s+(p+1)/2,2*h+(x+1)/2)}class _o{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(h=>h.id),this.index=s.index,this.hasPattern=!1,this.layoutVertexArray=new Au,this.indexArray=new ts,this.segments=new Xr,this.programConfigurations=new ku(s.layers,s.zoom),this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(s,h,p){const x=this.layers[0],C=[];let T=null,R=!1;x.type==="circle"&&(T=x.layout.get("circle-sort-key"),R=!T.isConstant());for(const{feature:F,id:U,index:G,sourceLayerIndex:Y}of s){const ee=this.layers[0]._featureFilter.needGeometry,ae=Du(F,ee);if(!this.layers[0]._featureFilter.filter(new tr(this.zoom),ae,p))continue;const ue=R?T.evaluate(ae,{},p):void 0,pe={id:U,properties:F.properties,type:F.type,sourceLayerIndex:Y,index:G,geometry:ee?ae.geometry:Fc(F),patterns:{},sortKey:ue};C.push(pe)}R&&C.sort((F,U)=>F.sortKey-U.sortKey);for(const F of C){const{geometry:U,index:G,sourceLayerIndex:Y}=F,ee=s[G].feature;this.addFeature(F,U,G,p),h.featureIndex.insert(ee,U,G,Y,this.index)}}update(s,h,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,h,this.stateDependentLayers,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,Mf),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(s,h,p,x){for(const C of h)for(const T of C){const R=T.x,F=T.y;if(R<0||R>=Oi||F<0||F>=Oi)continue;const U=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,s.sortKey),G=U.vertexLength;xm(this.layoutVertexArray,R,F,-1,-1),xm(this.layoutVertexArray,R,F,1,-1),xm(this.layoutVertexArray,R,F,1,1),xm(this.layoutVertexArray,R,F,-1,1),this.indexArray.emplaceBack(G,G+1,G+2),this.indexArray.emplaceBack(G,G+3,G+2),U.vertexLength+=4,U.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,p,{},x)}}function zc(c,s){for(let h=0;h<c.length;h++)if(sa(s,c[h]))return!0;for(let h=0;h<s.length;h++)if(sa(c,s[h]))return!0;return!!y0(c,s)}function vx(c,s,h){return!!sa(c,s)||!!_0(s,c,h)}function yx(c,s){if(c.length===1)return b0(s,c[0]);for(let h=0;h<s.length;h++){const p=s[h];for(let x=0;x<p.length;x++)if(sa(c,p[x]))return!0}for(let h=0;h<c.length;h++)if(b0(s,c[h]))return!0;for(let h=0;h<s.length;h++)if(y0(c,s[h]))return!0;return!1}function v0(c,s,h){if(c.length>1){if(y0(c,s))return!0;for(let p=0;p<s.length;p++)if(_0(s[p],c,h))return!0}for(let p=0;p<c.length;p++)if(_0(c[p],s,h))return!0;return!1}function y0(c,s){if(c.length===0||s.length===0)return!1;for(let h=0;h<c.length-1;h++){const p=c[h],x=c[h+1];for(let C=0;C<s.length-1;C++)if(_x(p,x,s[C],s[C+1]))return!0}return!1}function _x(c,s,h,p){return Me(c,h,p)!==Me(s,h,p)&&Me(c,s,h)!==Me(c,s,p)}function _0(c,s,h){const p=h*h;if(s.length===1)return c.distSqr(s[0])<p;for(let x=1;x<s.length;x++)if(x0(c,s[x-1],s[x])<p)return!0;return!1}function x0(c,s,h){const p=s.distSqr(h);if(p===0)return c.distSqr(s);const x=((c.x-s.x)*(h.x-s.x)+(c.y-s.y)*(h.y-s.y))/p;return c.distSqr(x<0?s:x>1?h:h.sub(s)._mult(x)._add(s))}function b0(c,s){let h,p,x,C=!1;for(let T=0;T<c.length;T++){h=c[T];for(let R=0,F=h.length-1;R<h.length;F=R++)p=h[R],x=h[F],p.y>s.y!=x.y>s.y&&s.x<(x.x-p.x)*(s.y-p.y)/(x.y-p.y)+p.x&&(C=!C)}return C}function sa(c,s){let h=!1;for(let p=0,x=c.length-1;p<c.length;x=p++){const C=c[p],T=c[x];C.y>s.y!=T.y>s.y&&s.x<(T.x-C.x)*(s.y-C.y)/(T.y-C.y)+C.x&&(h=!h)}return h}function QI(c,s,h){const p=h[0],x=h[2];if(c.x<p.x&&s.x<p.x||c.x>x.x&&s.x>x.x||c.y<p.y&&s.y<p.y||c.y>x.y&&s.y>x.y)return!1;const C=Me(c,s,h[0]);return C!==Me(c,s,h[1])||C!==Me(c,s,h[2])||C!==Me(c,s,h[3])}function Pa(c,s,h){const p=s.paint.get(c).value;return p.kind==="constant"?p.value:h.programConfigurations.get(s.id).getMaxValue(c)}function bm(c){return Math.sqrt(c[0]*c[0]+c[1]*c[1])}function wm(c,s,h,p,x){if(!s[0]&&!s[1])return c;const C=S.convert(s)._mult(x);h==="viewport"&&C._rotate(-p);const T=[];for(let R=0;R<c.length;R++)T.push(c[R].sub(C));return T}let w0,L2;dn("CircleBucket",_o,{omit:["layers"]});var eR={get paint(){return L2=L2||new v({"circle-radius":new An(Ue.paint_circle["circle-radius"]),"circle-color":new An(Ue.paint_circle["circle-color"]),"circle-blur":new An(Ue.paint_circle["circle-blur"]),"circle-opacity":new An(Ue.paint_circle["circle-opacity"]),"circle-translate":new Tn(Ue.paint_circle["circle-translate"]),"circle-translate-anchor":new Tn(Ue.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Tn(Ue.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Tn(Ue.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new An(Ue.paint_circle["circle-stroke-width"]),"circle-stroke-color":new An(Ue.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new An(Ue.paint_circle["circle-stroke-opacity"])})},get layout(){return w0=w0||new v({"circle-sort-key":new An(Ue.layout_circle["circle-sort-key"])})}},Js=1e-6,Gh=typeof Float32Array<"u"?Float32Array:Array;function S0(c){return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function k2(c,s,h){var p=s[0],x=s[1],C=s[2],T=s[3],R=s[4],F=s[5],U=s[6],G=s[7],Y=s[8],ee=s[9],ae=s[10],ue=s[11],pe=s[12],Ae=s[13],Oe=s[14],tt=s[15],Le=h[0],Qe=h[1],dt=h[2],Ut=h[3];return c[0]=Le*p+Qe*R+dt*Y+Ut*pe,c[1]=Le*x+Qe*F+dt*ee+Ut*Ae,c[2]=Le*C+Qe*U+dt*ae+Ut*Oe,c[3]=Le*T+Qe*G+dt*ue+Ut*tt,c[4]=(Le=h[4])*p+(Qe=h[5])*R+(dt=h[6])*Y+(Ut=h[7])*pe,c[5]=Le*x+Qe*F+dt*ee+Ut*Ae,c[6]=Le*C+Qe*U+dt*ae+Ut*Oe,c[7]=Le*T+Qe*G+dt*ue+Ut*tt,c[8]=(Le=h[8])*p+(Qe=h[9])*R+(dt=h[10])*Y+(Ut=h[11])*pe,c[9]=Le*x+Qe*F+dt*ee+Ut*Ae,c[10]=Le*C+Qe*U+dt*ae+Ut*Oe,c[11]=Le*T+Qe*G+dt*ue+Ut*tt,c[12]=(Le=h[12])*p+(Qe=h[13])*R+(dt=h[14])*Y+(Ut=h[15])*pe,c[13]=Le*x+Qe*F+dt*ee+Ut*Ae,c[14]=Le*C+Qe*U+dt*ae+Ut*Oe,c[15]=Le*T+Qe*G+dt*ue+Ut*tt,c}Math.hypot||(Math.hypot=function(){for(var c=0,s=arguments.length;s--;)c+=arguments[s]*arguments[s];return Math.sqrt(c)});var If,D2=k2;function Fs(c,s,h){var p=s[0],x=s[1],C=s[2],T=s[3];return c[0]=h[0]*p+h[4]*x+h[8]*C+h[12]*T,c[1]=h[1]*p+h[5]*x+h[9]*C+h[13]*T,c[2]=h[2]*p+h[6]*x+h[10]*C+h[14]*T,c[3]=h[3]*p+h[7]*x+h[11]*C+h[15]*T,c}If=new Gh(4),Gh!=Float32Array&&(If[0]=0,If[1]=0,If[2]=0,If[3]=0);class Zl extends E{constructor(s){super(s,eR)}createBucket(s){return new _o(s)}queryRadius(s){const h=s;return Pa("circle-radius",this,h)+Pa("circle-stroke-width",this,h)+bm(this.paint.get("circle-translate"))}queryIntersectsFeature(s,h,p,x,C,T,R,F){const U=wm(s,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),T.angle,R),G=this.paint.get("circle-radius").evaluate(h,p)+this.paint.get("circle-stroke-width").evaluate(h,p),Y=this.paint.get("circle-pitch-alignment")==="map",ee=Y?U:function(ue,pe){return ue.map(Ae=>O2(Ae,pe))}(U,F),ae=Y?G*R:G;for(const ue of x)for(const pe of ue){const Ae=Y?pe:O2(pe,F);let Oe=ae;const tt=Fs([],[pe.x,pe.y,0,1],F);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Oe*=tt[3]/T.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Oe*=T.cameraToCenterDistance/tt[3]),vx(ee,Ae,Oe))return!0}return!1}}function O2(c,s){const h=Fs([],[c.x,c.y,0,1],s);return new S(h[0]/h[3],h[1]/h[3])}class F2 extends _o{}let Sm;dn("HeatmapBucket",F2,{omit:["layers"]});var Rf={get paint(){return Sm=Sm||new v({"heatmap-radius":new An(Ue.paint_heatmap["heatmap-radius"]),"heatmap-weight":new An(Ue.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Tn(Ue.paint_heatmap["heatmap-intensity"]),"heatmap-color":new d(Ue.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Tn(Ue.paint_heatmap["heatmap-opacity"])})}};function E0(c,{width:s,height:h},p,x){if(x){if(x instanceof Uint8ClampedArray)x=new Uint8Array(x.buffer);else if(x.length!==s*h*p)throw new RangeError(`mismatched image size. expected: ${x.length} but got: ${s*h*p}`)}else x=new Uint8Array(s*h*p);return c.width=s,c.height=h,c.data=x,c}function xx(c,{width:s,height:h},p){if(s===c.width&&h===c.height)return;const x=E0({},{width:s,height:h},p);bx(c,x,{x:0,y:0},{x:0,y:0},{width:Math.min(c.width,s),height:Math.min(c.height,h)},p),c.width=s,c.height=h,c.data=x.data}function bx(c,s,h,p,x,C){if(x.width===0||x.height===0)return s;if(x.width>c.width||x.height>c.height||h.x>c.width-x.width||h.y>c.height-x.height)throw new RangeError("out of range source coordinates for image copy");if(x.width>s.width||x.height>s.height||p.x>s.width-x.width||p.y>s.height-x.height)throw new RangeError("out of range destination coordinates for image copy");const T=c.data,R=s.data;if(T===R)throw new Error("srcData equals dstData, so image is already copied");for(let F=0;F<x.height;F++){const U=((h.y+F)*c.width+h.x)*C,G=((p.y+F)*s.width+p.x)*C;for(let Y=0;Y<x.width*C;Y++)R[G+Y]=T[U+Y]}return s}class Lf{constructor(s,h){E0(this,s,1,h)}resize(s){xx(this,s,1)}clone(){return new Lf({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(s,h,p,x,C){bx(s,h,p,x,C,1)}}class _s{constructor(s,h){E0(this,s,4,h)}resize(s){xx(this,s,4)}replace(s,h){h?this.data.set(s):this.data=s instanceof Uint8ClampedArray?new Uint8Array(s.buffer):s}clone(){return new _s({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(s,h,p,x,C){bx(s,h,p,x,C,4)}}function kf(c){const s={},h=c.resolution||256,p=c.clips?c.clips.length:1,x=c.image||new _s({width:h,height:p});if(Math.log(h)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${h}`);const C=(T,R,F)=>{s[c.evaluationKey]=F;const U=c.expression.evaluate(s);x.data[T+R+0]=Math.floor(255*U.r/U.a),x.data[T+R+1]=Math.floor(255*U.g/U.a),x.data[T+R+2]=Math.floor(255*U.b/U.a),x.data[T+R+3]=Math.floor(255*U.a)};if(c.clips)for(let T=0,R=0;T<p;++T,R+=4*h)for(let F=0,U=0;F<h;F++,U+=4){const G=F/(h-1),{start:Y,end:ee}=c.clips[T];C(R,U,Y*(1-G)+ee*G)}else for(let T=0,R=0;T<h;T++,R+=4)C(0,R,T/(h-1));return x}dn("AlphaImage",Lf),dn("RGBAImage",_s);class tR extends E{createBucket(s){return new F2(s)}constructor(s){super(s,Rf),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(s){s==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=kf({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let wx;var z2={get paint(){return wx=wx||new v({"hillshade-illumination-direction":new Tn(Ue.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Tn(Ue.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Tn(Ue.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Tn(Ue.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Tn(Ue.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Tn(Ue.paint_hillshade["hillshade-accent-color"])})}};class M0 extends E{constructor(s){super(s,z2)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const N2=H([{name:"a_pos",components:2,type:"Int16"}],4),{members:C0}=N2;function T0(c,s,h=2){const p=s&&s.length,x=p?s[0]*h:c.length;let C=Em(c,0,x,h,!0);const T=[];if(!C||C.next===C.prev)return T;let R,F,U;if(p&&(C=function(G,Y,ee,ae){const ue=[];for(let pe=0,Ae=Y.length;pe<Ae;pe++){const Oe=Em(G,Y[pe]*ae,pe<Ae-1?Y[pe+1]*ae:G.length,ae,!1);Oe===Oe.next&&(Oe.steiner=!0),ue.push(iR(Oe))}ue.sort(U2);for(let pe=0;pe<ue.length;pe++)ee=Nc(ue[pe],ee);return ee}(c,s,C,h)),c.length>80*h){R=1/0,F=1/0;let G=-1/0,Y=-1/0;for(let ee=h;ee<x;ee+=h){const ae=c[ee],ue=c[ee+1];ae<R&&(R=ae),ue<F&&(F=ue),ae>G&&(G=ae),ue>Y&&(Y=ue)}U=Math.max(G-R,Y-F),U=U!==0?32767/U:0}return Df(C,T,h,R,F,U,0),T}function Em(c,s,h,p,x){let C;if(x===function(T,R,F,U){let G=0;for(let Y=R,ee=F-U;Y<F;Y+=U)G+=(T[ee]-T[Y])*(T[Y+1]+T[ee+1]),ee=Y;return G}(c,s,h,p)>0)for(let T=s;T<h;T+=p)C=Yn(T/p|0,c[T],c[T+1],C);else for(let T=h-p;T>=s;T-=p)C=Yn(T/p|0,c[T],c[T+1],C);return C&&Ia(C,C.next)&&(Fu(C),C=C.next),C}function Wh(c,s){if(!c)return c;s||(s=c);let h,p=c;do if(h=!1,p.steiner||!Ia(p,p.next)&&Lr(p.prev,p,p.next)!==0)p=p.next;else{if(Fu(p),p=s=p.prev,p===p.next)break;h=!0}while(h||p!==s);return s}function Df(c,s,h,p,x,C,T){if(!c)return;!T&&C&&function(F,U,G,Y){let ee=F;do ee.z===0&&(ee.z=P0(ee.x,ee.y,U,G,Y)),ee.prevZ=ee.prev,ee.nextZ=ee.next,ee=ee.next;while(ee!==F);ee.prevZ.nextZ=null,ee.prevZ=null,function(ae){let ue,pe=1;do{let Ae,Oe=ae;ae=null;let tt=null;for(ue=0;Oe;){ue++;let Le=Oe,Qe=0;for(let Ut=0;Ut<pe&&(Qe++,Le=Le.nextZ,Le);Ut++);let dt=pe;for(;Qe>0||dt>0&&Le;)Qe!==0&&(dt===0||!Le||Oe.z<=Le.z)?(Ae=Oe,Oe=Oe.nextZ,Qe--):(Ae=Le,Le=Le.nextZ,dt--),tt?tt.nextZ=Ae:ae=Ae,Ae.prevZ=tt,tt=Ae;Oe=Le}tt.nextZ=null,pe*=2}while(ue>1)}(ee)}(c,p,x,C);let R=c;for(;c.prev!==c.next;){const F=c.prev,U=c.next;if(C?B2(c,p,x,C):A0(c))s.push(F.i,c.i,U.i),Fu(c),c=U.next,R=U.next;else if((c=U)===R){T?T===1?Df(c=Sx(Wh(c),s),s,h,p,x,C,2):T===2&&nR(c,s,h,p,x,C):Df(Wh(c),s,h,p,x,C,1);break}}}function A0(c){const s=c.prev,h=c,p=c.next;if(Lr(s,h,p)>=0)return!1;const x=s.x,C=h.x,T=p.x,R=s.y,F=h.y,U=p.y,G=x<C?x<T?x:T:C<T?C:T,Y=R<F?R<U?R:U:F<U?F:U,ee=x>C?x>T?x:T:C>T?C:T,ae=R>F?R>U?R:U:F>U?F:U;let ue=p.next;for(;ue!==s;){if(ue.x>=G&&ue.x<=ee&&ue.y>=Y&&ue.y<=ae&&jh(x,R,C,F,T,U,ue.x,ue.y)&&Lr(ue.prev,ue,ue.next)>=0)return!1;ue=ue.next}return!0}function B2(c,s,h,p){const x=c.prev,C=c,T=c.next;if(Lr(x,C,T)>=0)return!1;const R=x.x,F=C.x,U=T.x,G=x.y,Y=C.y,ee=T.y,ae=R<F?R<U?R:U:F<U?F:U,ue=G<Y?G<ee?G:ee:Y<ee?Y:ee,pe=R>F?R>U?R:U:F>U?F:U,Ae=G>Y?G>ee?G:ee:Y>ee?Y:ee,Oe=P0(ae,ue,s,h,p),tt=P0(pe,Ae,s,h,p);let Le=c.prevZ,Qe=c.nextZ;for(;Le&&Le.z>=Oe&&Qe&&Qe.z<=tt;){if(Le.x>=ae&&Le.x<=pe&&Le.y>=ue&&Le.y<=Ae&&Le!==x&&Le!==T&&jh(R,G,F,Y,U,ee,Le.x,Le.y)&&Lr(Le.prev,Le,Le.next)>=0||(Le=Le.prevZ,Qe.x>=ae&&Qe.x<=pe&&Qe.y>=ue&&Qe.y<=Ae&&Qe!==x&&Qe!==T&&jh(R,G,F,Y,U,ee,Qe.x,Qe.y)&&Lr(Qe.prev,Qe,Qe.next)>=0))return!1;Qe=Qe.nextZ}for(;Le&&Le.z>=Oe;){if(Le.x>=ae&&Le.x<=pe&&Le.y>=ue&&Le.y<=Ae&&Le!==x&&Le!==T&&jh(R,G,F,Y,U,ee,Le.x,Le.y)&&Lr(Le.prev,Le,Le.next)>=0)return!1;Le=Le.prevZ}for(;Qe&&Qe.z<=tt;){if(Qe.x>=ae&&Qe.x<=pe&&Qe.y>=ue&&Qe.y<=Ae&&Qe!==x&&Qe!==T&&jh(R,G,F,Y,U,ee,Qe.x,Qe.y)&&Lr(Qe.prev,Qe,Qe.next)>=0)return!1;Qe=Qe.nextZ}return!0}function Sx(c,s){let h=c;do{const p=h.prev,x=h.next.next;!Ia(p,x)&&I0(p,h,h.next,x)&&Ou(p,x)&&Ou(x,p)&&(s.push(p.i,h.i,x.i),Fu(h),Fu(h.next),h=c=x),h=h.next}while(h!==c);return Wh(h)}function nR(c,s,h,p,x,C){let T=c;do{let R=T.next.next;for(;R!==T.prev;){if(T.i!==R.i&&rR(T,R)){let F=qh(T,R);return T=Wh(T,T.next),F=Wh(F,F.next),Df(T,s,h,p,x,C,0),void Df(F,s,h,p,x,C,0)}R=R.next}T=T.next}while(T!==c)}function U2(c,s){return c.x-s.x}function Nc(c,s){const h=function(x,C){let T=C;const R=x.x,F=x.y;let U,G=-1/0;do{if(F<=T.y&&F>=T.next.y&&T.next.y!==T.y){const pe=T.x+(F-T.y)*(T.next.x-T.x)/(T.next.y-T.y);if(pe<=R&&pe>G&&(G=pe,U=T.x<T.next.x?T:T.next,pe===R))return U}T=T.next}while(T!==C);if(!U)return null;const Y=U,ee=U.x,ae=U.y;let ue=1/0;T=U;do{if(R>=T.x&&T.x>=ee&&R!==T.x&&jh(F<ae?R:G,F,ee,ae,F<ae?G:R,F,T.x,T.y)){const pe=Math.abs(F-T.y)/(R-T.x);Ou(T,x)&&(pe<ue||pe===ue&&(T.x>U.x||T.x===U.x&&V2(U,T)))&&(U=T,ue=pe)}T=T.next}while(T!==Y);return U}(c,s);if(!h)return s;const p=qh(h,c);return Wh(p,p.next),Wh(h,h.next)}function V2(c,s){return Lr(c.prev,c,s.prev)<0&&Lr(s.next,c,c.next)<0}function P0(c,s,h,p,x){return(c=1431655765&((c=858993459&((c=252645135&((c=16711935&((c=(c-h)*x|0)|c<<8))|c<<4))|c<<2))|c<<1))|(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-p)*x|0)|s<<8))|s<<4))|s<<2))|s<<1))<<1}function iR(c){let s=c,h=c;do(s.x<h.x||s.x===h.x&&s.y<h.y)&&(h=s),s=s.next;while(s!==c);return h}function jh(c,s,h,p,x,C,T,R){return(x-T)*(s-R)>=(c-T)*(C-R)&&(c-T)*(p-R)>=(h-T)*(s-R)&&(h-T)*(C-R)>=(x-T)*(p-R)}function rR(c,s){return c.next.i!==s.i&&c.prev.i!==s.i&&!function(h,p){let x=h;do{if(x.i!==h.i&&x.next.i!==h.i&&x.i!==p.i&&x.next.i!==p.i&&I0(x,x.next,h,p))return!0;x=x.next}while(x!==h);return!1}(c,s)&&(Ou(c,s)&&Ou(s,c)&&function(h,p){let x=h,C=!1;const T=(h.x+p.x)/2,R=(h.y+p.y)/2;do x.y>R!=x.next.y>R&&x.next.y!==x.y&&T<(x.next.x-x.x)*(R-x.y)/(x.next.y-x.y)+x.x&&(C=!C),x=x.next;while(x!==h);return C}(c,s)&&(Lr(c.prev,c,s.prev)||Lr(c,s.prev,s))||Ia(c,s)&&Lr(c.prev,c,c.next)>0&&Lr(s.prev,s,s.next)>0)}function Lr(c,s,h){return(s.y-c.y)*(h.x-s.x)-(s.x-c.x)*(h.y-s.y)}function Ia(c,s){return c.x===s.x&&c.y===s.y}function I0(c,s,h,p){const x=Ff(Lr(c,s,h)),C=Ff(Lr(c,s,p)),T=Ff(Lr(h,p,c)),R=Ff(Lr(h,p,s));return x!==C&&T!==R||!(x!==0||!Of(c,h,s))||!(C!==0||!Of(c,p,s))||!(T!==0||!Of(h,c,p))||!(R!==0||!Of(h,s,p))}function Of(c,s,h){return s.x<=Math.max(c.x,h.x)&&s.x>=Math.min(c.x,h.x)&&s.y<=Math.max(c.y,h.y)&&s.y>=Math.min(c.y,h.y)}function Ff(c){return c>0?1:c<0?-1:0}function Ou(c,s){return Lr(c.prev,c,c.next)<0?Lr(c,s,c.next)>=0&&Lr(c,c.prev,s)>=0:Lr(c,s,c.prev)<0||Lr(c,c.next,s)<0}function qh(c,s){const h=Mm(c.i,c.x,c.y),p=Mm(s.i,s.x,s.y),x=c.next,C=s.prev;return c.next=s,s.prev=c,h.next=x,x.prev=h,p.next=h,h.prev=p,C.next=p,p.prev=C,p}function Yn(c,s,h,p){const x=Mm(c,s,h);return p?(x.next=p.next,x.prev=p,p.next.prev=x,p.next=x):(x.prev=x,x.next=x),x}function Fu(c){c.next.prev=c.prev,c.prev.next=c.next,c.prevZ&&(c.prevZ.nextZ=c.nextZ),c.nextZ&&(c.nextZ.prevZ=c.prevZ)}function Mm(c,s,h){return{i:c,x:s,y:h,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function Bc(c,s,h){const p=h.patternDependencies;let x=!1;for(const C of s){const T=C.paint.get(`${c}-pattern`);T.isConstant()||(x=!0);const R=T.constantOr(null);R&&(x=!0,p[R.to]=!0,p[R.from]=!0)}return x}function Ex(c,s,h,p,x){const C=x.patternDependencies;for(const T of s){const R=T.paint.get(`${c}-pattern`).value;if(R.kind!=="constant"){let F=R.evaluate({zoom:p-1},h,{},x.availableImages),U=R.evaluate({zoom:p},h,{},x.availableImages),G=R.evaluate({zoom:p+1},h,{},x.availableImages);F=F&&F.name?F.name:F,U=U&&U.name?U.name:U,G=G&&G.name?G.name:G,C[F]=!0,C[U]=!0,C[G]=!0,h.patterns[T.id]={min:F,mid:U,max:G}}}return h}class Cm{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(h=>h.id),this.index=s.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Pu,this.indexArray=new ts,this.indexArray2=new vr,this.programConfigurations=new ku(s.layers,s.zoom),this.segments=new Xr,this.segments2=new Xr,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(s,h,p){this.hasPattern=Bc("fill",this.layers,h);const x=this.layers[0].layout.get("fill-sort-key"),C=!x.isConstant(),T=[];for(const{feature:R,id:F,index:U,sourceLayerIndex:G}of s){const Y=this.layers[0]._featureFilter.needGeometry,ee=Du(R,Y);if(!this.layers[0]._featureFilter.filter(new tr(this.zoom),ee,p))continue;const ae=C?x.evaluate(ee,{},p,h.availableImages):void 0,ue={id:F,properties:R.properties,type:R.type,sourceLayerIndex:G,index:U,geometry:Y?ee.geometry:Fc(R),patterns:{},sortKey:ae};T.push(ue)}C&&T.sort((R,F)=>R.sortKey-F.sortKey);for(const R of T){const{geometry:F,index:U,sourceLayerIndex:G}=R;if(this.hasPattern){const Y=Ex("fill",this.layers,R,this.zoom,h);this.patternFeatures.push(Y)}else this.addFeature(R,F,U,p,{});h.featureIndex.insert(s[U].feature,F,U,G,this.index)}}update(s,h,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,h,this.stateDependentLayers,p)}addFeatures(s,h,p){for(const x of this.patternFeatures)this.addFeature(x,x.geometry,x.index,h,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,C0),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.indexBuffer2=s.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(s,h,p,x,C){for(const T of ta(h,500)){let R=0;for(const ae of T)R+=ae.length;const F=this.segments.prepareSegment(R,this.layoutVertexArray,this.indexArray),U=F.vertexLength,G=[],Y=[];for(const ae of T){if(ae.length===0)continue;ae!==T[0]&&Y.push(G.length/2);const ue=this.segments2.prepareSegment(ae.length,this.layoutVertexArray,this.indexArray2),pe=ue.vertexLength;this.layoutVertexArray.emplaceBack(ae[0].x,ae[0].y),this.indexArray2.emplaceBack(pe+ae.length-1,pe),G.push(ae[0].x),G.push(ae[0].y);for(let Ae=1;Ae<ae.length;Ae++)this.layoutVertexArray.emplaceBack(ae[Ae].x,ae[Ae].y),this.indexArray2.emplaceBack(pe+Ae-1,pe+Ae),G.push(ae[Ae].x),G.push(ae[Ae].y);ue.vertexLength+=ae.length,ue.primitiveLength+=ae.length}const ee=T0(G,Y);for(let ae=0;ae<ee.length;ae+=3)this.indexArray.emplaceBack(U+ee[ae],U+ee[ae+1],U+ee[ae+2]);F.vertexLength+=R,F.primitiveLength+=ee.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,p,C,x)}}let Mx,zs;dn("FillBucket",Cm,{omit:["layers","patternFeatures"]});var sR={get paint(){return zs=zs||new v({"fill-antialias":new Tn(Ue.paint_fill["fill-antialias"]),"fill-opacity":new An(Ue.paint_fill["fill-opacity"]),"fill-color":new An(Ue.paint_fill["fill-color"]),"fill-outline-color":new An(Ue.paint_fill["fill-outline-color"]),"fill-translate":new Tn(Ue.paint_fill["fill-translate"]),"fill-translate-anchor":new Tn(Ue.paint_fill["fill-translate-anchor"]),"fill-pattern":new M(Ue.paint_fill["fill-pattern"])})},get layout(){return Mx=Mx||new v({"fill-sort-key":new An(Ue.layout_fill["fill-sort-key"])})}};class oR extends E{constructor(s){super(s,sR)}recalculate(s,h){super.recalculate(s,h);const p=this.paint._values["fill-outline-color"];p.value.kind==="constant"&&p.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(s){return new Cm(s)}queryRadius(){return bm(this.paint.get("fill-translate"))}queryIntersectsFeature(s,h,p,x,C,T,R){return yx(wm(s,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),T.angle,R),x)}isTileClipped(){return!0}}const $2=H([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),aR=H([{name:"a_centroid",components:2,type:"Int16"}],4),{members:H2}=$2;var zu={},lR=g,G2=No;function No(c,s,h,p,x){this.properties={},this.extent=h,this.type=0,this._pbf=c,this._geometry=-1,this._keys=p,this._values=x,c.readFields(xo,this,s)}function xo(c,s,h){c==1?s.id=h.readVarint():c==2?function(p,x){for(var C=p.readVarint()+p.pos;p.pos<C;){var T=x._keys[p.readVarint()],R=x._values[p.readVarint()];x.properties[T]=R}}(h,s):c==3?s.type=h.readVarint():c==4&&(s._geometry=h.pos)}function Cx(c){for(var s,h,p=0,x=0,C=c.length,T=C-1;x<C;T=x++)p+=((h=c[T]).x-(s=c[x]).x)*(s.y+h.y);return p}No.types=["Unknown","Point","LineString","Polygon"],No.prototype.loadGeometry=function(){var c=this._pbf;c.pos=this._geometry;for(var s,h=c.readVarint()+c.pos,p=1,x=0,C=0,T=0,R=[];c.pos<h;){if(x<=0){var F=c.readVarint();p=7&F,x=F>>3}if(x--,p===1||p===2)C+=c.readSVarint(),T+=c.readSVarint(),p===1&&(s&&R.push(s),s=[]),s.push(new lR(C,T));else{if(p!==7)throw new Error("unknown command "+p);s&&s.push(s[0].clone())}}return s&&R.push(s),R},No.prototype.bbox=function(){var c=this._pbf;c.pos=this._geometry;for(var s=c.readVarint()+c.pos,h=1,p=0,x=0,C=0,T=1/0,R=-1/0,F=1/0,U=-1/0;c.pos<s;){if(p<=0){var G=c.readVarint();h=7&G,p=G>>3}if(p--,h===1||h===2)(x+=c.readSVarint())<T&&(T=x),x>R&&(R=x),(C+=c.readSVarint())<F&&(F=C),C>U&&(U=C);else if(h!==7)throw new Error("unknown command "+h)}return[T,F,R,U]},No.prototype.toGeoJSON=function(c,s,h){var p,x,C=this.extent*Math.pow(2,h),T=this.extent*c,R=this.extent*s,F=this.loadGeometry(),U=No.types[this.type];function G(ae){for(var ue=0;ue<ae.length;ue++){var pe=ae[ue];ae[ue]=[360*(pe.x+T)/C-180,360/Math.PI*Math.atan(Math.exp((180-360*(pe.y+R)/C)*Math.PI/180))-90]}}switch(this.type){case 1:var Y=[];for(p=0;p<F.length;p++)Y[p]=F[p][0];G(F=Y);break;case 2:for(p=0;p<F.length;p++)G(F[p]);break;case 3:for(F=function(ae){var ue=ae.length;if(ue<=1)return[ae];for(var pe,Ae,Oe=[],tt=0;tt<ue;tt++){var Le=Cx(ae[tt]);Le!==0&&(Ae===void 0&&(Ae=Le<0),Ae===Le<0?(pe&&Oe.push(pe),pe=[ae[tt]]):pe.push(ae[tt]))}return pe&&Oe.push(pe),Oe}(F),p=0;p<F.length;p++)for(x=0;x<F[p].length;x++)G(F[p][x])}F.length===1?F=F[0]:U="Multi"+U;var ee={type:"Feature",geometry:{type:U,coordinates:F},properties:this.properties};return"id"in this&&(ee.id=this.id),ee};var cR=G2,R0=W2;function W2(c,s){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=c,this._keys=[],this._values=[],this._features=[],c.readFields(uR,this,s),this.length=this._features.length}function uR(c,s,h){c===15?s.version=h.readVarint():c===1?s.name=h.readString():c===5?s.extent=h.readVarint():c===2?s._features.push(h.pos):c===3?s._keys.push(h.readString()):c===4&&s._values.push(function(p){for(var x=null,C=p.readVarint()+p.pos;p.pos<C;){var T=p.readVarint()>>3;x=T===1?p.readString():T===2?p.readFloat():T===3?p.readDouble():T===4?p.readVarint64():T===5?p.readVarint():T===6?p.readSVarint():T===7?p.readBoolean():null}return x}(h))}W2.prototype.feature=function(c){if(c<0||c>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[c];var s=this._pbf.readVarint()+this._pbf.pos;return new cR(this._pbf,s,this.extent,this._keys,this._values)};var Tm=R0;function j2(c,s,h){if(c===3){var p=new Tm(h,h.readVarint()+h.pos);p.length&&(s[p.name]=p)}}zu.VectorTile=function(c,s){this.layers=c.readFields(j2,{},s)},zu.VectorTileFeature=G2,zu.VectorTileLayer=R0;const q2=zu.VectorTileFeature.types,Tx=Math.pow(2,13);function Am(c,s,h,p,x,C,T,R){c.emplaceBack(s,h,2*Math.floor(p*Tx)+T,x*Tx*2,C*Tx*2,Math.round(R))}class Ax{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(h=>h.id),this.index=s.index,this.hasPattern=!1,this.layoutVertexArray=new Oc,this.centroidVertexArray=new Rr,this.indexArray=new ts,this.programConfigurations=new ku(s.layers,s.zoom),this.segments=new Xr,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(s,h,p){this.features=[],this.hasPattern=Bc("fill-extrusion",this.layers,h);for(const{feature:x,id:C,index:T,sourceLayerIndex:R}of s){const F=this.layers[0]._featureFilter.needGeometry,U=Du(x,F);if(!this.layers[0]._featureFilter.filter(new tr(this.zoom),U,p))continue;const G={id:C,sourceLayerIndex:R,index:T,geometry:F?U.geometry:Fc(x),properties:x.properties,type:x.type,patterns:{}};this.hasPattern?this.features.push(Ex("fill-extrusion",this.layers,G,this.zoom,h)):this.addFeature(G,G.geometry,T,p,{}),h.featureIndex.insert(x,G.geometry,T,R,this.index,!0)}}addFeatures(s,h,p){for(const x of this.features){const{geometry:C}=x;this.addFeature(x,C,x.index,h,p)}}update(s,h,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,h,this.stateDependentLayers,p)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,H2),this.centroidVertexBuffer=s.createVertexBuffer(this.centroidVertexArray,aR.members,!0),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(s,h,p,x,C){for(const T of ta(h,500)){const R={x:0,y:0,vertexCount:0};let F=0;for(const ue of T)F+=ue.length;let U=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const ue of T){if(ue.length===0||X2(ue))continue;let pe=0;for(let Ae=0;Ae<ue.length;Ae++){const Oe=ue[Ae];if(Ae>=1){const tt=ue[Ae-1];if(!hR(Oe,tt)){U.vertexLength+4>Xr.MAX_VERTEX_ARRAY_LENGTH&&(U=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const Le=Oe.sub(tt)._perp()._unit(),Qe=tt.dist(Oe);pe+Qe>32768&&(pe=0),Am(this.layoutVertexArray,Oe.x,Oe.y,Le.x,Le.y,0,0,pe),Am(this.layoutVertexArray,Oe.x,Oe.y,Le.x,Le.y,0,1,pe),R.x+=2*Oe.x,R.y+=2*Oe.y,R.vertexCount+=2,pe+=Qe,Am(this.layoutVertexArray,tt.x,tt.y,Le.x,Le.y,0,0,pe),Am(this.layoutVertexArray,tt.x,tt.y,Le.x,Le.y,0,1,pe),R.x+=2*tt.x,R.y+=2*tt.y,R.vertexCount+=2;const dt=U.vertexLength;this.indexArray.emplaceBack(dt,dt+2,dt+1),this.indexArray.emplaceBack(dt+1,dt+2,dt+3),U.vertexLength+=4,U.primitiveLength+=2}}}}if(U.vertexLength+F>Xr.MAX_VERTEX_ARRAY_LENGTH&&(U=this.segments.prepareSegment(F,this.layoutVertexArray,this.indexArray)),q2[s.type]!=="Polygon")continue;const G=[],Y=[],ee=U.vertexLength;for(const ue of T)if(ue.length!==0){ue!==T[0]&&Y.push(G.length/2);for(let pe=0;pe<ue.length;pe++){const Ae=ue[pe];Am(this.layoutVertexArray,Ae.x,Ae.y,0,0,1,1,0),R.x+=Ae.x,R.y+=Ae.y,R.vertexCount+=1,G.push(Ae.x),G.push(Ae.y)}}const ae=T0(G,Y);for(let ue=0;ue<ae.length;ue+=3)this.indexArray.emplaceBack(ee+ae[ue],ee+ae[ue+2],ee+ae[ue+1]);U.primitiveLength+=ae.length/3,U.vertexLength+=F;for(let ue=0;ue<R.vertexCount;ue++){const pe=Math.floor(R.x/R.vertexCount),Ae=Math.floor(R.y/R.vertexCount);this.centroidVertexArray.emplaceBack(pe,Ae)}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,p,C,x)}}function hR(c,s){return c.x===s.x&&(c.x<0||c.x>Oi)||c.y===s.y&&(c.y<0||c.y>Oi)}function X2(c){return c.every(s=>s.x<0)||c.every(s=>s.x>Oi)||c.every(s=>s.y<0)||c.every(s=>s.y>Oi)}let Px;dn("FillExtrusionBucket",Ax,{omit:["layers","features"]});var dR={get paint(){return Px=Px||new v({"fill-extrusion-opacity":new Tn(Ue["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new An(Ue["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Tn(Ue["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Tn(Ue["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new M(Ue["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new An(Ue["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new An(Ue["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Tn(Ue["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class Ix extends E{constructor(s){super(s,dR)}createBucket(s){return new Ax(s)}queryRadius(){return bm(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(s,h,p,x,C,T,R,F){const U=wm(s,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),T.angle,R),G=this.paint.get("fill-extrusion-height").evaluate(h,p),Y=this.paint.get("fill-extrusion-base").evaluate(h,p),ee=function(ue,pe,Ae,Oe){const tt=[];for(const Le of ue){const Qe=[Le.x,Le.y,0,1];Fs(Qe,Qe,pe),tt.push(new S(Qe[0]/Qe[3],Qe[1]/Qe[3]))}return tt}(U,F),ae=function(ue,pe,Ae,Oe){const tt=[],Le=[],Qe=Oe[8]*pe,dt=Oe[9]*pe,Ut=Oe[10]*pe,cn=Oe[11]*pe,nn=Oe[8]*Ae,ln=Oe[9]*Ae,rn=Oe[10]*Ae,xn=Oe[11]*Ae;for(const mn of ue){const hn=[],St=[];for(const Pn of mn){const wn=Pn.x,Hn=Pn.y,Zi=Oe[0]*wn+Oe[4]*Hn+Oe[12],Wi=Oe[1]*wn+Oe[5]*Hn+Oe[13],ns=Oe[2]*wn+Oe[6]*Hn+Oe[14],La=Oe[3]*wn+Oe[7]*Hn+Oe[15],bs=ns+Ut,Er=La+cn,to=Zi+nn,ws=Wi+ln,no=ns+rn,yr=La+xn,is=new S((Zi+Qe)/Er,(Wi+dt)/Er);is.z=bs/Er,hn.push(is);const Ns=new S(to/yr,ws/yr);Ns.z=no/yr,St.push(Ns)}tt.push(hn),Le.push(St)}return[tt,Le]}(x,Y,G,F);return function(ue,pe,Ae){let Oe=1/0;yx(Ae,pe)&&(Oe=Nf(Ae,pe[0]));for(let tt=0;tt<pe.length;tt++){const Le=pe[tt],Qe=ue[tt];for(let dt=0;dt<Le.length-1;dt++){const Ut=Le[dt],cn=[Ut,Le[dt+1],Qe[dt+1],Qe[dt],Ut];zc(Ae,cn)&&(Oe=Math.min(Oe,Nf(Ae,cn)))}}return Oe!==1/0&&Oe}(ae[0],ae[1],ee)}}function zf(c,s){return c.x*s.x+c.y*s.y}function Nf(c,s){if(c.length===1){let h=0;const p=s[h++];let x;for(;!x||p.equals(x);)if(x=s[h++],!x)return 1/0;for(;h<s.length;h++){const C=s[h],T=c[0],R=x.sub(p),F=C.sub(p),U=T.sub(p),G=zf(R,R),Y=zf(R,F),ee=zf(F,F),ae=zf(U,R),ue=zf(U,F),pe=G*ee-Y*Y,Ae=(ee*ae-Y*ue)/pe,Oe=(G*ue-Y*ae)/pe,tt=p.z*(1-Ae-Oe)+x.z*Ae+C.z*Oe;if(isFinite(tt))return tt}return 1/0}{let h=1/0;for(const p of s)h=Math.min(h,p.z);return h}}const Rx=H([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Z2}=Rx,Y2=H([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:L0}=Y2,K2=zu.VectorTileFeature.types,Yl=Math.cos(Math.PI/180*37.5),Nu=Math.pow(2,14)/.5;class Lx{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(h=>h.id),this.index=s.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(h=>{this.gradients[h.id]={}}),this.layoutVertexArray=new Ef,this.layoutVertexArray2=new Bh,this.indexArray=new ts,this.programConfigurations=new ku(s.layers,s.zoom),this.segments=new Xr,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(s,h,p){this.hasPattern=Bc("line",this.layers,h);const x=this.layers[0].layout.get("line-sort-key"),C=!x.isConstant(),T=[];for(const{feature:R,id:F,index:U,sourceLayerIndex:G}of s){const Y=this.layers[0]._featureFilter.needGeometry,ee=Du(R,Y);if(!this.layers[0]._featureFilter.filter(new tr(this.zoom),ee,p))continue;const ae=C?x.evaluate(ee,{},p):void 0,ue={id:F,properties:R.properties,type:R.type,sourceLayerIndex:G,index:U,geometry:Y?ee.geometry:Fc(R),patterns:{},sortKey:ae};T.push(ue)}C&&T.sort((R,F)=>R.sortKey-F.sortKey);for(const R of T){const{geometry:F,index:U,sourceLayerIndex:G}=R;if(this.hasPattern){const Y=Ex("line",this.layers,R,this.zoom,h);this.patternFeatures.push(Y)}else this.addFeature(R,F,U,p,{});h.featureIndex.insert(s[U].feature,F,U,G,this.index)}}update(s,h,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,h,this.stateDependentLayers,p)}addFeatures(s,h,p){for(const x of this.patternFeatures)this.addFeature(x,x.geometry,x.index,h,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=s.createVertexBuffer(this.layoutVertexArray2,L0)),this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,Z2),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(s){if(s.properties&&Object.prototype.hasOwnProperty.call(s.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(s.properties,"mapbox_clip_end"))return{start:+s.properties.mapbox_clip_start,end:+s.properties.mapbox_clip_end}}addFeature(s,h,p,x,C){const T=this.layers[0].layout,R=T.get("line-join").evaluate(s,{}),F=T.get("line-cap"),U=T.get("line-miter-limit"),G=T.get("line-round-limit");this.lineClips=this.lineFeatureClips(s);for(const Y of h)this.addLine(Y,s,R,F,U,G);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,p,C,x)}addLine(s,h,p,x,C,T){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Oe=0;Oe<s.length-1;Oe++)this.totalDistance+=s[Oe].dist(s[Oe+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const R=K2[h.type]==="Polygon";let F=s.length;for(;F>=2&&s[F-1].equals(s[F-2]);)F--;let U=0;for(;U<F-1&&s[U].equals(s[U+1]);)U++;if(F<(R?3:2))return;p==="bevel"&&(C=1.05);const G=this.overscaling<=16?15*Oi/(512*this.overscaling):0,Y=this.segments.prepareSegment(10*F,this.layoutVertexArray,this.indexArray);let ee,ae,ue,pe,Ae;this.e1=this.e2=-1,R&&(ee=s[F-2],Ae=s[U].sub(ee)._unit()._perp());for(let Oe=U;Oe<F;Oe++){if(ue=Oe===F-1?R?s[U+1]:void 0:s[Oe+1],ue&&s[Oe].equals(ue))continue;Ae&&(pe=Ae),ee&&(ae=ee),ee=s[Oe],Ae=ue?ue.sub(ee)._unit()._perp():pe,pe=pe||Ae;let tt=pe.add(Ae);tt.x===0&&tt.y===0||tt._unit();const Le=pe.x*Ae.x+pe.y*Ae.y,Qe=tt.x*Ae.x+tt.y*Ae.y,dt=Qe!==0?1/Qe:1/0,Ut=2*Math.sqrt(2-2*Qe),cn=Qe<Yl&&ae&&ue,nn=pe.x*Ae.y-pe.y*Ae.x>0;if(cn&&Oe>U){const xn=ee.dist(ae);if(xn>2*G){const mn=ee.sub(ee.sub(ae)._mult(G/xn)._round());this.updateDistance(ae,mn),this.addCurrentVertex(mn,pe,0,0,Y),ae=mn}}const ln=ae&&ue;let rn=ln?p:R?"butt":x;if(ln&&rn==="round"&&(dt<T?rn="miter":dt<=2&&(rn="fakeround")),rn==="miter"&&dt>C&&(rn="bevel"),rn==="bevel"&&(dt>2&&(rn="flipbevel"),dt<C&&(rn="miter")),ae&&this.updateDistance(ae,ee),rn==="miter")tt._mult(dt),this.addCurrentVertex(ee,tt,0,0,Y);else if(rn==="flipbevel"){if(dt>100)tt=Ae.mult(-1);else{const xn=dt*pe.add(Ae).mag()/pe.sub(Ae).mag();tt._perp()._mult(xn*(nn?-1:1))}this.addCurrentVertex(ee,tt,0,0,Y),this.addCurrentVertex(ee,tt.mult(-1),0,0,Y)}else if(rn==="bevel"||rn==="fakeround"){const xn=-Math.sqrt(dt*dt-1),mn=nn?xn:0,hn=nn?0:xn;if(ae&&this.addCurrentVertex(ee,pe,mn,hn,Y),rn==="fakeround"){const St=Math.round(180*Ut/Math.PI/20);for(let Pn=1;Pn<St;Pn++){let wn=Pn/St;if(wn!==.5){const Zi=wn-.5;wn+=wn*Zi*(wn-1)*((1.0904+Le*(Le*(3.55645-1.43519*Le)-3.2452))*Zi*Zi+(.848013+Le*(.215638*Le-1.06021)))}const Hn=Ae.sub(pe)._mult(wn)._add(pe)._unit()._mult(nn?-1:1);this.addHalfVertex(ee,Hn.x,Hn.y,!1,nn,0,Y)}}ue&&this.addCurrentVertex(ee,Ae,-mn,-hn,Y)}else if(rn==="butt")this.addCurrentVertex(ee,tt,0,0,Y);else if(rn==="square"){const xn=ae?1:-1;this.addCurrentVertex(ee,tt,xn,xn,Y)}else rn==="round"&&(ae&&(this.addCurrentVertex(ee,pe,0,0,Y),this.addCurrentVertex(ee,pe,1,1,Y,!0)),ue&&(this.addCurrentVertex(ee,Ae,-1,-1,Y,!0),this.addCurrentVertex(ee,Ae,0,0,Y)));if(cn&&Oe<F-1){const xn=ee.dist(ue);if(xn>2*G){const mn=ee.add(ue.sub(ee)._mult(G/xn)._round());this.updateDistance(ee,mn),this.addCurrentVertex(mn,Ae,0,0,Y),ee=mn}}}}addCurrentVertex(s,h,p,x,C,T=!1){const R=h.y*x-h.x,F=-h.y-h.x*x;this.addHalfVertex(s,h.x+h.y*p,h.y-h.x*p,T,!1,p,C),this.addHalfVertex(s,R,F,T,!0,-x,C),this.distance>Nu/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(s,h,p,x,C,T))}addHalfVertex({x:s,y:h},p,x,C,T,R,F){const U=.5*(this.lineClips?this.scaledDistance*(Nu-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((s<<1)+(C?1:0),(h<<1)+(T?1:0),Math.round(63*p)+128,Math.round(63*x)+128,1+(R===0?0:R<0?-1:1)|(63&U)<<2,U>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const G=F.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,G),F.primitiveLength++),T?this.e2=G:this.e1=G}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(s,h){this.distance+=s.dist(h),this.updateScaledDistance()}}let kx,J2;dn("LineBucket",Lx,{omit:["layers","patternFeatures"]});var Q2={get paint(){return J2=J2||new v({"line-opacity":new An(Ue.paint_line["line-opacity"]),"line-color":new An(Ue.paint_line["line-color"]),"line-translate":new Tn(Ue.paint_line["line-translate"]),"line-translate-anchor":new Tn(Ue.paint_line["line-translate-anchor"]),"line-width":new An(Ue.paint_line["line-width"]),"line-gap-width":new An(Ue.paint_line["line-gap-width"]),"line-offset":new An(Ue.paint_line["line-offset"]),"line-blur":new An(Ue.paint_line["line-blur"]),"line-dasharray":new o(Ue.paint_line["line-dasharray"]),"line-pattern":new M(Ue.paint_line["line-pattern"]),"line-gradient":new d(Ue.paint_line["line-gradient"])})},get layout(){return kx=kx||new v({"line-cap":new Tn(Ue.layout_line["line-cap"]),"line-join":new An(Ue.layout_line["line-join"]),"line-miter-limit":new Tn(Ue.layout_line["line-miter-limit"]),"line-round-limit":new Tn(Ue.layout_line["line-round-limit"]),"line-sort-key":new An(Ue.layout_line["line-sort-key"])})}};class fR extends An{possiblyEvaluate(s,h){return h=new tr(Math.floor(h.zoom),{now:h.now,fadeDuration:h.fadeDuration,zoomHistory:h.zoomHistory,transition:h.transition}),super.possiblyEvaluate(s,h)}evaluate(s,h,p,x){return h=W({},h,{zoom:Math.floor(h.zoom)}),super.evaluate(s,h,p,x)}}let k0;class pR extends E{constructor(s){super(s,Q2),this.gradientVersion=0,k0||(k0=new fR(Q2.paint.properties["line-width"].specification),k0.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(s){if(s==="line-gradient"){const h=this.gradientExpression();this.stepInterpolant=!!function(p){return p._styleExpression!==void 0}(h)&&h._styleExpression.expression instanceof gu,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(s,h){super.recalculate(s,h),this.paint._values["line-floorwidth"]=k0.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,s)}createBucket(s){return new Lx(s)}queryRadius(s){const h=s,p=eE(Pa("line-width",this,h),Pa("line-gap-width",this,h)),x=Pa("line-offset",this,h);return p/2+Math.abs(x)+bm(this.paint.get("line-translate"))}queryIntersectsFeature(s,h,p,x,C,T,R){const F=wm(s,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),T.angle,R),U=R/2*eE(this.paint.get("line-width").evaluate(h,p),this.paint.get("line-gap-width").evaluate(h,p)),G=this.paint.get("line-offset").evaluate(h,p);return G&&(x=function(Y,ee){const ae=[];for(let ue=0;ue<Y.length;ue++){const pe=Y[ue],Ae=[];for(let Oe=0;Oe<pe.length;Oe++){const tt=pe[Oe-1],Le=pe[Oe],Qe=pe[Oe+1],dt=Oe===0?new S(0,0):Le.sub(tt)._unit()._perp(),Ut=Oe===pe.length-1?new S(0,0):Qe.sub(Le)._unit()._perp(),cn=dt._add(Ut)._unit(),nn=cn.x*Ut.x+cn.y*Ut.y;nn!==0&&cn._mult(1/nn),Ae.push(cn._mult(ee)._add(Le))}ae.push(Ae)}return ae}(x,G*R)),function(Y,ee,ae){for(let ue=0;ue<ee.length;ue++){const pe=ee[ue];if(Y.length>=3){for(let Ae=0;Ae<pe.length;Ae++)if(sa(Y,pe[Ae]))return!0}if(v0(Y,pe,ae))return!0}return!1}(F,x,U)}isTileClipped(){return!0}}function eE(c,s){return s>0?s+2*c:c}const mR=H([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),gR=H([{name:"a_projected_pos",components:3,type:"Float32"}],4);H([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const vR=H([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);H([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const tE=H([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),yR=H([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function nE(c,s,h){return c.sections.forEach(p=>{p.text=function(x,C,T){const R=C.layout.get("text-transform").evaluate(T,{});return R==="uppercase"?x=x.toLocaleUpperCase():R==="lowercase"&&(x=x.toLocaleLowerCase()),ql.applyArabicShaping&&(x=ql.applyArabicShaping(x)),x}(p.text,s,h)}),c}H([{name:"triangle",components:3,type:"Uint16"}]),H([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),H([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),H([{type:"Float32",name:"offsetX"}]),H([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),H([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Bf={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var Ur=24,iE=Bi,rE=function(c,s,h,p,x){var C,T,R=8*x-p-1,F=(1<<R)-1,U=F>>1,G=-7,Y=x-1,ee=-1,ae=c[s+Y];for(Y+=ee,C=ae&(1<<-G)-1,ae>>=-G,G+=R;G>0;C=256*C+c[s+Y],Y+=ee,G-=8);for(T=C&(1<<-G)-1,C>>=-G,G+=p;G>0;T=256*T+c[s+Y],Y+=ee,G-=8);if(C===0)C=1-U;else{if(C===F)return T?NaN:1/0*(ae?-1:1);T+=Math.pow(2,p),C-=U}return(ae?-1:1)*T*Math.pow(2,C-p)},sE=function(c,s,h,p,x,C){var T,R,F,U=8*C-x-1,G=(1<<U)-1,Y=G>>1,ee=x===23?Math.pow(2,-24)-Math.pow(2,-77):0,ae=0,ue=1,pe=s<0||s===0&&1/s<0?1:0;for(s=Math.abs(s),isNaN(s)||s===1/0?(R=isNaN(s)?1:0,T=G):(T=Math.floor(Math.log(s)/Math.LN2),s*(F=Math.pow(2,-T))<1&&(T--,F*=2),(s+=T+Y>=1?ee/F:ee*Math.pow(2,1-Y))*F>=2&&(T++,F/=2),T+Y>=G?(R=0,T=G):T+Y>=1?(R=(s*F-1)*Math.pow(2,x),T+=Y):(R=s*Math.pow(2,Y-1)*Math.pow(2,x),T=0));x>=8;c[h+ae]=255&R,ae+=ue,R/=256,x-=8);for(T=T<<x|R,U+=x;U>0;c[h+ae]=255&T,ae+=ue,T/=256,U-=8);c[h+ae-ue]|=128*pe};function Bi(c){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(c)?c:new Uint8Array(c||0),this.pos=0,this.type=0,this.length=this.buf.length}Bi.Varint=0,Bi.Fixed64=1,Bi.Bytes=2,Bi.Fixed32=5;var Dx=4294967296,oE=1/Dx,aE=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function Uc(c){return c.type===Bi.Bytes?c.readVarint()+c.pos:c.pos+1}function Uf(c,s,h){return h?4294967296*s+(c>>>0):4294967296*(s>>>0)+(c>>>0)}function lE(c,s,h){var p=s<=16383?1:s<=2097151?2:s<=268435455?3:Math.floor(Math.log(s)/(7*Math.LN2));h.realloc(p);for(var x=h.pos-1;x>=c;x--)h.buf[x+p]=h.buf[x]}function Ra(c,s){for(var h=0;h<c.length;h++)s.writeVarint(c[h])}function _R(c,s){for(var h=0;h<c.length;h++)s.writeSVarint(c[h])}function xR(c,s){for(var h=0;h<c.length;h++)s.writeFloat(c[h])}function bR(c,s){for(var h=0;h<c.length;h++)s.writeDouble(c[h])}function cE(c,s){for(var h=0;h<c.length;h++)s.writeBoolean(c[h])}function wR(c,s){for(var h=0;h<c.length;h++)s.writeFixed32(c[h])}function SR(c,s){for(var h=0;h<c.length;h++)s.writeSFixed32(c[h])}function ER(c,s){for(var h=0;h<c.length;h++)s.writeFixed64(c[h])}function MR(c,s){for(var h=0;h<c.length;h++)s.writeSFixed64(c[h])}function Vf(c,s){return(c[s]|c[s+1]<<8|c[s+2]<<16)+16777216*c[s+3]}function $f(c,s,h){c[h]=s,c[h+1]=s>>>8,c[h+2]=s>>>16,c[h+3]=s>>>24}function uE(c,s){return(c[s]|c[s+1]<<8|c[s+2]<<16)+(c[s+3]<<24)}Bi.prototype={destroy:function(){this.buf=null},readFields:function(c,s,h){for(h=h||this.length;this.pos<h;){var p=this.readVarint(),x=p>>3,C=this.pos;this.type=7&p,c(x,s,this),this.pos===C&&this.skip(p)}return s},readMessage:function(c,s){return this.readFields(c,s,this.readVarint()+this.pos)},readFixed32:function(){var c=Vf(this.buf,this.pos);return this.pos+=4,c},readSFixed32:function(){var c=uE(this.buf,this.pos);return this.pos+=4,c},readFixed64:function(){var c=Vf(this.buf,this.pos)+Vf(this.buf,this.pos+4)*Dx;return this.pos+=8,c},readSFixed64:function(){var c=Vf(this.buf,this.pos)+uE(this.buf,this.pos+4)*Dx;return this.pos+=8,c},readFloat:function(){var c=rE(this.buf,this.pos,!0,23,4);return this.pos+=4,c},readDouble:function(){var c=rE(this.buf,this.pos,!0,52,8);return this.pos+=8,c},readVarint:function(c){var s,h,p=this.buf;return s=127&(h=p[this.pos++]),h<128?s:(s|=(127&(h=p[this.pos++]))<<7,h<128?s:(s|=(127&(h=p[this.pos++]))<<14,h<128?s:(s|=(127&(h=p[this.pos++]))<<21,h<128?s:function(x,C,T){var R,F,U=T.buf;if(R=(112&(F=U[T.pos++]))>>4,F<128||(R|=(127&(F=U[T.pos++]))<<3,F<128)||(R|=(127&(F=U[T.pos++]))<<10,F<128)||(R|=(127&(F=U[T.pos++]))<<17,F<128)||(R|=(127&(F=U[T.pos++]))<<24,F<128)||(R|=(1&(F=U[T.pos++]))<<31,F<128))return Uf(x,R,C);throw new Error("Expected varint not more than 10 bytes")}(s|=(15&(h=p[this.pos]))<<28,c,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var c=this.readVarint();return c%2==1?(c+1)/-2:c/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var c=this.readVarint()+this.pos,s=this.pos;return this.pos=c,c-s>=12&&aE?function(h,p,x){return aE.decode(h.subarray(p,x))}(this.buf,s,c):function(h,p,x){for(var C="",T=p;T<x;){var R,F,U,G=h[T],Y=null,ee=G>239?4:G>223?3:G>191?2:1;if(T+ee>x)break;ee===1?G<128&&(Y=G):ee===2?(192&(R=h[T+1]))==128&&(Y=(31&G)<<6|63&R)<=127&&(Y=null):ee===3?(F=h[T+2],(192&(R=h[T+1]))==128&&(192&F)==128&&((Y=(15&G)<<12|(63&R)<<6|63&F)<=2047||Y>=55296&&Y<=57343)&&(Y=null)):ee===4&&(F=h[T+2],U=h[T+3],(192&(R=h[T+1]))==128&&(192&F)==128&&(192&U)==128&&((Y=(15&G)<<18|(63&R)<<12|(63&F)<<6|63&U)<=65535||Y>=1114112)&&(Y=null)),Y===null?(Y=65533,ee=1):Y>65535&&(Y-=65536,C+=String.fromCharCode(Y>>>10&1023|55296),Y=56320|1023&Y),C+=String.fromCharCode(Y),T+=ee}return C}(this.buf,s,c)},readBytes:function(){var c=this.readVarint()+this.pos,s=this.buf.subarray(this.pos,c);return this.pos=c,s},readPackedVarint:function(c,s){if(this.type!==Bi.Bytes)return c.push(this.readVarint(s));var h=Uc(this);for(c=c||[];this.pos<h;)c.push(this.readVarint(s));return c},readPackedSVarint:function(c){if(this.type!==Bi.Bytes)return c.push(this.readSVarint());var s=Uc(this);for(c=c||[];this.pos<s;)c.push(this.readSVarint());return c},readPackedBoolean:function(c){if(this.type!==Bi.Bytes)return c.push(this.readBoolean());var s=Uc(this);for(c=c||[];this.pos<s;)c.push(this.readBoolean());return c},readPackedFloat:function(c){if(this.type!==Bi.Bytes)return c.push(this.readFloat());var s=Uc(this);for(c=c||[];this.pos<s;)c.push(this.readFloat());return c},readPackedDouble:function(c){if(this.type!==Bi.Bytes)return c.push(this.readDouble());var s=Uc(this);for(c=c||[];this.pos<s;)c.push(this.readDouble());return c},readPackedFixed32:function(c){if(this.type!==Bi.Bytes)return c.push(this.readFixed32());var s=Uc(this);for(c=c||[];this.pos<s;)c.push(this.readFixed32());return c},readPackedSFixed32:function(c){if(this.type!==Bi.Bytes)return c.push(this.readSFixed32());var s=Uc(this);for(c=c||[];this.pos<s;)c.push(this.readSFixed32());return c},readPackedFixed64:function(c){if(this.type!==Bi.Bytes)return c.push(this.readFixed64());var s=Uc(this);for(c=c||[];this.pos<s;)c.push(this.readFixed64());return c},readPackedSFixed64:function(c){if(this.type!==Bi.Bytes)return c.push(this.readSFixed64());var s=Uc(this);for(c=c||[];this.pos<s;)c.push(this.readSFixed64());return c},skip:function(c){var s=7&c;if(s===Bi.Varint)for(;this.buf[this.pos++]>127;);else if(s===Bi.Bytes)this.pos=this.readVarint()+this.pos;else if(s===Bi.Fixed32)this.pos+=4;else{if(s!==Bi.Fixed64)throw new Error("Unimplemented type: "+s);this.pos+=8}},writeTag:function(c,s){this.writeVarint(c<<3|s)},realloc:function(c){for(var s=this.length||16;s<this.pos+c;)s*=2;if(s!==this.length){var h=new Uint8Array(s);h.set(this.buf),this.buf=h,this.length=s}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(c){this.realloc(4),$f(this.buf,c,this.pos),this.pos+=4},writeSFixed32:function(c){this.realloc(4),$f(this.buf,c,this.pos),this.pos+=4},writeFixed64:function(c){this.realloc(8),$f(this.buf,-1&c,this.pos),$f(this.buf,Math.floor(c*oE),this.pos+4),this.pos+=8},writeSFixed64:function(c){this.realloc(8),$f(this.buf,-1&c,this.pos),$f(this.buf,Math.floor(c*oE),this.pos+4),this.pos+=8},writeVarint:function(c){(c=+c||0)>268435455||c<0?function(s,h){var p,x;if(s>=0?(p=s%4294967296|0,x=s/4294967296|0):(x=~(-s/4294967296),4294967295^(p=~(-s%4294967296))?p=p+1|0:(p=0,x=x+1|0)),s>=18446744073709552e3||s<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");h.realloc(10),function(C,T,R){R.buf[R.pos++]=127&C|128,C>>>=7,R.buf[R.pos++]=127&C|128,C>>>=7,R.buf[R.pos++]=127&C|128,C>>>=7,R.buf[R.pos++]=127&C|128,R.buf[R.pos]=127&(C>>>=7)}(p,0,h),function(C,T){var R=(7&C)<<4;T.buf[T.pos++]|=R|((C>>>=3)?128:0),C&&(T.buf[T.pos++]=127&C|((C>>>=7)?128:0),C&&(T.buf[T.pos++]=127&C|((C>>>=7)?128:0),C&&(T.buf[T.pos++]=127&C|((C>>>=7)?128:0),C&&(T.buf[T.pos++]=127&C|((C>>>=7)?128:0),C&&(T.buf[T.pos++]=127&C)))))}(x,h)}(c,this):(this.realloc(4),this.buf[this.pos++]=127&c|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=c>>>7&127))))},writeSVarint:function(c){this.writeVarint(c<0?2*-c-1:2*c)},writeBoolean:function(c){this.writeVarint(!!c)},writeString:function(c){c=String(c),this.realloc(4*c.length),this.pos++;var s=this.pos;this.pos=function(p,x,C){for(var T,R,F=0;F<x.length;F++){if((T=x.charCodeAt(F))>55295&&T<57344){if(!R){T>56319||F+1===x.length?(p[C++]=239,p[C++]=191,p[C++]=189):R=T;continue}if(T<56320){p[C++]=239,p[C++]=191,p[C++]=189,R=T;continue}T=R-55296<<10|T-56320|65536,R=null}else R&&(p[C++]=239,p[C++]=191,p[C++]=189,R=null);T<128?p[C++]=T:(T<2048?p[C++]=T>>6|192:(T<65536?p[C++]=T>>12|224:(p[C++]=T>>18|240,p[C++]=T>>12&63|128),p[C++]=T>>6&63|128),p[C++]=63&T|128)}return C}(this.buf,c,this.pos);var h=this.pos-s;h>=128&&lE(s,h,this),this.pos=s-1,this.writeVarint(h),this.pos+=h},writeFloat:function(c){this.realloc(4),sE(this.buf,c,this.pos,!0,23,4),this.pos+=4},writeDouble:function(c){this.realloc(8),sE(this.buf,c,this.pos,!0,52,8),this.pos+=8},writeBytes:function(c){var s=c.length;this.writeVarint(s),this.realloc(s);for(var h=0;h<s;h++)this.buf[this.pos++]=c[h]},writeRawMessage:function(c,s){this.pos++;var h=this.pos;c(s,this);var p=this.pos-h;p>=128&&lE(h,p,this),this.pos=h-1,this.writeVarint(p),this.pos+=p},writeMessage:function(c,s,h){this.writeTag(c,Bi.Bytes),this.writeRawMessage(s,h)},writePackedVarint:function(c,s){s.length&&this.writeMessage(c,Ra,s)},writePackedSVarint:function(c,s){s.length&&this.writeMessage(c,_R,s)},writePackedBoolean:function(c,s){s.length&&this.writeMessage(c,cE,s)},writePackedFloat:function(c,s){s.length&&this.writeMessage(c,xR,s)},writePackedDouble:function(c,s){s.length&&this.writeMessage(c,bR,s)},writePackedFixed32:function(c,s){s.length&&this.writeMessage(c,wR,s)},writePackedSFixed32:function(c,s){s.length&&this.writeMessage(c,SR,s)},writePackedFixed64:function(c,s){s.length&&this.writeMessage(c,ER,s)},writePackedSFixed64:function(c,s){s.length&&this.writeMessage(c,MR,s)},writeBytesField:function(c,s){this.writeTag(c,Bi.Bytes),this.writeBytes(s)},writeFixed32Field:function(c,s){this.writeTag(c,Bi.Fixed32),this.writeFixed32(s)},writeSFixed32Field:function(c,s){this.writeTag(c,Bi.Fixed32),this.writeSFixed32(s)},writeFixed64Field:function(c,s){this.writeTag(c,Bi.Fixed64),this.writeFixed64(s)},writeSFixed64Field:function(c,s){this.writeTag(c,Bi.Fixed64),this.writeSFixed64(s)},writeVarintField:function(c,s){this.writeTag(c,Bi.Varint),this.writeVarint(s)},writeSVarintField:function(c,s){this.writeTag(c,Bi.Varint),this.writeSVarint(s)},writeStringField:function(c,s){this.writeTag(c,Bi.Bytes),this.writeString(s)},writeFloatField:function(c,s){this.writeTag(c,Bi.Fixed32),this.writeFloat(s)},writeDoubleField:function(c,s){this.writeTag(c,Bi.Fixed64),this.writeDouble(s)},writeBooleanField:function(c,s){this.writeVarintField(c,!!s)}};var Ox=f(iE);const Fx=3;function CR(c,s,h){c===1&&h.readMessage(TR,s)}function TR(c,s,h){if(c===3){const{id:p,bitmap:x,width:C,height:T,left:R,top:F,advance:U}=h.readMessage(AR,{});s.push({id:p,bitmap:new Lf({width:C+2*Fx,height:T+2*Fx},x),metrics:{width:C,height:T,left:R,top:F,advance:U}})}}function AR(c,s,h){c===1?s.id=h.readVarint():c===2?s.bitmap=h.readBytes():c===3?s.width=h.readVarint():c===4?s.height=h.readVarint():c===5?s.left=h.readSVarint():c===6?s.top=h.readSVarint():c===7&&(s.advance=h.readVarint())}const PR=Fx;function hE(c){let s=0,h=0;for(const T of c)s+=T.w*T.h,h=Math.max(h,T.w);c.sort((T,R)=>R.h-T.h);const p=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(s/.95)),h),h:1/0}];let x=0,C=0;for(const T of c)for(let R=p.length-1;R>=0;R--){const F=p[R];if(!(T.w>F.w||T.h>F.h)){if(T.x=F.x,T.y=F.y,C=Math.max(C,T.y+T.h),x=Math.max(x,T.x+T.w),T.w===F.w&&T.h===F.h){const U=p.pop();R<p.length&&(p[R]=U)}else T.h===F.h?(F.x+=T.w,F.w-=T.w):T.w===F.w?(F.y+=T.h,F.h-=T.h):(p.push({x:F.x+T.w,y:F.y,w:F.w-T.w,h:T.h}),F.y+=T.h,F.h-=T.h);break}}return{w:x,h:C,fill:s/(x*C)||0}}const bo=1;class zx{constructor(s,{pixelRatio:h,version:p,stretchX:x,stretchY:C,content:T,textFitWidth:R,textFitHeight:F}){this.paddedRect=s,this.pixelRatio=h,this.stretchX=x,this.stretchY=C,this.content=T,this.version=p,this.textFitWidth=R,this.textFitHeight=F}get tl(){return[this.paddedRect.x+bo,this.paddedRect.y+bo]}get br(){return[this.paddedRect.x+this.paddedRect.w-bo,this.paddedRect.y+this.paddedRect.h-bo]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*bo)/this.pixelRatio,(this.paddedRect.h-2*bo)/this.pixelRatio]}}class dE{constructor(s,h){const p={},x={};this.haveRenderCallbacks=[];const C=[];this.addImages(s,p,C),this.addImages(h,x,C);const{w:T,h:R}=hE(C),F=new _s({width:T||1,height:R||1});for(const U in s){const G=s[U],Y=p[U].paddedRect;_s.copy(G.data,F,{x:0,y:0},{x:Y.x+bo,y:Y.y+bo},G.data)}for(const U in h){const G=h[U],Y=x[U].paddedRect,ee=Y.x+bo,ae=Y.y+bo,ue=G.data.width,pe=G.data.height;_s.copy(G.data,F,{x:0,y:0},{x:ee,y:ae},G.data),_s.copy(G.data,F,{x:0,y:pe-1},{x:ee,y:ae-1},{width:ue,height:1}),_s.copy(G.data,F,{x:0,y:0},{x:ee,y:ae+pe},{width:ue,height:1}),_s.copy(G.data,F,{x:ue-1,y:0},{x:ee-1,y:ae},{width:1,height:pe}),_s.copy(G.data,F,{x:0,y:0},{x:ee+ue,y:ae},{width:1,height:pe})}this.image=F,this.iconPositions=p,this.patternPositions=x}addImages(s,h,p){for(const x in s){const C=s[x],T={x:0,y:0,w:C.data.width+2*bo,h:C.data.height+2*bo};p.push(T),h[x]=new zx(T,C),C.hasRenderCallback&&this.haveRenderCallbacks.push(x)}}patchUpdatedImages(s,h){s.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const p in s.updatedImages)this.patchUpdatedImage(this.iconPositions[p],s.getImage(p),h),this.patchUpdatedImage(this.patternPositions[p],s.getImage(p),h)}patchUpdatedImage(s,h,p){if(!s||!h||s.version===h.version)return;s.version=h.version;const[x,C]=s.tl;p.update(h.data,void 0,{x,y:C})}}var Bu;dn("ImagePosition",zx),dn("ImageAtlas",dE),u.ai=void 0,(Bu=u.ai||(u.ai={}))[Bu.none=0]="none",Bu[Bu.horizontal=1]="horizontal",Bu[Bu.vertical=2]="vertical",Bu[Bu.horizontalOnly=3]="horizontalOnly";const Pm=-17;class Im{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(s,h){const p=new Im;return p.scale=s||1,p.fontStack=h,p}static forImage(s){const h=new Im;return h.imageName=s,h}}class Hf{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(s,h){const p=new Hf;for(let x=0;x<s.sections.length;x++){const C=s.sections[x];C.image?p.addImageSection(C):p.addTextSection(C,h)}return p}length(){return this.text.length}getSection(s){return this.sections[this.sectionIndex[s]]}getSectionIndex(s){return this.sectionIndex[s]}getCharCode(s){return this.text.charCodeAt(s)}verticalizePunctuation(){this.text=function(s){let h="";for(let p=0;p<s.length;p++){const x=s.charCodeAt(p+1)||null,C=s.charCodeAt(p-1)||null;h+=x&&h0(x)&&!Bf[s[p+1]]||C&&h0(C)&&!Bf[s[p-1]]||!Bf[s[p]]?s[p]:Bf[s[p]]}return h}(this.text)}trim(){let s=0;for(let p=0;p<this.text.length&&O0[this.text.charCodeAt(p)];p++)s++;let h=this.text.length;for(let p=this.text.length-1;p>=0&&p>=s&&O0[this.text.charCodeAt(p)];p--)h--;this.text=this.text.substring(s,h),this.sectionIndex=this.sectionIndex.slice(s,h)}substring(s,h){const p=new Hf;return p.text=this.text.substring(s,h),p.sectionIndex=this.sectionIndex.slice(s,h),p.sections=this.sections,p}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((s,h)=>Math.max(s,this.sections[h].scale),0)}addTextSection(s,h){this.text+=s.text,this.sections.push(Im.forText(s.scale,s.fontStack||h));const p=this.sections.length-1;for(let x=0;x<s.text.length;++x)this.sectionIndex.push(p)}addImageSection(s){const h=s.image?s.image.name:"";if(h.length===0)return void Se("Can't add FormattedSection with an empty image.");const p=this.getNextImageSectionCharCode();p?(this.text+=String.fromCharCode(p),this.sections.push(Im.forImage(h)),this.sectionIndex.push(this.sections.length-1)):Se("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function D0(c,s,h,p,x,C,T,R,F,U,G,Y,ee,ae,ue){const pe=Hf.fromFeature(c,x);let Ae;Y===u.ai.vertical&&pe.verticalizePunctuation();const{processBidirectionalText:Oe,processStyledBidirectionalText:tt}=ql;if(Oe&&pe.sections.length===1){Ae=[];const dt=Oe(pe.toString(),Bx(pe,U,C,s,p,ae));for(const Ut of dt){const cn=new Hf;cn.text=Ut,cn.sections=pe.sections;for(let nn=0;nn<Ut.length;nn++)cn.sectionIndex.push(0);Ae.push(cn)}}else if(tt){Ae=[];const dt=tt(pe.text,pe.sectionIndex,Bx(pe,U,C,s,p,ae));for(const Ut of dt){const cn=new Hf;cn.text=Ut[0],cn.sectionIndex=Ut[1],cn.sections=pe.sections,Ae.push(cn)}}else Ae=function(dt,Ut){const cn=[],nn=dt.text;let ln=0;for(const rn of Ut)cn.push(dt.substring(ln,rn)),ln=rn;return ln<nn.length&&cn.push(dt.substring(ln,nn.length)),cn}(pe,Bx(pe,U,C,s,p,ae));const Le=[],Qe={positionedLines:Le,text:pe.toString(),top:G[1],bottom:G[1],left:G[0],right:G[0],writingMode:Y,iconsInText:!1,verticalizable:!1};return function(dt,Ut,cn,nn,ln,rn,xn,mn,hn,St,Pn,wn){let Hn=0,Zi=Pm,Wi=0,ns=0;const La=mn==="right"?1:mn==="left"?0:.5;let bs=0;for(const yr of ln){yr.trim();const is=yr.getMaxScale(),Ns=(is-1)*Ur,Ss={positionedGlyphs:[],lineOffset:0};dt.positionedLines[bs]=Ss;const Fi=Ss.positionedGlyphs;let ji=0;if(!yr.length()){Zi+=rn,++bs;continue}for(let wo=0;wo<yr.length();wo++){const Mi=yr.getSection(wo),Yi=yr.getSectionIndex(wo),sr=yr.getCharCode(wo);let Uo=0,xr=null,Yh=null,Jl=null,Ql=Ur;const ka=!(hn===u.ai.horizontal||!Pn&&!fi(sr)||Pn&&(O0[sr]||(Er=sr,oe.Arabic(Er)||oe["Arabic Supplement"](Er)||oe["Arabic Extended-A"](Er)||oe["Arabic Presentation Forms-A"](Er)||oe["Arabic Presentation Forms-B"](Er))));if(Mi.imageName){const Vo=nn[Mi.imageName];if(!Vo)continue;Jl=Mi.imageName,dt.iconsInText=dt.iconsInText||!0,Yh=Vo.paddedRect;const rs=Vo.displaySize;Mi.scale=Mi.scale*Ur/wn,xr={width:rs[0],height:rs[1],left:bo,top:-3,advance:ka?rs[1]:rs[0]},Uo=Ns+(Ur-rs[1]*Mi.scale),Ql=xr.advance;const Hc=ka?rs[0]*Mi.scale-Ur*is:rs[1]*Mi.scale-Ur*is;Hc>0&&Hc>ji&&(ji=Hc)}else{const Vo=cn[Mi.fontStack],rs=Vo&&Vo[sr];if(rs&&rs.rect)Yh=rs.rect,xr=rs.metrics;else{const Hc=Ut[Mi.fontStack],Dm=Hc&&Hc[sr];if(!Dm)continue;xr=Dm.metrics}Uo=(is-Mi.scale)*Ur}ka?(dt.verticalizable=!0,Fi.push({glyph:sr,imageName:Jl,x:Hn,y:Zi+Uo,vertical:ka,scale:Mi.scale,fontStack:Mi.fontStack,sectionIndex:Yi,metrics:xr,rect:Yh}),Hn+=Ql*Mi.scale+St):(Fi.push({glyph:sr,imageName:Jl,x:Hn,y:Zi+Uo,vertical:ka,scale:Mi.scale,fontStack:Mi.fontStack,sectionIndex:Yi,metrics:xr,rect:Yh}),Hn+=xr.advance*Mi.scale+St)}Fi.length!==0&&(Wi=Math.max(Hn-St,Wi),kR(Fi,0,Fi.length-1,La,ji)),Hn=0;const aa=rn*is+ji;Ss.lineOffset=Math.max(ji,Ns),Zi+=aa,ns=Math.max(aa,ns),++bs}var Er;const to=Zi-Pm,{horizontalAlign:ws,verticalAlign:no}=Ux(xn);(function(yr,is,Ns,Ss,Fi,ji,aa,wo,Mi){const Yi=(is-Ns)*Fi;let sr=0;sr=ji!==aa?-wo*Ss-Pm:(-Ss*Mi+.5)*aa;for(const Uo of yr)for(const xr of Uo.positionedGlyphs)xr.x+=Yi,xr.y+=sr})(dt.positionedLines,La,ws,no,Wi,ns,rn,to,ln.length),dt.top+=-no*to,dt.bottom=dt.top+to,dt.left+=-ws*Wi,dt.right=dt.left+Wi}(Qe,s,h,p,Ae,T,R,F,Y,U,ee,ue),!function(dt){for(const Ut of dt)if(Ut.positionedGlyphs.length!==0)return!1;return!0}(Le)&&Qe}const O0={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},IR={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},RR={40:!0};function F0(c,s,h,p,x,C){if(s.imageName){const T=p[s.imageName];return T?T.displaySize[0]*s.scale*Ur/C+x:0}{const T=h[s.fontStack],R=T&&T[c];return R?R.metrics.advance*s.scale+x:0}}function Nx(c,s,h,p){const x=Math.pow(c-s,2);return p?c<s?x/2:2*x:x+Math.abs(h)*h}function LR(c,s,h){let p=0;return c===10&&(p-=1e4),h&&(p+=150),c!==40&&c!==65288||(p+=50),s!==41&&s!==65289||(p+=50),p}function fE(c,s,h,p,x,C){let T=null,R=Nx(s,h,x,C);for(const F of p){const U=Nx(s-F.x,h,x,C)+F.badness;U<=R&&(T=F,R=U)}return{index:c,x:s,priorBreak:T,badness:R}}function pE(c){return c?pE(c.priorBreak).concat(c.index):[]}function Bx(c,s,h,p,x,C){if(!c)return[];const T=[],R=function(Y,ee,ae,ue,pe,Ae){let Oe=0;for(let tt=0;tt<Y.length();tt++){const Le=Y.getSection(tt);Oe+=F0(Y.getCharCode(tt),Le,ue,pe,ee,Ae)}return Oe/Math.max(1,Math.ceil(Oe/ae))}(c,s,h,p,x,C),F=c.text.indexOf("")>=0;let U=0;for(let Y=0;Y<c.length();Y++){const ee=c.getSection(Y),ae=c.getCharCode(Y);if(O0[ae]||(U+=F0(ae,ee,p,x,s,C)),Y<c.length()-1){const ue=!((G=ae)<11904||!(oe["Bopomofo Extended"](G)||oe.Bopomofo(G)||oe["CJK Compatibility Forms"](G)||oe["CJK Compatibility Ideographs"](G)||oe["CJK Compatibility"](G)||oe["CJK Radicals Supplement"](G)||oe["CJK Strokes"](G)||oe["CJK Symbols and Punctuation"](G)||oe["CJK Unified Ideographs Extension A"](G)||oe["CJK Unified Ideographs"](G)||oe["Enclosed CJK Letters and Months"](G)||oe["Halfwidth and Fullwidth Forms"](G)||oe.Hiragana(G)||oe["Ideographic Description Characters"](G)||oe["Kangxi Radicals"](G)||oe["Katakana Phonetic Extensions"](G)||oe.Katakana(G)||oe["Vertical Forms"](G)||oe["Yi Radicals"](G)||oe["Yi Syllables"](G)));(IR[ae]||ue||ee.imageName||Y!==c.length()-2&&RR[c.getCharCode(Y+1)])&&T.push(fE(Y+1,U,R,T,LR(ae,c.getCharCode(Y+1),ue&&F),!1))}}var G;return pE(fE(c.length(),U,R,T,0,!0))}function Ux(c){let s=.5,h=.5;switch(c){case"right":case"top-right":case"bottom-right":s=1;break;case"left":case"top-left":case"bottom-left":s=0}switch(c){case"bottom":case"bottom-right":case"bottom-left":h=1;break;case"top":case"top-right":case"top-left":h=0}return{horizontalAlign:s,verticalAlign:h}}function kR(c,s,h,p,x){if(!p&&!x)return;const C=c[h],T=(c[h].x+C.metrics.advance*C.scale)*p;for(let R=s;R<=h;R++)c[R].x-=T,c[R].y+=x}function DR(c,s,h){const{horizontalAlign:p,verticalAlign:x}=Ux(h),C=s[0]-c.displaySize[0]*p,T=s[1]-c.displaySize[1]*x;return{image:c,top:T,bottom:T+c.displaySize[1],left:C,right:C+c.displaySize[0]}}function mE(c){var s,h;let p=c.left,x=c.top,C=c.right-p,T=c.bottom-x;const R=(s=c.image.textFitWidth)!==null&&s!==void 0?s:"stretchOrShrink",F=(h=c.image.textFitHeight)!==null&&h!==void 0?h:"stretchOrShrink",U=(c.image.content[2]-c.image.content[0])/(c.image.content[3]-c.image.content[1]);if(F==="proportional"){if(R==="stretchOnly"&&C/T<U||R==="proportional"){const G=Math.ceil(T*U);p*=G/C,C=G}}else if(R==="proportional"&&F==="stretchOnly"&&U!==0&&C/T>U){const G=Math.ceil(C/U);x*=G/T,T=G}return{x1:p,y1:x,x2:p+C,y2:x+T}}function Vx(c,s,h,p,x,C){const T=c.image;let R;if(T.content){const Ae=T.content,Oe=T.pixelRatio||1;R=[Ae[0]/Oe,Ae[1]/Oe,T.displaySize[0]-Ae[2]/Oe,T.displaySize[1]-Ae[3]/Oe]}const F=s.left*C,U=s.right*C;let G,Y,ee,ae;h==="width"||h==="both"?(ae=x[0]+F-p[3],Y=x[0]+U+p[1]):(ae=x[0]+(F+U-T.displaySize[0])/2,Y=ae+T.displaySize[0]);const ue=s.top*C,pe=s.bottom*C;return h==="height"||h==="both"?(G=x[1]+ue-p[0],ee=x[1]+pe+p[2]):(G=x[1]+(ue+pe-T.displaySize[1])/2,ee=G+T.displaySize[1]),{image:T,top:G,right:Y,bottom:ee,left:ae,collisionPadding:R}}const Rm=255,oa=128,Uu=Rm*oa;function gE(c,s){const{expression:h}=s;if(h.kind==="constant")return{kind:"constant",layoutSize:h.evaluate(new tr(c+1))};if(h.kind==="source")return{kind:"source"};{const{zoomStops:p,interpolationType:x}=h;let C=0;for(;C<p.length&&p[C]<=c;)C++;C=Math.max(0,C-1);let T=C;for(;T<p.length&&p[T]<c+1;)T++;T=Math.min(p.length-1,T);const R=p[C],F=p[T];return h.kind==="composite"?{kind:"composite",minZoom:R,maxZoom:F,interpolationType:x}:{kind:"camera",minZoom:R,maxZoom:F,minSize:h.evaluate(new tr(R)),maxSize:h.evaluate(new tr(F)),interpolationType:x}}}function $x(c,s,h){let p="never";const x=c.get(s);return x?p=x:c.get(h)&&(p="always"),p}const OR=zu.VectorTileFeature.types,FR=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function z0(c,s,h,p,x,C,T,R,F,U,G,Y,ee){const ae=R?Math.min(Uu,Math.round(R[0])):0,ue=R?Math.min(Uu,Math.round(R[1])):0;c.emplaceBack(s,h,Math.round(32*p),Math.round(32*x),C,T,(ae<<1)+(F?1:0),ue,16*U,16*G,256*Y,256*ee)}function Hx(c,s,h){c.emplaceBack(s.x,s.y,h),c.emplaceBack(s.x,s.y,h),c.emplaceBack(s.x,s.y,h),c.emplaceBack(s.x,s.y,h)}function zR(c){for(const s of c.sections)if(ul(s.text))return!0;return!1}class Gx{constructor(s){this.layoutVertexArray=new Os,this.indexArray=new ts,this.programConfigurations=s,this.segments=new Xr,this.dynamicLayoutVertexArray=new hl,this.opacityVertexArray=new Iu,this.hasVisibleVertices=!1,this.placedSymbolArray=new nr}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(s,h,p,x){this.isEmpty()||(p&&(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,mR.members),this.indexBuffer=s.createIndexBuffer(this.indexArray,h),this.dynamicLayoutVertexBuffer=s.createVertexBuffer(this.dynamicLayoutVertexArray,gR.members,!0),this.opacityVertexBuffer=s.createVertexBuffer(this.opacityVertexArray,FR,!0),this.opacityVertexBuffer.itemSize=1),(p||x)&&this.programConfigurations.upload(s))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}dn("SymbolBuffers",Gx);class Wx{constructor(s,h,p){this.layoutVertexArray=new s,this.layoutAttributes=h,this.indexArray=new p,this.segments=new Xr,this.collisionVertexArray=new Br}upload(s){this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=s.createVertexBuffer(this.collisionVertexArray,vR.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}dn("CollisionBuffers",Wx);class Gf{constructor(s){this.collisionBoxArray=s.collisionBoxArray,this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(T=>T.id),this.index=s.index,this.pixelRatio=s.pixelRatio,this.sourceLayerIndex=s.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=S0([]),this.placementViewportMatrix=S0([]);const h=this.layers[0]._unevaluatedLayout._values;this.textSizeData=gE(this.zoom,h["text-size"]),this.iconSizeData=gE(this.zoom,h["icon-size"]);const p=this.layers[0].layout,x=p.get("symbol-sort-key"),C=p.get("symbol-z-order");this.canOverlap=$x(p,"text-overlap","text-allow-overlap")!=="never"||$x(p,"icon-overlap","icon-allow-overlap")!=="never"||p.get("text-ignore-placement")||p.get("icon-ignore-placement"),this.sortFeaturesByKey=C!=="viewport-y"&&!x.isConstant(),this.sortFeaturesByY=(C==="viewport-y"||C==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,p.get("symbol-placement")==="point"&&(this.writingModes=p.get("text-writing-mode").map(T=>u.ai[T])),this.stateDependentLayerIds=this.layers.filter(T=>T.isStateDependent()).map(T=>T.id),this.sourceID=s.sourceID}createArrays(){this.text=new Gx(new ku(this.layers,this.zoom,s=>/^text/.test(s))),this.icon=new Gx(new ku(this.layers,this.zoom,s=>/^icon/.test(s))),this.glyphOffsetArray=new ir,this.lineVertexArray=new _r,this.symbolInstances=new yo,this.textAnchorOffsets=new qr}calculateGlyphDependencies(s,h,p,x,C){for(let T=0;T<s.length;T++)if(h[s.charCodeAt(T)]=!0,(p||x)&&C){const R=Bf[s.charAt(T)];R&&(h[R.charCodeAt(0)]=!0)}}populate(s,h,p){const x=this.layers[0],C=x.layout,T=C.get("text-font"),R=C.get("text-field"),F=C.get("icon-image"),U=(R.value.kind!=="constant"||R.value.value instanceof In&&!R.value.value.isEmpty()||R.value.value.toString().length>0)&&(T.value.kind!=="constant"||T.value.value.length>0),G=F.value.kind!=="constant"||!!F.value.value||Object.keys(F.parameters).length>0,Y=C.get("symbol-sort-key");if(this.features=[],!U&&!G)return;const ee=h.iconDependencies,ae=h.glyphDependencies,ue=h.availableImages,pe=new tr(this.zoom);for(const{feature:Ae,id:Oe,index:tt,sourceLayerIndex:Le}of s){const Qe=x._featureFilter.needGeometry,dt=Du(Ae,Qe);if(!x._featureFilter.filter(pe,dt,p))continue;let Ut,cn;if(Qe||(dt.geometry=Fc(Ae)),U){const ln=x.getValueAndResolveTokens("text-field",dt,p,ue),rn=In.factory(ln),xn=this.hasRTLText=this.hasRTLText||zR(rn);(!xn||ql.getRTLTextPluginStatus()==="unavailable"||xn&&ql.isParsed())&&(Ut=nE(rn,x,dt))}if(G){const ln=x.getValueAndResolveTokens("icon-image",dt,p,ue);cn=ln instanceof Ni?ln:Ni.fromString(ln)}if(!Ut&&!cn)continue;const nn=this.sortFeaturesByKey?Y.evaluate(dt,{},p):void 0;if(this.features.push({id:Oe,text:Ut,icon:cn,index:tt,sourceLayerIndex:Le,geometry:dt.geometry,properties:Ae.properties,type:OR[Ae.type],sortKey:nn}),cn&&(ee[cn.name]=!0),Ut){const ln=T.evaluate(dt,{},p).join(","),rn=C.get("text-rotation-alignment")!=="viewport"&&C.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(u.ai.vertical)>=0;for(const xn of Ut.sections)if(xn.image)ee[xn.image.name]=!0;else{const mn=Wl(Ut.toString()),hn=xn.fontStack||ln,St=ae[hn]=ae[hn]||{};this.calculateGlyphDependencies(xn.text,St,rn,this.allowVerticalPlacement,mn)}}}C.get("symbol-placement")==="line"&&(this.features=function(Ae){const Oe={},tt={},Le=[];let Qe=0;function dt(ln){Le.push(Ae[ln]),Qe++}function Ut(ln,rn,xn){const mn=tt[ln];return delete tt[ln],tt[rn]=mn,Le[mn].geometry[0].pop(),Le[mn].geometry[0]=Le[mn].geometry[0].concat(xn[0]),mn}function cn(ln,rn,xn){const mn=Oe[rn];return delete Oe[rn],Oe[ln]=mn,Le[mn].geometry[0].shift(),Le[mn].geometry[0]=xn[0].concat(Le[mn].geometry[0]),mn}function nn(ln,rn,xn){const mn=xn?rn[0][rn[0].length-1]:rn[0][0];return`${ln}:${mn.x}:${mn.y}`}for(let ln=0;ln<Ae.length;ln++){const rn=Ae[ln],xn=rn.geometry,mn=rn.text?rn.text.toString():null;if(!mn){dt(ln);continue}const hn=nn(mn,xn),St=nn(mn,xn,!0);if(hn in tt&&St in Oe&&tt[hn]!==Oe[St]){const Pn=cn(hn,St,xn),wn=Ut(hn,St,Le[Pn].geometry);delete Oe[hn],delete tt[St],tt[nn(mn,Le[wn].geometry,!0)]=wn,Le[Pn].geometry=null}else hn in tt?Ut(hn,St,xn):St in Oe?cn(hn,St,xn):(dt(ln),Oe[hn]=Qe-1,tt[St]=Qe-1)}return Le.filter(ln=>ln.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Ae,Oe)=>Ae.sortKey-Oe.sortKey)}update(s,h,p){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(s,h,this.layers,p),this.icon.programConfigurations.updatePaintArrays(s,h,this.layers,p))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(s){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(s),this.iconCollisionBox.upload(s)),this.text.upload(s,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(s,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(s,h){const p=this.lineVertexArray.length;if(s.segment!==void 0){let x=s.dist(h[s.segment+1]),C=s.dist(h[s.segment]);const T={};for(let R=s.segment+1;R<h.length;R++)T[R]={x:h[R].x,y:h[R].y,tileUnitDistanceFromAnchor:x},R<h.length-1&&(x+=h[R+1].dist(h[R]));for(let R=s.segment||0;R>=0;R--)T[R]={x:h[R].x,y:h[R].y,tileUnitDistanceFromAnchor:C},R>0&&(C+=h[R-1].dist(h[R]));for(let R=0;R<h.length;R++){const F=T[R];this.lineVertexArray.emplaceBack(F.x,F.y,F.tileUnitDistanceFromAnchor)}}return{lineStartIndex:p,lineLength:this.lineVertexArray.length-p}}addSymbols(s,h,p,x,C,T,R,F,U,G,Y,ee){const ae=s.indexArray,ue=s.layoutVertexArray,pe=s.segments.prepareSegment(4*h.length,ue,ae,this.canOverlap?T.sortKey:void 0),Ae=this.glyphOffsetArray.length,Oe=pe.vertexLength,tt=this.allowVerticalPlacement&&R===u.ai.vertical?Math.PI/2:0,Le=T.text&&T.text.sections;for(let Qe=0;Qe<h.length;Qe++){const{tl:dt,tr:Ut,bl:cn,br:nn,tex:ln,pixelOffsetTL:rn,pixelOffsetBR:xn,minFontScaleX:mn,minFontScaleY:hn,glyphOffset:St,isSDF:Pn,sectionIndex:wn}=h[Qe],Hn=pe.vertexLength,Zi=St[1];z0(ue,F.x,F.y,dt.x,Zi+dt.y,ln.x,ln.y,p,Pn,rn.x,rn.y,mn,hn),z0(ue,F.x,F.y,Ut.x,Zi+Ut.y,ln.x+ln.w,ln.y,p,Pn,xn.x,rn.y,mn,hn),z0(ue,F.x,F.y,cn.x,Zi+cn.y,ln.x,ln.y+ln.h,p,Pn,rn.x,xn.y,mn,hn),z0(ue,F.x,F.y,nn.x,Zi+nn.y,ln.x+ln.w,ln.y+ln.h,p,Pn,xn.x,xn.y,mn,hn),Hx(s.dynamicLayoutVertexArray,F,tt),ae.emplaceBack(Hn,Hn+1,Hn+2),ae.emplaceBack(Hn+1,Hn+2,Hn+3),pe.vertexLength+=4,pe.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(St[0]),Qe!==h.length-1&&wn===h[Qe+1].sectionIndex||s.programConfigurations.populatePaintArrays(ue.length,T,T.index,{},ee,Le&&Le[wn])}s.placedSymbolArray.emplaceBack(F.x,F.y,Ae,this.glyphOffsetArray.length-Ae,Oe,U,G,F.segment,p?p[0]:0,p?p[1]:0,x[0],x[1],R,0,!1,0,Y)}_addCollisionDebugVertex(s,h,p,x,C,T){return h.emplaceBack(0,0),s.emplaceBack(p.x,p.y,x,C,Math.round(T.x),Math.round(T.y))}addCollisionDebugVertices(s,h,p,x,C,T,R){const F=C.segments.prepareSegment(4,C.layoutVertexArray,C.indexArray),U=F.vertexLength,G=C.layoutVertexArray,Y=C.collisionVertexArray,ee=R.anchorX,ae=R.anchorY;this._addCollisionDebugVertex(G,Y,T,ee,ae,new S(s,h)),this._addCollisionDebugVertex(G,Y,T,ee,ae,new S(p,h)),this._addCollisionDebugVertex(G,Y,T,ee,ae,new S(p,x)),this._addCollisionDebugVertex(G,Y,T,ee,ae,new S(s,x)),F.vertexLength+=4;const ue=C.indexArray;ue.emplaceBack(U,U+1),ue.emplaceBack(U+1,U+2),ue.emplaceBack(U+2,U+3),ue.emplaceBack(U+3,U),F.primitiveLength+=4}addDebugCollisionBoxes(s,h,p,x){for(let C=s;C<h;C++){const T=this.collisionBoxArray.get(C);this.addCollisionDebugVertices(T.x1,T.y1,T.x2,T.y2,x?this.textCollisionBox:this.iconCollisionBox,T.anchorPoint,p)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Wx(ys,tE.members,vr),this.iconCollisionBox=new Wx(ys,tE.members,vr);for(let s=0;s<this.symbolInstances.length;s++){const h=this.symbolInstances.get(s);this.addDebugCollisionBoxes(h.textBoxStartIndex,h.textBoxEndIndex,h,!0),this.addDebugCollisionBoxes(h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h,!0),this.addDebugCollisionBoxes(h.iconBoxStartIndex,h.iconBoxEndIndex,h,!1),this.addDebugCollisionBoxes(h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex,h,!1)}}_deserializeCollisionBoxesForSymbol(s,h,p,x,C,T,R,F,U){const G={};for(let Y=h;Y<p;Y++){const ee=s.get(Y);G.textBox={x1:ee.x1,y1:ee.y1,x2:ee.x2,y2:ee.y2,anchorPointX:ee.anchorPointX,anchorPointY:ee.anchorPointY},G.textFeatureIndex=ee.featureIndex;break}for(let Y=x;Y<C;Y++){const ee=s.get(Y);G.verticalTextBox={x1:ee.x1,y1:ee.y1,x2:ee.x2,y2:ee.y2,anchorPointX:ee.anchorPointX,anchorPointY:ee.anchorPointY},G.verticalTextFeatureIndex=ee.featureIndex;break}for(let Y=T;Y<R;Y++){const ee=s.get(Y);G.iconBox={x1:ee.x1,y1:ee.y1,x2:ee.x2,y2:ee.y2,anchorPointX:ee.anchorPointX,anchorPointY:ee.anchorPointY},G.iconFeatureIndex=ee.featureIndex;break}for(let Y=F;Y<U;Y++){const ee=s.get(Y);G.verticalIconBox={x1:ee.x1,y1:ee.y1,x2:ee.x2,y2:ee.y2,anchorPointX:ee.anchorPointX,anchorPointY:ee.anchorPointY},G.verticalIconFeatureIndex=ee.featureIndex;break}return G}deserializeCollisionBoxes(s){this.collisionArrays=[];for(let h=0;h<this.symbolInstances.length;h++){const p=this.symbolInstances.get(h);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(s,p.textBoxStartIndex,p.textBoxEndIndex,p.verticalTextBoxStartIndex,p.verticalTextBoxEndIndex,p.iconBoxStartIndex,p.iconBoxEndIndex,p.verticalIconBoxStartIndex,p.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(s,h){const p=s.placedSymbolArray.get(h),x=p.vertexStartIndex+4*p.numGlyphs;for(let C=p.vertexStartIndex;C<x;C+=4)s.indexArray.emplaceBack(C,C+1,C+2),s.indexArray.emplaceBack(C+1,C+2,C+3)}getSortedSymbolIndexes(s){if(this.sortedAngle===s&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const h=Math.sin(s),p=Math.cos(s),x=[],C=[],T=[];for(let R=0;R<this.symbolInstances.length;++R){T.push(R);const F=this.symbolInstances.get(R);x.push(0|Math.round(h*F.anchorX+p*F.anchorY)),C.push(F.featureIndex)}return T.sort((R,F)=>x[R]-x[F]||C[F]-C[R]),T}addToSortKeyRanges(s,h){const p=this.sortKeyRanges[this.sortKeyRanges.length-1];p&&p.sortKey===h?p.symbolInstanceEnd=s+1:this.sortKeyRanges.push({sortKey:h,symbolInstanceStart:s,symbolInstanceEnd:s+1})}sortFeatures(s){if(this.sortFeaturesByY&&this.sortedAngle!==s&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(s),this.sortedAngle=s,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const h of this.symbolInstanceIndexes){const p=this.symbolInstances.get(h);this.featureSortOrder.push(p.featureIndex),[p.rightJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.leftJustifiedTextSymbolIndex].forEach((x,C,T)=>{x>=0&&T.indexOf(x)===C&&this.addIndicesForPlacedSymbol(this.text,x)}),p.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,p.verticalPlacedTextSymbolIndex),p.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,p.placedIconSymbolIndex),p.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,p.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let vE,yE;dn("SymbolBucket",Gf,{omit:["layers","collisionBoxArray","features","compareText"]}),Gf.MAX_GLYPHS=65535,Gf.addDynamicAttributes=Hx;var jx={get paint(){return yE=yE||new v({"icon-opacity":new An(Ue.paint_symbol["icon-opacity"]),"icon-color":new An(Ue.paint_symbol["icon-color"]),"icon-halo-color":new An(Ue.paint_symbol["icon-halo-color"]),"icon-halo-width":new An(Ue.paint_symbol["icon-halo-width"]),"icon-halo-blur":new An(Ue.paint_symbol["icon-halo-blur"]),"icon-translate":new Tn(Ue.paint_symbol["icon-translate"]),"icon-translate-anchor":new Tn(Ue.paint_symbol["icon-translate-anchor"]),"text-opacity":new An(Ue.paint_symbol["text-opacity"]),"text-color":new An(Ue.paint_symbol["text-color"],{runtimeType:kn,getOverride:c=>c.textColor,hasOverride:c=>!!c.textColor}),"text-halo-color":new An(Ue.paint_symbol["text-halo-color"]),"text-halo-width":new An(Ue.paint_symbol["text-halo-width"]),"text-halo-blur":new An(Ue.paint_symbol["text-halo-blur"]),"text-translate":new Tn(Ue.paint_symbol["text-translate"]),"text-translate-anchor":new Tn(Ue.paint_symbol["text-translate-anchor"])})},get layout(){return vE=vE||new v({"symbol-placement":new Tn(Ue.layout_symbol["symbol-placement"]),"symbol-spacing":new Tn(Ue.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Tn(Ue.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new An(Ue.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Tn(Ue.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Tn(Ue.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Tn(Ue.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Tn(Ue.layout_symbol["icon-ignore-placement"]),"icon-optional":new Tn(Ue.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Tn(Ue.layout_symbol["icon-rotation-alignment"]),"icon-size":new An(Ue.layout_symbol["icon-size"]),"icon-text-fit":new Tn(Ue.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Tn(Ue.layout_symbol["icon-text-fit-padding"]),"icon-image":new An(Ue.layout_symbol["icon-image"]),"icon-rotate":new An(Ue.layout_symbol["icon-rotate"]),"icon-padding":new An(Ue.layout_symbol["icon-padding"]),"icon-keep-upright":new Tn(Ue.layout_symbol["icon-keep-upright"]),"icon-offset":new An(Ue.layout_symbol["icon-offset"]),"icon-anchor":new An(Ue.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Tn(Ue.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Tn(Ue.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Tn(Ue.layout_symbol["text-rotation-alignment"]),"text-field":new An(Ue.layout_symbol["text-field"]),"text-font":new An(Ue.layout_symbol["text-font"]),"text-size":new An(Ue.layout_symbol["text-size"]),"text-max-width":new An(Ue.layout_symbol["text-max-width"]),"text-line-height":new Tn(Ue.layout_symbol["text-line-height"]),"text-letter-spacing":new An(Ue.layout_symbol["text-letter-spacing"]),"text-justify":new An(Ue.layout_symbol["text-justify"]),"text-radial-offset":new An(Ue.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Tn(Ue.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new An(Ue.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new An(Ue.layout_symbol["text-anchor"]),"text-max-angle":new Tn(Ue.layout_symbol["text-max-angle"]),"text-writing-mode":new Tn(Ue.layout_symbol["text-writing-mode"]),"text-rotate":new An(Ue.layout_symbol["text-rotate"]),"text-padding":new Tn(Ue.layout_symbol["text-padding"]),"text-keep-upright":new Tn(Ue.layout_symbol["text-keep-upright"]),"text-transform":new An(Ue.layout_symbol["text-transform"]),"text-offset":new An(Ue.layout_symbol["text-offset"]),"text-allow-overlap":new Tn(Ue.layout_symbol["text-allow-overlap"]),"text-overlap":new Tn(Ue.layout_symbol["text-overlap"]),"text-ignore-placement":new Tn(Ue.layout_symbol["text-ignore-placement"]),"text-optional":new Tn(Ue.layout_symbol["text-optional"])})}};class _E{constructor(s){if(s.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=s.property.overrides?s.property.overrides.runtimeType:Wn,this.defaultValue=s}evaluate(s){if(s.formattedSection){const h=this.defaultValue.property.overrides;if(h&&h.hasOverride(s.formattedSection))return h.getOverride(s.formattedSection)}return s.feature&&s.featureState?this.defaultValue.evaluate(s.feature,s.featureState):this.defaultValue.property.specification.default}eachChild(s){this.defaultValue.isConstant()||s(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}dn("FormatSectionOverride",_E,{omit:["defaultValue"]});class N0 extends E{constructor(s){super(s,jx)}recalculate(s,h){if(super.recalculate(s,h),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const p=this.layout.get("text-writing-mode");if(p){const x=[];for(const C of p)x.indexOf(C)<0&&x.push(C);this.layout._values["text-writing-mode"]=x}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(s,h,p,x){const C=this.layout.get(s).evaluate(h,{},p,x),T=this._unevaluatedLayout._values[s];return T.isDataDriven()||Qn(T.value)||!C?C:function(R,F){return F.replace(/{([^{}]+)}/g,(U,G)=>R&&G in R?String(R[G]):"")}(h.properties,C)}createBucket(s){return new Gf(s)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const s of jx.paint.overridableProperties){if(!N0.hasPaintOverride(this.layout,s))continue;const h=this.paint.get(s),p=new _E(h),x=new _n(p,h.property.specification);let C=null;C=h.value.kind==="constant"||h.value.kind==="source"?new Pr("source",x):new Gi("composite",x,h.value.zoomStops),this.paint._values[s]=new Ta(h.property,C,h.parameters)}}_handleOverridablePaintPropertyUpdate(s,h,p){return!(!this.layout||h.isDataDriven()||p.isDataDriven())&&N0.hasPaintOverride(this.layout,s)}static hasPaintOverride(s,h){const p=s.get("text-field"),x=jx.paint.properties[h];let C=!1;const T=R=>{for(const F of R)if(x.overrides&&x.overrides.hasOverride(F))return void(C=!0)};if(p.value.kind==="constant"&&p.value.value instanceof In)T(p.value.value.sections);else if(p.value.kind==="source"){const R=U=>{C||(U instanceof Or&&di(U.value)===Et?T(U.value.sections):U instanceof of?T(U.sections):U.eachChild(R))},F=p.value;F._styleExpression&&R(F._styleExpression.expression)}return C}}let qx;var xE={get paint(){return qx=qx||new v({"background-color":new Tn(Ue.paint_background["background-color"]),"background-pattern":new o(Ue.paint_background["background-pattern"]),"background-opacity":new Tn(Ue.paint_background["background-opacity"])})}};class NR extends E{constructor(s){super(s,xE)}}let bE;var BR={get paint(){return bE=bE||new v({"raster-opacity":new Tn(Ue.paint_raster["raster-opacity"]),"raster-hue-rotate":new Tn(Ue.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Tn(Ue.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Tn(Ue.paint_raster["raster-brightness-max"]),"raster-saturation":new Tn(Ue.paint_raster["raster-saturation"]),"raster-contrast":new Tn(Ue.paint_raster["raster-contrast"]),"raster-resampling":new Tn(Ue.paint_raster["raster-resampling"]),"raster-fade-duration":new Tn(Ue.paint_raster["raster-fade-duration"])})}};class UR extends E{constructor(s){super(s,BR)}}class B0 extends E{constructor(s){super(s,{}),this.onAdd=h=>{this.implementation.onAdd&&this.implementation.onAdd(h,h.painter.context.gl)},this.onRemove=h=>{this.implementation.onRemove&&this.implementation.onRemove(h,h.painter.context.gl)},this.implementation=s}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class VR{constructor(s){this._methodToThrottle=s,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const Xx=63710088e-1;class Vu{constructor(s,h){if(isNaN(s)||isNaN(h))throw new Error(`Invalid LngLat object: (${s}, ${h})`);if(this.lng=+s,this.lat=+h,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Vu(q(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(s){const h=Math.PI/180,p=this.lat*h,x=s.lat*h,C=Math.sin(p)*Math.sin(x)+Math.cos(p)*Math.cos(x)*Math.cos((s.lng-this.lng)*h);return Xx*Math.acos(Math.min(C,1))}static convert(s){if(s instanceof Vu)return s;if(Array.isArray(s)&&(s.length===2||s.length===3))return new Vu(Number(s[0]),Number(s[1]));if(!Array.isArray(s)&&typeof s=="object"&&s!==null)return new Vu(Number("lng"in s?s.lng:s.lon),Number(s.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const wE=2*Math.PI*Xx;function SE(c){return wE*Math.cos(c*Math.PI/180)}function EE(c){return(180+c)/360}function ME(c){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c*Math.PI/360)))/360}function CE(c,s){return c/SE(s)}function Zx(c){return 360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90}class U0{constructor(s,h,p=0){this.x=+s,this.y=+h,this.z=+p}static fromLngLat(s,h=0){const p=Vu.convert(s);return new U0(EE(p.lng),ME(p.lat),CE(h,p.lat))}toLngLat(){return new Vu(360*this.x-180,Zx(this.y))}toAltitude(){return this.z*SE(Zx(this.y))}meterInMercatorCoordinateUnits(){return 1/wE*(s=Zx(this.y),1/Math.cos(s*Math.PI/180));var s}}function TE(c,s,h){var p=2*Math.PI*6378137/256/Math.pow(2,h);return[c*p-2*Math.PI*6378137/2,s*p-2*Math.PI*6378137/2]}class Wf{constructor(s,h,p){if(s<0||s>25||p<0||p>=Math.pow(2,s)||h<0||h>=Math.pow(2,s))throw new Error(`x=${h}, y=${p}, z=${s} outside of bounds. 0<=x<${Math.pow(2,s)}, 0<=y<${Math.pow(2,s)} 0<=z<=25 `);this.z=s,this.x=h,this.y=p,this.key=jf(0,s,s,h,p)}equals(s){return this.z===s.z&&this.x===s.x&&this.y===s.y}url(s,h,p){const x=(T=this.y,R=this.z,F=TE(256*(C=this.x),256*(T=Math.pow(2,R)-T-1),R),U=TE(256*(C+1),256*(T+1),R),F[0]+","+F[1]+","+U[0]+","+U[1]);var C,T,R,F,U;const G=function(Y,ee,ae){let ue,pe="";for(let Ae=Y;Ae>0;Ae--)ue=1<<Ae-1,pe+=(ee&ue?1:0)+(ae&ue?2:0);return pe}(this.z,this.x,this.y);return s[(this.x+this.y)%s.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(p==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,h>1?"@2x":"").replace(/{quadkey}/g,G).replace(/{bbox-epsg-3857}/g,x)}isChildOf(s){const h=this.z-s.z;return h>0&&s.x===this.x>>h&&s.y===this.y>>h}getTilePoint(s){const h=Math.pow(2,this.z);return new S((s.x*h-this.x)*Oi,(s.y*h-this.y)*Oi)}toString(){return`${this.z}/${this.x}/${this.y}`}}class AE{constructor(s,h){this.wrap=s,this.canonical=h,this.key=jf(s,h.z,h.z,h.x,h.y)}}class Bo{constructor(s,h,p,x,C){if(s<p)throw new Error(`overscaledZ should be >= z; overscaledZ = ${s}; z = ${p}`);this.overscaledZ=s,this.wrap=h,this.canonical=new Wf(p,+x,+C),this.key=jf(h,s,p,x,C)}clone(){return new Bo(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(s){return this.overscaledZ===s.overscaledZ&&this.wrap===s.wrap&&this.canonical.equals(s.canonical)}scaledTo(s){if(s>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${s}; overscaledZ = ${this.overscaledZ}`);const h=this.canonical.z-s;return s>this.canonical.z?new Bo(s,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Bo(s,this.wrap,s,this.canonical.x>>h,this.canonical.y>>h)}calculateScaledKey(s,h){if(s>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${s}; overscaledZ = ${this.overscaledZ}`);const p=this.canonical.z-s;return s>this.canonical.z?jf(this.wrap*+h,s,this.canonical.z,this.canonical.x,this.canonical.y):jf(this.wrap*+h,s,s,this.canonical.x>>p,this.canonical.y>>p)}isChildOf(s){if(s.wrap!==this.wrap)return!1;const h=this.canonical.z-s.canonical.z;return s.overscaledZ===0||s.overscaledZ<this.overscaledZ&&s.canonical.x===this.canonical.x>>h&&s.canonical.y===this.canonical.y>>h}children(s){if(this.overscaledZ>=s)return[new Bo(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const h=this.canonical.z+1,p=2*this.canonical.x,x=2*this.canonical.y;return[new Bo(h,this.wrap,h,p,x),new Bo(h,this.wrap,h,p+1,x),new Bo(h,this.wrap,h,p,x+1),new Bo(h,this.wrap,h,p+1,x+1)]}isLessThan(s){return this.wrap<s.wrap||!(this.wrap>s.wrap)&&(this.overscaledZ<s.overscaledZ||!(this.overscaledZ>s.overscaledZ)&&(this.canonical.x<s.canonical.x||!(this.canonical.x>s.canonical.x)&&this.canonical.y<s.canonical.y))}wrapped(){return new Bo(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(s){return new Bo(this.overscaledZ,s,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new AE(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(s){return this.canonical.getTilePoint(new U0(s.x-this.wrap,s.y))}}function jf(c,s,h,p,x){(c*=2)<0&&(c=-1*c-1);const C=1<<h;return(C*C*c+C*x+p).toString(36)+h.toString(36)+s.toString(36)}dn("CanonicalTileID",Wf),dn("OverscaledTileID",Bo,{omit:["posMatrix"]});class V0{constructor(s,h,p,x=1,C=1,T=1,R=0){if(this.uid=s,h.height!==h.width)throw new RangeError("DEM tiles must be square");if(p&&!["mapbox","terrarium","custom"].includes(p))return void Se(`"${p}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=h.height;const F=this.dim=h.height-2;switch(this.data=new Uint32Array(h.data.buffer),p){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=x,this.greenFactor=C,this.blueFactor=T,this.baseShift=R;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let U=0;U<F;U++)this.data[this._idx(-1,U)]=this.data[this._idx(0,U)],this.data[this._idx(F,U)]=this.data[this._idx(F-1,U)],this.data[this._idx(U,-1)]=this.data[this._idx(U,0)],this.data[this._idx(U,F)]=this.data[this._idx(U,F-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(F,-1)]=this.data[this._idx(F-1,0)],this.data[this._idx(-1,F)]=this.data[this._idx(0,F-1)],this.data[this._idx(F,F)]=this.data[this._idx(F-1,F-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let U=0;U<F;U++)for(let G=0;G<F;G++){const Y=this.get(U,G);Y>this.max&&(this.max=Y),Y<this.min&&(this.min=Y)}}get(s,h){const p=new Uint8Array(this.data.buffer),x=4*this._idx(s,h);return this.unpack(p[x],p[x+1],p[x+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(s,h){if(s<-1||s>=this.dim+1||h<-1||h>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(h+1)*this.stride+(s+1)}unpack(s,h,p){return s*this.redFactor+h*this.greenFactor+p*this.blueFactor-this.baseShift}getPixels(){return new _s({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(s,h,p){if(this.dim!==s.dim)throw new Error("dem dimension mismatch");let x=h*this.dim,C=h*this.dim+this.dim,T=p*this.dim,R=p*this.dim+this.dim;switch(h){case-1:x=C-1;break;case 1:C=x+1}switch(p){case-1:T=R-1;break;case 1:R=T+1}const F=-h*this.dim,U=-p*this.dim;for(let G=T;G<R;G++)for(let Y=x;Y<C;Y++)this.data[this._idx(Y,G)]=s.data[this._idx(Y+F,G+U)]}}dn("DEMData",V0);class Yx{constructor(s){this._stringToNumber={},this._numberToString=[];for(let h=0;h<s.length;h++){const p=s[h];this._stringToNumber[p]=h,this._numberToString[h]=p}}encode(s){return this._stringToNumber[s]}decode(s){if(s>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${s} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[s]}}class Kx{constructor(s,h,p,x,C){this.type="Feature",this._vectorTileFeature=s,s._z=h,s._x=p,s._y=x,this.properties=s.properties,this.id=C}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(s){this._geometry=s}toJSON(){const s={geometry:this.geometry};for(const h in this)h!=="_geometry"&&h!=="_vectorTileFeature"&&(s[h]=this[h]);return s}}class Jx{constructor(s,h){this.tileID=s,this.x=s.canonical.x,this.y=s.canonical.y,this.z=s.canonical.z,this.grid=new ra(Oi,16,0),this.grid3D=new ra(Oi,16,0),this.featureIndexArray=new zo,this.promoteId=h}insert(s,h,p,x,C,T){const R=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(p,x,C);const F=T?this.grid3D:this.grid;for(let U=0;U<h.length;U++){const G=h[U],Y=[1/0,1/0,-1/0,-1/0];for(let ee=0;ee<G.length;ee++){const ae=G[ee];Y[0]=Math.min(Y[0],ae.x),Y[1]=Math.min(Y[1],ae.y),Y[2]=Math.max(Y[2],ae.x),Y[3]=Math.max(Y[3],ae.y)}Y[0]<Oi&&Y[1]<Oi&&Y[2]>=0&&Y[3]>=0&&F.insert(R,Y[0],Y[1],Y[2],Y[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new zu.VectorTile(new Ox(this.rawTileData)).layers,this.sourceLayerCoder=new Yx(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(s,h,p,x){this.loadVTLayers();const C=s.params||{},T=Oi/s.tileSize/s.scale,R=Nr(C.filter),F=s.queryGeometry,U=s.queryPadding*T,G=PE(F),Y=this.grid.query(G.minX-U,G.minY-U,G.maxX+U,G.maxY+U),ee=PE(s.cameraQueryGeometry),ae=this.grid3D.query(ee.minX-U,ee.minY-U,ee.maxX+U,ee.maxY+U,(Ae,Oe,tt,Le)=>function(Qe,dt,Ut,cn,nn){for(const rn of Qe)if(dt<=rn.x&&Ut<=rn.y&&cn>=rn.x&&nn>=rn.y)return!0;const ln=[new S(dt,Ut),new S(dt,nn),new S(cn,nn),new S(cn,Ut)];if(Qe.length>2){for(const rn of ln)if(sa(Qe,rn))return!0}for(let rn=0;rn<Qe.length-1;rn++)if(QI(Qe[rn],Qe[rn+1],ln))return!0;return!1}(s.cameraQueryGeometry,Ae-U,Oe-U,tt+U,Le+U));for(const Ae of ae)Y.push(Ae);Y.sort($R);const ue={};let pe;for(let Ae=0;Ae<Y.length;Ae++){const Oe=Y[Ae];if(Oe===pe)continue;pe=Oe;const tt=this.featureIndexArray.get(Oe);let Le=null;this.loadMatchingFeature(ue,tt.bucketIndex,tt.sourceLayerIndex,tt.featureIndex,R,C.layers,C.availableImages,h,p,x,(Qe,dt,Ut)=>(Le||(Le=Fc(Qe)),dt.queryIntersectsFeature(F,Qe,Ut,Le,this.z,s.transform,T,s.pixelPosMatrix)))}return ue}loadMatchingFeature(s,h,p,x,C,T,R,F,U,G,Y){const ee=this.bucketLayerIDs[h];if(T&&!function(Ae,Oe){for(let tt=0;tt<Ae.length;tt++)if(Oe.indexOf(Ae[tt])>=0)return!0;return!1}(T,ee))return;const ae=this.sourceLayerCoder.decode(p),ue=this.vtLayers[ae].feature(x);if(C.needGeometry){const Ae=Du(ue,!0);if(!C.filter(new tr(this.tileID.overscaledZ),Ae,this.tileID.canonical))return}else if(!C.filter(new tr(this.tileID.overscaledZ),ue))return;const pe=this.getId(ue,ae);for(let Ae=0;Ae<ee.length;Ae++){const Oe=ee[Ae];if(T&&T.indexOf(Oe)<0)continue;const tt=F[Oe];if(!tt)continue;let Le={};pe&&G&&(Le=G.getState(tt.sourceLayer||"_geojsonTileLayer",pe));const Qe=W({},U[Oe]);Qe.paint=Qx(Qe.paint,tt.paint,ue,Le,R),Qe.layout=Qx(Qe.layout,tt.layout,ue,Le,R);const dt=!Y||Y(ue,tt,Le);if(!dt)continue;const Ut=new Kx(ue,this.z,this.x,this.y,pe);Ut.layer=Qe;let cn=s[Oe];cn===void 0&&(cn=s[Oe]=[]),cn.push({featureIndex:x,feature:Ut,intersectionZ:dt})}}lookupSymbolFeatures(s,h,p,x,C,T,R,F){const U={};this.loadVTLayers();const G=Nr(C);for(const Y of s)this.loadMatchingFeature(U,p,x,Y,G,T,R,F,h);return U}hasLayer(s){for(const h of this.bucketLayerIDs)for(const p of h)if(s===p)return!0;return!1}getId(s,h){let p=s.id;return this.promoteId&&(p=s.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[h]],typeof p=="boolean"&&(p=Number(p))),p}}function Qx(c,s,h,p,x){return Z(c,(C,T)=>{const R=s instanceof Sf?s.get(T):null;return R&&R.evaluate?R.evaluate(h,p,x):R})}function PE(c){let s=1/0,h=1/0,p=-1/0,x=-1/0;for(const C of c)s=Math.min(s,C.x),h=Math.min(h,C.y),p=Math.max(p,C.x),x=Math.max(x,C.y);return{minX:s,minY:h,maxX:p,maxY:x}}function $R(c,s){return s-c}function IE(c,s,h,p,x){const C=[];for(let T=0;T<c.length;T++){const R=c[T];let F;for(let U=0;U<R.length-1;U++){let G=R[U],Y=R[U+1];G.x<s&&Y.x<s||(G.x<s?G=new S(s,G.y+(s-G.x)/(Y.x-G.x)*(Y.y-G.y))._round():Y.x<s&&(Y=new S(s,G.y+(s-G.x)/(Y.x-G.x)*(Y.y-G.y))._round()),G.y<h&&Y.y<h||(G.y<h?G=new S(G.x+(h-G.y)/(Y.y-G.y)*(Y.x-G.x),h)._round():Y.y<h&&(Y=new S(G.x+(h-G.y)/(Y.y-G.y)*(Y.x-G.x),h)._round()),G.x>=p&&Y.x>=p||(G.x>=p?G=new S(p,G.y+(p-G.x)/(Y.x-G.x)*(Y.y-G.y))._round():Y.x>=p&&(Y=new S(p,G.y+(p-G.x)/(Y.x-G.x)*(Y.y-G.y))._round()),G.y>=x&&Y.y>=x||(G.y>=x?G=new S(G.x+(x-G.y)/(Y.y-G.y)*(Y.x-G.x),x)._round():Y.y>=x&&(Y=new S(G.x+(x-G.y)/(Y.y-G.y)*(Y.x-G.x),x)._round()),F&&G.equals(F[F.length-1])||(F=[G],C.push(F)),F.push(Y)))))}}return C}dn("FeatureIndex",Jx,{omit:["rawTileData","sourceLayerCoder"]});class pl extends S{constructor(s,h,p,x){super(s,h),this.angle=p,x!==void 0&&(this.segment=x)}clone(){return new pl(this.x,this.y,this.angle,this.segment)}}function Lm(c,s,h,p,x){if(s.segment===void 0||h===0)return!0;let C=s,T=s.segment+1,R=0;for(;R>-h/2;){if(T--,T<0)return!1;R-=c[T].dist(C),C=c[T]}R+=c[T].dist(c[T+1]),T++;const F=[];let U=0;for(;R<h/2;){const G=c[T],Y=c[T+1];if(!Y)return!1;let ee=c[T-1].angleTo(G)-G.angleTo(Y);for(ee=Math.abs((ee+3*Math.PI)%(2*Math.PI)-Math.PI),F.push({distance:R,angleDelta:ee}),U+=ee;R-F[0].distance>p;)U-=F.shift().angleDelta;if(U>x)return!1;T++,R+=G.dist(Y)}return!0}function RE(c){let s=0;for(let h=0;h<c.length-1;h++)s+=c[h].dist(c[h+1]);return s}function LE(c,s,h){return c?.6*s*h:0}function $0(c,s){return Math.max(c?c.right-c.left:0,s?s.right-s.left:0)}function kE(c,s,h,p,x,C){const T=LE(h,x,C),R=$0(h,p)*C;let F=0;const U=RE(c)/2;for(let G=0;G<c.length-1;G++){const Y=c[G],ee=c[G+1],ae=Y.dist(ee);if(F+ae>U){const ue=(U-F)/ae,pe=ho.number(Y.x,ee.x,ue),Ae=ho.number(Y.y,ee.y,ue),Oe=new pl(pe,Ae,ee.angleTo(Y),G);return Oe._round(),!T||Lm(c,Oe,R,T,s)?Oe:void 0}F+=ae}}function HR(c,s,h,p,x,C,T,R,F){const U=LE(p,C,T),G=$0(p,x),Y=G*T,ee=c[0].x===0||c[0].x===F||c[0].y===0||c[0].y===F;return s-Y<s/4&&(s=Y+s/4),DE(c,ee?s/2*R%s:(G/2+2*C)*T*R%s,s,U,h,Y,ee,!1,F)}function DE(c,s,h,p,x,C,T,R,F){const U=C/2,G=RE(c);let Y=0,ee=s-h,ae=[];for(let ue=0;ue<c.length-1;ue++){const pe=c[ue],Ae=c[ue+1],Oe=pe.dist(Ae),tt=Ae.angleTo(pe);for(;ee+h<Y+Oe;){ee+=h;const Le=(ee-Y)/Oe,Qe=ho.number(pe.x,Ae.x,Le),dt=ho.number(pe.y,Ae.y,Le);if(Qe>=0&&Qe<F&&dt>=0&&dt<F&&ee-U>=0&&ee+U<=G){const Ut=new pl(Qe,dt,tt,ue);Ut._round(),p&&!Lm(c,Ut,C,p,x)||ae.push(Ut)}}Y+=Oe}return R||ae.length||T||(ae=DE(c,Y/2,h,p,x,C,T,!0,F)),ae}dn("Anchor",pl);const km=bo;function OE(c,s,h,p){const x=[],C=c.image,T=C.pixelRatio,R=C.paddedRect.w-2*km,F=C.paddedRect.h-2*km;let U={x1:c.left,y1:c.top,x2:c.right,y2:c.bottom};const G=C.stretchX||[[0,R]],Y=C.stretchY||[[0,F]],ee=(St,Pn)=>St+Pn[1]-Pn[0],ae=G.reduce(ee,0),ue=Y.reduce(ee,0),pe=R-ae,Ae=F-ue;let Oe=0,tt=ae,Le=0,Qe=ue,dt=0,Ut=pe,cn=0,nn=Ae;if(C.content&&p){const St=C.content,Pn=St[2]-St[0],wn=St[3]-St[1];(C.textFitWidth||C.textFitHeight)&&(U=mE(c)),Oe=H0(G,0,St[0]),Le=H0(Y,0,St[1]),tt=H0(G,St[0],St[2]),Qe=H0(Y,St[1],St[3]),dt=St[0]-Oe,cn=St[1]-Le,Ut=Pn-tt,nn=wn-Qe}const ln=U.x1,rn=U.y1,xn=U.x2-ln,mn=U.y2-rn,hn=(St,Pn,wn,Hn)=>{const Zi=G0(St.stretch-Oe,tt,xn,ln),Wi=W0(St.fixed-dt,Ut,St.stretch,ae),ns=G0(Pn.stretch-Le,Qe,mn,rn),La=W0(Pn.fixed-cn,nn,Pn.stretch,ue),bs=G0(wn.stretch-Oe,tt,xn,ln),Er=W0(wn.fixed-dt,Ut,wn.stretch,ae),to=G0(Hn.stretch-Le,Qe,mn,rn),ws=W0(Hn.fixed-cn,nn,Hn.stretch,ue),no=new S(Zi,ns),yr=new S(bs,ns),is=new S(bs,to),Ns=new S(Zi,to),Ss=new S(Wi/T,La/T),Fi=new S(Er/T,ws/T),ji=s*Math.PI/180;if(ji){const Mi=Math.sin(ji),Yi=Math.cos(ji),sr=[Yi,-Mi,Mi,Yi];no._matMult(sr),yr._matMult(sr),Ns._matMult(sr),is._matMult(sr)}const aa=St.stretch+St.fixed,wo=Pn.stretch+Pn.fixed;return{tl:no,tr:yr,bl:Ns,br:is,tex:{x:C.paddedRect.x+km+aa,y:C.paddedRect.y+km+wo,w:wn.stretch+wn.fixed-aa,h:Hn.stretch+Hn.fixed-wo},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ss,pixelOffsetBR:Fi,minFontScaleX:Ut/T/xn,minFontScaleY:nn/T/mn,isSDF:h}};if(p&&(C.stretchX||C.stretchY)){const St=FE(G,pe,ae),Pn=FE(Y,Ae,ue);for(let wn=0;wn<St.length-1;wn++){const Hn=St[wn],Zi=St[wn+1];for(let Wi=0;Wi<Pn.length-1;Wi++)x.push(hn(Hn,Pn[Wi],Zi,Pn[Wi+1]))}}else x.push(hn({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:R+1},{fixed:0,stretch:F+1}));return x}function H0(c,s,h){let p=0;for(const x of c)p+=Math.max(s,Math.min(h,x[1]))-Math.max(s,Math.min(h,x[0]));return p}function FE(c,s,h){const p=[{fixed:-1,stretch:0}];for(const[x,C]of c){const T=p[p.length-1];p.push({fixed:x-T.stretch,stretch:T.stretch}),p.push({fixed:x-T.stretch,stretch:T.stretch+(C-x)})}return p.push({fixed:s+km,stretch:h}),p}function G0(c,s,h,p){return c/s*h+p}function W0(c,s,h,p){return c-s*h/p}class j0{constructor(s,h,p,x,C,T,R,F,U,G){var Y;if(this.boxStartIndex=s.length,U){let ee=T.top,ae=T.bottom;const ue=T.collisionPadding;ue&&(ee-=ue[1],ae+=ue[3]);let pe=ae-ee;pe>0&&(pe=Math.max(10,pe),this.circleDiameter=pe)}else{const ee=!((Y=T.image)===null||Y===void 0)&&Y.content&&(T.image.textFitWidth||T.image.textFitHeight)?mE(T):{x1:T.left,y1:T.top,x2:T.right,y2:T.bottom};ee.y1=ee.y1*R-F[0],ee.y2=ee.y2*R+F[2],ee.x1=ee.x1*R-F[3],ee.x2=ee.x2*R+F[1];const ae=T.collisionPadding;if(ae&&(ee.x1-=ae[0]*R,ee.y1-=ae[1]*R,ee.x2+=ae[2]*R,ee.y2+=ae[3]*R),G){const ue=new S(ee.x1,ee.y1),pe=new S(ee.x2,ee.y1),Ae=new S(ee.x1,ee.y2),Oe=new S(ee.x2,ee.y2),tt=G*Math.PI/180;ue._rotate(tt),pe._rotate(tt),Ae._rotate(tt),Oe._rotate(tt),ee.x1=Math.min(ue.x,pe.x,Ae.x,Oe.x),ee.x2=Math.max(ue.x,pe.x,Ae.x,Oe.x),ee.y1=Math.min(ue.y,pe.y,Ae.y,Oe.y),ee.y2=Math.max(ue.y,pe.y,Ae.y,Oe.y)}s.emplaceBack(h.x,h.y,ee.x1,ee.y1,ee.x2,ee.y2,p,x,C)}this.boxEndIndex=s.length}}class GR{constructor(s=[],h=(p,x)=>p<x?-1:p>x?1:0){if(this.data=s,this.length=this.data.length,this.compare=h,this.length>0)for(let p=(this.length>>1)-1;p>=0;p--)this._down(p)}push(s){this.data.push(s),this._up(this.length++)}pop(){if(this.length===0)return;const s=this.data[0],h=this.data.pop();return--this.length>0&&(this.data[0]=h,this._down(0)),s}peek(){return this.data[0]}_up(s){const{data:h,compare:p}=this,x=h[s];for(;s>0;){const C=s-1>>1,T=h[C];if(p(x,T)>=0)break;h[s]=T,s=C}h[s]=x}_down(s){const{data:h,compare:p}=this,x=this.length>>1,C=h[s];for(;s<x;){let T=1+(s<<1);const R=T+1;if(R<this.length&&p(h[R],h[T])<0&&(T=R),p(h[T],C)>=0)break;h[s]=h[T],s=T}h[s]=C}}function WR(c,s=1,h=!1){let p=1/0,x=1/0,C=-1/0,T=-1/0;const R=c[0];for(let ae=0;ae<R.length;ae++){const ue=R[ae];(!ae||ue.x<p)&&(p=ue.x),(!ae||ue.y<x)&&(x=ue.y),(!ae||ue.x>C)&&(C=ue.x),(!ae||ue.y>T)&&(T=ue.y)}const F=Math.min(C-p,T-x);let U=F/2;const G=new GR([],jR);if(F===0)return new S(p,x);for(let ae=p;ae<C;ae+=F)for(let ue=x;ue<T;ue+=F)G.push(new Qs(ae+U,ue+U,U,c));let Y=function(ae){let ue=0,pe=0,Ae=0;const Oe=ae[0];for(let tt=0,Le=Oe.length,Qe=Le-1;tt<Le;Qe=tt++){const dt=Oe[tt],Ut=Oe[Qe],cn=dt.x*Ut.y-Ut.x*dt.y;pe+=(dt.x+Ut.x)*cn,Ae+=(dt.y+Ut.y)*cn,ue+=3*cn}return new Qs(pe/ue,Ae/ue,0,ae)}(c),ee=G.length;for(;G.length;){const ae=G.pop();(ae.d>Y.d||!Y.d)&&(Y=ae,h&&console.log("found best %d after %d probes",Math.round(1e4*ae.d)/1e4,ee)),ae.max-Y.d<=s||(U=ae.h/2,G.push(new Qs(ae.p.x-U,ae.p.y-U,U,c)),G.push(new Qs(ae.p.x+U,ae.p.y-U,U,c)),G.push(new Qs(ae.p.x-U,ae.p.y+U,U,c)),G.push(new Qs(ae.p.x+U,ae.p.y+U,U,c)),ee+=4)}return h&&(console.log(`num probes: ${ee}`),console.log(`best distance: ${Y.d}`)),Y.p}function jR(c,s){return s.max-c.max}function Qs(c,s,h,p){this.p=new S(c,s),this.h=h,this.d=function(x,C){let T=!1,R=1/0;for(let F=0;F<C.length;F++){const U=C[F];for(let G=0,Y=U.length,ee=Y-1;G<Y;ee=G++){const ae=U[G],ue=U[ee];ae.y>x.y!=ue.y>x.y&&x.x<(ue.x-ae.x)*(x.y-ae.y)/(ue.y-ae.y)+ae.x&&(T=!T),R=Math.min(R,x0(x,ae,ue))}}return(T?1:-1)*Math.sqrt(R)}(this.p,p),this.max=this.d+this.h*Math.SQRT2}var xs;u.ar=void 0,(xs=u.ar||(u.ar={}))[xs.center=1]="center",xs[xs.left=2]="left",xs[xs.right=3]="right",xs[xs.top=4]="top",xs[xs.bottom=5]="bottom",xs[xs["top-left"]=6]="top-left",xs[xs["top-right"]=7]="top-right",xs[xs["bottom-left"]=8]="bottom-left",xs[xs["bottom-right"]=9]="bottom-right";const $u=7,Vc=Number.POSITIVE_INFINITY;function oi(c,s){return s[1]!==Vc?function(h,p,x){let C=0,T=0;switch(p=Math.abs(p),x=Math.abs(x),h){case"top-right":case"top-left":case"top":T=x-$u;break;case"bottom-right":case"bottom-left":case"bottom":T=-x+$u}switch(h){case"top-right":case"bottom-right":case"right":C=-p;break;case"top-left":case"bottom-left":case"left":C=p}return[C,T]}(c,s[0],s[1]):function(h,p){let x=0,C=0;p<0&&(p=0);const T=p/Math.SQRT2;switch(h){case"top-right":case"top-left":C=T-$u;break;case"bottom-right":case"bottom-left":C=-T+$u;break;case"bottom":C=-p+$u;break;case"top":C=p-$u}switch(h){case"top-right":case"bottom-right":x=-T;break;case"top-left":case"bottom-left":x=T;break;case"left":x=p;break;case"right":x=-p}return[x,C]}(c,s[0])}function zE(c,s,h){var p;const x=c.layout,C=(p=x.get("text-variable-anchor-offset"))===null||p===void 0?void 0:p.evaluate(s,{},h);if(C){const R=C.values,F=[];for(let U=0;U<R.length;U+=2){const G=F[U]=R[U],Y=R[U+1].map(ee=>ee*Ur);G.startsWith("top")?Y[1]-=$u:G.startsWith("bottom")&&(Y[1]+=$u),F[U+1]=Y}return new mi(F)}const T=x.get("text-variable-anchor");if(T){let R;R=c._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[x.get("text-radial-offset").evaluate(s,{},h)*Ur,Vc]:x.get("text-offset").evaluate(s,{},h).map(U=>U*Ur);const F=[];for(const U of T)F.push(U,oi(U,R));return new mi(F)}return null}function eo(c){switch(c){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Zr(c,s,h,p,x,C,T,R,F,U,G){let Y=C.textMaxSize.evaluate(s,{});Y===void 0&&(Y=T);const ee=c.layers[0].layout,ae=ee.get("icon-offset").evaluate(s,{},G),ue=$c(h.horizontal),pe=T/24,Ae=c.tilePixelRatio*pe,Oe=c.tilePixelRatio*Y/24,tt=c.tilePixelRatio*R,Le=c.tilePixelRatio*ee.get("symbol-spacing"),Qe=ee.get("text-padding")*c.tilePixelRatio,dt=function(St,Pn,wn,Hn=1){const Zi=St.get("icon-padding").evaluate(Pn,{},wn),Wi=Zi&&Zi.values;return[Wi[0]*Hn,Wi[1]*Hn,Wi[2]*Hn,Wi[3]*Hn]}(ee,s,G,c.tilePixelRatio),Ut=ee.get("text-max-angle")/180*Math.PI,cn=ee.get("text-rotation-alignment")!=="viewport"&&ee.get("symbol-placement")!=="point",nn=ee.get("icon-rotation-alignment")==="map"&&ee.get("symbol-placement")!=="point",ln=ee.get("symbol-placement"),rn=Le/2,xn=ee.get("icon-text-fit");let mn;p&&xn!=="none"&&(c.allowVerticalPlacement&&h.vertical&&(mn=Vx(p,h.vertical,xn,ee.get("icon-text-fit-padding"),ae,pe)),ue&&(p=Vx(p,ue,xn,ee.get("icon-text-fit-padding"),ae,pe)));const hn=(St,Pn)=>{Pn.x<0||Pn.x>=Oi||Pn.y<0||Pn.y>=Oi||function(wn,Hn,Zi,Wi,ns,La,bs,Er,to,ws,no,yr,is,Ns,Ss,Fi,ji,aa,wo,Mi,Yi,sr,Uo,xr,Yh){const Jl=wn.addToLineVertexArray(Hn,Zi);let Ql,ka,Vo,rs,Hc=0,Dm=0,VE=0,$E=0,Hu=-1,r1=-1;const Gc={};let HE=$h("");if(wn.allowVerticalPlacement&&Wi.vertical){const Bs=Er.layout.get("text-rotate").evaluate(Yi,{},xr)+90;Vo=new j0(to,Hn,ws,no,yr,Wi.vertical,is,Ns,Ss,Bs),bs&&(rs=new j0(to,Hn,ws,no,yr,bs,ji,aa,Ss,Bs))}if(ns){const Bs=Er.layout.get("icon-rotate").evaluate(Yi,{}),la=Er.layout.get("icon-text-fit")!=="none",Kh=OE(ns,Bs,Uo,la),gl=bs?OE(bs,Bs,Uo,la):void 0;ka=new j0(to,Hn,ws,no,yr,ns,ji,aa,!1,Bs),Hc=4*Kh.length;const Jh=wn.iconSizeData;let ec=null;Jh.kind==="source"?(ec=[oa*Er.layout.get("icon-size").evaluate(Yi,{})],ec[0]>Uu&&Se(`${wn.layerIds[0]}: Value for "icon-size" is >= ${Rm}. Reduce your "icon-size".`)):Jh.kind==="composite"&&(ec=[oa*sr.compositeIconSizes[0].evaluate(Yi,{},xr),oa*sr.compositeIconSizes[1].evaluate(Yi,{},xr)],(ec[0]>Uu||ec[1]>Uu)&&Se(`${wn.layerIds[0]}: Value for "icon-size" is >= ${Rm}. Reduce your "icon-size".`)),wn.addSymbols(wn.icon,Kh,ec,Mi,wo,Yi,u.ai.none,Hn,Jl.lineStartIndex,Jl.lineLength,-1,xr),Hu=wn.icon.placedSymbolArray.length-1,gl&&(Dm=4*gl.length,wn.addSymbols(wn.icon,gl,ec,Mi,wo,Yi,u.ai.vertical,Hn,Jl.lineStartIndex,Jl.lineLength,-1,xr),r1=wn.icon.placedSymbolArray.length-1)}const GE=Object.keys(Wi.horizontal);for(const Bs of GE){const la=Wi.horizontal[Bs];if(!Ql){HE=$h(la.text);const gl=Er.layout.get("text-rotate").evaluate(Yi,{},xr);Ql=new j0(to,Hn,ws,no,yr,la,is,Ns,Ss,gl)}const Kh=la.positionedLines.length===1;if(VE+=NE(wn,Hn,la,La,Er,Ss,Yi,Fi,Jl,Wi.vertical?u.ai.horizontal:u.ai.horizontalOnly,Kh?GE:[Bs],Gc,Hu,sr,xr),Kh)break}Wi.vertical&&($E+=NE(wn,Hn,Wi.vertical,La,Er,Ss,Yi,Fi,Jl,u.ai.vertical,["vertical"],Gc,r1,sr,xr));const ZR=Ql?Ql.boxStartIndex:wn.collisionBoxArray.length,WE=Ql?Ql.boxEndIndex:wn.collisionBoxArray.length,jE=Vo?Vo.boxStartIndex:wn.collisionBoxArray.length,YR=Vo?Vo.boxEndIndex:wn.collisionBoxArray.length,KR=ka?ka.boxStartIndex:wn.collisionBoxArray.length,JR=ka?ka.boxEndIndex:wn.collisionBoxArray.length,QR=rs?rs.boxStartIndex:wn.collisionBoxArray.length,eL=rs?rs.boxEndIndex:wn.collisionBoxArray.length;let ml=-1;const Z0=(Bs,la)=>Bs&&Bs.circleDiameter?Math.max(Bs.circleDiameter,la):la;ml=Z0(Ql,ml),ml=Z0(Vo,ml),ml=Z0(ka,ml),ml=Z0(rs,ml);const qE=ml>-1?1:0;qE&&(ml*=Yh/Ur),wn.glyphOffsetArray.length>=Gf.MAX_GLYPHS&&Se("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Yi.sortKey!==void 0&&wn.addToSortKeyRanges(wn.symbolInstances.length,Yi.sortKey);const tL=zE(Er,Yi,xr),[nL,iL]=function(Bs,la){const Kh=Bs.length,gl=la==null?void 0:la.values;if((gl==null?void 0:gl.length)>0)for(let Jh=0;Jh<gl.length;Jh+=2){const ec=gl[Jh+1];Bs.emplaceBack(u.ar[gl[Jh]],ec[0],ec[1])}return[Kh,Bs.length]}(wn.textAnchorOffsets,tL);wn.symbolInstances.emplaceBack(Hn.x,Hn.y,Gc.right>=0?Gc.right:-1,Gc.center>=0?Gc.center:-1,Gc.left>=0?Gc.left:-1,Gc.vertical||-1,Hu,r1,HE,ZR,WE,jE,YR,KR,JR,QR,eL,ws,VE,$E,Hc,Dm,qE,0,is,ml,nL,iL)}(c,Pn,St,h,p,x,mn,c.layers[0],c.collisionBoxArray,s.index,s.sourceLayerIndex,c.index,Ae,[Qe,Qe,Qe,Qe],cn,F,tt,dt,nn,ae,s,C,U,G,T)};if(ln==="line")for(const St of IE(s.geometry,0,0,Oi,Oi)){const Pn=HR(St,Le,Ut,h.vertical||ue,p,24,Oe,c.overscaling,Oi);for(const wn of Pn)ue&&qR(c,ue.text,rn,wn)||hn(St,wn)}else if(ln==="line-center"){for(const St of s.geometry)if(St.length>1){const Pn=kE(St,Ut,h.vertical||ue,p,24,Oe);Pn&&hn(St,Pn)}}else if(s.type==="Polygon")for(const St of ta(s.geometry,0)){const Pn=WR(St,16);hn(St[0],new pl(Pn.x,Pn.y,0))}else if(s.type==="LineString")for(const St of s.geometry)hn(St,new pl(St[0].x,St[0].y,0));else if(s.type==="Point")for(const St of s.geometry)for(const Pn of St)hn([Pn],new pl(Pn.x,Pn.y,0))}function NE(c,s,h,p,x,C,T,R,F,U,G,Y,ee,ae,ue){const pe=function(tt,Le,Qe,dt,Ut,cn,nn,ln){const rn=dt.layout.get("text-rotate").evaluate(cn,{})*Math.PI/180,xn=[];for(const mn of Le.positionedLines)for(const hn of mn.positionedGlyphs){if(!hn.rect)continue;const St=hn.rect||{};let Pn=PR+1,wn=!0,Hn=1,Zi=0;const Wi=(Ut||ln)&&hn.vertical,ns=hn.metrics.advance*hn.scale/2;if(ln&&Le.verticalizable&&(Zi=mn.lineOffset/2-(hn.imageName?-(Ur-hn.metrics.width*hn.scale)/2:(hn.scale-1)*Ur)),hn.imageName){const Mi=nn[hn.imageName];wn=Mi.sdf,Hn=Mi.pixelRatio,Pn=bo/Hn}const La=Ut?[hn.x+ns,hn.y]:[0,0];let bs=Ut?[0,0]:[hn.x+ns+Qe[0],hn.y+Qe[1]-Zi],Er=[0,0];Wi&&(Er=bs,bs=[0,0]);const to=hn.metrics.isDoubleResolution?2:1,ws=(hn.metrics.left-Pn)*hn.scale-ns+bs[0],no=(-hn.metrics.top-Pn)*hn.scale+bs[1],yr=ws+St.w/to*hn.scale/Hn,is=no+St.h/to*hn.scale/Hn,Ns=new S(ws,no),Ss=new S(yr,no),Fi=new S(ws,is),ji=new S(yr,is);if(Wi){const Mi=new S(-ns,ns-Pm),Yi=-Math.PI/2,sr=Ur/2-ns,Uo=new S(5-Pm-sr,-(hn.imageName?sr:0)),xr=new S(...Er);Ns._rotateAround(Yi,Mi)._add(Uo)._add(xr),Ss._rotateAround(Yi,Mi)._add(Uo)._add(xr),Fi._rotateAround(Yi,Mi)._add(Uo)._add(xr),ji._rotateAround(Yi,Mi)._add(Uo)._add(xr)}if(rn){const Mi=Math.sin(rn),Yi=Math.cos(rn),sr=[Yi,-Mi,Mi,Yi];Ns._matMult(sr),Ss._matMult(sr),Fi._matMult(sr),ji._matMult(sr)}const aa=new S(0,0),wo=new S(0,0);xn.push({tl:Ns,tr:Ss,bl:Fi,br:ji,tex:St,writingMode:Le.writingMode,glyphOffset:La,sectionIndex:hn.sectionIndex,isSDF:wn,pixelOffsetTL:aa,pixelOffsetBR:wo,minFontScaleX:0,minFontScaleY:0})}return xn}(0,h,R,x,C,T,p,c.allowVerticalPlacement),Ae=c.textSizeData;let Oe=null;Ae.kind==="source"?(Oe=[oa*x.layout.get("text-size").evaluate(T,{})],Oe[0]>Uu&&Se(`${c.layerIds[0]}: Value for "text-size" is >= ${Rm}. Reduce your "text-size".`)):Ae.kind==="composite"&&(Oe=[oa*ae.compositeTextSizes[0].evaluate(T,{},ue),oa*ae.compositeTextSizes[1].evaluate(T,{},ue)],(Oe[0]>Uu||Oe[1]>Uu)&&Se(`${c.layerIds[0]}: Value for "text-size" is >= ${Rm}. Reduce your "text-size".`)),c.addSymbols(c.text,pe,Oe,R,C,T,U,s,F.lineStartIndex,F.lineLength,ee,ue);for(const tt of G)Y[tt]=c.text.placedSymbolArray.length-1;return 4*pe.length}function $c(c){for(const s in c)return c[s];return null}function qR(c,s,h,p){const x=c.compareText;if(s in x){const C=x[s];for(let T=C.length-1;T>=0;T--)if(p.dist(C[T])<h)return!0}else x[s]=[];return x[s].push(p),!1}const BE=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class e1{static from(s){if(!(s instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[h,p]=new Uint8Array(s,0,2);if(h!==219)throw new Error("Data does not appear to be in a KDBush format.");const x=p>>4;if(x!==1)throw new Error(`Got v${x} data when expected v1.`);const C=BE[15&p];if(!C)throw new Error("Unrecognized array type.");const[T]=new Uint16Array(s,2,1),[R]=new Uint32Array(s,4,1);return new e1(R,T,C,s)}constructor(s,h=64,p=Float64Array,x){if(isNaN(s)||s<0)throw new Error(`Unpexpected numItems value: ${s}.`);this.numItems=+s,this.nodeSize=Math.min(Math.max(+h,2),65535),this.ArrayType=p,this.IndexArrayType=s<65536?Uint16Array:Uint32Array;const C=BE.indexOf(this.ArrayType),T=2*s*this.ArrayType.BYTES_PER_ELEMENT,R=s*this.IndexArrayType.BYTES_PER_ELEMENT,F=(8-R%8)%8;if(C<0)throw new Error(`Unexpected typed array class: ${p}.`);x&&x instanceof ArrayBuffer?(this.data=x,this.ids=new this.IndexArrayType(this.data,8,s),this.coords=new this.ArrayType(this.data,8+R+F,2*s),this._pos=2*s,this._finished=!0):(this.data=new ArrayBuffer(8+T+R+F),this.ids=new this.IndexArrayType(this.data,8,s),this.coords=new this.ArrayType(this.data,8+R+F,2*s),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+C]),new Uint16Array(this.data,2,1)[0]=h,new Uint32Array(this.data,4,1)[0]=s)}add(s,h){const p=this._pos>>1;return this.ids[p]=p,this.coords[this._pos++]=s,this.coords[this._pos++]=h,p}finish(){const s=this._pos>>1;if(s!==this.numItems)throw new Error(`Added ${s} items when expected ${this.numItems}.`);return t1(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(s,h,p,x){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:C,coords:T,nodeSize:R}=this,F=[0,C.length-1,0],U=[];for(;F.length;){const G=F.pop()||0,Y=F.pop()||0,ee=F.pop()||0;if(Y-ee<=R){for(let Ae=ee;Ae<=Y;Ae++){const Oe=T[2*Ae],tt=T[2*Ae+1];Oe>=s&&Oe<=p&&tt>=h&&tt<=x&&U.push(C[Ae])}continue}const ae=ee+Y>>1,ue=T[2*ae],pe=T[2*ae+1];ue>=s&&ue<=p&&pe>=h&&pe<=x&&U.push(C[ae]),(G===0?s<=ue:h<=pe)&&(F.push(ee),F.push(ae-1),F.push(1-G)),(G===0?p>=ue:x>=pe)&&(F.push(ae+1),F.push(Y),F.push(1-G))}return U}within(s,h,p){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:x,coords:C,nodeSize:T}=this,R=[0,x.length-1,0],F=[],U=p*p;for(;R.length;){const G=R.pop()||0,Y=R.pop()||0,ee=R.pop()||0;if(Y-ee<=T){for(let Ae=ee;Ae<=Y;Ae++)Kl(C[2*Ae],C[2*Ae+1],s,h)<=U&&F.push(x[Ae]);continue}const ae=ee+Y>>1,ue=C[2*ae],pe=C[2*ae+1];Kl(ue,pe,s,h)<=U&&F.push(x[ae]),(G===0?s-p<=ue:h-p<=pe)&&(R.push(ee),R.push(ae-1),R.push(1-G)),(G===0?s+p>=ue:h+p>=pe)&&(R.push(ae+1),R.push(Y),R.push(1-G))}return F}}function t1(c,s,h,p,x,C){if(x-p<=h)return;const T=p+x>>1;UE(c,s,T,p,x,C),t1(c,s,h,p,T-1,1-C),t1(c,s,h,T+1,x,1-C)}function UE(c,s,h,p,x,C){for(;x>p;){if(x-p>600){const U=x-p+1,G=h-p+1,Y=Math.log(U),ee=.5*Math.exp(2*Y/3),ae=.5*Math.sqrt(Y*ee*(U-ee)/U)*(G-U/2<0?-1:1);UE(c,s,h,Math.max(p,Math.floor(h-G*ee/U+ae)),Math.min(x,Math.floor(h+(U-G)*ee/U+ae)),C)}const T=s[2*h+C];let R=p,F=x;for(Xh(c,s,p,h),s[2*x+C]>T&&Xh(c,s,p,x);R<F;){for(Xh(c,s,R,F),R++,F--;s[2*R+C]<T;)R++;for(;s[2*F+C]>T;)F--}s[2*p+C]===T?Xh(c,s,p,F):(F++,Xh(c,s,F,x)),F<=h&&(p=F+1),h<=F&&(x=F-1)}}function Xh(c,s,h,p){n1(c,h,p),n1(s,2*h,2*p),n1(s,2*h+1,2*p+1)}function n1(c,s,h){const p=c[s];c[s]=c[h],c[h]=p}function Kl(c,s,h,p){const x=c-h,C=s-p;return x*x+C*C}var q0;u.bf=void 0,(q0=u.bf||(u.bf={})).create="create",q0.load="load",q0.fullLoad="fullLoad";let Zh=null,fr=[];const Sr=1e3/60,X0="loadTime",i1="fullLoadTime",XR={mark(c){performance.mark(c)},frame(c){const s=c;Zh!=null&&fr.push(s-Zh),Zh=s},clearMetrics(){Zh=null,fr=[],performance.clearMeasures(X0),performance.clearMeasures(i1);for(const c in u.bf)performance.clearMarks(u.bf[c])},getPerformanceMetrics(){performance.measure(X0,u.bf.create,u.bf.load),performance.measure(i1,u.bf.create,u.bf.fullLoad);const c=performance.getEntriesByName(X0)[0].duration,s=performance.getEntriesByName(i1)[0].duration,h=fr.length,p=1/(fr.reduce((C,T)=>C+T,0)/h/1e3),x=fr.filter(C=>C>Sr).reduce((C,T)=>C+(T-Sr)/Sr,0);return{loadTime:c,fullLoadTime:s,fps:p,percentDroppedFrames:x/(h+x)*100,totalFrames:h}}};u.$=class extends fe{},u.A=Gh,u.B=Hl,u.C=function(c){if(ye==null){const s=c.navigator?c.navigator.userAgent:null;ye=!!c.safari||!(!s||!(/\b(iPad|iPhone|iPod)\b/.test(s)||s.match("Safari")&&!s.match("Chrome")))}return ye},u.D=Tn,u.E=Cn,u.F=class{constructor(c,s){this.target=c,this.mapId=s,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new VR(()=>this.process()),this.subscription=function(h,p,x,C){return h.addEventListener(p,x,!1),{unsubscribe:()=>{h.removeEventListener(p,x,!1)}}}(this.target,"message",h=>this.receive(h)),this.globalScope=Ye(self)?c:window}registerMessageHandler(c,s){this.messageHandlers[c]=s}sendAsync(c,s){return new Promise((h,p)=>{const x=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[x]={resolve:h,reject:p},s&&s.signal.addEventListener("abort",()=>{delete this.resolveRejects[x];const R={id:x,type:"<cancel>",origin:location.origin,targetMapId:c.targetMapId,sourceMapId:this.mapId};this.target.postMessage(R)},{once:!0});const C=[],T=Object.assign(Object.assign({},c),{id:x,sourceMapId:this.mapId,origin:location.origin,data:Gl(c.data,C)});this.target.postMessage(T,{transfer:C})})}receive(c){const s=c.data,h=s.id;if(!(s.origin!=="file://"&&location.origin!=="file://"&&s.origin!=="resource://android"&&location.origin!=="resource://android"&&s.origin!==location.origin||s.targetMapId&&this.mapId!==s.targetMapId)){if(s.type==="<cancel>"){delete this.tasks[h];const p=this.abortControllers[h];return delete this.abortControllers[h],void(p&&p.abort())}if(Ye(self)||s.mustQueue)return this.tasks[h]=s,this.taskQueue.push(h),void this.invoker.trigger();this.processTask(h,s)}}process(){if(this.taskQueue.length===0)return;const c=this.taskQueue.shift(),s=this.tasks[c];delete this.tasks[c],this.taskQueue.length>0&&this.invoker.trigger(),s&&this.processTask(c,s)}processTask(c,s){return l(this,void 0,void 0,function*(){if(s.type==="<response>"){const x=this.resolveRejects[c];return delete this.resolveRejects[c],x?void(s.error?x.reject(Ks(s.error)):x.resolve(Ks(s.data))):void 0}if(!this.messageHandlers[s.type])return void this.completeTask(c,new Error(`Could not find a registered handler for ${s.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const h=Ks(s.data),p=new AbortController;this.abortControllers[c]=p;try{const x=yield this.messageHandlers[s.type](s.sourceMapId,h,p);this.completeTask(c,null,x)}catch(x){this.completeTask(c,x)}})}completeTask(c,s,h){const p=[];delete this.abortControllers[c];const x={id:c,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:s?Gl(s):null,data:Gl(h,p)};this.target.postMessage(x,{transfer:p})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},u.G=zt,u.H=function(){var c=new Gh(16);return Gh!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=0,c[12]=0,c[13]=0,c[14]=0),c[0]=1,c[5]=1,c[10]=1,c[15]=1,c},u.I=zx,u.J=function(c,s,h){var p,x,C,T,R,F,U,G,Y,ee,ae,ue,pe=h[0],Ae=h[1],Oe=h[2];return s===c?(c[12]=s[0]*pe+s[4]*Ae+s[8]*Oe+s[12],c[13]=s[1]*pe+s[5]*Ae+s[9]*Oe+s[13],c[14]=s[2]*pe+s[6]*Ae+s[10]*Oe+s[14],c[15]=s[3]*pe+s[7]*Ae+s[11]*Oe+s[15]):(x=s[1],C=s[2],T=s[3],R=s[4],F=s[5],U=s[6],G=s[7],Y=s[8],ee=s[9],ae=s[10],ue=s[11],c[0]=p=s[0],c[1]=x,c[2]=C,c[3]=T,c[4]=R,c[5]=F,c[6]=U,c[7]=G,c[8]=Y,c[9]=ee,c[10]=ae,c[11]=ue,c[12]=p*pe+R*Ae+Y*Oe+s[12],c[13]=x*pe+F*Ae+ee*Oe+s[13],c[14]=C*pe+U*Ae+ae*Oe+s[14],c[15]=T*pe+G*Ae+ue*Oe+s[15]),c},u.K=function(c,s,h){var p=h[0],x=h[1],C=h[2];return c[0]=s[0]*p,c[1]=s[1]*p,c[2]=s[2]*p,c[3]=s[3]*p,c[4]=s[4]*x,c[5]=s[5]*x,c[6]=s[6]*x,c[7]=s[7]*x,c[8]=s[8]*C,c[9]=s[9]*C,c[10]=s[10]*C,c[11]=s[11]*C,c[12]=s[12],c[13]=s[13],c[14]=s[14],c[15]=s[15],c},u.L=k2,u.M=function(c,s){const h={};for(let p=0;p<s.length;p++){const x=s[p];x in c&&(h[x]=c[x])}return h},u.N=Vu,u.O=EE,u.P=S,u.Q=ME,u.R=_s,u.S=Bo,u.T=Tu,u.U=P,u.V=N,u.W=Be,u.X=Oi,u.Y=H,u.Z=U0,u._=l,u.a=Ke,u.a$=function(c,s){var h=c[0],p=c[1],x=c[2],C=c[3],T=c[4],R=c[5],F=c[6],U=c[7],G=c[8],Y=c[9],ee=c[10],ae=c[11],ue=c[12],pe=c[13],Ae=c[14],Oe=c[15],tt=s[0],Le=s[1],Qe=s[2],dt=s[3],Ut=s[4],cn=s[5],nn=s[6],ln=s[7],rn=s[8],xn=s[9],mn=s[10],hn=s[11],St=s[12],Pn=s[13],wn=s[14],Hn=s[15];return Math.abs(h-tt)<=Js*Math.max(1,Math.abs(h),Math.abs(tt))&&Math.abs(p-Le)<=Js*Math.max(1,Math.abs(p),Math.abs(Le))&&Math.abs(x-Qe)<=Js*Math.max(1,Math.abs(x),Math.abs(Qe))&&Math.abs(C-dt)<=Js*Math.max(1,Math.abs(C),Math.abs(dt))&&Math.abs(T-Ut)<=Js*Math.max(1,Math.abs(T),Math.abs(Ut))&&Math.abs(R-cn)<=Js*Math.max(1,Math.abs(R),Math.abs(cn))&&Math.abs(F-nn)<=Js*Math.max(1,Math.abs(F),Math.abs(nn))&&Math.abs(U-ln)<=Js*Math.max(1,Math.abs(U),Math.abs(ln))&&Math.abs(G-rn)<=Js*Math.max(1,Math.abs(G),Math.abs(rn))&&Math.abs(Y-xn)<=Js*Math.max(1,Math.abs(Y),Math.abs(xn))&&Math.abs(ee-mn)<=Js*Math.max(1,Math.abs(ee),Math.abs(mn))&&Math.abs(ae-hn)<=Js*Math.max(1,Math.abs(ae),Math.abs(hn))&&Math.abs(ue-St)<=Js*Math.max(1,Math.abs(ue),Math.abs(St))&&Math.abs(pe-Pn)<=Js*Math.max(1,Math.abs(pe),Math.abs(Pn))&&Math.abs(Ae-wn)<=Js*Math.max(1,Math.abs(Ae),Math.abs(wn))&&Math.abs(Oe-Hn)<=Js*Math.max(1,Math.abs(Oe),Math.abs(Hn))},u.a0=Xr,u.a1=Wf,u.a2=it,u.a3=c=>{const s=window.document.createElement("video");return s.muted=!0,new Promise(h=>{s.onloadstart=()=>{h(s)};for(const p of c){const x=window.document.createElement("source");Bt(p)||(s.crossOrigin="Anonymous"),x.src=p,s.appendChild(x)}})},u.a4=function(){return ie++},u.a5=ei,u.a6=Gf,u.a7=Nr,u.a8=Du,u.a9=tr,u.aA=function(c){c=c.slice();const s=Object.create(null);for(let h=0;h<c.length;h++)s[c[h].id]=c[h];for(let h=0;h<c.length;h++)"ref"in c[h]&&(c[h]=Pt(c[h],s[c[h].ref]));return c},u.aB=function(c){if(c.type==="custom")return new B0(c);switch(c.type){case"background":return new NR(c);case"circle":return new Zl(c);case"fill":return new oR(c);case"fill-extrusion":return new Ix(c);case"heatmap":return new tR(c);case"hillshade":return new M0(c);case"line":return new pR(c);case"raster":return new UR(c);case"symbol":return new N0(c)}},u.aC=se,u.aD=function(c,s){if(!c)return[{command:"setStyle",args:[s]}];let h=[];try{if(!mt(c.version,s.version))return[{command:"setStyle",args:[s]}];mt(c.center,s.center)||h.push({command:"setCenter",args:[s.center]}),mt(c.zoom,s.zoom)||h.push({command:"setZoom",args:[s.zoom]}),mt(c.bearing,s.bearing)||h.push({command:"setBearing",args:[s.bearing]}),mt(c.pitch,s.pitch)||h.push({command:"setPitch",args:[s.pitch]}),mt(c.sprite,s.sprite)||h.push({command:"setSprite",args:[s.sprite]}),mt(c.glyphs,s.glyphs)||h.push({command:"setGlyphs",args:[s.glyphs]}),mt(c.transition,s.transition)||h.push({command:"setTransition",args:[s.transition]}),mt(c.light,s.light)||h.push({command:"setLight",args:[s.light]}),mt(c.terrain,s.terrain)||h.push({command:"setTerrain",args:[s.terrain]}),mt(c.sky,s.sky)||h.push({command:"setSky",args:[s.sky]}),mt(c.projection,s.projection)||h.push({command:"setProjection",args:[s.projection]});const p={},x=[];(function(T,R,F,U){let G;for(G in R=R||{},T=T||{})Object.prototype.hasOwnProperty.call(T,G)&&(Object.prototype.hasOwnProperty.call(R,G)||Xe(G,F,U));for(G in R)Object.prototype.hasOwnProperty.call(R,G)&&(Object.prototype.hasOwnProperty.call(T,G)?mt(T[G],R[G])||(T[G].type==="geojson"&&R[G].type==="geojson"&&st(T,R,G)?ve(F,{command:"setGeoJSONSourceData",args:[G,R[G].data]}):Ge(G,R,F,U)):re(G,R,F))})(c.sources,s.sources,x,p);const C=[];c.layers&&c.layers.forEach(T=>{"source"in T&&p[T.source]?h.push({command:"removeLayer",args:[T.id]}):C.push(T)}),h=h.concat(x),function(T,R,F){R=R||[];const U=(T=T||[]).map(Ht),G=R.map(Ht),Y=T.reduce($t,{}),ee=R.reduce($t,{}),ae=U.slice(),ue=Object.create(null);let pe,Ae,Oe,tt,Le;for(let Qe=0,dt=0;Qe<U.length;Qe++)pe=U[Qe],Object.prototype.hasOwnProperty.call(ee,pe)?dt++:(ve(F,{command:"removeLayer",args:[pe]}),ae.splice(ae.indexOf(pe,dt),1));for(let Qe=0,dt=0;Qe<G.length;Qe++)pe=G[G.length-1-Qe],ae[ae.length-1-Qe]!==pe&&(Object.prototype.hasOwnProperty.call(Y,pe)?(ve(F,{command:"removeLayer",args:[pe]}),ae.splice(ae.lastIndexOf(pe,ae.length-dt),1)):dt++,tt=ae[ae.length-Qe],ve(F,{command:"addLayer",args:[ee[pe],tt]}),ae.splice(ae.length-Qe,0,pe),ue[pe]=!0);for(let Qe=0;Qe<G.length;Qe++)if(pe=G[Qe],Ae=Y[pe],Oe=ee[pe],!ue[pe]&&!mt(Ae,Oe))if(mt(Ae.source,Oe.source)&&mt(Ae["source-layer"],Oe["source-layer"])&&mt(Ae.type,Oe.type)){for(Le in ft(Ae.layout,Oe.layout,F,pe,null,"setLayoutProperty"),ft(Ae.paint,Oe.paint,F,pe,null,"setPaintProperty"),mt(Ae.filter,Oe.filter)||ve(F,{command:"setFilter",args:[pe,Oe.filter]}),mt(Ae.minzoom,Oe.minzoom)&&mt(Ae.maxzoom,Oe.maxzoom)||ve(F,{command:"setLayerZoomRange",args:[pe,Oe.minzoom,Oe.maxzoom]}),Ae)Object.prototype.hasOwnProperty.call(Ae,Le)&&Le!=="layout"&&Le!=="paint"&&Le!=="filter"&&Le!=="metadata"&&Le!=="minzoom"&&Le!=="maxzoom"&&(Le.indexOf("paint.")===0?ft(Ae[Le],Oe[Le],F,pe,Le.slice(6),"setPaintProperty"):mt(Ae[Le],Oe[Le])||ve(F,{command:"setLayerProperty",args:[pe,Le,Oe[Le]]}));for(Le in Oe)Object.prototype.hasOwnProperty.call(Oe,Le)&&!Object.prototype.hasOwnProperty.call(Ae,Le)&&Le!=="layout"&&Le!=="paint"&&Le!=="filter"&&Le!=="metadata"&&Le!=="minzoom"&&Le!=="maxzoom"&&(Le.indexOf("paint.")===0?ft(Ae[Le],Oe[Le],F,pe,Le.slice(6),"setPaintProperty"):mt(Ae[Le],Oe[Le])||ve(F,{command:"setLayerProperty",args:[pe,Le,Oe[Le]]}))}else ve(F,{command:"removeLayer",args:[pe]}),tt=ae[ae.lastIndexOf(pe)+1],ve(F,{command:"addLayer",args:[Oe,tt]})}(C,s.layers,h)}catch(p){console.warn("Unable to compute style diff:",p),h=[{command:"setStyle",args:[s]}]}return h},u.aE=function(c){const s=[],h=c.id;return h===void 0&&s.push({message:`layers.${h}: missing required property "id"`}),c.render===void 0&&s.push({message:`layers.${h}: missing required method "render"`}),c.renderingMode&&c.renderingMode!=="2d"&&c.renderingMode!=="3d"&&s.push({message:`layers.${h}: property "renderingMode" must be either "2d" or "3d"`}),s},u.aF=function c(s,h){if(Array.isArray(s)){if(!Array.isArray(h)||s.length!==h.length)return!1;for(let p=0;p<s.length;p++)if(!c(s[p],h[p]))return!1;return!0}if(typeof s=="object"&&s!==null&&h!==null){if(typeof h!="object"||Object.keys(s).length!==Object.keys(h).length)return!1;for(const p in s)if(!c(s[p],h[p]))return!1;return!0}return s===h},u.aG=Z,u.aH=X,u.aI=class extends Hh{constructor(c,s){super(c,s),this.current=0}set(c){this.current!==c&&(this.current=c,this.gl.uniform1i(this.location,c))}},u.aJ=gm,u.aK=class extends Hh{constructor(c,s){super(c,s),this.current=I2}set(c){if(c[12]!==this.current[12]||c[0]!==this.current[0])return this.current=c,void this.gl.uniformMatrix4fv(this.location,!1,c);for(let s=1;s<16;s++)if(c[s]!==this.current[s]){this.current=c,this.gl.uniformMatrix4fv(this.location,!1,c);break}}},u.aL=P2,u.aM=g0,u.aN=Yt,u.aO=class extends Hh{constructor(c,s){super(c,s),this.current=[0,0,0]}set(c){c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]||(this.current=c,this.gl.uniform3f(this.location,c[0],c[1],c[2]))}},u.aP=class extends Hh{constructor(c,s){super(c,s),this.current=[0,0]}set(c){c[0]===this.current[0]&&c[1]===this.current[1]||(this.current=c,this.gl.uniform2f(this.location,c[0],c[1]))}},u.aQ=function(c,s,h,p,x,C,T){var R=1/(s-h),F=1/(p-x),U=1/(C-T);return c[0]=-2*R,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=-2*F,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=2*U,c[11]=0,c[12]=(s+h)*R,c[13]=(x+p)*F,c[14]=(T+C)*U,c[15]=1,c},u.aR=D2,u.aS=class extends At{},u.aT=yR,u.aU=class extends an{},u.aV=function(c){return c<=1?1:Math.pow(2,Math.ceil(Math.log(c)/Math.LN2))},u.aW=kf,u.aX=Rr,u.aY=ts,u.aZ=class extends tn{},u.a_=function(c,s){return c[0]===s[0]&&c[1]===s[1]&&c[2]===s[2]&&c[3]===s[3]&&c[4]===s[4]&&c[5]===s[5]&&c[6]===s[6]&&c[7]===s[7]&&c[8]===s[8]&&c[9]===s[9]&&c[10]===s[10]&&c[11]===s[11]&&c[12]===s[12]&&c[13]===s[13]&&c[14]===s[14]&&c[15]===s[15]},u.aa=Kx,u.ab=function(c){const s={};if(c.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(h,p,x,C)=>{const T=x||C;return s[p]=!T||T.toLowerCase(),""}),s["max-age"]){const h=parseInt(s["max-age"],10);isNaN(h)?delete s["max-age"]:s["max-age"]=h}return s},u.ac=function(c,s){const h=[];for(const p in c)p in s||h.push(p);return h},u.ad=K,u.ae=function(c,s,h){var p=Math.sin(h),x=Math.cos(h),C=s[0],T=s[1],R=s[2],F=s[3],U=s[4],G=s[5],Y=s[6],ee=s[7];return s!==c&&(c[8]=s[8],c[9]=s[9],c[10]=s[10],c[11]=s[11],c[12]=s[12],c[13]=s[13],c[14]=s[14],c[15]=s[15]),c[0]=C*x+U*p,c[1]=T*x+G*p,c[2]=R*x+Y*p,c[3]=F*x+ee*p,c[4]=U*x-C*p,c[5]=G*x-T*p,c[6]=Y*x-R*p,c[7]=ee*x-F*p,c},u.af=function(c){var s=new Gh(16);return s[0]=c[0],s[1]=c[1],s[2]=c[2],s[3]=c[3],s[4]=c[4],s[5]=c[5],s[6]=c[6],s[7]=c[7],s[8]=c[8],s[9]=c[9],s[10]=c[10],s[11]=c[11],s[12]=c[12],s[13]=c[13],s[14]=c[14],s[15]=c[15],s},u.ag=Fs,u.ah=function(c,s){let h=0,p=0;if(c.kind==="constant")p=c.layoutSize;else if(c.kind!=="source"){const{interpolationType:x,minZoom:C,maxZoom:T}=c,R=x?K(Xs.interpolationFactor(x,s,C,T),0,1):0;c.kind==="camera"?p=ho.number(c.minSize,c.maxSize,R):h=R}return{uSizeT:h,uSize:p}},u.aj=function(c,{uSize:s,uSizeT:h},{lowerSize:p,upperSize:x}){return c.kind==="source"?p/oa:c.kind==="composite"?ho.number(p/oa,x/oa,h):s},u.ak=Hx,u.al=function(c,s,h,p){const x=s.y-c.y,C=s.x-c.x,T=p.y-h.y,R=p.x-h.x,F=T*C-R*x;if(F===0)return null;const U=(R*(c.y-h.y)-T*(c.x-h.x))/F;return new S(c.x+U*C,c.y+U*x)},u.am=IE,u.an=zc,u.ao=S0,u.ap=function(c){let s=1/0,h=1/0,p=-1/0,x=-1/0;for(const C of c)s=Math.min(s,C.x),h=Math.min(h,C.y),p=Math.max(p,C.x),x=Math.max(x,C.y);return[s,h,p,x]},u.aq=Ur,u.as=$x,u.at=function(c,s){var h=s[0],p=s[1],x=s[2],C=s[3],T=s[4],R=s[5],F=s[6],U=s[7],G=s[8],Y=s[9],ee=s[10],ae=s[11],ue=s[12],pe=s[13],Ae=s[14],Oe=s[15],tt=h*R-p*T,Le=h*F-x*T,Qe=h*U-C*T,dt=p*F-x*R,Ut=p*U-C*R,cn=x*U-C*F,nn=G*pe-Y*ue,ln=G*Ae-ee*ue,rn=G*Oe-ae*ue,xn=Y*Ae-ee*pe,mn=Y*Oe-ae*pe,hn=ee*Oe-ae*Ae,St=tt*hn-Le*mn+Qe*xn+dt*rn-Ut*ln+cn*nn;return St?(c[0]=(R*hn-F*mn+U*xn)*(St=1/St),c[1]=(x*mn-p*hn-C*xn)*St,c[2]=(pe*cn-Ae*Ut+Oe*dt)*St,c[3]=(ee*Ut-Y*cn-ae*dt)*St,c[4]=(F*rn-T*hn-U*ln)*St,c[5]=(h*hn-x*rn+C*ln)*St,c[6]=(Ae*Qe-ue*cn-Oe*Le)*St,c[7]=(G*cn-ee*Qe+ae*Le)*St,c[8]=(T*mn-R*rn+U*nn)*St,c[9]=(p*rn-h*mn-C*nn)*St,c[10]=(ue*Ut-pe*Qe+Oe*tt)*St,c[11]=(Y*Qe-G*Ut-ae*tt)*St,c[12]=(R*ln-T*xn-F*nn)*St,c[13]=(h*xn-p*ln+x*nn)*St,c[14]=(pe*Le-ue*dt-Ae*tt)*St,c[15]=(G*dt-Y*Le+ee*tt)*St,c):null},u.au=eo,u.av=Ux,u.aw=e1,u.ax=function(){const c={},s=Ue.$version;for(const h in Ue.$root){const p=Ue.$root[h];if(p.required){let x=null;x=h==="version"?s:p.type==="array"?[]:{},x!=null&&(c[h]=x)}}return c},u.ay=fm,u.az=fn,u.b=Ce,u.b0=function(c,s){return c[0]=s[0],c[1]=s[1],c[2]=s[2],c[3]=s[3],c[4]=s[4],c[5]=s[5],c[6]=s[6],c[7]=s[7],c[8]=s[8],c[9]=s[9],c[10]=s[10],c[11]=s[11],c[12]=s[12],c[13]=s[13],c[14]=s[14],c[15]=s[15],c},u.b1=function(c,s,h){return c[0]=s[0]*h[0],c[1]=s[1]*h[1],c[2]=s[2]*h[2],c[3]=s[3]*h[3],c},u.b2=function(c,s){return c[0]*s[0]+c[1]*s[1]+c[2]*s[2]+c[3]*s[3]},u.b3=q,u.b4=AE,u.b5=CE,u.b6=function(c,s,h,p,x){var C,T=1/Math.tan(s/2);return c[0]=T/h,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=T,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=-1,c[12]=0,c[13]=0,c[15]=0,x!=null&&x!==1/0?(c[10]=(x+p)*(C=1/(p-x)),c[14]=2*x*p*C):(c[10]=-1,c[14]=-2*p),c},u.b7=function(c,s,h){var p=Math.sin(h),x=Math.cos(h),C=s[4],T=s[5],R=s[6],F=s[7],U=s[8],G=s[9],Y=s[10],ee=s[11];return s!==c&&(c[0]=s[0],c[1]=s[1],c[2]=s[2],c[3]=s[3],c[12]=s[12],c[13]=s[13],c[14]=s[14],c[15]=s[15]),c[4]=C*x+U*p,c[5]=T*x+G*p,c[6]=R*x+Y*p,c[7]=F*x+ee*p,c[8]=U*x-C*p,c[9]=G*x-T*p,c[10]=Y*x-R*p,c[11]=ee*x-F*p,c},u.b8=B,u.b9=$,u.bA=function(c){return c.message===wt},u.bB=gi,u.bC=ql,u.ba=function(c){return c*Math.PI/180},u.bb=function(c,s){return c[0]=s[0],c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=s[1],c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=s[2],c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c},u.bc=class extends ce{},u.bd=Xx,u.be=XR,u.bg=Rt,u.bh=function(c,s){Ke.REGISTERED_PROTOCOLS[c]=s},u.bi=function(c){delete Ke.REGISTERED_PROTOCOLS[c]},u.bj=function(c,s){const h={};for(let x=0;x<c.length;x++){const C=s&&s[c[x].id]||nm(c[x]);s&&(s[c[x].id]=C);let T=h[C];T||(T=h[C]=[]),T.push(c[x])}const p=[];for(const x in h)p.push(h[x]);return p},u.bk=dn,u.bl=Yx,u.bm=Jx,u.bn=dE,u.bo=function(c){c.bucket.createArrays(),c.bucket.tilePixelRatio=Oi/(512*c.bucket.overscaling),c.bucket.compareText={},c.bucket.iconsNeedLinear=!1;const s=c.bucket.layers[0],h=s.layout,p=s._unevaluatedLayout._values,x={layoutIconSize:p["icon-size"].possiblyEvaluate(new tr(c.bucket.zoom+1),c.canonical),layoutTextSize:p["text-size"].possiblyEvaluate(new tr(c.bucket.zoom+1),c.canonical),textMaxSize:p["text-size"].possiblyEvaluate(new tr(18))};if(c.bucket.textSizeData.kind==="composite"){const{minZoom:U,maxZoom:G}=c.bucket.textSizeData;x.compositeTextSizes=[p["text-size"].possiblyEvaluate(new tr(U),c.canonical),p["text-size"].possiblyEvaluate(new tr(G),c.canonical)]}if(c.bucket.iconSizeData.kind==="composite"){const{minZoom:U,maxZoom:G}=c.bucket.iconSizeData;x.compositeIconSizes=[p["icon-size"].possiblyEvaluate(new tr(U),c.canonical),p["icon-size"].possiblyEvaluate(new tr(G),c.canonical)]}const C=h.get("text-line-height")*Ur,T=h.get("text-rotation-alignment")!=="viewport"&&h.get("symbol-placement")!=="point",R=h.get("text-keep-upright"),F=h.get("text-size");for(const U of c.bucket.features){const G=h.get("text-font").evaluate(U,{},c.canonical).join(","),Y=F.evaluate(U,{},c.canonical),ee=x.layoutTextSize.evaluate(U,{},c.canonical),ae=x.layoutIconSize.evaluate(U,{},c.canonical),ue={horizontal:{},vertical:void 0},pe=U.text;let Ae,Oe=[0,0];if(pe){const Qe=pe.toString(),dt=h.get("text-letter-spacing").evaluate(U,{},c.canonical)*Ur,Ut=bf(Qe)?dt:0,cn=h.get("text-anchor").evaluate(U,{},c.canonical),nn=zE(s,U,c.canonical);if(!nn){const mn=h.get("text-radial-offset").evaluate(U,{},c.canonical);Oe=mn?oi(cn,[mn*Ur,Vc]):h.get("text-offset").evaluate(U,{},c.canonical).map(hn=>hn*Ur)}let ln=T?"center":h.get("text-justify").evaluate(U,{},c.canonical);const rn=h.get("symbol-placement")==="point"?h.get("text-max-width").evaluate(U,{},c.canonical)*Ur:1/0,xn=()=>{c.bucket.allowVerticalPlacement&&Wl(Qe)&&(ue.vertical=D0(pe,c.glyphMap,c.glyphPositions,c.imagePositions,G,rn,C,cn,"left",Ut,Oe,u.ai.vertical,!0,ee,Y))};if(!T&&nn){const mn=new Set;if(ln==="auto")for(let St=0;St<nn.values.length;St+=2)mn.add(eo(nn.values[St]));else mn.add(ln);let hn=!1;for(const St of mn)if(!ue.horizontal[St])if(hn)ue.horizontal[St]=ue.horizontal[0];else{const Pn=D0(pe,c.glyphMap,c.glyphPositions,c.imagePositions,G,rn,C,"center",St,Ut,Oe,u.ai.horizontal,!1,ee,Y);Pn&&(ue.horizontal[St]=Pn,hn=Pn.positionedLines.length===1)}xn()}else{ln==="auto"&&(ln=eo(cn));const mn=D0(pe,c.glyphMap,c.glyphPositions,c.imagePositions,G,rn,C,cn,ln,Ut,Oe,u.ai.horizontal,!1,ee,Y);mn&&(ue.horizontal[ln]=mn),xn(),Wl(Qe)&&T&&R&&(ue.vertical=D0(pe,c.glyphMap,c.glyphPositions,c.imagePositions,G,rn,C,cn,ln,Ut,Oe,u.ai.vertical,!1,ee,Y))}}let tt=!1;if(U.icon&&U.icon.name){const Qe=c.imageMap[U.icon.name];Qe&&(Ae=DR(c.imagePositions[U.icon.name],h.get("icon-offset").evaluate(U,{},c.canonical),h.get("icon-anchor").evaluate(U,{},c.canonical)),tt=!!Qe.sdf,c.bucket.sdfIcons===void 0?c.bucket.sdfIcons=tt:c.bucket.sdfIcons!==tt&&Se("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Qe.pixelRatio!==c.bucket.pixelRatio||h.get("icon-rotate").constantOr(1)!==0)&&(c.bucket.iconsNeedLinear=!0))}const Le=$c(ue.horizontal)||ue.vertical;c.bucket.iconsInText=!!Le&&Le.iconsInText,(Le||Ae)&&Zr(c.bucket,U,ue,Ae,c.imageMap,x,ee,ae,Oe,tt,c.canonical)}c.showCollisionBoxes&&c.bucket.generateCollisionDebugBuffers()},u.bp=Lx,u.bq=Cm,u.br=Ax,u.bs=zu,u.bt=Ox,u.bu=class{constructor(c){this._marks={start:[c.url,"start"].join("#"),end:[c.url,"end"].join("#"),measure:c.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let c=performance.getEntriesByName(this._marks.measure);return c.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),c=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),c}},u.bv=function(c,s,h,p,x){return l(this,void 0,void 0,function*(){if(N())try{return yield Be(c,s,h,p,x)}catch{}return function(C,T,R,F,U){const G=C.width,Y=C.height;Ze&&je||(Ze=new OffscreenCanvas(G,Y),je=Ze.getContext("2d",{willReadFrequently:!0})),Ze.width=G,Ze.height=Y,je.drawImage(C,0,0,G,Y);const ee=je.getImageData(T,R,F,U);return je.clearRect(0,0,G,Y),ee.data}(c,s,h,p,x)})},u.bw=V0,u.bx=f,u.by=g,u.bz=iE,u.c=Xt,u.d=c=>l(void 0,void 0,void 0,function*(){if(c.byteLength===0)return createImageBitmap(new ImageData(1,1));const s=new Blob([new Uint8Array(c)],{type:"image/png"});try{return createImageBitmap(s)}catch(h){throw new Error(`Could not load image because of ${h.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),u.e=W,u.f=c=>new Promise((s,h)=>{const p=new Image;p.onload=()=>{s(p),URL.revokeObjectURL(p.src),p.onload=null,window.requestAnimationFrame(()=>{p.src=ge})},p.onerror=()=>h(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const x=new Blob([new Uint8Array(c)],{type:"image/png"});p.src=c.byteLength?URL.createObjectURL(x):ge}),u.g=_t,u.h=(c,s)=>Mn(W(c,{type:"json"}),s),u.i=Ye,u.j=Ln,u.k=Jn,u.l=(c,s)=>Mn(W(c,{type:"arrayBuffer"}),s),u.m=Mn,u.n=function(c){return new Ox(c).readFields(CR,[])},u.o=Lf,u.p=hE,u.q=v,u.r=hm,u.s=Bt,u.t=Mu,u.u=oe,u.v=Ue,u.w=Se,u.x=go,u.y=function([c,s,h]){return s+=90,s*=Math.PI/180,h*=Math.PI/180,{x:c*Math.cos(s)*Math.sin(h),y:c*Math.sin(s)*Math.sin(h),z:c*Math.cos(h)}},u.z=ho}),r("worker",["./shared"],function(u){class l{constructor(te){this.keyCache={},te&&this.replace(te)}replace(te){this._layerConfigs={},this._layers={},this.update(te,[])}update(te,ne){for(const we of te){this._layerConfigs[we.id]=we;const Fe=this._layers[we.id]=u.aB(we);Fe._featureFilter=u.a7(Fe.filter),this.keyCache[we.id]&&delete this.keyCache[we.id]}for(const we of ne)delete this.keyCache[we],delete this._layerConfigs[we],delete this._layers[we];this.familiesBySource={};const de=u.bj(Object.values(this._layerConfigs),this.keyCache);for(const we of de){const Fe=we.map(ct=>this._layers[ct.id]),He=Fe[0];if(He.visibility==="none")continue;const nt=He.source||"";let Ie=this.familiesBySource[nt];Ie||(Ie=this.familiesBySource[nt]={});const ut=He.sourceLayer||"_geojsonTileLayer";let bt=Ie[ut];bt||(bt=Ie[ut]=[]),bt.push(Fe)}}}class f{constructor(te){const ne={},de=[];for(const nt in te){const Ie=te[nt],ut=ne[nt]={};for(const bt in Ie){const ct=Ie[+bt];if(!ct||ct.bitmap.width===0||ct.bitmap.height===0)continue;const Wt={x:0,y:0,w:ct.bitmap.width+2,h:ct.bitmap.height+2};de.push(Wt),ut[bt]={rect:Wt,metrics:ct.metrics}}}const{w:we,h:Fe}=u.p(de),He=new u.o({width:we||1,height:Fe||1});for(const nt in te){const Ie=te[nt];for(const ut in Ie){const bt=Ie[+ut];if(!bt||bt.bitmap.width===0||bt.bitmap.height===0)continue;const ct=ne[nt][ut].rect;u.o.copy(bt.bitmap,He,{x:0,y:0},{x:ct.x+1,y:ct.y+1},bt.bitmap)}}this.image=He,this.positions=ne}}u.bk("GlyphAtlas",f);class g{constructor(te){this.tileID=new u.S(te.tileID.overscaledZ,te.tileID.wrap,te.tileID.canonical.z,te.tileID.canonical.x,te.tileID.canonical.y),this.uid=te.uid,this.zoom=te.zoom,this.pixelRatio=te.pixelRatio,this.tileSize=te.tileSize,this.source=te.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=te.showCollisionBoxes,this.collectResourceTiming=!!te.collectResourceTiming,this.returnDependencies=!!te.returnDependencies,this.promoteId=te.promoteId,this.inFlightDependencies=[]}parse(te,ne,de,we){return u._(this,void 0,void 0,function*(){this.status="parsing",this.data=te,this.collisionBoxArray=new u.a5;const Fe=new u.bl(Object.keys(te.layers).sort()),He=new u.bm(this.tileID,this.promoteId);He.bucketLayerIDs=[];const nt={},Ie={featureIndex:He,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:de},ut=ne.familiesBySource[this.source];for(const $e in ut){const ot=te.layers[$e];if(!ot)continue;ot.version===1&&u.w(`Vector tile source "${this.source}" layer "${$e}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const lt=Fe.encode($e),Je=[];for(let jt=0;jt<ot.length;jt++){const en=ot.feature(jt),En=He.getId(en,$e);Je.push({feature:en,id:En,index:jt,sourceLayerIndex:lt})}for(const jt of ut[$e]){const en=jt[0];en.source!==this.source&&u.w(`layer.source = ${en.source} does not equal this.source = ${this.source}`),en.minzoom&&this.zoom<Math.floor(en.minzoom)||en.maxzoom&&this.zoom>=en.maxzoom||en.visibility!=="none"&&(y(jt,this.zoom,de),(nt[en.id]=en.createBucket({index:He.bucketLayerIDs.length,layers:jt,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:lt,sourceID:this.source})).populate(Je,Ie,this.tileID.canonical),He.bucketLayerIDs.push(jt.map(En=>En.id)))}}const bt=u.aG(Ie.glyphDependencies,$e=>Object.keys($e).map(Number));this.inFlightDependencies.forEach($e=>$e==null?void 0:$e.abort()),this.inFlightDependencies=[];let ct=Promise.resolve({});if(Object.keys(bt).length){const $e=new AbortController;this.inFlightDependencies.push($e),ct=we.sendAsync({type:"GG",data:{stacks:bt,source:this.source,tileID:this.tileID,type:"glyphs"}},$e)}const Wt=Object.keys(Ie.iconDependencies);let bn=Promise.resolve({});if(Wt.length){const $e=new AbortController;this.inFlightDependencies.push($e),bn=we.sendAsync({type:"GI",data:{icons:Wt,source:this.source,tileID:this.tileID,type:"icons"}},$e)}const Sn=Object.keys(Ie.patternDependencies);let Bn=Promise.resolve({});if(Sn.length){const $e=new AbortController;this.inFlightDependencies.push($e),Bn=we.sendAsync({type:"GI",data:{icons:Sn,source:this.source,tileID:this.tileID,type:"patterns"}},$e)}const[ui,Vn,Di]=yield Promise.all([ct,bn,Bn]),qi=new f(ui),me=new u.bn(Vn,Di);for(const $e in nt){const ot=nt[$e];ot instanceof u.a6?(y(ot.layers,this.zoom,de),u.bo({bucket:ot,glyphMap:ui,glyphPositions:qi.positions,imageMap:Vn,imagePositions:me.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):ot.hasPattern&&(ot instanceof u.bp||ot instanceof u.bq||ot instanceof u.br)&&(y(ot.layers,this.zoom,de),ot.addFeatures(Ie,this.tileID.canonical,me.patternPositions))}return this.status="done",{buckets:Object.values(nt).filter($e=>!$e.isEmpty()),featureIndex:He,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:qi.image,imageAtlas:me,glyphMap:this.returnDependencies?ui:null,iconMap:this.returnDependencies?Vn:null,glyphPositions:this.returnDependencies?qi.positions:null}})}}function y(xe,te,ne){const de=new u.a9(te);for(const we of xe)we.recalculate(de,ne)}class S{constructor(te,ne,de){this.actor=te,this.layerIndex=ne,this.availableImages=de,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(te,ne){return u._(this,void 0,void 0,function*(){const de=yield u.l(te.request,ne);try{return{vectorTile:new u.bs.VectorTile(new u.bt(de.data)),rawData:de.data,cacheControl:de.cacheControl,expires:de.expires}}catch(we){const Fe=new Uint8Array(de.data);let He=`Unable to parse the tile at ${te.request.url}, `;throw He+=Fe[0]===31&&Fe[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${we.message}`,new Error(He)}})}loadTile(te){return u._(this,void 0,void 0,function*(){const ne=te.uid,de=!!(te&&te.request&&te.request.collectResourceTiming)&&new u.bu(te.request),we=new g(te);this.loading[ne]=we;const Fe=new AbortController;we.abort=Fe;try{const He=yield this.loadVectorTile(te,Fe);if(delete this.loading[ne],!He)return null;const nt=He.rawData,Ie={};He.expires&&(Ie.expires=He.expires),He.cacheControl&&(Ie.cacheControl=He.cacheControl);const ut={};if(de){const ct=de.finish();ct&&(ut.resourceTiming=JSON.parse(JSON.stringify(ct)))}we.vectorTile=He.vectorTile;const bt=we.parse(He.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[ne]=we,this.fetching[ne]={rawTileData:nt,cacheControl:Ie,resourceTiming:ut};try{const ct=yield bt;return u.e({rawTileData:nt.slice(0)},ct,Ie,ut)}finally{delete this.fetching[ne]}}catch(He){throw delete this.loading[ne],we.status="done",this.loaded[ne]=we,He}})}reloadTile(te){return u._(this,void 0,void 0,function*(){const ne=te.uid;if(!this.loaded||!this.loaded[ne])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const de=this.loaded[ne];if(de.showCollisionBoxes=te.showCollisionBoxes,de.status==="parsing"){const we=yield de.parse(de.vectorTile,this.layerIndex,this.availableImages,this.actor);let Fe;if(this.fetching[ne]){const{rawTileData:He,cacheControl:nt,resourceTiming:Ie}=this.fetching[ne];delete this.fetching[ne],Fe=u.e({rawTileData:He.slice(0)},we,nt,Ie)}else Fe=we;return Fe}if(de.status==="done"&&de.vectorTile)return de.parse(de.vectorTile,this.layerIndex,this.availableImages,this.actor)})}abortTile(te){return u._(this,void 0,void 0,function*(){const ne=this.loading,de=te.uid;ne&&ne[de]&&ne[de].abort&&(ne[de].abort.abort(),delete ne[de])})}removeTile(te){return u._(this,void 0,void 0,function*(){this.loaded&&this.loaded[te.uid]&&delete this.loaded[te.uid]})}}class b{constructor(){this.loaded={}}loadTile(te){return u._(this,void 0,void 0,function*(){const{uid:ne,encoding:de,rawImageData:we,redFactor:Fe,greenFactor:He,blueFactor:nt,baseShift:Ie}=te,ut=we.width+2,bt=we.height+2,ct=u.b(we)?new u.R({width:ut,height:bt},yield u.bv(we,-1,-1,ut,bt)):we,Wt=new u.bw(ne,ct,de,Fe,He,nt,Ie);return this.loaded=this.loaded||{},this.loaded[ne]=Wt,Wt})}removeTile(te){const ne=this.loaded,de=te.uid;ne&&ne[de]&&delete ne[de]}}function A(xe,te){if(xe.length!==0){I(xe[0],te);for(var ne=1;ne<xe.length;ne++)I(xe[ne],!te)}}function I(xe,te){for(var ne=0,de=0,we=0,Fe=xe.length,He=Fe-1;we<Fe;He=we++){var nt=(xe[we][0]-xe[He][0])*(xe[He][1]+xe[we][1]),Ie=ne+nt;de+=Math.abs(ne)>=Math.abs(nt)?ne-Ie+nt:nt-Ie+ne,ne=Ie}ne+de>=0!=!!te&&xe.reverse()}var D=u.bx(function xe(te,ne){var de,we=te&&te.type;if(we==="FeatureCollection")for(de=0;de<te.features.length;de++)xe(te.features[de],ne);else if(we==="GeometryCollection")for(de=0;de<te.geometries.length;de++)xe(te.geometries[de],ne);else if(we==="Feature")xe(te.geometry,ne);else if(we==="Polygon")A(te.coordinates,ne);else if(we==="MultiPolygon")for(de=0;de<te.coordinates.length;de++)A(te.coordinates[de],ne);return te});const L=u.bs.VectorTileFeature.prototype.toGeoJSON;var P={exports:{}},N=u.by,B=u.bs.VectorTileFeature,$=K;function K(xe,te){this.options=te||{},this.features=xe,this.length=xe.length}function q(xe,te){this.id=typeof xe.id=="number"?xe.id:void 0,this.type=xe.type,this.rawGeometry=xe.type===1?[xe.geometry]:xe.geometry,this.properties=xe.tags,this.extent=te||4096}K.prototype.feature=function(xe){return new q(this.features[xe],this.options.extent)},q.prototype.loadGeometry=function(){var xe=this.rawGeometry;this.geometry=[];for(var te=0;te<xe.length;te++){for(var ne=xe[te],de=[],we=0;we<ne.length;we++)de.push(new N(ne[we][0],ne[we][1]));this.geometry.push(de)}return this.geometry},q.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var xe=this.geometry,te=1/0,ne=-1/0,de=1/0,we=-1/0,Fe=0;Fe<xe.length;Fe++)for(var He=xe[Fe],nt=0;nt<He.length;nt++){var Ie=He[nt];te=Math.min(te,Ie.x),ne=Math.max(ne,Ie.x),de=Math.min(de,Ie.y),we=Math.max(we,Ie.y)}return[te,de,ne,we]},q.prototype.toGeoJSON=B.prototype.toGeoJSON;var W=u.bz,ie=$;function Z(xe){var te=new W;return function(ne,de){for(var we in ne.layers)de.writeMessage(3,X,ne.layers[we])}(xe,te),te.finish()}function X(xe,te){var ne;te.writeVarintField(15,xe.version||1),te.writeStringField(1,xe.name||""),te.writeVarintField(5,xe.extent||4096);var de={keys:[],values:[],keycache:{},valuecache:{}};for(ne=0;ne<xe.length;ne++)de.feature=xe.feature(ne),te.writeMessage(2,se,de);var we=de.keys;for(ne=0;ne<we.length;ne++)te.writeStringField(3,we[ne]);var Fe=de.values;for(ne=0;ne<Fe.length;ne++)te.writeMessage(4,ye,Fe[ne])}function se(xe,te){var ne=xe.feature;ne.id!==void 0&&te.writeVarintField(1,ne.id),te.writeMessage(2,De,xe),te.writeVarintField(3,ne.type),te.writeMessage(4,Ye,ne)}function De(xe,te){var ne=xe.feature,de=xe.keys,we=xe.values,Fe=xe.keycache,He=xe.valuecache;for(var nt in ne.properties){var Ie=ne.properties[nt],ut=Fe[nt];if(Ie!==null){ut===void 0&&(de.push(nt),Fe[nt]=ut=de.length-1),te.writeVarint(ut);var bt=typeof Ie;bt!=="string"&&bt!=="boolean"&&bt!=="number"&&(Ie=JSON.stringify(Ie));var ct=bt+":"+Ie,Wt=He[ct];Wt===void 0&&(we.push(Ie),He[ct]=Wt=we.length-1),te.writeVarint(Wt)}}}function Se(xe,te){return(te<<3)+(7&xe)}function Me(xe){return xe<<1^xe>>31}function Ye(xe,te){for(var ne=xe.loadGeometry(),de=xe.type,we=0,Fe=0,He=ne.length,nt=0;nt<He;nt++){var Ie=ne[nt],ut=1;de===1&&(ut=Ie.length),te.writeVarint(Se(1,ut));for(var bt=de===3?Ie.length-1:Ie.length,ct=0;ct<bt;ct++){ct===1&&de!==1&&te.writeVarint(Se(2,bt-1));var Wt=Ie[ct].x-we,bn=Ie[ct].y-Fe;te.writeVarint(Me(Wt)),te.writeVarint(Me(bn)),we+=Wt,Fe+=bn}de===3&&te.writeVarint(Se(7,1))}}function ye(xe,te){var ne=typeof xe;ne==="string"?te.writeStringField(1,xe):ne==="boolean"?te.writeBooleanField(7,xe):ne==="number"&&(xe%1!=0?te.writeDoubleField(3,xe):xe<0?te.writeSVarintField(6,xe):te.writeVarintField(5,xe))}P.exports=Z,P.exports.fromVectorTileJs=Z,P.exports.fromGeojsonVt=function(xe,te){te=te||{};var ne={};for(var de in xe)ne[de]=new ie(xe[de].features,te),ne[de].name=de,ne[de].version=te.version,ne[de].extent=te.extent;return Z({layers:ne})},P.exports.GeoJSONWrapper=ie;var Ce=u.bx(P.exports);const ge={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:xe=>xe},Be=Math.fround||(Ze=new Float32Array(1),xe=>(Ze[0]=+xe,Ze[0]));var Ze;const je=3,wt=5,Xt=6;class Ke{constructor(te){this.options=Object.assign(Object.create(ge),te),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(te){const{log:ne,minZoom:de,maxZoom:we}=this.options;ne&&console.time("total time");const Fe=`prepare ${te.length} points`;ne&&console.time(Fe),this.points=te;const He=[];for(let Ie=0;Ie<te.length;Ie++){const ut=te[Ie];if(!ut.geometry)continue;const[bt,ct]=ut.geometry.coordinates,Wt=Be(Rt(bt)),bn=Be(fn(ct));He.push(Wt,bn,1/0,Ie,-1,1),this.options.reduce&&He.push(0)}let nt=this.trees[we+1]=this._createTree(He);ne&&console.timeEnd(Fe);for(let Ie=we;Ie>=de;Ie--){const ut=+Date.now();nt=this.trees[Ie]=this._createTree(this._cluster(nt,Ie)),ne&&console.log("z%d: %d clusters in %dms",Ie,nt.numItems,+Date.now()-ut)}return ne&&console.timeEnd("total time"),this}getClusters(te,ne){let de=((te[0]+180)%360+360)%360-180;const we=Math.max(-90,Math.min(90,te[1]));let Fe=te[2]===180?180:((te[2]+180)%360+360)%360-180;const He=Math.max(-90,Math.min(90,te[3]));if(te[2]-te[0]>=360)de=-180,Fe=180;else if(de>Fe){const ct=this.getClusters([de,we,180,He],ne),Wt=this.getClusters([-180,we,Fe,He],ne);return ct.concat(Wt)}const nt=this.trees[this._limitZoom(ne)],Ie=nt.range(Rt(de),fn(He),Rt(Fe),fn(we)),ut=nt.data,bt=[];for(const ct of Ie){const Wt=this.stride*ct;bt.push(ut[Wt+wt]>1?_t(ut,Wt,this.clusterProps):this.points[ut[Wt+je]])}return bt}getChildren(te){const ne=this._getOriginId(te),de=this._getOriginZoom(te),we="No cluster with the specified id.",Fe=this.trees[de];if(!Fe)throw new Error(we);const He=Fe.data;if(ne*this.stride>=He.length)throw new Error(we);const nt=this.options.radius/(this.options.extent*Math.pow(2,de-1)),Ie=Fe.within(He[ne*this.stride],He[ne*this.stride+1],nt),ut=[];for(const bt of Ie){const ct=bt*this.stride;He[ct+4]===te&&ut.push(He[ct+wt]>1?_t(He,ct,this.clusterProps):this.points[He[ct+je]])}if(ut.length===0)throw new Error(we);return ut}getLeaves(te,ne,de){const we=[];return this._appendLeaves(we,te,ne=ne||10,de=de||0,0),we}getTile(te,ne,de){const we=this.trees[this._limitZoom(te)],Fe=Math.pow(2,te),{extent:He,radius:nt}=this.options,Ie=nt/He,ut=(de-Ie)/Fe,bt=(de+1+Ie)/Fe,ct={features:[]};return this._addTileFeatures(we.range((ne-Ie)/Fe,ut,(ne+1+Ie)/Fe,bt),we.data,ne,de,Fe,ct),ne===0&&this._addTileFeatures(we.range(1-Ie/Fe,ut,1,bt),we.data,Fe,de,Fe,ct),ne===Fe-1&&this._addTileFeatures(we.range(0,ut,Ie/Fe,bt),we.data,-1,de,Fe,ct),ct.features.length?ct:null}getClusterExpansionZoom(te){let ne=this._getOriginZoom(te)-1;for(;ne<=this.options.maxZoom;){const de=this.getChildren(te);if(ne++,de.length!==1)break;te=de[0].properties.cluster_id}return ne}_appendLeaves(te,ne,de,we,Fe){const He=this.getChildren(ne);for(const nt of He){const Ie=nt.properties;if(Ie&&Ie.cluster?Fe+Ie.point_count<=we?Fe+=Ie.point_count:Fe=this._appendLeaves(te,Ie.cluster_id,de,we,Fe):Fe<we?Fe++:te.push(nt),te.length===de)break}return Fe}_createTree(te){const ne=new u.aw(te.length/this.stride|0,this.options.nodeSize,Float32Array);for(let de=0;de<te.length;de+=this.stride)ne.add(te[de],te[de+1]);return ne.finish(),ne.data=te,ne}_addTileFeatures(te,ne,de,we,Fe,He){for(const nt of te){const Ie=nt*this.stride,ut=ne[Ie+wt]>1;let bt,ct,Wt;if(ut)bt=zt(ne,Ie,this.clusterProps),ct=ne[Ie],Wt=ne[Ie+1];else{const Bn=this.points[ne[Ie+je]];bt=Bn.properties;const[ui,Vn]=Bn.geometry.coordinates;ct=Rt(ui),Wt=fn(Vn)}const bn={type:1,geometry:[[Math.round(this.options.extent*(ct*Fe-de)),Math.round(this.options.extent*(Wt*Fe-we))]],tags:bt};let Sn;Sn=ut||this.options.generateId?ne[Ie+je]:this.points[ne[Ie+je]].id,Sn!==void 0&&(bn.id=Sn),He.features.push(bn)}}_limitZoom(te){return Math.max(this.options.minZoom,Math.min(Math.floor(+te),this.options.maxZoom+1))}_cluster(te,ne){const{radius:de,extent:we,reduce:Fe,minPoints:He}=this.options,nt=de/(we*Math.pow(2,ne)),Ie=te.data,ut=[],bt=this.stride;for(let ct=0;ct<Ie.length;ct+=bt){if(Ie[ct+2]<=ne)continue;Ie[ct+2]=ne;const Wt=Ie[ct],bn=Ie[ct+1],Sn=te.within(Ie[ct],Ie[ct+1],nt),Bn=Ie[ct+wt];let ui=Bn;for(const Vn of Sn){const Di=Vn*bt;Ie[Di+2]>ne&&(ui+=Ie[Di+wt])}if(ui>Bn&&ui>=He){let Vn,Di=Wt*Bn,qi=bn*Bn,me=-1;const $e=((ct/bt|0)<<5)+(ne+1)+this.points.length;for(const ot of Sn){const lt=ot*bt;if(Ie[lt+2]<=ne)continue;Ie[lt+2]=ne;const Je=Ie[lt+wt];Di+=Ie[lt]*Je,qi+=Ie[lt+1]*Je,Ie[lt+4]=$e,Fe&&(Vn||(Vn=this._map(Ie,ct,!0),me=this.clusterProps.length,this.clusterProps.push(Vn)),Fe(Vn,this._map(Ie,lt)))}Ie[ct+4]=$e,ut.push(Di/ui,qi/ui,1/0,$e,-1,ui),Fe&&ut.push(me)}else{for(let Vn=0;Vn<bt;Vn++)ut.push(Ie[ct+Vn]);if(ui>1)for(const Vn of Sn){const Di=Vn*bt;if(!(Ie[Di+2]<=ne)){Ie[Di+2]=ne;for(let qi=0;qi<bt;qi++)ut.push(Ie[Di+qi])}}}}return ut}_getOriginId(te){return te-this.points.length>>5}_getOriginZoom(te){return(te-this.points.length)%32}_map(te,ne,de){if(te[ne+wt]>1){const He=this.clusterProps[te[ne+Xt]];return de?Object.assign({},He):He}const we=this.points[te[ne+je]].properties,Fe=this.options.map(we);return de&&Fe===we?Object.assign({},Fe):Fe}}function _t(xe,te,ne){return{type:"Feature",id:xe[te+je],properties:zt(xe,te,ne),geometry:{type:"Point",coordinates:[(de=xe[te],360*(de-.5)),Mn(xe[te+1])]}};var de}function zt(xe,te,ne){const de=xe[te+wt],we=de>=1e4?`${Math.round(de/1e3)}k`:de>=1e3?Math.round(de/100)/10+"k":de,Fe=xe[te+Xt],He=Fe===-1?{}:Object.assign({},ne[Fe]);return Object.assign(He,{cluster:!0,cluster_id:xe[te+je],point_count:de,point_count_abbreviated:we})}function Rt(xe){return xe/360+.5}function fn(xe){const te=Math.sin(xe*Math.PI/180),ne=.5-.25*Math.log((1+te)/(1-te))/Math.PI;return ne<0?0:ne>1?1:ne}function Mn(xe){const te=(180-360*xe)*Math.PI/180;return 360*Math.atan(Math.exp(te))/Math.PI-90}function Bt(xe,te,ne,de){let we=de;const Fe=te+(ne-te>>1);let He,nt=ne-te;const Ie=xe[te],ut=xe[te+1],bt=xe[ne],ct=xe[ne+1];for(let Wt=te+3;Wt<ne;Wt+=3){const bn=Kn(xe[Wt],xe[Wt+1],Ie,ut,bt,ct);if(bn>we)He=Wt,we=bn;else if(bn===we){const Sn=Math.abs(Wt-Fe);Sn<nt&&(He=Wt,nt=Sn)}}we>de&&(He-te>3&&Bt(xe,te,He,de),xe[He+2]=we,ne-He>3&&Bt(xe,He,ne,de))}function Kn(xe,te,ne,de,we,Fe){let He=we-ne,nt=Fe-de;if(He!==0||nt!==0){const Ie=((xe-ne)*He+(te-de)*nt)/(He*He+nt*nt);Ie>1?(ne=we,de=Fe):Ie>0&&(ne+=He*Ie,de+=nt*Ie)}return He=xe-ne,nt=te-de,He*He+nt*nt}function Re(xe,te,ne,de){const we={id:xe??null,type:te,geometry:ne,tags:de,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(te==="Point"||te==="MultiPoint"||te==="LineString")Jn(we,ne);else if(te==="Polygon")Jn(we,ne[0]);else if(te==="MultiLineString")for(const Fe of ne)Jn(we,Fe);else if(te==="MultiPolygon")for(const Fe of ne)Jn(we,Fe[0]);return we}function Jn(xe,te){for(let ne=0;ne<te.length;ne+=3)xe.minX=Math.min(xe.minX,te[ne]),xe.minY=Math.min(xe.minY,te[ne+1]),xe.maxX=Math.max(xe.maxX,te[ne]),xe.maxY=Math.max(xe.maxY,te[ne+1])}function Ln(xe,te,ne,de){if(!te.geometry)return;const we=te.geometry.coordinates;if(we&&we.length===0)return;const Fe=te.geometry.type,He=Math.pow(ne.tolerance/((1<<ne.maxZoom)*ne.extent),2);let nt=[],Ie=te.id;if(ne.promoteId?Ie=te.properties[ne.promoteId]:ne.generateId&&(Ie=de||0),Fe==="Point")Cn(we,nt);else if(Fe==="MultiPoint")for(const ut of we)Cn(ut,nt);else if(Fe==="LineString")Ue(we,nt,He,!1);else if(Fe==="MultiLineString"){if(ne.lineMetrics){for(const ut of we)nt=[],Ue(ut,nt,He,!1),xe.push(Re(Ie,"LineString",nt,te.properties));return}xt(we,nt,He,!1)}else if(Fe==="Polygon")xt(we,nt,He,!0);else{if(Fe!=="MultiPolygon"){if(Fe==="GeometryCollection"){for(const ut of te.geometry.geometries)Ln(xe,{id:Ie,geometry:ut,properties:te.properties},ne,de);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const ut of we){const bt=[];xt(ut,bt,He,!0),nt.push(bt)}}xe.push(Re(Ie,Fe,nt,te.properties))}function Cn(xe,te){te.push(Pt(xe[0]),mt(xe[1]),0)}function Ue(xe,te,ne,de){let we,Fe,He=0;for(let Ie=0;Ie<xe.length;Ie++){const ut=Pt(xe[Ie][0]),bt=mt(xe[Ie][1]);te.push(ut,bt,0),Ie>0&&(He+=de?(we*bt-ut*Fe)/2:Math.sqrt(Math.pow(ut-we,2)+Math.pow(bt-Fe,2))),we=ut,Fe=bt}const nt=te.length-3;te[2]=1,Bt(te,0,nt,ne),te[nt+2]=1,te.size=Math.abs(He),te.start=0,te.end=te.size}function xt(xe,te,ne,de){for(let we=0;we<xe.length;we++){const Fe=[];Ue(xe[we],Fe,ne,de),te.push(Fe)}}function Pt(xe){return xe/360+.5}function mt(xe){const te=Math.sin(xe*Math.PI/180),ne=.5-.25*Math.log((1+te)/(1-te))/Math.PI;return ne<0?0:ne>1?1:ne}function ve(xe,te,ne,de,we,Fe,He,nt){if(de/=te,Fe>=(ne/=te)&&He<de)return xe;if(He<ne||Fe>=de)return null;const Ie=[];for(const ut of xe){const bt=ut.geometry;let ct=ut.type;const Wt=we===0?ut.minX:ut.minY,bn=we===0?ut.maxX:ut.maxY;if(Wt>=ne&&bn<de){Ie.push(ut);continue}if(bn<ne||Wt>=de)continue;let Sn=[];if(ct==="Point"||ct==="MultiPoint")re(bt,Sn,ne,de,we);else if(ct==="LineString")Xe(bt,Sn,ne,de,we,!1,nt.lineMetrics);else if(ct==="MultiLineString")st(bt,Sn,ne,de,we,!1);else if(ct==="Polygon")st(bt,Sn,ne,de,we,!0);else if(ct==="MultiPolygon")for(const Bn of bt){const ui=[];st(Bn,ui,ne,de,we,!0),ui.length&&Sn.push(ui)}if(Sn.length){if(nt.lineMetrics&&ct==="LineString"){for(const Bn of Sn)Ie.push(Re(ut.id,ct,Bn,ut.tags));continue}ct!=="LineString"&&ct!=="MultiLineString"||(Sn.length===1?(ct="LineString",Sn=Sn[0]):ct="MultiLineString"),ct!=="Point"&&ct!=="MultiPoint"||(ct=Sn.length===3?"Point":"MultiPoint"),Ie.push(Re(ut.id,ct,Sn,ut.tags))}}return Ie.length?Ie:null}function re(xe,te,ne,de,we){for(let Fe=0;Fe<xe.length;Fe+=3){const He=xe[Fe+we];He>=ne&&He<=de&&ft(te,xe[Fe],xe[Fe+1],xe[Fe+2])}}function Xe(xe,te,ne,de,we,Fe,He){let nt=Ge(xe);const Ie=we===0?Ht:$t;let ut,bt,ct=xe.start;for(let ui=0;ui<xe.length-3;ui+=3){const Vn=xe[ui],Di=xe[ui+1],qi=xe[ui+2],me=xe[ui+3],$e=xe[ui+4],ot=we===0?Vn:Di,lt=we===0?me:$e;let Je=!1;He&&(ut=Math.sqrt(Math.pow(Vn-me,2)+Math.pow(Di-$e,2))),ot<ne?lt>ne&&(bt=Ie(nt,Vn,Di,me,$e,ne),He&&(nt.start=ct+ut*bt)):ot>de?lt<de&&(bt=Ie(nt,Vn,Di,me,$e,de),He&&(nt.start=ct+ut*bt)):ft(nt,Vn,Di,qi),lt<ne&&ot>=ne&&(bt=Ie(nt,Vn,Di,me,$e,ne),Je=!0),lt>de&&ot<=de&&(bt=Ie(nt,Vn,Di,me,$e,de),Je=!0),!Fe&&Je&&(He&&(nt.end=ct+ut*bt),te.push(nt),nt=Ge(xe)),He&&(ct+=ut)}let Wt=xe.length-3;const bn=xe[Wt],Sn=xe[Wt+1],Bn=we===0?bn:Sn;Bn>=ne&&Bn<=de&&ft(nt,bn,Sn,xe[Wt+2]),Wt=nt.length-3,Fe&&Wt>=3&&(nt[Wt]!==nt[0]||nt[Wt+1]!==nt[1])&&ft(nt,nt[0],nt[1],nt[2]),nt.length&&te.push(nt)}function Ge(xe){const te=[];return te.size=xe.size,te.start=xe.start,te.end=xe.end,te}function st(xe,te,ne,de,we,Fe){for(const He of xe)Xe(He,te,ne,de,we,Fe,!1)}function ft(xe,te,ne,de){xe.push(te,ne,de)}function Ht(xe,te,ne,de,we,Fe){const He=(Fe-te)/(de-te);return ft(xe,Fe,ne+(we-ne)*He,1),He}function $t(xe,te,ne,de,we,Fe){const He=(Fe-ne)/(we-ne);return ft(xe,te+(de-te)*He,Fe,1),He}function it(xe,te){const ne=[];for(let de=0;de<xe.length;de++){const we=xe[de],Fe=we.type;let He;if(Fe==="Point"||Fe==="MultiPoint"||Fe==="LineString")He=On(we.geometry,te);else if(Fe==="MultiLineString"||Fe==="Polygon"){He=[];for(const nt of we.geometry)He.push(On(nt,te))}else if(Fe==="MultiPolygon"){He=[];for(const nt of we.geometry){const Ie=[];for(const ut of nt)Ie.push(On(ut,te));He.push(Ie)}}ne.push(Re(we.id,Fe,He,we.tags))}return ne}function On(xe,te){const ne=[];ne.size=xe.size,xe.start!==void 0&&(ne.start=xe.start,ne.end=xe.end);for(let de=0;de<xe.length;de+=3)ne.push(xe[de]+te,xe[de+1],xe[de+2]);return ne}function Nt(xe,te){if(xe.transformed)return xe;const ne=1<<xe.z,de=xe.x,we=xe.y;for(const Fe of xe.features){const He=Fe.geometry,nt=Fe.type;if(Fe.geometry=[],nt===1)for(let Ie=0;Ie<He.length;Ie+=2)Fe.geometry.push(on(He[Ie],He[Ie+1],te,ne,de,we));else for(let Ie=0;Ie<He.length;Ie++){const ut=[];for(let bt=0;bt<He[Ie].length;bt+=2)ut.push(on(He[Ie][bt],He[Ie][bt+1],te,ne,de,we));Fe.geometry.push(ut)}}return xe.transformed=!0,xe}function on(xe,te,ne,de,we,Fe){return[Math.round(ne*(xe*de-we)),Math.round(ne*(te*de-Fe))]}function Wn(xe,te,ne,de,we){const Fe=te===we.maxZoom?0:we.tolerance/((1<<te)*we.extent),He={features:[],numPoints:0,numSimplified:0,numFeatures:xe.length,source:null,x:ne,y:de,z:te,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const nt of xe)yt(He,nt,Fe,we);return He}function yt(xe,te,ne,de){const we=te.geometry,Fe=te.type,He=[];if(xe.minX=Math.min(xe.minX,te.minX),xe.minY=Math.min(xe.minY,te.minY),xe.maxX=Math.max(xe.maxX,te.maxX),xe.maxY=Math.max(xe.maxY,te.maxY),Fe==="Point"||Fe==="MultiPoint")for(let nt=0;nt<we.length;nt+=3)He.push(we[nt],we[nt+1]),xe.numPoints++,xe.numSimplified++;else if(Fe==="LineString")Tt(He,we,xe,ne,!1,!1);else if(Fe==="MultiLineString"||Fe==="Polygon")for(let nt=0;nt<we.length;nt++)Tt(He,we[nt],xe,ne,Fe==="Polygon",nt===0);else if(Fe==="MultiPolygon")for(let nt=0;nt<we.length;nt++){const Ie=we[nt];for(let ut=0;ut<Ie.length;ut++)Tt(He,Ie[ut],xe,ne,!0,ut===0)}if(He.length){let nt=te.tags||null;if(Fe==="LineString"&&de.lineMetrics){nt={};for(const ut in te.tags)nt[ut]=te.tags[ut];nt.mapbox_clip_start=we.start/we.size,nt.mapbox_clip_end=we.end/we.size}const Ie={geometry:He,type:Fe==="Polygon"||Fe==="MultiPolygon"?3:Fe==="LineString"||Fe==="MultiLineString"?2:1,tags:nt};te.id!==null&&(Ie.id=te.id),xe.features.push(Ie)}}function Tt(xe,te,ne,de,we,Fe){const He=de*de;if(de>0&&te.size<(we?He:de))return void(ne.numPoints+=te.length/3);const nt=[];for(let Ie=0;Ie<te.length;Ie+=3)(de===0||te[Ie+2]>He)&&(ne.numSimplified++,nt.push(te[Ie],te[Ie+1])),ne.numPoints++;we&&function(Ie,ut){let bt=0;for(let ct=0,Wt=Ie.length,bn=Wt-2;ct<Wt;bn=ct,ct+=2)bt+=(Ie[ct]-Ie[bn])*(Ie[ct+1]+Ie[bn+1]);if(bt>0===ut)for(let ct=0,Wt=Ie.length;ct<Wt/2;ct+=2){const bn=Ie[ct],Sn=Ie[ct+1];Ie[ct]=Ie[Wt-2-ct],Ie[ct+1]=Ie[Wt-1-ct],Ie[Wt-2-ct]=bn,Ie[Wt-1-ct]=Sn}}(nt,Fe),xe.push(nt)}const Vt={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class kn{constructor(te,ne){const de=(ne=this.options=function(Fe,He){for(const nt in He)Fe[nt]=He[nt];return Fe}(Object.create(Vt),ne)).debug;if(de&&console.time("preprocess data"),ne.maxZoom<0||ne.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ne.promoteId&&ne.generateId)throw new Error("promoteId and generateId cannot be used together.");let we=function(Fe,He){const nt=[];if(Fe.type==="FeatureCollection")for(let Ie=0;Ie<Fe.features.length;Ie++)Ln(nt,Fe.features[Ie],He,Ie);else Ln(nt,Fe.type==="Feature"?Fe:{geometry:Fe},He);return nt}(te,ne);this.tiles={},this.tileCoords=[],de&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ne.indexMaxZoom,ne.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),we=function(Fe,He){const nt=He.buffer/He.extent;let Ie=Fe;const ut=ve(Fe,1,-1-nt,nt,0,-1,2,He),bt=ve(Fe,1,1-nt,2+nt,0,-1,2,He);return(ut||bt)&&(Ie=ve(Fe,1,-nt,1+nt,0,-1,2,He)||[],ut&&(Ie=it(ut,1).concat(Ie)),bt&&(Ie=Ie.concat(it(bt,-1)))),Ie}(we,ne),we.length&&this.splitTile(we,0,0,0),de&&(we.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(te,ne,de,we,Fe,He,nt){const Ie=[te,ne,de,we],ut=this.options,bt=ut.debug;for(;Ie.length;){we=Ie.pop(),de=Ie.pop(),ne=Ie.pop(),te=Ie.pop();const ct=1<<ne,Wt=ii(ne,de,we);let bn=this.tiles[Wt];if(!bn&&(bt>1&&console.time("creation"),bn=this.tiles[Wt]=Wn(te,ne,de,we,ut),this.tileCoords.push({z:ne,x:de,y:we}),bt)){bt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ne,de,we,bn.numFeatures,bn.numPoints,bn.numSimplified),console.timeEnd("creation"));const Je=`z${ne}`;this.stats[Je]=(this.stats[Je]||0)+1,this.total++}if(bn.source=te,Fe==null){if(ne===ut.indexMaxZoom||bn.numPoints<=ut.indexMaxPoints)continue}else{if(ne===ut.maxZoom||ne===Fe)continue;if(Fe!=null){const Je=Fe-ne;if(de!==He>>Je||we!==nt>>Je)continue}}if(bn.source=null,te.length===0)continue;bt>1&&console.time("clipping");const Sn=.5*ut.buffer/ut.extent,Bn=.5-Sn,ui=.5+Sn,Vn=1+Sn;let Di=null,qi=null,me=null,$e=null,ot=ve(te,ct,de-Sn,de+ui,0,bn.minX,bn.maxX,ut),lt=ve(te,ct,de+Bn,de+Vn,0,bn.minX,bn.maxX,ut);te=null,ot&&(Di=ve(ot,ct,we-Sn,we+ui,1,bn.minY,bn.maxY,ut),qi=ve(ot,ct,we+Bn,we+Vn,1,bn.minY,bn.maxY,ut),ot=null),lt&&(me=ve(lt,ct,we-Sn,we+ui,1,bn.minY,bn.maxY,ut),$e=ve(lt,ct,we+Bn,we+Vn,1,bn.minY,bn.maxY,ut),lt=null),bt>1&&console.timeEnd("clipping"),Ie.push(Di||[],ne+1,2*de,2*we),Ie.push(qi||[],ne+1,2*de,2*we+1),Ie.push(me||[],ne+1,2*de+1,2*we),Ie.push($e||[],ne+1,2*de+1,2*we+1)}}getTile(te,ne,de){te=+te,ne=+ne,de=+de;const we=this.options,{extent:Fe,debug:He}=we;if(te<0||te>24)return null;const nt=1<<te,Ie=ii(te,ne=ne+nt&nt-1,de);if(this.tiles[Ie])return Nt(this.tiles[Ie],Fe);He>1&&console.log("drilling down to z%d-%d-%d",te,ne,de);let ut,bt=te,ct=ne,Wt=de;for(;!ut&&bt>0;)bt--,ct>>=1,Wt>>=1,ut=this.tiles[ii(bt,ct,Wt)];return ut&&ut.source?(He>1&&(console.log("found parent tile z%d-%d-%d",bt,ct,Wt),console.time("drilling down")),this.splitTile(ut.source,bt,ct,Wt,te,ne,de),He>1&&console.timeEnd("drilling down"),this.tiles[Ie]?Nt(this.tiles[Ie],Fe):null):null}}function ii(xe,te,ne){return 32*((1<<xe)*ne+te)+xe}function Ne(xe,te){return te?xe.properties[te]:xe.id}function Gt(xe,te){if(xe==null)return!0;if(xe.type==="Feature")return Ne(xe,te)!=null;if(xe.type==="FeatureCollection"){const ne=new Set;for(const de of xe.features){const we=Ne(de,te);if(we==null||ne.has(we))return!1;ne.add(we)}return!0}return!1}function Et(xe,te){const ne=new Map;if(xe!=null)if(xe.type==="Feature")ne.set(Ne(xe,te),xe);else for(const de of xe.features)ne.set(Ne(de,te),de);return ne}class Ct extends S{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(te,ne){return u._(this,void 0,void 0,function*(){const de=te.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const we=this._geoJSONIndex.getTile(de.z,de.x,de.y);if(!we)return null;const Fe=new class{constructor(nt){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=u.X,this.length=nt.length,this._features=nt}feature(nt){return new class{constructor(Ie){this._feature=Ie,this.extent=u.X,this.type=Ie.type,this.properties=Ie.tags,"id"in Ie&&!isNaN(Ie.id)&&(this.id=parseInt(Ie.id,10))}loadGeometry(){if(this._feature.type===1){const Ie=[];for(const ut of this._feature.geometry)Ie.push([new u.P(ut[0],ut[1])]);return Ie}{const Ie=[];for(const ut of this._feature.geometry){const bt=[];for(const ct of ut)bt.push(new u.P(ct[0],ct[1]));Ie.push(bt)}return Ie}}toGeoJSON(Ie,ut,bt){return L.call(this,Ie,ut,bt)}}(this._features[nt])}}(we.features);let He=Ce(Fe);return He.byteOffset===0&&He.byteLength===He.buffer.byteLength||(He=new Uint8Array(He)),{vectorTile:Fe,rawData:He.buffer}})}loadData(te){return u._(this,void 0,void 0,function*(){var ne;(ne=this._pendingRequest)===null||ne===void 0||ne.abort();const de=!!(te&&te.request&&te.request.collectResourceTiming)&&new u.bu(te.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(te,this._pendingRequest),this._geoJSONIndex=te.cluster?new Ke(function({superclusterOptions:He,clusterProperties:nt}){if(!nt||!He)return He;const Ie={},ut={},bt={accumulated:null,zoom:0},ct={properties:null},Wt=Object.keys(nt);for(const bn of Wt){const[Sn,Bn]=nt[bn],ui=u.bB(Bn),Vn=u.bB(typeof Sn=="string"?[Sn,["accumulated"],["get",bn]]:Sn);Ie[bn]=ui.value,ut[bn]=Vn.value}return He.map=bn=>{ct.properties=bn;const Sn={};for(const Bn of Wt)Sn[Bn]=Ie[Bn].evaluate(bt,ct);return Sn},He.reduce=(bn,Sn)=>{ct.properties=Sn;for(const Bn of Wt)bt.accumulated=bn[Bn],bn[Bn]=ut[Bn].evaluate(bt,ct)},He}(te)).load((yield this._pendingData).features):(we=yield this._pendingData,new kn(we,te.geojsonVtOptions)),this.loaded={};const Fe={};if(de){const He=de.finish();He&&(Fe.resourceTiming={},Fe.resourceTiming[te.source]=JSON.parse(JSON.stringify(He)))}return Fe}catch(Fe){if(delete this._pendingRequest,u.bA(Fe))return{abandoned:!0};throw Fe}var we})}getData(){return u._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(te){const ne=this.loaded;return ne&&ne[te.uid]?super.reloadTile(te):this.loadTile(te)}loadAndProcessGeoJSON(te,ne){return u._(this,void 0,void 0,function*(){let de=yield this.loadGeoJSON(te,ne);if(delete this._pendingRequest,typeof de!="object")throw new Error(`Input data given to '${te.source}' is not a valid GeoJSON object.`);if(D(de,!0),te.filter){const we=u.bB(te.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(we.result==="error")throw new Error(we.value.map(He=>`${He.key}: ${He.message}`).join(", "));de={type:"FeatureCollection",features:de.features.filter(He=>we.value.evaluate({zoom:0},He))}}return de})}loadGeoJSON(te,ne){return u._(this,void 0,void 0,function*(){const{promoteId:de}=te;if(te.request){const we=yield u.h(te.request,ne);return this._dataUpdateable=Gt(we.data,de)?Et(we.data,de):void 0,we.data}if(typeof te.data=="string")try{const we=JSON.parse(te.data);return this._dataUpdateable=Gt(we,de)?Et(we,de):void 0,we}catch{throw new Error(`Input data given to '${te.source}' is not a valid GeoJSON object.`)}if(!te.dataDiff)throw new Error(`Input data given to '${te.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${te.source}`);return function(we,Fe,He){var nt,Ie,ut,bt;if(Fe.removeAll&&we.clear(),Fe.remove)for(const ct of Fe.remove)we.delete(ct);if(Fe.add)for(const ct of Fe.add){const Wt=Ne(ct,He);Wt!=null&&we.set(Wt,ct)}if(Fe.update)for(const ct of Fe.update){let Wt=we.get(ct.id);if(Wt==null)continue;const bn=!ct.removeAllProperties&&(((nt=ct.removeProperties)===null||nt===void 0?void 0:nt.length)>0||((Ie=ct.addOrUpdateProperties)===null||Ie===void 0?void 0:Ie.length)>0);if((ct.newGeometry||ct.removeAllProperties||bn)&&(Wt=Object.assign({},Wt),we.set(ct.id,Wt),bn&&(Wt.properties=Object.assign({},Wt.properties))),ct.newGeometry&&(Wt.geometry=ct.newGeometry),ct.removeAllProperties)Wt.properties={};else if(((ut=ct.removeProperties)===null||ut===void 0?void 0:ut.length)>0)for(const Sn of ct.removeProperties)Object.prototype.hasOwnProperty.call(Wt.properties,Sn)&&delete Wt.properties[Sn];if(((bt=ct.addOrUpdateProperties)===null||bt===void 0?void 0:bt.length)>0)for(const{key:Sn,value:Bn}of ct.addOrUpdateProperties)Wt.properties[Sn]=Bn}}(this._dataUpdateable,te.dataDiff,de),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(te){return u._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(te){return this._geoJSONIndex.getClusterExpansionZoom(te.clusterId)}getClusterChildren(te){return this._geoJSONIndex.getChildren(te.clusterId)}getClusterLeaves(te){return this._geoJSONIndex.getLeaves(te.clusterId,te.limit,te.offset)}}class Zt{constructor(te){this.self=te,this.actor=new u.F(te),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(ne,de)=>{if(this.externalWorkerSourceTypes[ne])throw new Error(`Worker source with name "${ne}" already registered.`);this.externalWorkerSourceTypes[ne]=de},this.self.addProtocol=u.bh,this.self.removeProtocol=u.bi,this.self.registerRTLTextPlugin=ne=>{if(u.bC.isParsed())throw new Error("RTL text plugin already registered.");u.bC.setMethods(ne)},this.actor.registerMessageHandler("LDT",(ne,de)=>this._getDEMWorkerSource(ne,de.source).loadTile(de)),this.actor.registerMessageHandler("RDT",(ne,de)=>u._(this,void 0,void 0,function*(){this._getDEMWorkerSource(ne,de.source).removeTile(de)})),this.actor.registerMessageHandler("GCEZ",(ne,de)=>u._(this,void 0,void 0,function*(){return this._getWorkerSource(ne,de.type,de.source).getClusterExpansionZoom(de)})),this.actor.registerMessageHandler("GCC",(ne,de)=>u._(this,void 0,void 0,function*(){return this._getWorkerSource(ne,de.type,de.source).getClusterChildren(de)})),this.actor.registerMessageHandler("GCL",(ne,de)=>u._(this,void 0,void 0,function*(){return this._getWorkerSource(ne,de.type,de.source).getClusterLeaves(de)})),this.actor.registerMessageHandler("LD",(ne,de)=>this._getWorkerSource(ne,de.type,de.source).loadData(de)),this.actor.registerMessageHandler("GD",(ne,de)=>this._getWorkerSource(ne,de.type,de.source).getData()),this.actor.registerMessageHandler("LT",(ne,de)=>this._getWorkerSource(ne,de.type,de.source).loadTile(de)),this.actor.registerMessageHandler("RT",(ne,de)=>this._getWorkerSource(ne,de.type,de.source).reloadTile(de)),this.actor.registerMessageHandler("AT",(ne,de)=>this._getWorkerSource(ne,de.type,de.source).abortTile(de)),this.actor.registerMessageHandler("RMT",(ne,de)=>this._getWorkerSource(ne,de.type,de.source).removeTile(de)),this.actor.registerMessageHandler("RS",(ne,de)=>u._(this,void 0,void 0,function*(){if(!this.workerSources[ne]||!this.workerSources[ne][de.type]||!this.workerSources[ne][de.type][de.source])return;const we=this.workerSources[ne][de.type][de.source];delete this.workerSources[ne][de.type][de.source],we.removeSource!==void 0&&we.removeSource(de)})),this.actor.registerMessageHandler("RM",ne=>u._(this,void 0,void 0,function*(){delete this.layerIndexes[ne],delete this.availableImages[ne],delete this.workerSources[ne],delete this.demWorkerSources[ne]})),this.actor.registerMessageHandler("SR",(ne,de)=>u._(this,void 0,void 0,function*(){this.referrer=de})),this.actor.registerMessageHandler("SRPS",(ne,de)=>this._syncRTLPluginState(ne,de)),this.actor.registerMessageHandler("IS",(ne,de)=>u._(this,void 0,void 0,function*(){this.self.importScripts(de)})),this.actor.registerMessageHandler("SI",(ne,de)=>this._setImages(ne,de)),this.actor.registerMessageHandler("UL",(ne,de)=>u._(this,void 0,void 0,function*(){this._getLayerIndex(ne).update(de.layers,de.removedIds)})),this.actor.registerMessageHandler("SL",(ne,de)=>u._(this,void 0,void 0,function*(){this._getLayerIndex(ne).replace(de)}))}_setImages(te,ne){return u._(this,void 0,void 0,function*(){this.availableImages[te]=ne;for(const de in this.workerSources[te]){const we=this.workerSources[te][de];for(const Fe in we)we[Fe].availableImages=ne}})}_syncRTLPluginState(te,ne){return u._(this,void 0,void 0,function*(){if(u.bC.isParsed())return u.bC.getState();if(ne.pluginStatus!=="loading")return u.bC.setState(ne),ne;const de=ne.pluginURL;if(this.self.importScripts(de),u.bC.isParsed()){const we={pluginStatus:"loaded",pluginURL:de};return u.bC.setState(we),we}throw u.bC.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${de}`)})}_getAvailableImages(te){let ne=this.availableImages[te];return ne||(ne=[]),ne}_getLayerIndex(te){let ne=this.layerIndexes[te];return ne||(ne=this.layerIndexes[te]=new l),ne}_getWorkerSource(te,ne,de){if(this.workerSources[te]||(this.workerSources[te]={}),this.workerSources[te][ne]||(this.workerSources[te][ne]={}),!this.workerSources[te][ne][de]){const we={sendAsync:(Fe,He)=>(Fe.targetMapId=te,this.actor.sendAsync(Fe,He))};switch(ne){case"vector":this.workerSources[te][ne][de]=new S(we,this._getLayerIndex(te),this._getAvailableImages(te));break;case"geojson":this.workerSources[te][ne][de]=new Ct(we,this._getLayerIndex(te),this._getAvailableImages(te));break;default:this.workerSources[te][ne][de]=new this.externalWorkerSourceTypes[ne](we,this._getLayerIndex(te),this._getAvailableImages(te))}}return this.workerSources[te][ne][de]}_getDEMWorkerSource(te,ne){return this.demWorkerSources[te]||(this.demWorkerSources[te]={}),this.demWorkerSources[te][ne]||(this.demWorkerSources[te][ne]=new b),this.demWorkerSources[te][ne]}}return u.i(self)&&(self.worker=new Zt(self)),Zt}),r("index",["exports","./shared"],function(u,l){var f="4.5.2";let g,y;const S={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:M=>new Promise((o,d)=>{const v=requestAnimationFrame(o);M.signal.addEventListener("abort",()=>{cancelAnimationFrame(v),d(l.c())})}),getImageData(M,o=0){return this.getImageCanvasContext(M).getImageData(-o,-o,M.width+2*o,M.height+2*o)},getImageCanvasContext(M){const o=window.document.createElement("canvas"),d=o.getContext("2d",{willReadFrequently:!0});if(!d)throw new Error("failed to create canvas 2d context");return o.width=M.width,o.height=M.height,d.drawImage(M,0,0,M.width,M.height),d},resolveURL:M=>(g||(g=document.createElement("a")),g.href=M,g.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(y==null&&(y=matchMedia("(prefers-reduced-motion: reduce)")),y.matches)}};class b{static testProp(o){if(!b.docStyle)return o[0];for(let d=0;d<o.length;d++)if(o[d]in b.docStyle)return o[d];return o[0]}static create(o,d,v){const _=window.document.createElement(o);return d!==void 0&&(_.className=d),v&&v.appendChild(_),_}static createNS(o,d){return window.document.createElementNS(o,d)}static disableDrag(){b.docStyle&&b.selectProp&&(b.userSelect=b.docStyle[b.selectProp],b.docStyle[b.selectProp]="none")}static enableDrag(){b.docStyle&&b.selectProp&&(b.docStyle[b.selectProp]=b.userSelect)}static setTransform(o,d){o.style[b.transformProp]=d}static addEventListener(o,d,v,_={}){o.addEventListener(d,v,"passive"in _?_:_.capture)}static removeEventListener(o,d,v,_={}){o.removeEventListener(d,v,"passive"in _?_:_.capture)}static suppressClickInternal(o){o.preventDefault(),o.stopPropagation(),window.removeEventListener("click",b.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",b.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",b.suppressClickInternal,!0)},0)}static getScale(o){const d=o.getBoundingClientRect();return{x:d.width/o.offsetWidth||1,y:d.height/o.offsetHeight||1,boundingClientRect:d}}static getPoint(o,d,v){const _=d.boundingClientRect;return new l.P((v.clientX-_.left)/d.x-o.clientLeft,(v.clientY-_.top)/d.y-o.clientTop)}static mousePos(o,d){const v=b.getScale(o);return b.getPoint(o,v,d)}static touchPos(o,d){const v=[],_=b.getScale(o);for(let E=0;E<d.length;E++)v.push(b.getPoint(o,_,d[E]));return v}static mouseButton(o){return o.button}static remove(o){o.parentNode&&o.parentNode.removeChild(o)}}b.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,b.selectProp=b.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),b.transformProp=b.testProp(["transform","WebkitTransform"]);const A={supported:!1,testSupport:function(M){!L&&D&&(P?N(M):I=M)}};let I,D,L=!1,P=!1;function N(M){const o=M.createTexture();M.bindTexture(M.TEXTURE_2D,o);try{if(M.texImage2D(M.TEXTURE_2D,0,M.RGBA,M.RGBA,M.UNSIGNED_BYTE,D),M.isContextLost())return;A.supported=!0}catch{}M.deleteTexture(o),L=!0}var B;typeof document<"u"&&(D=document.createElement("img"),D.onload=()=>{I&&N(I),I=null,P=!0},D.onerror=()=>{L=!0,I=null},D.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(M){let o,d,v,_;M.resetRequestQueue=()=>{o=[],d=0,v=0,_={}},M.addThrottleControl=V=>{const H=v++;return _[H]=V,H},M.removeThrottleControl=V=>{delete _[V],O()},M.getImage=(V,H,J=!0)=>new Promise((Q,ce)=>{A.supported&&(V.headers||(V.headers={}),V.headers.accept="image/webp,*/*"),l.e(V,{type:"image"}),o.push({abortController:H,requestParameters:V,supportImageRefresh:J,state:"queued",onError:fe=>{ce(fe)},onSuccess:fe=>{Q(fe)}}),O()});const E=V=>l._(this,void 0,void 0,function*(){V.state="running";const{requestParameters:H,supportImageRefresh:J,onError:Q,onSuccess:ce,abortController:fe}=V,be=J===!1&&!l.i(self)&&!l.g(H.url)&&(!H.headers||Object.keys(H.headers).reduce((ke,Ve)=>ke&&Ve==="accept",!0));d++;const Pe=be?z(H,fe):l.m(H,fe);try{const ke=yield Pe;delete V.abortController,V.state="completed",ke.data instanceof HTMLImageElement||l.b(ke.data)?ce(ke):ke.data&&ce({data:yield(Te=ke.data,typeof createImageBitmap=="function"?l.d(Te):l.f(Te)),cacheControl:ke.cacheControl,expires:ke.expires})}catch(ke){delete V.abortController,Q(ke)}finally{d--,O()}var Te}),O=()=>{const V=(()=>{for(const H of Object.keys(_))if(_[H]())return!0;return!1})()?l.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:l.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let H=d;H<V&&o.length>0;H++){const J=o.shift();J.abortController.signal.aborted?H--:E(J)}},z=(V,H)=>new Promise((J,Q)=>{const ce=new Image,fe=V.url,be=V.credentials;be&&be==="include"?ce.crossOrigin="use-credentials":(be&&be==="same-origin"||!l.s(fe))&&(ce.crossOrigin="anonymous"),H.signal.addEventListener("abort",()=>{ce.src="",Q(l.c())}),ce.fetchPriority="high",ce.onload=()=>{ce.onerror=ce.onload=null,J({data:ce})},ce.onerror=()=>{ce.onerror=ce.onload=null,H.signal.aborted||Q(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},ce.src=fe})}(B||(B={})),B.resetRequestQueue();class ${constructor(o){this._transformRequestFn=o}transformRequest(o,d){return this._transformRequestFn&&this._transformRequestFn(o,d)||{url:o}}setTransformRequest(o){this._transformRequestFn=o}}function K(M){var o=new l.A(3);return o[0]=M[0],o[1]=M[1],o[2]=M[2],o}var q,W=function(M,o,d){return M[0]=o[0]-d[0],M[1]=o[1]-d[1],M[2]=o[2]-d[2],M};q=new l.A(3),l.A!=Float32Array&&(q[0]=0,q[1]=0,q[2]=0);var ie=function(M){var o=M[0],d=M[1];return o*o+d*d};function Z(M){const o=[];if(typeof M=="string")o.push({id:"default",url:M});else if(M&&M.length>0){const d=[];for(const{id:v,url:_}of M){const E=`${v}${_}`;d.indexOf(E)===-1&&(d.push(E),o.push({id:v,url:_}))}}return o}function X(M,o,d){const v=M.split("?");return v[0]+=`${o}${d}`,v.join("?")}(function(){var M=new l.A(2);l.A!=Float32Array&&(M[0]=0,M[1]=0)})();class se{constructor(o,d,v,_){this.context=o,this.format=v,this.texture=o.gl.createTexture(),this.update(d,_)}update(o,d,v){const{width:_,height:E}=o,O=!(this.size&&this.size[0]===_&&this.size[1]===E||v),{context:z}=this,{gl:V}=z;if(this.useMipmap=!!(d&&d.useMipmap),V.bindTexture(V.TEXTURE_2D,this.texture),z.pixelStoreUnpackFlipY.set(!1),z.pixelStoreUnpack.set(1),z.pixelStoreUnpackPremultiplyAlpha.set(this.format===V.RGBA&&(!d||d.premultiply!==!1)),O)this.size=[_,E],o instanceof HTMLImageElement||o instanceof HTMLCanvasElement||o instanceof HTMLVideoElement||o instanceof ImageData||l.b(o)?V.texImage2D(V.TEXTURE_2D,0,this.format,this.format,V.UNSIGNED_BYTE,o):V.texImage2D(V.TEXTURE_2D,0,this.format,_,E,0,this.format,V.UNSIGNED_BYTE,o.data);else{const{x:H,y:J}=v||{x:0,y:0};o instanceof HTMLImageElement||o instanceof HTMLCanvasElement||o instanceof HTMLVideoElement||o instanceof ImageData||l.b(o)?V.texSubImage2D(V.TEXTURE_2D,0,H,J,V.RGBA,V.UNSIGNED_BYTE,o):V.texSubImage2D(V.TEXTURE_2D,0,H,J,_,E,V.RGBA,V.UNSIGNED_BYTE,o.data)}this.useMipmap&&this.isSizePowerOfTwo()&&V.generateMipmap(V.TEXTURE_2D)}bind(o,d,v){const{context:_}=this,{gl:E}=_;E.bindTexture(E.TEXTURE_2D,this.texture),v!==E.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(v=E.LINEAR),o!==this.filter&&(E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MAG_FILTER,o),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MIN_FILTER,v||o),this.filter=o),d!==this.wrap&&(E.texParameteri(E.TEXTURE_2D,E.TEXTURE_WRAP_S,d),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_WRAP_T,d),this.wrap=d)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:o}=this.context;o.deleteTexture(this.texture),this.texture=null}}function De(M){const{userImage:o}=M;return!!(o&&o.render&&o.render())&&(M.data.replace(new Uint8Array(o.data.buffer)),!0)}class Se extends l.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new l.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(o){if(this.loaded!==o&&(this.loaded=o,o)){for(const{ids:d,promiseResolve:v}of this.requestors)v(this._getImagesForIds(d));this.requestors=[]}}getImage(o){const d=this.images[o];if(d&&!d.data&&d.spriteData){const v=d.spriteData;d.data=new l.R({width:v.width,height:v.height},v.context.getImageData(v.x,v.y,v.width,v.height).data),d.spriteData=null}return d}addImage(o,d){if(this.images[o])throw new Error(`Image id ${o} already exist, use updateImage instead`);this._validate(o,d)&&(this.images[o]=d)}_validate(o,d){let v=!0;const _=d.data||d.spriteData;return this._validateStretch(d.stretchX,_&&_.width)||(this.fire(new l.j(new Error(`Image "${o}" has invalid "stretchX" value`))),v=!1),this._validateStretch(d.stretchY,_&&_.height)||(this.fire(new l.j(new Error(`Image "${o}" has invalid "stretchY" value`))),v=!1),this._validateContent(d.content,d)||(this.fire(new l.j(new Error(`Image "${o}" has invalid "content" value`))),v=!1),v}_validateStretch(o,d){if(!o)return!0;let v=0;for(const _ of o){if(_[0]<v||_[1]<_[0]||d<_[1])return!1;v=_[1]}return!0}_validateContent(o,d){if(!o)return!0;if(o.length!==4)return!1;const v=d.spriteData,_=v&&v.width||d.data.width,E=v&&v.height||d.data.height;return!(o[0]<0||_<o[0]||o[1]<0||E<o[1]||o[2]<0||_<o[2]||o[3]<0||E<o[3]||o[2]<o[0]||o[3]<o[1])}updateImage(o,d,v=!0){const _=this.getImage(o);if(v&&(_.data.width!==d.data.width||_.data.height!==d.data.height))throw new Error(`size mismatch between old image (${_.data.width}x${_.data.height}) and new image (${d.data.width}x${d.data.height}).`);d.version=_.version+1,this.images[o]=d,this.updatedImages[o]=!0}removeImage(o){const d=this.images[o];delete this.images[o],delete this.patterns[o],d.userImage&&d.userImage.onRemove&&d.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(o){return new Promise((d,v)=>{let _=!0;if(!this.isLoaded())for(const E of o)this.images[E]||(_=!1);this.isLoaded()||_?d(this._getImagesForIds(o)):this.requestors.push({ids:o,promiseResolve:d})})}_getImagesForIds(o){const d={};for(const v of o){let _=this.getImage(v);_||(this.fire(new l.k("styleimagemissing",{id:v})),_=this.getImage(v)),_?d[v]={data:_.data.clone(),pixelRatio:_.pixelRatio,sdf:_.sdf,version:_.version,stretchX:_.stretchX,stretchY:_.stretchY,content:_.content,textFitWidth:_.textFitWidth,textFitHeight:_.textFitHeight,hasRenderCallback:!!(_.userImage&&_.userImage.render)}:l.w(`Image "${v}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return d}getPixelSize(){const{width:o,height:d}=this.atlasImage;return{width:o,height:d}}getPattern(o){const d=this.patterns[o],v=this.getImage(o);if(!v)return null;if(d&&d.position.version===v.version)return d.position;if(d)d.position.version=v.version;else{const _={w:v.data.width+2,h:v.data.height+2,x:0,y:0},E=new l.I(_,v);this.patterns[o]={bin:_,position:E}}return this._updatePatternAtlas(),this.patterns[o].position}bind(o){const d=o.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new se(o,this.atlasImage,d.RGBA),this.atlasTexture.bind(d.LINEAR,d.CLAMP_TO_EDGE)}_updatePatternAtlas(){const o=[];for(const E in this.patterns)o.push(this.patterns[E].bin);const{w:d,h:v}=l.p(o),_=this.atlasImage;_.resize({width:d||1,height:v||1});for(const E in this.patterns){const{bin:O}=this.patterns[E],z=O.x+1,V=O.y+1,H=this.getImage(E).data,J=H.width,Q=H.height;l.R.copy(H,_,{x:0,y:0},{x:z,y:V},{width:J,height:Q}),l.R.copy(H,_,{x:0,y:Q-1},{x:z,y:V-1},{width:J,height:1}),l.R.copy(H,_,{x:0,y:0},{x:z,y:V+Q},{width:J,height:1}),l.R.copy(H,_,{x:J-1,y:0},{x:z-1,y:V},{width:1,height:Q}),l.R.copy(H,_,{x:0,y:0},{x:z+J,y:V},{width:1,height:Q})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(o){for(const d of o){if(this.callbackDispatchedThisFrame[d])continue;this.callbackDispatchedThisFrame[d]=!0;const v=this.getImage(d);v||l.w(`Image with ID: "${d}" was not found`),De(v)&&this.updateImage(d,v)}}}const Me=1e20;function Ye(M,o,d,v,_,E,O,z,V){for(let H=o;H<o+v;H++)ye(M,d*E+H,E,_,O,z,V);for(let H=d;H<d+_;H++)ye(M,H*E+o,1,v,O,z,V)}function ye(M,o,d,v,_,E,O){E[0]=0,O[0]=-1e20,O[1]=Me,_[0]=M[o];for(let z=1,V=0,H=0;z<v;z++){_[z]=M[o+z*d];const J=z*z;do{const Q=E[V];H=(_[z]-_[Q]+J-Q*Q)/(z-Q)/2}while(H<=O[V]&&--V>-1);V++,E[V]=z,O[V]=H,O[V+1]=Me}for(let z=0,V=0;z<v;z++){for(;O[V+1]<z;)V++;const H=E[V],J=z-H;M[o+z*d]=_[H]+J*J}}class Ce{constructor(o,d){this.requestManager=o,this.localIdeographFontFamily=d,this.entries={}}setURL(o){this.url=o}getGlyphs(o){return l._(this,void 0,void 0,function*(){const d=[];for(const E in o)for(const O of o[E])d.push(this._getAndCacheGlyphsPromise(E,O));const v=yield Promise.all(d),_={};for(const{stack:E,id:O,glyph:z}of v)_[E]||(_[E]={}),_[E][O]=z&&{id:z.id,bitmap:z.bitmap.clone(),metrics:z.metrics};return _})}_getAndCacheGlyphsPromise(o,d){return l._(this,void 0,void 0,function*(){let v=this.entries[o];v||(v=this.entries[o]={glyphs:{},requests:{},ranges:{}});let _=v.glyphs[d];if(_!==void 0)return{stack:o,id:d,glyph:_};if(_=this._tinySDF(v,o,d),_)return v.glyphs[d]=_,{stack:o,id:d,glyph:_};const E=Math.floor(d/256);if(256*E>65535)throw new Error("glyphs > 65535 not supported");if(v.ranges[E])return{stack:o,id:d,glyph:_};if(!this.url)throw new Error("glyphsUrl is not set");if(!v.requests[E]){const z=Ce.loadGlyphRange(o,E,this.url,this.requestManager);v.requests[E]=z}const O=yield v.requests[E];for(const z in O)this._doesCharSupportLocalGlyph(+z)||(v.glyphs[+z]=O[+z]);return v.ranges[E]=!0,{stack:o,id:d,glyph:O[d]||null}})}_doesCharSupportLocalGlyph(o){return!!this.localIdeographFontFamily&&(l.u["CJK Unified Ideographs"](o)||l.u["Hangul Syllables"](o)||l.u.Hiragana(o)||l.u.Katakana(o))}_tinySDF(o,d,v){const _=this.localIdeographFontFamily;if(!_||!this._doesCharSupportLocalGlyph(v))return;let E=o.tinySDF;if(!E){let z="400";/bold/i.test(d)?z="900":/medium/i.test(d)?z="500":/light/i.test(d)&&(z="200"),E=o.tinySDF=new Ce.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:_,fontWeight:z})}const O=E.draw(String.fromCharCode(v));return{id:v,bitmap:new l.o({width:O.width||60,height:O.height||60},O.data),metrics:{width:O.glyphWidth/2||24,height:O.glyphHeight/2||24,left:O.glyphLeft/2+.5||0,top:O.glyphTop/2-27.5||-8,advance:O.glyphAdvance/2||24,isDoubleResolution:!0}}}}Ce.loadGlyphRange=function(M,o,d,v){return l._(this,void 0,void 0,function*(){const _=256*o,E=_+255,O=v.transformRequest(d.replace("{fontstack}",M).replace("{range}",`${_}-${E}`),"Glyphs"),z=yield l.l(O,new AbortController);if(!z||!z.data)throw new Error(`Could not load glyph range. range: ${o}, ${_}-${E}`);const V={};for(const H of l.n(z.data))V[H.id]=H;return V})},Ce.TinySDF=class{constructor({fontSize:M=24,buffer:o=3,radius:d=8,cutoff:v=.25,fontFamily:_="sans-serif",fontWeight:E="normal",fontStyle:O="normal"}={}){this.buffer=o,this.cutoff=v,this.radius=d;const z=this.size=M+4*o,V=this._createCanvas(z),H=this.ctx=V.getContext("2d",{willReadFrequently:!0});H.font=`${O} ${E} ${M}px ${_}`,H.textBaseline="alphabetic",H.textAlign="left",H.fillStyle="black",this.gridOuter=new Float64Array(z*z),this.gridInner=new Float64Array(z*z),this.f=new Float64Array(z),this.z=new Float64Array(z+1),this.v=new Uint16Array(z)}_createCanvas(M){const o=document.createElement("canvas");return o.width=o.height=M,o}draw(M){const{width:o,actualBoundingBoxAscent:d,actualBoundingBoxDescent:v,actualBoundingBoxLeft:_,actualBoundingBoxRight:E}=this.ctx.measureText(M),O=Math.ceil(d),z=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(E-_))),V=Math.min(this.size-this.buffer,O+Math.ceil(v)),H=z+2*this.buffer,J=V+2*this.buffer,Q=Math.max(H*J,0),ce=new Uint8ClampedArray(Q),fe={data:ce,width:H,height:J,glyphWidth:z,glyphHeight:V,glyphTop:O,glyphLeft:0,glyphAdvance:o};if(z===0||V===0)return fe;const{ctx:be,buffer:Pe,gridInner:Te,gridOuter:ke}=this;be.clearRect(Pe,Pe,z,V),be.fillText(M,Pe,Pe+O);const Ve=be.getImageData(Pe,Pe,z,V);ke.fill(Me,0,Q),Te.fill(0,0,Q);for(let Ee=0;Ee<V;Ee++)for(let qe=0;qe<z;qe++){const rt=Ve.data[4*(Ee*z+qe)+3]/255;if(rt===0)continue;const ht=(Ee+Pe)*H+qe+Pe;if(rt===1)ke[ht]=0,Te[ht]=Me;else{const At=.5-rt;ke[ht]=At>0?At*At:0,Te[ht]=At<0?At*At:0}}Ye(ke,0,0,H,J,H,this.f,this.v,this.z),Ye(Te,Pe,Pe,z,V,H,this.f,this.v,this.z);for(let Ee=0;Ee<Q;Ee++){const qe=Math.sqrt(ke[Ee])-Math.sqrt(Te[Ee]);ce[Ee]=Math.round(255-255*(qe/this.radius+this.cutoff))}return fe}};class ge{constructor(){this.specification=l.v.light.position}possiblyEvaluate(o,d){return l.y(o.expression.evaluate(d))}interpolate(o,d,v){return{x:l.z.number(o.x,d.x,v),y:l.z.number(o.y,d.y,v),z:l.z.number(o.z,d.z,v)}}}let Be;class Ze extends l.E{constructor(o){super(),Be=Be||new l.q({anchor:new l.D(l.v.light.anchor),position:new ge,color:new l.D(l.v.light.color),intensity:new l.D(l.v.light.intensity)}),this._transitionable=new l.T(Be),this.setLight(o),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(o,d={}){if(!this._validate(l.r,o,d))for(const v in o){const _=o[v];v.endsWith("-transition")?this._transitionable.setTransition(v.slice(0,-11),_):this._transitionable.setValue(v,_)}}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,d,v){return(!v||v.validate!==!1)&&l.t(this,o.call(l.x,{value:d,style:{glyphs:!0,sprite:!0},styleSpec:l.v}))}}const je=new l.q({"sky-color":new l.D(l.v.sky["sky-color"]),"horizon-color":new l.D(l.v.sky["horizon-color"]),"fog-color":new l.D(l.v.sky["fog-color"]),"fog-ground-blend":new l.D(l.v.sky["fog-ground-blend"]),"horizon-fog-blend":new l.D(l.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new l.D(l.v.sky["sky-horizon-blend"]),"atmosphere-blend":new l.D(l.v.sky["atmosphere-blend"])});class wt extends l.E{constructor(o){super(),this._transitionable=new l.T(je),this.setSky(o),this._transitioning=this._transitionable.untransitioned()}setSky(o,d={}){if(!this._validate(l.B,o,d))for(const v in o){const _=o[v];v.endsWith("-transition")?this._transitionable.setTransition(v.slice(0,-11),_):this._transitionable.setValue(v,_)}}getSky(){return this._transitionable.serialize()}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,d,v={}){return(v==null?void 0:v.validate)!==!1&&l.t(this,o.call(l.x,l.e({value:d,style:{glyphs:!0,sprite:!0},styleSpec:l.v})))}calculateFogBlendOpacity(o){return o<60?0:o<70?(o-60)/10:1}}class Xt{constructor(o,d){this.width=o,this.height=d,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(o,d){const v=o.join(",")+String(d);return this.dashEntry[v]||(this.dashEntry[v]=this.addDash(o,d)),this.dashEntry[v]}getDashRanges(o,d,v){const _=[];let E=o.length%2==1?-o[o.length-1]*v:0,O=o[0]*v,z=!0;_.push({left:E,right:O,isDash:z,zeroLength:o[0]===0});let V=o[0];for(let H=1;H<o.length;H++){z=!z;const J=o[H];E=V*v,V+=J,O=V*v,_.push({left:E,right:O,isDash:z,zeroLength:J===0})}return _}addRoundDash(o,d,v){const _=d/2;for(let E=-v;E<=v;E++){const O=this.width*(this.nextRow+v+E);let z=0,V=o[z];for(let H=0;H<this.width;H++){H/V.right>1&&(V=o[++z]);const J=Math.abs(H-V.left),Q=Math.abs(H-V.right),ce=Math.min(J,Q);let fe;const be=E/v*(_+1);if(V.isDash){const Pe=_-Math.abs(be);fe=Math.sqrt(ce*ce+Pe*Pe)}else fe=_-Math.sqrt(ce*ce+be*be);this.data[O+H]=Math.max(0,Math.min(255,fe+128))}}}addRegularDash(o){for(let z=o.length-1;z>=0;--z){const V=o[z],H=o[z+1];V.zeroLength?o.splice(z,1):H&&H.isDash===V.isDash&&(H.left=V.left,o.splice(z,1))}const d=o[0],v=o[o.length-1];d.isDash===v.isDash&&(d.left=v.left-this.width,v.right=d.right+this.width);const _=this.width*this.nextRow;let E=0,O=o[E];for(let z=0;z<this.width;z++){z/O.right>1&&(O=o[++E]);const V=Math.abs(z-O.left),H=Math.abs(z-O.right),J=Math.min(V,H);this.data[_+z]=Math.max(0,Math.min(255,(O.isDash?J:-J)+128))}}addDash(o,d){const v=d?7:0,_=2*v+1;if(this.nextRow+_>this.height)return l.w("LineAtlas out of space"),null;let E=0;for(let z=0;z<o.length;z++)E+=o[z];if(E!==0){const z=this.width/E,V=this.getDashRanges(o,this.width,z);d?this.addRoundDash(V,z,v):this.addRegularDash(V)}const O={y:(this.nextRow+v+.5)/this.height,height:2*v/this.height,width:E};return this.nextRow+=_,this.dirty=!0,O}bind(o){const d=o.gl;this.texture?(d.bindTexture(d.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,d.texSubImage2D(d.TEXTURE_2D,0,0,0,this.width,this.height,d.ALPHA,d.UNSIGNED_BYTE,this.data))):(this.texture=d.createTexture(),d.bindTexture(d.TEXTURE_2D,this.texture),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.REPEAT),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.REPEAT),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.LINEAR),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.LINEAR),d.texImage2D(d.TEXTURE_2D,0,d.ALPHA,this.width,this.height,0,d.ALPHA,d.UNSIGNED_BYTE,this.data))}}const Ke="maplibre_preloaded_worker_pool";class _t{constructor(){this.active={}}acquire(o){if(!this.workers)for(this.workers=[];this.workers.length<_t.workerCount;)this.workers.push(new Worker(l.a.WORKER_URL));return this.active[o]=!0,this.workers.slice()}release(o){delete this.active[o],this.numActive()===0&&(this.workers.forEach(d=>{d.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Ke]}numActive(){return Object.keys(this.active).length}}const zt=Math.floor(S.hardwareConcurrency/2);let Rt,fn;function Mn(){return Rt||(Rt=new _t),Rt}_t.workerCount=l.C(globalThis)?Math.max(Math.min(zt,3),1):1;class Bt{constructor(o,d){this.workerPool=o,this.actors=[],this.currentActor=0,this.id=d;const v=this.workerPool.acquire(d);for(let _=0;_<v.length;_++){const E=new l.F(v[_],d);E.name=`Worker ${_}`,this.actors.push(E)}if(!this.actors.length)throw new Error("No actors found")}broadcast(o,d){const v=[];for(const _ of this.actors)v.push(_.sendAsync({type:o,data:d}));return Promise.all(v)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(o=!0){this.actors.forEach(d=>{d.remove()}),this.actors=[],o&&this.workerPool.release(this.id)}registerMessageHandler(o,d){for(const v of this.actors)v.registerMessageHandler(o,d)}}function Kn(){return fn||(fn=new Bt(Mn(),l.G),fn.registerMessageHandler("GR",(M,o,d)=>l.m(o,d))),fn}function Re(M,o){const d=l.H();return l.J(d,d,[1,1,0]),l.K(d,d,[.5*M.width,.5*M.height,1]),l.L(d,d,M.calculatePosMatrix(o.toUnwrapped()))}function Jn(M,o,d,v,_,E){const O=function(Q,ce,fe){if(Q)for(const be of Q){const Pe=ce[be];if(Pe&&Pe.source===fe&&Pe.type==="fill-extrusion")return!0}else for(const be in ce){const Pe=ce[be];if(Pe.source===fe&&Pe.type==="fill-extrusion")return!0}return!1}(_&&_.layers,o,M.id),z=E.maxPitchScaleFactor(),V=M.tilesIn(v,z,O);V.sort(Ln);const H=[];for(const Q of V)H.push({wrappedTileID:Q.tileID.wrapped().key,queryResults:Q.tile.queryRenderedFeatures(o,d,M._state,Q.queryGeometry,Q.cameraQueryGeometry,Q.scale,_,E,z,Re(M.transform,Q.tileID))});const J=function(Q){const ce={},fe={};for(const be of Q){const Pe=be.queryResults,Te=be.wrappedTileID,ke=fe[Te]=fe[Te]||{};for(const Ve in Pe){const Ee=Pe[Ve],qe=ke[Ve]=ke[Ve]||{},rt=ce[Ve]=ce[Ve]||[];for(const ht of Ee)qe[ht.featureIndex]||(qe[ht.featureIndex]=!0,rt.push(ht))}}return ce}(H);for(const Q in J)J[Q].forEach(ce=>{const fe=ce.feature,be=M.getFeatureState(fe.layer["source-layer"],fe.id);fe.source=fe.layer.source,fe.layer["source-layer"]&&(fe.sourceLayer=fe.layer["source-layer"]),fe.state=be});return J}function Ln(M,o){const d=M.tileID,v=o.tileID;return d.overscaledZ-v.overscaledZ||d.canonical.y-v.canonical.y||d.wrap-v.wrap||d.canonical.x-v.canonical.x}function Cn(M,o,d){return l._(this,void 0,void 0,function*(){let v=M;if(M.url?v=(yield l.h(o.transformRequest(M.url,"Source"),d)).data:yield S.frameAsync(d),!v)return null;const _=l.M(l.e(v,M),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in v&&v.vector_layers&&(_.vectorLayerIds=v.vector_layers.map(E=>E.id)),_})}class Ue{constructor(o,d){o&&(d?this.setSouthWest(o).setNorthEast(d):Array.isArray(o)&&(o.length===4?this.setSouthWest([o[0],o[1]]).setNorthEast([o[2],o[3]]):this.setSouthWest(o[0]).setNorthEast(o[1])))}setNorthEast(o){return this._ne=o instanceof l.N?new l.N(o.lng,o.lat):l.N.convert(o),this}setSouthWest(o){return this._sw=o instanceof l.N?new l.N(o.lng,o.lat):l.N.convert(o),this}extend(o){const d=this._sw,v=this._ne;let _,E;if(o instanceof l.N)_=o,E=o;else{if(!(o instanceof Ue))return Array.isArray(o)?o.length===4||o.every(Array.isArray)?this.extend(Ue.convert(o)):this.extend(l.N.convert(o)):o&&("lng"in o||"lon"in o)&&"lat"in o?this.extend(l.N.convert(o)):this;if(_=o._sw,E=o._ne,!_||!E)return this}return d||v?(d.lng=Math.min(_.lng,d.lng),d.lat=Math.min(_.lat,d.lat),v.lng=Math.max(E.lng,v.lng),v.lat=Math.max(E.lat,v.lat)):(this._sw=new l.N(_.lng,_.lat),this._ne=new l.N(E.lng,E.lat)),this}getCenter(){return new l.N((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new l.N(this.getWest(),this.getNorth())}getSouthEast(){return new l.N(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(o){const{lng:d,lat:v}=l.N.convert(o);let _=this._sw.lng<=d&&d<=this._ne.lng;return this._sw.lng>this._ne.lng&&(_=this._sw.lng>=d&&d>=this._ne.lng),this._sw.lat<=v&&v<=this._ne.lat&&_}static convert(o){return o instanceof Ue?o:o&&new Ue(o)}static fromLngLat(o,d=0){const v=360*d/40075017,_=v/Math.cos(Math.PI/180*o.lat);return new Ue(new l.N(o.lng-_,o.lat-v),new l.N(o.lng+_,o.lat+v))}}class xt{constructor(o,d,v){this.bounds=Ue.convert(this.validateBounds(o)),this.minzoom=d||0,this.maxzoom=v||24}validateBounds(o){return Array.isArray(o)&&o.length===4?[Math.max(-180,o[0]),Math.max(-90,o[1]),Math.min(180,o[2]),Math.min(90,o[3])]:[-180,-90,180,90]}contains(o){const d=Math.pow(2,o.z),v=Math.floor(l.O(this.bounds.getWest())*d),_=Math.floor(l.Q(this.bounds.getNorth())*d),E=Math.ceil(l.O(this.bounds.getEast())*d),O=Math.ceil(l.Q(this.bounds.getSouth())*d);return o.x>=v&&o.x<E&&o.y>=_&&o.y<O}}class Pt extends l.E{constructor(o,d,v,_){if(super(),this.id=o,this.dispatcher=v,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,l.e(this,l.M(d,["url","scheme","tileSize","promoteId"])),this._options=l.e({type:"vector"},d),this._collectResourceTiming=d.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(_)}load(){return l._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new l.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const o=yield Cn(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),o&&(l.e(this,o),o.bounds&&(this.tileBounds=new xt(o.bounds,this.minzoom,this.maxzoom)),this.fire(new l.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.k("data",{dataType:"source",sourceDataType:"content"})))}catch(o){this._tileJSONRequest=null,this.fire(new l.j(o))}})}loaded(){return this._loaded}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}onAdd(o){this.map=o,this.load()}setSourceProperty(o){this._tileJSONRequest&&this._tileJSONRequest.abort(),o(),this.load()}setTiles(o){return this.setSourceProperty(()=>{this._options.tiles=o}),this}setUrl(o){return this.setSourceProperty(()=>{this.url=o,this._options.url=o}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return l.e({},this._options)}loadTile(o){return l._(this,void 0,void 0,function*(){const d=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),v={request:this.map._requestManager.transformRequest(d,"Tile"),uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};v.request.collectResourceTiming=this._collectResourceTiming;let _="RT";if(o.actor&&o.state!=="expired"){if(o.state==="loading")return new Promise((E,O)=>{o.reloadPromise={resolve:E,reject:O}})}else o.actor=this.dispatcher.getActor(),_="LT";o.abortController=new AbortController;try{const E=yield o.actor.sendAsync({type:_,data:v},o.abortController);if(delete o.abortController,o.aborted)return;this._afterTileLoadWorkerResponse(o,E)}catch(E){if(delete o.abortController,o.aborted)return;if(E&&E.status!==404)throw E;this._afterTileLoadWorkerResponse(o,null)}})}_afterTileLoadWorkerResponse(o,d){if(d&&d.resourceTiming&&(o.resourceTiming=d.resourceTiming),d&&this.map._refreshExpiredTiles&&o.setExpiryData(d),o.loadVectorData(d,this.map.painter),o.reloadPromise){const v=o.reloadPromise;o.reloadPromise=null,this.loadTile(o).then(v.resolve).catch(v.reject)}}abortTile(o){return l._(this,void 0,void 0,function*(){o.abortController&&(o.abortController.abort(),delete o.abortController),o.actor&&(yield o.actor.sendAsync({type:"AT",data:{uid:o.uid,type:this.type,source:this.id}}))})}unloadTile(o){return l._(this,void 0,void 0,function*(){o.unloadVectorData(),o.actor&&(yield o.actor.sendAsync({type:"RMT",data:{uid:o.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class mt extends l.E{constructor(o,d,v,_){super(),this.id=o,this.dispatcher=v,this.setEventedParent(_),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=l.e({type:"raster"},d),l.e(this,l.M(d,["url","scheme","tileSize"]))}load(){return l._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new l.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const o=yield Cn(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,o&&(l.e(this,o),o.bounds&&(this.tileBounds=new xt(o.bounds,this.minzoom,this.maxzoom)),this.fire(new l.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.k("data",{dataType:"source",sourceDataType:"content"})))}catch(o){this._tileJSONRequest=null,this.fire(new l.j(o))}})}loaded(){return this._loaded}onAdd(o){this.map=o,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(o){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),o(),this.load()}setTiles(o){return this.setSourceProperty(()=>{this._options.tiles=o}),this}setUrl(o){return this.setSourceProperty(()=>{this.url=o,this._options.url=o}),this}serialize(){return l.e({},this._options)}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}loadTile(o){return l._(this,void 0,void 0,function*(){const d=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);o.abortController=new AbortController;try{const v=yield B.getImage(this.map._requestManager.transformRequest(d,"Tile"),o.abortController,this.map._refreshExpiredTiles);if(delete o.abortController,o.aborted)return void(o.state="unloaded");if(v&&v.data){this.map._refreshExpiredTiles&&v.cacheControl&&v.expires&&o.setExpiryData({cacheControl:v.cacheControl,expires:v.expires});const _=this.map.painter.context,E=_.gl,O=v.data;o.texture=this.map.painter.getTileTexture(O.width),o.texture?o.texture.update(O,{useMipmap:!0}):(o.texture=new se(_,O,E.RGBA,{useMipmap:!0}),o.texture.bind(E.LINEAR,E.CLAMP_TO_EDGE,E.LINEAR_MIPMAP_NEAREST)),o.state="loaded"}}catch(v){if(delete o.abortController,o.aborted)o.state="unloaded";else if(v)throw o.state="errored",v}})}abortTile(o){return l._(this,void 0,void 0,function*(){o.abortController&&(o.abortController.abort(),delete o.abortController)})}unloadTile(o){return l._(this,void 0,void 0,function*(){o.texture&&this.map.painter.saveTileTexture(o.texture)})}hasTransition(){return!1}}class ve extends mt{constructor(o,d,v,_){super(o,d,v,_),this.type="raster-dem",this.maxzoom=22,this._options=l.e({type:"raster-dem"},d),this.encoding=d.encoding||"mapbox",this.redFactor=d.redFactor,this.greenFactor=d.greenFactor,this.blueFactor=d.blueFactor,this.baseShift=d.baseShift}loadTile(o){return l._(this,void 0,void 0,function*(){const d=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),v=this.map._requestManager.transformRequest(d,"Tile");o.neighboringTiles=this._getNeighboringTiles(o.tileID),o.abortController=new AbortController;try{const _=yield B.getImage(v,o.abortController,this.map._refreshExpiredTiles);if(delete o.abortController,o.aborted)return void(o.state="unloaded");if(_&&_.data){const E=_.data;this.map._refreshExpiredTiles&&_.cacheControl&&_.expires&&o.setExpiryData({cacheControl:_.cacheControl,expires:_.expires});const O=l.b(E)&&l.U()?E:yield this.readImageNow(E),z={type:this.type,uid:o.uid,source:this.id,rawImageData:O,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!o.actor||o.state==="expired"){o.actor=this.dispatcher.getActor();const V=yield o.actor.sendAsync({type:"LDT",data:z});o.dem=V,o.needsHillshadePrepare=!0,o.needsTerrainPrepare=!0,o.state="loaded"}}}catch(_){if(delete o.abortController,o.aborted)o.state="unloaded";else if(_)throw o.state="errored",_}})}readImageNow(o){return l._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&l.V()){const d=o.width+2,v=o.height+2;try{return new l.R({width:d,height:v},yield l.W(o,-1,-1,d,v))}catch{}}return S.getImageData(o,1)})}_getNeighboringTiles(o){const d=o.canonical,v=Math.pow(2,d.z),_=(d.x-1+v)%v,E=d.x===0?o.wrap-1:o.wrap,O=(d.x+1+v)%v,z=d.x+1===v?o.wrap+1:o.wrap,V={};return V[new l.S(o.overscaledZ,E,d.z,_,d.y).key]={backfilled:!1},V[new l.S(o.overscaledZ,z,d.z,O,d.y).key]={backfilled:!1},d.y>0&&(V[new l.S(o.overscaledZ,E,d.z,_,d.y-1).key]={backfilled:!1},V[new l.S(o.overscaledZ,o.wrap,d.z,d.x,d.y-1).key]={backfilled:!1},V[new l.S(o.overscaledZ,z,d.z,O,d.y-1).key]={backfilled:!1}),d.y+1<v&&(V[new l.S(o.overscaledZ,E,d.z,_,d.y+1).key]={backfilled:!1},V[new l.S(o.overscaledZ,o.wrap,d.z,d.x,d.y+1).key]={backfilled:!1},V[new l.S(o.overscaledZ,z,d.z,O,d.y+1).key]={backfilled:!1}),V}unloadTile(o){return l._(this,void 0,void 0,function*(){o.demTexture&&this.map.painter.saveTileTexture(o.demTexture),o.fbo&&(o.fbo.destroy(),delete o.fbo),o.dem&&delete o.dem,delete o.neighboringTiles,o.state="unloaded",o.actor&&(yield o.actor.sendAsync({type:"RDT",data:{type:this.type,uid:o.uid,source:this.id}}))})}}class re extends l.E{constructor(o,d,v,_){super(),this.id=o,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=v.getActor(),this.setEventedParent(_),this._data=d.data,this._options=l.e({},d),this._collectResourceTiming=d.collectResourceTiming,d.maxzoom!==void 0&&(this.maxzoom=d.maxzoom),d.type&&(this.type=d.type),d.attribution&&(this.attribution=d.attribution),this.promoteId=d.promoteId;const E=l.X/this.tileSize;this.workerOptions=l.e({source:this.id,cluster:d.cluster||!1,geojsonVtOptions:{buffer:(d.buffer!==void 0?d.buffer:128)*E,tolerance:(d.tolerance!==void 0?d.tolerance:.375)*E,extent:l.X,maxZoom:this.maxzoom,lineMetrics:d.lineMetrics||!1,generateId:d.generateId||!1},superclusterOptions:{maxZoom:d.clusterMaxZoom!==void 0?d.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,d.clusterMinPoints||2),extent:l.X,radius:(d.clusterRadius||50)*E,log:!1,generateId:d.generateId||!1},clusterProperties:d.clusterProperties,filter:d.filter},d.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}load(){return l._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(o){this.map=o,this.load()}setData(o){return this._data=o,this._updateWorkerData(),this}updateData(o){return this._updateWorkerData(o),this}getData(){return l._(this,void 0,void 0,function*(){const o=l.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:o})})}setClusterOptions(o){return this.workerOptions.cluster=o.cluster,o&&(o.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=o.clusterRadius),o.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=o.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(o){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:o,source:this.id}})}getClusterChildren(o){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:o,source:this.id}})}getClusterLeaves(o,d,v){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:o,limit:d,offset:v}})}_updateWorkerData(o){return l._(this,void 0,void 0,function*(){const d=l.e({type:this.type},this.workerOptions);o?d.dataDiff=o:typeof this._data=="string"?(d.request=this.map._requestManager.transformRequest(S.resolveURL(this._data),"Source"),d.request.collectResourceTiming=this._collectResourceTiming):d.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new l.k("dataloading",{dataType:"source"}));try{const v=yield this.actor.sendAsync({type:"LD",data:d});if(this._pendingLoads--,this._removed||v.abandoned)return void this.fire(new l.k("dataabort",{dataType:"source"}));let _=null;v.resourceTiming&&v.resourceTiming[this.id]&&(_=v.resourceTiming[this.id].slice(0));const E={dataType:"source"};this._collectResourceTiming&&_&&_.length>0&&l.e(E,{resourceTiming:_}),this.fire(new l.k("data",Object.assign(Object.assign({},E),{sourceDataType:"metadata"}))),this.fire(new l.k("data",Object.assign(Object.assign({},E),{sourceDataType:"content"})))}catch(v){if(this._pendingLoads--,this._removed)return void this.fire(new l.k("dataabort",{dataType:"source"}));this.fire(new l.j(v))}})}loaded(){return this._pendingLoads===0}loadTile(o){return l._(this,void 0,void 0,function*(){const d=o.actor?"RT":"LT";o.actor=this.actor;const v={type:this.type,uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};o.abortController=new AbortController;const _=yield this.actor.sendAsync({type:d,data:v},o.abortController);delete o.abortController,o.unloadVectorData(),o.aborted||o.loadVectorData(_,this.map.painter,d==="RT")})}abortTile(o){return l._(this,void 0,void 0,function*(){o.abortController&&(o.abortController.abort(),delete o.abortController),o.aborted=!0})}unloadTile(o){return l._(this,void 0,void 0,function*(){o.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:o.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return l.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var Xe=l.Y([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Ge extends l.E{constructor(o,d,v,_){super(),this.id=o,this.dispatcher=v,this.coordinates=d.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(_),this.options=d}load(o){return l._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new l.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const d=yield B.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,d&&d.data&&(this.image=d.data,o&&(this.coordinates=o),this._finishLoading())}catch(d){this._request=null,this._loaded=!0,this.fire(new l.j(d))}})}loaded(){return this._loaded}updateImage(o){return o.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=o.url,this.load(o.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new l.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(o){this.map=o,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(o){this.coordinates=o;const d=o.map(l.Z.fromLngLat);this.tileID=function(_){let E=1/0,O=1/0,z=-1/0,V=-1/0;for(const ce of _)E=Math.min(E,ce.x),O=Math.min(O,ce.y),z=Math.max(z,ce.x),V=Math.max(V,ce.y);const H=Math.max(z-E,V-O),J=Math.max(0,Math.floor(-Math.log(H)/Math.LN2)),Q=Math.pow(2,J);return new l.a1(J,Math.floor((E+z)/2*Q),Math.floor((O+V)/2*Q))}(d),this.minzoom=this.maxzoom=this.tileID.z;const v=d.map(_=>this.tileID.getTilePoint(_)._round());return this._boundsArray=new l.$,this._boundsArray.emplaceBack(v[0].x,v[0].y,0,0),this._boundsArray.emplaceBack(v[1].x,v[1].y,l.X,0),this._boundsArray.emplaceBack(v[3].x,v[3].y,0,l.X),this._boundsArray.emplaceBack(v[2].x,v[2].y,l.X,l.X),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new l.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const o=this.map.painter.context,d=o.gl;this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,Xe.members)),this.boundsSegments||(this.boundsSegments=l.a0.simpleSegment(0,0,4,2)),this.texture||(this.texture=new se(o,this.image,d.RGBA),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE));let v=!1;for(const _ in this.tiles){const E=this.tiles[_];E.state!=="loaded"&&(E.state="loaded",E.texture=this.texture,v=!0)}v&&this.fire(new l.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(o){return l._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={}):o.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class st extends Ge{constructor(o,d,v,_){super(o,d,v,_),this.roundZoom=!0,this.type="video",this.options=d}load(){return l._(this,void 0,void 0,function*(){this._loaded=!1;const o=this.options;this.urls=[];for(const d of o.urls)this.urls.push(this.map._requestManager.transformRequest(d,"Source").url);try{const d=yield l.a3(this.urls);if(this._loaded=!0,!d)return;this.video=d,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(d){this.fire(new l.j(d))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(o){if(this.video){const d=this.video.seekable;o<d.start(0)||o>d.end(0)?this.fire(new l.j(new l.a2(`sources.${this.id}`,null,`Playback for this video can be set only between the ${d.start(0)} and ${d.end(0)}-second mark.`))):this.video.currentTime=o}}getVideo(){return this.video}onAdd(o){this.map||(this.map=o,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const o=this.map.painter.context,d=o.gl;this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,Xe.members)),this.boundsSegments||(this.boundsSegments=l.a0.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE),d.texSubImage2D(d.TEXTURE_2D,0,0,0,d.RGBA,d.UNSIGNED_BYTE,this.video)):(this.texture=new se(o,this.video,d.RGBA),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE));let v=!1;for(const _ in this.tiles){const E=this.tiles[_];E.state!=="loaded"&&(E.state="loaded",E.texture=this.texture,v=!0)}v&&this.fire(new l.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class ft extends Ge{constructor(o,d,v,_){super(o,d,v,_),d.coordinates?Array.isArray(d.coordinates)&&d.coordinates.length===4&&!d.coordinates.some(E=>!Array.isArray(E)||E.length!==2||E.some(O=>typeof O!="number"))||this.fire(new l.j(new l.a2(`sources.${o}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new l.j(new l.a2(`sources.${o}`,null,'missing required property "coordinates"'))),d.animate&&typeof d.animate!="boolean"&&this.fire(new l.j(new l.a2(`sources.${o}`,null,'optional "animate" property must be a boolean value'))),d.canvas?typeof d.canvas=="string"||d.canvas instanceof HTMLCanvasElement||this.fire(new l.j(new l.a2(`sources.${o}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new l.j(new l.a2(`sources.${o}`,null,'missing required property "canvas"'))),this.options=d,this.animate=d.animate===void 0||d.animate}load(){return l._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new l.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(o){this.map=o,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let o=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,o=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,o=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const d=this.map.painter.context,v=d.gl;this.boundsBuffer||(this.boundsBuffer=d.createVertexBuffer(this._boundsArray,Xe.members)),this.boundsSegments||(this.boundsSegments=l.a0.simpleSegment(0,0,4,2)),this.texture?(o||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new se(d,this.canvas,v.RGBA,{premultiply:!0});let _=!1;for(const E in this.tiles){const O=this.tiles[E];O.state!=="loaded"&&(O.state="loaded",O.texture=this.texture,_=!0)}_&&this.fire(new l.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const o of[this.canvas.width,this.canvas.height])if(isNaN(o)||o<=0)return!0;return!1}}const Ht={},$t=M=>{switch(M){case"geojson":return re;case"image":return Ge;case"raster":return mt;case"raster-dem":return ve;case"vector":return Pt;case"video":return st;case"canvas":return ft}return Ht[M]},it="RTLPluginLoaded";class On extends l.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=Kn()}_syncState(o){return this.status=o,this.dispatcher.broadcast("SRPS",{pluginStatus:o,pluginURL:this.url}).catch(d=>{throw this.status="error",d})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(o){return l._(this,arguments,void 0,function*(d,v=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=S.resolveURL(d),!this.url)throw new Error(`requested url ${d} is invalid`);if(this.status==="unavailable"){if(!v)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return l._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new l.k(it))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Nt=null;function on(){return Nt||(Nt=new On),Nt}class Wn{constructor(o,d){this.timeAdded=0,this.fadeEndTime=0,this.tileID=o,this.uid=l.a4(),this.uses=0,this.tileSize=d,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(o){const d=o+this.timeAdded;d<this.fadeEndTime||(this.fadeEndTime=d)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(o){this.demTexture&&o.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(o,d,v){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",o){o.featureIndex&&(this.latestFeatureIndex=o.featureIndex,o.rawTileData?(this.latestRawTileData=o.rawTileData,this.latestFeatureIndex.rawTileData=o.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=o.collisionBoxArray,this.buckets=function(_,E){const O={};if(!E)return O;for(const z of _){const V=z.layerIds.map(H=>E.getLayer(H)).filter(Boolean);if(V.length!==0){z.layers=V,z.stateDependentLayerIds&&(z.stateDependentLayers=z.stateDependentLayerIds.map(H=>V.filter(J=>J.id===H)[0]));for(const H of V)O[H.id]=z}}return O}(o.buckets,d.style),this.hasSymbolBuckets=!1;for(const _ in this.buckets){const E=this.buckets[_];if(E instanceof l.a6){if(this.hasSymbolBuckets=!0,!v)break;E.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const _ in this.buckets){const E=this.buckets[_];if(E instanceof l.a6&&E.hasRTLText){this.hasRTLText=!0,on().lazyLoad();break}}this.queryPadding=0;for(const _ in this.buckets){const E=this.buckets[_];this.queryPadding=Math.max(this.queryPadding,d.style.getLayer(_).queryRadius(E))}o.imageAtlas&&(this.imageAtlas=o.imageAtlas),o.glyphAtlasImage&&(this.glyphAtlasImage=o.glyphAtlasImage)}else this.collisionBoxArray=new l.a5}unloadVectorData(){for(const o in this.buckets)this.buckets[o].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(o){return this.buckets[o.id]}upload(o){for(const v in this.buckets){const _=this.buckets[v];_.uploadPending()&&_.upload(o)}const d=o.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new se(o,this.imageAtlas.image,d.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new se(o,this.glyphAtlasImage,d.ALPHA),this.glyphAtlasImage=null)}prepare(o){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(o,this.imageAtlasTexture)}queryRenderedFeatures(o,d,v,_,E,O,z,V,H,J){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:_,cameraQueryGeometry:E,scale:O,tileSize:this.tileSize,pixelPosMatrix:J,transform:V,params:z,queryPadding:this.queryPadding*H},o,d,v):{}}querySourceFeatures(o,d){const v=this.latestFeatureIndex;if(!v||!v.rawTileData)return;const _=v.loadVTLayers(),E=d&&d.sourceLayer?d.sourceLayer:"",O=_._geojsonTileLayer||_[E];if(!O)return;const z=l.a7(d&&d.filter),{z:V,x:H,y:J}=this.tileID.canonical,Q={z:V,x:H,y:J};for(let ce=0;ce<O.length;ce++){const fe=O.feature(ce);if(z.needGeometry){const Te=l.a8(fe,!0);if(!z.filter(new l.a9(this.tileID.overscaledZ),Te,this.tileID.canonical))continue}else if(!z.filter(new l.a9(this.tileID.overscaledZ),fe))continue;const be=v.getId(fe,E),Pe=new l.aa(fe,V,H,J,be);Pe.tile=Q,o.push(Pe)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(o){const d=this.expirationTime;if(o.cacheControl){const v=l.ab(o.cacheControl);v["max-age"]&&(this.expirationTime=Date.now()+1e3*v["max-age"])}else o.expires&&(this.expirationTime=new Date(o.expires).getTime());if(this.expirationTime){const v=Date.now();let _=!1;if(this.expirationTime>v)_=!1;else if(d)if(this.expirationTime<d)_=!0;else{const E=this.expirationTime-d;E?this.expirationTime=v+Math.max(E,3e4):_=!0}else _=!0;_?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(o,d){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(o).length===0)return;const v=this.latestFeatureIndex.loadVTLayers();for(const _ in this.buckets){if(!d.style.hasLayer(_))continue;const E=this.buckets[_],O=E.layers[0].sourceLayer||"_geojsonTileLayer",z=v[O],V=o[O];if(!z||!V||Object.keys(V).length===0)continue;E.update(V,z,this.imageAtlas&&this.imageAtlas.patternPositions||{});const H=d&&d.style&&d.style.getLayer(_);H&&(this.queryPadding=Math.max(this.queryPadding,H.queryRadius(E)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<S.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(o){this.symbolFadeHoldUntil=S.now()+o}setDependencies(o,d){const v={};for(const _ of d)v[_]=!0;this.dependencies[o]=v}hasDependency(o,d){for(const v of o){const _=this.dependencies[v];if(_){for(const E of d)if(_[E])return!0}}return!1}}class yt{constructor(o,d){this.max=o,this.onRemove=d,this.reset()}reset(){for(const o in this.data)for(const d of this.data[o])d.timeout&&clearTimeout(d.timeout),this.onRemove(d.value);return this.data={},this.order=[],this}add(o,d,v){const _=o.wrapped().key;this.data[_]===void 0&&(this.data[_]=[]);const E={value:d,timeout:void 0};if(v!==void 0&&(E.timeout=setTimeout(()=>{this.remove(o,E)},v)),this.data[_].push(E),this.order.push(_),this.order.length>this.max){const O=this._getAndRemoveByKey(this.order[0]);O&&this.onRemove(O)}return this}has(o){return o.wrapped().key in this.data}getAndRemove(o){return this.has(o)?this._getAndRemoveByKey(o.wrapped().key):null}_getAndRemoveByKey(o){const d=this.data[o].shift();return d.timeout&&clearTimeout(d.timeout),this.data[o].length===0&&delete this.data[o],this.order.splice(this.order.indexOf(o),1),d.value}getByKey(o){const d=this.data[o];return d?d[0].value:null}get(o){return this.has(o)?this.data[o.wrapped().key][0].value:null}remove(o,d){if(!this.has(o))return this;const v=o.wrapped().key,_=d===void 0?0:this.data[v].indexOf(d),E=this.data[v][_];return this.data[v].splice(_,1),E.timeout&&clearTimeout(E.timeout),this.data[v].length===0&&delete this.data[v],this.onRemove(E.value),this.order.splice(this.order.indexOf(v),1),this}setMaxSize(o){for(this.max=o;this.order.length>this.max;){const d=this._getAndRemoveByKey(this.order[0]);d&&this.onRemove(d)}return this}filter(o){const d=[];for(const v in this.data)for(const _ of this.data[v])o(_.value)||d.push(_);for(const v of d)this.remove(v.value.tileID,v)}}class Tt{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(o,d,v){const _=String(d);if(this.stateChanges[o]=this.stateChanges[o]||{},this.stateChanges[o][_]=this.stateChanges[o][_]||{},l.e(this.stateChanges[o][_],v),this.deletedStates[o]===null){this.deletedStates[o]={};for(const E in this.state[o])E!==_&&(this.deletedStates[o][E]=null)}else if(this.deletedStates[o]&&this.deletedStates[o][_]===null){this.deletedStates[o][_]={};for(const E in this.state[o][_])v[E]||(this.deletedStates[o][_][E]=null)}else for(const E in v)this.deletedStates[o]&&this.deletedStates[o][_]&&this.deletedStates[o][_][E]===null&&delete this.deletedStates[o][_][E]}removeFeatureState(o,d,v){if(this.deletedStates[o]===null)return;const _=String(d);if(this.deletedStates[o]=this.deletedStates[o]||{},v&&d!==void 0)this.deletedStates[o][_]!==null&&(this.deletedStates[o][_]=this.deletedStates[o][_]||{},this.deletedStates[o][_][v]=null);else if(d!==void 0)if(this.stateChanges[o]&&this.stateChanges[o][_])for(v in this.deletedStates[o][_]={},this.stateChanges[o][_])this.deletedStates[o][_][v]=null;else this.deletedStates[o][_]=null;else this.deletedStates[o]=null}getState(o,d){const v=String(d),_=l.e({},(this.state[o]||{})[v],(this.stateChanges[o]||{})[v]);if(this.deletedStates[o]===null)return{};if(this.deletedStates[o]){const E=this.deletedStates[o][d];if(E===null)return{};for(const O in E)delete _[O]}return _}initializeTileState(o,d){o.setFeatureState(this.state,d)}coalesceChanges(o,d){const v={};for(const _ in this.stateChanges){this.state[_]=this.state[_]||{};const E={};for(const O in this.stateChanges[_])this.state[_][O]||(this.state[_][O]={}),l.e(this.state[_][O],this.stateChanges[_][O]),E[O]=this.state[_][O];v[_]=E}for(const _ in this.deletedStates){this.state[_]=this.state[_]||{};const E={};if(this.deletedStates[_]===null)for(const O in this.state[_])E[O]={},this.state[_][O]={};else for(const O in this.deletedStates[_]){if(this.deletedStates[_][O]===null)this.state[_][O]={};else for(const z of Object.keys(this.deletedStates[_][O]))delete this.state[_][O][z];E[O]=this.state[_][O]}v[_]=v[_]||{},l.e(v[_],E)}if(this.stateChanges={},this.deletedStates={},Object.keys(v).length!==0)for(const _ in o)o[_].setFeatureState(v,d)}}class Vt extends l.E{constructor(o,d,v){super(),this.id=o,this.dispatcher=v,this.on("data",_=>this._dataHandler(_)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((_,E,O,z)=>{const V=new($t(E.type))(_,E,O,z);if(V.id!==_)throw new Error(`Expected Source id to be ${_} instead of ${V.id}`);return V})(o,d,v,this),this._tiles={},this._cache=new yt(0,_=>this._unloadTile(_)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Tt,this._didEmitContent=!1,this._updated=!1}onAdd(o){this.map=o,this._maxTileCacheSize=o?o._maxTileCacheSize:null,this._maxTileCacheZoomLevels=o?o._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(o)}onRemove(o){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(o)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const o in this._tiles){const d=this._tiles[o];if(d.state!=="loaded"&&d.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(o,d,v){return l._(this,void 0,void 0,function*(){try{yield this._source.loadTile(o),this._tileLoaded(o,d,v)}catch(_){o.state="errored",_.status!==404?this._source.fire(new l.j(_,{tile:o})):this.update(this.transform,this.terrain)}})}_unloadTile(o){this._source.unloadTile&&this._source.unloadTile(o)}_abortTile(o){this._source.abortTile&&this._source.abortTile(o),this._source.fire(new l.k("dataabort",{tile:o,coord:o.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(o){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const d in this._tiles){const v=this._tiles[d];v.upload(o),v.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(o=>o.tileID).sort(kn).map(o=>o.key)}getRenderableIds(o){const d=[];for(const v in this._tiles)this._isIdRenderable(v,o)&&d.push(this._tiles[v]);return o?d.sort((v,_)=>{const E=v.tileID,O=_.tileID,z=new l.P(E.canonical.x,E.canonical.y)._rotate(this.transform.angle),V=new l.P(O.canonical.x,O.canonical.y)._rotate(this.transform.angle);return E.overscaledZ-O.overscaledZ||V.y-z.y||V.x-z.x}).map(v=>v.tileID.key):d.map(v=>v.tileID).sort(kn).map(v=>v.key)}hasRenderableParent(o){const d=this.findLoadedParent(o,0);return!!d&&this._isIdRenderable(d.tileID.key)}_isIdRenderable(o,d){return this._tiles[o]&&this._tiles[o].hasData()&&!this._coveredTiles[o]&&(d||!this._tiles[o].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const o in this._tiles)this._tiles[o].state!=="errored"&&this._reloadTile(o,"reloading")}}_reloadTile(o,d){return l._(this,void 0,void 0,function*(){const v=this._tiles[o];v&&(v.state!=="loading"&&(v.state=d),yield this._loadTile(v,o,d))})}_tileLoaded(o,d,v){o.timeAdded=S.now(),v==="expired"&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(d,o),this.getSource().type==="raster-dem"&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),o.aborted||this._source.fire(new l.k("data",{dataType:"source",tile:o,coord:o.tileID}))}_backfillDEM(o){const d=this.getRenderableIds();for(let _=0;_<d.length;_++){const E=d[_];if(o.neighboringTiles&&o.neighboringTiles[E]){const O=this.getTileByID(E);v(o,O),v(O,o)}}function v(_,E){_.needsHillshadePrepare=!0,_.needsTerrainPrepare=!0;let O=E.tileID.canonical.x-_.tileID.canonical.x;const z=E.tileID.canonical.y-_.tileID.canonical.y,V=Math.pow(2,_.tileID.canonical.z),H=E.tileID.key;O===0&&z===0||Math.abs(z)>1||(Math.abs(O)>1&&(Math.abs(O+V)===1?O+=V:Math.abs(O-V)===1&&(O-=V)),E.dem&&_.dem&&(_.dem.backfillBorder(E.dem,O,z),_.neighboringTiles&&_.neighboringTiles[H]&&(_.neighboringTiles[H].backfilled=!0)))}}getTile(o){return this.getTileByID(o.key)}getTileByID(o){return this._tiles[o]}_retainLoadedChildren(o,d,v,_){for(const E in this._tiles){let O=this._tiles[E];if(_[E]||!O.hasData()||O.tileID.overscaledZ<=d||O.tileID.overscaledZ>v)continue;let z=O.tileID;for(;O&&O.tileID.overscaledZ>d+1;){const H=O.tileID.scaledTo(O.tileID.overscaledZ-1);O=this._tiles[H.key],O&&O.hasData()&&(z=H)}let V=z;for(;V.overscaledZ>d;)if(V=V.scaledTo(V.overscaledZ-1),o[V.key]){_[z.key]=z;break}}}findLoadedParent(o,d){if(o.key in this._loadedParentTiles){const v=this._loadedParentTiles[o.key];return v&&v.tileID.overscaledZ>=d?v:null}for(let v=o.overscaledZ-1;v>=d;v--){const _=o.scaledTo(v),E=this._getLoadedTile(_);if(E)return E}}findLoadedSibling(o){return this._getLoadedTile(o)}_getLoadedTile(o){const d=this._tiles[o.key];return d&&d.hasData()?d:this._cache.getByKey(o.wrapped().key)}updateCacheSize(o){const d=Math.ceil(o.width/this._source.tileSize)+1,v=Math.ceil(o.height/this._source.tileSize)+1,_=Math.floor(d*v*(this._maxTileCacheZoomLevels===null?l.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),E=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,_):_;this._cache.setMaxSize(E)}handleWrapJump(o){const d=Math.round((o-(this._prevLng===void 0?o:this._prevLng))/360);if(this._prevLng=o,d){const v={};for(const _ in this._tiles){const E=this._tiles[_];E.tileID=E.tileID.unwrapTo(E.tileID.wrap+d),v[E.tileID.key]=E}this._tiles=v;for(const _ in this._timers)clearTimeout(this._timers[_]),delete this._timers[_];for(const _ in this._tiles)this._setTileReloadTimer(_,this._tiles[_])}}_updateCoveredAndRetainedTiles(o,d,v,_,E,O){const z={},V={},H=Object.keys(o),J=S.now();for(const Q of H){const ce=o[Q],fe=this._tiles[Q];if(!fe||fe.fadeEndTime!==0&&fe.fadeEndTime<=J)continue;const be=this.findLoadedParent(ce,d),Pe=this.findLoadedSibling(ce),Te=be||Pe||null;Te&&(this._addTile(Te.tileID),z[Te.tileID.key]=Te.tileID),V[Q]=ce}this._retainLoadedChildren(V,_,v,o);for(const Q in z)o[Q]||(this._coveredTiles[Q]=!0,o[Q]=z[Q]);if(O){const Q={},ce={};for(const fe of E)this._tiles[fe.key].hasData()?Q[fe.key]=fe:ce[fe.key]=fe;for(const fe in ce){const be=ce[fe].children(this._source.maxzoom);this._tiles[be[0].key]&&this._tiles[be[1].key]&&this._tiles[be[2].key]&&this._tiles[be[3].key]&&(Q[be[0].key]=o[be[0].key]=be[0],Q[be[1].key]=o[be[1].key]=be[1],Q[be[2].key]=o[be[2].key]=be[2],Q[be[3].key]=o[be[3].key]=be[3],delete ce[fe])}for(const fe in ce){const be=ce[fe],Pe=this.findLoadedParent(be,this._source.minzoom),Te=this.findLoadedSibling(be),ke=Pe||Te||null;if(ke){Q[ke.tileID.key]=o[ke.tileID.key]=ke.tileID;for(const Ve in Q)Q[Ve].isChildOf(ke.tileID)&&delete Q[Ve]}}for(const fe in this._tiles)Q[fe]||(this._coveredTiles[fe]=!0)}}update(o,d){if(!this._sourceLoaded||this._paused)return;let v;this.transform=o,this.terrain=d,this.updateCacheSize(o),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?v=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(J=>new l.S(J.canonical.z,J.wrap,J.canonical.z,J.canonical.x,J.canonical.y)):(v=o.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:d}),this._source.hasTile&&(v=v.filter(J=>this._source.hasTile(J)))):v=[];const _=o.coveringZoomLevel(this._source),E=Math.max(_-Vt.maxOverzooming,this._source.minzoom),O=Math.max(_+Vt.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const J={};for(const Q of v)if(Q.canonical.z>this._source.minzoom){const ce=Q.scaledTo(Q.canonical.z-1);J[ce.key]=ce;const fe=Q.scaledTo(Math.max(this._source.minzoom,Math.min(Q.canonical.z,5)));J[fe.key]=fe}v=v.concat(Object.values(J))}const z=v.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,z&&this.fire(new l.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const V=this._updateRetainedTiles(v,_);ii(this._source.type)&&this._updateCoveredAndRetainedTiles(V,E,O,_,v,d);for(const J in V)this._tiles[J].clearFadeHold();const H=l.ac(this._tiles,V);for(const J of H){const Q=this._tiles[J];Q.hasSymbolBuckets&&!Q.holdingForFade()?Q.setHoldDuration(this.map._fadeDuration):Q.hasSymbolBuckets&&!Q.symbolFadeFinished()||this._removeTile(J)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const o in this._tiles)this._tiles[o].holdingForFade()&&this._removeTile(o)}_updateRetainedTiles(o,d){var v;const _={},E={},O=Math.max(d-Vt.maxOverzooming,this._source.minzoom),z=Math.max(d+Vt.maxUnderzooming,this._source.minzoom),V={};for(const H of o){const J=this._addTile(H);_[H.key]=H,J.hasData()||d<this._source.maxzoom&&(V[H.key]=H)}this._retainLoadedChildren(V,d,z,_);for(const H of o){let J=this._tiles[H.key];if(J.hasData())continue;if(d+1>this._source.maxzoom){const ce=H.children(this._source.maxzoom)[0],fe=this.getTile(ce);if(fe&&fe.hasData()){_[ce.key]=ce;continue}}else{const ce=H.children(this._source.maxzoom);if(_[ce[0].key]&&_[ce[1].key]&&_[ce[2].key]&&_[ce[3].key])continue}let Q=J.wasRequested();for(let ce=H.overscaledZ-1;ce>=O;--ce){const fe=H.scaledTo(ce);if(E[fe.key])break;if(E[fe.key]=!0,J=this.getTile(fe),!J&&Q&&(J=this._addTile(fe)),J){const be=J.hasData();if((be||!(!((v=this.map)===null||v===void 0)&&v.cancelPendingTileRequestsWhileZooming)||Q)&&(_[fe.key]=fe),Q=J.wasRequested(),be)break}}}return _}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const o in this._tiles){const d=[];let v,_=this._tiles[o].tileID;for(;_.overscaledZ>0;){if(_.key in this._loadedParentTiles){v=this._loadedParentTiles[_.key];break}d.push(_.key);const E=_.scaledTo(_.overscaledZ-1);if(v=this._getLoadedTile(E),v)break;_=E}for(const E of d)this._loadedParentTiles[E]=v}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const o in this._tiles){const d=this._tiles[o].tileID,v=this._getLoadedTile(d);this._loadedSiblingTiles[d.key]=v}}_addTile(o){let d=this._tiles[o.key];if(d)return d;d=this._cache.getAndRemove(o),d&&(this._setTileReloadTimer(o.key,d),d.tileID=o,this._state.initializeTileState(d,this.map?this.map.painter:null),this._cacheTimers[o.key]&&(clearTimeout(this._cacheTimers[o.key]),delete this._cacheTimers[o.key],this._setTileReloadTimer(o.key,d)));const v=d;return d||(d=new Wn(o,this._source.tileSize*o.overscaleFactor()),this._loadTile(d,o.key,d.state)),d.uses++,this._tiles[o.key]=d,v||this._source.fire(new l.k("dataloading",{tile:d,coord:d.tileID,dataType:"source"})),d}_setTileReloadTimer(o,d){o in this._timers&&(clearTimeout(this._timers[o]),delete this._timers[o]);const v=d.getExpiryTimeout();v&&(this._timers[o]=setTimeout(()=>{this._reloadTile(o,"expired"),delete this._timers[o]},v))}_removeTile(o){const d=this._tiles[o];d&&(d.uses--,delete this._tiles[o],this._timers[o]&&(clearTimeout(this._timers[o]),delete this._timers[o]),d.uses>0||(d.hasData()&&d.state!=="reloading"?this._cache.add(d.tileID,d,d.getExpiryTimeout()):(d.aborted=!0,this._abortTile(d),this._unloadTile(d))))}_dataHandler(o){const d=o.sourceDataType;o.dataType==="source"&&d==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&o.dataType==="source"&&d==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const o in this._tiles)this._removeTile(o);this._cache.reset()}tilesIn(o,d,v){const _=[],E=this.transform;if(!E)return _;const O=v?E.getCameraQueryGeometry(o):o,z=o.map(be=>E.pointCoordinate(be,this.terrain)),V=O.map(be=>E.pointCoordinate(be,this.terrain)),H=this.getIds();let J=1/0,Q=1/0,ce=-1/0,fe=-1/0;for(const be of V)J=Math.min(J,be.x),Q=Math.min(Q,be.y),ce=Math.max(ce,be.x),fe=Math.max(fe,be.y);for(let be=0;be<H.length;be++){const Pe=this._tiles[H[be]];if(Pe.holdingForFade())continue;const Te=Pe.tileID,ke=Math.pow(2,E.zoom-Pe.tileID.overscaledZ),Ve=d*Pe.queryPadding*l.X/Pe.tileSize/ke,Ee=[Te.getTilePoint(new l.Z(J,Q)),Te.getTilePoint(new l.Z(ce,fe))];if(Ee[0].x-Ve<l.X&&Ee[0].y-Ve<l.X&&Ee[1].x+Ve>=0&&Ee[1].y+Ve>=0){const qe=z.map(ht=>Te.getTilePoint(ht)),rt=V.map(ht=>Te.getTilePoint(ht));_.push({tile:Pe,tileID:Te,queryGeometry:qe,cameraQueryGeometry:rt,scale:ke})}}return _}getVisibleCoordinates(o){const d=this.getRenderableIds(o).map(v=>this._tiles[v].tileID);for(const v of d)v.posMatrix=this.transform.calculatePosMatrix(v.toUnwrapped());return d}hasTransition(){if(this._source.hasTransition())return!0;if(ii(this._source.type)){const o=S.now();for(const d in this._tiles)if(this._tiles[d].fadeEndTime>=o)return!0}return!1}setFeatureState(o,d,v){this._state.updateState(o=o||"_geojsonTileLayer",d,v)}removeFeatureState(o,d,v){this._state.removeFeatureState(o=o||"_geojsonTileLayer",d,v)}getFeatureState(o,d){return this._state.getState(o=o||"_geojsonTileLayer",d)}setDependencies(o,d,v){const _=this._tiles[o];_&&_.setDependencies(d,v)}reloadTilesForDependencies(o,d){for(const v in this._tiles)this._tiles[v].hasDependency(o,d)&&this._reloadTile(v,"reloading");this._cache.filter(v=>!v.hasDependency(o,d))}}function kn(M,o){const d=Math.abs(2*M.wrap)-+(M.wrap<0),v=Math.abs(2*o.wrap)-+(o.wrap<0);return M.overscaledZ-o.overscaledZ||v-d||o.canonical.y-M.canonical.y||o.canonical.x-M.canonical.x}function ii(M){return M==="raster"||M==="image"||M==="video"}Vt.maxOverzooming=10,Vt.maxUnderzooming=3;class Ne{constructor(o,d){this.reset(o,d)}reset(o,d){this.points=o||[],this._distances=[0];for(let v=1;v<this.points.length;v++)this._distances[v]=this._distances[v-1]+this.points[v].dist(this.points[v-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(d||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(o){if(this.points.length===1)return this.points[0];o=l.ad(o,0,1);let d=1,v=this._distances[d];const _=o*this.paddedLength+this.padding;for(;v<_&&d<this._distances.length;)v=this._distances[++d];const E=d-1,O=this._distances[E],z=v-O,V=z>0?(_-O)/z:0;return this.points[E].mult(1-V).add(this.points[d].mult(V))}}function Gt(M,o){let d=!0;return M==="always"||M!=="never"&&o!=="never"||(d=!1),d}class Et{constructor(o,d,v){const _=this.boxCells=[],E=this.circleCells=[];this.xCellCount=Math.ceil(o/v),this.yCellCount=Math.ceil(d/v);for(let O=0;O<this.xCellCount*this.yCellCount;O++)_.push([]),E.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=o,this.height=d,this.xScale=this.xCellCount/o,this.yScale=this.yCellCount/d,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(o,d,v,_,E){this._forEachCell(d,v,_,E,this._insertBoxCell,this.boxUid++),this.boxKeys.push(o),this.bboxes.push(d),this.bboxes.push(v),this.bboxes.push(_),this.bboxes.push(E)}insertCircle(o,d,v,_){this._forEachCell(d-_,v-_,d+_,v+_,this._insertCircleCell,this.circleUid++),this.circleKeys.push(o),this.circles.push(d),this.circles.push(v),this.circles.push(_)}_insertBoxCell(o,d,v,_,E,O){this.boxCells[E].push(O)}_insertCircleCell(o,d,v,_,E,O){this.circleCells[E].push(O)}_query(o,d,v,_,E,O,z){if(v<0||o>this.width||_<0||d>this.height)return[];const V=[];if(o<=0&&d<=0&&this.width<=v&&this.height<=_){if(E)return[{key:null,x1:o,y1:d,x2:v,y2:_}];for(let H=0;H<this.boxKeys.length;H++)V.push({key:this.boxKeys[H],x1:this.bboxes[4*H],y1:this.bboxes[4*H+1],x2:this.bboxes[4*H+2],y2:this.bboxes[4*H+3]});for(let H=0;H<this.circleKeys.length;H++){const J=this.circles[3*H],Q=this.circles[3*H+1],ce=this.circles[3*H+2];V.push({key:this.circleKeys[H],x1:J-ce,y1:Q-ce,x2:J+ce,y2:Q+ce})}}else this._forEachCell(o,d,v,_,this._queryCell,V,{hitTest:E,overlapMode:O,seenUids:{box:{},circle:{}}},z);return V}query(o,d,v,_){return this._query(o,d,v,_,!1,null)}hitTest(o,d,v,_,E,O){return this._query(o,d,v,_,!0,E,O).length>0}hitTestCircle(o,d,v,_,E){const O=o-v,z=o+v,V=d-v,H=d+v;if(z<0||O>this.width||H<0||V>this.height)return!1;const J=[];return this._forEachCell(O,V,z,H,this._queryCellCircle,J,{hitTest:!0,overlapMode:_,circle:{x:o,y:d,radius:v},seenUids:{box:{},circle:{}}},E),J.length>0}_queryCell(o,d,v,_,E,O,z,V){const{seenUids:H,hitTest:J,overlapMode:Q}=z,ce=this.boxCells[E];if(ce!==null){const be=this.bboxes;for(const Pe of ce)if(!H.box[Pe]){H.box[Pe]=!0;const Te=4*Pe,ke=this.boxKeys[Pe];if(o<=be[Te+2]&&d<=be[Te+3]&&v>=be[Te+0]&&_>=be[Te+1]&&(!V||V(ke))&&(!J||!Gt(Q,ke.overlapMode))&&(O.push({key:ke,x1:be[Te],y1:be[Te+1],x2:be[Te+2],y2:be[Te+3]}),J))return!0}}const fe=this.circleCells[E];if(fe!==null){const be=this.circles;for(const Pe of fe)if(!H.circle[Pe]){H.circle[Pe]=!0;const Te=3*Pe,ke=this.circleKeys[Pe];if(this._circleAndRectCollide(be[Te],be[Te+1],be[Te+2],o,d,v,_)&&(!V||V(ke))&&(!J||!Gt(Q,ke.overlapMode))){const Ve=be[Te],Ee=be[Te+1],qe=be[Te+2];if(O.push({key:ke,x1:Ve-qe,y1:Ee-qe,x2:Ve+qe,y2:Ee+qe}),J)return!0}}}return!1}_queryCellCircle(o,d,v,_,E,O,z,V){const{circle:H,seenUids:J,overlapMode:Q}=z,ce=this.boxCells[E];if(ce!==null){const be=this.bboxes;for(const Pe of ce)if(!J.box[Pe]){J.box[Pe]=!0;const Te=4*Pe,ke=this.boxKeys[Pe];if(this._circleAndRectCollide(H.x,H.y,H.radius,be[Te+0],be[Te+1],be[Te+2],be[Te+3])&&(!V||V(ke))&&!Gt(Q,ke.overlapMode))return O.push(!0),!0}}const fe=this.circleCells[E];if(fe!==null){const be=this.circles;for(const Pe of fe)if(!J.circle[Pe]){J.circle[Pe]=!0;const Te=3*Pe,ke=this.circleKeys[Pe];if(this._circlesCollide(be[Te],be[Te+1],be[Te+2],H.x,H.y,H.radius)&&(!V||V(ke))&&!Gt(Q,ke.overlapMode))return O.push(!0),!0}}}_forEachCell(o,d,v,_,E,O,z,V){const H=this._convertToXCellCoord(o),J=this._convertToYCellCoord(d),Q=this._convertToXCellCoord(v),ce=this._convertToYCellCoord(_);for(let fe=H;fe<=Q;fe++)for(let be=J;be<=ce;be++)if(E.call(this,o,d,v,_,this.xCellCount*be+fe,O,z,V))return}_convertToXCellCoord(o){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(o*this.xScale)))}_convertToYCellCoord(o){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(o*this.yScale)))}_circlesCollide(o,d,v,_,E,O){const z=_-o,V=E-d,H=v+O;return H*H>z*z+V*V}_circleAndRectCollide(o,d,v,_,E,O,z){const V=(O-_)/2,H=Math.abs(o-(_+V));if(H>V+v)return!1;const J=(z-E)/2,Q=Math.abs(d-(E+J));if(Q>J+v)return!1;if(H<=V||Q<=J)return!0;const ce=H-V,fe=Q-J;return ce*ce+fe*fe<=v*v}}function Ct(M,o,d,v,_){const E=l.H();return o?(l.K(E,E,[1/_,1/_,1]),d||l.ae(E,E,v.angle)):l.L(E,v.labelPlaneMatrix,M),E}function Zt(M,o,d,v,_){if(o){const E=l.af(M);return l.K(E,E,[_,_,1]),d||l.ae(E,E,-v.angle),E}return v.glCoordMatrix}function xe(M,o,d){let v;d?(v=[M.x,M.y,d(M.x,M.y),1],l.ag(v,v,o)):(v=[M.x,M.y,0,1],function(E,O,z){const V=O[0],H=O[1];E[0]=z[0]*V+z[4]*H+z[12],E[1]=z[1]*V+z[5]*H+z[13],E[3]=z[3]*V+z[7]*H+z[15]}(v,v,o));const _=v[3];return{point:new l.P(v[0]/_,v[1]/_),signedDistanceFromCamera:_,isOccluded:!1}}function te(M,o){return .5+M/o*.5}function ne(M,o){return M.x>=-o[0]&&M.x<=o[0]&&M.y>=-o[1]&&M.y<=o[1]}function de(M,o,d,v,_,E,O,z,V,H,J,Q,ce,fe,be){const Pe=v?M.textSizeData:M.iconSizeData,Te=l.ah(Pe,d.transform.zoom),ke=[256/d.width*2+1,256/d.height*2+1],Ve=v?M.text.dynamicLayoutVertexArray:M.icon.dynamicLayoutVertexArray;Ve.clear();const Ee=M.lineVertexArray,qe=v?M.text.placedSymbolArray:M.icon.placedSymbolArray,rt=d.transform.width/d.transform.height;let ht=!1;for(let At=0;At<qe.length;At++){const Ft=qe.get(At);if(Ft.hidden||Ft.writingMode===l.ai.vertical&&!ht){Sn(Ft.numGlyphs,Ve);continue}ht=!1;const an=xe(new l.P(Ft.anchorX,Ft.anchorY),o,be);if(!ne(an.point,ke)){Sn(Ft.numGlyphs,Ve);continue}const sn=te(d.transform.cameraToCenterDistance,an.signedDistanceFromCamera),kt=l.aj(Pe,Te,Ft),Kt=O?kt/sn:kt*sn,pn={getElevation:be,labelPlaneMatrix:_,lineVertexArray:Ee,pitchWithMap:O,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:H,tileAnchorPoint:new l.P(Ft.anchorX,Ft.anchorY),unwrappedTileID:J,width:Q,height:ce,translation:fe},$n=He(pn,Ft,Kt,!1,z,o,E,M.glyphOffsetArray,Ve,rt,V);ht=$n.useVertical,($n.notEnoughRoom||ht||$n.needsFlipping&&He(pn,Ft,Kt,!0,z,o,E,M.glyphOffsetArray,Ve,rt,V).notEnoughRoom)&&Sn(Ft.numGlyphs,Ve)}v?M.text.dynamicLayoutVertexBuffer.updateData(Ve):M.icon.dynamicLayoutVertexBuffer.updateData(Ve)}function we(M,o,d,v,_,E,O,z){const V=E.glyphStartIndex+E.numGlyphs,H=E.lineStartIndex,J=E.lineStartIndex+E.lineLength,Q=o.getoffsetX(E.glyphStartIndex),ce=o.getoffsetX(V-1),fe=Wt(M*Q,d,v,_,E.segment,H,J,z,O);if(!fe)return null;const be=Wt(M*ce,d,v,_,E.segment,H,J,z,O);return be?z.projectionCache.anyProjectionOccluded?null:{first:fe,last:be}:null}function Fe(M,o,d,v){return M===l.ai.horizontal&&Math.abs(d.y-o.y)>Math.abs(d.x-o.x)*v?{useVertical:!0}:(M===l.ai.vertical?o.y<d.y:o.x>d.x)?{needsFlipping:!0}:null}function He(M,o,d,v,_,E,O,z,V,H,J){const Q=d/24,ce=o.lineOffsetX*Q,fe=o.lineOffsetY*Q;let be;if(o.numGlyphs>1){const Pe=o.glyphStartIndex+o.numGlyphs,Te=o.lineStartIndex,ke=o.lineStartIndex+o.lineLength,Ve=we(Q,z,ce,fe,v,o,J,M);if(!Ve)return{notEnoughRoom:!0};const Ee=xe(Ve.first.point,O,M.getElevation).point,qe=xe(Ve.last.point,O,M.getElevation).point;if(_&&!v){const rt=Fe(o.writingMode,Ee,qe,H);if(rt)return rt}be=[Ve.first];for(let rt=o.glyphStartIndex+1;rt<Pe-1;rt++)be.push(Wt(Q*z.getoffsetX(rt),ce,fe,v,o.segment,Te,ke,M,J));be.push(Ve.last)}else{if(_&&!v){const Te=xe(M.tileAnchorPoint,E,M.getElevation).point,ke=o.lineStartIndex+o.segment+1,Ve=new l.P(M.lineVertexArray.getx(ke),M.lineVertexArray.gety(ke)),Ee=xe(Ve,E,M.getElevation),qe=Ee.signedDistanceFromCamera>0?Ee.point:function(ht,At,Ft,an,sn,kt){return nt(ht,At,Ft,1,sn,kt)}(M.tileAnchorPoint,Ve,Te,0,E,M),rt=Fe(o.writingMode,Te,qe,H);if(rt)return rt}const Pe=Wt(Q*z.getoffsetX(o.glyphStartIndex),ce,fe,v,o.segment,o.lineStartIndex,o.lineStartIndex+o.lineLength,M,J);if(!Pe||M.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};be=[Pe]}for(const Pe of be)l.ak(V,Pe.point,Pe.angle);return{}}function nt(M,o,d,v,_,E){const O=M.add(M.sub(o)._unit()),z=_!==void 0?xe(O,_,E.getElevation).point:ut(O.x,O.y,E).point,V=d.sub(z);return d.add(V._mult(v/V.mag()))}function Ie(M,o,d){const v=o.projectionCache;if(v.projections[M])return v.projections[M];const _=new l.P(o.lineVertexArray.getx(M),o.lineVertexArray.gety(M)),E=ut(_.x,_.y,o);if(E.signedDistanceFromCamera>0)return v.projections[M]=E.point,v.anyProjectionOccluded=v.anyProjectionOccluded||E.isOccluded,E.point;const O=M-d.direction;return function(z,V,H,J,Q){return nt(z,V,H,J,void 0,Q)}(d.distanceFromAnchor===0?o.tileAnchorPoint:new l.P(o.lineVertexArray.getx(O),o.lineVertexArray.gety(O)),_,d.previousVertex,d.absOffsetX-d.distanceFromAnchor+1,o)}function ut(M,o,d){const v=M+d.translation[0],_=o+d.translation[1];let E;return!d.pitchWithMap&&d.projection.useSpecialProjectionForSymbols?(E=d.projection.projectTileCoordinates(v,_,d.unwrappedTileID,d.getElevation),E.point.x=(.5*E.point.x+.5)*d.width,E.point.y=(.5*-E.point.y+.5)*d.height):(E=xe(new l.P(v,_),d.labelPlaneMatrix,d.getElevation),E.isOccluded=!1),E}function bt(M,o,d){return M._unit()._perp()._mult(o*d)}function ct(M,o,d,v,_,E,O,z,V){if(z.projectionCache.offsets[M])return z.projectionCache.offsets[M];const H=d.add(o);if(M+V.direction<v||M+V.direction>=_)return z.projectionCache.offsets[M]=H,H;const J=Ie(M+V.direction,z,V),Q=bt(J.sub(d),O,V.direction),ce=d.add(Q),fe=J.add(Q);return z.projectionCache.offsets[M]=l.al(E,H,ce,fe)||H,z.projectionCache.offsets[M]}function Wt(M,o,d,v,_,E,O,z,V){const H=v?M-o:M+o;let J=H>0?1:-1,Q=0;v&&(J*=-1,Q=Math.PI),J<0&&(Q+=Math.PI);let ce,fe=J>0?E+_:E+_+1;z.projectionCache.cachedAnchorPoint?ce=z.projectionCache.cachedAnchorPoint:(ce=ut(z.tileAnchorPoint.x,z.tileAnchorPoint.y,z).point,z.projectionCache.cachedAnchorPoint=ce);let be,Pe,Te=ce,ke=ce,Ve=0,Ee=0;const qe=Math.abs(H),rt=[];let ht;for(;Ve+Ee<=qe;){if(fe+=J,fe<E||fe>=O)return null;Ve+=Ee,ke=Te,Pe=be;const an={absOffsetX:qe,direction:J,distanceFromAnchor:Ve,previousVertex:ke};if(Te=Ie(fe,z,an),d===0)rt.push(ke),ht=Te.sub(ke);else{let sn;const kt=Te.sub(ke);sn=kt.mag()===0?bt(Ie(fe+J,z,an).sub(Te),d,J):bt(kt,d,J),Pe||(Pe=ke.add(sn)),be=ct(fe,sn,Te,E,O,Pe,d,z,an),rt.push(Pe),ht=be.sub(Pe)}Ee=ht.mag()}const At=ht._mult((qe-Ve)/Ee)._add(Pe||ke),Ft=Q+Math.atan2(Te.y-ke.y,Te.x-ke.x);return rt.push(At),{point:At,angle:V?Ft:0,path:rt}}const bn=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Sn(M,o){for(let d=0;d<M;d++){const v=o.length;o.resize(v+4),o.float32.set(bn,3*v)}}const Bn=100;class ui{constructor(o,d,v=new Et(o.width+200,o.height+200,25),_=new Et(o.width+200,o.height+200,25)){this.transform=o,this.mapProjection=d,this.grid=v,this.ignoredGrid=_,this.pitchFactor=Math.cos(o._pitch)*o.cameraToCenterDistance,this.screenRightBoundary=o.width+Bn,this.screenBottomBoundary=o.height+Bn,this.gridRightBoundary=o.width+200,this.gridBottomBoundary=o.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(o,d,v,_,E,O,z,V,H,J,Q){const ce=o.anchorPointX+V[0],fe=o.anchorPointY+V[1],be=this.projectAndGetPerspectiveRatio(_,ce,fe,E,J),Pe=this._projectCollisionBox(o,v,_,E,O,z,V,be,J,Q),[Te,ke,Ve,Ee]=Pe.box;return this.mapProjection.useSpecialProjectionForSymbols&&(O?Pe.allPointsOccluded:this.mapProjection.isOccluded(ce,fe,E))||be.perspectiveRatio<this.perspectiveRatioCutoff||!this.isInsideGrid(Te,ke,Ve,Ee)||d!=="always"&&this.grid.hitTest(Te,ke,Ve,Ee,d,H)?{box:[Te,ke,Ve,Ee],placeable:!1,offscreen:!1}:{box:[Te,ke,Ve,Ee],placeable:!0,offscreen:this.isOffscreen(Te,ke,Ve,Ee)}}placeCollisionCircles(o,d,v,_,E,O,z,V,H,J,Q,ce,fe,be,Pe,Te){const ke=[],Ve=new l.P(d.anchorX,d.anchorY),Ee=this.getPerspectiveRatio(O,Ve.x,Ve.y,z,Te),qe=(Q?E/Ee:E*Ee)/l.aq,rt={getElevation:Te,labelPlaneMatrix:V,lineVertexArray:v,pitchWithMap:Q,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:this.mapProjection,tileAnchorPoint:Ve,unwrappedTileID:z,width:this.transform.width,height:this.transform.height,translation:Pe},ht=we(qe,_,d.lineOffsetX*qe,d.lineOffsetY*qe,!1,d,!1,rt);let At=!1,Ft=!1,an=!0;if(ht){const sn=.5*fe*Ee+be,kt=new l.P(-100,-100),Kt=new l.P(this.screenRightBoundary,this.screenBottomBoundary),pn=new Ne,$n=ht.first,Jt=ht.last;let tn=[];for(let ei=$n.path.length-1;ei>=1;ei--)tn.push($n.path[ei]);for(let ei=1;ei<Jt.path.length;ei++)tn.push(Jt.path[ei]);const Un=2.5*sn;if(H){const ei=this.projectPathToScreenSpace(tn,rt,H);tn=ei.some(hi=>hi.signedDistanceFromCamera<=0)?[]:ei.map(hi=>hi.point)}let rr=[];if(tn.length>0){const ei=tn[0].clone(),hi=tn[0].clone();for(let nr=1;nr<tn.length;nr++)ei.x=Math.min(ei.x,tn[nr].x),ei.y=Math.min(ei.y,tn[nr].y),hi.x=Math.max(hi.x,tn[nr].x),hi.y=Math.max(hi.y,tn[nr].y);rr=ei.x>=kt.x&&hi.x<=Kt.x&&ei.y>=kt.y&&hi.y<=Kt.y?[tn]:hi.x<kt.x||ei.x>Kt.x||hi.y<kt.y||ei.y>Kt.y?[]:l.am([tn],kt.x,kt.y,Kt.x,Kt.y)}for(const ei of rr){pn.reset(ei,.25*sn);let hi=0;hi=pn.length<=.5*sn?1:Math.ceil(pn.paddedLength/Un)+1;for(let nr=0;nr<hi;nr++){const Li=nr/Math.max(hi-1,1),yo=pn.lerp(Li),ir=yo.x+Bn,_r=yo.y+Bn;ke.push(ir,_r,sn,0);const ls=ir-sn,qr=_r-sn,wr=ir+sn,zo=_r+sn;if(an=an&&this.isOffscreen(ls,qr,wr,zo),Ft=Ft||this.isInsideGrid(ls,qr,wr,zo),o!=="always"&&this.grid.hitTestCircle(ir,_r,sn,o,ce)&&(At=!0,!J))return{circles:[],offscreen:!1,collisionDetected:At}}}}return{circles:!J&&At||!Ft||Ee<this.perspectiveRatioCutoff?[]:ke,offscreen:an,collisionDetected:At}}projectPathToScreenSpace(o,d,v){return o.map(_=>xe(_,v,d.getElevation))}queryRenderedSymbols(o){if(o.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const d=[];let v=1/0,_=1/0,E=-1/0,O=-1/0;for(const J of o){const Q=new l.P(J.x+Bn,J.y+Bn);v=Math.min(v,Q.x),_=Math.min(_,Q.y),E=Math.max(E,Q.x),O=Math.max(O,Q.y),d.push(Q)}const z=this.grid.query(v,_,E,O).concat(this.ignoredGrid.query(v,_,E,O)),V={},H={};for(const J of z){const Q=J.key;if(V[Q.bucketInstanceId]===void 0&&(V[Q.bucketInstanceId]={}),V[Q.bucketInstanceId][Q.featureIndex])continue;const ce=[new l.P(J.x1,J.y1),new l.P(J.x2,J.y1),new l.P(J.x2,J.y2),new l.P(J.x1,J.y2)];l.an(d,ce)&&(V[Q.bucketInstanceId][Q.featureIndex]=!0,H[Q.bucketInstanceId]===void 0&&(H[Q.bucketInstanceId]=[]),H[Q.bucketInstanceId].push(Q.featureIndex))}return H}insertCollisionBox(o,d,v,_,E,O){(v?this.ignoredGrid:this.grid).insert({bucketInstanceId:_,featureIndex:E,collisionGroupID:O,overlapMode:d},o[0],o[1],o[2],o[3])}insertCollisionCircles(o,d,v,_,E,O){const z=v?this.ignoredGrid:this.grid,V={bucketInstanceId:_,featureIndex:E,collisionGroupID:O,overlapMode:d};for(let H=0;H<o.length;H+=4)z.insertCircle(V,o[H],o[H+1],o[H+2])}projectAndGetPerspectiveRatio(o,d,v,_,E){const O=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(d,v,_,E):xe(new l.P(d,v),o,E);return{point:new l.P((O.point.x+1)/2*this.transform.width+Bn,(1-O.point.y)/2*this.transform.height+Bn),perspectiveRatio:.5+this.transform.cameraToCenterDistance/O.signedDistanceFromCamera*.5,isOccluded:O.isOccluded,signedDistanceFromCamera:O.signedDistanceFromCamera}}getPerspectiveRatio(o,d,v,_,E){const O=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(d,v,_,E):xe(new l.P(d,v),o,E);return .5+this.transform.cameraToCenterDistance/O.signedDistanceFromCamera*.5}isOffscreen(o,d,v,_){return v<Bn||o>=this.screenRightBoundary||_<Bn||d>this.screenBottomBoundary}isInsideGrid(o,d,v,_){return v>=0&&o<this.gridRightBoundary&&_>=0&&d<this.gridBottomBoundary}getViewportMatrix(){const o=l.ao([]);return l.J(o,o,[-100,-100,0]),o}_projectCollisionBox(o,d,v,_,E,O,z,V,H,J){const Q=d*V.perspectiveRatio;let ce=new l.P(1,0),fe=new l.P(0,1);const be=new l.P(o.anchorPointX+z[0],o.anchorPointY+z[1]);if(O&&!E){const sn=this.projectAndGetPerspectiveRatio(v,be.x+1,be.y,_,H).point.sub(V.point).unit(),kt=Math.atan(sn.y/sn.x)+(sn.x<0?Math.PI:0),Kt=Math.sin(kt),pn=Math.cos(kt);ce=new l.P(pn,Kt),fe=new l.P(-Kt,pn)}else if(!O&&E){const sn=-this.transform.angle,kt=Math.sin(sn),Kt=Math.cos(sn);ce=new l.P(Kt,kt),fe=new l.P(-kt,Kt)}let Pe=V.point,Te=Q;if(E){Pe=be;const sn=this.transform.zoom-Math.floor(this.transform.zoom);Te=Math.pow(2,-sn),Te*=this.mapProjection.getPitchedTextCorrection(this.transform,be,_),J||(Te*=l.ad(.5+V.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))}J&&(Pe=Pe.add(ce.mult(J.x*Te)).add(fe.mult(J.y*Te)));const ke=o.x1*Te,Ve=o.x2*Te,Ee=(ke+Ve)/2,qe=o.y1*Te,rt=o.y2*Te,ht=(qe+rt)/2,At=[{offsetX:ke,offsetY:qe},{offsetX:Ee,offsetY:qe},{offsetX:Ve,offsetY:qe},{offsetX:Ve,offsetY:ht},{offsetX:Ve,offsetY:rt},{offsetX:Ee,offsetY:rt},{offsetX:ke,offsetY:rt},{offsetX:ke,offsetY:ht}];let Ft=[];for(const{offsetX:sn,offsetY:kt}of At)Ft.push(new l.P(Pe.x+ce.x*sn+fe.x*kt,Pe.y+ce.y*sn+fe.y*kt));let an=!1;if(E){const sn=Ft.map(kt=>this.projectAndGetPerspectiveRatio(v,kt.x,kt.y,_,H));an=sn.some(kt=>!kt.isOccluded),Ft=sn.map(kt=>kt.point)}else an=!0;return{box:l.ap(Ft),allPointsOccluded:!an}}}function Vn(M,o,d){return o*(l.X/(M.tileSize*Math.pow(2,d-M.tileID.overscaledZ)))}class Di{constructor(o,d,v,_){this.opacity=o?Math.max(0,Math.min(1,o.opacity+(o.placed?d:-d))):_&&v?1:0,this.placed=v}isHidden(){return this.opacity===0&&!this.placed}}class qi{constructor(o,d,v,_,E){this.text=new Di(o?o.text:null,d,v,E),this.icon=new Di(o?o.icon:null,d,_,E)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class me{constructor(o,d,v){this.text=o,this.icon=d,this.skipFade=v}}class $e{constructor(){this.invProjMatrix=l.H(),this.viewportMatrix=l.H(),this.circles=[]}}class ot{constructor(o,d,v,_,E){this.bucketInstanceId=o,this.featureIndex=d,this.sourceLayerIndex=v,this.bucketIndex=_,this.tileID=E}}class lt{constructor(o){this.crossSourceCollisions=o,this.maxGroupID=0,this.collisionGroups={}}get(o){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[o]){const d=++this.maxGroupID;this.collisionGroups[o]={ID:d,predicate:v=>v.collisionGroupID===d}}return this.collisionGroups[o]}}function Je(M,o,d,v,_){const{horizontalAlign:E,verticalAlign:O}=l.av(M);return new l.P(-(E-.5)*o+v[0]*_,-(O-.5)*d+v[1]*_)}class jt{constructor(o,d,v,_,E,O){this.transform=o.clone(),this.terrain=v,this.collisionIndex=new ui(this.transform,d),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=_,this.retainedQueryData={},this.collisionGroups=new lt(E),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=O,O&&(O.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(o){const d=this.terrain;return d?(v,_)=>d.getElevation(o,v,_):null}getBucketParts(o,d,v,_){const E=v.getBucket(d),O=v.latestFeatureIndex;if(!E||!O||d.id!==E.layerIds[0])return;const z=v.collisionBoxArray,V=E.layers[0].layout,H=E.layers[0].paint,J=Math.pow(2,this.transform.zoom-v.tileID.overscaledZ),Q=v.tileSize/l.X,ce=v.tileID.toUnwrapped(),fe=this.transform.calculatePosMatrix(ce),be=V.get("text-pitch-alignment")==="map",Pe=V.get("text-rotation-alignment")==="map",Te=Vn(v,1,this.transform.zoom),ke=this.collisionIndex.mapProjection.translatePosition(this.transform,v,H.get("text-translate"),H.get("text-translate-anchor")),Ve=this.collisionIndex.mapProjection.translatePosition(this.transform,v,H.get("icon-translate"),H.get("icon-translate-anchor")),Ee=Ct(fe,be,Pe,this.transform,Te);let qe=null;if(be){const ht=Zt(fe,be,Pe,this.transform,Te);qe=l.L([],this.transform.labelPlaneMatrix,ht)}this.retainedQueryData[E.bucketInstanceId]=new ot(E.bucketInstanceId,O,E.sourceLayerIndex,E.index,v.tileID);const rt={bucket:E,layout:V,translationText:ke,translationIcon:Ve,posMatrix:fe,unwrappedTileID:ce,textLabelPlaneMatrix:Ee,labelToScreenMatrix:qe,scale:J,textPixelRatio:Q,holdingForFade:v.holdingForFade(),collisionBoxArray:z,partiallyEvaluatedTextSize:l.ah(E.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(E.sourceID)};if(_)for(const ht of E.sortKeyRanges){const{sortKey:At,symbolInstanceStart:Ft,symbolInstanceEnd:an}=ht;o.push({sortKey:At,symbolInstanceStart:Ft,symbolInstanceEnd:an,parameters:rt})}else o.push({symbolInstanceStart:0,symbolInstanceEnd:E.symbolInstances.length,parameters:rt})}attemptAnchorPlacement(o,d,v,_,E,O,z,V,H,J,Q,ce,fe,be,Pe,Te,ke,Ve,Ee){const qe=l.ar[o.textAnchor],rt=[o.textOffset0,o.textOffset1],ht=Je(qe,v,_,rt,E),At=this.collisionIndex.placeCollisionBox(d,ce,V,H,J,z,O,Te,Q.predicate,Ee,ht);if((!Ve||this.collisionIndex.placeCollisionBox(Ve,ce,V,H,J,z,O,ke,Q.predicate,Ee,ht).placeable)&&At.placeable){let Ft;if(this.prevPlacement&&this.prevPlacement.variableOffsets[fe.crossTileID]&&this.prevPlacement.placements[fe.crossTileID]&&this.prevPlacement.placements[fe.crossTileID].text&&(Ft=this.prevPlacement.variableOffsets[fe.crossTileID].anchor),fe.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[fe.crossTileID]={textOffset:rt,width:v,height:_,anchor:qe,textBoxScale:E,prevAnchor:Ft},this.markUsedJustification(be,qe,fe,Pe),be.allowVerticalPlacement&&(this.markUsedOrientation(be,Pe,fe),this.placedOrientations[fe.crossTileID]=Pe),{shift:ht,placedGlyphBoxes:At}}}placeLayerBucketPart(o,d,v){const{bucket:_,layout:E,translationText:O,translationIcon:z,posMatrix:V,unwrappedTileID:H,textLabelPlaneMatrix:J,labelToScreenMatrix:Q,textPixelRatio:ce,holdingForFade:fe,collisionBoxArray:be,partiallyEvaluatedTextSize:Pe,collisionGroup:Te}=o.parameters,ke=E.get("text-optional"),Ve=E.get("icon-optional"),Ee=l.as(E,"text-overlap","text-allow-overlap"),qe=Ee==="always",rt=l.as(E,"icon-overlap","icon-allow-overlap"),ht=rt==="always",At=E.get("text-rotation-alignment")==="map",Ft=E.get("text-pitch-alignment")==="map",an=E.get("icon-text-fit")!=="none",sn=E.get("symbol-z-order")==="viewport-y",kt=qe&&(ht||!_.hasIconData()||Ve),Kt=ht&&(qe||!_.hasTextData()||ke);!_.collisionArrays&&be&&_.deserializeCollisionBoxes(be);const pn=this._getTerrainElevationFunc(this.retainedQueryData[_.bucketInstanceId].tileID),$n=(Jt,tn,Un)=>{var rr,ei;if(d[Jt.crossTileID])return;if(fe)return void(this.placements[Jt.crossTileID]=new me(!1,!1,!1));let hi=!1,nr=!1,Li=!0,yo=null,ir={box:null,placeable:!1,offscreen:null},_r={placeable:!1},ls=null,qr=null,wr=null,zo=0,Rr=0,Au=0;tn.textFeatureIndex?zo=tn.textFeatureIndex:Jt.useRuntimeCollisionCircles&&(zo=Jt.featureIndex),tn.verticalTextFeatureIndex&&(Rr=tn.verticalTextFeatureIndex);const Pu=tn.textBox;if(Pu){const cs=ys=>{let Br=l.ai.horizontal;if(_.allowVerticalPlacement&&!ys&&this.prevPlacement){const ts=this.prevPlacement.placedOrientations[Jt.crossTileID];ts&&(this.placedOrientations[Jt.crossTileID]=ts,Br=ts,this.markUsedOrientation(_,Br,Jt))}return Br},Os=(ys,Br)=>{if(_.allowVerticalPlacement&&Jt.numVerticalGlyphVertices>0&&tn.verticalTextBox){for(const ts of _.writingModes)if(ts===l.ai.vertical?(ir=Br(),_r=ir):ir=ys(),ir&&ir.placeable)break}else ir=ys()},hl=Jt.textAnchorOffsetStartIndex,Iu=Jt.textAnchorOffsetEndIndex;if(Iu===hl){const ys=(Br,ts)=>{const vr=this.collisionIndex.placeCollisionBox(Br,Ee,ce,V,H,Ft,At,O,Te.predicate,pn);return vr&&vr.placeable&&(this.markUsedOrientation(_,ts,Jt),this.placedOrientations[Jt.crossTileID]=ts),vr};Os(()=>ys(Pu,l.ai.horizontal),()=>{const Br=tn.verticalTextBox;return _.allowVerticalPlacement&&Jt.numVerticalGlyphVertices>0&&Br?ys(Br,l.ai.vertical):{box:null,offscreen:null}}),cs(ir&&ir.placeable)}else{let ys=l.ar[(ei=(rr=this.prevPlacement)===null||rr===void 0?void 0:rr.variableOffsets[Jt.crossTileID])===null||ei===void 0?void 0:ei.anchor];const Br=(vr,Xl,Mf)=>{const Xr=vr.x2-vr.x1,f0=vr.y2-vr.y1,Cf=Jt.textBoxScale,Uh=an&&rt==="never"?Xl:null;let Aa=null,p0=Ee==="never"?1:2,Vh="never";ys&&p0++;for(let Tf=0;Tf<p0;Tf++){for(let Af=hl;Af<Iu;Af++){const $h=_.textAnchorOffsets.get(Af);if(ys&&$h.textAnchor!==ys)continue;const dl=this.attemptAnchorPlacement($h,vr,Xr,f0,Cf,At,Ft,ce,V,H,Te,Vh,Jt,_,Mf,O,z,Uh,pn);if(dl&&(Aa=dl.placedGlyphBoxes,Aa&&Aa.placeable))return hi=!0,yo=dl.shift,Aa}ys?ys=null:Vh=Ee}return v&&!Aa&&(Aa={box:this.collisionIndex.placeCollisionBox(Pu,"always",ce,V,H,Ft,At,O,Te.predicate,pn,new l.P(0,0)).box,offscreen:!1,placeable:!1}),Aa};Os(()=>Br(Pu,tn.iconBox,l.ai.horizontal),()=>{const vr=tn.verticalTextBox;return _.allowVerticalPlacement&&(!ir||!ir.placeable)&&Jt.numVerticalGlyphVertices>0&&vr?Br(vr,tn.verticalIconBox,l.ai.vertical):{box:null,occluded:!0,offscreen:null}}),ir&&(hi=ir.placeable,Li=ir.offscreen);const ts=cs(ir&&ir.placeable);if(!hi&&this.prevPlacement){const vr=this.prevPlacement.variableOffsets[Jt.crossTileID];vr&&(this.variableOffsets[Jt.crossTileID]=vr,this.markUsedJustification(_,vr.anchor,Jt,ts))}}}if(ls=ir,hi=ls&&ls.placeable,Li=ls&&ls.offscreen,Jt.useRuntimeCollisionCircles){const cs=_.text.placedSymbolArray.get(Jt.centerJustifiedTextSymbolIndex),Os=l.aj(_.textSizeData,Pe,cs),hl=E.get("text-padding");qr=this.collisionIndex.placeCollisionCircles(Ee,cs,_.lineVertexArray,_.glyphOffsetArray,Os,V,H,J,Q,v,Ft,Te.predicate,Jt.collisionCircleDiameter,hl,O,pn),qr.circles.length&&qr.collisionDetected&&!v&&l.w("Collisions detected, but collision boxes are not shown"),hi=qe||qr.circles.length>0&&!qr.collisionDetected,Li=Li&&qr.offscreen}if(tn.iconFeatureIndex&&(Au=tn.iconFeatureIndex),tn.iconBox){const cs=Os=>this.collisionIndex.placeCollisionBox(Os,rt,ce,V,H,Ft,At,z,Te.predicate,pn,an&&yo?yo:void 0);_r&&_r.placeable&&tn.verticalIconBox?(wr=cs(tn.verticalIconBox),nr=wr.placeable):(wr=cs(tn.iconBox),nr=wr.placeable),Li=Li&&wr.offscreen}const Oc=ke||Jt.numHorizontalGlyphVertices===0&&Jt.numVerticalGlyphVertices===0,Ef=Ve||Jt.numIconVertices===0;Oc||Ef?Ef?Oc||(nr=nr&&hi):hi=nr&&hi:nr=hi=nr&&hi;const Bh=nr&&wr.placeable;if(hi&&ls.placeable&&this.collisionIndex.insertCollisionBox(ls.box,Ee,E.get("text-ignore-placement"),_.bucketInstanceId,_r&&_r.placeable&&Rr?Rr:zo,Te.ID),Bh&&this.collisionIndex.insertCollisionBox(wr.box,rt,E.get("icon-ignore-placement"),_.bucketInstanceId,Au,Te.ID),qr&&hi&&this.collisionIndex.insertCollisionCircles(qr.circles,Ee,E.get("text-ignore-placement"),_.bucketInstanceId,zo,Te.ID),v&&this.storeCollisionData(_.bucketInstanceId,Un,tn,ls,wr,qr),Jt.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(_.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Jt.crossTileID]=new me(hi||kt,nr||Kt,Li||_.justReloaded),d[Jt.crossTileID]=!0};if(sn){if(o.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Jt=_.getSortedSymbolIndexes(this.transform.angle);for(let tn=Jt.length-1;tn>=0;--tn){const Un=Jt[tn];$n(_.symbolInstances.get(Un),_.collisionArrays[Un],Un)}}else for(let Jt=o.symbolInstanceStart;Jt<o.symbolInstanceEnd;Jt++)$n(_.symbolInstances.get(Jt),_.collisionArrays[Jt],Jt);if(v&&_.bucketInstanceId in this.collisionCircleArrays){const Jt=this.collisionCircleArrays[_.bucketInstanceId];l.at(Jt.invProjMatrix,V),Jt.viewportMatrix=this.collisionIndex.getViewportMatrix()}_.justReloaded=!1}storeCollisionData(o,d,v,_,E,O){if(v.textBox||v.iconBox){let z,V;this.collisionBoxArrays.has(o)?z=this.collisionBoxArrays.get(o):(z=new Map,this.collisionBoxArrays.set(o,z)),z.has(d)?V=z.get(d):(V={text:null,icon:null},z.set(d,V)),v.textBox&&(V.text=_.box),v.iconBox&&(V.icon=E.box)}if(O){let z=this.collisionCircleArrays[o];z===void 0&&(z=this.collisionCircleArrays[o]=new $e);for(let V=0;V<O.circles.length;V+=4)z.circles.push(O.circles[V+0]),z.circles.push(O.circles[V+1]),z.circles.push(O.circles[V+2]),z.circles.push(O.collisionDetected?1:0)}}markUsedJustification(o,d,v,_){let E;E=_===l.ai.vertical?v.verticalPlacedTextSymbolIndex:{left:v.leftJustifiedTextSymbolIndex,center:v.centerJustifiedTextSymbolIndex,right:v.rightJustifiedTextSymbolIndex}[l.au(d)];const O=[v.leftJustifiedTextSymbolIndex,v.centerJustifiedTextSymbolIndex,v.rightJustifiedTextSymbolIndex,v.verticalPlacedTextSymbolIndex];for(const z of O)z>=0&&(o.text.placedSymbolArray.get(z).crossTileID=E>=0&&z!==E?0:v.crossTileID)}markUsedOrientation(o,d,v){const _=d===l.ai.horizontal||d===l.ai.horizontalOnly?d:0,E=d===l.ai.vertical?d:0,O=[v.leftJustifiedTextSymbolIndex,v.centerJustifiedTextSymbolIndex,v.rightJustifiedTextSymbolIndex];for(const z of O)o.text.placedSymbolArray.get(z).placedOrientation=_;v.verticalPlacedTextSymbolIndex&&(o.text.placedSymbolArray.get(v.verticalPlacedTextSymbolIndex).placedOrientation=E)}commit(o){this.commitTime=o,this.zoomAtLastRecencyCheck=this.transform.zoom;const d=this.prevPlacement;let v=!1;this.prevZoomAdjustment=d?d.zoomAdjustment(this.transform.zoom):0;const _=d?d.symbolFadeChange(o):1,E=d?d.opacities:{},O=d?d.variableOffsets:{},z=d?d.placedOrientations:{};for(const V in this.placements){const H=this.placements[V],J=E[V];J?(this.opacities[V]=new qi(J,_,H.text,H.icon),v=v||H.text!==J.text.placed||H.icon!==J.icon.placed):(this.opacities[V]=new qi(null,_,H.text,H.icon,H.skipFade),v=v||H.text||H.icon)}for(const V in E){const H=E[V];if(!this.opacities[V]){const J=new qi(H,_,!1,!1);J.isHidden()||(this.opacities[V]=J,v=v||H.text.placed||H.icon.placed)}}for(const V in O)this.variableOffsets[V]||!this.opacities[V]||this.opacities[V].isHidden()||(this.variableOffsets[V]=O[V]);for(const V in z)this.placedOrientations[V]||!this.opacities[V]||this.opacities[V].isHidden()||(this.placedOrientations[V]=z[V]);if(d&&d.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");v?this.lastPlacementChangeTime=o:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=d?d.lastPlacementChangeTime:o)}updateLayerOpacities(o,d){const v={};for(const _ of d){const E=_.getBucket(o);E&&_.latestFeatureIndex&&o.id===E.layerIds[0]&&this.updateBucketOpacities(E,_.tileID,v,_.collisionBoxArray)}}updateBucketOpacities(o,d,v,_){o.hasTextData()&&(o.text.opacityVertexArray.clear(),o.text.hasVisibleVertices=!1),o.hasIconData()&&(o.icon.opacityVertexArray.clear(),o.icon.hasVisibleVertices=!1),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexArray.clear(),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexArray.clear();const E=o.layers[0],O=E.layout,z=new qi(null,0,!1,!1,!0),V=O.get("text-allow-overlap"),H=O.get("icon-allow-overlap"),J=E._unevaluatedLayout.hasValue("text-variable-anchor")||E._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Q=O.get("text-rotation-alignment")==="map",ce=O.get("text-pitch-alignment")==="map",fe=O.get("icon-text-fit")!=="none",be=new qi(null,0,V&&(H||!o.hasIconData()||O.get("icon-optional")),H&&(V||!o.hasTextData()||O.get("text-optional")),!0);!o.collisionArrays&&_&&(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData())&&o.deserializeCollisionBoxes(_);const Pe=(ke,Ve,Ee)=>{for(let qe=0;qe<Ve/4;qe++)ke.opacityVertexArray.emplaceBack(Ee);ke.hasVisibleVertices=ke.hasVisibleVertices||Ee!==Ni},Te=this.collisionBoxArrays.get(o.bucketInstanceId);for(let ke=0;ke<o.symbolInstances.length;ke++){const Ve=o.symbolInstances.get(ke),{numHorizontalGlyphVertices:Ee,numVerticalGlyphVertices:qe,crossTileID:rt}=Ve;let ht=this.opacities[rt];v[rt]?ht=z:ht||(ht=be,this.opacities[rt]=ht),v[rt]=!0;const At=Ve.numIconVertices>0,Ft=this.placedOrientations[Ve.crossTileID],an=Ft===l.ai.vertical,sn=Ft===l.ai.horizontal||Ft===l.ai.horizontalOnly;if(Ee>0||qe>0){const Kt=mi(ht.text);Pe(o.text,Ee,an?Ni:Kt),Pe(o.text,qe,sn?Ni:Kt);const pn=ht.text.isHidden();[Ve.rightJustifiedTextSymbolIndex,Ve.centerJustifiedTextSymbolIndex,Ve.leftJustifiedTextSymbolIndex].forEach(tn=>{tn>=0&&(o.text.placedSymbolArray.get(tn).hidden=pn||an?1:0)}),Ve.verticalPlacedTextSymbolIndex>=0&&(o.text.placedSymbolArray.get(Ve.verticalPlacedTextSymbolIndex).hidden=pn||sn?1:0);const $n=this.variableOffsets[Ve.crossTileID];$n&&this.markUsedJustification(o,$n.anchor,Ve,Ft);const Jt=this.placedOrientations[Ve.crossTileID];Jt&&(this.markUsedJustification(o,"left",Ve,Jt),this.markUsedOrientation(o,Jt,Ve))}if(At){const Kt=mi(ht.icon),pn=!(fe&&Ve.verticalPlacedIconSymbolIndex&&an);Ve.placedIconSymbolIndex>=0&&(Pe(o.icon,Ve.numIconVertices,pn?Kt:Ni),o.icon.placedSymbolArray.get(Ve.placedIconSymbolIndex).hidden=ht.icon.isHidden()),Ve.verticalPlacedIconSymbolIndex>=0&&(Pe(o.icon,Ve.numVerticalIconVertices,pn?Ni:Kt),o.icon.placedSymbolArray.get(Ve.verticalPlacedIconSymbolIndex).hidden=ht.icon.isHidden())}const kt=Te&&Te.has(ke)?Te.get(ke):{text:null,icon:null};if(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData()){const Kt=o.collisionArrays[ke];if(Kt){let pn=new l.P(0,0);if(Kt.textBox||Kt.verticalTextBox){let $n=!0;if(J){const Jt=this.variableOffsets[rt];Jt?(pn=Je(Jt.anchor,Jt.width,Jt.height,Jt.textOffset,Jt.textBoxScale),Q&&pn._rotate(ce?this.transform.angle:-this.transform.angle)):$n=!1}if(Kt.textBox||Kt.verticalTextBox){let Jt;Kt.textBox&&(Jt=an),Kt.verticalTextBox&&(Jt=sn),en(o.textCollisionBox.collisionVertexArray,ht.text.placed,!$n||Jt,kt.text,pn.x,pn.y)}}if(Kt.iconBox||Kt.verticalIconBox){const $n=!!(!sn&&Kt.verticalIconBox);let Jt;Kt.iconBox&&(Jt=$n),Kt.verticalIconBox&&(Jt=!$n),en(o.iconCollisionBox.collisionVertexArray,ht.icon.placed,Jt,kt.icon,fe?pn.x:0,fe?pn.y:0)}}}}if(o.sortFeatures(this.transform.angle),this.retainedQueryData[o.bucketInstanceId]&&(this.retainedQueryData[o.bucketInstanceId].featureSortOrder=o.featureSortOrder),o.hasTextData()&&o.text.opacityVertexBuffer&&o.text.opacityVertexBuffer.updateData(o.text.opacityVertexArray),o.hasIconData()&&o.icon.opacityVertexBuffer&&o.icon.opacityVertexBuffer.updateData(o.icon.opacityVertexArray),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexBuffer&&o.iconCollisionBox.collisionVertexBuffer.updateData(o.iconCollisionBox.collisionVertexArray),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexBuffer&&o.textCollisionBox.collisionVertexBuffer.updateData(o.textCollisionBox.collisionVertexArray),o.text.opacityVertexArray.length!==o.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${o.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${o.text.layoutVertexArray.length}) / 4`);if(o.icon.opacityVertexArray.length!==o.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${o.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${o.icon.layoutVertexArray.length}) / 4`);if(o.bucketInstanceId in this.collisionCircleArrays){const ke=this.collisionCircleArrays[o.bucketInstanceId];o.placementInvProjMatrix=ke.invProjMatrix,o.placementViewportMatrix=ke.viewportMatrix,o.collisionCircleArray=ke.circles,delete this.collisionCircleArrays[o.bucketInstanceId]}}symbolFadeChange(o){return this.fadeDuration===0?1:(o-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(o){return Math.max(0,(this.transform.zoom-o)/1.5)}hasTransitions(o){return this.stale||o-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(o,d){const v=this.zoomAtLastRecencyCheck===d?1-this.zoomAdjustment(d):1;return this.zoomAtLastRecencyCheck=d,this.commitTime+this.fadeDuration*v>o}setStale(){this.stale=!0}}function en(M,o,d,v,_,E){v&&v.length!==0||(v=[0,0,0,0]);const O=v[0]-Bn,z=v[1]-Bn,V=v[2]-Bn,H=v[3]-Bn;M.emplaceBack(o?1:0,d?1:0,_||0,E||0,O,z),M.emplaceBack(o?1:0,d?1:0,_||0,E||0,V,z),M.emplaceBack(o?1:0,d?1:0,_||0,E||0,V,H),M.emplaceBack(o?1:0,d?1:0,_||0,E||0,O,H)}const En=Math.pow(2,25),Yt=Math.pow(2,24),jn=Math.pow(2,17),Zn=Math.pow(2,16),In=Math.pow(2,9),ri=Math.pow(2,8),ur=Math.pow(2,1);function mi(M){if(M.opacity===0&&!M.placed)return 0;if(M.opacity===1&&M.placed)return 4294967295;const o=M.placed?1:0,d=Math.floor(127*M.opacity);return d*En+o*Yt+d*jn+o*Zn+d*In+o*ri+d*ur+o}const Ni=0;function wi(){return{isOccluded:(M,o,d)=>!1,getPitchedTextCorrection:(M,o,d)=>1,get useSpecialProjectionForSymbols(){return!1},projectTileCoordinates(M,o,d,v){throw new Error("Not implemented.")},translatePosition:(M,o,d,v)=>function(_,E,O,z,V=!1){if(!O[0]&&!O[1])return[0,0];const H=V?z==="map"?_.angle:0:z==="viewport"?-_.angle:0;if(H){const J=Math.sin(H),Q=Math.cos(H);O=[O[0]*Q-O[1]*J,O[0]*J+O[1]*Q]}return[V?O[0]:Vn(E,O[0],_.zoom),V?O[1]:Vn(E,O[1],_.zoom)]}(M,o,d,v),getCircleRadiusCorrection:M=>1}}class Fn{constructor(o){this._sortAcrossTiles=o.layout.get("symbol-z-order")!=="viewport-y"&&!o.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(o,d,v,_,E){const O=this._bucketParts;for(;this._currentTileIndex<o.length;)if(d.getBucketParts(O,_,o[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,E())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,O.sort((z,V)=>z.sortKey-V.sortKey));this._currentPartIndex<O.length;)if(d.placeLayerBucketPart(O[this._currentPartIndex],this._seenCrossTileIDs,v),this._currentPartIndex++,E())return!0;return!1}}class di{constructor(o,d,v,_,E,O,z,V){this.placement=new jt(o,wi(),d,O,z,V),this._currentPlacementIndex=v.length-1,this._forceFullPlacement=_,this._showCollisionBoxes=E,this._done=!1}isDone(){return this._done}continuePlacement(o,d,v){const _=S.now(),E=()=>!this._forceFullPlacement&&S.now()-_>2;for(;this._currentPlacementIndex>=0;){const O=d[o[this._currentPlacementIndex]],z=this.placement.collisionIndex.transform.zoom;if(O.type==="symbol"&&(!O.minzoom||O.minzoom<=z)&&(!O.maxzoom||O.maxzoom>z)){if(this._inProgressLayer||(this._inProgressLayer=new Fn(O)),this._inProgressLayer.continuePlacement(v[O.source],this.placement,this._showCollisionBoxes,O,E))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(o){return this.placement.commit(o),this.placement}}const li=512/l.X/2;class Or{constructor(o,d,v){this.tileID=o,this.bucketInstanceId=v,this._symbolsByKey={};const _=new Map;for(let E=0;E<d.length;E++){const O=d.get(E),z=O.key,V=_.get(z);V?V.push(O):_.set(z,[O])}for(const[E,O]of _){const z={positions:O.map(V=>({x:Math.floor(V.anchorX*li),y:Math.floor(V.anchorY*li)})),crossTileIDs:O.map(V=>V.crossTileID)};if(z.positions.length>128){const V=new l.aw(z.positions.length,16,Uint16Array);for(const{x:H,y:J}of z.positions)V.add(H,J);V.finish(),delete z.positions,z.index=V}this._symbolsByKey[E]=z}}getScaledCoordinates(o,d){const{x:v,y:_,z:E}=this.tileID.canonical,{x:O,y:z,z:V}=d.canonical,H=li/Math.pow(2,V-E),J=(z*l.X+o.anchorY)*H,Q=_*l.X*li;return{x:Math.floor((O*l.X+o.anchorX)*H-v*l.X*li),y:Math.floor(J-Q)}}findMatches(o,d,v){const _=this.tileID.canonical.z<d.canonical.z?1:Math.pow(2,this.tileID.canonical.z-d.canonical.z);for(let E=0;E<o.length;E++){const O=o.get(E);if(O.crossTileID)continue;const z=this._symbolsByKey[O.key];if(!z)continue;const V=this.getScaledCoordinates(O,d);if(z.index){const H=z.index.range(V.x-_,V.y-_,V.x+_,V.y+_).sort();for(const J of H){const Q=z.crossTileIDs[J];if(!v[Q]){v[Q]=!0,O.crossTileID=Q;break}}}else if(z.positions)for(let H=0;H<z.positions.length;H++){const J=z.positions[H],Q=z.crossTileIDs[H];if(Math.abs(J.x-V.x)<=_&&Math.abs(J.y-V.y)<=_&&!v[Q]){v[Q]=!0,O.crossTileID=Q;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:o})=>o)}}class $i{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Fr{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(o){const d=Math.round((o-this.lng)/360);if(d!==0)for(const v in this.indexes){const _=this.indexes[v],E={};for(const O in _){const z=_[O];z.tileID=z.tileID.unwrapTo(z.tileID.wrap+d),E[z.tileID.key]=z}this.indexes[v]=E}this.lng=o}addBucket(o,d,v){if(this.indexes[o.overscaledZ]&&this.indexes[o.overscaledZ][o.key]){if(this.indexes[o.overscaledZ][o.key].bucketInstanceId===d.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(o.overscaledZ,this.indexes[o.overscaledZ][o.key])}for(let E=0;E<d.symbolInstances.length;E++)d.symbolInstances.get(E).crossTileID=0;this.usedCrossTileIDs[o.overscaledZ]||(this.usedCrossTileIDs[o.overscaledZ]={});const _=this.usedCrossTileIDs[o.overscaledZ];for(const E in this.indexes){const O=this.indexes[E];if(Number(E)>o.overscaledZ)for(const z in O){const V=O[z];V.tileID.isChildOf(o)&&V.findMatches(d.symbolInstances,o,_)}else{const z=O[o.scaledTo(Number(E)).key];z&&z.findMatches(d.symbolInstances,o,_)}}for(let E=0;E<d.symbolInstances.length;E++){const O=d.symbolInstances.get(E);O.crossTileID||(O.crossTileID=v.generate(),_[O.crossTileID]=!0)}return this.indexes[o.overscaledZ]===void 0&&(this.indexes[o.overscaledZ]={}),this.indexes[o.overscaledZ][o.key]=new Or(o,d.symbolInstances,d.bucketInstanceId),!0}removeBucketCrossTileIDs(o,d){for(const v of d.getCrossTileIDsLists())for(const _ of v)delete this.usedCrossTileIDs[o][_]}removeStaleBuckets(o){let d=!1;for(const v in this.indexes){const _=this.indexes[v];for(const E in _)o[_[E].bucketInstanceId]||(this.removeBucketCrossTileIDs(v,_[E]),delete _[E],d=!0)}return d}}class vs{constructor(){this.layerIndexes={},this.crossTileIDs=new $i,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(o,d,v){let _=this.layerIndexes[o.id];_===void 0&&(_=this.layerIndexes[o.id]=new Fr);let E=!1;const O={};_.handleWrapJump(v);for(const z of d){const V=z.getBucket(o);V&&o.id===V.layerIds[0]&&(V.bucketInstanceId||(V.bucketInstanceId=++this.maxBucketInstanceId),_.addBucket(z.tileID,V,this.crossTileIDs)&&(E=!0),O[V.bucketInstanceId]=!0)}return _.removeStaleBuckets(O)&&(E=!0),E}pruneUnusedLayers(o){const d={};o.forEach(v=>{d[v]=!0});for(const v in this.layerIndexes)d[v]||delete this.layerIndexes[v]}}const Qi=(M,o)=>l.t(M,o&&o.filter(d=>d.identifier!=="source.canvas")),zr=l.ax();class Ol extends l.E{constructor(o,d={}){super(),this._rtlPluginLoaded=()=>{for(const v in this.sourceCaches){const _=this.sourceCaches[v].getSource().type;_!=="vector"&&_!=="geojson"||this.sourceCaches[v].reload()}},this.map=o,this.dispatcher=new Bt(Mn(),o._getMapId()),this.dispatcher.registerMessageHandler("GG",(v,_)=>this.getGlyphs(v,_)),this.dispatcher.registerMessageHandler("GI",(v,_)=>this.getImages(v,_)),this.imageManager=new Se,this.imageManager.setEventedParent(this),this.glyphManager=new Ce(o._requestManager,d.localIdeographFontFamily),this.lineAtlas=new Xt(256,512),this.crossTileSymbolIndex=new vs,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new l.ay,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",l.az()),on().on(it,this._rtlPluginLoaded),this.on("data",v=>{if(v.dataType!=="source"||v.sourceDataType!=="metadata")return;const _=this.sourceCaches[v.sourceId];if(!_)return;const E=_.getSource();if(E&&E.vectorLayerIds)for(const O in this._layers){const z=this._layers[O];z.source===E.id&&this._validateLayer(z)}})}loadURL(o,d={},v){this.fire(new l.k("dataloading",{dataType:"style"})),d.validate=typeof d.validate!="boolean"||d.validate;const _=this.map._requestManager.transformRequest(o,"Style");this._loadStyleRequest=new AbortController;const E=this._loadStyleRequest;l.h(_,this._loadStyleRequest).then(O=>{this._loadStyleRequest=null,this._load(O.data,d,v)}).catch(O=>{this._loadStyleRequest=null,O&&!E.signal.aborted&&this.fire(new l.j(O))})}loadJSON(o,d={},v){this.fire(new l.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,S.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,d.validate=d.validate!==!1,this._load(o,d,v)}).catch(()=>{})}loadEmpty(){this.fire(new l.k("dataloading",{dataType:"style"})),this._load(zr,{validate:!1})}_load(o,d,v){var _;const E=d.transformStyle?d.transformStyle(v,o):o;if(!d.validate||!Qi(this,l.x(E))){this._loaded=!0,this.stylesheet=E;for(const O in E.sources)this.addSource(O,E.sources[O],{validate:!1});E.sprite?this._loadSprite(E.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(E.glyphs),this._createLayers(),this.light=new Ze(this.stylesheet.light),this.sky=new wt(this.stylesheet.sky),this.map.setTerrain((_=this.stylesheet.terrain)!==null&&_!==void 0?_:null),this.fire(new l.k("data",{dataType:"style"})),this.fire(new l.k("style.load"))}}_createLayers(){const o=l.aA(this.stylesheet.layers);this.dispatcher.broadcast("SL",o),this._order=o.map(d=>d.id),this._layers={},this._serializedLayers=null;for(const d of o){const v=l.aB(d);v.setEventedParent(this,{layer:{id:d.id}}),this._layers[d.id]=v}}_loadSprite(o,d=!1,v=void 0){let _;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(E,O,z,V){return l._(this,void 0,void 0,function*(){const H=Z(E),J=z>1?"@2x":"",Q={},ce={};for(const{id:fe,url:be}of H){const Pe=O.transformRequest(X(be,J,".json"),"SpriteJSON");Q[fe]=l.h(Pe,V);const Te=O.transformRequest(X(be,J,".png"),"SpriteImage");ce[fe]=B.getImage(Te,V)}return yield Promise.all([...Object.values(Q),...Object.values(ce)]),function(fe,be){return l._(this,void 0,void 0,function*(){const Pe={};for(const Te in fe){Pe[Te]={};const ke=S.getImageCanvasContext((yield be[Te]).data),Ve=(yield fe[Te]).data;for(const Ee in Ve){const{width:qe,height:rt,x:ht,y:At,sdf:Ft,pixelRatio:an,stretchX:sn,stretchY:kt,content:Kt,textFitWidth:pn,textFitHeight:$n}=Ve[Ee];Pe[Te][Ee]={data:null,pixelRatio:an,sdf:Ft,stretchX:sn,stretchY:kt,content:Kt,textFitWidth:pn,textFitHeight:$n,spriteData:{width:qe,height:rt,x:ht,y:At,context:ke}}}}return Pe})}(Q,ce)})}(o,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(E=>{if(this._spriteRequest=null,E)for(const O in E){this._spritesImagesIds[O]=[];const z=this._spritesImagesIds[O]?this._spritesImagesIds[O].filter(V=>!(V in E)):[];for(const V of z)this.imageManager.removeImage(V),this._changedImages[V]=!0;for(const V in E[O]){const H=O==="default"?V:`${O}:${V}`;this._spritesImagesIds[O].push(H),H in this.imageManager.images?this.imageManager.updateImage(H,E[O][V],!1):this.imageManager.addImage(H,E[O][V]),d&&(this._changedImages[H]=!0)}}}).catch(E=>{this._spriteRequest=null,_=E,this.fire(new l.j(_))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),d&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new l.k("data",{dataType:"style"})),v&&v(_)})}_unloadSprite(){for(const o of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(o),this._changedImages[o]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new l.k("data",{dataType:"style"}))}_validateLayer(o){const d=this.sourceCaches[o.source];if(!d)return;const v=o.sourceLayer;if(!v)return;const _=d.getSource();(_.type==="geojson"||_.vectorLayerIds&&_.vectorLayerIds.indexOf(v)===-1)&&this.fire(new l.j(new Error(`Source layer "${v}" does not exist on source "${_.id}" as specified by style layer "${o.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const o in this.sourceCaches)if(!this.sourceCaches[o].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(o){const d=this._serializedAllLayers();if(!o||o.length===0)return Object.values(d);const v=[];for(const _ of o)d[_]&&v.push(d[_]);return v}_serializedAllLayers(){let o=this._serializedLayers;if(o)return o;o=this._serializedLayers={};const d=Object.keys(this._layers);for(const v of d){const _=this._layers[v];_.type!=="custom"&&(o[v]=_.serialize())}return o}hasTransitions(){if(this.light&&this.light.hasTransition()||this.sky&&this.sky.hasTransition())return!0;for(const o in this.sourceCaches)if(this.sourceCaches[o].hasTransition())return!0;for(const o in this._layers)if(this._layers[o].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(o){if(!this._loaded)return;const d=this._changed;if(d){const _=Object.keys(this._updatedLayers),E=Object.keys(this._removedLayers);(_.length||E.length)&&this._updateWorkerLayers(_,E);for(const O in this._updatedSources){const z=this._updatedSources[O];if(z==="reload")this._reloadSource(O);else{if(z!=="clear")throw new Error(`Invalid action ${z}`);this._clearSource(O)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const O in this._updatedPaintProps)this._layers[O].updateTransitions(o);this.light.updateTransitions(o),this.sky.updateTransitions(o),this._resetUpdates()}const v={};for(const _ in this.sourceCaches){const E=this.sourceCaches[_];v[_]=E.used,E.used=!1}for(const _ of this._order){const E=this._layers[_];E.recalculate(o,this._availableImages),!E.isHidden(o.zoom)&&E.source&&(this.sourceCaches[E.source].used=!0)}for(const _ in v){const E=this.sourceCaches[_];!!v[_]!=!!E.used&&E.fire(new l.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:_}))}this.light.recalculate(o),this.sky.recalculate(o),this.z=o.zoom,d&&this.fire(new l.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const o=Object.keys(this._changedImages);if(o.length){for(const d in this.sourceCaches)this.sourceCaches[d].reloadTilesForDependencies(["icons","patterns"],o);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const o in this.sourceCaches)this.sourceCaches[o].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(o,d){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(o),removedIds:d})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(o,d={}){var v;this._checkLoaded();const _=this.serialize();if(o=d.transformStyle?d.transformStyle(_,o):o,((v=d.validate)===null||v===void 0||v)&&Qi(this,l.x(o)))return!1;(o=l.aC(o)).layers=l.aA(o.layers);const E=l.aD(_,o),O=this._getOperationsToPerform(E);if(O.unimplemented.length>0)throw new Error(`Unimplemented: ${O.unimplemented.join(", ")}.`);if(O.operations.length===0)return!1;for(const z of O.operations)z();return this.stylesheet=o,this._serializedLayers=null,!0}_getOperationsToPerform(o){const d=[],v=[];for(const _ of o)switch(_.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":d.push(()=>this.addLayer.apply(this,_.args));break;case"removeLayer":d.push(()=>this.removeLayer.apply(this,_.args));break;case"setPaintProperty":d.push(()=>this.setPaintProperty.apply(this,_.args));break;case"setLayoutProperty":d.push(()=>this.setLayoutProperty.apply(this,_.args));break;case"setFilter":d.push(()=>this.setFilter.apply(this,_.args));break;case"addSource":d.push(()=>this.addSource.apply(this,_.args));break;case"removeSource":d.push(()=>this.removeSource.apply(this,_.args));break;case"setLayerZoomRange":d.push(()=>this.setLayerZoomRange.apply(this,_.args));break;case"setLight":d.push(()=>this.setLight.apply(this,_.args));break;case"setGeoJSONSourceData":d.push(()=>this.setGeoJSONSourceData.apply(this,_.args));break;case"setGlyphs":d.push(()=>this.setGlyphs.apply(this,_.args));break;case"setSprite":d.push(()=>this.setSprite.apply(this,_.args));break;case"setSky":d.push(()=>this.setSky.apply(this,_.args));break;case"setTerrain":d.push(()=>this.map.setTerrain.apply(this,_.args));break;case"setTransition":d.push(()=>{});break;default:v.push(_.command)}return{operations:d,unimplemented:v}}addImage(o,d){if(this.getImage(o))return this.fire(new l.j(new Error(`An image named "${o}" already exists.`)));this.imageManager.addImage(o,d),this._afterImageUpdated(o)}updateImage(o,d){this.imageManager.updateImage(o,d)}getImage(o){return this.imageManager.getImage(o)}removeImage(o){if(!this.getImage(o))return this.fire(new l.j(new Error(`An image named "${o}" does not exist.`)));this.imageManager.removeImage(o),this._afterImageUpdated(o)}_afterImageUpdated(o){this._availableImages=this.imageManager.listImages(),this._changedImages[o]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new l.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(o,d,v={}){if(this._checkLoaded(),this.sourceCaches[o]!==void 0)throw new Error(`Source "${o}" already exists.`);if(!d.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(d).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(d.type)>=0&&this._validate(l.x.source,`sources.${o}`,d,null,v))return;this.map&&this.map._collectResourceTiming&&(d.collectResourceTiming=!0);const _=this.sourceCaches[o]=new Vt(o,d,this.dispatcher);_.style=this,_.setEventedParent(this,()=>({isSourceLoaded:_.loaded(),source:_.serialize(),sourceId:o})),_.onAdd(this.map),this._changed=!0}removeSource(o){if(this._checkLoaded(),this.sourceCaches[o]===void 0)throw new Error("There is no source with this ID");for(const v in this._layers)if(this._layers[v].source===o)return this.fire(new l.j(new Error(`Source "${o}" cannot be removed while layer "${v}" is using it.`)));const d=this.sourceCaches[o];delete this.sourceCaches[o],delete this._updatedSources[o],d.fire(new l.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:o})),d.setEventedParent(null),d.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(o,d){if(this._checkLoaded(),this.sourceCaches[o]===void 0)throw new Error(`There is no source with this ID=${o}`);const v=this.sourceCaches[o].getSource();if(v.type!=="geojson")throw new Error(`geojsonSource.type is ${v.type}, which is !== 'geojson`);v.setData(d),this._changed=!0}getSource(o){return this.sourceCaches[o]&&this.sourceCaches[o].getSource()}addLayer(o,d,v={}){this._checkLoaded();const _=o.id;if(this.getLayer(_))return void this.fire(new l.j(new Error(`Layer "${_}" already exists on this map.`)));let E;if(o.type==="custom"){if(Qi(this,l.aE(o)))return;E=l.aB(o)}else{if("source"in o&&typeof o.source=="object"&&(this.addSource(_,o.source),o=l.aC(o),o=l.e(o,{source:_})),this._validate(l.x.layer,`layers.${_}`,o,{arrayIndex:-1},v))return;E=l.aB(o),this._validateLayer(E),E.setEventedParent(this,{layer:{id:_}})}const O=d?this._order.indexOf(d):this._order.length;if(d&&O===-1)this.fire(new l.j(new Error(`Cannot add layer "${_}" before non-existing layer "${d}".`)));else{if(this._order.splice(O,0,_),this._layerOrderChanged=!0,this._layers[_]=E,this._removedLayers[_]&&E.source&&E.type!=="custom"){const z=this._removedLayers[_];delete this._removedLayers[_],z.type!==E.type?this._updatedSources[E.source]="clear":(this._updatedSources[E.source]="reload",this.sourceCaches[E.source].pause())}this._updateLayer(E),E.onAdd&&E.onAdd(this.map)}}moveLayer(o,d){if(this._checkLoaded(),this._changed=!0,!this._layers[o])return void this.fire(new l.j(new Error(`The layer '${o}' does not exist in the map's style and cannot be moved.`)));if(o===d)return;const v=this._order.indexOf(o);this._order.splice(v,1);const _=d?this._order.indexOf(d):this._order.length;d&&_===-1?this.fire(new l.j(new Error(`Cannot move layer "${o}" before non-existing layer "${d}".`))):(this._order.splice(_,0,o),this._layerOrderChanged=!0)}removeLayer(o){this._checkLoaded();const d=this._layers[o];if(!d)return void this.fire(new l.j(new Error(`Cannot remove non-existing layer "${o}".`)));d.setEventedParent(null);const v=this._order.indexOf(o);this._order.splice(v,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[o]=d,delete this._layers[o],this._serializedLayers&&delete this._serializedLayers[o],delete this._updatedLayers[o],delete this._updatedPaintProps[o],d.onRemove&&d.onRemove(this.map)}getLayer(o){return this._layers[o]}getLayersOrder(){return[...this._order]}hasLayer(o){return o in this._layers}setLayerZoomRange(o,d,v){this._checkLoaded();const _=this.getLayer(o);_?_.minzoom===d&&_.maxzoom===v||(d!=null&&(_.minzoom=d),v!=null&&(_.maxzoom=v),this._updateLayer(_)):this.fire(new l.j(new Error(`Cannot set the zoom range of non-existing layer "${o}".`)))}setFilter(o,d,v={}){this._checkLoaded();const _=this.getLayer(o);if(_){if(!l.aF(_.filter,d))return d==null?(_.filter=void 0,void this._updateLayer(_)):void(this._validate(l.x.filter,`layers.${_.id}.filter`,d,null,v)||(_.filter=l.aC(d),this._updateLayer(_)))}else this.fire(new l.j(new Error(`Cannot filter non-existing layer "${o}".`)))}getFilter(o){return l.aC(this.getLayer(o).filter)}setLayoutProperty(o,d,v,_={}){this._checkLoaded();const E=this.getLayer(o);E?l.aF(E.getLayoutProperty(d),v)||(E.setLayoutProperty(d,v,_),this._updateLayer(E)):this.fire(new l.j(new Error(`Cannot style non-existing layer "${o}".`)))}getLayoutProperty(o,d){const v=this.getLayer(o);if(v)return v.getLayoutProperty(d);this.fire(new l.j(new Error(`Cannot get style of non-existing layer "${o}".`)))}setPaintProperty(o,d,v,_={}){this._checkLoaded();const E=this.getLayer(o);E?l.aF(E.getPaintProperty(d),v)||(E.setPaintProperty(d,v,_)&&this._updateLayer(E),this._changed=!0,this._updatedPaintProps[o]=!0,this._serializedLayers=null):this.fire(new l.j(new Error(`Cannot style non-existing layer "${o}".`)))}getPaintProperty(o,d){return this.getLayer(o).getPaintProperty(d)}setFeatureState(o,d){this._checkLoaded();const v=o.source,_=o.sourceLayer,E=this.sourceCaches[v];if(E===void 0)return void this.fire(new l.j(new Error(`The source '${v}' does not exist in the map's style.`)));const O=E.getSource().type;O==="geojson"&&_?this.fire(new l.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):O!=="vector"||_?(o.id===void 0&&this.fire(new l.j(new Error("The feature id parameter must be provided."))),E.setFeatureState(_,o.id,d)):this.fire(new l.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(o,d){this._checkLoaded();const v=o.source,_=this.sourceCaches[v];if(_===void 0)return void this.fire(new l.j(new Error(`The source '${v}' does not exist in the map's style.`)));const E=_.getSource().type,O=E==="vector"?o.sourceLayer:void 0;E!=="vector"||O?d&&typeof o.id!="string"&&typeof o.id!="number"?this.fire(new l.j(new Error("A feature id is required to remove its specific state property."))):_.removeFeatureState(O,o.id,d):this.fire(new l.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(o){this._checkLoaded();const d=o.source,v=o.sourceLayer,_=this.sourceCaches[d];if(_!==void 0)return _.getSource().type!=="vector"||v?(o.id===void 0&&this.fire(new l.j(new Error("The feature id parameter must be provided."))),_.getFeatureState(v,o.id)):void this.fire(new l.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new l.j(new Error(`The source '${d}' does not exist in the map's style.`)))}getTransition(){return l.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const o=l.aG(this.sourceCaches,E=>E.serialize()),d=this._serializeByIds(this._order),v=this.map.getTerrain()||void 0,_=this.stylesheet;return l.aH({version:_.version,name:_.name,metadata:_.metadata,light:_.light,sky:_.sky,center:_.center,zoom:_.zoom,bearing:_.bearing,pitch:_.pitch,sprite:_.sprite,glyphs:_.glyphs,transition:_.transition,sources:o,layers:d,terrain:v},E=>E!==void 0)}_updateLayer(o){this._updatedLayers[o.id]=!0,o.source&&!this._updatedSources[o.source]&&this.sourceCaches[o.source].getSource().type!=="raster"&&(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(o){const d=O=>this._layers[O].type==="fill-extrusion",v={},_=[];for(let O=this._order.length-1;O>=0;O--){const z=this._order[O];if(d(z)){v[z]=O;for(const V of o){const H=V[z];if(H)for(const J of H)_.push(J)}}}_.sort((O,z)=>z.intersectionZ-O.intersectionZ);const E=[];for(let O=this._order.length-1;O>=0;O--){const z=this._order[O];if(d(z))for(let V=_.length-1;V>=0;V--){const H=_[V].feature;if(v[H.layer.id]<O)break;E.push(H),_.pop()}else for(const V of o){const H=V[z];if(H)for(const J of H)E.push(J.feature)}}return E}queryRenderedFeatures(o,d,v){d&&d.filter&&this._validate(l.x.filter,"queryRenderedFeatures.filter",d.filter,null,d);const _={};if(d&&d.layers){if(!Array.isArray(d.layers))return this.fire(new l.j(new Error("parameters.layers must be an Array."))),[];for(const z of d.layers){const V=this._layers[z];if(!V)return this.fire(new l.j(new Error(`The layer '${z}' does not exist in the map's style and cannot be queried for features.`))),[];_[V.source]=!0}}const E=[];d.availableImages=this._availableImages;const O=this._serializedAllLayers();for(const z in this.sourceCaches)d.layers&&!_[z]||E.push(Jn(this.sourceCaches[z],this._layers,O,o,d,v));return this.placement&&E.push(function(z,V,H,J,Q,ce,fe){const be={},Pe=ce.queryRenderedSymbols(J),Te=[];for(const ke of Object.keys(Pe).map(Number))Te.push(fe[ke]);Te.sort(Ln);for(const ke of Te){const Ve=ke.featureIndex.lookupSymbolFeatures(Pe[ke.bucketInstanceId],V,ke.bucketIndex,ke.sourceLayerIndex,Q.filter,Q.layers,Q.availableImages,z);for(const Ee in Ve){const qe=be[Ee]=be[Ee]||[],rt=Ve[Ee];rt.sort((ht,At)=>{const Ft=ke.featureSortOrder;if(Ft){const an=Ft.indexOf(ht.featureIndex);return Ft.indexOf(At.featureIndex)-an}return At.featureIndex-ht.featureIndex});for(const ht of rt)qe.push(ht)}}for(const ke in be)be[ke].forEach(Ve=>{const Ee=Ve.feature,qe=H[z[ke].source].getFeatureState(Ee.layer["source-layer"],Ee.id);Ee.source=Ee.layer.source,Ee.layer["source-layer"]&&(Ee.sourceLayer=Ee.layer["source-layer"]),Ee.state=qe});return be}(this._layers,O,this.sourceCaches,o,d,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(E)}querySourceFeatures(o,d){d&&d.filter&&this._validate(l.x.filter,"querySourceFeatures.filter",d.filter,null,d);const v=this.sourceCaches[o];return v?function(_,E){const O=_.getRenderableIds().map(H=>_.getTileByID(H)),z=[],V={};for(let H=0;H<O.length;H++){const J=O[H],Q=J.tileID.canonical.key;V[Q]||(V[Q]=!0,J.querySourceFeatures(z,E))}return z}(v,d):[]}getLight(){return this.light.getLight()}setLight(o,d={}){this._checkLoaded();const v=this.light.getLight();let _=!1;for(const O in o)if(!l.aF(o[O],v[O])){_=!0;break}if(!_)return;const E={now:S.now(),transition:l.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(o,d),this.light.updateTransitions(E)}getSky(){var o;return(o=this.stylesheet)===null||o===void 0?void 0:o.sky}setSky(o,d={}){const v=this.sky.getSky();let _=!1;o||v&&(_=!0);for(const O in o)if(!l.aF(o[O],v[O])){_=!0;break}if(!_)return;const E={now:S.now(),transition:l.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=o,this.sky.setSky(o,d),this.sky.updateTransitions(E)}_validate(o,d,v,_,E={}){return(!E||E.validate!==!1)&&Qi(this,o.call(l.x,l.e({key:d,style:this.serialize(),value:v,styleSpec:l.v},_)))}_remove(o=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),on().off(it,this._rtlPluginLoaded);for(const d in this._layers)this._layers[d].setEventedParent(null);for(const d in this.sourceCaches){const v=this.sourceCaches[d];v.setEventedParent(null),v.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),o&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(o)}_clearSource(o){this.sourceCaches[o].clearTiles()}_reloadSource(o){this.sourceCaches[o].resume(),this.sourceCaches[o].reload()}_updateSources(o){for(const d in this.sourceCaches)this.sourceCaches[d].update(o,this.map.terrain)}_generateCollisionBoxes(){for(const o in this.sourceCaches)this._reloadSource(o)}_updatePlacement(o,d,v,_,E=!1){let O=!1,z=!1;const V={};for(const H of this._order){const J=this._layers[H];if(J.type!=="symbol")continue;if(!V[J.source]){const ce=this.sourceCaches[J.source];V[J.source]=ce.getRenderableIds(!0).map(fe=>ce.getTileByID(fe)).sort((fe,be)=>be.tileID.overscaledZ-fe.tileID.overscaledZ||(fe.tileID.isLessThan(be.tileID)?-1:1))}const Q=this.crossTileSymbolIndex.addLayer(J,V[J.source],o.center.lng);O=O||Q}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((E=E||this._layerOrderChanged||v===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(S.now(),o.zoom))&&(this.pauseablePlacement=new di(o,this.map.terrain,this._order,E,d,v,_,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,V),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(S.now()),z=!0),O&&this.pauseablePlacement.placement.setStale()),z||O)for(const H of this._order){const J=this._layers[H];J.type==="symbol"&&this.placement.updateLayerOpacities(J,V[J.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(S.now())}_releaseSymbolFadeTiles(){for(const o in this.sourceCaches)this.sourceCaches[o].releaseSymbolFadeTiles()}getImages(o,d){return l._(this,void 0,void 0,function*(){const v=yield this.imageManager.getImages(d.icons);this._updateTilesForChangedImages();const _=this.sourceCaches[d.source];return _&&_.setDependencies(d.tileID.key,d.type,d.icons),v})}getGlyphs(o,d){return l._(this,void 0,void 0,function*(){const v=yield this.glyphManager.getGlyphs(d.stacks),_=this.sourceCaches[d.source];return _&&_.setDependencies(d.tileID.key,d.type,[""]),v})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(o,d={}){this._checkLoaded(),o&&this._validate(l.x.glyphs,"glyphs",o,null,d)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=o,this.glyphManager.entries={},this.glyphManager.setURL(o))}addSprite(o,d,v={},_){this._checkLoaded();const E=[{id:o,url:d}],O=[...Z(this.stylesheet.sprite),...E];this._validate(l.x.sprite,"sprite",O,null,v)||(this.stylesheet.sprite=O,this._loadSprite(E,!0,_))}removeSprite(o){this._checkLoaded();const d=Z(this.stylesheet.sprite);if(d.find(v=>v.id===o)){if(this._spritesImagesIds[o])for(const v of this._spritesImagesIds[o])this.imageManager.removeImage(v),this._changedImages[v]=!0;d.splice(d.findIndex(v=>v.id===o),1),this.stylesheet.sprite=d.length>0?d:void 0,delete this._spritesImagesIds[o],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new l.k("data",{dataType:"style"}))}else this.fire(new l.j(new Error(`Sprite "${o}" doesn't exists on this map.`)))}getSprite(){return Z(this.stylesheet.sprite)}setSprite(o,d={},v){this._checkLoaded(),o&&this._validate(l.x.sprite,"sprite",o,null,d)||(this.stylesheet.sprite=o,o?this._loadSprite(o,!0,v):(this._unloadSprite(),v&&v(null)))}}var Qr=l.Y([{name:"a_pos",type:"Int16",components:2}]);const uo={prelude:yi(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:yi(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:yi(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:yi(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:yi("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:yi(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:yi(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:yi("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_anchor_pos;attribute vec2 a_placed;attribute vec2 a_box_real;uniform mat4 u_matrix;uniform vec2 u_pixel_extrude_scale;varying float v_placed;varying float v_notUsed;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:yi("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:yi("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:yi(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:yi(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:yi(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:yi(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:yi(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:yi(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:yi(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:yi(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:yi(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:yi(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:yi(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:yi(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:yi(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:yi(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_tex;varying float v_fade_opacity;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:yi(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_data0;varying vec3 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:yi(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec4 v_data0;varying vec4 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:yi("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;varying vec2 v_texture_pos;varying float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture2D(u_texture,v_texture_pos);if (v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);gl_FragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {gl_FragColor=surface_color;}}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform mat4 u_fog_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:yi("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:yi("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);}"),sky:yi("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform float u_horizon;uniform float u_sky_horizon_blend;void main() {float y=gl_FragCoord.y;if (y > u_horizon) {float blend=y-u_horizon;if (blend < u_sky_horizon_blend) {gl_FragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {gl_FragColor=u_sky_color;}}}","attribute vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function yi(M,o){const d=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,v=o.match(/attribute ([\w]+) ([\w]+)/g),_=M.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),E=o.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),O=E?E.concat(_):_,z={};return{fragmentSource:M=M.replace(d,(V,H,J,Q,ce)=>(z[ce]=!0,H==="define"?`
#ifndef HAS_UNIFORM_u_${ce}
varying ${J} ${Q} ${ce};
#else
uniform ${J} ${Q} u_${ce};
#endif
`:`
#ifdef HAS_UNIFORM_u_${ce}
    ${J} ${Q} ${ce} = u_${ce};
#endif
`)),vertexSource:o=o.replace(d,(V,H,J,Q,ce)=>{const fe=Q==="float"?"vec2":"vec4",be=ce.match(/color/)?"color":fe;return z[ce]?H==="define"?`
#ifndef HAS_UNIFORM_u_${ce}
uniform lowp float u_${ce}_t;
attribute ${J} ${fe} a_${ce};
varying ${J} ${Q} ${ce};
#else
uniform ${J} ${Q} u_${ce};
#endif
`:be==="vec4"?`
#ifndef HAS_UNIFORM_u_${ce}
    ${ce} = a_${ce};
#else
    ${J} ${Q} ${ce} = u_${ce};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ce}
    ${ce} = unpack_mix_${be}(a_${ce}, u_${ce}_t);
#else
    ${J} ${Q} ${ce} = u_${ce};
#endif
`:H==="define"?`
#ifndef HAS_UNIFORM_u_${ce}
uniform lowp float u_${ce}_t;
attribute ${J} ${fe} a_${ce};
#else
uniform ${J} ${Q} u_${ce};
#endif
`:be==="vec4"?`
#ifndef HAS_UNIFORM_u_${ce}
    ${J} ${Q} ${ce} = a_${ce};
#else
    ${J} ${Q} ${ce} = u_${ce};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ce}
    ${J} ${Q} ${ce} = unpack_mix_${be}(a_${ce}, u_${ce}_t);
#else
    ${J} ${Q} ${ce} = u_${ce};
#endif
`}),staticAttributes:v,staticUniforms:O}}class il{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(o,d,v,_,E,O,z,V,H){this.context=o;let J=this.boundPaintVertexBuffers.length!==_.length;for(let Q=0;!J&&Q<_.length;Q++)this.boundPaintVertexBuffers[Q]!==_[Q]&&(J=!0);!this.vao||this.boundProgram!==d||this.boundLayoutVertexBuffer!==v||J||this.boundIndexBuffer!==E||this.boundVertexOffset!==O||this.boundDynamicVertexBuffer!==z||this.boundDynamicVertexBuffer2!==V||this.boundDynamicVertexBuffer3!==H?this.freshBind(d,v,_,E,O,z,V,H):(o.bindVertexArray.set(this.vao),z&&z.bind(),E&&E.dynamicDraw&&E.bind(),V&&V.bind(),H&&H.bind())}freshBind(o,d,v,_,E,O,z,V){const H=o.numAttributes,J=this.context,Q=J.gl;this.vao&&this.destroy(),this.vao=J.createVertexArray(),J.bindVertexArray.set(this.vao),this.boundProgram=o,this.boundLayoutVertexBuffer=d,this.boundPaintVertexBuffers=v,this.boundIndexBuffer=_,this.boundVertexOffset=E,this.boundDynamicVertexBuffer=O,this.boundDynamicVertexBuffer2=z,this.boundDynamicVertexBuffer3=V,d.enableAttributes(Q,o);for(const ce of v)ce.enableAttributes(Q,o);O&&O.enableAttributes(Q,o),z&&z.enableAttributes(Q,o),V&&V.enableAttributes(Q,o),d.bind(),d.setVertexAttribPointers(Q,o,E);for(const ce of v)ce.bind(),ce.setVertexAttribPointers(Q,o,E);O&&(O.bind(),O.setVertexAttribPointers(Q,o,E)),_&&_.bind(),z&&(z.bind(),z.setVertexAttribPointers(Q,o,E)),V&&(V.bind(),V.setVertexAttribPointers(Q,o,E)),J.currentNumAttributes=H}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const zp=(M,o,d,v,_)=>({u_matrix:M,u_texture:0,u_ele_delta:o,u_fog_matrix:d,u_fog_color:v?v.properties.get("fog-color"):l.aN.white,u_fog_ground_blend:v?v.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:v?v.calculateFogBlendOpacity(_):0,u_horizon_color:v?v.properties.get("horizon-color"):l.aN.white,u_horizon_fog_blend:v?v.properties.get("horizon-fog-blend"):1});function du(M){const o=[];for(let d=0;d<M.length;d++){if(M[d]===null)continue;const v=M[d].split(" ");o.push(v.pop())}return o}class fu{constructor(o,d,v,_,E,O){const z=o.gl;this.program=z.createProgram();const V=du(d.staticAttributes),H=v?v.getBinderAttributes():[],J=V.concat(H),Q=uo.prelude.staticUniforms?du(uo.prelude.staticUniforms):[],ce=d.staticUniforms?du(d.staticUniforms):[],fe=v?v.getBinderUniforms():[],be=Q.concat(ce).concat(fe),Pe=[];for(const ht of be)Pe.indexOf(ht)<0&&Pe.push(ht);const Te=v?v.defines():[];E&&Te.push("#define OVERDRAW_INSPECTOR;"),O&&Te.push("#define TERRAIN3D;");const ke=Te.concat(uo.prelude.fragmentSource,d.fragmentSource).join(`
`),Ve=Te.concat(uo.prelude.vertexSource,d.vertexSource).join(`
`),Ee=z.createShader(z.FRAGMENT_SHADER);if(z.isContextLost())return void(this.failedToCreate=!0);if(z.shaderSource(Ee,ke),z.compileShader(Ee),!z.getShaderParameter(Ee,z.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${z.getShaderInfoLog(Ee)}`);z.attachShader(this.program,Ee);const qe=z.createShader(z.VERTEX_SHADER);if(z.isContextLost())return void(this.failedToCreate=!0);if(z.shaderSource(qe,Ve),z.compileShader(qe),!z.getShaderParameter(qe,z.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${z.getShaderInfoLog(qe)}`);z.attachShader(this.program,qe),this.attributes={};const rt={};this.numAttributes=J.length;for(let ht=0;ht<this.numAttributes;ht++)J[ht]&&(z.bindAttribLocation(this.program,ht,J[ht]),this.attributes[J[ht]]=ht);if(z.linkProgram(this.program),!z.getProgramParameter(this.program,z.LINK_STATUS))throw new Error(`Program failed to link: ${z.getProgramInfoLog(this.program)}`);z.deleteShader(qe),z.deleteShader(Ee);for(let ht=0;ht<Pe.length;ht++){const At=Pe[ht];if(At&&!rt[At]){const Ft=z.getUniformLocation(this.program,At);Ft&&(rt[At]=Ft)}}this.fixedUniforms=_(o,rt),this.terrainUniforms=((ht,At)=>({u_depth:new l.aI(ht,At.u_depth),u_terrain:new l.aI(ht,At.u_terrain),u_terrain_dim:new l.aJ(ht,At.u_terrain_dim),u_terrain_matrix:new l.aK(ht,At.u_terrain_matrix),u_terrain_unpack:new l.aL(ht,At.u_terrain_unpack),u_terrain_exaggeration:new l.aJ(ht,At.u_terrain_exaggeration)}))(o,rt),this.binderUniforms=v?v.getUniforms(o,rt):[]}draw(o,d,v,_,E,O,z,V,H,J,Q,ce,fe,be,Pe,Te,ke,Ve){const Ee=o.gl;if(this.failedToCreate)return;if(o.program.set(this.program),o.setDepthMode(v),o.setStencilMode(_),o.setColorMode(E),o.setCullFace(O),V){o.activeTexture.set(Ee.TEXTURE2),Ee.bindTexture(Ee.TEXTURE_2D,V.depthTexture),o.activeTexture.set(Ee.TEXTURE3),Ee.bindTexture(Ee.TEXTURE_2D,V.texture);for(const rt in this.terrainUniforms)this.terrainUniforms[rt].set(V[rt])}for(const rt in this.fixedUniforms)this.fixedUniforms[rt].set(z[rt]);Pe&&Pe.setUniforms(o,this.binderUniforms,fe,{zoom:be});let qe=0;switch(d){case Ee.LINES:qe=2;break;case Ee.TRIANGLES:qe=3;break;case Ee.LINE_STRIP:qe=1}for(const rt of ce.get()){const ht=rt.vaos||(rt.vaos={});(ht[H]||(ht[H]=new il)).bind(o,this,J,Pe?Pe.getPaintVertexBuffers():[],Q,rt.vertexOffset,Te,ke,Ve),Ee.drawElements(d,rt.primitiveLength*qe,Ee.UNSIGNED_SHORT,rt.primitiveOffset*qe*2)}}}function pu(M,o,d){const v=1/Vn(d,1,o.transform.tileZoom),_=Math.pow(2,d.tileID.overscaledZ),E=d.tileSize*Math.pow(2,o.transform.tileZoom)/_,O=E*(d.tileID.canonical.x+d.tileID.wrap*_),z=E*d.tileID.canonical.y;return{u_image:0,u_texsize:d.imageAtlasTexture.size,u_scale:[v,M.fromScale,M.toScale],u_fade:M.t,u_pixel_coord_upper:[O>>16,z>>16],u_pixel_coord_lower:[65535&O,65535&z]}}const rl=(M,o,d,v)=>{const _=o.style.light,E=_.properties.get("position"),O=[E.x,E.y,E.z],z=function(){var H=new l.A(9);return l.A!=Float32Array&&(H[1]=0,H[2]=0,H[3]=0,H[5]=0,H[6]=0,H[7]=0),H[0]=1,H[4]=1,H[8]=1,H}();_.properties.get("anchor")==="viewport"&&function(H,J){var Q=Math.sin(J),ce=Math.cos(J);H[0]=ce,H[1]=Q,H[2]=0,H[3]=-Q,H[4]=ce,H[5]=0,H[6]=0,H[7]=0,H[8]=1}(z,-o.transform.angle),function(H,J,Q){var ce=J[0],fe=J[1],be=J[2];H[0]=ce*Q[0]+fe*Q[3]+be*Q[6],H[1]=ce*Q[1]+fe*Q[4]+be*Q[7],H[2]=ce*Q[2]+fe*Q[5]+be*Q[8]}(O,O,z);const V=_.properties.get("color");return{u_matrix:M,u_lightpos:O,u_lightintensity:_.properties.get("intensity"),u_lightcolor:[V.r,V.g,V.b],u_vertical_gradient:+d,u_opacity:v}},Eh=(M,o,d,v,_,E,O)=>l.e(rl(M,o,d,v),pu(E,o,O),{u_height_factor:-Math.pow(2,_.overscaledZ)/O.tileSize/8}),mu=M=>({u_matrix:M}),gu=(M,o,d,v)=>l.e(mu(M),pu(d,o,v)),Gv=(M,o)=>({u_matrix:M,u_world:o}),Wv=(M,o,d,v,_)=>l.e(gu(M,o,d,v),{u_world:_}),Np=(M,o,d,v)=>{const _=M.transform;let E,O;if(v.paint.get("circle-pitch-alignment")==="map"){const z=Vn(d,1,_.zoom);E=!0,O=[z,z]}else E=!1,O=_.pixelsToGLUnits;return{u_camera_to_center_distance:_.cameraToCenterDistance,u_scale_with_map:+(v.paint.get("circle-pitch-scale")==="map"),u_matrix:M.translatePosMatrix(o.posMatrix,d,v.paint.get("circle-translate"),v.paint.get("circle-translate-anchor")),u_pitch_with_map:+E,u_device_pixel_ratio:M.pixelRatio,u_extrude_scale:O}},jv=(M,o,d)=>({u_matrix:M,u_inv_matrix:o,u_camera_to_center_distance:d.cameraToCenterDistance,u_viewport_size:[d.width,d.height]}),Fl=(M,o,d=1)=>({u_matrix:M,u_color:o,u_overlay:0,u_overlay_scale:d}),Mh=M=>({u_matrix:M}),ho=(M,o,d,v)=>({u_matrix:M,u_extrude_scale:Vn(o,1,d),u_intensity:v});function Xs(M,o){const d=Math.pow(2,o.canonical.z),v=o.canonical.y;return[new l.Z(0,v/d).toLngLat().lat,new l.Z(0,(v+1)/d).toLngLat().lat]}const Ch=(M,o,d,v)=>{const _=M.transform;return{u_matrix:Zv(M,o,d,v),u_ratio:1/Vn(o,1,_.zoom),u_device_pixel_ratio:M.pixelRatio,u_units_to_pixels:[1/_.pixelsToGLUnits[0],1/_.pixelsToGLUnits[1]]}},sf=(M,o,d,v,_)=>l.e(Ch(M,o,d,_),{u_image:0,u_image_height:v}),qv=(M,o,d,v,_)=>{const E=M.transform,O=sl(o,E);return{u_matrix:Zv(M,o,d,_),u_texsize:o.imageAtlasTexture.size,u_ratio:1/Vn(o,1,E.zoom),u_device_pixel_ratio:M.pixelRatio,u_image:0,u_scale:[O,v.fromScale,v.toScale],u_fade:v.t,u_units_to_pixels:[1/E.pixelsToGLUnits[0],1/E.pixelsToGLUnits[1]]}},Xv=(M,o,d,v,_,E)=>{const O=M.lineAtlas,z=sl(o,M.transform),V=d.layout.get("line-cap")==="round",H=O.getDash(v.from,V),J=O.getDash(v.to,V),Q=H.width*_.fromScale,ce=J.width*_.toScale;return l.e(Ch(M,o,d,E),{u_patternscale_a:[z/Q,-H.height/2],u_patternscale_b:[z/ce,-J.height/2],u_sdfgamma:O.width/(256*Math.min(Q,ce)*M.pixelRatio)/2,u_image:0,u_tex_y_a:H.y,u_tex_y_b:J.y,u_mix:_.t})};function sl(M,o){return 1/Vn(M,1,o.tileZoom)}function Zv(M,o,d,v){return M.translatePosMatrix(v?v.posMatrix:o.tileID.posMatrix,o,d.paint.get("line-translate"),d.paint.get("line-translate-anchor"))}const fx=(M,o,d,v,_)=>{return{u_matrix:M,u_tl_parent:o,u_scale_parent:d,u_buffer_scale:1,u_fade_t:v.mix,u_opacity:v.opacity*_.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:_.paint.get("raster-brightness-min"),u_brightness_high:_.paint.get("raster-brightness-max"),u_saturation_factor:(O=_.paint.get("raster-saturation"),O>0?1-1/(1.001-O):-O),u_contrast_factor:(E=_.paint.get("raster-contrast"),E>0?1/(1-E):1+E),u_spin_weights:px(_.paint.get("raster-hue-rotate"))};var E,O};function px(M){M*=Math.PI/180;const o=Math.sin(M),d=Math.cos(M);return[(2*d+1)/3,(-Math.sqrt(3)*o-d+1)/3,(Math.sqrt(3)*o-d+1)/3]}const Yv=(M,o,d,v,_,E,O,z,V,H,J,Q,ce,fe)=>{const be=O.transform;return{u_is_size_zoom_constant:+(M==="constant"||M==="source"),u_is_size_feature_constant:+(M==="constant"||M==="camera"),u_size_t:o?o.uSizeT:0,u_size:o?o.uSize:0,u_camera_to_center_distance:be.cameraToCenterDistance,u_pitch:be.pitch/360*2*Math.PI,u_rotate_symbol:+d,u_aspect_ratio:be.width/be.height,u_fade_change:O.options.fadeDuration?O.symbolFadeChange:1,u_matrix:z,u_label_plane_matrix:V,u_coord_matrix:H,u_is_text:+Q,u_pitch_with_map:+v,u_is_along_line:_,u_is_variable_anchor:E,u_texsize:ce,u_texture:0,u_translation:J,u_pitched_scale:fe}},Kv=(M,o,d,v,_,E,O,z,V,H,J,Q,ce,fe,be)=>{const Pe=O.transform;return l.e(Yv(M,o,d,v,_,E,O,z,V,H,J,Q,ce,be),{u_gamma_scale:v?Math.cos(Pe._pitch)*Pe.cameraToCenterDistance:1,u_device_pixel_ratio:O.pixelRatio,u_is_halo:1})},hr=(M,o,d,v,_,E,O,z,V,H,J,Q,ce,fe)=>l.e(Kv(M,o,d,v,_,E,O,z,V,H,J,!0,Q,!0,fe),{u_texsize_icon:ce,u_texture_icon:1}),Hi=(M,o,d)=>({u_matrix:M,u_opacity:o,u_color:d}),Bp=(M,o,d,v,_,E)=>l.e(function(O,z,V,H){const J=V.imageManager.getPattern(O.from.toString()),Q=V.imageManager.getPattern(O.to.toString()),{width:ce,height:fe}=V.imageManager.getPixelSize(),be=Math.pow(2,H.tileID.overscaledZ),Pe=H.tileSize*Math.pow(2,V.transform.tileZoom)/be,Te=Pe*(H.tileID.canonical.x+H.tileID.wrap*be),ke=Pe*H.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:J.tl,u_pattern_br_a:J.br,u_pattern_tl_b:Q.tl,u_pattern_br_b:Q.br,u_texsize:[ce,fe],u_mix:z.t,u_pattern_size_a:J.displaySize,u_pattern_size_b:Q.displaySize,u_scale_a:z.fromScale,u_scale_b:z.toScale,u_tile_units_to_pixels:1/Vn(H,1,V.transform.tileZoom),u_pixel_coord_upper:[Te>>16,ke>>16],u_pixel_coord_lower:[65535&Te,65535&ke]}}(v,E,d,_),{u_matrix:M,u_opacity:o}),of={fillExtrusion:(M,o)=>({u_matrix:new l.aK(M,o.u_matrix),u_lightpos:new l.aO(M,o.u_lightpos),u_lightintensity:new l.aJ(M,o.u_lightintensity),u_lightcolor:new l.aO(M,o.u_lightcolor),u_vertical_gradient:new l.aJ(M,o.u_vertical_gradient),u_opacity:new l.aJ(M,o.u_opacity)}),fillExtrusionPattern:(M,o)=>({u_matrix:new l.aK(M,o.u_matrix),u_lightpos:new l.aO(M,o.u_lightpos),u_lightintensity:new l.aJ(M,o.u_lightintensity),u_lightcolor:new l.aO(M,o.u_lightcolor),u_vertical_gradient:new l.aJ(M,o.u_vertical_gradient),u_height_factor:new l.aJ(M,o.u_height_factor),u_image:new l.aI(M,o.u_image),u_texsize:new l.aP(M,o.u_texsize),u_pixel_coord_upper:new l.aP(M,o.u_pixel_coord_upper),u_pixel_coord_lower:new l.aP(M,o.u_pixel_coord_lower),u_scale:new l.aO(M,o.u_scale),u_fade:new l.aJ(M,o.u_fade),u_opacity:new l.aJ(M,o.u_opacity)}),fill:(M,o)=>({u_matrix:new l.aK(M,o.u_matrix)}),fillPattern:(M,o)=>({u_matrix:new l.aK(M,o.u_matrix),u_image:new l.aI(M,o.u_image),u_texsize:new l.aP(M,o.u_texsize),u_pixel_coord_upper:new l.aP(M,o.u_pixel_coord_upper),u_pixel_coord_lower:new l.aP(M,o.u_pixel_coord_lower),u_scale:new l.aO(M,o.u_scale),u_fade:new l.aJ(M,o.u_fade)}),fillOutline:(M,o)=>({u_matrix:new l.aK(M,o.u_matrix),u_world:new l.aP(M,o.u_world)}),fillOutlinePattern:(M,o)=>({u_matrix:new l.aK(M,o.u_matrix),u_world:new l.aP(M,o.u_world),u_image:new l.aI(M,o.u_image),u_texsize:new l.aP(M,o.u_texsize),u_pixel_coord_upper:new l.aP(M,o.u_pixel_coord_upper),u_pixel_coord_lower:new l.aP(M,o.u_pixel_coord_lower),u_scale:new l.aO(M,o.u_scale),u_fade:new l.aJ(M,o.u_fade)}),circle:(M,o)=>({u_camera_to_center_distance:new l.aJ(M,o.u_camera_to_center_distance),u_scale_with_map:new l.aI(M,o.u_scale_with_map),u_pitch_with_map:new l.aI(M,o.u_pitch_with_map),u_extrude_scale:new l.aP(M,o.u_extrude_scale),u_device_pixel_ratio:new l.aJ(M,o.u_device_pixel_ratio),u_matrix:new l.aK(M,o.u_matrix)}),collisionBox:(M,o)=>({u_matrix:new l.aK(M,o.u_matrix),u_pixel_extrude_scale:new l.aP(M,o.u_pixel_extrude_scale)}),collisionCircle:(M,o)=>({u_matrix:new l.aK(M,o.u_matrix),u_inv_matrix:new l.aK(M,o.u_inv_matrix),u_camera_to_center_distance:new l.aJ(M,o.u_camera_to_center_distance),u_viewport_size:new l.aP(M,o.u_viewport_size)}),debug:(M,o)=>({u_color:new l.aM(M,o.u_color),u_matrix:new l.aK(M,o.u_matrix),u_overlay:new l.aI(M,o.u_overlay),u_overlay_scale:new l.aJ(M,o.u_overlay_scale)}),clippingMask:(M,o)=>({u_matrix:new l.aK(M,o.u_matrix)}),heatmap:(M,o)=>({u_extrude_scale:new l.aJ(M,o.u_extrude_scale),u_intensity:new l.aJ(M,o.u_intensity),u_matrix:new l.aK(M,o.u_matrix)}),heatmapTexture:(M,o)=>({u_matrix:new l.aK(M,o.u_matrix),u_world:new l.aP(M,o.u_world),u_image:new l.aI(M,o.u_image),u_color_ramp:new l.aI(M,o.u_color_ramp),u_opacity:new l.aJ(M,o.u_opacity)}),hillshade:(M,o)=>({u_matrix:new l.aK(M,o.u_matrix),u_image:new l.aI(M,o.u_image),u_latrange:new l.aP(M,o.u_latrange),u_light:new l.aP(M,o.u_light),u_shadow:new l.aM(M,o.u_shadow),u_highlight:new l.aM(M,o.u_highlight),u_accent:new l.aM(M,o.u_accent)}),hillshadePrepare:(M,o)=>({u_matrix:new l.aK(M,o.u_matrix),u_image:new l.aI(M,o.u_image),u_dimension:new l.aP(M,o.u_dimension),u_zoom:new l.aJ(M,o.u_zoom),u_unpack:new l.aL(M,o.u_unpack)}),line:(M,o)=>({u_matrix:new l.aK(M,o.u_matrix),u_ratio:new l.aJ(M,o.u_ratio),u_device_pixel_ratio:new l.aJ(M,o.u_device_pixel_ratio),u_units_to_pixels:new l.aP(M,o.u_units_to_pixels)}),lineGradient:(M,o)=>({u_matrix:new l.aK(M,o.u_matrix),u_ratio:new l.aJ(M,o.u_ratio),u_device_pixel_ratio:new l.aJ(M,o.u_device_pixel_ratio),u_units_to_pixels:new l.aP(M,o.u_units_to_pixels),u_image:new l.aI(M,o.u_image),u_image_height:new l.aJ(M,o.u_image_height)}),linePattern:(M,o)=>({u_matrix:new l.aK(M,o.u_matrix),u_texsize:new l.aP(M,o.u_texsize),u_ratio:new l.aJ(M,o.u_ratio),u_device_pixel_ratio:new l.aJ(M,o.u_device_pixel_ratio),u_image:new l.aI(M,o.u_image),u_units_to_pixels:new l.aP(M,o.u_units_to_pixels),u_scale:new l.aO(M,o.u_scale),u_fade:new l.aJ(M,o.u_fade)}),lineSDF:(M,o)=>({u_matrix:new l.aK(M,o.u_matrix),u_ratio:new l.aJ(M,o.u_ratio),u_device_pixel_ratio:new l.aJ(M,o.u_device_pixel_ratio),u_units_to_pixels:new l.aP(M,o.u_units_to_pixels),u_patternscale_a:new l.aP(M,o.u_patternscale_a),u_patternscale_b:new l.aP(M,o.u_patternscale_b),u_sdfgamma:new l.aJ(M,o.u_sdfgamma),u_image:new l.aI(M,o.u_image),u_tex_y_a:new l.aJ(M,o.u_tex_y_a),u_tex_y_b:new l.aJ(M,o.u_tex_y_b),u_mix:new l.aJ(M,o.u_mix)}),raster:(M,o)=>({u_matrix:new l.aK(M,o.u_matrix),u_tl_parent:new l.aP(M,o.u_tl_parent),u_scale_parent:new l.aJ(M,o.u_scale_parent),u_buffer_scale:new l.aJ(M,o.u_buffer_scale),u_fade_t:new l.aJ(M,o.u_fade_t),u_opacity:new l.aJ(M,o.u_opacity),u_image0:new l.aI(M,o.u_image0),u_image1:new l.aI(M,o.u_image1),u_brightness_low:new l.aJ(M,o.u_brightness_low),u_brightness_high:new l.aJ(M,o.u_brightness_high),u_saturation_factor:new l.aJ(M,o.u_saturation_factor),u_contrast_factor:new l.aJ(M,o.u_contrast_factor),u_spin_weights:new l.aO(M,o.u_spin_weights)}),symbolIcon:(M,o)=>({u_is_size_zoom_constant:new l.aI(M,o.u_is_size_zoom_constant),u_is_size_feature_constant:new l.aI(M,o.u_is_size_feature_constant),u_size_t:new l.aJ(M,o.u_size_t),u_size:new l.aJ(M,o.u_size),u_camera_to_center_distance:new l.aJ(M,o.u_camera_to_center_distance),u_pitch:new l.aJ(M,o.u_pitch),u_rotate_symbol:new l.aI(M,o.u_rotate_symbol),u_aspect_ratio:new l.aJ(M,o.u_aspect_ratio),u_fade_change:new l.aJ(M,o.u_fade_change),u_matrix:new l.aK(M,o.u_matrix),u_label_plane_matrix:new l.aK(M,o.u_label_plane_matrix),u_coord_matrix:new l.aK(M,o.u_coord_matrix),u_is_text:new l.aI(M,o.u_is_text),u_pitch_with_map:new l.aI(M,o.u_pitch_with_map),u_is_along_line:new l.aI(M,o.u_is_along_line),u_is_variable_anchor:new l.aI(M,o.u_is_variable_anchor),u_texsize:new l.aP(M,o.u_texsize),u_texture:new l.aI(M,o.u_texture),u_translation:new l.aP(M,o.u_translation),u_pitched_scale:new l.aJ(M,o.u_pitched_scale)}),symbolSDF:(M,o)=>({u_is_size_zoom_constant:new l.aI(M,o.u_is_size_zoom_constant),u_is_size_feature_constant:new l.aI(M,o.u_is_size_feature_constant),u_size_t:new l.aJ(M,o.u_size_t),u_size:new l.aJ(M,o.u_size),u_camera_to_center_distance:new l.aJ(M,o.u_camera_to_center_distance),u_pitch:new l.aJ(M,o.u_pitch),u_rotate_symbol:new l.aI(M,o.u_rotate_symbol),u_aspect_ratio:new l.aJ(M,o.u_aspect_ratio),u_fade_change:new l.aJ(M,o.u_fade_change),u_matrix:new l.aK(M,o.u_matrix),u_label_plane_matrix:new l.aK(M,o.u_label_plane_matrix),u_coord_matrix:new l.aK(M,o.u_coord_matrix),u_is_text:new l.aI(M,o.u_is_text),u_pitch_with_map:new l.aI(M,o.u_pitch_with_map),u_is_along_line:new l.aI(M,o.u_is_along_line),u_is_variable_anchor:new l.aI(M,o.u_is_variable_anchor),u_texsize:new l.aP(M,o.u_texsize),u_texture:new l.aI(M,o.u_texture),u_gamma_scale:new l.aJ(M,o.u_gamma_scale),u_device_pixel_ratio:new l.aJ(M,o.u_device_pixel_ratio),u_is_halo:new l.aI(M,o.u_is_halo),u_translation:new l.aP(M,o.u_translation),u_pitched_scale:new l.aJ(M,o.u_pitched_scale)}),symbolTextAndIcon:(M,o)=>({u_is_size_zoom_constant:new l.aI(M,o.u_is_size_zoom_constant),u_is_size_feature_constant:new l.aI(M,o.u_is_size_feature_constant),u_size_t:new l.aJ(M,o.u_size_t),u_size:new l.aJ(M,o.u_size),u_camera_to_center_distance:new l.aJ(M,o.u_camera_to_center_distance),u_pitch:new l.aJ(M,o.u_pitch),u_rotate_symbol:new l.aI(M,o.u_rotate_symbol),u_aspect_ratio:new l.aJ(M,o.u_aspect_ratio),u_fade_change:new l.aJ(M,o.u_fade_change),u_matrix:new l.aK(M,o.u_matrix),u_label_plane_matrix:new l.aK(M,o.u_label_plane_matrix),u_coord_matrix:new l.aK(M,o.u_coord_matrix),u_is_text:new l.aI(M,o.u_is_text),u_pitch_with_map:new l.aI(M,o.u_pitch_with_map),u_is_along_line:new l.aI(M,o.u_is_along_line),u_is_variable_anchor:new l.aI(M,o.u_is_variable_anchor),u_texsize:new l.aP(M,o.u_texsize),u_texsize_icon:new l.aP(M,o.u_texsize_icon),u_texture:new l.aI(M,o.u_texture),u_texture_icon:new l.aI(M,o.u_texture_icon),u_gamma_scale:new l.aJ(M,o.u_gamma_scale),u_device_pixel_ratio:new l.aJ(M,o.u_device_pixel_ratio),u_is_halo:new l.aI(M,o.u_is_halo),u_translation:new l.aP(M,o.u_translation),u_pitched_scale:new l.aJ(M,o.u_pitched_scale)}),background:(M,o)=>({u_matrix:new l.aK(M,o.u_matrix),u_opacity:new l.aJ(M,o.u_opacity),u_color:new l.aM(M,o.u_color)}),backgroundPattern:(M,o)=>({u_matrix:new l.aK(M,o.u_matrix),u_opacity:new l.aJ(M,o.u_opacity),u_image:new l.aI(M,o.u_image),u_pattern_tl_a:new l.aP(M,o.u_pattern_tl_a),u_pattern_br_a:new l.aP(M,o.u_pattern_br_a),u_pattern_tl_b:new l.aP(M,o.u_pattern_tl_b),u_pattern_br_b:new l.aP(M,o.u_pattern_br_b),u_texsize:new l.aP(M,o.u_texsize),u_mix:new l.aJ(M,o.u_mix),u_pattern_size_a:new l.aP(M,o.u_pattern_size_a),u_pattern_size_b:new l.aP(M,o.u_pattern_size_b),u_scale_a:new l.aJ(M,o.u_scale_a),u_scale_b:new l.aJ(M,o.u_scale_b),u_pixel_coord_upper:new l.aP(M,o.u_pixel_coord_upper),u_pixel_coord_lower:new l.aP(M,o.u_pixel_coord_lower),u_tile_units_to_pixels:new l.aJ(M,o.u_tile_units_to_pixels)}),terrain:(M,o)=>({u_matrix:new l.aK(M,o.u_matrix),u_texture:new l.aI(M,o.u_texture),u_ele_delta:new l.aJ(M,o.u_ele_delta),u_fog_matrix:new l.aK(M,o.u_fog_matrix),u_fog_color:new l.aM(M,o.u_fog_color),u_fog_ground_blend:new l.aJ(M,o.u_fog_ground_blend),u_fog_ground_blend_opacity:new l.aJ(M,o.u_fog_ground_blend_opacity),u_horizon_color:new l.aM(M,o.u_horizon_color),u_horizon_fog_blend:new l.aJ(M,o.u_horizon_fog_blend)}),terrainDepth:(M,o)=>({u_matrix:new l.aK(M,o.u_matrix),u_ele_delta:new l.aJ(M,o.u_ele_delta)}),terrainCoords:(M,o)=>({u_matrix:new l.aK(M,o.u_matrix),u_texture:new l.aI(M,o.u_texture),u_terrain_coords_id:new l.aJ(M,o.u_terrain_coords_id),u_ele_delta:new l.aJ(M,o.u_ele_delta)}),sky:(M,o)=>({u_sky_color:new l.aM(M,o.u_sky_color),u_horizon_color:new l.aM(M,o.u_horizon_color),u_horizon:new l.aJ(M,o.u_horizon),u_sky_horizon_blend:new l.aJ(M,o.u_sky_horizon_blend)})};class Up{constructor(o,d,v){this.context=o;const _=o.gl;this.buffer=_.createBuffer(),this.dynamicDraw=!!v,this.context.unbindVAO(),o.bindElementBuffer.set(this.buffer),_.bufferData(_.ELEMENT_ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?_.DYNAMIC_DRAW:_.STATIC_DRAW),this.dynamicDraw||delete d.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(o){const d=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),d.bufferSubData(d.ELEMENT_ARRAY_BUFFER,0,o.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Vp={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class ba{constructor(o,d,v,_){this.length=d.length,this.attributes=v,this.itemSize=d.bytesPerElement,this.dynamicDraw=_,this.context=o;const E=o.gl;this.buffer=E.createBuffer(),o.bindVertexBuffer.set(this.buffer),E.bufferData(E.ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?E.DYNAMIC_DRAW:E.STATIC_DRAW),this.dynamicDraw||delete d.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(o){if(o.length!==this.length)throw new Error(`Length of new data is ${o.length}, which doesn't match current length of ${this.length}`);const d=this.context.gl;this.bind(),d.bufferSubData(d.ARRAY_BUFFER,0,o.arrayBuffer)}enableAttributes(o,d){for(let v=0;v<this.attributes.length;v++){const _=d.attributes[this.attributes[v].name];_!==void 0&&o.enableVertexAttribArray(_)}}setVertexAttribPointers(o,d,v){for(let _=0;_<this.attributes.length;_++){const E=this.attributes[_],O=d.attributes[E.name];O!==void 0&&o.vertexAttribPointer(O,E.components,o[Vp[E.type]],!1,this.itemSize,E.offset+this.itemSize*(v||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const $p=new WeakMap;function Cc(M){var o;if($p.has(M))return $p.get(M);{const d=(o=M.getParameter(M.VERSION))===null||o===void 0?void 0:o.startsWith("WebGL 2.0");return $p.set(M,d),d}}class _i{constructor(o){this.gl=o.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(o){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Ar extends _i{getDefault(){return l.aN.transparent}set(o){const d=this.current;(o.r!==d.r||o.g!==d.g||o.b!==d.b||o.a!==d.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class Hp extends _i{getDefault(){return 1}set(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)}}class wa extends _i{getDefault(){return 0}set(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)}}class Jv extends _i{getDefault(){return[!0,!0,!0,!0]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||o[2]!==d[2]||o[3]!==d[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class zl extends _i{getDefault(){return!0}set(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)}}class Lo extends _i{getDefault(){return 255}set(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)}}class Gp extends _i{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(o){const d=this.current;(o.func!==d.func||o.ref!==d.ref||o.mask!==d.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)}}class Qv extends _i{getDefault(){const o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||o[2]!==d[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)}}class Wp extends _i{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;o?d.enable(d.STENCIL_TEST):d.disable(d.STENCIL_TEST),this.current=o,this.dirty=!1}}class af extends _i{getDefault(){return[0,1]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)}}class jp extends _i{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;o?d.enable(d.DEPTH_TEST):d.disable(d.DEPTH_TEST),this.current=o,this.dirty=!1}}class qp extends _i{getDefault(){return this.gl.LESS}set(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)}}class Zs extends _i{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;o?d.enable(d.BLEND):d.disable(d.BLEND),this.current=o,this.dirty=!1}}class e0 extends _i{getDefault(){const o=this.gl;return[o.ONE,o.ZERO]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||this.dirty)&&(this.gl.blendFunc(o[0],o[1]),this.current=o,this.dirty=!1)}}class es extends _i{getDefault(){return l.aN.transparent}set(o){const d=this.current;(o.r!==d.r||o.g!==d.g||o.b!==d.b||o.a!==d.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class t0 extends _i{getDefault(){return this.gl.FUNC_ADD}set(o){(o!==this.current||this.dirty)&&(this.gl.blendEquation(o),this.current=o,this.dirty=!1)}}class n0 extends _i{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;o?d.enable(d.CULL_FACE):d.disable(d.CULL_FACE),this.current=o,this.dirty=!1}}class Nl extends _i{getDefault(){return this.gl.BACK}set(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)}}class Th extends _i{getDefault(){return this.gl.CCW}set(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)}}class Tc extends _i{getDefault(){return null}set(o){(o!==this.current||this.dirty)&&(this.gl.useProgram(o),this.current=o,this.dirty=!1)}}class gr extends _i{getDefault(){return this.gl.TEXTURE0}set(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)}}class ta extends _i{getDefault(){const o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||o[2]!==d[2]||o[3]!==d[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class Xp extends _i{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.bindFramebuffer(d.FRAMEBUFFER,o),this.current=o,this.dirty=!1}}class mx extends _i{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.bindRenderbuffer(d.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class lf extends _i{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.bindTexture(d.TEXTURE_2D,o),this.current=o,this.dirty=!1}}class i0 extends _i{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.bindBuffer(d.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class r0 extends _i{getDefault(){return null}set(o){const d=this.gl;d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class Zp extends _i{getDefault(){return null}set(o){var d;if(o===this.current&&!this.dirty)return;const v=this.gl;Cc(v)?v.bindVertexArray(o):(d=v.getExtension("OES_vertex_array_object"))===null||d===void 0||d.bindVertexArrayOES(o),this.current=o,this.dirty=!1}}class Yp extends _i{getDefault(){return 4}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}}class Ac extends _i{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}}class Ys extends _i{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}}class Ah extends _i{constructor(o,d){super(o),this.context=o,this.parent=d}getDefault(){return null}}class cf extends Ah{setDirty(){this.dirty=!0}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}}class uf extends Ah{set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferRenderbuffer(d.FRAMEBUFFER,d.DEPTH_ATTACHMENT,d.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class hf extends Ah{set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferRenderbuffer(d.FRAMEBUFFER,d.DEPTH_STENCIL_ATTACHMENT,d.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class Ph{constructor(o,d,v,_,E){this.context=o,this.width=d,this.height=v;const O=o.gl,z=this.framebuffer=O.createFramebuffer();if(this.colorAttachment=new cf(o,z),_)this.depthAttachment=E?new hf(o,z):new uf(o,z);else if(E)throw new Error("Stencil cannot be set without depth");if(O.checkFramebufferStatus(O.FRAMEBUFFER)!==O.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const o=this.context.gl,d=this.colorAttachment.get();if(d&&o.deleteTexture(d),this.depthAttachment){const v=this.depthAttachment.get();v&&o.deleteRenderbuffer(v)}o.deleteFramebuffer(this.framebuffer)}}class Xi{constructor(o,d,v){this.blendFunction=o,this.blendColor=d,this.mask=v}}Xi.Replace=[1,0],Xi.disabled=new Xi(Xi.Replace,l.aN.transparent,[!1,!1,!1,!1]),Xi.unblended=new Xi(Xi.Replace,l.aN.transparent,[!0,!0,!0,!0]),Xi.alphaBlended=new Xi([1,771],l.aN.transparent,[!0,!0,!0,!0]);class Kp{constructor(o){var d,v;if(this.gl=o,this.clearColor=new Ar(this),this.clearDepth=new Hp(this),this.clearStencil=new wa(this),this.colorMask=new Jv(this),this.depthMask=new zl(this),this.stencilMask=new Lo(this),this.stencilFunc=new Gp(this),this.stencilOp=new Qv(this),this.stencilTest=new Wp(this),this.depthRange=new af(this),this.depthTest=new jp(this),this.depthFunc=new qp(this),this.blend=new Zs(this),this.blendFunc=new e0(this),this.blendColor=new es(this),this.blendEquation=new t0(this),this.cullFace=new n0(this),this.cullFaceSide=new Nl(this),this.frontFace=new Th(this),this.program=new Tc(this),this.activeTexture=new gr(this),this.viewport=new ta(this),this.bindFramebuffer=new Xp(this),this.bindRenderbuffer=new mx(this),this.bindTexture=new lf(this),this.bindVertexBuffer=new i0(this),this.bindElementBuffer=new r0(this),this.bindVertexArray=new Zp(this),this.pixelStoreUnpack=new Yp(this),this.pixelStoreUnpackPremultiplyAlpha=new Ac(this),this.pixelStoreUnpackFlipY=new Ys(this),this.extTextureFilterAnisotropic=o.getExtension("EXT_texture_filter_anisotropic")||o.getExtension("MOZ_EXT_texture_filter_anisotropic")||o.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=o.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=o.getParameter(o.MAX_TEXTURE_SIZE),Cc(o)){this.HALF_FLOAT=o.HALF_FLOAT;const _=o.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(d=o.RGBA16F)!==null&&d!==void 0?d:_==null?void 0:_.RGBA16F_EXT,this.RGB16F=(v=o.RGB16F)!==null&&v!==void 0?v:_==null?void 0:_.RGB16F_EXT,o.getExtension("EXT_color_buffer_float")}else{o.getExtension("EXT_color_buffer_half_float"),o.getExtension("OES_texture_half_float_linear");const _=o.getExtension("OES_texture_half_float");this.HALF_FLOAT=_==null?void 0:_.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(o,d){return new Up(this,o,d)}createVertexBuffer(o,d,v){return new ba(this,o,d,v)}createRenderbuffer(o,d,v){const _=this.gl,E=_.createRenderbuffer();return this.bindRenderbuffer.set(E),_.renderbufferStorage(_.RENDERBUFFER,o,d,v),this.bindRenderbuffer.set(null),E}createFramebuffer(o,d,v,_){return new Ph(this,o,d,v,_)}clear({color:o,depth:d,stencil:v}){const _=this.gl;let E=0;o&&(E|=_.COLOR_BUFFER_BIT,this.clearColor.set(o),this.colorMask.set([!0,!0,!0,!0])),d!==void 0&&(E|=_.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(d),this.depthMask.set(!0)),v!==void 0&&(E|=_.STENCIL_BUFFER_BIT,this.clearStencil.set(v),this.stencilMask.set(255)),_.clear(E)}setCullFace(o){o.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(o.mode),this.frontFace.set(o.frontFace))}setDepthMode(o){o.func!==this.gl.ALWAYS||o.mask?(this.depthTest.set(!0),this.depthFunc.set(o.func),this.depthMask.set(o.mask),this.depthRange.set(o.range)):this.depthTest.set(!1)}setStencilMode(o){o.test.func!==this.gl.ALWAYS||o.mask?(this.stencilTest.set(!0),this.stencilMask.set(o.mask),this.stencilOp.set([o.fail,o.depthFail,o.pass]),this.stencilFunc.set({func:o.test.func,ref:o.ref,mask:o.test.mask})):this.stencilTest.set(!1)}setColorMode(o){l.aF(o.blendFunction,Xi.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(o.blendFunction),this.blendColor.set(o.blendColor)),this.colorMask.set(o.mask)}createVertexArray(){var o;return Cc(this.gl)?this.gl.createVertexArray():(o=this.gl.getExtension("OES_vertex_array_object"))===null||o===void 0?void 0:o.createVertexArrayOES()}deleteVertexArray(o){var d;return Cc(this.gl)?this.gl.deleteVertexArray(o):(d=this.gl.getExtension("OES_vertex_array_object"))===null||d===void 0?void 0:d.deleteVertexArrayOES(o)}unbindVAO(){this.bindVertexArray.set(null)}}class ci{constructor(o,d,v){this.func=o,this.mask=d,this.range=v}}ci.ReadOnly=!1,ci.ReadWrite=!0,ci.disabled=new ci(519,ci.ReadOnly,[0,1]);const Ih=7680;class dr{constructor(o,d,v,_,E,O){this.test=o,this.ref=d,this.mask=v,this.fail=_,this.depthFail=E,this.pass=O}}dr.disabled=new dr({func:519,mask:0},0,0,Ih,Ih,Ih);class er{constructor(o,d,v){this.enable=o,this.mode=d,this.frontFace=v}}let as;function df(M,o,d,v,_){const E=M.context,O=E.gl,z=M.useProgram("collisionBox"),V=[];let H=0,J=0;for(let ke=0;ke<v.length;ke++){const Ve=v[ke],Ee=o.getTile(Ve).getBucket(d);if(!Ee)continue;const qe=_?Ee.textCollisionBox:Ee.iconCollisionBox,rt=Ee.collisionCircleArray;if(rt.length>0){const ht=l.H();l.aR(ht,Ee.placementInvProjMatrix,M.transform.glCoordMatrix),l.aR(ht,ht,Ee.placementViewportMatrix),V.push({circleArray:rt,circleOffset:J,transform:Ve.posMatrix,invTransform:ht,coord:Ve}),H+=rt.length/4,J=H}qe&&z.draw(E,O.LINES,ci.disabled,dr.disabled,M.colorModeForRenderPass(),er.disabled,{u_matrix:Ve.posMatrix,u_pixel_extrude_scale:[1/(Q=M.transform).width,1/Q.height]},M.style.map.terrain&&M.style.map.terrain.getTerrainData(Ve),d.id,qe.layoutVertexBuffer,qe.indexBuffer,qe.segments,null,M.transform.zoom,null,null,qe.collisionVertexBuffer)}var Q;if(!_||!V.length)return;const ce=M.useProgram("collisionCircle"),fe=new l.aS;fe.resize(4*H),fe._trim();let be=0;for(const ke of V)for(let Ve=0;Ve<ke.circleArray.length/4;Ve++){const Ee=4*Ve,qe=ke.circleArray[Ee+0],rt=ke.circleArray[Ee+1],ht=ke.circleArray[Ee+2],At=ke.circleArray[Ee+3];fe.emplace(be++,qe,rt,ht,At,0),fe.emplace(be++,qe,rt,ht,At,1),fe.emplace(be++,qe,rt,ht,At,2),fe.emplace(be++,qe,rt,ht,At,3)}(!as||as.length<2*H)&&(as=function(ke){const Ve=2*ke,Ee=new l.aU;Ee.resize(Ve),Ee._trim();for(let qe=0;qe<Ve;qe++){const rt=6*qe;Ee.uint16[rt+0]=4*qe+0,Ee.uint16[rt+1]=4*qe+1,Ee.uint16[rt+2]=4*qe+2,Ee.uint16[rt+3]=4*qe+2,Ee.uint16[rt+4]=4*qe+3,Ee.uint16[rt+5]=4*qe+0}return Ee}(H));const Pe=E.createIndexBuffer(as,!0),Te=E.createVertexBuffer(fe,l.aT.members,!0);for(const ke of V){const Ve=jv(ke.transform,ke.invTransform,M.transform);ce.draw(E,O.TRIANGLES,ci.disabled,dr.disabled,M.colorModeForRenderPass(),er.disabled,Ve,M.style.map.terrain&&M.style.map.terrain.getTerrainData(ke.coord),d.id,Te,Pe,l.a0.simpleSegment(0,2*ke.circleOffset,ke.circleArray.length,ke.circleArray.length/2),null,M.transform.zoom,null,null,null)}Te.destroy(),Pe.destroy()}er.disabled=new er(!1,1029,2305),er.backCCW=new er(!0,1029,2305);const Pc=l.ao(new Float32Array(16));function Rh(M,o,d,v,_,E){const{horizontalAlign:O,verticalAlign:z}=l.av(M);return new l.P((-(O-.5)*o/_+v[0])*E,(-(z-.5)*d/_+v[1])*E)}function Lh(M,o,d,v,_,E){const O=o.tileAnchorPoint.add(new l.P(o.translation[0],o.translation[1]));if(o.pitchWithMap){let z=v.mult(E);return d||(z=z.rotate(-_)),xe(O.add(z),o.labelPlaneMatrix,o.getElevation).point}if(d){const z=ut(o.tileAnchorPoint.x+1,o.tileAnchorPoint.y,o).point.sub(M),V=Math.atan(z.y/z.x)+(z.x<0?Math.PI:0);return M.add(v.rotate(V))}return M.add(v)}function ff(M,o,d,v,_,E,O,z,V,H,J,Q,ce,fe){const be=M.text.placedSymbolArray,Pe=M.text.dynamicLayoutVertexArray,Te=M.icon.dynamicLayoutVertexArray,ke={};Pe.clear();for(let Ve=0;Ve<be.length;Ve++){const Ee=be.get(Ve),qe=Ee.hidden||!Ee.crossTileID||M.allowVerticalPlacement&&!Ee.placedOrientation?null:v[Ee.crossTileID];if(qe){const rt=new l.P(Ee.anchorX,Ee.anchorY),ht={getElevation:fe,width:_.width,height:_.height,labelPlaneMatrix:E,pitchWithMap:d,projection:J,tileAnchorPoint:rt,translation:Q,unwrappedTileID:ce},At=d?xe(rt,O,fe):ut(rt.x,rt.y,ht),Ft=te(_.cameraToCenterDistance,At.signedDistanceFromCamera);let an=l.aj(M.textSizeData,V,Ee)*Ft/l.aq;d&&(an*=M.tilePixelRatio/z);const{width:sn,height:kt,anchor:Kt,textOffset:pn,textBoxScale:$n}=qe,Jt=Rh(Kt,sn,kt,pn,$n,an),tn=J.getPitchedTextCorrection(_,rt.add(new l.P(Q[0],Q[1])),ce),Un=Lh(At.point,ht,o,Jt,_.angle,tn),rr=M.allowVerticalPlacement&&Ee.placedOrientation===l.ai.vertical?Math.PI/2:0;for(let ei=0;ei<Ee.numGlyphs;ei++)l.ak(Pe,Un,rr);H&&Ee.associatedIconIndex>=0&&(ke[Ee.associatedIconIndex]={shiftedAnchor:Un,angle:rr})}else Sn(Ee.numGlyphs,Pe)}if(H){Te.clear();const Ve=M.icon.placedSymbolArray;for(let Ee=0;Ee<Ve.length;Ee++){const qe=Ve.get(Ee);if(qe.hidden)Sn(qe.numGlyphs,Te);else{const rt=ke[Ee];if(rt)for(let ht=0;ht<qe.numGlyphs;ht++)l.ak(Te,rt.shiftedAnchor,rt.angle);else Sn(qe.numGlyphs,Te)}}M.icon.dynamicLayoutVertexBuffer.updateData(Te)}M.text.dynamicLayoutVertexBuffer.updateData(Pe)}function Jp(M,o,d){return d.iconsInText&&o?"symbolTextAndIcon":M?"symbolSDF":"symbolIcon"}function Bl(M,o,d,v,_,E,O,z,V,H,J,Q){const ce=M.context,fe=ce.gl,be=M.transform,Pe=wi(),Te=z==="map",ke=V==="map",Ve=z!=="viewport"&&d.layout.get("symbol-placement")!=="point",Ee=Te&&!ke&&!Ve,qe=!ke&&Ve,rt=!d.layout.get("symbol-sort-key").isConstant();let ht=!1;const At=M.depthModeForSublayer(0,ci.ReadOnly),Ft=d._unevaluatedLayout.hasValue("text-variable-anchor")||d._unevaluatedLayout.hasValue("text-variable-anchor-offset"),an=[],sn=Pe.getCircleRadiusCorrection(be);for(const kt of v){const Kt=o.getTile(kt),pn=Kt.getBucket(d);if(!pn)continue;const $n=_?pn.text:pn.icon;if(!$n||!$n.segments.get().length||!$n.hasVisibleVertices)continue;const Jt=$n.programConfigurations.get(d.id),tn=_||pn.sdfIcons,Un=_?pn.textSizeData:pn.iconSizeData,rr=ke||be.pitch!==0,ei=M.useProgram(Jp(tn,_,pn),Jt),hi=l.ah(Un,be.zoom),nr=M.style.map.terrain&&M.style.map.terrain.getTerrainData(kt);let Li,yo,ir,_r,ls=[0,0],qr=null;if(_)yo=Kt.glyphAtlasTexture,ir=fe.LINEAR,Li=Kt.glyphAtlasTexture.size,pn.iconsInText&&(ls=Kt.imageAtlasTexture.size,qr=Kt.imageAtlasTexture,_r=rr||M.options.rotating||M.options.zooming||Un.kind==="composite"||Un.kind==="camera"?fe.LINEAR:fe.NEAREST);else{const vr=d.layout.get("icon-size").constantOr(0)!==1||pn.iconsNeedLinear;yo=Kt.imageAtlasTexture,ir=tn||M.options.rotating||M.options.zooming||vr||rr?fe.LINEAR:fe.NEAREST,Li=Kt.imageAtlasTexture.size}const wr=Vn(Kt,1,M.transform.zoom),zo=qe?kt.posMatrix:Pc,Rr=Ct(zo,ke,Te,M.transform,wr),Au=Zt(zo,ke,Te,M.transform,wr),Pu=Zt(kt.posMatrix,ke,Te,M.transform,wr),Oc=Pe.translatePosition(M.transform,Kt,E,O),Ef=Ft&&pn.hasTextData(),Bh=d.layout.get("icon-text-fit")!=="none"&&Ef&&pn.hasIconData();if(Ve){const vr=M.style.map.terrain?(Mf,Xr)=>M.style.map.terrain.getElevation(kt,Mf,Xr):null,Xl=d.layout.get("text-rotation-alignment")==="map";de(pn,kt.posMatrix,M,_,Rr,Pu,ke,H,Xl,Pe,kt.toUnwrapped(),be.width,be.height,Oc,vr)}const cs=kt.posMatrix,Os=_&&Ft||Bh,hl=Ve||Os?Pc:Rr,Iu=Au,ys=tn&&d.paint.get(_?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Br;Br=tn?pn.iconsInText?hr(Un.kind,hi,Ee,ke,Ve,Os,M,cs,hl,Iu,Oc,Li,ls,sn):Kv(Un.kind,hi,Ee,ke,Ve,Os,M,cs,hl,Iu,Oc,_,Li,!0,sn):Yv(Un.kind,hi,Ee,ke,Ve,Os,M,cs,hl,Iu,Oc,_,Li,sn);const ts={program:ei,buffers:$n,uniformValues:Br,atlasTexture:yo,atlasTextureIcon:qr,atlasInterpolation:ir,atlasInterpolationIcon:_r,isSDF:tn,hasHalo:ys};if(rt&&pn.canOverlap){ht=!0;const vr=$n.segments.get();for(const Xl of vr)an.push({segments:new l.a0([Xl]),sortKey:Xl.sortKey,state:ts,terrainData:nr})}else an.push({segments:$n.segments,sortKey:0,state:ts,terrainData:nr})}ht&&an.sort((kt,Kt)=>kt.sortKey-Kt.sortKey);for(const kt of an){const Kt=kt.state;if(ce.activeTexture.set(fe.TEXTURE0),Kt.atlasTexture.bind(Kt.atlasInterpolation,fe.CLAMP_TO_EDGE),Kt.atlasTextureIcon&&(ce.activeTexture.set(fe.TEXTURE1),Kt.atlasTextureIcon&&Kt.atlasTextureIcon.bind(Kt.atlasInterpolationIcon,fe.CLAMP_TO_EDGE)),Kt.isSDF){const pn=Kt.uniformValues;Kt.hasHalo&&(pn.u_is_halo=1,Ic(Kt.buffers,kt.segments,d,M,Kt.program,At,J,Q,pn,kt.terrainData)),pn.u_is_halo=0}Ic(Kt.buffers,kt.segments,d,M,Kt.program,At,J,Q,Kt.uniformValues,kt.terrainData)}}function Ic(M,o,d,v,_,E,O,z,V,H){const J=v.context;_.draw(J,J.gl.TRIANGLES,E,O,z,er.disabled,V,H,d.id,M.layoutVertexBuffer,M.indexBuffer,o,d.paint,v.transform.zoom,M.programConfigurations.get(d.id),M.dynamicLayoutVertexBuffer,M.opacityVertexBuffer)}function fo(M,o,d,v,_){if(!d||!v||!v.imageAtlas)return;const E=v.imageAtlas.patternPositions;let O=E[d.to.toString()],z=E[d.from.toString()];if(!O&&z&&(O=z),!z&&O&&(z=O),!O||!z){const V=_.getPaintProperty(o);O=E[V],z=E[V]}O&&z&&M.setConstantPatternPositions(O,z)}function Ul(M,o,d,v,_,E,O){const z=M.context.gl,V="fill-pattern",H=d.paint.get(V),J=H&&H.constantOr(1),Q=d.getCrossfadeParameters();let ce,fe,be,Pe,Te;O?(fe=J&&!d.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",ce=z.LINES):(fe=J?"fillPattern":"fill",ce=z.TRIANGLES);const ke=H.constantOr(null);for(const Ve of v){const Ee=o.getTile(Ve);if(J&&!Ee.patternsLoaded())continue;const qe=Ee.getBucket(d);if(!qe)continue;const rt=qe.programConfigurations.get(d.id),ht=M.useProgram(fe,rt),At=M.style.map.terrain&&M.style.map.terrain.getTerrainData(Ve);J&&(M.context.activeTexture.set(z.TEXTURE0),Ee.imageAtlasTexture.bind(z.LINEAR,z.CLAMP_TO_EDGE),rt.updatePaintBuffers(Q)),fo(rt,V,ke,Ee,d);const Ft=At?Ve:null,an=M.translatePosMatrix(Ft?Ft.posMatrix:Ve.posMatrix,Ee,d.paint.get("fill-translate"),d.paint.get("fill-translate-anchor"));if(O){Pe=qe.indexBuffer2,Te=qe.segments2;const sn=[z.drawingBufferWidth,z.drawingBufferHeight];be=fe==="fillOutlinePattern"&&J?Wv(an,M,Q,Ee,sn):Gv(an,sn)}else Pe=qe.indexBuffer,Te=qe.segments,be=J?gu(an,M,Q,Ee):mu(an);ht.draw(M.context,ce,_,M.stencilModeForClipping(Ve),E,er.disabled,be,At,d.id,qe.layoutVertexBuffer,Pe,Te,d.paint,M.transform.zoom,rt)}}function pf(M,o,d,v,_,E,O){const z=M.context,V=z.gl,H="fill-extrusion-pattern",J=d.paint.get(H),Q=J.constantOr(1),ce=d.getCrossfadeParameters(),fe=d.paint.get("fill-extrusion-opacity"),be=J.constantOr(null);for(const Pe of v){const Te=o.getTile(Pe),ke=Te.getBucket(d);if(!ke)continue;const Ve=M.style.map.terrain&&M.style.map.terrain.getTerrainData(Pe),Ee=ke.programConfigurations.get(d.id),qe=M.useProgram(Q?"fillExtrusionPattern":"fillExtrusion",Ee);Q&&(M.context.activeTexture.set(V.TEXTURE0),Te.imageAtlasTexture.bind(V.LINEAR,V.CLAMP_TO_EDGE),Ee.updatePaintBuffers(ce)),fo(Ee,H,be,Te,d);const rt=M.translatePosMatrix(Pe.posMatrix,Te,d.paint.get("fill-extrusion-translate"),d.paint.get("fill-extrusion-translate-anchor")),ht=d.paint.get("fill-extrusion-vertical-gradient"),At=Q?Eh(rt,M,ht,fe,Pe,ce,Te):rl(rt,M,ht,fe);qe.draw(z,z.gl.TRIANGLES,_,E,O,er.backCCW,At,Ve,d.id,ke.layoutVertexBuffer,ke.indexBuffer,ke.segments,d.paint,M.transform.zoom,Ee,M.style.map.terrain&&ke.centroidVertexBuffer)}}function Qp(M,o,d,v,_,E,O){const z=M.context,V=z.gl,H=d.fbo;if(!H)return;const J=M.useProgram("hillshade"),Q=M.style.map.terrain&&M.style.map.terrain.getTerrainData(o);z.activeTexture.set(V.TEXTURE0),V.bindTexture(V.TEXTURE_2D,H.colorAttachment.get()),J.draw(z,V.TRIANGLES,_,E,O,er.disabled,((ce,fe,be,Pe)=>{const Te=be.paint.get("hillshade-shadow-color"),ke=be.paint.get("hillshade-highlight-color"),Ve=be.paint.get("hillshade-accent-color");let Ee=be.paint.get("hillshade-illumination-direction")*(Math.PI/180);be.paint.get("hillshade-illumination-anchor")==="viewport"&&(Ee-=ce.transform.angle);const qe=!ce.options.moving;return{u_matrix:Pe?Pe.posMatrix:ce.transform.calculatePosMatrix(fe.tileID.toUnwrapped(),qe),u_image:0,u_latrange:Xs(0,fe.tileID),u_light:[be.paint.get("hillshade-exaggeration"),Ee],u_shadow:Te,u_highlight:ke,u_accent:Ve}})(M,d,v,Q?o:null),Q,v.id,M.rasterBoundsBuffer,M.quadTriangleIndexBuffer,M.rasterBoundsSegments)}function ol(M,o,d,v,_,E){const O=M.context,z=O.gl,V=o.dem;if(V&&V.data){const H=V.dim,J=V.stride,Q=V.getPixels();if(O.activeTexture.set(z.TEXTURE1),O.pixelStoreUnpackPremultiplyAlpha.set(!1),o.demTexture=o.demTexture||M.getTileTexture(J),o.demTexture){const fe=o.demTexture;fe.update(Q,{premultiply:!1}),fe.bind(z.NEAREST,z.CLAMP_TO_EDGE)}else o.demTexture=new se(O,Q,z.RGBA,{premultiply:!1}),o.demTexture.bind(z.NEAREST,z.CLAMP_TO_EDGE);O.activeTexture.set(z.TEXTURE0);let ce=o.fbo;if(!ce){const fe=new se(O,{width:H,height:H,data:null},z.RGBA);fe.bind(z.LINEAR,z.CLAMP_TO_EDGE),ce=o.fbo=O.createFramebuffer(H,H,!0,!1),ce.colorAttachment.set(fe.texture)}O.bindFramebuffer.set(ce.framebuffer),O.viewport.set([0,0,H,H]),M.useProgram("hillshadePrepare").draw(O,z.TRIANGLES,v,_,E,er.disabled,((fe,be)=>{const Pe=be.stride,Te=l.H();return l.aQ(Te,0,l.X,-l.X,0,0,1),l.J(Te,Te,[0,-l.X,0]),{u_matrix:Te,u_image:1,u_dimension:[Pe,Pe],u_zoom:fe.overscaledZ,u_unpack:be.getUnpackVector()}})(o.tileID,V),null,d.id,M.rasterBoundsBuffer,M.quadTriangleIndexBuffer,M.rasterBoundsSegments),o.needsHillshadePrepare=!1}}function kh(M,o,d,v,_,E){const O=v.paint.get("raster-fade-duration");if(!E&&O>0){const z=S.now(),V=(z-M.timeAdded)/O,H=o?(z-o.timeAdded)/O:-1,J=d.getSource(),Q=_.coveringZoomLevel({tileSize:J.tileSize,roundZoom:J.roundZoom}),ce=!o||Math.abs(o.tileID.overscaledZ-Q)>Math.abs(M.tileID.overscaledZ-Q),fe=ce&&M.refreshedUponExpiration?1:l.ad(ce?V:1-H,0,1);return M.refreshedUponExpiration&&V>=1&&(M.refreshedUponExpiration=!1),o?{opacity:1,mix:1-fe}:{opacity:fe,mix:0}}return{opacity:1,mix:0}}const na=new l.aN(1,0,0,1),Vl=new l.aN(0,1,0,1),mf=new l.aN(0,0,1,1),s0=new l.aN(1,0,1,1),vu=new l.aN(0,1,1,1);function ko(M,o,d,v){Rc(M,0,o+d/2,M.transform.width,d,v)}function po(M,o,d,v){Rc(M,o-d/2,0,d,M.transform.height,v)}function Rc(M,o,d,v,_,E){const O=M.context,z=O.gl;z.enable(z.SCISSOR_TEST),z.scissor(o*M.pixelRatio,d*M.pixelRatio,v*M.pixelRatio,_*M.pixelRatio),O.clear({color:E}),z.disable(z.SCISSOR_TEST)}function Ei(M,o,d){const v=M.context,_=v.gl,E=d.posMatrix,O=M.useProgram("debug"),z=ci.disabled,V=dr.disabled,H=M.colorModeForRenderPass(),J="$debug",Q=M.style.map.terrain&&M.style.map.terrain.getTerrainData(d);v.activeTexture.set(_.TEXTURE0);const ce=o.getTileByID(d.key).latestRawTileData,fe=Math.floor((ce&&ce.byteLength||0)/1024),be=o.getTile(d).tileSize,Pe=512/Math.min(be,512)*(d.overscaledZ/M.transform.zoom)*.5;let Te=d.canonical.toString();d.overscaledZ!==d.canonical.z&&(Te+=` => ${d.overscaledZ}`),function(ke,Ve){ke.initDebugOverlayCanvas();const Ee=ke.debugOverlayCanvas,qe=ke.context.gl,rt=ke.debugOverlayCanvas.getContext("2d");rt.clearRect(0,0,Ee.width,Ee.height),rt.shadowColor="white",rt.shadowBlur=2,rt.lineWidth=1.5,rt.strokeStyle="white",rt.textBaseline="top",rt.font="bold 36px Open Sans, sans-serif",rt.fillText(Ve,5,5),rt.strokeText(Ve,5,5),ke.debugOverlayTexture.update(Ee),ke.debugOverlayTexture.bind(qe.LINEAR,qe.CLAMP_TO_EDGE)}(M,`${Te} ${fe}kB`),O.draw(v,_.TRIANGLES,z,V,Xi.alphaBlended,er.disabled,Fl(E,l.aN.transparent,Pe),null,J,M.debugBuffer,M.quadTriangleIndexBuffer,M.debugSegments),O.draw(v,_.LINE_STRIP,z,V,H,er.disabled,Fl(E,l.aN.red),Q,J,M.debugBuffer,M.tileBorderIndexBuffer,M.debugSegments)}function Dh(M,o,d){const v=M.context,_=v.gl,E=M.colorModeForRenderPass(),O=new ci(_.LEQUAL,ci.ReadWrite,M.depthRangeFor3D),z=M.useProgram("terrain"),V=o.getTerrainMesh();v.bindFramebuffer.set(null),v.viewport.set([0,0,M.width,M.height]);for(const H of d){const J=M.renderToTexture.getTexture(H),Q=o.getTerrainData(H.tileID);v.activeTexture.set(_.TEXTURE0),_.bindTexture(_.TEXTURE_2D,J.texture);const ce=M.transform.calculatePosMatrix(H.tileID.toUnwrapped()),fe=o.getMeshFrameDelta(M.transform.zoom),be=M.transform.calculateFogMatrix(H.tileID.toUnwrapped()),Pe=zp(ce,fe,be,M.style.sky,M.transform.pitch);z.draw(v,_.TRIANGLES,O,dr.disabled,E,er.backCCW,Pe,Q,"terrain",V.vertexBuffer,V.indexBuffer,V.segments)}}class o0{constructor(o,d,v){this.vertexBuffer=o,this.indexBuffer=d,this.segments=v}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}class a0{constructor(o,d){this.context=new Kp(o),this.transform=d,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:l.ao(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Vt.maxUnderzooming+Vt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new vs}resize(o,d,v){if(this.width=Math.floor(o*v),this.height=Math.floor(d*v),this.pixelRatio=v,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const _ of this.style._order)this.style._layers[_].resize()}setup(){const o=this.context,d=new l.aX;d.emplaceBack(0,0),d.emplaceBack(l.X,0),d.emplaceBack(0,l.X),d.emplaceBack(l.X,l.X),this.tileExtentBuffer=o.createVertexBuffer(d,Qr.members),this.tileExtentSegments=l.a0.simpleSegment(0,0,4,2);const v=new l.aX;v.emplaceBack(0,0),v.emplaceBack(l.X,0),v.emplaceBack(0,l.X),v.emplaceBack(l.X,l.X),this.debugBuffer=o.createVertexBuffer(v,Qr.members),this.debugSegments=l.a0.simpleSegment(0,0,4,5);const _=new l.$;_.emplaceBack(0,0,0,0),_.emplaceBack(l.X,0,l.X,0),_.emplaceBack(0,l.X,0,l.X),_.emplaceBack(l.X,l.X,l.X,l.X),this.rasterBoundsBuffer=o.createVertexBuffer(_,Xe.members),this.rasterBoundsSegments=l.a0.simpleSegment(0,0,4,2);const E=new l.aX;E.emplaceBack(0,0),E.emplaceBack(1,0),E.emplaceBack(0,1),E.emplaceBack(1,1),this.viewportBuffer=o.createVertexBuffer(E,Qr.members),this.viewportSegments=l.a0.simpleSegment(0,0,4,2);const O=new l.aZ;O.emplaceBack(0),O.emplaceBack(1),O.emplaceBack(3),O.emplaceBack(2),O.emplaceBack(0),this.tileBorderIndexBuffer=o.createIndexBuffer(O);const z=new l.aY;z.emplaceBack(0,1,2),z.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=o.createIndexBuffer(z);const V=this.context.gl;this.stencilClearMode=new dr({func:V.ALWAYS,mask:0},0,255,V.ZERO,V.ZERO,V.ZERO)}clearStencil(){const o=this.context,d=o.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const v=l.H();l.aQ(v,0,this.width,this.height,0,0,1),l.K(v,v,[d.drawingBufferWidth,d.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(o,d.TRIANGLES,ci.disabled,this.stencilClearMode,Xi.disabled,er.disabled,Mh(v),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(o,d){if(this.currentStencilSource===o.source||!o.isTileClipped()||!d||!d.length)return;this.currentStencilSource=o.source;const v=this.context,_=v.gl;this.nextStencilID+d.length>256&&this.clearStencil(),v.setColorMode(Xi.disabled),v.setDepthMode(ci.disabled);const E=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const O of d){const z=this._tileClippingMaskIDs[O.key]=this.nextStencilID++,V=this.style.map.terrain&&this.style.map.terrain.getTerrainData(O);E.draw(v,_.TRIANGLES,ci.disabled,new dr({func:_.ALWAYS,mask:0},z,255,_.KEEP,_.KEEP,_.REPLACE),Xi.disabled,er.disabled,Mh(O.posMatrix),V,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const o=this.nextStencilID++,d=this.context.gl;return new dr({func:d.NOTEQUAL,mask:255},o,255,d.KEEP,d.KEEP,d.REPLACE)}stencilModeForClipping(o){const d=this.context.gl;return new dr({func:d.EQUAL,mask:255},this._tileClippingMaskIDs[o.key],0,d.KEEP,d.KEEP,d.REPLACE)}stencilConfigForOverlap(o){const d=this.context.gl,v=o.sort((O,z)=>z.overscaledZ-O.overscaledZ),_=v[v.length-1].overscaledZ,E=v[0].overscaledZ-_+1;if(E>1){this.currentStencilSource=void 0,this.nextStencilID+E>256&&this.clearStencil();const O={};for(let z=0;z<E;z++)O[z+_]=new dr({func:d.GEQUAL,mask:255},z+this.nextStencilID,255,d.KEEP,d.KEEP,d.REPLACE);return this.nextStencilID+=E,[O,v]}return[{[_]:dr.disabled},v]}colorModeForRenderPass(){const o=this.context.gl;return this._showOverdrawInspector?new Xi([o.CONSTANT_COLOR,o.ONE],new l.aN(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Xi.unblended:Xi.alphaBlended}depthModeForSublayer(o,d,v){if(!this.opaquePassEnabledForLayer())return ci.disabled;const _=1-((1+this.currentLayer)*this.numSublayers+o)*this.depthEpsilon;return new ci(v||this.context.gl.LEQUAL,d,[_,_])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(o,d){var v;this.style=o,this.options=d,this.lineAtlas=o.lineAtlas,this.imageManager=o.imageManager,this.glyphManager=o.glyphManager,this.symbolFadeChange=o.placement.symbolFadeChange(S.now()),this.imageManager.beginFrame();const _=this.style._order,E=this.style.sourceCaches,O={},z={},V={};for(const H in E){const J=E[H];J.used&&J.prepare(this.context),O[H]=J.getVisibleCoordinates(),z[H]=O[H].slice().reverse(),V[H]=J.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let H=0;H<_.length;H++)if(this.style._layers[_[H]].is3D()){this.opaquePassCutoff=H;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const H of _){const J=this.style._layers[H];if(!J.hasOffscreenPass()||J.isHidden(this.transform.zoom))continue;const Q=z[J.source];(J.type==="custom"||Q.length)&&this.renderLayer(this,E[J.source],J,Q)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:d.showOverdrawInspector?l.aN.black:l.aN.transparent,depth:1}),this.clearStencil(),!((v=this.style.stylesheet)===null||v===void 0)&&v.sky&&function(H,J){const Q=H.context,ce=Q.gl,fe=((Ve,Ee,qe)=>({u_sky_color:Ve.properties.get("sky-color"),u_horizon_color:Ve.properties.get("horizon-color"),u_horizon:(Ee.height/2+Ee.getHorizon())*qe,u_sky_horizon_blend:Ve.properties.get("sky-horizon-blend")*Ee.height/2*qe}))(J,H.style.map.transform,H.pixelRatio),be=new ci(ce.LEQUAL,ci.ReadWrite,[0,1]),Pe=dr.disabled,Te=H.colorModeForRenderPass(),ke=H.useProgram("sky");if(!J.mesh){const Ve=new l.aX;Ve.emplaceBack(-1,-1),Ve.emplaceBack(1,-1),Ve.emplaceBack(1,1),Ve.emplaceBack(-1,1);const Ee=new l.aY;Ee.emplaceBack(0,1,2),Ee.emplaceBack(0,2,3),J.mesh=new o0(Q.createVertexBuffer(Ve,Qr.members),Q.createIndexBuffer(Ee),l.a0.simpleSegment(0,0,Ve.length,Ee.length))}ke.draw(Q,ce.TRIANGLES,be,Pe,Te,er.disabled,fe,void 0,"sky",J.mesh.vertexBuffer,J.mesh.indexBuffer,J.mesh.segments)}(this,this.style.sky),this._showOverdrawInspector=d.showOverdrawInspector,this.depthRangeFor3D=[0,1-(o._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=_.length-1;this.currentLayer>=0;this.currentLayer--){const H=this.style._layers[_[this.currentLayer]],J=E[H.source],Q=O[H.source];this._renderTileClippingMasks(H,Q),this.renderLayer(this,J,H,Q)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<_.length;this.currentLayer++){const H=this.style._layers[_[this.currentLayer]],J=E[H.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(H))continue;const Q=(H.type==="symbol"?V:z)[H.source];this._renderTileClippingMasks(H,O[H.source]),this.renderLayer(this,J,H,Q)}if(this.options.showTileBoundaries){const H=function(J,Q){let ce=null;const fe=Object.values(J._layers).flatMap(ke=>ke.source&&!ke.isHidden(Q)?[J.sourceCaches[ke.source]]:[]),be=fe.filter(ke=>ke.getSource().type==="vector"),Pe=fe.filter(ke=>ke.getSource().type!=="vector"),Te=ke=>{(!ce||ce.getSource().maxzoom<ke.getSource().maxzoom)&&(ce=ke)};return be.forEach(ke=>Te(ke)),ce||Pe.forEach(ke=>Te(ke)),ce}(this.style,this.transform.zoom);H&&function(J,Q,ce){for(let fe=0;fe<ce.length;fe++)Ei(J,Q,ce[fe])}(this,H,H.getVisibleCoordinates())}this.options.showPadding&&function(H){const J=H.transform.padding;ko(H,H.transform.height-(J.top||0),3,na),ko(H,J.bottom||0,3,Vl),po(H,J.left||0,3,mf),po(H,H.transform.width-(J.right||0),3,s0);const Q=H.transform.centerPoint;(function(ce,fe,be,Pe){Rc(ce,fe-1,be-10,2,20,Pe),Rc(ce,fe-10,be-1,20,2,Pe)})(H,Q.x,H.transform.height-Q.y,vu)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(o){if(!this.style||!this.style.map||!this.style.map.terrain)return;const d=this.terrainFacilitator.matrix,v=this.transform.modelViewProjectionMatrix;let _=this.terrainFacilitator.dirty;_||(_=o?!l.a_(d,v):!l.a$(d,v)),_||(_=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime).length>0),_&&(l.b0(d,v),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(E,O){const z=E.context,V=z.gl,H=Xi.unblended,J=new ci(V.LEQUAL,ci.ReadWrite,[0,1]),Q=O.getTerrainMesh(),ce=O.sourceCache.getRenderableTiles(),fe=E.useProgram("terrainDepth");z.bindFramebuffer.set(O.getFramebuffer("depth").framebuffer),z.viewport.set([0,0,E.width/devicePixelRatio,E.height/devicePixelRatio]),z.clear({color:l.aN.transparent,depth:1});for(const be of ce){const Pe=O.getTerrainData(be.tileID),Te={u_matrix:E.transform.calculatePosMatrix(be.tileID.toUnwrapped()),u_ele_delta:O.getMeshFrameDelta(E.transform.zoom)};fe.draw(z,V.TRIANGLES,J,dr.disabled,H,er.backCCW,Te,Pe,"terrain",Q.vertexBuffer,Q.indexBuffer,Q.segments)}z.bindFramebuffer.set(null),z.viewport.set([0,0,E.width,E.height])}(this,this.style.map.terrain),function(E,O){const z=E.context,V=z.gl,H=Xi.unblended,J=new ci(V.LEQUAL,ci.ReadWrite,[0,1]),Q=O.getTerrainMesh(),ce=O.getCoordsTexture(),fe=O.sourceCache.getRenderableTiles(),be=E.useProgram("terrainCoords");z.bindFramebuffer.set(O.getFramebuffer("coords").framebuffer),z.viewport.set([0,0,E.width/devicePixelRatio,E.height/devicePixelRatio]),z.clear({color:l.aN.transparent,depth:1}),O.coordsIndex=[];for(const Pe of fe){const Te=O.getTerrainData(Pe.tileID);z.activeTexture.set(V.TEXTURE0),V.bindTexture(V.TEXTURE_2D,ce.texture);const ke={u_matrix:E.transform.calculatePosMatrix(Pe.tileID.toUnwrapped()),u_terrain_coords_id:(255-O.coordsIndex.length)/255,u_texture:0,u_ele_delta:O.getMeshFrameDelta(E.transform.zoom)};be.draw(z,V.TRIANGLES,J,dr.disabled,H,er.backCCW,ke,Te,"terrain",Q.vertexBuffer,Q.indexBuffer,Q.segments),O.coordsIndex.push(Pe.tileID.key)}z.bindFramebuffer.set(null),z.viewport.set([0,0,E.width,E.height])}(this,this.style.map.terrain))}renderLayer(o,d,v,_){if(!v.isHidden(this.transform.zoom)&&(v.type==="background"||v.type==="custom"||(_||[]).length))switch(this.id=v.id,v.type){case"symbol":(function(E,O,z,V,H){if(E.renderPass!=="translucent")return;const J=dr.disabled,Q=E.colorModeForRenderPass();(z._unevaluatedLayout.hasValue("text-variable-anchor")||z._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(ce,fe,be,Pe,Te,ke,Ve,Ee,qe){const rt=fe.transform,ht=wi(),At=Te==="map",Ft=ke==="map";for(const an of ce){const sn=Pe.getTile(an),kt=sn.getBucket(be);if(!kt||!kt.text||!kt.text.segments.get().length)continue;const Kt=l.ah(kt.textSizeData,rt.zoom),pn=Vn(sn,1,fe.transform.zoom),$n=Ct(an.posMatrix,Ft,At,fe.transform,pn),Jt=be.layout.get("icon-text-fit")!=="none"&&kt.hasIconData();if(Kt){const tn=Math.pow(2,rt.zoom-sn.tileID.overscaledZ),Un=fe.style.map.terrain?(ei,hi)=>fe.style.map.terrain.getElevation(an,ei,hi):null,rr=ht.translatePosition(rt,sn,Ve,Ee);ff(kt,At,Ft,qe,rt,$n,an.posMatrix,tn,Kt,Jt,ht,rr,an.toUnwrapped(),Un)}}}(V,E,z,O,z.layout.get("text-rotation-alignment"),z.layout.get("text-pitch-alignment"),z.paint.get("text-translate"),z.paint.get("text-translate-anchor"),H),z.paint.get("icon-opacity").constantOr(1)!==0&&Bl(E,O,z,V,!1,z.paint.get("icon-translate"),z.paint.get("icon-translate-anchor"),z.layout.get("icon-rotation-alignment"),z.layout.get("icon-pitch-alignment"),z.layout.get("icon-keep-upright"),J,Q),z.paint.get("text-opacity").constantOr(1)!==0&&Bl(E,O,z,V,!0,z.paint.get("text-translate"),z.paint.get("text-translate-anchor"),z.layout.get("text-rotation-alignment"),z.layout.get("text-pitch-alignment"),z.layout.get("text-keep-upright"),J,Q),O.map.showCollisionBoxes&&(df(E,O,z,V,!0),df(E,O,z,V,!1))})(o,d,v,_,this.style.placement.variableOffsets);break;case"circle":(function(E,O,z,V){if(E.renderPass!=="translucent")return;const H=z.paint.get("circle-opacity"),J=z.paint.get("circle-stroke-width"),Q=z.paint.get("circle-stroke-opacity"),ce=!z.layout.get("circle-sort-key").isConstant();if(H.constantOr(1)===0&&(J.constantOr(1)===0||Q.constantOr(1)===0))return;const fe=E.context,be=fe.gl,Pe=E.depthModeForSublayer(0,ci.ReadOnly),Te=dr.disabled,ke=E.colorModeForRenderPass(),Ve=[];for(let Ee=0;Ee<V.length;Ee++){const qe=V[Ee],rt=O.getTile(qe),ht=rt.getBucket(z);if(!ht)continue;const At=ht.programConfigurations.get(z.id),Ft=E.useProgram("circle",At),an=ht.layoutVertexBuffer,sn=ht.indexBuffer,kt=E.style.map.terrain&&E.style.map.terrain.getTerrainData(qe),Kt={programConfiguration:At,program:Ft,layoutVertexBuffer:an,indexBuffer:sn,uniformValues:Np(E,qe,rt,z),terrainData:kt};if(ce){const pn=ht.segments.get();for(const $n of pn)Ve.push({segments:new l.a0([$n]),sortKey:$n.sortKey,state:Kt})}else Ve.push({segments:ht.segments,sortKey:0,state:Kt})}ce&&Ve.sort((Ee,qe)=>Ee.sortKey-qe.sortKey);for(const Ee of Ve){const{programConfiguration:qe,program:rt,layoutVertexBuffer:ht,indexBuffer:At,uniformValues:Ft,terrainData:an}=Ee.state;rt.draw(fe,be.TRIANGLES,Pe,Te,ke,er.disabled,Ft,an,z.id,ht,At,Ee.segments,z.paint,E.transform.zoom,qe)}})(o,d,v,_);break;case"heatmap":(function(E,O,z,V){if(z.paint.get("heatmap-opacity")!==0)if(E.renderPass==="offscreen"){const H=E.context,J=H.gl,Q=dr.disabled,ce=new Xi([J.ONE,J.ONE],l.aN.transparent,[!0,!0,!0,!0]);(function(fe,be,Pe){const Te=fe.gl;fe.activeTexture.set(Te.TEXTURE1),fe.viewport.set([0,0,be.width/4,be.height/4]);let ke=Pe.heatmapFbo;if(ke)Te.bindTexture(Te.TEXTURE_2D,ke.colorAttachment.get()),fe.bindFramebuffer.set(ke.framebuffer);else{const Ve=Te.createTexture();Te.bindTexture(Te.TEXTURE_2D,Ve),Te.texParameteri(Te.TEXTURE_2D,Te.TEXTURE_WRAP_S,Te.CLAMP_TO_EDGE),Te.texParameteri(Te.TEXTURE_2D,Te.TEXTURE_WRAP_T,Te.CLAMP_TO_EDGE),Te.texParameteri(Te.TEXTURE_2D,Te.TEXTURE_MIN_FILTER,Te.LINEAR),Te.texParameteri(Te.TEXTURE_2D,Te.TEXTURE_MAG_FILTER,Te.LINEAR),ke=Pe.heatmapFbo=fe.createFramebuffer(be.width/4,be.height/4,!1,!1),function(Ee,qe,rt,ht){var At,Ft;const an=Ee.gl,sn=(At=Ee.HALF_FLOAT)!==null&&At!==void 0?At:an.UNSIGNED_BYTE,kt=(Ft=Ee.RGBA16F)!==null&&Ft!==void 0?Ft:an.RGBA;an.texImage2D(an.TEXTURE_2D,0,kt,qe.width/4,qe.height/4,0,an.RGBA,sn,null),ht.colorAttachment.set(rt)}(fe,be,Ve,ke)}})(H,E,z),H.clear({color:l.aN.transparent});for(let fe=0;fe<V.length;fe++){const be=V[fe];if(O.hasRenderableParent(be))continue;const Pe=O.getTile(be),Te=Pe.getBucket(z);if(!Te)continue;const ke=Te.programConfigurations.get(z.id),Ve=E.useProgram("heatmap",ke),{zoom:Ee}=E.transform;Ve.draw(H,J.TRIANGLES,ci.disabled,Q,ce,er.disabled,ho(be.posMatrix,Pe,Ee,z.paint.get("heatmap-intensity")),null,z.id,Te.layoutVertexBuffer,Te.indexBuffer,Te.segments,z.paint,E.transform.zoom,ke)}H.viewport.set([0,0,E.width,E.height])}else E.renderPass==="translucent"&&(E.context.setColorMode(E.colorModeForRenderPass()),function(H,J){const Q=H.context,ce=Q.gl,fe=J.heatmapFbo;if(!fe)return;Q.activeTexture.set(ce.TEXTURE0),ce.bindTexture(ce.TEXTURE_2D,fe.colorAttachment.get()),Q.activeTexture.set(ce.TEXTURE1);let be=J.colorRampTexture;be||(be=J.colorRampTexture=new se(Q,J.colorRamp,ce.RGBA)),be.bind(ce.LINEAR,ce.CLAMP_TO_EDGE),H.useProgram("heatmapTexture").draw(Q,ce.TRIANGLES,ci.disabled,dr.disabled,H.colorModeForRenderPass(),er.disabled,((Pe,Te,ke,Ve)=>{const Ee=l.H();l.aQ(Ee,0,Pe.width,Pe.height,0,0,1);const qe=Pe.context.gl;return{u_matrix:Ee,u_world:[qe.drawingBufferWidth,qe.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:Te.paint.get("heatmap-opacity")}})(H,J),null,J.id,H.viewportBuffer,H.quadTriangleIndexBuffer,H.viewportSegments,J.paint,H.transform.zoom)}(E,z))})(o,d,v,_);break;case"line":(function(E,O,z,V){if(E.renderPass!=="translucent")return;const H=z.paint.get("line-opacity"),J=z.paint.get("line-width");if(H.constantOr(1)===0||J.constantOr(1)===0)return;const Q=E.depthModeForSublayer(0,ci.ReadOnly),ce=E.colorModeForRenderPass(),fe=z.paint.get("line-dasharray"),be=z.paint.get("line-pattern"),Pe=be.constantOr(1),Te=z.paint.get("line-gradient"),ke=z.getCrossfadeParameters(),Ve=Pe?"linePattern":fe?"lineSDF":Te?"lineGradient":"line",Ee=E.context,qe=Ee.gl;let rt=!0;for(const ht of V){const At=O.getTile(ht);if(Pe&&!At.patternsLoaded())continue;const Ft=At.getBucket(z);if(!Ft)continue;const an=Ft.programConfigurations.get(z.id),sn=E.context.program.get(),kt=E.useProgram(Ve,an),Kt=rt||kt.program!==sn,pn=E.style.map.terrain&&E.style.map.terrain.getTerrainData(ht),$n=be.constantOr(null);if($n&&At.imageAtlas){const Un=At.imageAtlas,rr=Un.patternPositions[$n.to.toString()],ei=Un.patternPositions[$n.from.toString()];rr&&ei&&an.setConstantPatternPositions(rr,ei)}const Jt=pn?ht:null,tn=Pe?qv(E,At,z,ke,Jt):fe?Xv(E,At,z,fe,ke,Jt):Te?sf(E,At,z,Ft.lineClipsArray.length,Jt):Ch(E,At,z,Jt);if(Pe)Ee.activeTexture.set(qe.TEXTURE0),At.imageAtlasTexture.bind(qe.LINEAR,qe.CLAMP_TO_EDGE),an.updatePaintBuffers(ke);else if(fe&&(Kt||E.lineAtlas.dirty))Ee.activeTexture.set(qe.TEXTURE0),E.lineAtlas.bind(Ee);else if(Te){const Un=Ft.gradients[z.id];let rr=Un.texture;if(z.gradientVersion!==Un.version){let ei=256;if(z.stepInterpolant){const hi=O.getSource().maxzoom,nr=ht.canonical.z===hi?Math.ceil(1<<E.transform.maxZoom-ht.canonical.z):1;ei=l.ad(l.aV(Ft.maxLineLength/l.X*1024*nr),256,Ee.maxTextureSize)}Un.gradient=l.aW({expression:z.gradientExpression(),evaluationKey:"lineProgress",resolution:ei,image:Un.gradient||void 0,clips:Ft.lineClipsArray}),Un.texture?Un.texture.update(Un.gradient):Un.texture=new se(Ee,Un.gradient,qe.RGBA),Un.version=z.gradientVersion,rr=Un.texture}Ee.activeTexture.set(qe.TEXTURE0),rr.bind(z.stepInterpolant?qe.NEAREST:qe.LINEAR,qe.CLAMP_TO_EDGE)}kt.draw(Ee,qe.TRIANGLES,Q,E.stencilModeForClipping(ht),ce,er.disabled,tn,pn,z.id,Ft.layoutVertexBuffer,Ft.indexBuffer,Ft.segments,z.paint,E.transform.zoom,an,Ft.layoutVertexBuffer2),rt=!1}})(o,d,v,_);break;case"fill":(function(E,O,z,V){const H=z.paint.get("fill-color"),J=z.paint.get("fill-opacity");if(J.constantOr(1)===0)return;const Q=E.colorModeForRenderPass(),ce=z.paint.get("fill-pattern"),fe=E.opaquePassEnabledForLayer()&&!ce.constantOr(1)&&H.constantOr(l.aN.transparent).a===1&&J.constantOr(0)===1?"opaque":"translucent";if(E.renderPass===fe){const be=E.depthModeForSublayer(1,E.renderPass==="opaque"?ci.ReadWrite:ci.ReadOnly);Ul(E,O,z,V,be,Q,!1)}if(E.renderPass==="translucent"&&z.paint.get("fill-antialias")){const be=E.depthModeForSublayer(z.getPaintProperty("fill-outline-color")?2:0,ci.ReadOnly);Ul(E,O,z,V,be,Q,!0)}})(o,d,v,_);break;case"fill-extrusion":(function(E,O,z,V){const H=z.paint.get("fill-extrusion-opacity");if(H!==0&&E.renderPass==="translucent"){const J=new ci(E.context.gl.LEQUAL,ci.ReadWrite,E.depthRangeFor3D);if(H!==1||z.paint.get("fill-extrusion-pattern").constantOr(1))pf(E,O,z,V,J,dr.disabled,Xi.disabled),pf(E,O,z,V,J,E.stencilModeFor3D(),E.colorModeForRenderPass());else{const Q=E.colorModeForRenderPass();pf(E,O,z,V,J,dr.disabled,Q)}}})(o,d,v,_);break;case"hillshade":(function(E,O,z,V){if(E.renderPass!=="offscreen"&&E.renderPass!=="translucent")return;const H=E.context,J=E.depthModeForSublayer(0,ci.ReadOnly),Q=E.colorModeForRenderPass(),[ce,fe]=E.renderPass==="translucent"?E.stencilConfigForOverlap(V):[{},V];for(const be of fe){const Pe=O.getTile(be);Pe.needsHillshadePrepare!==void 0&&Pe.needsHillshadePrepare&&E.renderPass==="offscreen"?ol(E,Pe,z,J,dr.disabled,Q):E.renderPass==="translucent"&&Qp(E,be,Pe,z,J,ce[be.overscaledZ],Q)}H.viewport.set([0,0,E.width,E.height])})(o,d,v,_);break;case"raster":(function(E,O,z,V){if(E.renderPass!=="translucent"||z.paint.get("raster-opacity")===0||!V.length)return;const H=E.context,J=H.gl,Q=O.getSource(),ce=E.useProgram("raster"),fe=E.colorModeForRenderPass(),[be,Pe]=Q instanceof Ge?[{},V]:E.stencilConfigForOverlap(V),Te=Pe[Pe.length-1].overscaledZ,ke=!E.options.moving;for(const Ve of Pe){const Ee=E.depthModeForSublayer(Ve.overscaledZ-Te,z.paint.get("raster-opacity")===1?ci.ReadWrite:ci.ReadOnly,J.LESS),qe=O.getTile(Ve);qe.registerFadeDuration(z.paint.get("raster-fade-duration"));const rt=O.findLoadedParent(Ve,0),ht=O.findLoadedSibling(Ve),At=kh(qe,rt||ht||null,O,z,E.transform,E.style.map.terrain);let Ft,an;const sn=z.paint.get("raster-resampling")==="nearest"?J.NEAREST:J.LINEAR;H.activeTexture.set(J.TEXTURE0),qe.texture.bind(sn,J.CLAMP_TO_EDGE,J.LINEAR_MIPMAP_NEAREST),H.activeTexture.set(J.TEXTURE1),rt?(rt.texture.bind(sn,J.CLAMP_TO_EDGE,J.LINEAR_MIPMAP_NEAREST),Ft=Math.pow(2,rt.tileID.overscaledZ-qe.tileID.overscaledZ),an=[qe.tileID.canonical.x*Ft%1,qe.tileID.canonical.y*Ft%1]):qe.texture.bind(sn,J.CLAMP_TO_EDGE,J.LINEAR_MIPMAP_NEAREST),qe.texture.useMipmap&&H.extTextureFilterAnisotropic&&E.transform.pitch>20&&J.texParameterf(J.TEXTURE_2D,H.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,H.extTextureFilterAnisotropicMax);const kt=E.style.map.terrain&&E.style.map.terrain.getTerrainData(Ve),Kt=kt?Ve:null,pn=Kt?Kt.posMatrix:E.transform.calculatePosMatrix(Ve.toUnwrapped(),ke),$n=fx(pn,an||[0,0],Ft||1,At,z);Q instanceof Ge?ce.draw(H,J.TRIANGLES,Ee,dr.disabled,fe,er.disabled,$n,kt,z.id,Q.boundsBuffer,E.quadTriangleIndexBuffer,Q.boundsSegments):ce.draw(H,J.TRIANGLES,Ee,be[Ve.overscaledZ],fe,er.disabled,$n,kt,z.id,E.rasterBoundsBuffer,E.quadTriangleIndexBuffer,E.rasterBoundsSegments)}})(o,d,v,_);break;case"background":(function(E,O,z,V){const H=z.paint.get("background-color"),J=z.paint.get("background-opacity");if(J===0)return;const Q=E.context,ce=Q.gl,fe=E.transform,be=fe.tileSize,Pe=z.paint.get("background-pattern");if(E.isPatternMissing(Pe))return;const Te=!Pe&&H.a===1&&J===1&&E.opaquePassEnabledForLayer()?"opaque":"translucent";if(E.renderPass!==Te)return;const ke=dr.disabled,Ve=E.depthModeForSublayer(0,Te==="opaque"?ci.ReadWrite:ci.ReadOnly),Ee=E.colorModeForRenderPass(),qe=E.useProgram(Pe?"backgroundPattern":"background"),rt=V||fe.coveringTiles({tileSize:be,terrain:E.style.map.terrain});Pe&&(Q.activeTexture.set(ce.TEXTURE0),E.imageManager.bind(E.context));const ht=z.getCrossfadeParameters();for(const At of rt){const Ft=V?At.posMatrix:E.transform.calculatePosMatrix(At.toUnwrapped()),an=Pe?Bp(Ft,J,E,Pe,{tileID:At,tileSize:be},ht):Hi(Ft,J,H),sn=E.style.map.terrain&&E.style.map.terrain.getTerrainData(At);qe.draw(Q,ce.TRIANGLES,Ve,ke,Ee,er.disabled,an,sn,z.id,E.tileExtentBuffer,E.quadTriangleIndexBuffer,E.tileExtentSegments)}})(o,0,v,_);break;case"custom":(function(E,O,z){const V=E.context,H=z.implementation;if(E.renderPass==="offscreen"){const J=H.prerender;J&&(E.setCustomLayerDefaults(),V.setColorMode(E.colorModeForRenderPass()),J.call(H,V.gl,E.transform.customLayerMatrix()),V.setDirty(),E.setBaseState())}else if(E.renderPass==="translucent"){E.setCustomLayerDefaults(),V.setColorMode(E.colorModeForRenderPass()),V.setStencilMode(dr.disabled);const J=H.renderingMode==="3d"?new ci(E.context.gl.LEQUAL,ci.ReadWrite,E.depthRangeFor3D):E.depthModeForSublayer(0,ci.ReadOnly);V.setDepthMode(J),H.render(V.gl,E.transform.customLayerMatrix(),{farZ:E.transform.farZ,nearZ:E.transform.nearZ,fov:E.transform._fov,modelViewProjectionMatrix:E.transform.modelViewProjectionMatrix,projectionMatrix:E.transform.projectionMatrix}),V.setDirty(),E.setBaseState(),V.bindFramebuffer.set(null)}})(o,0,v)}}translatePosMatrix(o,d,v,_,E){if(!v[0]&&!v[1])return o;const O=E?_==="map"?this.transform.angle:0:_==="viewport"?-this.transform.angle:0;if(O){const H=Math.sin(O),J=Math.cos(O);v=[v[0]*J-v[1]*H,v[0]*H+v[1]*J]}const z=[E?v[0]:Vn(d,v[0],this.transform.zoom),E?v[1]:Vn(d,v[1],this.transform.zoom),0],V=new Float32Array(16);return l.J(V,o,z),V}saveTileTexture(o){const d=this._tileTextures[o.size[0]];d?d.push(o):this._tileTextures[o.size[0]]=[o]}getTileTexture(o){const d=this._tileTextures[o];return d&&d.length>0?d.pop():null}isPatternMissing(o){if(!o)return!1;if(!o.from||!o.to)return!0;const d=this.imageManager.getPattern(o.from.toString()),v=this.imageManager.getPattern(o.to.toString());return!d||!v}useProgram(o,d){this.cache=this.cache||{};const v=o+(d?d.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[v]||(this.cache[v]=new fu(this.context,uo[o],d,of[o],this._showOverdrawInspector,this.style.map.terrain)),this.cache[v]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const o=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(o.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new se(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:o,drawingBufferHeight:d}=this.context.gl;return this.width!==o||this.height!==d}}class Lc{constructor(o,d){this.points=o,this.planes=d}static fromInvProjectionMatrix(o,d,v){const _=Math.pow(2,v),E=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(z=>{const V=1/(z=l.ag([],z,o))[3]/d*_;return l.b1(z,z,[V,V,1/z[3],V])}),O=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(z=>{const V=function(ce,fe){var be=fe[0],Pe=fe[1],Te=fe[2],ke=be*be+Pe*Pe+Te*Te;return ke>0&&(ke=1/Math.sqrt(ke)),ce[0]=fe[0]*ke,ce[1]=fe[1]*ke,ce[2]=fe[2]*ke,ce}([],function(ce,fe,be){var Pe=fe[0],Te=fe[1],ke=fe[2],Ve=be[0],Ee=be[1],qe=be[2];return ce[0]=Te*qe-ke*Ee,ce[1]=ke*Ve-Pe*qe,ce[2]=Pe*Ee-Te*Ve,ce}([],W([],E[z[0]],E[z[1]]),W([],E[z[2]],E[z[1]]))),H=-((J=V)[0]*(Q=E[z[1]])[0]+J[1]*Q[1]+J[2]*Q[2]);var J,Q;return V.concat(H)});return new Lc(E,O)}}class al{constructor(o,d){this.min=o,this.max=d,this.center=function(v,_,E){return v[0]=.5*_[0],v[1]=.5*_[1],v[2]=.5*_[2],v}([],function(v,_,E){return v[0]=_[0]+E[0],v[1]=_[1]+E[1],v[2]=_[2]+E[2],v}([],this.min,this.max))}quadrant(o){const d=[o%2==0,o<2],v=K(this.min),_=K(this.max);for(let E=0;E<d.length;E++)v[E]=d[E]?this.min[E]:this.center[E],_[E]=d[E]?this.center[E]:this.max[E];return _[2]=this.max[2],new al(v,_)}distanceX(o){return Math.max(Math.min(this.max[0],o[0]),this.min[0])-o[0]}distanceY(o){return Math.max(Math.min(this.max[1],o[1]),this.min[1])-o[1]}intersects(o){const d=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let v=!0;for(let _=0;_<o.planes.length;_++){const E=o.planes[_];let O=0;for(let z=0;z<d.length;z++)l.b2(E,d[z])>=0&&O++;if(O===0)return 0;O!==d.length&&(v=!1)}if(v)return 2;for(let _=0;_<3;_++){let E=Number.MAX_VALUE,O=-Number.MAX_VALUE;for(let z=0;z<o.points.length;z++){const V=o.points[z][_]-this.min[_];E=Math.min(E,V),O=Math.max(O,V)}if(O<0||E>this.max[_]-this.min[_])return 0}return 1}}class et{constructor(o=0,d=0,v=0,_=0){if(isNaN(o)||o<0||isNaN(d)||d<0||isNaN(v)||v<0||isNaN(_)||_<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=o,this.bottom=d,this.left=v,this.right=_}interpolate(o,d,v){return d.top!=null&&o.top!=null&&(this.top=l.z.number(o.top,d.top,v)),d.bottom!=null&&o.bottom!=null&&(this.bottom=l.z.number(o.bottom,d.bottom,v)),d.left!=null&&o.left!=null&&(this.left=l.z.number(o.left,d.left,v)),d.right!=null&&o.right!=null&&(this.right=l.z.number(o.right,d.right,v)),this}getCenter(o,d){const v=l.ad((this.left+o-this.right)/2,0,o),_=l.ad((this.top+d-this.bottom)/2,0,d);return new l.P(v,_)}equals(o){return this.top===o.top&&this.bottom===o.bottom&&this.left===o.left&&this.right===o.right}clone(){return new et(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const Mt=85.051129;class gt{constructor(o,d,v,_,E){this.tileSize=512,this._renderWorldCopies=E===void 0||!!E,this._minZoom=o||0,this._maxZoom=d||22,this._minPitch=v??0,this._maxPitch=_??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new l.N(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new et,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={},this.minElevationForCurrentTile=0}clone(){const o=new gt(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return o.apply(this),o}apply(o){this.tileSize=o.tileSize,this.latRange=o.latRange,this.width=o.width,this.height=o.height,this._center=o._center,this._elevation=o._elevation,this.minElevationForCurrentTile=o.minElevationForCurrentTile,this.zoom=o.zoom,this.angle=o.angle,this._fov=o._fov,this._pitch=o._pitch,this._unmodified=o._unmodified,this._edgeInsets=o._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(o){this._minZoom!==o&&(this._minZoom=o,this.zoom=Math.max(this.zoom,o))}get maxZoom(){return this._maxZoom}set maxZoom(o){this._maxZoom!==o&&(this._maxZoom=o,this.zoom=Math.min(this.zoom,o))}get minPitch(){return this._minPitch}set minPitch(o){this._minPitch!==o&&(this._minPitch=o,this.pitch=Math.max(this.pitch,o))}get maxPitch(){return this._maxPitch}set maxPitch(o){this._maxPitch!==o&&(this._maxPitch=o,this.pitch=Math.min(this.pitch,o))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(o){o===void 0?o=!0:o===null&&(o=!1),this._renderWorldCopies=o}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new l.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(o){const d=-l.b3(o,-180,180)*Math.PI/180;this.angle!==d&&(this._unmodified=!1,this.angle=d,this._calcMatrices(),this.rotationMatrix=function(){var v=new l.A(4);return l.A!=Float32Array&&(v[1]=0,v[2]=0),v[0]=1,v[3]=1,v}(),function(v,_,E){var O=_[0],z=_[1],V=_[2],H=_[3],J=Math.sin(E),Q=Math.cos(E);v[0]=O*Q+V*J,v[1]=z*Q+H*J,v[2]=O*-J+V*Q,v[3]=z*-J+H*Q}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(o){const d=l.ad(o,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==d&&(this._unmodified=!1,this._pitch=d,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(o){o=Math.max(.01,Math.min(60,o)),this._fov!==o&&(this._unmodified=!1,this._fov=o/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(o){const d=Math.min(Math.max(o,this.minZoom),this.maxZoom);this._zoom!==d&&(this._unmodified=!1,this._zoom=d,this.tileZoom=Math.max(0,Math.floor(d)),this.scale=this.zoomScale(d),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(o){o.lat===this._center.lat&&o.lng===this._center.lng||(this._unmodified=!1,this._center=o,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(o){o!==this._elevation&&(this._elevation=o,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(o){this._edgeInsets.equals(o)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,o,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(o){return this._edgeInsets.equals(o)}interpolatePadding(o,d,v){this._unmodified=!1,this._edgeInsets.interpolate(o,d,v),this._constrain(),this._calcMatrices()}coveringZoomLevel(o){const d=(o.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/o.tileSize));return Math.max(0,d)}getVisibleUnwrappedCoordinates(o){const d=[new l.b4(0,o)];if(this._renderWorldCopies){const v=this.pointCoordinate(new l.P(0,0)),_=this.pointCoordinate(new l.P(this.width,0)),E=this.pointCoordinate(new l.P(this.width,this.height)),O=this.pointCoordinate(new l.P(0,this.height)),z=Math.floor(Math.min(v.x,_.x,E.x,O.x)),V=Math.floor(Math.max(v.x,_.x,E.x,O.x)),H=1;for(let J=z-H;J<=V+H;J++)J!==0&&d.push(new l.b4(J,o))}return d}coveringTiles(o){var d,v;let _=this.coveringZoomLevel(o);const E=_;if(o.minzoom!==void 0&&_<o.minzoom)return[];o.maxzoom!==void 0&&_>o.maxzoom&&(_=o.maxzoom);const O=this.pointCoordinate(this.getCameraPoint()),z=l.Z.fromLngLat(this.center),V=Math.pow(2,_),H=[V*O.x,V*O.y,0],J=[V*z.x,V*z.y,0],Q=Lc.fromInvProjectionMatrix(this.invModelViewProjectionMatrix,this.worldSize,_);let ce=o.minzoom||0;!o.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(ce=_);const fe=o.terrain?2/Math.min(this.tileSize,o.tileSize)*this.tileSize:3,be=Ee=>({aabb:new al([Ee*V,0,0],[(Ee+1)*V,V,0]),zoom:0,x:0,y:0,wrap:Ee,fullyVisible:!1}),Pe=[],Te=[],ke=_,Ve=o.reparseOverscaled?E:_;if(this._renderWorldCopies)for(let Ee=1;Ee<=3;Ee++)Pe.push(be(-Ee)),Pe.push(be(Ee));for(Pe.push(be(0));Pe.length>0;){const Ee=Pe.pop(),qe=Ee.x,rt=Ee.y;let ht=Ee.fullyVisible;if(!ht){const kt=Ee.aabb.intersects(Q);if(kt===0)continue;ht=kt===2}const At=o.terrain?H:J,Ft=Ee.aabb.distanceX(At),an=Ee.aabb.distanceY(At),sn=Math.max(Math.abs(Ft),Math.abs(an));if(Ee.zoom===ke||sn>fe+(1<<ke-Ee.zoom)-2&&Ee.zoom>=ce){const kt=ke-Ee.zoom,Kt=H[0]-.5-(qe<<kt),pn=H[1]-.5-(rt<<kt);Te.push({tileID:new l.S(Ee.zoom===ke?Ve:Ee.zoom,Ee.wrap,Ee.zoom,qe,rt),distanceSq:ie([J[0]-.5-qe,J[1]-.5-rt]),tileDistanceToCamera:Math.sqrt(Kt*Kt+pn*pn)})}else for(let kt=0;kt<4;kt++){const Kt=(qe<<1)+kt%2,pn=(rt<<1)+(kt>>1),$n=Ee.zoom+1;let Jt=Ee.aabb.quadrant(kt);if(o.terrain){const tn=new l.S($n,Ee.wrap,$n,Kt,pn),Un=o.terrain.getMinMaxElevation(tn),rr=(d=Un.minElevation)!==null&&d!==void 0?d:this.elevation,ei=(v=Un.maxElevation)!==null&&v!==void 0?v:this.elevation;Jt=new al([Jt.min[0],Jt.min[1],rr],[Jt.max[0],Jt.max[1],ei])}Pe.push({aabb:Jt,zoom:$n,x:Kt,y:pn,wrap:Ee.wrap,fullyVisible:ht})}}return Te.sort((Ee,qe)=>Ee.distanceSq-qe.distanceSq).map(Ee=>Ee.tileID)}resize(o,d){this.width=o,this.height=d,this.pixelsToGLUnits=[2/o,-2/d],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(o){return Math.pow(2,o)}scaleZoom(o){return Math.log(o)/Math.LN2}project(o){const d=l.ad(o.lat,-85.051129,Mt);return new l.P(l.O(o.lng)*this.worldSize,l.Q(d)*this.worldSize)}unproject(o){return new l.Z(o.x/this.worldSize,o.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(o){const d=this.elevation,v=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter,_=this.pointLocation(this.centerPoint,o),E=o.getElevationForLngLatZoom(_,this.tileZoom);if(!(this.elevation-E))return;const O=v+d-E,z=Math.cos(this._pitch)*this.cameraToCenterDistance/O/l.b5(1,_.lat),V=this.scaleZoom(z/this.tileSize);this._elevation=E,this._center=_,this.zoom=V}setLocationAtPoint(o,d){const v=this.pointCoordinate(d),_=this.pointCoordinate(this.centerPoint),E=this.locationCoordinate(o),O=new l.Z(E.x-(v.x-_.x),E.y-(v.y-_.y));this.center=this.coordinateLocation(O),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(o,d){return d?this.coordinatePoint(this.locationCoordinate(o),d.getElevationForLngLatZoom(o,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(o))}pointLocation(o,d){return this.coordinateLocation(this.pointCoordinate(o,d))}locationCoordinate(o){return l.Z.fromLngLat(o)}coordinateLocation(o){return o&&o.toLngLat()}pointCoordinate(o,d){if(d){const ce=d.pointCoordinate(o);if(ce!=null)return ce}const v=[o.x,o.y,0,1],_=[o.x,o.y,1,1];l.ag(v,v,this.pixelMatrixInverse),l.ag(_,_,this.pixelMatrixInverse);const E=v[3],O=_[3],z=v[1]/E,V=_[1]/O,H=v[2]/E,J=_[2]/O,Q=H===J?0:(0-H)/(J-H);return new l.Z(l.z.number(v[0]/E,_[0]/O,Q)/this.worldSize,l.z.number(z,V,Q)/this.worldSize)}coordinatePoint(o,d=0,v=this.pixelMatrix){const _=[o.x*this.worldSize,o.y*this.worldSize,d,1];return l.ag(_,_,v),new l.P(_[0]/_[3],_[1]/_[3])}getBounds(){const o=Math.max(0,this.height/2-this.getHorizon());return new Ue().extend(this.pointLocation(new l.P(0,o))).extend(this.pointLocation(new l.P(this.width,o))).extend(this.pointLocation(new l.P(this.width,this.height))).extend(this.pointLocation(new l.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new Ue([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(o){o?(this.lngRange=[o.getWest(),o.getEast()],this.latRange=[o.getSouth(),o.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-85.051129,Mt])}calculateTileMatrix(o){const d=o.canonical,v=this.worldSize/this.zoomScale(d.z),_=d.x+Math.pow(2,d.z)*o.wrap,E=l.ao(new Float64Array(16));return l.J(E,E,[_*v,d.y*v,0]),l.K(E,E,[v/l.X,v/l.X,1]),E}calculatePosMatrix(o,d=!1){const v=o.key,_=d?this._alignedPosMatrixCache:this._posMatrixCache;if(_[v])return _[v];const E=this.calculateTileMatrix(o);return l.L(E,d?this.alignedModelViewProjectionMatrix:this.modelViewProjectionMatrix,E),_[v]=new Float32Array(E),_[v]}calculateFogMatrix(o){const d=o.key,v=this._fogMatrixCache;if(v[d])return v[d];const _=this.calculateTileMatrix(o);return l.L(_,this.fogMatrix,_),v[d]=new Float32Array(_),v[d]}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(o,d){d=l.ad(+d,this.minZoom,this.maxZoom);const v={center:new l.N(o.lng,o.lat),zoom:d};let _=this.lngRange;!this._renderWorldCopies&&_===null&&(_=[-179.9999999999,179.9999999999]);const E=this.tileSize*this.zoomScale(v.zoom);let O=0,z=E,V=0,H=E,J=0,Q=0;const{x:ce,y:fe}=this.size;if(this.latRange){const Ee=this.latRange;O=l.Q(Ee[1])*E,z=l.Q(Ee[0])*E,z-O<fe&&(J=fe/(z-O))}_&&(V=l.b3(l.O(_[0])*E,0,E),H=l.b3(l.O(_[1])*E,0,E),H<V&&(H+=E),H-V<ce&&(Q=ce/(H-V)));const{x:be,y:Pe}=this.project.call({worldSize:E},o);let Te,ke;const Ve=Math.max(Q||0,J||0);if(Ve){const Ee=new l.P(Q?(H+V)/2:be,J?(z+O)/2:Pe);return v.center=this.unproject.call({worldSize:E},Ee).wrap(),v.zoom+=this.scaleZoom(Ve),v}if(this.latRange){const Ee=fe/2;Pe-Ee<O&&(ke=O+Ee),Pe+Ee>z&&(ke=z-Ee)}if(_){const Ee=(V+H)/2;let qe=be;this._renderWorldCopies&&(qe=l.b3(be,Ee-E/2,Ee+E/2));const rt=ce/2;qe-rt<V&&(Te=V+rt),qe+rt>H&&(Te=H-rt)}if(Te!==void 0||ke!==void 0){const Ee=new l.P(Te??be,ke??Pe);v.center=this.unproject.call({worldSize:E},Ee).wrap()}return v}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const o=this._unmodified,{center:d,zoom:v}=this.getConstrained(this.center,this.zoom);this.center=d,this.zoom=v,this._unmodified=o,this._constraining=!1}_calcMatrices(){if(!this.height)return;const o=this.centerOffset,d=this.point.x,v=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=l.b5(1,this.center.lat)*this.worldSize;let _=l.ao(new Float64Array(16));l.K(_,_,[this.width/2,-this.height/2,1]),l.J(_,_,[1,-1,0]),this.labelPlaneMatrix=_,_=l.ao(new Float64Array(16)),l.K(_,_,[1,-1,1]),l.J(_,_,[-1,-1,0]),l.K(_,_,[2/this.width,2/this.height,1]),this.glCoordMatrix=_;const E=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),O=Math.min(this.elevation,this.minElevationForCurrentTile),z=E-O*this._pixelPerMeter/Math.cos(this._pitch),V=O<0?z:E,H=Math.PI/2+this._pitch,J=this._fov*(.5+o.y/this.height),Q=Math.sin(J)*V/Math.sin(l.ad(Math.PI-H-J,.01,Math.PI-.01)),ce=this.getHorizon(),fe=2*Math.atan(ce/this.cameraToCenterDistance)*(.5+o.y/(2*ce)),be=Math.sin(fe)*V/Math.sin(l.ad(Math.PI-H-fe,.01,Math.PI-.01)),Pe=Math.min(Q,be);this.farZ=1.01*(Math.cos(Math.PI/2-this._pitch)*Pe+V),this.nearZ=this.height/50,_=new Float64Array(16),l.b6(_,this._fov,this.width/this.height,this.nearZ,this.farZ),_[8]=2*-o.x/this.width,_[9]=2*o.y/this.height,this.projectionMatrix=l.af(_),l.K(_,_,[1,-1,1]),l.J(_,_,[0,0,-this.cameraToCenterDistance]),l.b7(_,_,this._pitch),l.ae(_,_,this.angle),l.J(_,_,[-d,-v,0]),this.mercatorMatrix=l.K([],_,[this.worldSize,this.worldSize,this.worldSize]),l.K(_,_,[1,1,this._pixelPerMeter]),this.pixelMatrix=l.L(new Float64Array(16),this.labelPlaneMatrix,_),l.J(_,_,[0,0,-this.elevation]),this.modelViewProjectionMatrix=_,this.invModelViewProjectionMatrix=l.at([],_),this.fogMatrix=new Float64Array(16),l.b6(this.fogMatrix,this._fov,this.width/this.height,E,this.farZ),this.fogMatrix[8]=2*-o.x/this.width,this.fogMatrix[9]=2*o.y/this.height,l.K(this.fogMatrix,this.fogMatrix,[1,-1,1]),l.J(this.fogMatrix,this.fogMatrix,[0,0,-this.cameraToCenterDistance]),l.b7(this.fogMatrix,this.fogMatrix,this._pitch),l.ae(this.fogMatrix,this.fogMatrix,this.angle),l.J(this.fogMatrix,this.fogMatrix,[-d,-v,0]),l.K(this.fogMatrix,this.fogMatrix,[1,1,this._pixelPerMeter]),l.J(this.fogMatrix,this.fogMatrix,[0,0,-this.elevation]),this.pixelMatrix3D=l.L(new Float64Array(16),this.labelPlaneMatrix,_);const Te=this.width%2/2,ke=this.height%2/2,Ve=Math.cos(this.angle),Ee=Math.sin(this.angle),qe=d-Math.round(d)+Ve*Te+Ee*ke,rt=v-Math.round(v)+Ve*ke+Ee*Te,ht=new Float64Array(_);if(l.J(ht,ht,[qe>.5?qe-1:qe,rt>.5?rt-1:rt,0]),this.alignedModelViewProjectionMatrix=ht,_=l.at(new Float64Array(16),this.pixelMatrix),!_)throw new Error("failed to invert matrix");this.pixelMatrixInverse=_,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const o=this.pointCoordinate(new l.P(0,0)),d=[o.x*this.worldSize,o.y*this.worldSize,0,1];return l.ag(d,d,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const o=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new l.P(0,o))}getCameraQueryGeometry(o){const d=this.getCameraPoint();if(o.length===1)return[o[0],d];{let v=d.x,_=d.y,E=d.x,O=d.y;for(const z of o)v=Math.min(v,z.x),_=Math.min(_,z.y),E=Math.max(E,z.x),O=Math.max(O,z.y);return[new l.P(v,_),new l.P(E,_),new l.P(E,O),new l.P(v,O),new l.P(v,_)]}}lngLatToCameraDepth(o,d){const v=this.locationCoordinate(o),_=[v.x*this.worldSize,v.y*this.worldSize,d,1];return l.ag(_,_,this.modelViewProjectionMatrix),_[2]/_[3]}}function _n(M,o){let d,v=!1,_=null,E=null;const O=()=>{_=null,v&&(M.apply(E,d),_=setTimeout(O,o),v=!1)};return(...z)=>(v=!0,E=this,d=z,_||O(),_)}class Qn{constructor(o){this._getCurrentHash=()=>{const d=window.location.hash.replace("#","");if(this._hashName){let v;return d.split("&").map(_=>_.split("=")).forEach(_=>{_[0]===this._hashName&&(v=_)}),(v&&v[1]||"").split("/")}return d.split("/")},this._onHashChange=()=>{const d=this._getCurrentHash();if(d.length>=3&&!d.some(v=>isNaN(v))){const v=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(d[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+d[2],+d[1]],zoom:+d[0],bearing:v,pitch:+(d[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const d=window.location.href.replace(/(#.+)?$/,this.getHashString());window.history.replaceState(window.history.state,null,d)},this._removeHash=()=>{const d=this._getCurrentHash();if(d.length===0)return;const v=d.join("/");let _=v;_.split("&").length>0&&(_=_.split("&")[0]),this._hashName&&(_=`${this._hashName}=${v}`);let E=window.location.hash.replace(_,"");E.startsWith("#&")?E=E.slice(0,1)+E.slice(2):E==="#"&&(E="");let O=window.location.href.replace(/(#.+)?$/,E);O=O.replace("&&","&"),window.history.replaceState(window.history.state,null,O)},this._updateHash=_n(this._updateHashUnthrottled,300),this._hashName=o&&encodeURIComponent(o)}addTo(o){return this._map=o,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(o){const d=this._map.getCenter(),v=Math.round(100*this._map.getZoom())/100,_=Math.ceil((v*Math.LN2+Math.log(512/360/.5))/Math.LN10),E=Math.pow(10,_),O=Math.round(d.lng*E)/E,z=Math.round(d.lat*E)/E,V=this._map.getBearing(),H=this._map.getPitch();let J="";if(J+=o?`/${O}/${z}/${v}`:`${v}/${z}/${O}`,(V||H)&&(J+="/"+Math.round(10*V)/10),H&&(J+=`/${Math.round(H)}`),this._hashName){const Q=this._hashName;let ce=!1;const fe=window.location.hash.slice(1).split("&").map(be=>{const Pe=be.split("=")[0];return Pe===Q?(ce=!0,`${Pe}=${J}`):be}).filter(be=>be);return ce||fe.push(`${Q}=${J}`),`#${fe.join("&")}`}return`#${J}`}}const gi={linearity:.3,easing:l.b8(0,0,.3,1)},Pr=l.e({deceleration:2500,maxSpeed:1400},gi),Gi=l.e({deceleration:20,maxSpeed:1400},gi),gf=l.e({deceleration:1e3,maxSpeed:360},gi),vf=l.e({deceleration:1e3,maxSpeed:90},gi);class ks{constructor(o){this._map=o,this.clear()}clear(){this._inertiaBuffer=[]}record(o){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:S.now(),settings:o})}_drainInertiaBuffer(){const o=this._inertiaBuffer,d=S.now();for(;o.length>0&&d-o[0].time>160;)o.shift()}_onMoveEnd(o){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const d={zoom:0,bearing:0,pitch:0,pan:new l.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:E}of this._inertiaBuffer)d.zoom+=E.zoomDelta||0,d.bearing+=E.bearingDelta||0,d.pitch+=E.pitchDelta||0,E.panDelta&&d.pan._add(E.panDelta),E.around&&(d.around=E.around),E.pinchAround&&(d.pinchAround=E.pinchAround);const v=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,_={};if(d.pan.mag()){const E=yf(d.pan.mag(),v,l.e({},Pr,o||{}));_.offset=d.pan.mult(E.amount/d.pan.mag()),_.center=this._map.transform.center,ll(_,E)}if(d.zoom){const E=yf(d.zoom,v,Gi);_.zoom=this._map.transform.zoom+E.amount,ll(_,E)}if(d.bearing){const E=yf(d.bearing,v,gf);_.bearing=this._map.transform.bearing+l.ad(E.amount,-179,179),ll(_,E)}if(d.pitch){const E=yf(d.pitch,v,vf);_.pitch=this._map.transform.pitch+E.amount,ll(_,E)}if(_.zoom||_.bearing){const E=d.pinchAround===void 0?d.around:d.pinchAround;_.around=E?this._map.unproject(E):this._map.getCenter()}return this.clear(),l.e(_,{noMoveStart:!0})}}function ll(M,o){(!M.duration||M.duration<o.duration)&&(M.duration=o.duration,M.easing=o.easing)}function yf(M,o,d){const{maxSpeed:v,linearity:_,deceleration:E}=d,O=l.ad(M*_/(o/1e3),-v,v),z=Math.abs(O)/(E*_);return{easing:d.easing,duration:1e3*z,amount:O*(z/2)}}class Nr extends l.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,d,v,_={}){const E=b.mousePos(d.getCanvas(),v),O=d.unproject(E);super(o,l.e({point:E,lngLat:O,originalEvent:v},_)),this._defaultPrevented=!1,this.target=d}}class $l extends l.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,d,v){const _=o==="touchend"?v.changedTouches:v.touches,E=b.touchPos(d.getCanvasContainer(),_),O=E.map(V=>d.unproject(V)),z=E.reduce((V,H,J,Q)=>V.add(H.div(Q.length)),new l.P(0,0));super(o,{points:E,point:z,lngLats:O,lngLat:d.unproject(z),originalEvent:v}),this._defaultPrevented=!1}}class yu extends l.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,d,v){super(o,{originalEvent:v}),this._defaultPrevented=!1}}class Ri{constructor(o,d){this._map=o,this._clickTolerance=d.clickTolerance}reset(){delete this._mousedownPos}wheel(o){return this._firePreventable(new yu(o.type,this._map,o))}mousedown(o,d){return this._mousedownPos=d,this._firePreventable(new Nr(o.type,this._map,o))}mouseup(o){this._map.fire(new Nr(o.type,this._map,o))}click(o,d){this._mousedownPos&&this._mousedownPos.dist(d)>=this._clickTolerance||this._map.fire(new Nr(o.type,this._map,o))}dblclick(o){return this._firePreventable(new Nr(o.type,this._map,o))}mouseover(o){this._map.fire(new Nr(o.type,this._map,o))}mouseout(o){this._map.fire(new Nr(o.type,this._map,o))}touchstart(o){return this._firePreventable(new $l(o.type,this._map,o))}touchmove(o){this._map.fire(new $l(o.type,this._map,o))}touchend(o){this._map.fire(new $l(o.type,this._map,o))}touchcancel(o){this._map.fire(new $l(o.type,this._map,o))}_firePreventable(o){if(this._map.fire(o),o.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class em{constructor(o){this._map=o}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(o){this._map.fire(new Nr(o.type,this._map,o))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Nr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(o){this._delayContextMenu?this._contextMenuEvent=o:this._ignoreContextMenu||this._map.fire(new Nr(o.type,this._map,o)),this._map.listens("contextmenu")&&o.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class kc{constructor(o){this._map=o}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(o){return this.transform.pointLocation(l.P.convert(o),this._map.terrain)}}class _u{constructor(o,d){this._map=o,this._tr=new kc(o),this._el=o.getCanvasContainer(),this._container=o.getContainer(),this._clickTolerance=d.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(o,d){this.isEnabled()&&o.shiftKey&&o.button===0&&(b.disableDrag(),this._startPos=this._lastPos=d,this._active=!0)}mousemoveWindow(o,d){if(!this._active)return;const v=d;if(this._lastPos.equals(v)||!this._box&&v.dist(this._startPos)<this._clickTolerance)return;const _=this._startPos;this._lastPos=v,this._box||(this._box=b.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",o));const E=Math.min(_.x,v.x),O=Math.max(_.x,v.x),z=Math.min(_.y,v.y),V=Math.max(_.y,v.y);b.setTransform(this._box,`translate(${E}px,${z}px)`),this._box.style.width=O-E+"px",this._box.style.height=V-z+"px"}mouseupWindow(o,d){if(!this._active||o.button!==0)return;const v=this._startPos,_=d;if(this.reset(),b.suppressClick(),v.x!==_.x||v.y!==_.y)return this._map.fire(new l.k("boxzoomend",{originalEvent:o})),{cameraAnimation:E=>E.fitScreenCoordinates(v,_,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",o)}keydown(o){this._active&&o.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",o))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(b.remove(this._box),this._box=null),b.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(o,d){return this._map.fire(new l.k(o,{originalEvent:d}))}}function xu(M,o){if(M.length!==o.length)throw new Error(`The number of touches and points are not equal - touches ${M.length}, points ${o.length}`);const d={};for(let v=0;v<M.length;v++)d[M[v].identifier]=o[v];return d}class tm{constructor(o){this.reset(),this.numTouches=o.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(o,d,v){(this.centroid||v.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=o.timeStamp),v.length===this.numTouches&&(this.centroid=function(_){const E=new l.P(0,0);for(const O of _)E._add(O);return E.div(_.length)}(d),this.touches=xu(v,d)))}touchmove(o,d,v){if(this.aborted||!this.centroid)return;const _=xu(v,d);for(const E in this.touches){const O=_[E];(!O||O.dist(this.touches[E])>30)&&(this.aborted=!0)}}touchend(o,d,v){if((!this.centroid||o.timeStamp-this.startTime>500)&&(this.aborted=!0),v.length===0){const _=!this.aborted&&this.centroid;if(this.reset(),_)return _}}}class nm{constructor(o){this.singleTap=new tm(o),this.numTaps=o.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(o,d,v){this.singleTap.touchstart(o,d,v)}touchmove(o,d,v){this.singleTap.touchmove(o,d,v)}touchend(o,d,v){const _=this.singleTap.touchend(o,d,v);if(_){const E=o.timeStamp-this.lastTime<500,O=!this.lastTap||this.lastTap.dist(_)<30;if(E&&O||this.reset(),this.count++,this.lastTime=o.timeStamp,this.lastTap=_,this.count===this.numTaps)return this.reset(),_}}}class Oh{constructor(o){this._tr=new kc(o),this._zoomIn=new nm({numTouches:1,numTaps:2}),this._zoomOut=new nm({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(o,d,v){this._zoomIn.touchstart(o,d,v),this._zoomOut.touchstart(o,d,v)}touchmove(o,d,v){this._zoomIn.touchmove(o,d,v),this._zoomOut.touchmove(o,d,v)}touchend(o,d,v){const _=this._zoomIn.touchend(o,d,v),E=this._zoomOut.touchend(o,d,v),O=this._tr;return _?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:z=>z.easeTo({duration:300,zoom:O.zoom+1,around:O.unproject(_)},{originalEvent:o})}):E?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:z=>z.easeTo({duration:300,zoom:O.zoom-1,around:O.unproject(E)},{originalEvent:o})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ti{constructor(o){this._enabled=!!o.enable,this._moveStateManager=o.moveStateManager,this._clickTolerance=o.clickTolerance||1,this._moveFunction=o.move,this._activateOnStart=!!o.activateOnStart,o.assignEvents(this),this.reset()}reset(o){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(o)}_move(...o){const d=this._moveFunction(...o);if(d.bearingDelta||d.pitchDelta||d.around||d.panDelta)return this._active=!0,d}dragStart(o,d){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(o)&&(this._moveStateManager.startMove(o),this._lastPoint=d.length?d[0]:d,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(o,d){if(!this.isEnabled())return;const v=this._lastPoint;if(!v)return;if(o.preventDefault(),!this._moveStateManager.isValidMoveEvent(o))return void this.reset(o);const _=d.length?d[0]:d;return!this._moved&&_.dist(v)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=_,this._move(v,_))}dragEnd(o){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(o)&&(this._moved&&b.suppressClick(),this.reset(o))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Sa={0:1,2:2};class Ds{constructor(o){this._correctEvent=o.checkCorrectEvent}startMove(o){const d=b.mouseButton(o);this._eventButton=d}endMove(o){delete this._eventButton}isValidStartEvent(o){return this._correctEvent(o)}isValidMoveEvent(o){return!function(d,v){const _=Sa[v];return d.buttons===void 0||(d.buttons&_)!==_}(o,this._eventButton)}isValidEndEvent(o){return b.mouseButton(o)===this._eventButton}}class Dc{constructor(){this._firstTouch=void 0}_isOneFingerTouch(o){return o.targetTouches.length===1}_isSameTouchEvent(o){return o.targetTouches[0].identifier===this._firstTouch}startMove(o){this._firstTouch=o.targetTouches[0].identifier}endMove(o){delete this._firstTouch}isValidStartEvent(o){return this._isOneFingerTouch(o)}isValidMoveEvent(o){return this._isOneFingerTouch(o)&&this._isSameTouchEvent(o)}isValidEndEvent(o){return this._isOneFingerTouch(o)&&this._isSameTouchEvent(o)}}const bu=M=>{M.mousedown=M.dragStart,M.mousemoveWindow=M.dragMove,M.mouseup=M.dragEnd,M.contextmenu=o=>{o.preventDefault()}},_f=({enable:M,clickTolerance:o,bearingDegreesPerPixelMoved:d=.8})=>{const v=new Ds({checkCorrectEvent:_=>b.mouseButton(_)===0&&_.ctrlKey||b.mouseButton(_)===2});return new Ti({clickTolerance:o,move:(_,E)=>({bearingDelta:(E.x-_.x)*d}),moveStateManager:v,enable:M,assignEvents:bu})},Ea=({enable:M,clickTolerance:o,pitchDegreesPerPixelMoved:d=-.5})=>{const v=new Ds({checkCorrectEvent:_=>b.mouseButton(_)===0&&_.ctrlKey||b.mouseButton(_)===2});return new Ti({clickTolerance:o,move:(_,E)=>({pitchDelta:(E.y-_.y)*d}),moveStateManager:v,enable:M,assignEvents:bu})};class wu{constructor(o,d){this._clickTolerance=o.clickTolerance||1,this._map=d,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new l.P(0,0)}_shouldBePrevented(o){return o<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(o,d,v){return this._calculateTransform(o,d,v)}touchmove(o,d,v){if(this._active){if(!this._shouldBePrevented(v.length))return o.preventDefault(),this._calculateTransform(o,d,v);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",o)}}touchend(o,d,v){this._calculateTransform(o,d,v),this._active&&this._shouldBePrevented(v.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(o,d,v){v.length>0&&(this._active=!0);const _=xu(v,d),E=new l.P(0,0),O=new l.P(0,0);let z=0;for(const H in _){const J=_[H],Q=this._touches[H];Q&&(E._add(J),O._add(J.sub(Q)),z++,_[H]=J)}if(this._touches=_,this._shouldBePrevented(z)||!O.mag())return;const V=O.div(z);return this._sum._add(V),this._sum.mag()<this._clickTolerance?void 0:{around:E.div(z),panDelta:V}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class cl{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(o,d,v){this._firstTwoTouches||v.length<2||(this._firstTwoTouches=[v[0].identifier,v[1].identifier],this._start([d[0],d[1]]))}touchmove(o,d,v){if(!this._firstTwoTouches)return;o.preventDefault();const[_,E]=this._firstTwoTouches,O=ia(v,d,_),z=ia(v,d,E);if(!O||!z)return;const V=this._aroundCenter?null:O.add(z).div(2);return this._move([O,z],V,o)}touchend(o,d,v){if(!this._firstTwoTouches)return;const[_,E]=this._firstTwoTouches,O=ia(v,d,_),z=ia(v,d,E);O&&z||(this._active&&b.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(o){this._enabled=!0,this._aroundCenter=!!o&&o.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function ia(M,o,d){for(let v=0;v<M.length;v++)if(M[v].identifier===d)return o[v]}function Su(M,o){return Math.log(M/o)/Math.LN2}class im extends cl{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(o){this._startDistance=this._distance=o[0].dist(o[1])}_move(o,d){const v=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(Su(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Su(this._distance,v),pinchAround:d}}}function rm(M,o){return 180*M.angleWith(o)/Math.PI}class sm extends cl{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])}_move(o,d,v){const _=this._vector;if(this._vector=o[0].sub(o[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:rm(this._vector,_),pinchAround:d}}_isBelowThreshold(o){this._minDiameter=Math.min(this._minDiameter,o.mag());const d=25/(Math.PI*this._minDiameter)*360,v=rm(o,this._startVector);return Math.abs(v)<d}}function Do(M){return Math.abs(M.y)>Math.abs(M.x)}class Eu extends cl{constructor(o){super(),this._currentTouchCount=0,this._map=o}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(o,d,v){super.touchstart(o,d,v),this._currentTouchCount=v.length}_start(o){this._lastPoints=o,Do(o[0].sub(o[1]))&&(this._valid=!1)}_move(o,d,v){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const _=o[0].sub(this._lastPoints[0]),E=o[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(_,E,v.timeStamp),this._valid?(this._lastPoints=o,this._active=!0,{pitchDelta:(_.y+E.y)/2*-.5}):void 0}gestureBeginsVertically(o,d,v){if(this._valid!==void 0)return this._valid;const _=o.mag()>=2,E=d.mag()>=2;if(!_&&!E)return;if(!_||!E)return this._firstMove===void 0&&(this._firstMove=v),v-this._firstMove<100&&void 0;const O=o.y>0==d.y>0;return Do(o)&&Do(d)&&O}}const xf={panStep:100,bearingStep:15,pitchStep:10};class om{constructor(o){this._tr=new kc(o);const d=xf;this._panStep=d.panStep,this._bearingStep=d.bearingStep,this._pitchStep=d.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(o){if(o.altKey||o.ctrlKey||o.metaKey)return;let d=0,v=0,_=0,E=0,O=0;switch(o.keyCode){case 61:case 107:case 171:case 187:d=1;break;case 189:case 109:case 173:d=-1;break;case 37:o.shiftKey?v=-1:(o.preventDefault(),E=-1);break;case 39:o.shiftKey?v=1:(o.preventDefault(),E=1);break;case 38:o.shiftKey?_=1:(o.preventDefault(),O=-1);break;case 40:o.shiftKey?_=-1:(o.preventDefault(),O=1);break;default:return}return this._rotationDisabled&&(v=0,_=0),{cameraAnimation:z=>{const V=this._tr;z.easeTo({duration:300,easeId:"keyboardHandler",easing:am,zoom:d?Math.round(V.zoom)+d*(o.shiftKey?2:1):V.zoom,bearing:V.bearing+v*this._bearingStep,pitch:V.pitch+_*this._pitchStep,offset:[-E*this._panStep,-O*this._panStep],center:V.center},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function am(M){return M*(2-M)}const lm=4.000244140625;class cm{constructor(o,d){this._onTimeout=v=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(v)},this._map=o,this._tr=new kc(o),this._triggerRenderFrame=d,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(o){this._defaultZoomRate=o}setWheelZoomRate(o){this._wheelZoomRate=o}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(o){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!o&&o.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(o){return!!this._map.cooperativeGestures.isEnabled()&&!(o.ctrlKey||this._map.cooperativeGestures.isBypassed(o))}wheel(o){if(!this.isEnabled())return;if(this._shouldBePrevented(o))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",o);let d=o.deltaMode===WheelEvent.DOM_DELTA_LINE?40*o.deltaY:o.deltaY;const v=S.now(),_=v-(this._lastWheelEventTime||0);this._lastWheelEventTime=v,d!==0&&d%lm==0?this._type="wheel":d!==0&&Math.abs(d)<4?this._type="trackpad":_>400?(this._type=null,this._lastValue=d,this._timeout=setTimeout(this._onTimeout,40,o)):this._type||(this._type=Math.abs(_*d)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,d+=this._lastValue)),o.shiftKey&&d&&(d/=4),this._type&&(this._lastWheelEvent=o,this._delta-=d,this._active||this._start(o)),o.preventDefault()}_start(o){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const d=b.mousePos(this._map.getCanvas(),o),v=this._tr;this._around=d.y>v.transform.height/2-v.transform.getHorizon()?l.N.convert(this._aroundCenter?v.center:v.unproject(d)):l.N.convert(v.center),this._aroundPoint=v.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const o=this._tr.transform;if(this._delta!==0){const V=this._type==="wheel"&&Math.abs(this._delta)>lm?this._wheelZoomRate:this._defaultZoomRate;let H=2/(1+Math.exp(-Math.abs(this._delta*V)));this._delta<0&&H!==0&&(H=1/H);const J=typeof this._targetZoom=="number"?o.zoomScale(this._targetZoom):o.scale;this._targetZoom=Math.min(o.maxZoom,Math.max(o.minZoom,o.scaleZoom(J*H))),this._type==="wheel"&&(this._startZoom=o.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const d=typeof this._targetZoom=="number"?this._targetZoom:o.zoom,v=this._startZoom,_=this._easing;let E,O=!1;const z=S.now()-this._lastWheelEventTime;if(this._type==="wheel"&&v&&_&&z){const V=Math.min(z/200,1),H=_(V);E=l.z.number(v,d,H),V<1?this._frameId||(this._frameId=!0):O=!0}else E=d,O=!0;return this._active=!0,O&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!O,zoomDelta:E-o.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(o){let d=l.b9;if(this._prevEase){const v=this._prevEase,_=(S.now()-v.start)/v.duration,E=v.easing(_+.01)-v.easing(_),O=.27/Math.sqrt(E*E+1e-4)*.01,z=Math.sqrt(.0729-O*O);d=l.b8(O,z,.25,1)}return this._prevEase={start:S.now(),duration:o,easing:d},d}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Ir{constructor(o,d){this._clickZoom=o,this._tapZoom=d}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class jr{constructor(o){this._tr=new kc(o),this.reset()}reset(){this._active=!1}dblclick(o,d){return o.preventDefault(),{cameraAnimation:v=>{v.easeTo({duration:300,zoom:this._tr.zoom+(o.shiftKey?-1:1),around:this._tr.unproject(d)},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class l0{constructor(){this._tap=new nm({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(o,d,v){if(!this._swipePoint)if(this._tapTime){const _=d[0],E=o.timeStamp-this._tapTime<500,O=this._tapPoint.dist(_)<30;E&&O?v.length>0&&(this._swipePoint=_,this._swipeTouch=v[0].identifier):this.reset()}else this._tap.touchstart(o,d,v)}touchmove(o,d,v){if(this._tapTime){if(this._swipePoint){if(v[0].identifier!==this._swipeTouch)return;const _=d[0],E=_.y-this._swipePoint.y;return this._swipePoint=_,o.preventDefault(),this._active=!0,{zoomDelta:E/128}}}else this._tap.touchmove(o,d,v)}touchend(o,d,v){if(this._tapTime)this._swipePoint&&v.length===0&&this.reset();else{const _=this._tap.touchend(o,d,v);_&&(this._tapTime=o.timeStamp,this._tapPoint=_)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Oo{constructor(o,d,v){this._el=o,this._mousePan=d,this._touchPan=v}enable(o){this._inertiaOptions=o||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Fo{constructor(o,d,v){this._pitchWithRotate=o.pitchWithRotate,this._mouseRotate=d,this._mousePitch=v}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class um{constructor(o,d,v,_){this._el=o,this._touchZoom=d,this._touchRotate=v,this._tapDragZoom=_,this._rotationDisabled=!1,this._enabled=!0}enable(o){this._touchZoom.enable(o),this._rotationDisabled||this._touchRotate.enable(o),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class mo{constructor(o,d){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=o,this._options=d,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const o=this._map.getCanvasContainer();o.classList.add("maplibregl-cooperative-gestures"),this._container=b.create("div","maplibregl-cooperative-gesture-screen",o);let d=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(d=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const v=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),_=document.createElement("div");_.className="maplibregl-desktop-message",_.textContent=d,this._container.appendChild(_);const E=document.createElement("div");E.className="maplibregl-mobile-message",E.textContent=v,this._container.appendChild(E),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(b.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(o){return o[this._bypassKey]}notifyGestureBlocked(o,d){this._enabled&&(this._map.fire(new l.k("cooperativegestureprevented",{gestureType:o,originalEvent:d})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const go=M=>M.zoom||M.drag||M.pitch||M.rotate;class hm extends l.k{}function Hl(M){return M.panDelta&&M.panDelta.mag()||M.zoomDelta||M.bearingDelta||M.pitchDelta}class Fh{constructor(o,d){this.handleWindowEvent=_=>{this.handleEvent(_,`${_.type}Window`)},this.handleEvent=(_,E)=>{if(_.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const O=_.type==="renderFrame"?void 0:_,z={needsRenderFrame:!1},V={},H={},J=_.touches,Q=J?this._getMapTouches(J):void 0,ce=Q?b.touchPos(this._map.getCanvas(),Q):b.mousePos(this._map.getCanvas(),_);for(const{handlerName:Pe,handler:Te,allowed:ke}of this._handlers){if(!Te.isEnabled())continue;let Ve;this._blockedByActive(H,ke,Pe)?Te.reset():Te[E||_.type]&&(Ve=Te[E||_.type](_,ce,Q),this.mergeHandlerResult(z,V,Ve,Pe,O),Ve&&Ve.needsRenderFrame&&this._triggerRenderFrame()),(Ve||Te.isActive())&&(H[Pe]=Te)}const fe={};for(const Pe in this._previousActiveHandlers)H[Pe]||(fe[Pe]=O);this._previousActiveHandlers=H,(Object.keys(fe).length||Hl(z))&&(this._changes.push([z,V,fe]),this._triggerRenderFrame()),(Object.keys(H).length||Hl(z))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:be}=z;be&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],be(this._map))},this._map=o,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new ks(o),this._bearingSnap=d.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(d);const v=this._el;this._listeners=[[v,"touchstart",{passive:!0}],[v,"touchmove",{passive:!1}],[v,"touchend",void 0],[v,"touchcancel",void 0],[v,"mousedown",void 0],[v,"mousemove",void 0],[v,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[v,"mouseover",void 0],[v,"mouseout",void 0],[v,"dblclick",void 0],[v,"click",void 0],[v,"keydown",{capture:!1}],[v,"keyup",void 0],[v,"wheel",{passive:!1}],[v,"contextmenu",void 0],[window,"blur",void 0]];for(const[_,E,O]of this._listeners)b.addEventListener(_,E,_===document?this.handleWindowEvent:this.handleEvent,O)}destroy(){for(const[o,d,v]of this._listeners)b.removeEventListener(o,d,o===document?this.handleWindowEvent:this.handleEvent,v)}_addDefaultHandlers(o){const d=this._map,v=d.getCanvasContainer();this._add("mapEvent",new Ri(d,o));const _=d.boxZoom=new _u(d,o);this._add("boxZoom",_),o.interactive&&o.boxZoom&&_.enable();const E=d.cooperativeGestures=new mo(d,o.cooperativeGestures);this._add("cooperativeGestures",E),o.cooperativeGestures&&E.enable();const O=new Oh(d),z=new jr(d);d.doubleClickZoom=new Ir(z,O),this._add("tapZoom",O),this._add("clickZoom",z),o.interactive&&o.doubleClickZoom&&d.doubleClickZoom.enable();const V=new l0;this._add("tapDragZoom",V);const H=d.touchPitch=new Eu(d);this._add("touchPitch",H),o.interactive&&o.touchPitch&&d.touchPitch.enable(o.touchPitch);const J=_f(o),Q=Ea(o);d.dragRotate=new Fo(o,J,Q),this._add("mouseRotate",J,["mousePitch"]),this._add("mousePitch",Q,["mouseRotate"]),o.interactive&&o.dragRotate&&d.dragRotate.enable();const ce=(({enable:Ve,clickTolerance:Ee})=>{const qe=new Ds({checkCorrectEvent:rt=>b.mouseButton(rt)===0&&!rt.ctrlKey});return new Ti({clickTolerance:Ee,move:(rt,ht)=>({around:ht,panDelta:ht.sub(rt)}),activateOnStart:!0,moveStateManager:qe,enable:Ve,assignEvents:bu})})(o),fe=new wu(o,d);d.dragPan=new Oo(v,ce,fe),this._add("mousePan",ce),this._add("touchPan",fe,["touchZoom","touchRotate"]),o.interactive&&o.dragPan&&d.dragPan.enable(o.dragPan);const be=new sm,Pe=new im;d.touchZoomRotate=new um(v,Pe,be,V),this._add("touchRotate",be,["touchPan","touchZoom"]),this._add("touchZoom",Pe,["touchPan","touchRotate"]),o.interactive&&o.touchZoomRotate&&d.touchZoomRotate.enable(o.touchZoomRotate);const Te=d.scrollZoom=new cm(d,()=>this._triggerRenderFrame());this._add("scrollZoom",Te,["mousePan"]),o.interactive&&o.scrollZoom&&d.scrollZoom.enable(o.scrollZoom);const ke=d.keyboard=new om(d);this._add("keyboard",ke),o.interactive&&o.keyboard&&d.keyboard.enable(),this._add("blockableMapEvent",new em(d))}_add(o,d,v){this._handlers.push({handlerName:o,handler:d,allowed:v}),this._handlersById[o]=d}stop(o){if(!this._updatingCamera){for(const{handler:d}of this._handlers)d.reset();this._inertia.clear(),this._fireEvents({},{},o),this._changes=[]}}isActive(){for(const{handler:o}of this._handlers)if(o.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!go(this._eventsInProgress)||this.isZooming()}_blockedByActive(o,d,v){for(const _ in o)if(_!==v&&(!d||d.indexOf(_)<0))return!0;return!1}_getMapTouches(o){const d=[];for(const v of o)this._el.contains(v.target)&&d.push(v);return d}mergeHandlerResult(o,d,v,_,E){if(!v)return;l.e(o,v);const O={handlerName:_,originalEvent:v.originalEvent||E};v.zoomDelta!==void 0&&(d.zoom=O),v.panDelta!==void 0&&(d.drag=O),v.pitchDelta!==void 0&&(d.pitch=O),v.bearingDelta!==void 0&&(d.rotate=O)}_applyChanges(){const o={},d={},v={};for(const[_,E,O]of this._changes)_.panDelta&&(o.panDelta=(o.panDelta||new l.P(0,0))._add(_.panDelta)),_.zoomDelta&&(o.zoomDelta=(o.zoomDelta||0)+_.zoomDelta),_.bearingDelta&&(o.bearingDelta=(o.bearingDelta||0)+_.bearingDelta),_.pitchDelta&&(o.pitchDelta=(o.pitchDelta||0)+_.pitchDelta),_.around!==void 0&&(o.around=_.around),_.pinchAround!==void 0&&(o.pinchAround=_.pinchAround),_.noInertia&&(o.noInertia=_.noInertia),l.e(d,E),l.e(v,O);this._updateMapTransform(o,d,v),this._changes=[]}_updateMapTransform(o,d,v){const _=this._map,E=_._getTransformForUpdate(),O=_.terrain;if(!(Hl(o)||O&&this._terrainMovement))return this._fireEvents(d,v,!0);let{panDelta:z,zoomDelta:V,bearingDelta:H,pitchDelta:J,around:Q,pinchAround:ce}=o;ce!==void 0&&(Q=ce),_._stop(!0),Q=Q||_.transform.centerPoint;const fe=E.pointLocation(z?Q.sub(z):Q);H&&(E.bearing+=H),J&&(E.pitch+=J),V&&(E.zoom+=V),O?this._terrainMovement||!d.drag&&!d.zoom?d.drag&&this._terrainMovement?E.center=E.pointLocation(E.centerPoint.sub(z)):E.setLocationAtPoint(fe,Q):(this._terrainMovement=!0,this._map._elevationFreeze=!0,E.setLocationAtPoint(fe,Q)):E.setLocationAtPoint(fe,Q),_._applyUpdatedTransform(E),this._map._update(),o.noInertia||this._inertia.record(o),this._fireEvents(d,v,!0)}_fireEvents(o,d,v){const _=go(this._eventsInProgress),E=go(o),O={};for(const Q in o){const{originalEvent:ce}=o[Q];this._eventsInProgress[Q]||(O[`${Q}start`]=ce),this._eventsInProgress[Q]=o[Q]}!_&&E&&this._fireEvent("movestart",E.originalEvent);for(const Q in O)this._fireEvent(Q,O[Q]);E&&this._fireEvent("move",E.originalEvent);for(const Q in o){const{originalEvent:ce}=o[Q];this._fireEvent(Q,ce)}const z={};let V;for(const Q in this._eventsInProgress){const{handlerName:ce,originalEvent:fe}=this._eventsInProgress[Q];this._handlersById[ce].isActive()||(delete this._eventsInProgress[Q],V=d[ce]||fe,z[`${Q}end`]=V)}for(const Q in z)this._fireEvent(Q,z[Q]);const H=go(this._eventsInProgress),J=(_||E)&&!H;if(J&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const Q=this._map._getTransformForUpdate();Q.recalculateZoom(this._map.terrain),this._map._applyUpdatedTransform(Q)}if(v&&J){this._updatingCamera=!0;const Q=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),ce=fe=>fe!==0&&-this._bearingSnap<fe&&fe<this._bearingSnap;!Q||!Q.essential&&S.prefersReducedMotion?(this._map.fire(new l.k("moveend",{originalEvent:V})),ce(this._map.getBearing())&&this._map.resetNorth()):(ce(Q.bearing||this._map.getBearing())&&(Q.bearing=0),Q.freezeElevation=!0,this._map.easeTo(Q,{originalEvent:V})),this._updatingCamera=!1}}_fireEvent(o,d){this._map.fire(new l.k(o,d?{originalEvent:d}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(o=>{delete this._frameId,this.handleEvent(new hm("renderFrame",{timeStamp:o})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class zh extends l.E{constructor(o,d){super(),this._renderFrameCallback=()=>{const v=Math.min((S.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(v)),v<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=d.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new l.N(this.transform.center.lng,this.transform.center.lat)}setCenter(o,d){return this.jumpTo({center:o},d)}panBy(o,d,v){return o=l.P.convert(o).mult(-1),this.panTo(this.transform.center,l.e({offset:o},d),v)}panTo(o,d,v){return this.easeTo(l.e({center:o},d),v)}getZoom(){return this.transform.zoom}setZoom(o,d){return this.jumpTo({zoom:o},d),this}zoomTo(o,d,v){return this.easeTo(l.e({zoom:o},d),v)}zoomIn(o,d){return this.zoomTo(this.getZoom()+1,o,d),this}zoomOut(o,d){return this.zoomTo(this.getZoom()-1,o,d),this}getBearing(){return this.transform.bearing}setBearing(o,d){return this.jumpTo({bearing:o},d),this}getPadding(){return this.transform.padding}setPadding(o,d){return this.jumpTo({padding:o},d),this}rotateTo(o,d,v){return this.easeTo(l.e({bearing:o},d),v)}resetNorth(o,d){return this.rotateTo(0,l.e({duration:1e3},o),d),this}resetNorthPitch(o,d){return this.easeTo(l.e({bearing:0,pitch:0,duration:1e3},o),d),this}snapToNorth(o,d){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,d):this}getPitch(){return this.transform.pitch}setPitch(o,d){return this.jumpTo({pitch:o},d),this}cameraForBounds(o,d){o=Ue.convert(o);const v=d&&d.bearing||0;return this._cameraForBoxAndBearing(o.getNorthWest(),o.getSouthEast(),v,d)}_cameraForBoxAndBearing(o,d,v,_){const E={top:0,bottom:0,right:0,left:0};if(typeof(_=l.e({padding:E,offset:[0,0],maxZoom:this.transform.maxZoom},_)).padding=="number"){const kt=_.padding;_.padding={top:kt,bottom:kt,right:kt,left:kt}}_.padding=l.e(E,_.padding);const O=this.transform,z=O.padding,V=new Ue(o,d),H=O.project(V.getNorthWest()),J=O.project(V.getNorthEast()),Q=O.project(V.getSouthEast()),ce=O.project(V.getSouthWest()),fe=l.ba(-v),be=H.rotate(fe),Pe=J.rotate(fe),Te=Q.rotate(fe),ke=ce.rotate(fe),Ve=new l.P(Math.max(be.x,Pe.x,ke.x,Te.x),Math.max(be.y,Pe.y,ke.y,Te.y)),Ee=new l.P(Math.min(be.x,Pe.x,ke.x,Te.x),Math.min(be.y,Pe.y,ke.y,Te.y)),qe=Ve.sub(Ee),rt=(O.width-(z.left+z.right+_.padding.left+_.padding.right))/qe.x,ht=(O.height-(z.top+z.bottom+_.padding.top+_.padding.bottom))/qe.y;if(ht<0||rt<0)return void l.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const At=Math.min(O.scaleZoom(O.scale*Math.min(rt,ht)),_.maxZoom),Ft=l.P.convert(_.offset),an=new l.P((_.padding.left-_.padding.right)/2,(_.padding.top-_.padding.bottom)/2).rotate(l.ba(v)),sn=Ft.add(an).mult(O.scale/O.zoomScale(At));return{center:O.unproject(H.add(Q).div(2).sub(sn)),zoom:At,bearing:v}}fitBounds(o,d,v){return this._fitInternal(this.cameraForBounds(o,d),d,v)}fitScreenCoordinates(o,d,v,_,E){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(l.P.convert(o)),this.transform.pointLocation(l.P.convert(d)),v,_),_,E)}_fitInternal(o,d,v){return o?(delete(d=l.e(o,d)).padding,d.linear?this.easeTo(d,v):this.flyTo(d,v)):this}jumpTo(o,d){this.stop();const v=this._getTransformForUpdate();let _=!1,E=!1,O=!1;return"zoom"in o&&v.zoom!==+o.zoom&&(_=!0,v.zoom=+o.zoom),o.center!==void 0&&(v.center=l.N.convert(o.center)),"bearing"in o&&v.bearing!==+o.bearing&&(E=!0,v.bearing=+o.bearing),"pitch"in o&&v.pitch!==+o.pitch&&(O=!0,v.pitch=+o.pitch),o.padding==null||v.isPaddingEqual(o.padding)||(v.padding=o.padding),this._applyUpdatedTransform(v),this.fire(new l.k("movestart",d)).fire(new l.k("move",d)),_&&this.fire(new l.k("zoomstart",d)).fire(new l.k("zoom",d)).fire(new l.k("zoomend",d)),E&&this.fire(new l.k("rotatestart",d)).fire(new l.k("rotate",d)).fire(new l.k("rotateend",d)),O&&this.fire(new l.k("pitchstart",d)).fire(new l.k("pitch",d)).fire(new l.k("pitchend",d)),this.fire(new l.k("moveend",d))}calculateCameraOptionsFromTo(o,d,v,_=0){const E=l.Z.fromLngLat(o,d),O=l.Z.fromLngLat(v,_),z=O.x-E.x,V=O.y-E.y,H=O.z-E.z,J=Math.hypot(z,V,H);if(J===0)throw new Error("Can't calculate camera options with same From and To");const Q=Math.hypot(z,V),ce=this.transform.scaleZoom(this.transform.cameraToCenterDistance/J/this.transform.tileSize),fe=180*Math.atan2(z,-V)/Math.PI;let be=180*Math.acos(Q/J)/Math.PI;return be=H<0?90-be:90+be,{center:O.toLngLat(),zoom:ce,pitch:be,bearing:fe}}easeTo(o,d){var v;this._stop(!1,o.easeId),((o=l.e({offset:[0,0],duration:500,easing:l.b9},o)).animate===!1||!o.essential&&S.prefersReducedMotion)&&(o.duration=0);const _=this._getTransformForUpdate(),E=_.zoom,O=_.bearing,z=_.pitch,V=_.padding,H="bearing"in o?this._normalizeBearing(o.bearing,O):O,J="pitch"in o?+o.pitch:z,Q="padding"in o?o.padding:_.padding,ce=l.P.convert(o.offset);let fe=_.centerPoint.add(ce);const be=_.pointLocation(fe),{center:Pe,zoom:Te}=_.getConstrained(l.N.convert(o.center||be),(v=o.zoom)!==null&&v!==void 0?v:E);this._normalizeCenter(Pe,_);const ke=_.project(be),Ve=_.project(Pe).sub(ke),Ee=_.zoomScale(Te-E);let qe,rt;o.around&&(qe=l.N.convert(o.around),rt=_.locationPoint(qe));const ht={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||Te!==E,this._rotating=this._rotating||O!==H,this._pitching=this._pitching||J!==z,this._padding=!_.isPaddingEqual(Q),this._easeId=o.easeId,this._prepareEase(d,o.noMoveStart,ht),this.terrain&&this._prepareElevation(Pe),this._ease(At=>{if(this._zooming&&(_.zoom=l.z.number(E,Te,At)),this._rotating&&(_.bearing=l.z.number(O,H,At)),this._pitching&&(_.pitch=l.z.number(z,J,At)),this._padding&&(_.interpolatePadding(V,Q,At),fe=_.centerPoint.add(ce)),this.terrain&&!o.freezeElevation&&this._updateElevation(At),qe)_.setLocationAtPoint(qe,rt);else{const Ft=_.zoomScale(_.zoom-E),an=Te>E?Math.min(2,Ee):Math.max(.5,Ee),sn=Math.pow(an,1-At),kt=_.unproject(ke.add(Ve.mult(At*sn)).mult(Ft));_.setLocationAtPoint(_.renderWorldCopies?kt.wrap():kt,fe)}this._applyUpdatedTransform(_),this._fireMoveEvents(d)},At=>{this.terrain&&o.freezeElevation&&this._finalizeElevation(),this._afterEase(d,At)},o),this}_prepareEase(o,d,v={}){this._moving=!0,d||v.moving||this.fire(new l.k("movestart",o)),this._zooming&&!v.zooming&&this.fire(new l.k("zoomstart",o)),this._rotating&&!v.rotating&&this.fire(new l.k("rotatestart",o)),this._pitching&&!v.pitching&&this.fire(new l.k("pitchstart",o))}_prepareElevation(o){this._elevationCenter=o,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(o,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(o){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const d=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(o<1&&d!==this._elevationTarget){const v=this._elevationTarget-this._elevationStart;this._elevationStart+=o*(v-(d-(v*o+this._elevationStart))/(1-o)),this._elevationTarget=d}this.transform.elevation=l.z.number(this._elevationStart,this._elevationTarget,o)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(o){const d=o.getCameraPosition(),v=this.terrain.getElevationForLngLatZoom(d.lngLat,o.zoom);if(d.altitude<v){const _=this.calculateCameraOptionsFromTo(d.lngLat,v,o.center,o.elevation);return{pitch:_.pitch,zoom:_.zoom}}return{}}_applyUpdatedTransform(o){const d=[];if(this.terrain&&d.push(_=>this._elevateCameraIfInsideTerrain(_)),this.transformCameraUpdate&&d.push(_=>this.transformCameraUpdate(_)),!d.length)return;const v=o.clone();for(const _ of d){const E=v.clone(),{center:O,zoom:z,pitch:V,bearing:H,elevation:J}=_(E);O&&(E.center=O),z!==void 0&&(E.zoom=z),V!==void 0&&(E.pitch=V),H!==void 0&&(E.bearing=H),J!==void 0&&(E.elevation=J),v.apply(E)}this.transform.apply(v)}_fireMoveEvents(o){this.fire(new l.k("move",o)),this._zooming&&this.fire(new l.k("zoom",o)),this._rotating&&this.fire(new l.k("rotate",o)),this._pitching&&this.fire(new l.k("pitch",o))}_afterEase(o,d){if(this._easeId&&d&&this._easeId===d)return;delete this._easeId;const v=this._zooming,_=this._rotating,E=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,v&&this.fire(new l.k("zoomend",o)),_&&this.fire(new l.k("rotateend",o)),E&&this.fire(new l.k("pitchend",o)),this.fire(new l.k("moveend",o))}flyTo(o,d){var v;if(!o.essential&&S.prefersReducedMotion){const tn=l.M(o,["center","zoom","bearing","pitch","around"]);return this.jumpTo(tn,d)}this.stop(),o=l.e({offset:[0,0],speed:1.2,curve:1.42,easing:l.b9},o);const _=this._getTransformForUpdate(),E=_.zoom,O=_.bearing,z=_.pitch,V=_.padding,H="bearing"in o?this._normalizeBearing(o.bearing,O):O,J="pitch"in o?+o.pitch:z,Q="padding"in o?o.padding:_.padding,ce=l.P.convert(o.offset);let fe=_.centerPoint.add(ce);const be=_.pointLocation(fe),{center:Pe,zoom:Te}=_.getConstrained(l.N.convert(o.center||be),(v=o.zoom)!==null&&v!==void 0?v:E);this._normalizeCenter(Pe,_);const ke=_.zoomScale(Te-E),Ve=_.project(be),Ee=_.project(Pe).sub(Ve);let qe=o.curve;const rt=Math.max(_.width,_.height),ht=rt/ke,At=Ee.mag();if("minZoom"in o){const tn=l.ad(Math.min(o.minZoom,E,Te),_.minZoom,_.maxZoom),Un=rt/_.zoomScale(tn-E);qe=Math.sqrt(Un/At*2)}const Ft=qe*qe;function an(tn){const Un=(ht*ht-rt*rt+(tn?-1:1)*Ft*Ft*At*At)/(2*(tn?ht:rt)*Ft*At);return Math.log(Math.sqrt(Un*Un+1)-Un)}function sn(tn){return(Math.exp(tn)-Math.exp(-tn))/2}function kt(tn){return(Math.exp(tn)+Math.exp(-tn))/2}const Kt=an(!1);let pn=function(tn){return kt(Kt)/kt(Kt+qe*tn)},$n=function(tn){return rt*((kt(Kt)*(sn(Un=Kt+qe*tn)/kt(Un))-sn(Kt))/Ft)/At;var Un},Jt=(an(!0)-Kt)/qe;if(Math.abs(At)<1e-6||!isFinite(Jt)){if(Math.abs(rt-ht)<1e-6)return this.easeTo(o,d);const tn=ht<rt?-1:1;Jt=Math.abs(Math.log(ht/rt))/qe,$n=()=>0,pn=Un=>Math.exp(tn*qe*Un)}return o.duration="duration"in o?+o.duration:1e3*Jt/("screenSpeed"in o?+o.screenSpeed/qe:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0),this._zooming=!0,this._rotating=O!==H,this._pitching=J!==z,this._padding=!_.isPaddingEqual(Q),this._prepareEase(d,!1),this.terrain&&this._prepareElevation(Pe),this._ease(tn=>{const Un=tn*Jt,rr=1/pn(Un);_.zoom=tn===1?Te:E+_.scaleZoom(rr),this._rotating&&(_.bearing=l.z.number(O,H,tn)),this._pitching&&(_.pitch=l.z.number(z,J,tn)),this._padding&&(_.interpolatePadding(V,Q,tn),fe=_.centerPoint.add(ce)),this.terrain&&!o.freezeElevation&&this._updateElevation(tn);const ei=tn===1?Pe:_.unproject(Ve.add(Ee.mult($n(Un))).mult(rr));_.setLocationAtPoint(_.renderWorldCopies?ei.wrap():ei,fe),this._applyUpdatedTransform(_),this._fireMoveEvents(d)},()=>{this.terrain&&o.freezeElevation&&this._finalizeElevation(),this._afterEase(d)},o),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(o,d){var v;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const _=this._onEaseEnd;delete this._onEaseEnd,_.call(this,d)}return o||(v=this.handlers)===null||v===void 0||v.stop(!1),this}_ease(o,d,v){v.animate===!1||v.duration===0?(o(1),d()):(this._easeStart=S.now(),this._easeOptions=v,this._onEaseFrame=o,this._onEaseEnd=d,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(o,d){o=l.b3(o,-180,180);const v=Math.abs(o-d);return Math.abs(o-360-d)<v&&(o-=360),Math.abs(o+360-d)<v&&(o+=360),o}_normalizeCenter(o,d){if(!d.renderWorldCopies||d.lngRange)return;const v=o.lng-d.center.lng;o.lng+=v>180?-360:v<-180?360:0}queryTerrainElevation(o){return this.terrain?this.terrain.getElevationForLngLatZoom(l.N.convert(o),this.transform.tileZoom)-this.transform.elevation:null}}const Mu={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class ra{constructor(o=Mu){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=d=>{!d||d.sourceDataType!=="metadata"&&d.sourceDataType!=="visibility"&&d.dataType!=="style"&&d.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=o}getDefaultPosition(){return"bottom-right"}onAdd(o){return this._map=o,this._compact=this.options.compact,this._container=b.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=b.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=b.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){b.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(o,d){const v=this._map._getUIString(`AttributionControl.${d}`);o.title=v,o.setAttribute("aria-label",v)}_updateAttributions(){if(!this._map.style)return;let o=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?o=o.concat(this.options.customAttribution.map(_=>typeof _!="string"?"":_)):typeof this.options.customAttribution=="string"&&o.push(this.options.customAttribution)),this._map.style.stylesheet){const _=this._map.style.stylesheet;this.styleOwner=_.owner,this.styleId=_.id}const d=this._map.style.sourceCaches;for(const _ in d){const E=d[_];if(E.used||E.usedForTerrain){const O=E.getSource();O.attribution&&o.indexOf(O.attribution)<0&&o.push(O.attribution)}}o=o.filter(_=>String(_).trim()),o.sort((_,E)=>_.length-E.length),o=o.filter((_,E)=>{for(let O=E+1;O<o.length;O++)if(o[O].indexOf(_)>=0)return!1;return!0});const v=o.join(" | ");v!==this._attribHTML&&(this._attribHTML=v,o.length?(this._innerContainer.innerHTML=v,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Ma{constructor(o={}){this._updateCompact=()=>{const d=this._container.children;if(d.length){const v=d[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&v.classList.add("maplibregl-compact"):v.classList.remove("maplibregl-compact")}},this.options=o}getDefaultPosition(){return"bottom-left"}onAdd(o){this._map=o,this._compact=this.options&&this.options.compact,this._container=b.create("div","maplibregl-ctrl");const d=b.create("a","maplibregl-ctrl-logo");return d.target="_blank",d.rel="noopener nofollow",d.href="https://maplibre.org/",d.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),d.setAttribute("rel","noopener nofollow"),this._container.appendChild(d),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){b.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class dn{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(o){const d=++this._id;return this._queue.push({callback:o,id:d,cancelled:!1}),d}remove(o){const d=this._currentlyRunning,v=d?this._queue.concat(d):this._queue;for(const _ of v)if(_.id===o)return void(_.cancelled=!0)}run(o=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const d=this._currentlyRunning=this._queue;this._queue=[];for(const v of d)if(!v.cancelled&&(v.callback(o),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var c0=l.Y([{name:"a_pos3d",type:"Int16",components:3}]);class dm extends l.E{constructor(o){super(),this.sourceCache=o,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,o.usedForTerrain=!0,o.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(o,d){this.sourceCache.update(o,d),this._renderableTilesKeys=[];const v={};for(const _ of o.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:d}))v[_.key]=!0,this._renderableTilesKeys.push(_.key),this._tiles[_.key]||(_.posMatrix=new Float64Array(16),l.aQ(_.posMatrix,0,l.X,0,l.X,0,1),this._tiles[_.key]=new Wn(_,this.tileSize));for(const _ in this._tiles)v[_]||delete this._tiles[_]}freeRtt(o){for(const d in this._tiles){const v=this._tiles[d];(!o||v.tileID.equals(o)||v.tileID.isChildOf(o)||o.isChildOf(v.tileID))&&(v.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(o=>this.getTileByID(o))}getTileByID(o){return this._tiles[o]}getTerrainCoords(o){const d={};for(const v of this._renderableTilesKeys){const _=this._tiles[v].tileID;if(_.canonical.equals(o.canonical)){const E=o.clone();E.posMatrix=new Float64Array(16),l.aQ(E.posMatrix,0,l.X,0,l.X,0,1),d[v]=E}else if(_.canonical.isChildOf(o.canonical)){const E=o.clone();E.posMatrix=new Float64Array(16);const O=_.canonical.z-o.canonical.z,z=_.canonical.x-(_.canonical.x>>O<<O),V=_.canonical.y-(_.canonical.y>>O<<O),H=l.X>>O;l.aQ(E.posMatrix,0,H,0,H,0,1),l.J(E.posMatrix,E.posMatrix,[-z*H,-V*H,0]),d[v]=E}else if(o.canonical.isChildOf(_.canonical)){const E=o.clone();E.posMatrix=new Float64Array(16);const O=o.canonical.z-_.canonical.z,z=o.canonical.x-(o.canonical.x>>O<<O),V=o.canonical.y-(o.canonical.y>>O<<O),H=l.X>>O;l.aQ(E.posMatrix,0,l.X,0,l.X,0,1),l.J(E.posMatrix,E.posMatrix,[z*H,V*H,0]),l.K(E.posMatrix,E.posMatrix,[1/2**O,1/2**O,0]),d[v]=E}}return d}getSourceTile(o,d){const v=this.sourceCache._source;let _=o.overscaledZ-this.deltaZoom;if(_>v.maxzoom&&(_=v.maxzoom),_<v.minzoom)return null;this._sourceTileCache[o.key]||(this._sourceTileCache[o.key]=o.scaledTo(_).key);let E=this.sourceCache.getTileByID(this._sourceTileCache[o.key]);if((!E||!E.dem)&&d)for(;_>=v.minzoom&&(!E||!E.dem);)E=this.sourceCache.getTileByID(o.scaledTo(_--).key);return E}tilesAfterTime(o=Date.now()){return Object.values(this._tiles).filter(d=>d.timeAdded>=o)}}class u0{constructor(o,d,v){this.painter=o,this.sourceCache=new dm(d),this.options=v,this.exaggeration=typeof v.exaggeration=="number"?v.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(o,d,v,_=l.X){var E;if(!(d>=0&&d<_&&v>=0&&v<_))return 0;const O=this.getTerrainData(o),z=(E=O.tile)===null||E===void 0?void 0:E.dem;if(!z)return 0;const V=function(be,Pe,Te){var ke=Pe[0],Ve=Pe[1];return be[0]=Te[0]*ke+Te[4]*Ve+Te[12],be[1]=Te[1]*ke+Te[5]*Ve+Te[13],be}([],[d/_*l.X,v/_*l.X],O.u_terrain_matrix),H=[V[0]*z.dim,V[1]*z.dim],J=Math.floor(H[0]),Q=Math.floor(H[1]),ce=H[0]-J,fe=H[1]-Q;return z.get(J,Q)*(1-ce)*(1-fe)+z.get(J+1,Q)*ce*(1-fe)+z.get(J,Q+1)*(1-ce)*fe+z.get(J+1,Q+1)*ce*fe}getElevationForLngLatZoom(o,d){const{tileID:v,mercatorX:_,mercatorY:E}=this._getOverscaledTileIDFromLngLatZoom(o,d);return this.getElevation(v,_%l.X,E%l.X,l.X)}getElevation(o,d,v,_=l.X){return this.getDEMElevation(o,d,v,_)*this.exaggeration}getTerrainData(o){if(!this._emptyDemTexture){const _=this.painter.context,E=new l.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new se(_,E,_.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new se(_,new l.R({width:1,height:1}),_.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(_.gl.NEAREST,_.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=l.ao([])}const d=this.sourceCache.getSourceTile(o,!0);if(d&&d.dem&&(!d.demTexture||d.needsTerrainPrepare)){const _=this.painter.context;d.demTexture=this.painter.getTileTexture(d.dem.stride),d.demTexture?d.demTexture.update(d.dem.getPixels(),{premultiply:!1}):d.demTexture=new se(_,d.dem.getPixels(),_.gl.RGBA,{premultiply:!1}),d.demTexture.bind(_.gl.NEAREST,_.gl.CLAMP_TO_EDGE),d.needsTerrainPrepare=!1}const v=d&&d+d.tileID.key+o.key;if(v&&!this._demMatrixCache[v]){const _=this.sourceCache.sourceCache._source.maxzoom;let E=o.canonical.z-d.tileID.canonical.z;o.overscaledZ>o.canonical.z&&(o.canonical.z>=_?E=o.canonical.z-_:l.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const O=o.canonical.x-(o.canonical.x>>E<<E),z=o.canonical.y-(o.canonical.y>>E<<E),V=l.bb(new Float64Array(16),[1/(l.X<<E),1/(l.X<<E),0]);l.J(V,V,[O*l.X,z*l.X,0]),this._demMatrixCache[o.key]={matrix:V,coord:o}}return{u_depth:2,u_terrain:3,u_terrain_dim:d&&d.dem&&d.dem.dim||1,u_terrain_matrix:v?this._demMatrixCache[o.key].matrix:this._emptyDemMatrix,u_terrain_unpack:d&&d.dem&&d.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(d&&d.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:d}}getFramebuffer(o){const d=this.painter,v=d.width/devicePixelRatio,_=d.height/devicePixelRatio;return!this._fbo||this._fbo.width===v&&this._fbo.height===_||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new se(d.context,{width:v,height:_,data:null},d.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(d.context.gl.NEAREST,d.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new se(d.context,{width:v,height:_,data:null},d.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(d.context.gl.NEAREST,d.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=d.context.createFramebuffer(v,_,!0,!1),this._fbo.depthAttachment.set(d.context.createRenderbuffer(d.context.gl.DEPTH_COMPONENT16,v,_))),this._fbo.colorAttachment.set(o==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const o=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const d=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let E=0,O=0;E<this._coordsTextureSize;E++)for(let z=0;z<this._coordsTextureSize;z++,O+=4)d[O+0]=255&z,d[O+1]=255&E,d[O+2]=z>>8<<4|E>>8,d[O+3]=0;const v=new l.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(d.buffer)),_=new se(o,v,o.gl.RGBA,{premultiply:!1});return _.bind(o.gl.NEAREST,o.gl.CLAMP_TO_EDGE),this._coordsTexture=_,_}pointCoordinate(o){this.painter.maybeDrawDepthAndCoords(!0);const d=new Uint8Array(4),v=this.painter.context,_=v.gl,E=Math.round(o.x*this.painter.pixelRatio/devicePixelRatio),O=Math.round(o.y*this.painter.pixelRatio/devicePixelRatio),z=Math.round(this.painter.height/devicePixelRatio);v.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),_.readPixels(E,z-O-1,1,1,_.RGBA,_.UNSIGNED_BYTE,d),v.bindFramebuffer.set(null);const V=d[0]+(d[2]>>4<<8),H=d[1]+((15&d[2])<<8),J=this.coordsIndex[255-d[3]],Q=J&&this.sourceCache.getTileByID(J);if(!Q)return null;const ce=this._coordsTextureSize,fe=(1<<Q.tileID.canonical.z)*ce;return new l.Z((Q.tileID.canonical.x*ce+V)/fe+Q.tileID.wrap,(Q.tileID.canonical.y*ce+H)/fe,this.getElevation(Q.tileID,V,H,ce))}depthAtPoint(o){const d=new Uint8Array(4),v=this.painter.context,_=v.gl;return v.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),_.readPixels(o.x,this.painter.height/devicePixelRatio-o.y-1,1,1,_.RGBA,_.UNSIGNED_BYTE,d),v.bindFramebuffer.set(null),(d[0]/16777216+d[1]/65536+d[2]/256+d[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;const o=this.painter.context,d=new l.bc,v=new l.aY,_=this.meshSize,E=l.X/_,O=_*_;for(let Q=0;Q<=_;Q++)for(let ce=0;ce<=_;ce++)d.emplaceBack(ce*E,Q*E,0);for(let Q=0;Q<O;Q+=_+1)for(let ce=0;ce<_;ce++)v.emplaceBack(ce+Q,_+ce+Q+1,_+ce+Q+2),v.emplaceBack(ce+Q,_+ce+Q+2,ce+Q+1);const z=d.length,V=z+2*(_+1);for(const Q of[0,1])for(let ce=0;ce<=_;ce++)for(const fe of[0,1])d.emplaceBack(ce*E,Q*l.X,fe);for(let Q=0;Q<2*_;Q+=2)v.emplaceBack(V+Q,V+Q+1,V+Q+3),v.emplaceBack(V+Q,V+Q+3,V+Q+2),v.emplaceBack(z+Q,z+Q+3,z+Q+1),v.emplaceBack(z+Q,z+Q+2,z+Q+3);const H=d.length,J=H+2*(_+1);for(const Q of[0,1])for(let ce=0;ce<=_;ce++)for(const fe of[0,1])d.emplaceBack(Q*l.X,ce*E,fe);for(let Q=0;Q<2*_;Q+=2)v.emplaceBack(H+Q,H+Q+1,H+Q+3),v.emplaceBack(H+Q,H+Q+3,H+Q+2),v.emplaceBack(J+Q,J+Q+3,J+Q+1),v.emplaceBack(J+Q,J+Q+2,J+Q+3);return this._mesh=new o0(o.createVertexBuffer(d,c0.members),o.createIndexBuffer(v),l.a0.simpleSegment(0,0,d.length,v.length)),this._mesh}getMeshFrameDelta(o){return 2*Math.PI*l.bd/Math.pow(2,o)/5}getMinTileElevationForLngLatZoom(o,d){var v;const{tileID:_}=this._getOverscaledTileIDFromLngLatZoom(o,d);return(v=this.getMinMaxElevation(_).minElevation)!==null&&v!==void 0?v:0}getMinMaxElevation(o){const d=this.getTerrainData(o).tile,v={minElevation:null,maxElevation:null};return d&&d.dem&&(v.minElevation=d.dem.min*this.exaggeration,v.maxElevation=d.dem.max*this.exaggeration),v}_getOverscaledTileIDFromLngLatZoom(o,d){const v=l.Z.fromLngLat(o.wrap()),_=(1<<d)*l.X,E=v.x*_,O=v.y*_,z=Math.floor(E/l.X),V=Math.floor(O/l.X);return{tileID:new l.S(d,0,d,z,V),mercatorX:E,mercatorY:O}}}class Gl{constructor(o,d,v){this._context=o,this._size=d,this._tileSize=v,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const o of this._objects)o.texture.destroy(),o.fbo.destroy()}_createObject(o){const d=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),v=new se(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return v.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),d.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),d.colorAttachment.set(v.texture),{id:o,fbo:d,texture:v,stamp:-1,inUse:!1}}getObjectForId(o){return this._objects[o]}useObject(o){o.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(d=>o.id!==d),this._recentlyUsed.push(o.id)}stampObject(o){o.stamp=++this._stamp}getOrCreateFreeObject(){for(const d of this._recentlyUsed)if(!this._objects[d].inUse)return this._objects[d];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const o=this._createObject(this._objects.length);return this._objects.push(o),o}freeObject(o){o.inUse=!1}freeAllObjects(){for(const o of this._objects)this.freeObject(o)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(o=>!o.inUse)===!1}}const Ks={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class fm{constructor(o,d){this.painter=o,this.terrain=d,this.pool=new Gl(o.context,30,d.sourceCache.tileSize*d.qualityFactor)}destruct(){this.pool.destruct()}getTexture(o){return this.pool.getObjectForId(o.rtt[this._stacks.length-1].id).texture}prepareForRender(o,d){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=o._order.filter(v=>!o._layers[v].isHidden(d)),this._coordsDescendingInv={};for(const v in o.sourceCaches){this._coordsDescendingInv[v]={};const _=o.sourceCaches[v].getVisibleCoordinates();for(const E of _){const O=this.terrain.sourceCache.getTerrainCoords(E);for(const z in O)this._coordsDescendingInv[v][z]||(this._coordsDescendingInv[v][z]=[]),this._coordsDescendingInv[v][z].push(O[z])}}this._coordsDescendingInvStr={};for(const v of o._order){const _=o._layers[v],E=_.source;if(Ks[_.type]&&!this._coordsDescendingInvStr[E]){this._coordsDescendingInvStr[E]={};for(const O in this._coordsDescendingInv[E])this._coordsDescendingInvStr[E][O]=this._coordsDescendingInv[E][O].map(z=>z.key).sort().join()}}for(const v of this._renderableTiles)for(const _ in this._coordsDescendingInvStr){const E=this._coordsDescendingInvStr[_][v.tileID.key];E&&E!==v.rttCoords[_]&&(v.rtt=[])}}renderLayer(o){if(o.isHidden(this.painter.transform.zoom))return!1;const d=o.type,v=this.painter,_=this._renderableLayerIds[this._renderableLayerIds.length-1]===o.id;if(Ks[d]&&(this._prevType&&Ks[this._prevType]||this._stacks.push([]),this._prevType=d,this._stacks[this._stacks.length-1].push(o.id),!_))return!0;if(Ks[this._prevType]||Ks[d]&&_){this._prevType=d;const E=this._stacks.length-1,O=this._stacks[E]||[];for(const z of this._renderableTiles){if(this.pool.isFull()&&(Dh(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(z),z.rtt[E]){const H=this.pool.getObjectForId(z.rtt[E].id);if(H.stamp===z.rtt[E].stamp){this.pool.useObject(H);continue}}const V=this.pool.getOrCreateFreeObject();this.pool.useObject(V),this.pool.stampObject(V),z.rtt[E]={id:V.id,stamp:V.stamp},v.context.bindFramebuffer.set(V.fbo.framebuffer),v.context.clear({color:l.aN.transparent,stencil:0}),v.currentStencilSource=void 0;for(let H=0;H<O.length;H++){const J=v.style._layers[O[H]],Q=J.source?this._coordsDescendingInv[J.source][z.tileID.key]:[z.tileID];v.context.viewport.set([0,0,V.fbo.width,V.fbo.height]),v._renderTileClippingMasks(J,Q),v.renderLayer(v,v.style.sourceCaches[J.source],J,Q),J.source&&(z.rttCoords[J.source]=this._coordsDescendingInvStr[J.source][z.tileID.key])}}return Dh(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),Ks[d]}return!1}}const oe={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Wl=f,bf={hash:!1,interactive:!0,bearingSnap:7,attributionControl:Mu,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,refreshExpiredTiles:!0,scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],zoom:0,bearing:0,pitch:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:l.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0},vo=M=>{M.touchstart=M.dragStart,M.touchmoveWindow=M.dragMove,M.touchend=M.dragEnd},fi={showCompass:!0,showZoom:!0,visualizePitch:!1};class h0{constructor(o,d,v=!1){this.mousedown=O=>{this.startMouse(l.e({},O,{ctrlKey:!0,preventDefault:()=>O.preventDefault()}),b.mousePos(this.element,O)),b.addEventListener(window,"mousemove",this.mousemove),b.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=O=>{this.moveMouse(O,b.mousePos(this.element,O))},this.mouseup=O=>{this.mouseRotate.dragEnd(O),this.mousePitch&&this.mousePitch.dragEnd(O),this.offTemp()},this.touchstart=O=>{O.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=b.touchPos(this.element,O.targetTouches)[0],this.startTouch(O,this._startPos),b.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),b.addEventListener(window,"touchend",this.touchend))},this.touchmove=O=>{O.targetTouches.length!==1?this.reset():(this._lastPos=b.touchPos(this.element,O.targetTouches)[0],this.moveTouch(O,this._lastPos))},this.touchend=O=>{O.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const _=o.dragRotate._mouseRotate.getClickTolerance(),E=o.dragRotate._mousePitch.getClickTolerance();this.element=d,this.mouseRotate=_f({clickTolerance:_,enable:!0}),this.touchRotate=(({enable:O,clickTolerance:z,bearingDegreesPerPixelMoved:V=.8})=>{const H=new Dc;return new Ti({clickTolerance:z,move:(J,Q)=>({bearingDelta:(Q.x-J.x)*V}),moveStateManager:H,enable:O,assignEvents:vo})})({clickTolerance:_,enable:!0}),this.map=o,v&&(this.mousePitch=Ea({clickTolerance:E,enable:!0}),this.touchPitch=(({enable:O,clickTolerance:z,pitchDegreesPerPixelMoved:V=-.5})=>{const H=new Dc;return new Ti({clickTolerance:z,move:(J,Q)=>({pitchDelta:(Q.y-J.y)*V}),moveStateManager:H,enable:O,assignEvents:vo})})({clickTolerance:E,enable:!0})),b.addEventListener(d,"mousedown",this.mousedown),b.addEventListener(d,"touchstart",this.touchstart,{passive:!1}),b.addEventListener(d,"touchcancel",this.reset)}startMouse(o,d){this.mouseRotate.dragStart(o,d),this.mousePitch&&this.mousePitch.dragStart(o,d),b.disableDrag()}startTouch(o,d){this.touchRotate.dragStart(o,d),this.touchPitch&&this.touchPitch.dragStart(o,d),b.disableDrag()}moveMouse(o,d){const v=this.map,{bearingDelta:_}=this.mouseRotate.dragMove(o,d)||{};if(_&&v.setBearing(v.getBearing()+_),this.mousePitch){const{pitchDelta:E}=this.mousePitch.dragMove(o,d)||{};E&&v.setPitch(v.getPitch()+E)}}moveTouch(o,d){const v=this.map,{bearingDelta:_}=this.touchRotate.dragMove(o,d)||{};if(_&&v.setBearing(v.getBearing()+_),this.touchPitch){const{pitchDelta:E}=this.touchPitch.dragMove(o,d)||{};E&&v.setPitch(v.getPitch()+E)}}off(){const o=this.element;b.removeEventListener(o,"mousedown",this.mousedown),b.removeEventListener(o,"touchstart",this.touchstart,{passive:!1}),b.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),b.removeEventListener(window,"touchend",this.touchend),b.removeEventListener(o,"touchcancel",this.reset),this.offTemp()}offTemp(){b.enableDrag(),b.removeEventListener(window,"mousemove",this.mousemove),b.removeEventListener(window,"mouseup",this.mouseup),b.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),b.removeEventListener(window,"touchend",this.touchend)}}let jl;function d0(M,o,d){const v=new l.N(M.lng,M.lat);if(M=new l.N(M.lng,M.lat),o){const _=new l.N(M.lng-360,M.lat),E=new l.N(M.lng+360,M.lat),O=d.locationPoint(M).distSqr(o);d.locationPoint(_).distSqr(o)<O?M=_:d.locationPoint(E).distSqr(o)<O&&(M=E)}for(;Math.abs(M.lng-d.center.lng)>180;){const _=d.locationPoint(M);if(_.x>=0&&_.y>=0&&_.x<=d.width&&_.y<=d.height)break;M.lng>d.center.lng?M.lng-=360:M.lng+=360}return M.lng!==v.lng&&d.locationPoint(M).y>d.height/2-d.getHorizon()?M:v}const ul={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function ql(M,o,d){const v=M.classList;for(const _ in ul)v.remove(`maplibregl-${d}-anchor-${_}`);v.add(`maplibregl-${d}-anchor-${o}`)}class tr extends l.E{constructor(o){if(super(),this._onKeyPress=d=>{const v=d.code,_=d.charCode||d.keyCode;v!=="Space"&&v!=="Enter"&&_!==32&&_!==13||this.togglePopup()},this._onMapClick=d=>{const v=d.originalEvent.target,_=this._element;this._popup&&(v===_||_.contains(v))&&this.togglePopup()},this._update=d=>{var v;if(!this._map)return;const _=this._map.loaded()&&!this._map.isMoving();((d==null?void 0:d.type)==="terrain"||(d==null?void 0:d.type)==="render"&&!_)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?d0(this._lngLat,this._flatPos,this._map.transform):(v=this._lngLat)===null||v===void 0?void 0:v.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let E="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?E=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(E=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let O="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?O="rotateX(0deg)":this._pitchAlignment==="map"&&(O=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||d&&d.type!=="moveend"||(this._pos=this._pos.round()),b.setTransform(this._element,`${ul[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${O} ${E}`),S.frameAsync(new AbortController).then(()=>{this._updateOpacity(d&&d.type==="moveend")}).catch(()=>{})},this._onMove=d=>{if(!this._isDragging){const v=this._clickTolerance||this._map._clickTolerance;this._isDragging=d.point.dist(this._pointerdownPos)>=v}this._isDragging&&(this._pos=d.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new l.k("dragstart"))),this.fire(new l.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new l.k("dragend")),this._state="inactive"},this._addDragHandler=d=>{this._element.contains(d.originalEvent.target)&&(d.preventDefault(),this._positionDelta=d.point.sub(this._pos).add(this._offset),this._pointerdownPos=d.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._subpixelPositioning=o&&o.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&o.pitchAlignment!=="auto"?o.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(o==null?void 0:o.opacity,o==null?void 0:o.opacityWhenCovered),o&&o.element)this._element=o.element,this._offset=l.P.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=b.create("div");const d=b.createNS("http://www.w3.org/2000/svg","svg"),v=41,_=27;d.setAttributeNS(null,"display","block"),d.setAttributeNS(null,"height",`${v}px`),d.setAttributeNS(null,"width",`${_}px`),d.setAttributeNS(null,"viewBox",`0 0 ${_} ${v}`);const E=b.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"stroke","none"),E.setAttributeNS(null,"stroke-width","1"),E.setAttributeNS(null,"fill","none"),E.setAttributeNS(null,"fill-rule","evenodd");const O=b.createNS("http://www.w3.org/2000/svg","g");O.setAttributeNS(null,"fill-rule","nonzero");const z=b.createNS("http://www.w3.org/2000/svg","g");z.setAttributeNS(null,"transform","translate(3.0, 29.0)"),z.setAttributeNS(null,"fill","#000000");const V=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ke of V){const Ve=b.createNS("http://www.w3.org/2000/svg","ellipse");Ve.setAttributeNS(null,"opacity","0.04"),Ve.setAttributeNS(null,"cx","10.5"),Ve.setAttributeNS(null,"cy","5.80029008"),Ve.setAttributeNS(null,"rx",ke.rx),Ve.setAttributeNS(null,"ry",ke.ry),z.appendChild(Ve)}const H=b.createNS("http://www.w3.org/2000/svg","g");H.setAttributeNS(null,"fill",this._color);const J=b.createNS("http://www.w3.org/2000/svg","path");J.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),H.appendChild(J);const Q=b.createNS("http://www.w3.org/2000/svg","g");Q.setAttributeNS(null,"opacity","0.25"),Q.setAttributeNS(null,"fill","#000000");const ce=b.createNS("http://www.w3.org/2000/svg","path");ce.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Q.appendChild(ce);const fe=b.createNS("http://www.w3.org/2000/svg","g");fe.setAttributeNS(null,"transform","translate(6.0, 7.0)"),fe.setAttributeNS(null,"fill","#FFFFFF");const be=b.createNS("http://www.w3.org/2000/svg","g");be.setAttributeNS(null,"transform","translate(8.0, 8.0)");const Pe=b.createNS("http://www.w3.org/2000/svg","circle");Pe.setAttributeNS(null,"fill","#000000"),Pe.setAttributeNS(null,"opacity","0.25"),Pe.setAttributeNS(null,"cx","5.5"),Pe.setAttributeNS(null,"cy","5.5"),Pe.setAttributeNS(null,"r","5.4999962");const Te=b.createNS("http://www.w3.org/2000/svg","circle");Te.setAttributeNS(null,"fill","#FFFFFF"),Te.setAttributeNS(null,"cx","5.5"),Te.setAttributeNS(null,"cy","5.5"),Te.setAttributeNS(null,"r","5.4999962"),be.appendChild(Pe),be.appendChild(Te),O.appendChild(z),O.appendChild(H),O.appendChild(Q),O.appendChild(fe),O.appendChild(be),d.appendChild(O),d.setAttributeNS(null,"height",v*this._scale+"px"),d.setAttributeNS(null,"width",_*this._scale+"px"),this._element.appendChild(d),this._offset=l.P.convert(o&&o.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",d=>{d.preventDefault()}),this._element.addEventListener("mousedown",d=>{d.preventDefault()}),ql(this._element,this._anchor,"marker"),o&&o.className)for(const d of o.className.split(" "))this._element.classList.add(d);this._popup=null}addTo(o){return this.remove(),this._map=o,this._element.setAttribute("aria-label",o._getUIString("Marker.Title")),o.getCanvasContainer().appendChild(this._element),o.on("move",this._update),o.on("moveend",this._update),o.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),b.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(o){return this._lngLat=l.N.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){const _=Math.abs(13.5)/Math.SQRT2;o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[_,-1*(38.1-13.5+_)],"bottom-right":[-_,-1*(38.1-13.5+_)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=o,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(o){return this._subpixelPositioning=o,this}getPopup(){return this._popup}togglePopup(){const o=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:o?(o.isOpen()?o.remove():(o.setLngLat(this._lngLat),o.addTo(this._map)),this):this}_updateOpacity(o=!1){var d,v;if(!(!((d=this._map)===null||d===void 0)&&d.terrain))return void(this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity));if(o)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const _=this._map,E=_.terrain.depthAtPoint(this._pos),O=_.terrain.getElevationForLngLatZoom(this._lngLat,_.transform.tileZoom);if(_.transform.lngLatToCameraDepth(this._lngLat,O)-E<.006)return void(this._element.style.opacity=this._opacity);const z=-this._offset.y/_.transform._pixelPerMeter,V=Math.sin(_.getPitch()*Math.PI/180)*z,H=_.terrain.depthAtPoint(new l.P(this._pos.x,this._pos.y-this._offset.y)),J=_.transform.lngLatToCameraDepth(this._lngLat,O+V)-H>.006;!((v=this._popup)===null||v===void 0)&&v.isOpen()&&J&&this._popup.remove(),this._element.style.opacity=J?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(o){return this._offset=l.P.convert(o),this._update(),this}addClassName(o){this._element.classList.add(o)}removeClassName(o){this._element.classList.remove(o)}toggleClassName(o){return this._element.classList.toggle(o)}setDraggable(o){return this._draggable=!!o,this._map&&(o?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(o){return this._rotation=o||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(o){return this._rotationAlignment=o||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(o){return this._pitchAlignment=o&&o!=="auto"?o:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(o,d){return o===void 0&&d===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),o!==void 0&&(this._opacity=o),d!==void 0&&(this._opacityWhenCovered=d),this._map&&this._updateOpacity(!0),this}}const wf={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Cu=0,Tu=!1;const Ca={maxWidth:100,unit:"metric"};function pm(M,o,d){const v=d&&d.maxWidth||100,_=M._container.clientHeight/2,E=M.unproject([0,_]),O=M.unproject([v,_]),z=E.distanceTo(O);if(d&&d.unit==="imperial"){const V=3.2808*z;V>5280?Nh(o,v,V/5280,M._getUIString("ScaleControl.Miles")):Nh(o,v,V,M._getUIString("ScaleControl.Feet"))}else d&&d.unit==="nautical"?Nh(o,v,z/1852,M._getUIString("ScaleControl.NauticalMiles")):z>=1e3?Nh(o,v,z/1e3,M._getUIString("ScaleControl.Kilometers")):Nh(o,v,z,M._getUIString("ScaleControl.Meters"))}function Nh(M,o,d,v){const _=function(E){const O=Math.pow(10,`${Math.floor(E)}`.length-1);let z=E/O;return z=z>=10?10:z>=5?5:z>=3?3:z>=2?2:z>=1?1:function(V){const H=Math.pow(10,Math.ceil(-Math.log(V)/Math.LN10));return Math.round(V*H)/H}(z),O*z}(d);M.style.width=o*(_/d)+"px",M.innerHTML=`${_}&nbsp;${v}`}const Ta={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},Sf=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Tn(M){if(M){if(typeof M=="number"){const o=Math.round(Math.abs(M)/Math.SQRT2);return{center:new l.P(0,0),top:new l.P(0,M),"top-left":new l.P(o,o),"top-right":new l.P(-o,o),bottom:new l.P(0,-M),"bottom-left":new l.P(o,-o),"bottom-right":new l.P(-o,-o),left:new l.P(M,0),right:new l.P(-M,0)}}if(M instanceof l.P||Array.isArray(M)){const o=l.P.convert(M);return{center:o,top:o,"top-left":o,"top-right":o,bottom:o,"bottom-left":o,"bottom-right":o,left:o,right:o}}return{center:l.P.convert(M.center||[0,0]),top:l.P.convert(M.top||[0,0]),"top-left":l.P.convert(M["top-left"]||[0,0]),"top-right":l.P.convert(M["top-right"]||[0,0]),bottom:l.P.convert(M.bottom||[0,0]),"bottom-left":l.P.convert(M["bottom-left"]||[0,0]),"bottom-right":l.P.convert(M["bottom-right"]||[0,0]),left:l.P.convert(M.left||[0,0]),right:l.P.convert(M.right||[0,0])}}return Tn(new l.P(0,0))}const An=f;u.AJAXError=l.bg,u.Evented=l.E,u.LngLat=l.N,u.MercatorCoordinate=l.Z,u.Point=l.P,u.addProtocol=l.bh,u.config=l.a,u.removeProtocol=l.bi,u.AttributionControl=ra,u.BoxZoomHandler=_u,u.CanvasSource=ft,u.CooperativeGesturesHandler=mo,u.DoubleClickZoomHandler=Ir,u.DragPanHandler=Oo,u.DragRotateHandler=Fo,u.EdgeInsets=et,u.FullscreenControl=class extends l.E{constructor(M={}){super(),this._onFullscreenChange=()=>{var o;let d=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((o=d==null?void 0:d.shadowRoot)===null||o===void 0)&&o.fullscreenElement;)d=d.shadowRoot.fullscreenElement;d===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,M&&M.container&&(M.container instanceof HTMLElement?this._container=M.container:l.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(M){return this._map=M,this._container||(this._container=this._map.getContainer()),this._controlContainer=b.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){b.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const M=this._fullscreenButton=b.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);b.create("span","maplibregl-ctrl-icon",M).setAttribute("aria-hidden","true"),M.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const M=this._getTitle();this._fullscreenButton.setAttribute("aria-label",M),this._fullscreenButton.title=M}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new l.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new l.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},u.GeoJSONSource=re,u.GeolocateControl=class extends l.E{constructor(M){super(),this._onSuccess=o=>{if(this._map){if(this._isOutOfMapMaxBounds(o))return this._setErrorState(),this.fire(new l.k("outofmaxbounds",o)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=o,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(o),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(o),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new l.k("geolocate",o)),this._finish()}},this._updateCamera=o=>{const d=new l.N(o.coords.longitude,o.coords.latitude),v=o.coords.accuracy,_=this._map.getBearing(),E=l.e({bearing:_},this.options.fitBoundsOptions),O=Ue.fromLngLat(d,v);this._map.fitBounds(O,E,{geolocateSource:!0})},this._updateMarker=o=>{if(o){const d=new l.N(o.coords.longitude,o.coords.latitude);this._accuracyCircleMarker.setLngLat(d).addTo(this._map),this._userLocationDotMarker.setLngLat(d).addTo(this._map),this._accuracy=o.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=o=>{if(this._map){if(this.options.trackUserLocation)if(o.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const d=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=d,this._geolocateButton.setAttribute("aria-label",d),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(o.code===3&&Tu)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new l.k("error",o)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",o=>o.preventDefault()),this._geolocateButton=b.create("button","maplibregl-ctrl-geolocate",this._container),b.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=o=>{if(this._map){if(o===!1){l.w("Geolocation support is not available so the GeolocateControl will be disabled.");const d=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=d,this._geolocateButton.setAttribute("aria-label",d)}else{const d=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=d,this._geolocateButton.setAttribute("aria-label",d)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=b.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new tr({element:this._dotElement}),this._circleElement=b.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new tr({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",d=>{d.geolocateSource||this._watchState!=="ACTIVE_LOCK"||d.originalEvent&&d.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new l.k("trackuserlocationend")),this.fire(new l.k("userlocationlostfocus")))})}},this.options=l.e({},wf,M)}onAdd(M){return this._map=M,this._container=b.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return l._(this,arguments,void 0,function*(o=!1){if(jl!==void 0&&!o)return jl;if(window.navigator.permissions===void 0)return jl=!!window.navigator.geolocation,jl;try{jl=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{jl=!!window.navigator.geolocation}return jl})}().then(o=>this._finishSetupUI(o)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),b.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Cu=0,Tu=!1}_isOutOfMapMaxBounds(M){const o=this._map.getMaxBounds(),d=M.coords;return o&&(d.longitude<o.getWest()||d.longitude>o.getEast()||d.latitude<o.getSouth()||d.latitude>o.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const M=this._map.getBounds(),o=M.getSouthEast(),d=M.getNorthEast(),v=o.distanceTo(d),_=Math.ceil(this._accuracy/(v/this._map._container.clientHeight)*2);this._circleElement.style.width=`${_}px`,this._circleElement.style.height=`${_}px`}trigger(){if(!this._setup)return l.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new l.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Cu--,Tu=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new l.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new l.k("trackuserlocationstart")),this.fire(new l.k("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let M;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Cu++,Cu>1?(M={maximumAge:6e5,timeout:0},Tu=!0):(M=this.options.positionOptions,Tu=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,M)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},u.Hash=Qn,u.ImageSource=Ge,u.KeyboardHandler=om,u.LngLatBounds=Ue,u.LogoControl=Ma,u.Map=class extends zh{constructor(M){l.be.mark(l.bf.create);const o=Object.assign(Object.assign({},bf),M);if(o.minZoom!=null&&o.maxZoom!=null&&o.minZoom>o.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(o.minPitch!=null&&o.maxPitch!=null&&o.minPitch>o.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(o.minPitch!=null&&o.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(o.maxPitch!=null&&o.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new gt(o.minZoom,o.maxZoom,o.minPitch,o.maxPitch,o.renderWorldCopies),{bearingSnap:o.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new dn,this._controls=[],this._mapId=l.a4(),this._contextLost=d=>{d.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new l.k("webglcontextlost",{originalEvent:d}))},this._contextRestored=d=>{this._setupPainter(),this.resize(),this._update(),this.fire(new l.k("webglcontextrestored",{originalEvent:d}))},this._onMapScroll=d=>{if(d.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=o.interactive,this._maxTileCacheSize=o.maxTileCacheSize,this._maxTileCacheZoomLevels=o.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=o.failIfMajorPerformanceCaveat===!0,this._preserveDrawingBuffer=o.preserveDrawingBuffer===!0,this._antialias=o.antialias===!0,this._trackResize=o.trackResize===!0,this._bearingSnap=o.bearingSnap,this._refreshExpiredTiles=o.refreshExpiredTiles===!0,this._fadeDuration=o.fadeDuration,this._crossSourceCollisions=o.crossSourceCollisions===!0,this._collectResourceTiming=o.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},oe),o.locale),this._clickTolerance=o.clickTolerance,this._overridePixelRatio=o.pixelRatio,this._maxCanvasSize=o.maxCanvasSize,this.transformCameraUpdate=o.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=o.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=B.addThrottleControl(()=>this.isMoving()),this._requestManager=new $(o.transformRequest),typeof o.container=="string"){if(this._container=document.getElementById(o.container),!this._container)throw new Error(`Container '${o.container}' not found.`)}else{if(!(o.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=o.container}if(o.maxBounds&&this.setMaxBounds(o.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)).on("moveend",()=>this._update(!1)).on("zoom",()=>this._update(!0)).on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}).once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let d=!1;const v=_n(_=>{this._trackResize&&!this._removed&&this.resize(_)._update()},50);this._resizeObserver=new ResizeObserver(_=>{d?v(_):d=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Fh(this,o),this._hash=o.hash&&new Qn(typeof o.hash=="string"&&o.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:o.center,zoom:o.zoom,bearing:o.bearing,pitch:o.pitch}),o.bounds&&(this.resize(),this.fitBounds(o.bounds,l.e({},o.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=o.localIdeographFontFamily,this._validateStyle=o.validateStyle,o.style&&this.setStyle(o.style,{localIdeographFontFamily:o.localIdeographFontFamily}),o.attributionControl&&this.addControl(new ra(typeof o.attributionControl=="boolean"?void 0:o.attributionControl)),o.maplibreLogo&&this.addControl(new Ma,o.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",d=>{this._update(d.dataType==="style"),this.fire(new l.k(`${d.dataType}data`,d))}),this.on("dataloading",d=>{this.fire(new l.k(`${d.dataType}dataloading`,d))}),this.on("dataabort",d=>{this.fire(new l.k("sourcedataabort",d))})}_getMapId(){return this._mapId}addControl(M,o){if(o===void 0&&(o=M.getDefaultPosition?M.getDefaultPosition():"top-right"),!M||!M.onAdd)return this.fire(new l.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const d=M.onAdd(this);this._controls.push(M);const v=this._controlPositions[o];return o.indexOf("bottom")!==-1?v.insertBefore(d,v.firstChild):v.appendChild(d),this}removeControl(M){if(!M||!M.onRemove)return this.fire(new l.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const o=this._controls.indexOf(M);return o>-1&&this._controls.splice(o,1),M.onRemove(this),this}hasControl(M){return this._controls.indexOf(M)>-1}calculateCameraOptionsFromTo(M,o,d,v){return v==null&&this.terrain&&(v=this.terrain.getElevationForLngLatZoom(d,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(M,o,d,v)}resize(M){var o;const d=this._containerDimensions(),v=d[0],_=d[1],E=this._getClampedPixelRatio(v,_);if(this._resizeCanvas(v,_,E),this.painter.resize(v,_,E),this.painter.overLimit()){const z=this.painter.context.gl;this._maxCanvasSize=[z.drawingBufferWidth,z.drawingBufferHeight];const V=this._getClampedPixelRatio(v,_);this._resizeCanvas(v,_,V),this.painter.resize(v,_,V)}this.transform.resize(v,_),(o=this._requestedCameraState)===null||o===void 0||o.resize(v,_);const O=!this._moving;return O&&(this.stop(),this.fire(new l.k("movestart",M)).fire(new l.k("move",M))),this.fire(new l.k("resize",M)),O&&this.fire(new l.k("moveend",M)),this}_getClampedPixelRatio(M,o){const{0:d,1:v}=this._maxCanvasSize,_=this.getPixelRatio(),E=M*_,O=o*_;return Math.min(E>d?d/E:1,O>v?v/O:1)*_}getPixelRatio(){var M;return(M=this._overridePixelRatio)!==null&&M!==void 0?M:devicePixelRatio}setPixelRatio(M){this._overridePixelRatio=M,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(M){return this.transform.setMaxBounds(Ue.convert(M)),this._update()}setMinZoom(M){if((M=M??-2)>=-2&&M<=this.transform.maxZoom)return this.transform.minZoom=M,this._update(),this.getZoom()<M&&this.setZoom(M),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(M){if((M=M??22)>=this.transform.minZoom)return this.transform.maxZoom=M,this._update(),this.getZoom()>M&&this.setZoom(M),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(M){if((M=M??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(M>=0&&M<=this.transform.maxPitch)return this.transform.minPitch=M,this._update(),this.getPitch()<M&&this.setPitch(M),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(M){if((M=M??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(M>=this.transform.minPitch)return this.transform.maxPitch=M,this._update(),this.getPitch()>M&&this.setPitch(M),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(M){return this.transform.renderWorldCopies=M,this._update()}project(M){return this.transform.locationPoint(l.N.convert(M),this.style&&this.terrain)}unproject(M){return this.transform.pointLocation(l.P.convert(M),this.terrain)}isMoving(){var M;return this._moving||((M=this.handlers)===null||M===void 0?void 0:M.isMoving())}isZooming(){var M;return this._zooming||((M=this.handlers)===null||M===void 0?void 0:M.isZooming())}isRotating(){var M;return this._rotating||((M=this.handlers)===null||M===void 0?void 0:M.isRotating())}_createDelegatedListener(M,o,d){if(M==="mouseenter"||M==="mouseover"){let v=!1;return{layer:o,listener:d,delegates:{mousemove:E=>{const O=this.getLayer(o)?this.queryRenderedFeatures(E.point,{layers:[o]}):[];O.length?v||(v=!0,d.call(this,new Nr(M,this,E.originalEvent,{features:O}))):v=!1},mouseout:()=>{v=!1}}}}if(M==="mouseleave"||M==="mouseout"){let v=!1;return{layer:o,listener:d,delegates:{mousemove:O=>{(this.getLayer(o)?this.queryRenderedFeatures(O.point,{layers:[o]}):[]).length?v=!0:v&&(v=!1,d.call(this,new Nr(M,this,O.originalEvent)))},mouseout:O=>{v&&(v=!1,d.call(this,new Nr(M,this,O.originalEvent)))}}}}{const v=_=>{const E=this.getLayer(o)?this.queryRenderedFeatures(_.point,{layers:[o]}):[];E.length&&(_.features=E,d.call(this,_),delete _.features)};return{layer:o,listener:d,delegates:{[M]:v}}}}on(M,o,d){if(d===void 0)return super.on(M,o);const v=this._createDelegatedListener(M,o,d);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[M]=this._delegatedListeners[M]||[],this._delegatedListeners[M].push(v);for(const _ in v.delegates)this.on(_,v.delegates[_]);return this}once(M,o,d){if(d===void 0)return super.once(M,o);const v=this._createDelegatedListener(M,o,d);for(const _ in v.delegates)this.once(_,v.delegates[_]);return this}off(M,o,d){return d===void 0?super.off(M,o):(this._delegatedListeners&&this._delegatedListeners[M]&&(v=>{const _=this._delegatedListeners[M];for(let E=0;E<_.length;E++){const O=_[E];if(O.layer===o&&O.listener===d){for(const z in O.delegates)this.off(z,O.delegates[z]);return _.splice(E,1),this}}})(),this)}queryRenderedFeatures(M,o){if(!this.style)return[];let d;const v=M instanceof l.P||Array.isArray(M),_=v?M:[[0,0],[this.transform.width,this.transform.height]];if(o=o||(v?{}:M)||{},_ instanceof l.P||typeof _[0]=="number")d=[l.P.convert(_)];else{const E=l.P.convert(_[0]),O=l.P.convert(_[1]);d=[E,new l.P(O.x,E.y),O,new l.P(E.x,O.y),E]}return this.style.queryRenderedFeatures(d,o,this.transform)}querySourceFeatures(M,o){return this.style.querySourceFeatures(M,o)}setStyle(M,o){return(o=l.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},o)).diff!==!1&&o.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&M?(this._diffStyle(M,o),this):(this._localIdeographFontFamily=o.localIdeographFontFamily,this._updateStyle(M,o))}setTransformRequest(M){return this._requestManager.setTransformRequest(M),this}_getUIString(M){const o=this._locale[M];if(o==null)throw new Error(`Missing UI string '${M}'`);return o}_updateStyle(M,o){if(o.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(M,o));const d=this.style&&o.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!M)),M?(this.style=new Ol(this,o||{}),this.style.setEventedParent(this,{style:this.style}),typeof M=="string"?this.style.loadURL(M,o,d):this.style.loadJSON(M,o,d),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Ol(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(M,o){if(typeof M=="string"){const d=this._requestManager.transformRequest(M,"Style");l.h(d,new AbortController).then(v=>{this._updateDiff(v.data,o)}).catch(v=>{v&&this.fire(new l.j(v))})}else typeof M=="object"&&this._updateDiff(M,o)}_updateDiff(M,o){try{this.style.setState(M,o)&&this._update(!0)}catch(d){l.w(`Unable to perform style diff: ${d.message||d.error||d}.  Rebuilding the style from scratch.`),this._updateStyle(M,o)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():l.w("There is no style added to the map.")}addSource(M,o){return this._lazyInitEmptyStyle(),this.style.addSource(M,o),this._update(!0)}isSourceLoaded(M){const o=this.style&&this.style.sourceCaches[M];if(o!==void 0)return o.loaded();this.fire(new l.j(new Error(`There is no source with ID '${M}'`)))}setTerrain(M){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),M){const o=this.style.sourceCaches[M.source];if(!o)throw new Error(`cannot load terrain, because there exists no source with ID: ${M.source}`);this.terrain===null&&o.reload();for(const d in this.style._layers){const v=this.style._layers[d];v.type==="hillshade"&&v.source===M.source&&l.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new u0(this.painter,o,M),this.painter.renderToTexture=new fm(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=d=>{d.dataType==="style"?this.terrain.sourceCache.freeRtt():d.dataType==="source"&&d.tile&&(d.sourceId!==M.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(d.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new l.k("terrain",{terrain:M})),this}getTerrain(){var M,o;return(o=(M=this.terrain)===null||M===void 0?void 0:M.options)!==null&&o!==void 0?o:null}areTilesLoaded(){const M=this.style&&this.style.sourceCaches;for(const o in M){const d=M[o]._tiles;for(const v in d){const _=d[v];if(_.state!=="loaded"&&_.state!=="errored")return!1}}return!0}removeSource(M){return this.style.removeSource(M),this._update(!0)}getSource(M){return this.style.getSource(M)}addImage(M,o,d={}){const{pixelRatio:v=1,sdf:_=!1,stretchX:E,stretchY:O,content:z,textFitWidth:V,textFitHeight:H}=d;if(this._lazyInitEmptyStyle(),!(o instanceof HTMLImageElement||l.b(o))){if(o.width===void 0||o.height===void 0)return this.fire(new l.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:J,height:Q,data:ce}=o,fe=o;return this.style.addImage(M,{data:new l.R({width:J,height:Q},new Uint8Array(ce)),pixelRatio:v,stretchX:E,stretchY:O,content:z,textFitWidth:V,textFitHeight:H,sdf:_,version:0,userImage:fe}),fe.onAdd&&fe.onAdd(this,M),this}}{const{width:J,height:Q,data:ce}=S.getImageData(o);this.style.addImage(M,{data:new l.R({width:J,height:Q},ce),pixelRatio:v,stretchX:E,stretchY:O,content:z,textFitWidth:V,textFitHeight:H,sdf:_,version:0})}}updateImage(M,o){const d=this.style.getImage(M);if(!d)return this.fire(new l.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const v=o instanceof HTMLImageElement||l.b(o)?S.getImageData(o):o,{width:_,height:E,data:O}=v;if(_===void 0||E===void 0)return this.fire(new l.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(_!==d.data.width||E!==d.data.height)return this.fire(new l.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const z=!(o instanceof HTMLImageElement||l.b(o));return d.data.replace(O,z),this.style.updateImage(M,d),this}getImage(M){return this.style.getImage(M)}hasImage(M){return M?!!this.style.getImage(M):(this.fire(new l.j(new Error("Missing required image id"))),!1)}removeImage(M){this.style.removeImage(M)}loadImage(M){return B.getImage(this._requestManager.transformRequest(M,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(M,o){return this._lazyInitEmptyStyle(),this.style.addLayer(M,o),this._update(!0)}moveLayer(M,o){return this.style.moveLayer(M,o),this._update(!0)}removeLayer(M){return this.style.removeLayer(M),this._update(!0)}getLayer(M){return this.style.getLayer(M)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(M,o,d){return this.style.setLayerZoomRange(M,o,d),this._update(!0)}setFilter(M,o,d={}){return this.style.setFilter(M,o,d),this._update(!0)}getFilter(M){return this.style.getFilter(M)}setPaintProperty(M,o,d,v={}){return this.style.setPaintProperty(M,o,d,v),this._update(!0)}getPaintProperty(M,o){return this.style.getPaintProperty(M,o)}setLayoutProperty(M,o,d,v={}){return this.style.setLayoutProperty(M,o,d,v),this._update(!0)}getLayoutProperty(M,o){return this.style.getLayoutProperty(M,o)}setGlyphs(M,o={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(M,o),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(M,o,d={}){return this._lazyInitEmptyStyle(),this.style.addSprite(M,o,d,v=>{v||this._update(!0)}),this}removeSprite(M){return this._lazyInitEmptyStyle(),this.style.removeSprite(M),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(M,o={}){return this._lazyInitEmptyStyle(),this.style.setSprite(M,o,d=>{d||this._update(!0)}),this}setLight(M,o={}){return this._lazyInitEmptyStyle(),this.style.setLight(M,o),this._update(!0)}getLight(){return this.style.getLight()}setSky(M){return this._lazyInitEmptyStyle(),this.style.setSky(M),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(M,o){return this.style.setFeatureState(M,o),this._update()}removeFeatureState(M,o){return this.style.removeFeatureState(M,o),this._update()}getFeatureState(M){return this.style.getFeatureState(M)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let M=0,o=0;return this._container&&(M=this._container.clientWidth||400,o=this._container.clientHeight||300),[M,o]}_setupContainer(){const M=this._container;M.classList.add("maplibregl-map");const o=this._canvasContainer=b.create("div","maplibregl-canvas-container",M);this._interactive&&o.classList.add("maplibregl-interactive"),this._canvas=b.create("canvas","maplibregl-canvas",o),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const d=this._containerDimensions(),v=this._getClampedPixelRatio(d[0],d[1]);this._resizeCanvas(d[0],d[1],v);const _=this._controlContainer=b.create("div","maplibregl-control-container",M),E=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(O=>{E[O]=b.create("div",`maplibregl-ctrl-${O} `,_)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(M,o,d){this._canvas.width=Math.floor(d*M),this._canvas.height=Math.floor(d*o),this._canvas.style.width=`${M}px`,this._canvas.style.height=`${o}px`}_setupPainter(){const M={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let o=null;this._canvas.addEventListener("webglcontextcreationerror",v=>{o={requestedAttributes:M},v&&(o.statusMessage=v.statusMessage,o.type=v.type)},{once:!0});const d=this._canvas.getContext("webgl2",M)||this._canvas.getContext("webgl",M);if(!d){const v="Failed to initialize WebGL";throw o?(o.message=v,new Error(JSON.stringify(o))):new Error(v)}this.painter=new a0(d,this.transform),A.testSupport(d)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(M){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||M,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(M){return this._update(),this._renderTaskQueue.add(M)}_cancelRenderFrame(M){this._renderTaskQueue.remove(M)}_render(M){const o=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(M),this._removed)return;let d=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const _=this.transform.zoom,E=S.now();this.style.zoomHistory.update(_,E);const O=new l.a9(_,{now:E,fadeDuration:o,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),z=O.crossFadingFactor();z===1&&z===this._crossFadingFactor||(d=!0,this._crossFadingFactor=z),this.style.update(O)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,o,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:o,showPadding:this.showPadding}),this.fire(new l.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,l.be.mark(l.bf.load),this.fire(new l.k("load"))),this.style&&(this.style.hasTransitions()||d)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const v=this._sourcesDirty||this._styleDirty||this._placementDirty;return v||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new l.k("idle")),!this._loaded||this._fullyLoaded||v||(this._fullyLoaded=!0,l.be.mark(l.bf.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var M;this._hash&&this._hash.remove();for(const d of this._controls)d.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),B.removeThrottleControl(this._imageQueueHandle),(M=this._resizeObserver)===null||M===void 0||M.disconnect();const o=this.painter.context.gl.getExtension("WEBGL_lose_context");o!=null&&o.loseContext&&o.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),b.remove(this._canvasContainer),b.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),l.be.clearMetrics(),this._removed=!0,this.fire(new l.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,S.frameAsync(this._frameRequest).then(M=>{l.be.frame(M),this._frameRequest=null,this._render(M)}).catch(()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(M){this._showTileBoundaries!==M&&(this._showTileBoundaries=M,this._update())}get showPadding(){return!!this._showPadding}set showPadding(M){this._showPadding!==M&&(this._showPadding=M,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(M){this._showCollisionBoxes!==M&&(this._showCollisionBoxes=M,M?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(M){this._showOverdrawInspector!==M&&(this._showOverdrawInspector=M,this._update())}get repaint(){return!!this._repaint}set repaint(M){this._repaint!==M&&(this._repaint=M,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(M){this._vertices=M,this._update()}get version(){return Wl}getCameraTargetElevation(){return this.transform.elevation}},u.MapMouseEvent=Nr,u.MapTouchEvent=$l,u.MapWheelEvent=yu,u.Marker=tr,u.NavigationControl=class{constructor(M){this._updateZoomButtons=()=>{const o=this._map.getZoom(),d=o===this._map.getMaxZoom(),v=o===this._map.getMinZoom();this._zoomInButton.disabled=d,this._zoomOutButton.disabled=v,this._zoomInButton.setAttribute("aria-disabled",d.toString()),this._zoomOutButton.setAttribute("aria-disabled",v.toString())},this._rotateCompassArrow=()=>{const o=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=o},this._setButtonTitle=(o,d)=>{const v=this._map._getUIString(`NavigationControl.${d}`);o.title=v,o.setAttribute("aria-label",v)},this.options=l.e({},fi,M),this._container=b.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",o=>o.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",o=>this._map.zoomIn({},{originalEvent:o})),b.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",o=>this._map.zoomOut({},{originalEvent:o})),b.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",o=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:o}):this._map.resetNorth({},{originalEvent:o})}),this._compassIcon=b.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(M){return this._map=M,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new h0(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){b.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(M,o){const d=b.create("button",M,this._container);return d.type="button",d.addEventListener("click",o),d}},u.Popup=class extends l.E{constructor(M){super(),this.remove=()=>(this._content&&b.remove(this._content),this._container&&(b.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new l.k("close"))),this),this._onMouseUp=o=>{this._update(o.point)},this._onMouseMove=o=>{this._update(o.point)},this._onDrag=o=>{this._update(o.point)},this._update=o=>{var d;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=b.create("div","maplibregl-popup",this._map.getContainer()),this._tip=b.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const z of this.options.className.split(" "))this._container.classList.add(z);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?d0(this._lngLat,this._flatPos,this._map.transform):(d=this._lngLat)===null||d===void 0?void 0:d.wrap(),this._trackPointer&&!o)return;const v=this._flatPos=this._pos=this._trackPointer&&o?o:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&o?o:this._map.transform.locationPoint(this._lngLat));let _=this.options.anchor;const E=Tn(this.options.offset);if(!_){const z=this._container.offsetWidth,V=this._container.offsetHeight;let H;H=v.y+E.bottom.y<V?["top"]:v.y>this._map.transform.height-V?["bottom"]:[],v.x<z/2?H.push("left"):v.x>this._map.transform.width-z/2&&H.push("right"),_=H.length===0?"bottom":H.join("-")}let O=v.add(E[_]);this.options.subpixelPositioning||(O=O.round()),b.setTransform(this._container,`${ul[_]} translate(${O.x}px,${O.y}px)`),ql(this._container,_,"popup")},this._onClose=()=>{this.remove()},this.options=l.e(Object.create(Ta),M)}addTo(M){return this._map&&this.remove(),this._map=M,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new l.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(M){return this._lngLat=l.N.convert(M),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(M){return this.setDOMContent(document.createTextNode(M))}setHTML(M){const o=document.createDocumentFragment(),d=document.createElement("body");let v;for(d.innerHTML=M;v=d.firstChild,v;)o.appendChild(v);return this.setDOMContent(o)}getMaxWidth(){var M;return(M=this._container)===null||M===void 0?void 0:M.style.maxWidth}setMaxWidth(M){return this.options.maxWidth=M,this._update(),this}setDOMContent(M){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=b.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(M),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(M){return this._container&&this._container.classList.add(M),this}removeClassName(M){return this._container&&this._container.classList.remove(M),this}setOffset(M){return this.options.offset=M,this._update(),this}toggleClassName(M){if(this._container)return this._container.classList.toggle(M)}setSubpixelPositioning(M){this.options.subpixelPositioning=M}_createCloseButton(){this.options.closeButton&&(this._closeButton=b.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const M=this._container.querySelector(Sf);M&&M.focus()}},u.RasterDEMTileSource=ve,u.RasterTileSource=mt,u.ScaleControl=class{constructor(M){this._onMove=()=>{pm(this._map,this._container,this.options)},this.setUnit=o=>{this.options.unit=o,pm(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Ca),M)}getDefaultPosition(){return"bottom-left"}onAdd(M){return this._map=M,this._container=b.create("div","maplibregl-ctrl maplibregl-ctrl-scale",M.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){b.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},u.ScrollZoomHandler=cm,u.Style=Ol,u.TerrainControl=class{constructor(M){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=M}onAdd(M){return this._map=M,this._container=b.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=b.create("button","maplibregl-ctrl-terrain",this._container),b.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){b.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},u.TwoFingersTouchPitchHandler=Eu,u.TwoFingersTouchRotateHandler=sm,u.TwoFingersTouchZoomHandler=im,u.TwoFingersTouchZoomRotateHandler=um,u.VectorTileSource=Pt,u.VideoSource=st,u.addSourceType=(M,o)=>l._(void 0,void 0,void 0,function*(){if($t(M))throw new Error(`A source type called "${M}" already exists.`);((d,v)=>{Ht[d]=v})(M,o)}),u.clearPrewarmedResources=function(){const M=Rt;M&&(M.isPreloaded()&&M.numActive()===1?(M.release(Ke),Rt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},u.getMaxParallelImageRequests=function(){return l.a.MAX_PARALLEL_IMAGE_REQUESTS},u.getRTLTextPluginStatus=function(){return on().getRTLTextPluginStatus()},u.getVersion=function(){return An},u.getWorkerCount=function(){return _t.workerCount},u.getWorkerUrl=function(){return l.a.WORKER_URL},u.importScriptInWorkers=function(M){return Kn().broadcast("IS",M)},u.prewarm=function(){Mn().acquire(Ke)},u.setMaxParallelImageRequests=function(M){l.a.MAX_PARALLEL_IMAGE_REQUESTS=M},u.setRTLTextPlugin=function(M,o){return on().setRTLTextPlugin(M,o)},u.setWorkerCount=function(M){_t.workerCount=M},u.setWorkerUrl=function(M){l.a.WORKER_URL=M}});var a=n;return a})})(AD);var mj=AD.exports;const PD=cb(mj);/**
 * @license
 * Copyright 2010-2024 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const ID="165",VC=0,gj=1,RD=1,LD=100,kD=204,DD=205,OD=3,vj=0,FD=300,zD=1e3,ub=1001,ND=1002,BD=1003,yj=1006,_j=1008,xj=1009,bj=1014,wj=1015,Sj=1020,Ej=1023,$C=1026,UD=1027,VD="",_d="srgb",HC="srgb-linear",Mj="display-p3",$D="display-p3-linear",GC="linear",HD="srgb",GD="rec709",WD="p3",bg=7680,jD=519,Cj=515,qD=35044,Cy=2e3,XD=2001;class hb{addEventListener(e,n){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(n)===-1&&i[e].push(n)}hasEventListener(e,n){if(this._listeners===void 0)return!1;const i=this._listeners;return i[e]!==void 0&&i[e].indexOf(n)!==-1}removeEventListener(e,n){if(this._listeners===void 0)return;const r=this._listeners[e];if(r!==void 0){const a=r.indexOf(n);a!==-1&&r.splice(a,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const i=this._listeners[e.type];if(i!==void 0){e.target=this;const r=i.slice(0);for(let a=0,u=r.length;a<u;a++)r[a].call(this,e);e.target=null}}}const Mo=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let ZD=1234567;const Ty=Math.PI/180,db=180/Math.PI;function wg(){const t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,n=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(Mo[t&255]+Mo[t>>8&255]+Mo[t>>16&255]+Mo[t>>24&255]+"-"+Mo[e&255]+Mo[e>>8&255]+"-"+Mo[e>>16&15|64]+Mo[e>>24&255]+"-"+Mo[n&63|128]+Mo[n>>8&255]+"-"+Mo[n>>16&255]+Mo[n>>24&255]+Mo[i&255]+Mo[i>>8&255]+Mo[i>>16&255]+Mo[i>>24&255]).toLowerCase()}function Wo(t,e,n){return Math.max(e,Math.min(n,t))}function WC(t,e){return(t%e+e)%e}function Tj(t,e,n,i,r){return i+(t-e)*(r-i)/(n-e)}function Aj(t,e,n){return t!==e?(n-t)/(e-t):0}function Ay(t,e,n){return(1-n)*t+n*e}function Pj(t,e,n,i){return Ay(t,e,1-Math.exp(-n*i))}function Ij(t,e=1){return e-Math.abs(WC(t,e*2)-e)}function Rj(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*(3-2*t))}function Lj(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*t*(t*(t*6-15)+10))}function kj(t,e){return t+Math.floor(Math.random()*(e-t+1))}function Dj(t,e){return t+Math.random()*(e-t)}function Oj(t){return t*(.5-Math.random())}function Fj(t){t!==void 0&&(ZD=t);let e=ZD+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function zj(t){return t*Ty}function Nj(t){return t*db}function Bj(t){return(t&t-1)===0&&t!==0}function Uj(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function Vj(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}function $j(t,e,n,i,r){const a=Math.cos,u=Math.sin,l=a(n/2),f=u(n/2),g=a((e+i)/2),y=u((e+i)/2),S=a((e-i)/2),b=u((e-i)/2),A=a((i-e)/2),I=u((i-e)/2);switch(r){case"XYX":t.set(l*y,f*S,f*b,l*g);break;case"YZY":t.set(f*b,l*y,f*S,l*g);break;case"ZXZ":t.set(f*S,f*b,l*y,l*g);break;case"XZX":t.set(l*y,f*I,f*A,l*g);break;case"YXY":t.set(f*A,l*y,f*I,l*g);break;case"ZYZ":t.set(f*I,f*A,l*y,l*g);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function Sg(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return t/4294967295;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int32Array:return Math.max(t/2147483647,-1);case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}function jo(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return Math.round(t*4294967295);case Uint16Array:return Math.round(t*65535);case Uint8Array:return Math.round(t*255);case Int32Array:return Math.round(t*2147483647);case Int16Array:return Math.round(t*32767);case Int8Array:return Math.round(t*127);default:throw new Error("Invalid component type.")}}const eu={DEG2RAD:Ty,RAD2DEG:db,generateUUID:wg,clamp:Wo,euclideanModulo:WC,mapLinear:Tj,inverseLerp:Aj,lerp:Ay,damp:Pj,pingpong:Ij,smoothstep:Rj,smootherstep:Lj,randInt:kj,randFloat:Dj,randFloatSpread:Oj,seededRandom:Fj,degToRad:zj,radToDeg:Nj,isPowerOfTwo:Bj,ceilPowerOfTwo:Uj,floorPowerOfTwo:Vj,setQuaternionFromProperEuler:$j,normalize:jo,denormalize:Sg};class so{constructor(e=0,n=0){so.prototype.isVector2=!0,this.x=e,this.y=n}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,n){return this.x=e,this.y=n,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const n=this.x,i=this.y,r=e.elements;return this.x=r[0]*n+r[3]*i+r[6],this.y=r[1]*n+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(n,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const i=this.dot(e)/n;return Math.acos(Wo(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,i=this.y-e.y;return n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this}rotateAround(e,n){const i=Math.cos(n),r=Math.sin(n),a=this.x-e.x,u=this.y-e.y;return this.x=a*i-u*r+e.x,this.y=a*r+u*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class xd{constructor(e,n,i,r,a,u,l,f,g){xd.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,n,i,r,a,u,l,f,g)}set(e,n,i,r,a,u,l,f,g){const y=this.elements;return y[0]=e,y[1]=r,y[2]=l,y[3]=n,y[4]=a,y[5]=f,y[6]=i,y[7]=u,y[8]=g,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const n=this.elements,i=e.elements;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],this}extractBasis(e,n,i){return e.setFromMatrix3Column(this,0),n.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const n=e.elements;return this.set(n[0],n[4],n[8],n[1],n[5],n[9],n[2],n[6],n[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const i=e.elements,r=n.elements,a=this.elements,u=i[0],l=i[3],f=i[6],g=i[1],y=i[4],S=i[7],b=i[2],A=i[5],I=i[8],D=r[0],L=r[3],P=r[6],N=r[1],B=r[4],$=r[7],K=r[2],q=r[5],W=r[8];return a[0]=u*D+l*N+f*K,a[3]=u*L+l*B+f*q,a[6]=u*P+l*$+f*W,a[1]=g*D+y*N+S*K,a[4]=g*L+y*B+S*q,a[7]=g*P+y*$+S*W,a[2]=b*D+A*N+I*K,a[5]=b*L+A*B+I*q,a[8]=b*P+A*$+I*W,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=e,n[4]*=e,n[7]*=e,n[2]*=e,n[5]*=e,n[8]*=e,this}determinant(){const e=this.elements,n=e[0],i=e[1],r=e[2],a=e[3],u=e[4],l=e[5],f=e[6],g=e[7],y=e[8];return n*u*y-n*l*g-i*a*y+i*l*f+r*a*g-r*u*f}invert(){const e=this.elements,n=e[0],i=e[1],r=e[2],a=e[3],u=e[4],l=e[5],f=e[6],g=e[7],y=e[8],S=y*u-l*g,b=l*f-y*a,A=g*a-u*f,I=n*S+i*b+r*A;if(I===0)return this.set(0,0,0,0,0,0,0,0,0);const D=1/I;return e[0]=S*D,e[1]=(r*g-y*i)*D,e[2]=(l*i-r*u)*D,e[3]=b*D,e[4]=(y*n-r*f)*D,e[5]=(r*a-l*n)*D,e[6]=A*D,e[7]=(i*f-g*n)*D,e[8]=(u*n-i*a)*D,this}transpose(){let e;const n=this.elements;return e=n[1],n[1]=n[3],n[3]=e,e=n[2],n[2]=n[6],n[6]=e,e=n[5],n[5]=n[7],n[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const n=this.elements;return e[0]=n[0],e[1]=n[3],e[2]=n[6],e[3]=n[1],e[4]=n[4],e[5]=n[7],e[6]=n[2],e[7]=n[5],e[8]=n[8],this}setUvTransform(e,n,i,r,a,u,l){const f=Math.cos(a),g=Math.sin(a);return this.set(i*f,i*g,-i*(f*u+g*l)+u+e,-r*g,r*f,-r*(-g*u+f*l)+l+n,0,0,1),this}scale(e,n){return this.premultiply(jC.makeScale(e,n)),this}rotate(e){return this.premultiply(jC.makeRotation(-e)),this}translate(e,n){return this.premultiply(jC.makeTranslation(e,n)),this}makeTranslation(e,n){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,n,0,0,1),this}makeRotation(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,-i,0,i,n,0,0,0,1),this}makeScale(e,n){return this.set(e,0,0,0,n,0,0,0,1),this}equals(e){const n=this.elements,i=e.elements;for(let r=0;r<9;r++)if(n[r]!==i[r])return!1;return!0}fromArray(e,n=0){for(let i=0;i<9;i++)this.elements[i]=e[i+n];return this}toArray(e=[],n=0){const i=this.elements;return e[n]=i[0],e[n+1]=i[1],e[n+2]=i[2],e[n+3]=i[3],e[n+4]=i[4],e[n+5]=i[5],e[n+6]=i[6],e[n+7]=i[7],e[n+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const jC=new xd;function Hj(t){for(let e=t.length-1;e>=0;--e)if(t[e]>=65535)return!0;return!1}function YD(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}const KD={};function Gj(t){t in KD||(KD[t]=!0,console.warn(t))}const JD=new xd().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),QD=new xd().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),fb={[HC]:{transfer:GC,primaries:GD,toReference:t=>t,fromReference:t=>t},[_d]:{transfer:HD,primaries:GD,toReference:t=>t.convertSRGBToLinear(),fromReference:t=>t.convertLinearToSRGB()},[$D]:{transfer:GC,primaries:WD,toReference:t=>t.applyMatrix3(QD),fromReference:t=>t.applyMatrix3(JD)},[Mj]:{transfer:HD,primaries:WD,toReference:t=>t.convertSRGBToLinear().applyMatrix3(QD),fromReference:t=>t.applyMatrix3(JD).convertLinearToSRGB()}},Wj=new Set([HC,$D]),cc={enabled:!0,_workingColorSpace:HC,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(t){if(!Wj.has(t))throw new Error(`Unsupported working color space, "${t}".`);this._workingColorSpace=t},convert:function(t,e,n){if(this.enabled===!1||e===n||!e||!n)return t;const i=fb[e].toReference,r=fb[n].fromReference;return r(i(t))},fromWorkingColorSpace:function(t,e){return this.convert(t,this._workingColorSpace,e)},toWorkingColorSpace:function(t,e){return this.convert(t,e,this._workingColorSpace)},getPrimaries:function(t){return fb[t].primaries},getTransfer:function(t){return t===VD?GC:fb[t].transfer}};function Eg(t){return t<.04045?t*.0773993808:Math.pow(t*.9478672986+.0521327014,2.4)}function qC(t){return t<.0031308?t*12.92:1.055*Math.pow(t,.41666)-.055}let Mg;class jj{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let n;if(e instanceof HTMLCanvasElement)n=e;else{Mg===void 0&&(Mg=YD("canvas")),Mg.width=e.width,Mg.height=e.height;const i=Mg.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),n=Mg}return n.width>2048||n.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),n.toDataURL("image/jpeg",.6)):n.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const n=YD("canvas");n.width=e.width,n.height=e.height;const i=n.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),a=r.data;for(let u=0;u<a.length;u++)a[u]=Eg(a[u]/255)*255;return i.putImageData(r,0,0),n}else if(e.data){const n=e.data.slice(0);for(let i=0;i<n.length;i++)n instanceof Uint8Array||n instanceof Uint8ClampedArray?n[i]=Math.floor(Eg(n[i]/255)*255):n[i]=Eg(n[i]);return{data:n,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let qj=0;class Xj{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:qj++}),this.uuid=wg(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(r!==null){let a;if(Array.isArray(r)){a=[];for(let u=0,l=r.length;u<l;u++)r[u].isDataTexture?a.push(XC(r[u].image)):a.push(XC(r[u]))}else a=XC(r);i.url=a}return n||(e.images[this.uuid]=i),i}}function XC(t){return typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap?jj.getDataURL(t):t.data?{data:Array.from(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Zj=0;class bd extends hb{constructor(e=bd.DEFAULT_IMAGE,n=bd.DEFAULT_MAPPING,i=ub,r=ub,a=yj,u=_j,l=Ej,f=xj,g=bd.DEFAULT_ANISOTROPY,y=VD){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Zj++}),this.uuid=wg(),this.name="",this.source=new Xj(e),this.mipmaps=[],this.mapping=n,this.channel=0,this.wrapS=i,this.wrapT=r,this.magFilter=a,this.minFilter=u,this.anisotropy=g,this.format=l,this.internalFormat=null,this.type=f,this.offset=new so(0,0),this.repeat=new so(1,1),this.center=new so(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new xd,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=y,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const i={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),n||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==FD)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case zD:e.x=e.x-Math.floor(e.x);break;case ub:e.x=e.x<0?0:1;break;case ND:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case zD:e.y=e.y-Math.floor(e.y);break;case ub:e.y=e.y<0?0:1;break;case ND:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}bd.DEFAULT_IMAGE=null,bd.DEFAULT_MAPPING=FD,bd.DEFAULT_ANISOTROPY=1;class Cg{constructor(e=0,n=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=n,this._z=i,this._w=r}static slerpFlat(e,n,i,r,a,u,l){let f=i[r+0],g=i[r+1],y=i[r+2],S=i[r+3];const b=a[u+0],A=a[u+1],I=a[u+2],D=a[u+3];if(l===0){e[n+0]=f,e[n+1]=g,e[n+2]=y,e[n+3]=S;return}if(l===1){e[n+0]=b,e[n+1]=A,e[n+2]=I,e[n+3]=D;return}if(S!==D||f!==b||g!==A||y!==I){let L=1-l;const P=f*b+g*A+y*I+S*D,N=P>=0?1:-1,B=1-P*P;if(B>Number.EPSILON){const K=Math.sqrt(B),q=Math.atan2(K,P*N);L=Math.sin(L*q)/K,l=Math.sin(l*q)/K}const $=l*N;if(f=f*L+b*$,g=g*L+A*$,y=y*L+I*$,S=S*L+D*$,L===1-l){const K=1/Math.sqrt(f*f+g*g+y*y+S*S);f*=K,g*=K,y*=K,S*=K}}e[n]=f,e[n+1]=g,e[n+2]=y,e[n+3]=S}static multiplyQuaternionsFlat(e,n,i,r,a,u){const l=i[r],f=i[r+1],g=i[r+2],y=i[r+3],S=a[u],b=a[u+1],A=a[u+2],I=a[u+3];return e[n]=l*I+y*S+f*A-g*b,e[n+1]=f*I+y*b+g*S-l*A,e[n+2]=g*I+y*A+l*b-f*S,e[n+3]=y*I-l*S-f*b-g*A,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,n,i,r){return this._x=e,this._y=n,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,n=!0){const i=e._x,r=e._y,a=e._z,u=e._order,l=Math.cos,f=Math.sin,g=l(i/2),y=l(r/2),S=l(a/2),b=f(i/2),A=f(r/2),I=f(a/2);switch(u){case"XYZ":this._x=b*y*S+g*A*I,this._y=g*A*S-b*y*I,this._z=g*y*I+b*A*S,this._w=g*y*S-b*A*I;break;case"YXZ":this._x=b*y*S+g*A*I,this._y=g*A*S-b*y*I,this._z=g*y*I-b*A*S,this._w=g*y*S+b*A*I;break;case"ZXY":this._x=b*y*S-g*A*I,this._y=g*A*S+b*y*I,this._z=g*y*I+b*A*S,this._w=g*y*S-b*A*I;break;case"ZYX":this._x=b*y*S-g*A*I,this._y=g*A*S+b*y*I,this._z=g*y*I-b*A*S,this._w=g*y*S+b*A*I;break;case"YZX":this._x=b*y*S+g*A*I,this._y=g*A*S+b*y*I,this._z=g*y*I-b*A*S,this._w=g*y*S-b*A*I;break;case"XZY":this._x=b*y*S-g*A*I,this._y=g*A*S-b*y*I,this._z=g*y*I+b*A*S,this._w=g*y*S+b*A*I;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+u)}return n===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,n){const i=n/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const n=e.elements,i=n[0],r=n[4],a=n[8],u=n[1],l=n[5],f=n[9],g=n[2],y=n[6],S=n[10],b=i+l+S;if(b>0){const A=.5/Math.sqrt(b+1);this._w=.25/A,this._x=(y-f)*A,this._y=(a-g)*A,this._z=(u-r)*A}else if(i>l&&i>S){const A=2*Math.sqrt(1+i-l-S);this._w=(y-f)/A,this._x=.25*A,this._y=(r+u)/A,this._z=(a+g)/A}else if(l>S){const A=2*Math.sqrt(1+l-i-S);this._w=(a-g)/A,this._x=(r+u)/A,this._y=.25*A,this._z=(f+y)/A}else{const A=2*Math.sqrt(1+S-i-l);this._w=(u-r)/A,this._x=(a+g)/A,this._y=(f+y)/A,this._z=.25*A}return this._onChangeCallback(),this}setFromUnitVectors(e,n){let i=e.dot(n)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*n.z-e.z*n.y,this._y=e.z*n.x-e.x*n.z,this._z=e.x*n.y-e.y*n.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Wo(this.dot(e),-1,1)))}rotateTowards(e,n){const i=this.angleTo(e);if(i===0)return this;const r=Math.min(1,n/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,n){const i=e._x,r=e._y,a=e._z,u=e._w,l=n._x,f=n._y,g=n._z,y=n._w;return this._x=i*y+u*l+r*g-a*f,this._y=r*y+u*f+a*l-i*g,this._z=a*y+u*g+i*f-r*l,this._w=u*y-i*l-r*f-a*g,this._onChangeCallback(),this}slerp(e,n){if(n===0)return this;if(n===1)return this.copy(e);const i=this._x,r=this._y,a=this._z,u=this._w;let l=u*e._w+i*e._x+r*e._y+a*e._z;if(l<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,l=-l):this.copy(e),l>=1)return this._w=u,this._x=i,this._y=r,this._z=a,this;const f=1-l*l;if(f<=Number.EPSILON){const A=1-n;return this._w=A*u+n*this._w,this._x=A*i+n*this._x,this._y=A*r+n*this._y,this._z=A*a+n*this._z,this.normalize(),this}const g=Math.sqrt(f),y=Math.atan2(g,l),S=Math.sin((1-n)*y)/g,b=Math.sin(n*y)/g;return this._w=u*S+this._w*b,this._x=i*S+this._x*b,this._y=r*S+this._y*b,this._z=a*S+this._z*b,this._onChangeCallback(),this}slerpQuaternions(e,n,i){return this.copy(e).slerp(n,i)}random(){const e=2*Math.PI*Math.random(),n=2*Math.PI*Math.random(),i=Math.random(),r=Math.sqrt(1-i),a=Math.sqrt(i);return this.set(r*Math.sin(e),r*Math.cos(e),a*Math.sin(n),a*Math.cos(n))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,n=0){return this._x=e[n],this._y=e[n+1],this._z=e[n+2],this._w=e[n+3],this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._w,e}fromBufferAttribute(e,n){return this._x=e.getX(n),this._y=e.getY(n),this._z=e.getZ(n),this._w=e.getW(n),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Lt{constructor(e=0,n=0,i=0){Lt.prototype.isVector3=!0,this.x=e,this.y=n,this.z=i}set(e,n,i){return i===void 0&&(i=this.z),this.x=e,this.y=n,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,n){return this.x=e.x*n.x,this.y=e.y*n.y,this.z=e.z*n.z,this}applyEuler(e){return this.applyQuaternion(eO.setFromEuler(e))}applyAxisAngle(e,n){return this.applyQuaternion(eO.setFromAxisAngle(e,n))}applyMatrix3(e){const n=this.x,i=this.y,r=this.z,a=e.elements;return this.x=a[0]*n+a[3]*i+a[6]*r,this.y=a[1]*n+a[4]*i+a[7]*r,this.z=a[2]*n+a[5]*i+a[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const n=this.x,i=this.y,r=this.z,a=e.elements,u=1/(a[3]*n+a[7]*i+a[11]*r+a[15]);return this.x=(a[0]*n+a[4]*i+a[8]*r+a[12])*u,this.y=(a[1]*n+a[5]*i+a[9]*r+a[13])*u,this.z=(a[2]*n+a[6]*i+a[10]*r+a[14])*u,this}applyQuaternion(e){const n=this.x,i=this.y,r=this.z,a=e.x,u=e.y,l=e.z,f=e.w,g=2*(u*r-l*i),y=2*(l*n-a*r),S=2*(a*i-u*n);return this.x=n+f*g+u*S-l*y,this.y=i+f*y+l*g-a*S,this.z=r+f*S+a*y-u*g,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const n=this.x,i=this.y,r=this.z,a=e.elements;return this.x=a[0]*n+a[4]*i+a[8]*r,this.y=a[1]*n+a[5]*i+a[9]*r,this.z=a[2]*n+a[6]*i+a[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this.z=Math.max(e.z,Math.min(n.z,this.z)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this.z=Math.max(e,Math.min(n,this.z)),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(n,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this.z=e.z+(n.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,n){const i=e.x,r=e.y,a=e.z,u=n.x,l=n.y,f=n.z;return this.x=r*f-a*l,this.y=a*u-i*f,this.z=i*l-r*u,this}projectOnVector(e){const n=e.lengthSq();if(n===0)return this.set(0,0,0);const i=e.dot(this)/n;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return ZC.copy(this).projectOnVector(e),this.sub(ZC)}reflect(e){return this.sub(ZC.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const i=this.dot(e)/n;return Math.acos(Wo(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return n*n+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,n,i){const r=Math.sin(n)*e;return this.x=r*Math.sin(i),this.y=Math.cos(n)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,n,i){return this.x=e*Math.sin(n),this.y=i,this.z=e*Math.cos(n),this}setFromMatrixPosition(e){const n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this}setFromMatrixScale(e){const n=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=n,this.y=i,this.z=r,this}setFromMatrixColumn(e,n){return this.fromArray(e.elements,n*4)}setFromMatrix3Column(e,n){return this.fromArray(e.elements,n*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,n=Math.random()*2-1,i=Math.sqrt(1-n*n);return this.x=i*Math.cos(e),this.y=n,this.z=i*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const ZC=new Lt,eO=new Cg;class Py{constructor(e=new Lt(1/0,1/0,1/0),n=new Lt(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromArray(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n+=3)this.expandByPoint(uc.fromArray(e,n));return this}setFromBufferAttribute(e){this.makeEmpty();for(let n=0,i=e.count;n<i;n++)this.expandByPoint(uc.fromBufferAttribute(e,n));return this}setFromPoints(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){const i=uc.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,n=!1){return this.makeEmpty(),this.expandByObject(e,n)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,n=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(i!==void 0){const a=i.getAttribute("position");if(n===!0&&a!==void 0&&e.isInstancedMesh!==!0)for(let u=0,l=a.count;u<l;u++)e.isMesh===!0?e.getVertexPosition(u,uc):uc.fromBufferAttribute(a,u),uc.applyMatrix4(e.matrixWorld),this.expandByPoint(uc);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),pb.copy(e.boundingBox)):(i.boundingBox===null&&i.computeBoundingBox(),pb.copy(i.boundingBox)),pb.applyMatrix4(e.matrixWorld),this.union(pb)}const r=e.children;for(let a=0,u=r.length;a<u;a++)this.expandByObject(r[a],n);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,uc),uc.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let n,i;return e.normal.x>0?(n=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(n=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(n+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(n+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(n+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(n+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),n<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Iy),mb.subVectors(this.max,Iy),Tg.subVectors(e.a,Iy),Ag.subVectors(e.b,Iy),Pg.subVectors(e.c,Iy),wd.subVectors(Ag,Tg),Sd.subVectors(Pg,Ag),op.subVectors(Tg,Pg);let n=[0,-wd.z,wd.y,0,-Sd.z,Sd.y,0,-op.z,op.y,wd.z,0,-wd.x,Sd.z,0,-Sd.x,op.z,0,-op.x,-wd.y,wd.x,0,-Sd.y,Sd.x,0,-op.y,op.x,0];return!YC(n,Tg,Ag,Pg,mb)||(n=[1,0,0,0,1,0,0,0,1],!YC(n,Tg,Ag,Pg,mb))?!1:(gb.crossVectors(wd,Sd),n=[gb.x,gb.y,gb.z],YC(n,Tg,Ag,Pg,mb))}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,uc).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(uc).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(ih[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),ih[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),ih[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),ih[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),ih[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),ih[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),ih[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),ih[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(ih),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const ih=[new Lt,new Lt,new Lt,new Lt,new Lt,new Lt,new Lt,new Lt],uc=new Lt,pb=new Py,Tg=new Lt,Ag=new Lt,Pg=new Lt,wd=new Lt,Sd=new Lt,op=new Lt,Iy=new Lt,mb=new Lt,gb=new Lt,ap=new Lt;function YC(t,e,n,i,r){for(let a=0,u=t.length-3;a<=u;a+=3){ap.fromArray(t,a);const l=r.x*Math.abs(ap.x)+r.y*Math.abs(ap.y)+r.z*Math.abs(ap.z),f=e.dot(ap),g=n.dot(ap),y=i.dot(ap);if(Math.max(-Math.max(f,g,y),Math.min(f,g,y))>l)return!1}return!0}const Yj=new Py,Ry=new Lt,KC=new Lt;class JC{constructor(e=new Lt,n=-1){this.isSphere=!0,this.center=e,this.radius=n}set(e,n){return this.center.copy(e),this.radius=n,this}setFromPoints(e,n){const i=this.center;n!==void 0?i.copy(n):Yj.setFromPoints(e).getCenter(i);let r=0;for(let a=0,u=e.length;a<u;a++)r=Math.max(r,i.distanceToSquared(e[a]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const n=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=n*n}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,n){const i=this.center.distanceToSquared(e);return n.copy(e),i>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Ry.subVectors(e,this.center);const n=Ry.lengthSq();if(n>this.radius*this.radius){const i=Math.sqrt(n),r=(i-this.radius)*.5;this.center.addScaledVector(Ry,r/i),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(KC.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Ry.copy(e.center).add(KC)),this.expandByPoint(Ry.copy(e.center).sub(KC))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const rh=new Lt,QC=new Lt,vb=new Lt,Ed=new Lt,eT=new Lt,yb=new Lt,tT=new Lt;class tO{constructor(e=new Lt,n=new Lt(0,0,-1)){this.origin=e,this.direction=n}set(e,n){return this.origin.copy(e),this.direction.copy(n),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,n){return n.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,rh)),this}closestPointToPoint(e,n){n.subVectors(e,this.origin);const i=n.dot(this.direction);return i<0?n.copy(this.origin):n.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const n=rh.subVectors(e,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(e):(rh.copy(this.origin).addScaledVector(this.direction,n),rh.distanceToSquared(e))}distanceSqToSegment(e,n,i,r){QC.copy(e).add(n).multiplyScalar(.5),vb.copy(n).sub(e).normalize(),Ed.copy(this.origin).sub(QC);const a=e.distanceTo(n)*.5,u=-this.direction.dot(vb),l=Ed.dot(this.direction),f=-Ed.dot(vb),g=Ed.lengthSq(),y=Math.abs(1-u*u);let S,b,A,I;if(y>0)if(S=u*f-l,b=u*l-f,I=a*y,S>=0)if(b>=-I)if(b<=I){const D=1/y;S*=D,b*=D,A=S*(S+u*b+2*l)+b*(u*S+b+2*f)+g}else b=a,S=Math.max(0,-(u*b+l)),A=-S*S+b*(b+2*f)+g;else b=-a,S=Math.max(0,-(u*b+l)),A=-S*S+b*(b+2*f)+g;else b<=-I?(S=Math.max(0,-(-u*a+l)),b=S>0?-a:Math.min(Math.max(-a,-f),a),A=-S*S+b*(b+2*f)+g):b<=I?(S=0,b=Math.min(Math.max(-a,-f),a),A=b*(b+2*f)+g):(S=Math.max(0,-(u*a+l)),b=S>0?a:Math.min(Math.max(-a,-f),a),A=-S*S+b*(b+2*f)+g);else b=u>0?-a:a,S=Math.max(0,-(u*b+l)),A=-S*S+b*(b+2*f)+g;return i&&i.copy(this.origin).addScaledVector(this.direction,S),r&&r.copy(QC).addScaledVector(vb,b),A}intersectSphere(e,n){rh.subVectors(e.center,this.origin);const i=rh.dot(this.direction),r=rh.dot(rh)-i*i,a=e.radius*e.radius;if(r>a)return null;const u=Math.sqrt(a-r),l=i-u,f=i+u;return f<0?null:l<0?this.at(f,n):this.at(l,n)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const n=e.normal.dot(this.direction);if(n===0)return e.distanceToPoint(this.origin)===0?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/n;return i>=0?i:null}intersectPlane(e,n){const i=this.distanceToPlane(e);return i===null?null:this.at(i,n)}intersectsPlane(e){const n=e.distanceToPoint(this.origin);return n===0||e.normal.dot(this.direction)*n<0}intersectBox(e,n){let i,r,a,u,l,f;const g=1/this.direction.x,y=1/this.direction.y,S=1/this.direction.z,b=this.origin;return g>=0?(i=(e.min.x-b.x)*g,r=(e.max.x-b.x)*g):(i=(e.max.x-b.x)*g,r=(e.min.x-b.x)*g),y>=0?(a=(e.min.y-b.y)*y,u=(e.max.y-b.y)*y):(a=(e.max.y-b.y)*y,u=(e.min.y-b.y)*y),i>u||a>r||((a>i||isNaN(i))&&(i=a),(u<r||isNaN(r))&&(r=u),S>=0?(l=(e.min.z-b.z)*S,f=(e.max.z-b.z)*S):(l=(e.max.z-b.z)*S,f=(e.min.z-b.z)*S),i>f||l>r)||((l>i||i!==i)&&(i=l),(f<r||r!==r)&&(r=f),r<0)?null:this.at(i>=0?i:r,n)}intersectsBox(e){return this.intersectBox(e,rh)!==null}intersectTriangle(e,n,i,r,a){eT.subVectors(n,e),yb.subVectors(i,e),tT.crossVectors(eT,yb);let u=this.direction.dot(tT),l;if(u>0){if(r)return null;l=1}else if(u<0)l=-1,u=-u;else return null;Ed.subVectors(this.origin,e);const f=l*this.direction.dot(yb.crossVectors(Ed,yb));if(f<0)return null;const g=l*this.direction.dot(eT.cross(Ed));if(g<0||f+g>u)return null;const y=-l*Ed.dot(tT);return y<0?null:this.at(y/u,a)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class As{constructor(e,n,i,r,a,u,l,f,g,y,S,b,A,I,D,L){As.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,n,i,r,a,u,l,f,g,y,S,b,A,I,D,L)}set(e,n,i,r,a,u,l,f,g,y,S,b,A,I,D,L){const P=this.elements;return P[0]=e,P[4]=n,P[8]=i,P[12]=r,P[1]=a,P[5]=u,P[9]=l,P[13]=f,P[2]=g,P[6]=y,P[10]=S,P[14]=b,P[3]=A,P[7]=I,P[11]=D,P[15]=L,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new As().fromArray(this.elements)}copy(e){const n=this.elements,i=e.elements;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],n[9]=i[9],n[10]=i[10],n[11]=i[11],n[12]=i[12],n[13]=i[13],n[14]=i[14],n[15]=i[15],this}copyPosition(e){const n=this.elements,i=e.elements;return n[12]=i[12],n[13]=i[13],n[14]=i[14],this}setFromMatrix3(e){const n=e.elements;return this.set(n[0],n[3],n[6],0,n[1],n[4],n[7],0,n[2],n[5],n[8],0,0,0,0,1),this}extractBasis(e,n,i){return e.setFromMatrixColumn(this,0),n.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,n,i){return this.set(e.x,n.x,i.x,0,e.y,n.y,i.y,0,e.z,n.z,i.z,0,0,0,0,1),this}extractRotation(e){const n=this.elements,i=e.elements,r=1/Ig.setFromMatrixColumn(e,0).length(),a=1/Ig.setFromMatrixColumn(e,1).length(),u=1/Ig.setFromMatrixColumn(e,2).length();return n[0]=i[0]*r,n[1]=i[1]*r,n[2]=i[2]*r,n[3]=0,n[4]=i[4]*a,n[5]=i[5]*a,n[6]=i[6]*a,n[7]=0,n[8]=i[8]*u,n[9]=i[9]*u,n[10]=i[10]*u,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromEuler(e){const n=this.elements,i=e.x,r=e.y,a=e.z,u=Math.cos(i),l=Math.sin(i),f=Math.cos(r),g=Math.sin(r),y=Math.cos(a),S=Math.sin(a);if(e.order==="XYZ"){const b=u*y,A=u*S,I=l*y,D=l*S;n[0]=f*y,n[4]=-f*S,n[8]=g,n[1]=A+I*g,n[5]=b-D*g,n[9]=-l*f,n[2]=D-b*g,n[6]=I+A*g,n[10]=u*f}else if(e.order==="YXZ"){const b=f*y,A=f*S,I=g*y,D=g*S;n[0]=b+D*l,n[4]=I*l-A,n[8]=u*g,n[1]=u*S,n[5]=u*y,n[9]=-l,n[2]=A*l-I,n[6]=D+b*l,n[10]=u*f}else if(e.order==="ZXY"){const b=f*y,A=f*S,I=g*y,D=g*S;n[0]=b-D*l,n[4]=-u*S,n[8]=I+A*l,n[1]=A+I*l,n[5]=u*y,n[9]=D-b*l,n[2]=-u*g,n[6]=l,n[10]=u*f}else if(e.order==="ZYX"){const b=u*y,A=u*S,I=l*y,D=l*S;n[0]=f*y,n[4]=I*g-A,n[8]=b*g+D,n[1]=f*S,n[5]=D*g+b,n[9]=A*g-I,n[2]=-g,n[6]=l*f,n[10]=u*f}else if(e.order==="YZX"){const b=u*f,A=u*g,I=l*f,D=l*g;n[0]=f*y,n[4]=D-b*S,n[8]=I*S+A,n[1]=S,n[5]=u*y,n[9]=-l*y,n[2]=-g*y,n[6]=A*S+I,n[10]=b-D*S}else if(e.order==="XZY"){const b=u*f,A=u*g,I=l*f,D=l*g;n[0]=f*y,n[4]=-S,n[8]=g*y,n[1]=b*S+D,n[5]=u*y,n[9]=A*S-I,n[2]=I*S-A,n[6]=l*y,n[10]=D*S+b}return n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Kj,e,Jj)}lookAt(e,n,i){const r=this.elements;return Ba.subVectors(e,n),Ba.lengthSq()===0&&(Ba.z=1),Ba.normalize(),Md.crossVectors(i,Ba),Md.lengthSq()===0&&(Math.abs(i.z)===1?Ba.x+=1e-4:Ba.z+=1e-4,Ba.normalize(),Md.crossVectors(i,Ba)),Md.normalize(),_b.crossVectors(Ba,Md),r[0]=Md.x,r[4]=_b.x,r[8]=Ba.x,r[1]=Md.y,r[5]=_b.y,r[9]=Ba.y,r[2]=Md.z,r[6]=_b.z,r[10]=Ba.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const i=e.elements,r=n.elements,a=this.elements,u=i[0],l=i[4],f=i[8],g=i[12],y=i[1],S=i[5],b=i[9],A=i[13],I=i[2],D=i[6],L=i[10],P=i[14],N=i[3],B=i[7],$=i[11],K=i[15],q=r[0],W=r[4],ie=r[8],Z=r[12],X=r[1],se=r[5],De=r[9],Se=r[13],Me=r[2],Ye=r[6],ye=r[10],Ce=r[14],ge=r[3],Be=r[7],Ze=r[11],je=r[15];return a[0]=u*q+l*X+f*Me+g*ge,a[4]=u*W+l*se+f*Ye+g*Be,a[8]=u*ie+l*De+f*ye+g*Ze,a[12]=u*Z+l*Se+f*Ce+g*je,a[1]=y*q+S*X+b*Me+A*ge,a[5]=y*W+S*se+b*Ye+A*Be,a[9]=y*ie+S*De+b*ye+A*Ze,a[13]=y*Z+S*Se+b*Ce+A*je,a[2]=I*q+D*X+L*Me+P*ge,a[6]=I*W+D*se+L*Ye+P*Be,a[10]=I*ie+D*De+L*ye+P*Ze,a[14]=I*Z+D*Se+L*Ce+P*je,a[3]=N*q+B*X+$*Me+K*ge,a[7]=N*W+B*se+$*Ye+K*Be,a[11]=N*ie+B*De+$*ye+K*Ze,a[15]=N*Z+B*Se+$*Ce+K*je,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[4]*=e,n[8]*=e,n[12]*=e,n[1]*=e,n[5]*=e,n[9]*=e,n[13]*=e,n[2]*=e,n[6]*=e,n[10]*=e,n[14]*=e,n[3]*=e,n[7]*=e,n[11]*=e,n[15]*=e,this}determinant(){const e=this.elements,n=e[0],i=e[4],r=e[8],a=e[12],u=e[1],l=e[5],f=e[9],g=e[13],y=e[2],S=e[6],b=e[10],A=e[14],I=e[3],D=e[7],L=e[11],P=e[15];return I*(+a*f*S-r*g*S-a*l*b+i*g*b+r*l*A-i*f*A)+D*(+n*f*A-n*g*b+a*u*b-r*u*A+r*g*y-a*f*y)+L*(+n*g*S-n*l*A-a*u*S+i*u*A+a*l*y-i*g*y)+P*(-r*l*y-n*f*S+n*l*b+r*u*S-i*u*b+i*f*y)}transpose(){const e=this.elements;let n;return n=e[1],e[1]=e[4],e[4]=n,n=e[2],e[2]=e[8],e[8]=n,n=e[6],e[6]=e[9],e[9]=n,n=e[3],e[3]=e[12],e[12]=n,n=e[7],e[7]=e[13],e[13]=n,n=e[11],e[11]=e[14],e[14]=n,this}setPosition(e,n,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=n,r[14]=i),this}invert(){const e=this.elements,n=e[0],i=e[1],r=e[2],a=e[3],u=e[4],l=e[5],f=e[6],g=e[7],y=e[8],S=e[9],b=e[10],A=e[11],I=e[12],D=e[13],L=e[14],P=e[15],N=S*L*g-D*b*g+D*f*A-l*L*A-S*f*P+l*b*P,B=I*b*g-y*L*g-I*f*A+u*L*A+y*f*P-u*b*P,$=y*D*g-I*S*g+I*l*A-u*D*A-y*l*P+u*S*P,K=I*S*f-y*D*f-I*l*b+u*D*b+y*l*L-u*S*L,q=n*N+i*B+r*$+a*K;if(q===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const W=1/q;return e[0]=N*W,e[1]=(D*b*a-S*L*a-D*r*A+i*L*A+S*r*P-i*b*P)*W,e[2]=(l*L*a-D*f*a+D*r*g-i*L*g-l*r*P+i*f*P)*W,e[3]=(S*f*a-l*b*a-S*r*g+i*b*g+l*r*A-i*f*A)*W,e[4]=B*W,e[5]=(y*L*a-I*b*a+I*r*A-n*L*A-y*r*P+n*b*P)*W,e[6]=(I*f*a-u*L*a-I*r*g+n*L*g+u*r*P-n*f*P)*W,e[7]=(u*b*a-y*f*a+y*r*g-n*b*g-u*r*A+n*f*A)*W,e[8]=$*W,e[9]=(I*S*a-y*D*a-I*i*A+n*D*A+y*i*P-n*S*P)*W,e[10]=(u*D*a-I*l*a+I*i*g-n*D*g-u*i*P+n*l*P)*W,e[11]=(y*l*a-u*S*a-y*i*g+n*S*g+u*i*A-n*l*A)*W,e[12]=K*W,e[13]=(y*D*r-I*S*r+I*i*b-n*D*b-y*i*L+n*S*L)*W,e[14]=(I*l*r-u*D*r-I*i*f+n*D*f+u*i*L-n*l*L)*W,e[15]=(u*S*r-y*l*r+y*i*f-n*S*f-u*i*b+n*l*b)*W,this}scale(e){const n=this.elements,i=e.x,r=e.y,a=e.z;return n[0]*=i,n[4]*=r,n[8]*=a,n[1]*=i,n[5]*=r,n[9]*=a,n[2]*=i,n[6]*=r,n[10]*=a,n[3]*=i,n[7]*=r,n[11]*=a,this}getMaxScaleOnAxis(){const e=this.elements,n=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(n,i,r))}makeTranslation(e,n,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,n,0,0,1,i,0,0,0,1),this}makeRotationX(e){const n=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,n,-i,0,0,i,n,0,0,0,0,1),this}makeRotationY(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,0,i,0,0,1,0,0,-i,0,n,0,0,0,0,1),this}makeRotationZ(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,-i,0,0,i,n,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,n){const i=Math.cos(n),r=Math.sin(n),a=1-i,u=e.x,l=e.y,f=e.z,g=a*u,y=a*l;return this.set(g*u+i,g*l-r*f,g*f+r*l,0,g*l+r*f,y*l+i,y*f-r*u,0,g*f-r*l,y*f+r*u,a*f*f+i,0,0,0,0,1),this}makeScale(e,n,i){return this.set(e,0,0,0,0,n,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,n,i,r,a,u){return this.set(1,i,a,0,e,1,u,0,n,r,1,0,0,0,0,1),this}compose(e,n,i){const r=this.elements,a=n._x,u=n._y,l=n._z,f=n._w,g=a+a,y=u+u,S=l+l,b=a*g,A=a*y,I=a*S,D=u*y,L=u*S,P=l*S,N=f*g,B=f*y,$=f*S,K=i.x,q=i.y,W=i.z;return r[0]=(1-(D+P))*K,r[1]=(A+$)*K,r[2]=(I-B)*K,r[3]=0,r[4]=(A-$)*q,r[5]=(1-(b+P))*q,r[6]=(L+N)*q,r[7]=0,r[8]=(I+B)*W,r[9]=(L-N)*W,r[10]=(1-(b+D))*W,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,n,i){const r=this.elements;let a=Ig.set(r[0],r[1],r[2]).length();const u=Ig.set(r[4],r[5],r[6]).length(),l=Ig.set(r[8],r[9],r[10]).length();this.determinant()<0&&(a=-a),e.x=r[12],e.y=r[13],e.z=r[14],hc.copy(this);const g=1/a,y=1/u,S=1/l;return hc.elements[0]*=g,hc.elements[1]*=g,hc.elements[2]*=g,hc.elements[4]*=y,hc.elements[5]*=y,hc.elements[6]*=y,hc.elements[8]*=S,hc.elements[9]*=S,hc.elements[10]*=S,n.setFromRotationMatrix(hc),i.x=a,i.y=u,i.z=l,this}makePerspective(e,n,i,r,a,u,l=Cy){const f=this.elements,g=2*a/(n-e),y=2*a/(i-r),S=(n+e)/(n-e),b=(i+r)/(i-r);let A,I;if(l===Cy)A=-(u+a)/(u-a),I=-2*u*a/(u-a);else if(l===XD)A=-u/(u-a),I=-u*a/(u-a);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+l);return f[0]=g,f[4]=0,f[8]=S,f[12]=0,f[1]=0,f[5]=y,f[9]=b,f[13]=0,f[2]=0,f[6]=0,f[10]=A,f[14]=I,f[3]=0,f[7]=0,f[11]=-1,f[15]=0,this}makeOrthographic(e,n,i,r,a,u,l=Cy){const f=this.elements,g=1/(n-e),y=1/(i-r),S=1/(u-a),b=(n+e)*g,A=(i+r)*y;let I,D;if(l===Cy)I=(u+a)*S,D=-2*S;else if(l===XD)I=a*S,D=-1*S;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+l);return f[0]=2*g,f[4]=0,f[8]=0,f[12]=-b,f[1]=0,f[5]=2*y,f[9]=0,f[13]=-A,f[2]=0,f[6]=0,f[10]=D,f[14]=-I,f[3]=0,f[7]=0,f[11]=0,f[15]=1,this}equals(e){const n=this.elements,i=e.elements;for(let r=0;r<16;r++)if(n[r]!==i[r])return!1;return!0}fromArray(e,n=0){for(let i=0;i<16;i++)this.elements[i]=e[i+n];return this}toArray(e=[],n=0){const i=this.elements;return e[n]=i[0],e[n+1]=i[1],e[n+2]=i[2],e[n+3]=i[3],e[n+4]=i[4],e[n+5]=i[5],e[n+6]=i[6],e[n+7]=i[7],e[n+8]=i[8],e[n+9]=i[9],e[n+10]=i[10],e[n+11]=i[11],e[n+12]=i[12],e[n+13]=i[13],e[n+14]=i[14],e[n+15]=i[15],e}}const Ig=new Lt,hc=new As,Kj=new Lt(0,0,0),Jj=new Lt(1,1,1),Md=new Lt,_b=new Lt,Ba=new Lt,nO=new As,iO=new Cg;class lp{constructor(e=0,n=0,i=0,r=lp.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=n,this._z=i,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,n,i,r=this._order){return this._x=e,this._y=n,this._z=i,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,n=this._order,i=!0){const r=e.elements,a=r[0],u=r[4],l=r[8],f=r[1],g=r[5],y=r[9],S=r[2],b=r[6],A=r[10];switch(n){case"XYZ":this._y=Math.asin(Wo(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-y,A),this._z=Math.atan2(-u,a)):(this._x=Math.atan2(b,g),this._z=0);break;case"YXZ":this._x=Math.asin(-Wo(y,-1,1)),Math.abs(y)<.9999999?(this._y=Math.atan2(l,A),this._z=Math.atan2(f,g)):(this._y=Math.atan2(-S,a),this._z=0);break;case"ZXY":this._x=Math.asin(Wo(b,-1,1)),Math.abs(b)<.9999999?(this._y=Math.atan2(-S,A),this._z=Math.atan2(-u,g)):(this._y=0,this._z=Math.atan2(f,a));break;case"ZYX":this._y=Math.asin(-Wo(S,-1,1)),Math.abs(S)<.9999999?(this._x=Math.atan2(b,A),this._z=Math.atan2(f,a)):(this._x=0,this._z=Math.atan2(-u,g));break;case"YZX":this._z=Math.asin(Wo(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(-y,g),this._y=Math.atan2(-S,a)):(this._x=0,this._y=Math.atan2(l,A));break;case"XZY":this._z=Math.asin(-Wo(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(b,g),this._y=Math.atan2(l,a)):(this._x=Math.atan2(-y,A),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,n,i){return nO.makeRotationFromQuaternion(e),this.setFromRotationMatrix(nO,n,i)}setFromVector3(e,n=this._order){return this.set(e.x,e.y,e.z,n)}reorder(e){return iO.setFromEuler(this),this.setFromQuaternion(iO,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}lp.DEFAULT_ORDER="XYZ";class Qj{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let eq=0;const rO=new Lt,Rg=new Cg,sh=new As,xb=new Lt,Ly=new Lt,tq=new Lt,nq=new Cg,sO=new Lt(1,0,0),oO=new Lt(0,1,0),aO=new Lt(0,0,1),lO={type:"added"},iq={type:"removed"},Lg={type:"childadded",child:null},nT={type:"childremoved",child:null};class fa extends hb{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:eq++}),this.uuid=wg(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=fa.DEFAULT_UP.clone();const e=new Lt,n=new lp,i=new Cg,r=new Lt(1,1,1);function a(){i.setFromEuler(n,!1)}function u(){n.setFromQuaternion(i,void 0,!1)}n._onChange(a),i._onChange(u),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new As},normalMatrix:{value:new xd}}),this.matrix=new As,this.matrixWorld=new As,this.matrixAutoUpdate=fa.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=fa.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Qj,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,n){this.quaternion.setFromAxisAngle(e,n)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,n){return Rg.setFromAxisAngle(e,n),this.quaternion.multiply(Rg),this}rotateOnWorldAxis(e,n){return Rg.setFromAxisAngle(e,n),this.quaternion.premultiply(Rg),this}rotateX(e){return this.rotateOnAxis(sO,e)}rotateY(e){return this.rotateOnAxis(oO,e)}rotateZ(e){return this.rotateOnAxis(aO,e)}translateOnAxis(e,n){return rO.copy(e).applyQuaternion(this.quaternion),this.position.add(rO.multiplyScalar(n)),this}translateX(e){return this.translateOnAxis(sO,e)}translateY(e){return this.translateOnAxis(oO,e)}translateZ(e){return this.translateOnAxis(aO,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(sh.copy(this.matrixWorld).invert())}lookAt(e,n,i){e.isVector3?xb.copy(e):xb.set(e,n,i);const r=this.parent;this.updateWorldMatrix(!0,!1),Ly.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?sh.lookAt(Ly,xb,this.up):sh.lookAt(xb,Ly,this.up),this.quaternion.setFromRotationMatrix(sh),r&&(sh.extractRotation(r.matrixWorld),Rg.setFromRotationMatrix(sh),this.quaternion.premultiply(Rg.invert()))}add(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(lO),Lg.child=e,this.dispatchEvent(Lg),Lg.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const n=this.children.indexOf(e);return n!==-1&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(iq),nT.child=e,this.dispatchEvent(nT),nT.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),sh.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),sh.multiply(e.parent.matrixWorld)),e.applyMatrix4(sh),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(lO),Lg.child=e,this.dispatchEvent(Lg),Lg.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,n){if(this[e]===n)return this;for(let i=0,r=this.children.length;i<r;i++){const u=this.children[i].getObjectByProperty(e,n);if(u!==void 0)return u}}getObjectsByProperty(e,n,i=[]){this[e]===n&&i.push(this);const r=this.children;for(let a=0,u=r.length;a<u;a++)r[a].getObjectsByProperty(e,n,i);return i}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ly,e,tq),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ly,nq,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return e.set(n[8],n[9],n[10]).normalize()}raycast(){}traverse(e){e(this);const n=this.children;for(let i=0,r=n.length;i<r;i++)n[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const n=this.children;for(let i=0,r=n.length;i<r;i++)n[i].traverseVisible(e)}traverseAncestors(e){const n=this.parent;n!==null&&(e(n),n.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const n=this.children;for(let i=0,r=n.length;i<r;i++){const a=n[i];(a.matrixWorldAutoUpdate===!0||e===!0)&&a.updateMatrixWorld(e)}}updateWorldMatrix(e,n){const i=this.parent;if(e===!0&&i!==null&&i.matrixWorldAutoUpdate===!0&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),n===!0){const r=this.children;for(let a=0,u=r.length;a<u;a++){const l=r[a];l.matrixWorldAutoUpdate===!0&&l.updateWorldMatrix(!1,!0)}}}toJSON(e){const n=e===void 0||typeof e=="string",i={};n&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.visibility=this._visibility,r.active=this._active,r.bounds=this._bounds.map(l=>({boxInitialized:l.boxInitialized,boxMin:l.box.min.toArray(),boxMax:l.box.max.toArray(),sphereInitialized:l.sphereInitialized,sphereRadius:l.sphere.radius,sphereCenter:l.sphere.center.toArray()})),r.maxGeometryCount=this._maxGeometryCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.geometryCount=this._geometryCount,r.matricesTexture=this._matricesTexture.toJSON(e),this._colorsTexture!==null&&(r.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(r.boundingSphere={center:r.boundingSphere.center.toArray(),radius:r.boundingSphere.radius}),this.boundingBox!==null&&(r.boundingBox={min:r.boundingBox.min.toArray(),max:r.boundingBox.max.toArray()}));function a(l,f){return l[f.uuid]===void 0&&(l[f.uuid]=f.toJSON(e)),f.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=a(e.geometries,this.geometry);const l=this.geometry.parameters;if(l!==void 0&&l.shapes!==void 0){const f=l.shapes;if(Array.isArray(f))for(let g=0,y=f.length;g<y;g++){const S=f[g];a(e.shapes,S)}else a(e.shapes,f)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(a(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const l=[];for(let f=0,g=this.material.length;f<g;f++)l.push(a(e.materials,this.material[f]));r.material=l}else r.material=a(e.materials,this.material);if(this.children.length>0){r.children=[];for(let l=0;l<this.children.length;l++)r.children.push(this.children[l].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let l=0;l<this.animations.length;l++){const f=this.animations[l];r.animations.push(a(e.animations,f))}}if(n){const l=u(e.geometries),f=u(e.materials),g=u(e.textures),y=u(e.images),S=u(e.shapes),b=u(e.skeletons),A=u(e.animations),I=u(e.nodes);l.length>0&&(i.geometries=l),f.length>0&&(i.materials=f),g.length>0&&(i.textures=g),y.length>0&&(i.images=y),S.length>0&&(i.shapes=S),b.length>0&&(i.skeletons=b),A.length>0&&(i.animations=A),I.length>0&&(i.nodes=I)}return i.object=r,i;function u(l){const f=[];for(const g in l){const y=l[g];delete y.metadata,f.push(y)}return f}}clone(e){return new this.constructor().copy(this,e)}copy(e,n=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),n===!0)for(let i=0;i<e.children.length;i++){const r=e.children[i];this.add(r.clone())}return this}}fa.DEFAULT_UP=new Lt(0,1,0),fa.DEFAULT_MATRIX_AUTO_UPDATE=!0,fa.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const dc=new Lt,oh=new Lt,iT=new Lt,ah=new Lt,kg=new Lt,Dg=new Lt,cO=new Lt,rT=new Lt,sT=new Lt,oT=new Lt;class tu{constructor(e=new Lt,n=new Lt,i=new Lt){this.a=e,this.b=n,this.c=i}static getNormal(e,n,i,r){r.subVectors(i,n),dc.subVectors(e,n),r.cross(dc);const a=r.lengthSq();return a>0?r.multiplyScalar(1/Math.sqrt(a)):r.set(0,0,0)}static getBarycoord(e,n,i,r,a){dc.subVectors(r,n),oh.subVectors(i,n),iT.subVectors(e,n);const u=dc.dot(dc),l=dc.dot(oh),f=dc.dot(iT),g=oh.dot(oh),y=oh.dot(iT),S=u*g-l*l;if(S===0)return a.set(0,0,0),null;const b=1/S,A=(g*f-l*y)*b,I=(u*y-l*f)*b;return a.set(1-A-I,I,A)}static containsPoint(e,n,i,r){return this.getBarycoord(e,n,i,r,ah)===null?!1:ah.x>=0&&ah.y>=0&&ah.x+ah.y<=1}static getInterpolation(e,n,i,r,a,u,l,f){return this.getBarycoord(e,n,i,r,ah)===null?(f.x=0,f.y=0,"z"in f&&(f.z=0),"w"in f&&(f.w=0),null):(f.setScalar(0),f.addScaledVector(a,ah.x),f.addScaledVector(u,ah.y),f.addScaledVector(l,ah.z),f)}static isFrontFacing(e,n,i,r){return dc.subVectors(i,n),oh.subVectors(e,n),dc.cross(oh).dot(r)<0}set(e,n,i){return this.a.copy(e),this.b.copy(n),this.c.copy(i),this}setFromPointsAndIndices(e,n,i,r){return this.a.copy(e[n]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,n,i,r){return this.a.fromBufferAttribute(e,n),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return dc.subVectors(this.c,this.b),oh.subVectors(this.a,this.b),dc.cross(oh).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return tu.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,n){return tu.getBarycoord(e,this.a,this.b,this.c,n)}getInterpolation(e,n,i,r,a){return tu.getInterpolation(e,this.a,this.b,this.c,n,i,r,a)}containsPoint(e){return tu.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return tu.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,n){const i=this.a,r=this.b,a=this.c;let u,l;kg.subVectors(r,i),Dg.subVectors(a,i),rT.subVectors(e,i);const f=kg.dot(rT),g=Dg.dot(rT);if(f<=0&&g<=0)return n.copy(i);sT.subVectors(e,r);const y=kg.dot(sT),S=Dg.dot(sT);if(y>=0&&S<=y)return n.copy(r);const b=f*S-y*g;if(b<=0&&f>=0&&y<=0)return u=f/(f-y),n.copy(i).addScaledVector(kg,u);oT.subVectors(e,a);const A=kg.dot(oT),I=Dg.dot(oT);if(I>=0&&A<=I)return n.copy(a);const D=A*g-f*I;if(D<=0&&g>=0&&I<=0)return l=g/(g-I),n.copy(i).addScaledVector(Dg,l);const L=y*I-A*S;if(L<=0&&S-y>=0&&A-I>=0)return cO.subVectors(a,r),l=(S-y)/(S-y+(A-I)),n.copy(r).addScaledVector(cO,l);const P=1/(L+D+b);return u=D*P,l=b*P,n.copy(i).addScaledVector(kg,u).addScaledVector(Dg,l)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const uO={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Cd={h:0,s:0,l:0},bb={h:0,s:0,l:0};function aT(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*6*(2/3-n):t}class ky{constructor(e,n,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,n,i)}set(e,n,i){if(n===void 0&&i===void 0){const r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,n,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,n=_d){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,cc.toWorkingColorSpace(this,n),this}setRGB(e,n,i,r=cc.workingColorSpace){return this.r=e,this.g=n,this.b=i,cc.toWorkingColorSpace(this,r),this}setHSL(e,n,i,r=cc.workingColorSpace){if(e=WC(e,1),n=Wo(n,0,1),i=Wo(i,0,1),n===0)this.r=this.g=this.b=i;else{const a=i<=.5?i*(1+n):i+n-i*n,u=2*i-a;this.r=aT(u,a,e+1/3),this.g=aT(u,a,e),this.b=aT(u,a,e-1/3)}return cc.toWorkingColorSpace(this,r),this}setStyle(e,n=_d){function i(a){a!==void 0&&parseFloat(a)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let a;const u=r[1],l=r[2];switch(u){case"rgb":case"rgba":if(a=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return i(a[4]),this.setRGB(Math.min(255,parseInt(a[1],10))/255,Math.min(255,parseInt(a[2],10))/255,Math.min(255,parseInt(a[3],10))/255,n);if(a=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return i(a[4]),this.setRGB(Math.min(100,parseInt(a[1],10))/100,Math.min(100,parseInt(a[2],10))/100,Math.min(100,parseInt(a[3],10))/100,n);break;case"hsl":case"hsla":if(a=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return i(a[4]),this.setHSL(parseFloat(a[1])/360,parseFloat(a[2])/100,parseFloat(a[3])/100,n);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const a=r[1],u=a.length;if(u===3)return this.setRGB(parseInt(a.charAt(0),16)/15,parseInt(a.charAt(1),16)/15,parseInt(a.charAt(2),16)/15,n);if(u===6)return this.setHex(parseInt(a,16),n);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,n);return this}setColorName(e,n=_d){const i=uO[e.toLowerCase()];return i!==void 0?this.setHex(i,n):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Eg(e.r),this.g=Eg(e.g),this.b=Eg(e.b),this}copyLinearToSRGB(e){return this.r=qC(e.r),this.g=qC(e.g),this.b=qC(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=_d){return cc.fromWorkingColorSpace(Co.copy(this),e),Math.round(Wo(Co.r*255,0,255))*65536+Math.round(Wo(Co.g*255,0,255))*256+Math.round(Wo(Co.b*255,0,255))}getHexString(e=_d){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,n=cc.workingColorSpace){cc.fromWorkingColorSpace(Co.copy(this),n);const i=Co.r,r=Co.g,a=Co.b,u=Math.max(i,r,a),l=Math.min(i,r,a);let f,g;const y=(l+u)/2;if(l===u)f=0,g=0;else{const S=u-l;switch(g=y<=.5?S/(u+l):S/(2-u-l),u){case i:f=(r-a)/S+(r<a?6:0);break;case r:f=(a-i)/S+2;break;case a:f=(i-r)/S+4;break}f/=6}return e.h=f,e.s=g,e.l=y,e}getRGB(e,n=cc.workingColorSpace){return cc.fromWorkingColorSpace(Co.copy(this),n),e.r=Co.r,e.g=Co.g,e.b=Co.b,e}getStyle(e=_d){cc.fromWorkingColorSpace(Co.copy(this),e);const n=Co.r,i=Co.g,r=Co.b;return e!==_d?`color(${e} ${n.toFixed(3)} ${i.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(n*255)},${Math.round(i*255)},${Math.round(r*255)})`}offsetHSL(e,n,i){return this.getHSL(Cd),this.setHSL(Cd.h+e,Cd.s+n,Cd.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,n){return this.r=e.r+n.r,this.g=e.g+n.g,this.b=e.b+n.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,n){return this.r+=(e.r-this.r)*n,this.g+=(e.g-this.g)*n,this.b+=(e.b-this.b)*n,this}lerpColors(e,n,i){return this.r=e.r+(n.r-e.r)*i,this.g=e.g+(n.g-e.g)*i,this.b=e.b+(n.b-e.b)*i,this}lerpHSL(e,n){this.getHSL(Cd),e.getHSL(bb);const i=Ay(Cd.h,bb.h,n),r=Ay(Cd.s,bb.s,n),a=Ay(Cd.l,bb.l,n);return this.setHSL(i,r,a),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const n=this.r,i=this.g,r=this.b,a=e.elements;return this.r=a[0]*n+a[3]*i+a[6]*r,this.g=a[1]*n+a[4]*i+a[7]*r,this.b=a[2]*n+a[5]*i+a[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,n=0){return this.r=e[n],this.g=e[n+1],this.b=e[n+2],this}toArray(e=[],n=0){return e[n]=this.r,e[n+1]=this.g,e[n+2]=this.b,e}fromBufferAttribute(e,n){return this.r=e.getX(n),this.g=e.getY(n),this.b=e.getZ(n),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Co=new ky;ky.NAMES=uO;let rq=0;class hO extends hb{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:rq++}),this.uuid=wg(),this.name="",this.type="Material",this.blending=RD,this.side=VC,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=kD,this.blendDst=DD,this.blendEquation=LD,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new ky(0,0,0),this.blendAlpha=0,this.depthFunc=OD,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=jD,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=bg,this.stencilZFail=bg,this.stencilZPass=bg,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const n in e){const i=e[n];if(i===void 0){console.warn(`THREE.Material: parameter '${n}' has value of undefined.`);continue}const r=this[n];if(r===void 0){console.warn(`THREE.Material: '${n}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[n]=i}}toJSON(e){const n=e===void 0||typeof e=="string";n&&(e={textures:{},images:{}});const i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(i.dispersion=this.dispersion),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(i.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapRotation!==void 0&&(i.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==RD&&(i.blending=this.blending),this.side!==VC&&(i.side=this.side),this.vertexColors===!0&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=!0),this.blendSrc!==kD&&(i.blendSrc=this.blendSrc),this.blendDst!==DD&&(i.blendDst=this.blendDst),this.blendEquation!==LD&&(i.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(i.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(i.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(i.blendAlpha=this.blendAlpha),this.depthFunc!==OD&&(i.depthFunc=this.depthFunc),this.depthTest===!1&&(i.depthTest=this.depthTest),this.depthWrite===!1&&(i.depthWrite=this.depthWrite),this.colorWrite===!1&&(i.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(i.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==jD&&(i.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(i.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==bg&&(i.stencilFail=this.stencilFail),this.stencilZFail!==bg&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==bg&&(i.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(i.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaHash===!0&&(i.alphaHash=!0),this.alphaToCoverage===!0&&(i.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=!0),this.forceSinglePass===!0&&(i.forceSinglePass=!0),this.wireframe===!0&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=!0),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function r(a){const u=[];for(const l in a){const f=a[l];delete f.metadata,u.push(f)}return u}if(n){const a=r(e.textures),u=r(e.images);a.length>0&&(i.textures=a),u.length>0&&(i.images=u)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const n=e.clippingPlanes;let i=null;if(n!==null){const r=n.length;i=new Array(r);for(let a=0;a!==r;++a)i[a]=n[a].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class Dy extends hO{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new ky(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new lp,this.combine=vj,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const ds=new Lt,wb=new so;class Og{constructor(e,n,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=n,this.count=e!==void 0?e.length/n:0,this.normalized=i,this.usage=qD,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=wj,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return Gj("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,n){this.updateRanges.push({start:e,count:n})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,n,i){e*=this.itemSize,i*=n.itemSize;for(let r=0,a=this.itemSize;r<a;r++)this.array[e+r]=n.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let n=0,i=this.count;n<i;n++)wb.fromBufferAttribute(this,n),wb.applyMatrix3(e),this.setXY(n,wb.x,wb.y);else if(this.itemSize===3)for(let n=0,i=this.count;n<i;n++)ds.fromBufferAttribute(this,n),ds.applyMatrix3(e),this.setXYZ(n,ds.x,ds.y,ds.z);return this}applyMatrix4(e){for(let n=0,i=this.count;n<i;n++)ds.fromBufferAttribute(this,n),ds.applyMatrix4(e),this.setXYZ(n,ds.x,ds.y,ds.z);return this}applyNormalMatrix(e){for(let n=0,i=this.count;n<i;n++)ds.fromBufferAttribute(this,n),ds.applyNormalMatrix(e),this.setXYZ(n,ds.x,ds.y,ds.z);return this}transformDirection(e){for(let n=0,i=this.count;n<i;n++)ds.fromBufferAttribute(this,n),ds.transformDirection(e),this.setXYZ(n,ds.x,ds.y,ds.z);return this}set(e,n=0){return this.array.set(e,n),this}getComponent(e,n){let i=this.array[e*this.itemSize+n];return this.normalized&&(i=Sg(i,this.array)),i}setComponent(e,n,i){return this.normalized&&(i=jo(i,this.array)),this.array[e*this.itemSize+n]=i,this}getX(e){let n=this.array[e*this.itemSize];return this.normalized&&(n=Sg(n,this.array)),n}setX(e,n){return this.normalized&&(n=jo(n,this.array)),this.array[e*this.itemSize]=n,this}getY(e){let n=this.array[e*this.itemSize+1];return this.normalized&&(n=Sg(n,this.array)),n}setY(e,n){return this.normalized&&(n=jo(n,this.array)),this.array[e*this.itemSize+1]=n,this}getZ(e){let n=this.array[e*this.itemSize+2];return this.normalized&&(n=Sg(n,this.array)),n}setZ(e,n){return this.normalized&&(n=jo(n,this.array)),this.array[e*this.itemSize+2]=n,this}getW(e){let n=this.array[e*this.itemSize+3];return this.normalized&&(n=Sg(n,this.array)),n}setW(e,n){return this.normalized&&(n=jo(n,this.array)),this.array[e*this.itemSize+3]=n,this}setXY(e,n,i){return e*=this.itemSize,this.normalized&&(n=jo(n,this.array),i=jo(i,this.array)),this.array[e+0]=n,this.array[e+1]=i,this}setXYZ(e,n,i,r){return e*=this.itemSize,this.normalized&&(n=jo(n,this.array),i=jo(i,this.array),r=jo(r,this.array)),this.array[e+0]=n,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,n,i,r,a){return e*=this.itemSize,this.normalized&&(n=jo(n,this.array),i=jo(i,this.array),r=jo(r,this.array),a=jo(a,this.array)),this.array[e+0]=n,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=a,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==qD&&(e.usage=this.usage),e}}class sq extends Og{constructor(e,n,i){super(new Uint16Array(e),n,i)}}class oq extends Og{constructor(e,n,i){super(new Uint32Array(e),n,i)}}class cp extends Og{constructor(e,n,i){super(new Float32Array(e),n,i)}}let aq=0;const Ml=new As,lT=new fa,Fg=new Lt,Ua=new Py,Oy=new Py,Gs=new Lt;class zg extends hb{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:aq++}),this.uuid=wg(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(Hj(e)?oq:sq)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,n){return this.attributes[e]=n,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,n,i=0){this.groups.push({start:e,count:n,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,n){this.drawRange.start=e,this.drawRange.count=n}applyMatrix4(e){const n=this.attributes.position;n!==void 0&&(n.applyMatrix4(e),n.needsUpdate=!0);const i=this.attributes.normal;if(i!==void 0){const a=new xd().getNormalMatrix(e);i.applyNormalMatrix(a),i.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Ml.makeRotationFromQuaternion(e),this.applyMatrix4(Ml),this}rotateX(e){return Ml.makeRotationX(e),this.applyMatrix4(Ml),this}rotateY(e){return Ml.makeRotationY(e),this.applyMatrix4(Ml),this}rotateZ(e){return Ml.makeRotationZ(e),this.applyMatrix4(Ml),this}translate(e,n,i){return Ml.makeTranslation(e,n,i),this.applyMatrix4(Ml),this}scale(e,n,i){return Ml.makeScale(e,n,i),this.applyMatrix4(Ml),this}lookAt(e){return lT.lookAt(e),lT.updateMatrix(),this.applyMatrix4(lT.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Fg).negate(),this.translate(Fg.x,Fg.y,Fg.z),this}setFromPoints(e){const n=[];for(let i=0,r=e.length;i<r;i++){const a=e[i];n.push(a.x,a.y,a.z||0)}return this.setAttribute("position",new cp(n,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Py);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new Lt(-1/0,-1/0,-1/0),new Lt(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),n)for(let i=0,r=n.length;i<r;i++){const a=n[i];Ua.setFromBufferAttribute(a),this.morphTargetsRelative?(Gs.addVectors(this.boundingBox.min,Ua.min),this.boundingBox.expandByPoint(Gs),Gs.addVectors(this.boundingBox.max,Ua.max),this.boundingBox.expandByPoint(Gs)):(this.boundingBox.expandByPoint(Ua.min),this.boundingBox.expandByPoint(Ua.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new JC);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new Lt,1/0);return}if(e){const i=this.boundingSphere.center;if(Ua.setFromBufferAttribute(e),n)for(let a=0,u=n.length;a<u;a++){const l=n[a];Oy.setFromBufferAttribute(l),this.morphTargetsRelative?(Gs.addVectors(Ua.min,Oy.min),Ua.expandByPoint(Gs),Gs.addVectors(Ua.max,Oy.max),Ua.expandByPoint(Gs)):(Ua.expandByPoint(Oy.min),Ua.expandByPoint(Oy.max))}Ua.getCenter(i);let r=0;for(let a=0,u=e.count;a<u;a++)Gs.fromBufferAttribute(e,a),r=Math.max(r,i.distanceToSquared(Gs));if(n)for(let a=0,u=n.length;a<u;a++){const l=n[a],f=this.morphTargetsRelative;for(let g=0,y=l.count;g<y;g++)Gs.fromBufferAttribute(l,g),f&&(Fg.fromBufferAttribute(e,g),Gs.add(Fg)),r=Math.max(r,i.distanceToSquared(Gs))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,n=this.attributes;if(e===null||n.position===void 0||n.normal===void 0||n.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const i=n.position,r=n.normal,a=n.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Og(new Float32Array(4*i.count),4));const u=this.getAttribute("tangent"),l=[],f=[];for(let ie=0;ie<i.count;ie++)l[ie]=new Lt,f[ie]=new Lt;const g=new Lt,y=new Lt,S=new Lt,b=new so,A=new so,I=new so,D=new Lt,L=new Lt;function P(ie,Z,X){g.fromBufferAttribute(i,ie),y.fromBufferAttribute(i,Z),S.fromBufferAttribute(i,X),b.fromBufferAttribute(a,ie),A.fromBufferAttribute(a,Z),I.fromBufferAttribute(a,X),y.sub(g),S.sub(g),A.sub(b),I.sub(b);const se=1/(A.x*I.y-I.x*A.y);isFinite(se)&&(D.copy(y).multiplyScalar(I.y).addScaledVector(S,-A.y).multiplyScalar(se),L.copy(S).multiplyScalar(A.x).addScaledVector(y,-I.x).multiplyScalar(se),l[ie].add(D),l[Z].add(D),l[X].add(D),f[ie].add(L),f[Z].add(L),f[X].add(L))}let N=this.groups;N.length===0&&(N=[{start:0,count:e.count}]);for(let ie=0,Z=N.length;ie<Z;++ie){const X=N[ie],se=X.start,De=X.count;for(let Se=se,Me=se+De;Se<Me;Se+=3)P(e.getX(Se+0),e.getX(Se+1),e.getX(Se+2))}const B=new Lt,$=new Lt,K=new Lt,q=new Lt;function W(ie){K.fromBufferAttribute(r,ie),q.copy(K);const Z=l[ie];B.copy(Z),B.sub(K.multiplyScalar(K.dot(Z))).normalize(),$.crossVectors(q,Z);const se=$.dot(f[ie])<0?-1:1;u.setXYZW(ie,B.x,B.y,B.z,se)}for(let ie=0,Z=N.length;ie<Z;++ie){const X=N[ie],se=X.start,De=X.count;for(let Se=se,Me=se+De;Se<Me;Se+=3)W(e.getX(Se+0)),W(e.getX(Se+1)),W(e.getX(Se+2))}}computeVertexNormals(){const e=this.index,n=this.getAttribute("position");if(n!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new Og(new Float32Array(n.count*3),3),this.setAttribute("normal",i);else for(let b=0,A=i.count;b<A;b++)i.setXYZ(b,0,0,0);const r=new Lt,a=new Lt,u=new Lt,l=new Lt,f=new Lt,g=new Lt,y=new Lt,S=new Lt;if(e)for(let b=0,A=e.count;b<A;b+=3){const I=e.getX(b+0),D=e.getX(b+1),L=e.getX(b+2);r.fromBufferAttribute(n,I),a.fromBufferAttribute(n,D),u.fromBufferAttribute(n,L),y.subVectors(u,a),S.subVectors(r,a),y.cross(S),l.fromBufferAttribute(i,I),f.fromBufferAttribute(i,D),g.fromBufferAttribute(i,L),l.add(y),f.add(y),g.add(y),i.setXYZ(I,l.x,l.y,l.z),i.setXYZ(D,f.x,f.y,f.z),i.setXYZ(L,g.x,g.y,g.z)}else for(let b=0,A=n.count;b<A;b+=3)r.fromBufferAttribute(n,b+0),a.fromBufferAttribute(n,b+1),u.fromBufferAttribute(n,b+2),y.subVectors(u,a),S.subVectors(r,a),y.cross(S),i.setXYZ(b+0,y.x,y.y,y.z),i.setXYZ(b+1,y.x,y.y,y.z),i.setXYZ(b+2,y.x,y.y,y.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let n=0,i=e.count;n<i;n++)Gs.fromBufferAttribute(e,n),Gs.normalize(),e.setXYZ(n,Gs.x,Gs.y,Gs.z)}toNonIndexed(){function e(l,f){const g=l.array,y=l.itemSize,S=l.normalized,b=new g.constructor(f.length*y);let A=0,I=0;for(let D=0,L=f.length;D<L;D++){l.isInterleavedBufferAttribute?A=f[D]*l.data.stride+l.offset:A=f[D]*y;for(let P=0;P<y;P++)b[I++]=g[A++]}return new Og(b,y,S)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const n=new zg,i=this.index.array,r=this.attributes;for(const l in r){const f=r[l],g=e(f,i);n.setAttribute(l,g)}const a=this.morphAttributes;for(const l in a){const f=[],g=a[l];for(let y=0,S=g.length;y<S;y++){const b=g[y],A=e(b,i);f.push(A)}n.morphAttributes[l]=f}n.morphTargetsRelative=this.morphTargetsRelative;const u=this.groups;for(let l=0,f=u.length;l<f;l++){const g=u[l];n.addGroup(g.start,g.count,g.materialIndex)}return n}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const f=this.parameters;for(const g in f)f[g]!==void 0&&(e[g]=f[g]);return e}e.data={attributes:{}};const n=this.index;n!==null&&(e.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)});const i=this.attributes;for(const f in i){const g=i[f];e.data.attributes[f]=g.toJSON(e.data)}const r={};let a=!1;for(const f in this.morphAttributes){const g=this.morphAttributes[f],y=[];for(let S=0,b=g.length;S<b;S++){const A=g[S];y.push(A.toJSON(e.data))}y.length>0&&(r[f]=y,a=!0)}a&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const u=this.groups;u.length>0&&(e.data.groups=JSON.parse(JSON.stringify(u)));const l=this.boundingSphere;return l!==null&&(e.data.boundingSphere={center:l.center.toArray(),radius:l.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const n={};this.name=e.name;const i=e.index;i!==null&&this.setIndex(i.clone(n));const r=e.attributes;for(const g in r){const y=r[g];this.setAttribute(g,y.clone(n))}const a=e.morphAttributes;for(const g in a){const y=[],S=a[g];for(let b=0,A=S.length;b<A;b++)y.push(S[b].clone(n));this.morphAttributes[g]=y}this.morphTargetsRelative=e.morphTargetsRelative;const u=e.groups;for(let g=0,y=u.length;g<y;g++){const S=u[g];this.addGroup(S.start,S.count,S.materialIndex)}const l=e.boundingBox;l!==null&&(this.boundingBox=l.clone());const f=e.boundingSphere;return f!==null&&(this.boundingSphere=f.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const dO=new As,up=new tO,Sb=new JC,fO=new Lt,Ng=new Lt,Bg=new Lt,Ug=new Lt,cT=new Lt,Eb=new Lt,Mb=new so,Cb=new so,Tb=new so,pO=new Lt,mO=new Lt,gO=new Lt,Ab=new Lt,Pb=new Lt;class lq extends fa{constructor(e=new zg,n=new Dy){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=n,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){const r=n[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,u=r.length;a<u;a++){const l=r[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=a}}}}getVertexPosition(e,n){const i=this.geometry,r=i.attributes.position,a=i.morphAttributes.position,u=i.morphTargetsRelative;n.fromBufferAttribute(r,e);const l=this.morphTargetInfluences;if(a&&l){Eb.set(0,0,0);for(let f=0,g=a.length;f<g;f++){const y=l[f],S=a[f];y!==0&&(cT.fromBufferAttribute(S,e),u?Eb.addScaledVector(cT,y):Eb.addScaledVector(cT.sub(n),y))}n.add(Eb)}return n}raycast(e,n){const i=this.geometry,r=this.material,a=this.matrixWorld;r!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),Sb.copy(i.boundingSphere),Sb.applyMatrix4(a),up.copy(e.ray).recast(e.near),!(Sb.containsPoint(up.origin)===!1&&(up.intersectSphere(Sb,fO)===null||up.origin.distanceToSquared(fO)>(e.far-e.near)**2))&&(dO.copy(a).invert(),up.copy(e.ray).applyMatrix4(dO),!(i.boundingBox!==null&&up.intersectsBox(i.boundingBox)===!1)&&this._computeIntersections(e,n,up)))}_computeIntersections(e,n,i){let r;const a=this.geometry,u=this.material,l=a.index,f=a.attributes.position,g=a.attributes.uv,y=a.attributes.uv1,S=a.attributes.normal,b=a.groups,A=a.drawRange;if(l!==null)if(Array.isArray(u))for(let I=0,D=b.length;I<D;I++){const L=b[I],P=u[L.materialIndex],N=Math.max(L.start,A.start),B=Math.min(l.count,Math.min(L.start+L.count,A.start+A.count));for(let $=N,K=B;$<K;$+=3){const q=l.getX($),W=l.getX($+1),ie=l.getX($+2);r=Ib(this,P,e,i,g,y,S,q,W,ie),r&&(r.faceIndex=Math.floor($/3),r.face.materialIndex=L.materialIndex,n.push(r))}}else{const I=Math.max(0,A.start),D=Math.min(l.count,A.start+A.count);for(let L=I,P=D;L<P;L+=3){const N=l.getX(L),B=l.getX(L+1),$=l.getX(L+2);r=Ib(this,u,e,i,g,y,S,N,B,$),r&&(r.faceIndex=Math.floor(L/3),n.push(r))}}else if(f!==void 0)if(Array.isArray(u))for(let I=0,D=b.length;I<D;I++){const L=b[I],P=u[L.materialIndex],N=Math.max(L.start,A.start),B=Math.min(f.count,Math.min(L.start+L.count,A.start+A.count));for(let $=N,K=B;$<K;$+=3){const q=$,W=$+1,ie=$+2;r=Ib(this,P,e,i,g,y,S,q,W,ie),r&&(r.faceIndex=Math.floor($/3),r.face.materialIndex=L.materialIndex,n.push(r))}}else{const I=Math.max(0,A.start),D=Math.min(f.count,A.start+A.count);for(let L=I,P=D;L<P;L+=3){const N=L,B=L+1,$=L+2;r=Ib(this,u,e,i,g,y,S,N,B,$),r&&(r.faceIndex=Math.floor(L/3),n.push(r))}}}}function cq(t,e,n,i,r,a,u,l){let f;if(e.side===gj?f=i.intersectTriangle(u,a,r,!0,l):f=i.intersectTriangle(r,a,u,e.side===VC,l),f===null)return null;Pb.copy(l),Pb.applyMatrix4(t.matrixWorld);const g=n.ray.origin.distanceTo(Pb);return g<n.near||g>n.far?null:{distance:g,point:Pb.clone(),object:t}}function Ib(t,e,n,i,r,a,u,l,f,g){t.getVertexPosition(l,Ng),t.getVertexPosition(f,Bg),t.getVertexPosition(g,Ug);const y=cq(t,e,n,i,Ng,Bg,Ug,Ab);if(y){r&&(Mb.fromBufferAttribute(r,l),Cb.fromBufferAttribute(r,f),Tb.fromBufferAttribute(r,g),y.uv=tu.getInterpolation(Ab,Ng,Bg,Ug,Mb,Cb,Tb,new so)),a&&(Mb.fromBufferAttribute(a,l),Cb.fromBufferAttribute(a,f),Tb.fromBufferAttribute(a,g),y.uv1=tu.getInterpolation(Ab,Ng,Bg,Ug,Mb,Cb,Tb,new so)),u&&(pO.fromBufferAttribute(u,l),mO.fromBufferAttribute(u,f),gO.fromBufferAttribute(u,g),y.normal=tu.getInterpolation(Ab,Ng,Bg,Ug,pO,mO,gO,new Lt),y.normal.dot(i.direction)>0&&y.normal.multiplyScalar(-1));const S={a:l,b:f,c:g,normal:new Lt,materialIndex:0};tu.getNormal(Ng,Bg,Ug,S.normal),y.face=S}return y}class uq extends fa{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new As,this.projectionMatrix=new As,this.projectionMatrixInverse=new As,this.coordinateSystem=Cy}copy(e,n){return super.copy(e,n),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,n){super.updateWorldMatrix(e,n),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const Td=new Lt,vO=new so,yO=new so;class hq extends uq{constructor(e=50,n=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=n,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const n=.5*this.getFilmHeight()/e;this.fov=db*2*Math.atan(n),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(Ty*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return db*2*Math.atan(Math.tan(Ty*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,n,i){Td.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(Td.x,Td.y).multiplyScalar(-e/Td.z),Td.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),i.set(Td.x,Td.y).multiplyScalar(-e/Td.z)}getViewSize(e,n){return this.getViewBounds(e,vO,yO),n.subVectors(yO,vO)}setViewOffset(e,n,i,r,a,u){this.aspect=e/n,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=i,this.view.offsetY=r,this.view.width=a,this.view.height=u,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let n=e*Math.tan(Ty*.5*this.fov)/this.zoom,i=2*n,r=this.aspect*i,a=-.5*r;const u=this.view;if(this.view!==null&&this.view.enabled){const f=u.fullWidth,g=u.fullHeight;a+=u.offsetX*r/f,n-=u.offsetY*i/g,r*=u.width/f,i*=u.height/g}const l=this.filmOffset;l!==0&&(a+=e*l/this.getFilmWidth()),this.projectionMatrix.makePerspective(a,a+r,n,n-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.fov=this.fov,n.object.zoom=this.zoom,n.object.near=this.near,n.object.far=this.far,n.object.focus=this.focus,n.object.aspect=this.aspect,this.view!==null&&(n.object.view=Object.assign({},this.view)),n.object.filmGauge=this.filmGauge,n.object.filmOffset=this.filmOffset,n}}class dq extends bd{constructor(e,n,i,r,a,u,l,f,g,y=$C){if(y!==$C&&y!==UD)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&y===$C&&(i=bj),i===void 0&&y===UD&&(i=Sj),super(null,r,a,u,l,f,y,i,g),this.isDepthTexture=!0,this.image={width:e,height:n},this.magFilter=l!==void 0?l:BD,this.minFilter=f!==void 0?f:BD,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const n=super.toJSON(e);return this.compareFunction!==null&&(n.compareFunction=this.compareFunction),n}}const fq=new dq(1,1);fq.compareFunction=Cj;class pq extends fa{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new lp,this.environmentIntensity=1,this.environmentRotation=new lp,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,n){return super.copy(e,n),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const n=super.toJSON(e);return this.fog!==null&&(n.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(n.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(n.object.backgroundIntensity=this.backgroundIntensity),n.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(n.object.environmentIntensity=this.environmentIntensity),n.object.environmentRotation=this.environmentRotation.toArray(),n}}class mq extends hO{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new ky(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const Rb=new Lt,Lb=new Lt,_O=new As,Fy=new tO,kb=new JC,uT=new Lt,xO=new Lt;class gq extends fa{constructor(e=new zg,n=new mq){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=n,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const n=e.attributes.position,i=[0];for(let r=1,a=n.count;r<a;r++)Rb.fromBufferAttribute(n,r-1),Lb.fromBufferAttribute(n,r),i[r]=i[r-1],i[r]+=Rb.distanceTo(Lb);e.setAttribute("lineDistance",new cp(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,n){const i=this.geometry,r=this.matrixWorld,a=e.params.Line.threshold,u=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),kb.copy(i.boundingSphere),kb.applyMatrix4(r),kb.radius+=a,e.ray.intersectsSphere(kb)===!1)return;_O.copy(r).invert(),Fy.copy(e.ray).applyMatrix4(_O);const l=a/((this.scale.x+this.scale.y+this.scale.z)/3),f=l*l,g=this.isLineSegments?2:1,y=i.index,b=i.attributes.position;if(y!==null){const A=Math.max(0,u.start),I=Math.min(y.count,u.start+u.count);for(let D=A,L=I-1;D<L;D+=g){const P=y.getX(D),N=y.getX(D+1),B=Db(this,e,Fy,f,P,N);B&&n.push(B)}if(this.isLineLoop){const D=y.getX(I-1),L=y.getX(A),P=Db(this,e,Fy,f,D,L);P&&n.push(P)}}else{const A=Math.max(0,u.start),I=Math.min(b.count,u.start+u.count);for(let D=A,L=I-1;D<L;D+=g){const P=Db(this,e,Fy,f,D,D+1);P&&n.push(P)}if(this.isLineLoop){const D=Db(this,e,Fy,f,I-1,A);D&&n.push(D)}}}updateMorphTargets(){const n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){const r=n[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,u=r.length;a<u;a++){const l=r[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=a}}}}}function Db(t,e,n,i,r,a){const u=t.geometry.attributes.position;if(Rb.fromBufferAttribute(u,r),Lb.fromBufferAttribute(u,a),n.distanceSqToSegment(Rb,Lb,uT,xO)>i)return;uT.applyMatrix4(t.matrixWorld);const f=e.ray.origin.distanceTo(uT);if(!(f<e.near||f>e.far))return{distance:f,point:xO.clone().applyMatrix4(t.matrixWorld),index:r,face:null,faceIndex:null,object:t}}const bO=new Lt,wO=new Lt;class vq extends gq{constructor(e,n){super(e,n),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const n=e.attributes.position,i=[];for(let r=0,a=n.count;r<a;r+=2)bO.fromBufferAttribute(n,r),wO.fromBufferAttribute(n,r+1),i[r]=r===0?0:i[r-1],i[r+1]=i[r]+bO.distanceTo(wO);e.setAttribute("lineDistance",new cp(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class hT extends zg{constructor(e=1,n=32,i=16,r=0,a=Math.PI*2,u=0,l=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:n,heightSegments:i,phiStart:r,phiLength:a,thetaStart:u,thetaLength:l},n=Math.max(3,Math.floor(n)),i=Math.max(2,Math.floor(i));const f=Math.min(u+l,Math.PI);let g=0;const y=[],S=new Lt,b=new Lt,A=[],I=[],D=[],L=[];for(let P=0;P<=i;P++){const N=[],B=P/i;let $=0;P===0&&u===0?$=.5/n:P===i&&f===Math.PI&&($=-.5/n);for(let K=0;K<=n;K++){const q=K/n;S.x=-e*Math.cos(r+q*a)*Math.sin(u+B*l),S.y=e*Math.cos(u+B*l),S.z=e*Math.sin(r+q*a)*Math.sin(u+B*l),I.push(S.x,S.y,S.z),b.copy(S).normalize(),D.push(b.x,b.y,b.z),L.push(q+$,1-B),N.push(g++)}y.push(N)}for(let P=0;P<i;P++)for(let N=0;N<n;N++){const B=y[P][N+1],$=y[P][N],K=y[P+1][N],q=y[P+1][N+1];(P!==0||u>0)&&A.push(B,$,q),(P!==i-1||f<Math.PI)&&A.push($,K,q)}this.setIndex(A),this.setAttribute("position",new cp(I,3)),this.setAttribute("normal",new cp(D,3)),this.setAttribute("uv",new cp(L,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new hT(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class yq extends zg{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const n=[],i=new Set,r=new Lt,a=new Lt;if(e.index!==null){const u=e.attributes.position,l=e.index;let f=e.groups;f.length===0&&(f=[{start:0,count:l.count,materialIndex:0}]);for(let g=0,y=f.length;g<y;++g){const S=f[g],b=S.start,A=S.count;for(let I=b,D=b+A;I<D;I+=3)for(let L=0;L<3;L++){const P=l.getX(I+L),N=l.getX(I+(L+1)%3);r.fromBufferAttribute(u,P),a.fromBufferAttribute(u,N),SO(r,a,i)===!0&&(n.push(r.x,r.y,r.z),n.push(a.x,a.y,a.z))}}}else{const u=e.attributes.position;for(let l=0,f=u.count/3;l<f;l++)for(let g=0;g<3;g++){const y=3*l+g,S=3*l+(g+1)%3;r.fromBufferAttribute(u,y),a.fromBufferAttribute(u,S),SO(r,a,i)===!0&&(n.push(r.x,r.y,r.z),n.push(a.x,a.y,a.z))}}this.setAttribute("position",new cp(n,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function SO(t,e,n){const i=`${t.x},${t.y},${t.z}-${e.x},${e.y},${e.z}`,r=`${e.x},${e.y},${e.z}-${t.x},${t.y},${t.z}`;return n.has(i)===!0||n.has(r)===!0?!1:(n.add(i),n.add(r),!0)}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:ID}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=ID);const _q=t=>{let e=t+"=",n=document.cookie.split(";");for(let i=0;i<n.length;i++){let r=n[i];for(;r.charAt(0)==" ";)r=r.substring(1);if(r.indexOf(e)==0)return r.substring(e.length,r.length)}return""},EO="44+Technologies",xq=`https://tiles.openmap.vn/styles/${_q("theme")==="dark"?"night":"day"}-v1/style.json`,bq="&copy; 44+ Technologies";var MO={exports:{}},Ob={},CO={exports:{}},Ci={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zy=Symbol.for("react.element"),wq=Symbol.for("react.portal"),Sq=Symbol.for("react.fragment"),Eq=Symbol.for("react.strict_mode"),Mq=Symbol.for("react.profiler"),Cq=Symbol.for("react.provider"),Tq=Symbol.for("react.context"),Aq=Symbol.for("react.forward_ref"),Pq=Symbol.for("react.suspense"),Iq=Symbol.for("react.memo"),Rq=Symbol.for("react.lazy"),TO=Symbol.iterator;function Lq(t){return t===null||typeof t!="object"?null:(t=TO&&t[TO]||t["@@iterator"],typeof t=="function"?t:null)}var AO={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},PO=Object.assign,IO={};function Vg(t,e,n){this.props=t,this.context=e,this.refs=IO,this.updater=n||AO}Vg.prototype.isReactComponent={},Vg.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")},Vg.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function RO(){}RO.prototype=Vg.prototype;function dT(t,e,n){this.props=t,this.context=e,this.refs=IO,this.updater=n||AO}var fT=dT.prototype=new RO;fT.constructor=dT,PO(fT,Vg.prototype),fT.isPureReactComponent=!0;var LO=Array.isArray,kO=Object.prototype.hasOwnProperty,pT={current:null},DO={key:!0,ref:!0,__self:!0,__source:!0};function OO(t,e,n){var i,r={},a=null,u=null;if(e!=null)for(i in e.ref!==void 0&&(u=e.ref),e.key!==void 0&&(a=""+e.key),e)kO.call(e,i)&&!DO.hasOwnProperty(i)&&(r[i]=e[i]);var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){for(var f=Array(l),g=0;g<l;g++)f[g]=arguments[g+2];r.children=f}if(t&&t.defaultProps)for(i in l=t.defaultProps,l)r[i]===void 0&&(r[i]=l[i]);return{$$typeof:zy,type:t,key:a,ref:u,props:r,_owner:pT.current}}function kq(t,e){return{$$typeof:zy,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function mT(t){return typeof t=="object"&&t!==null&&t.$$typeof===zy}function Dq(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var FO=/\/+/g;function gT(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Dq(""+t.key):e.toString(36)}function Fb(t,e,n,i,r){var a=typeof t;(a==="undefined"||a==="boolean")&&(t=null);var u=!1;if(t===null)u=!0;else switch(a){case"string":case"number":u=!0;break;case"object":switch(t.$$typeof){case zy:case wq:u=!0}}if(u)return u=t,r=r(u),t=i===""?"."+gT(u,0):i,LO(r)?(n="",t!=null&&(n=t.replace(FO,"$&/")+"/"),Fb(r,e,n,"",function(g){return g})):r!=null&&(mT(r)&&(r=kq(r,n+(!r.key||u&&u.key===r.key?"":(""+r.key).replace(FO,"$&/")+"/")+t)),e.push(r)),1;if(u=0,i=i===""?".":i+":",LO(t))for(var l=0;l<t.length;l++){a=t[l];var f=i+gT(a,l);u+=Fb(a,e,n,f,r)}else if(f=Lq(t),typeof f=="function")for(t=f.call(t),l=0;!(a=t.next()).done;)a=a.value,f=i+gT(a,l++),u+=Fb(a,e,n,f,r);else if(a==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return u}function zb(t,e,n){if(t==null)return t;var i=[],r=0;return Fb(t,i,"","",function(a){return e.call(n,a,r++)}),i}function Oq(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var qo={current:null},Nb={transition:null},Fq={ReactCurrentDispatcher:qo,ReactCurrentBatchConfig:Nb,ReactCurrentOwner:pT};function zO(){throw Error("act(...) is not supported in production builds of React.")}Ci.Children={map:zb,forEach:function(t,e,n){zb(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return zb(t,function(){e++}),e},toArray:function(t){return zb(t,function(e){return e})||[]},only:function(t){if(!mT(t))throw Error("React.Children.only expected to receive a single React element child.");return t}},Ci.Component=Vg,Ci.Fragment=Sq,Ci.Profiler=Mq,Ci.PureComponent=dT,Ci.StrictMode=Eq,Ci.Suspense=Pq,Ci.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Fq,Ci.act=zO,Ci.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var i=PO({},t.props),r=t.key,a=t.ref,u=t._owner;if(e!=null){if(e.ref!==void 0&&(a=e.ref,u=pT.current),e.key!==void 0&&(r=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(f in e)kO.call(e,f)&&!DO.hasOwnProperty(f)&&(i[f]=e[f]===void 0&&l!==void 0?l[f]:e[f])}var f=arguments.length-2;if(f===1)i.children=n;else if(1<f){l=Array(f);for(var g=0;g<f;g++)l[g]=arguments[g+2];i.children=l}return{$$typeof:zy,type:t.type,key:r,ref:a,props:i,_owner:u}},Ci.createContext=function(t){return t={$$typeof:Tq,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Cq,_context:t},t.Consumer=t},Ci.createElement=OO,Ci.createFactory=function(t){var e=OO.bind(null,t);return e.type=t,e},Ci.createRef=function(){return{current:null}},Ci.forwardRef=function(t){return{$$typeof:Aq,render:t}},Ci.isValidElement=mT,Ci.lazy=function(t){return{$$typeof:Rq,_payload:{_status:-1,_result:t},_init:Oq}},Ci.memo=function(t,e){return{$$typeof:Iq,type:t,compare:e===void 0?null:e}},Ci.startTransition=function(t){var e=Nb.transition;Nb.transition={};try{t()}finally{Nb.transition=e}},Ci.unstable_act=zO,Ci.useCallback=function(t,e){return qo.current.useCallback(t,e)},Ci.useContext=function(t){return qo.current.useContext(t)},Ci.useDebugValue=function(){},Ci.useDeferredValue=function(t){return qo.current.useDeferredValue(t)},Ci.useEffect=function(t,e){return qo.current.useEffect(t,e)},Ci.useId=function(){return qo.current.useId()},Ci.useImperativeHandle=function(t,e,n){return qo.current.useImperativeHandle(t,e,n)},Ci.useInsertionEffect=function(t,e){return qo.current.useInsertionEffect(t,e)},Ci.useLayoutEffect=function(t,e){return qo.current.useLayoutEffect(t,e)},Ci.useMemo=function(t,e){return qo.current.useMemo(t,e)},Ci.useReducer=function(t,e,n){return qo.current.useReducer(t,e,n)},Ci.useRef=function(t){return qo.current.useRef(t)},Ci.useState=function(t){return qo.current.useState(t)},Ci.useSyncExternalStore=function(t,e,n){return qo.current.useSyncExternalStore(t,e,n)},Ci.useTransition=function(){return qo.current.useTransition()},Ci.version="18.3.1",CO.exports=Ci;var he=CO.exports;const un=cb(he),Bb=_l({__proto__:null,default:un},[he]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zq=he,Nq=Symbol.for("react.element"),Bq=Symbol.for("react.fragment"),Uq=Object.prototype.hasOwnProperty,Vq=zq.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,$q={key:!0,ref:!0,__self:!0,__source:!0};function NO(t,e,n){var i,r={},a=null,u=null;n!==void 0&&(a=""+n),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(u=e.ref);for(i in e)Uq.call(e,i)&&!$q.hasOwnProperty(i)&&(r[i]=e[i]);if(t&&t.defaultProps)for(i in e=t.defaultProps,e)r[i]===void 0&&(r[i]=e[i]);return{$$typeof:Nq,type:t,key:a,ref:u,props:r,_owner:Vq.current}}Ob.Fragment=Bq,Ob.jsx=NO,Ob.jsxs=NO,MO.exports=Ob;var Ws=MO.exports,BO={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(t){(function(){var e={}.hasOwnProperty;function n(){for(var a="",u=0;u<arguments.length;u++){var l=arguments[u];l&&(a=r(a,i(l)))}return a}function i(a){if(typeof a=="string"||typeof a=="number")return a;if(typeof a!="object")return"";if(Array.isArray(a))return n.apply(null,a);if(a.toString!==Object.prototype.toString&&!a.toString.toString().includes("[native code]"))return a.toString();var u="";for(var l in a)e.call(a,l)&&a[l]&&(u=r(u,l));return u}function r(a,u){return u?a?a+" "+u:a+u:a}t.exports?(n.default=n,t.exports=n):window.classNames=n})()})(BO);var Hq=BO.exports;const pi=cb(Hq);function Kr(){return Kr=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Kr.apply(null,arguments)}var UO={exports:{}},ar={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vT=Symbol.for("react.element"),yT=Symbol.for("react.portal"),Ub=Symbol.for("react.fragment"),Vb=Symbol.for("react.strict_mode"),$b=Symbol.for("react.profiler"),Hb=Symbol.for("react.provider"),Gb=Symbol.for("react.context"),Gq=Symbol.for("react.server_context"),Wb=Symbol.for("react.forward_ref"),jb=Symbol.for("react.suspense"),qb=Symbol.for("react.suspense_list"),Xb=Symbol.for("react.memo"),Zb=Symbol.for("react.lazy"),Wq=Symbol.for("react.offscreen"),VO;VO=Symbol.for("react.module.reference");function Cl(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case vT:switch(t=t.type,t){case Ub:case $b:case Vb:case jb:case qb:return t;default:switch(t=t&&t.$$typeof,t){case Gq:case Gb:case Wb:case Zb:case Xb:case Hb:return t;default:return e}}case yT:return e}}}ar.ContextConsumer=Gb,ar.ContextProvider=Hb,ar.Element=vT,ar.ForwardRef=Wb,ar.Fragment=Ub,ar.Lazy=Zb,ar.Memo=Xb,ar.Portal=yT,ar.Profiler=$b,ar.StrictMode=Vb,ar.Suspense=jb,ar.SuspenseList=qb,ar.isAsyncMode=function(){return!1},ar.isConcurrentMode=function(){return!1},ar.isContextConsumer=function(t){return Cl(t)===Gb},ar.isContextProvider=function(t){return Cl(t)===Hb},ar.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===vT},ar.isForwardRef=function(t){return Cl(t)===Wb},ar.isFragment=function(t){return Cl(t)===Ub},ar.isLazy=function(t){return Cl(t)===Zb},ar.isMemo=function(t){return Cl(t)===Xb},ar.isPortal=function(t){return Cl(t)===yT},ar.isProfiler=function(t){return Cl(t)===$b},ar.isStrictMode=function(t){return Cl(t)===Vb},ar.isSuspense=function(t){return Cl(t)===jb},ar.isSuspenseList=function(t){return Cl(t)===qb},ar.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===Ub||t===$b||t===Vb||t===jb||t===qb||t===Wq||typeof t=="object"&&t!==null&&(t.$$typeof===Zb||t.$$typeof===Xb||t.$$typeof===Hb||t.$$typeof===Gb||t.$$typeof===Wb||t.$$typeof===VO||t.getModuleId!==void 0)},ar.typeOf=Cl,UO.exports=ar;var Ny=UO.exports;function _T(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=[];return un.Children.forEach(t,function(i){i==null&&!e.keepEmpty||(Array.isArray(i)?n=n.concat(_T(i)):Ny.isFragment(i)&&i.props?n=n.concat(_T(i.props.children,e)):n.push(i))}),n}var xT={},jq=function(e){};function qq(t,e){}function Xq(t,e){}function Zq(){xT={}}function $O(t,e,n){!e&&!xT[n]&&(t(!1,n),xT[n]=!0)}function Va(t,e){$O(qq,t,e)}function Yq(t,e){$O(Xq,t,e)}Va.preMessage=jq,Va.resetWarned=Zq,Va.noteOnce=Yq;function ai(t){"@babel/helpers - typeof";return ai=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ai(t)}function Kq(t,e){if(ai(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(ai(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function HO(t){var e=Kq(t,"string");return ai(e)=="symbol"?e:e+""}function vt(t,e,n){return(e=HO(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function GO(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function It(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?GO(Object(n),!0).forEach(function(i){vt(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):GO(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}var WO={exports:{}},$a={},jO={exports:{}},qO={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(ge,Be){var Ze=ge.length;ge.push(Be);e:for(;0<Ze;){var je=Ze-1>>>1,wt=ge[je];if(0<r(wt,Be))ge[je]=Be,ge[Ze]=wt,Ze=je;else break e}}function n(ge){return ge.length===0?null:ge[0]}function i(ge){if(ge.length===0)return null;var Be=ge[0],Ze=ge.pop();if(Ze!==Be){ge[0]=Ze;e:for(var je=0,wt=ge.length,Xt=wt>>>1;je<Xt;){var Ke=2*(je+1)-1,_t=ge[Ke],zt=Ke+1,Rt=ge[zt];if(0>r(_t,Ze))zt<wt&&0>r(Rt,_t)?(ge[je]=Rt,ge[zt]=Ze,je=zt):(ge[je]=_t,ge[Ke]=Ze,je=Ke);else if(zt<wt&&0>r(Rt,Ze))ge[je]=Rt,ge[zt]=Ze,je=zt;else break e}}return Be}function r(ge,Be){var Ze=ge.sortIndex-Be.sortIndex;return Ze!==0?Ze:ge.id-Be.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var u=Date,l=u.now();t.unstable_now=function(){return u.now()-l}}var f=[],g=[],y=1,S=null,b=3,A=!1,I=!1,D=!1,L=typeof setTimeout=="function"?setTimeout:null,P=typeof clearTimeout=="function"?clearTimeout:null,N=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function B(ge){for(var Be=n(g);Be!==null;){if(Be.callback===null)i(g);else if(Be.startTime<=ge)i(g),Be.sortIndex=Be.expirationTime,e(f,Be);else break;Be=n(g)}}function $(ge){if(D=!1,B(ge),!I)if(n(f)!==null)I=!0,ye(K);else{var Be=n(g);Be!==null&&Ce($,Be.startTime-ge)}}function K(ge,Be){I=!1,D&&(D=!1,P(ie),ie=-1),A=!0;var Ze=b;try{for(B(Be),S=n(f);S!==null&&(!(S.expirationTime>Be)||ge&&!se());){var je=S.callback;if(typeof je=="function"){S.callback=null,b=S.priorityLevel;var wt=je(S.expirationTime<=Be);Be=t.unstable_now(),typeof wt=="function"?S.callback=wt:S===n(f)&&i(f),B(Be)}else i(f);S=n(f)}if(S!==null)var Xt=!0;else{var Ke=n(g);Ke!==null&&Ce($,Ke.startTime-Be),Xt=!1}return Xt}finally{S=null,b=Ze,A=!1}}var q=!1,W=null,ie=-1,Z=5,X=-1;function se(){return!(t.unstable_now()-X<Z)}function De(){if(W!==null){var ge=t.unstable_now();X=ge;var Be=!0;try{Be=W(!0,ge)}finally{Be?Se():(q=!1,W=null)}}else q=!1}var Se;if(typeof N=="function")Se=function(){N(De)};else if(typeof MessageChannel<"u"){var Me=new MessageChannel,Ye=Me.port2;Me.port1.onmessage=De,Se=function(){Ye.postMessage(null)}}else Se=function(){L(De,0)};function ye(ge){W=ge,q||(q=!0,Se())}function Ce(ge,Be){ie=L(function(){ge(t.unstable_now())},Be)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ge){ge.callback=null},t.unstable_continueExecution=function(){I||A||(I=!0,ye(K))},t.unstable_forceFrameRate=function(ge){0>ge||125<ge?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Z=0<ge?Math.floor(1e3/ge):5},t.unstable_getCurrentPriorityLevel=function(){return b},t.unstable_getFirstCallbackNode=function(){return n(f)},t.unstable_next=function(ge){switch(b){case 1:case 2:case 3:var Be=3;break;default:Be=b}var Ze=b;b=Be;try{return ge()}finally{b=Ze}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(ge,Be){switch(ge){case 1:case 2:case 3:case 4:case 5:break;default:ge=3}var Ze=b;b=ge;try{return Be()}finally{b=Ze}},t.unstable_scheduleCallback=function(ge,Be,Ze){var je=t.unstable_now();switch(typeof Ze=="object"&&Ze!==null?(Ze=Ze.delay,Ze=typeof Ze=="number"&&0<Ze?je+Ze:je):Ze=je,ge){case 1:var wt=-1;break;case 2:wt=250;break;case 5:wt=1073741823;break;case 4:wt=1e4;break;default:wt=5e3}return wt=Ze+wt,ge={id:y++,callback:Be,priorityLevel:ge,startTime:Ze,expirationTime:wt,sortIndex:-1},Ze>je?(ge.sortIndex=Ze,e(g,ge),n(f)===null&&ge===n(g)&&(D?(P(ie),ie=-1):D=!0,Ce($,Ze-je))):(ge.sortIndex=wt,e(f,ge),I||A||(I=!0,ye(K))),ge},t.unstable_shouldYield=se,t.unstable_wrapCallback=function(ge){var Be=b;return function(){var Ze=b;b=Be;try{return ge.apply(this,arguments)}finally{b=Ze}}}})(qO),jO.exports=qO;var Jq=jO.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qq=he,Ha=Jq;function Qt(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var XO=new Set,By={};function hp(t,e){$g(t,e),$g(t+"Capture",e)}function $g(t,e){for(By[t]=e,t=0;t<e.length;t++)XO.add(e[t])}var lh=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),bT=Object.prototype.hasOwnProperty,eX=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,ZO={},YO={};function tX(t){return bT.call(YO,t)?!0:bT.call(ZO,t)?!1:eX.test(t)?YO[t]=!0:(ZO[t]=!0,!1)}function nX(t,e,n,i){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function iX(t,e,n,i){if(e===null||typeof e>"u"||nX(t,e,n,i))return!0;if(i)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Xo(t,e,n,i,r,a,u){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=a,this.removeEmptyString=u}var oo={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){oo[t]=new Xo(t,0,!1,t,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];oo[e]=new Xo(e,1,!1,t[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(t){oo[t]=new Xo(t,2,!1,t.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){oo[t]=new Xo(t,2,!1,t,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){oo[t]=new Xo(t,3,!1,t.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(t){oo[t]=new Xo(t,3,!0,t,null,!1,!1)}),["capture","download"].forEach(function(t){oo[t]=new Xo(t,4,!1,t,null,!1,!1)}),["cols","rows","size","span"].forEach(function(t){oo[t]=new Xo(t,6,!1,t,null,!1,!1)}),["rowSpan","start"].forEach(function(t){oo[t]=new Xo(t,5,!1,t.toLowerCase(),null,!1,!1)});var wT=/[\-:]([a-z])/g;function ST(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(wT,ST);oo[e]=new Xo(e,1,!1,t,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(wT,ST);oo[e]=new Xo(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(wT,ST);oo[e]=new Xo(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(t){oo[t]=new Xo(t,1,!1,t.toLowerCase(),null,!1,!1)}),oo.xlinkHref=new Xo("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(t){oo[t]=new Xo(t,1,!1,t.toLowerCase(),null,!0,!0)});function ET(t,e,n,i){var r=oo.hasOwnProperty(e)?oo[e]:null;(r!==null?r.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(iX(e,n,r,i)&&(n=null),i||r===null?tX(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=n===null?r.type===3?!1:"":n:(e=r.attributeName,i=r.attributeNamespace,n===null?t.removeAttribute(e):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,i?t.setAttributeNS(i,e,n):t.setAttribute(e,n))))}var ch=Qq.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Yb=Symbol.for("react.element"),Hg=Symbol.for("react.portal"),Gg=Symbol.for("react.fragment"),MT=Symbol.for("react.strict_mode"),CT=Symbol.for("react.profiler"),KO=Symbol.for("react.provider"),JO=Symbol.for("react.context"),TT=Symbol.for("react.forward_ref"),AT=Symbol.for("react.suspense"),PT=Symbol.for("react.suspense_list"),IT=Symbol.for("react.memo"),Ad=Symbol.for("react.lazy"),QO=Symbol.for("react.offscreen"),eF=Symbol.iterator;function Uy(t){return t===null||typeof t!="object"?null:(t=eF&&t[eF]||t["@@iterator"],typeof t=="function"?t:null)}var $r=Object.assign,RT;function Vy(t){if(RT===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);RT=e&&e[1]||""}return`
`+RT+t}var LT=!1;function kT(t,e){if(!t||LT)return"";LT=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(g){var i=g}Reflect.construct(t,[],e)}else{try{e.call()}catch(g){i=g}t.call(e.prototype)}else{try{throw Error()}catch(g){i=g}t()}}catch(g){if(g&&i&&typeof g.stack=="string"){for(var r=g.stack.split(`
`),a=i.stack.split(`
`),u=r.length-1,l=a.length-1;1<=u&&0<=l&&r[u]!==a[l];)l--;for(;1<=u&&0<=l;u--,l--)if(r[u]!==a[l]){if(u!==1||l!==1)do if(u--,l--,0>l||r[u]!==a[l]){var f=`
`+r[u].replace(" at new "," at ");return t.displayName&&f.includes("<anonymous>")&&(f=f.replace("<anonymous>",t.displayName)),f}while(1<=u&&0<=l);break}}}finally{LT=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Vy(t):""}function rX(t){switch(t.tag){case 5:return Vy(t.type);case 16:return Vy("Lazy");case 13:return Vy("Suspense");case 19:return Vy("SuspenseList");case 0:case 2:case 15:return t=kT(t.type,!1),t;case 11:return t=kT(t.type.render,!1),t;case 1:return t=kT(t.type,!0),t;default:return""}}function DT(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Gg:return"Fragment";case Hg:return"Portal";case CT:return"Profiler";case MT:return"StrictMode";case AT:return"Suspense";case PT:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case JO:return(t.displayName||"Context")+".Consumer";case KO:return(t._context.displayName||"Context")+".Provider";case TT:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case IT:return e=t.displayName||null,e!==null?e:DT(t.type)||"Memo";case Ad:e=t._payload,t=t._init;try{return DT(t(e))}catch{}}return null}function sX(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return DT(e);case 8:return e===MT?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Pd(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function tF(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function oX(t){var e=tF(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),i=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,a=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(u){i=""+u,a.call(this,u)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(u){i=""+u},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Kb(t){t._valueTracker||(t._valueTracker=oX(t))}function nF(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),i="";return t&&(i=tF(t)?t.checked?"true":"false":t.value),t=i,t!==n?(e.setValue(t),!0):!1}function Jb(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function OT(t,e){var n=e.checked;return $r({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function iF(t,e){var n=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;n=Pd(e.value!=null?e.value:n),t._wrapperState={initialChecked:i,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function rF(t,e){e=e.checked,e!=null&&ET(t,"checked",e,!1)}function FT(t,e){rF(t,e);var n=Pd(e.value),i=e.type;if(n!=null)i==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(i==="submit"||i==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?zT(t,e.type,n):e.hasOwnProperty("defaultValue")&&zT(t,e.type,Pd(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function sF(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function zT(t,e,n){(e!=="number"||Jb(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var $y=Array.isArray;function Wg(t,e,n,i){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&i&&(t[n].defaultSelected=!0)}else{for(n=""+Pd(n),e=null,r=0;r<t.length;r++){if(t[r].value===n){t[r].selected=!0,i&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function NT(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Qt(91));return $r({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function oF(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(Qt(92));if($y(n)){if(1<n.length)throw Error(Qt(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Pd(n)}}function aF(t,e){var n=Pd(e.value),i=Pd(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),i!=null&&(t.defaultValue=""+i)}function lF(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function cF(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function BT(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?cF(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Qb,uF=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,i,r){MSApp.execUnsafeLocalFunction(function(){return t(e,n,i,r)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Qb=Qb||document.createElement("div"),Qb.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Qb.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Hy(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Gy={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},aX=["Webkit","ms","Moz","O"];Object.keys(Gy).forEach(function(t){aX.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Gy[e]=Gy[t]})});function hF(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Gy.hasOwnProperty(t)&&Gy[t]?(""+e).trim():e+"px"}function dF(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var i=n.indexOf("--")===0,r=hF(n,e[n],i);n==="float"&&(n="cssFloat"),i?t.setProperty(n,r):t[n]=r}}var lX=$r({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function UT(t,e){if(e){if(lX[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Qt(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Qt(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Qt(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Qt(62))}}function VT(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var $T=null;function HT(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var GT=null,jg=null,qg=null;function fF(t){if(t=d_(t)){if(typeof GT!="function")throw Error(Qt(280));var e=t.stateNode;e&&(e=ww(e),GT(t.stateNode,t.type,e))}}function pF(t){jg?qg?qg.push(t):qg=[t]:jg=t}function mF(){if(jg){var t=jg,e=qg;if(qg=jg=null,fF(t),e)for(t=0;t<e.length;t++)fF(e[t])}}function gF(t,e){return t(e)}function vF(){}var WT=!1;function yF(t,e,n){if(WT)return t(e,n);WT=!0;try{return gF(t,e,n)}finally{WT=!1,(jg!==null||qg!==null)&&(vF(),mF())}}function Wy(t,e){var n=t.stateNode;if(n===null)return null;var i=ww(n);if(i===null)return null;n=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(t=t.type,i=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!i;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Qt(231,e,typeof n));return n}var jT=!1;if(lh)try{var jy={};Object.defineProperty(jy,"passive",{get:function(){jT=!0}}),window.addEventListener("test",jy,jy),window.removeEventListener("test",jy,jy)}catch{jT=!1}function cX(t,e,n,i,r,a,u,l,f){var g=Array.prototype.slice.call(arguments,3);try{e.apply(n,g)}catch(y){this.onError(y)}}var qy=!1,ew=null,tw=!1,qT=null,uX={onError:function(t){qy=!0,ew=t}};function hX(t,e,n,i,r,a,u,l,f){qy=!1,ew=null,cX.apply(uX,arguments)}function dX(t,e,n,i,r,a,u,l,f){if(hX.apply(this,arguments),qy){if(qy){var g=ew;qy=!1,ew=null}else throw Error(Qt(198));tw||(tw=!0,qT=g)}}function dp(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function _F(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function xF(t){if(dp(t)!==t)throw Error(Qt(188))}function fX(t){var e=t.alternate;if(!e){if(e=dp(t),e===null)throw Error(Qt(188));return e!==t?null:t}for(var n=t,i=e;;){var r=n.return;if(r===null)break;var a=r.alternate;if(a===null){if(i=r.return,i!==null){n=i;continue}break}if(r.child===a.child){for(a=r.child;a;){if(a===n)return xF(r),t;if(a===i)return xF(r),e;a=a.sibling}throw Error(Qt(188))}if(n.return!==i.return)n=r,i=a;else{for(var u=!1,l=r.child;l;){if(l===n){u=!0,n=r,i=a;break}if(l===i){u=!0,i=r,n=a;break}l=l.sibling}if(!u){for(l=a.child;l;){if(l===n){u=!0,n=a,i=r;break}if(l===i){u=!0,i=a,n=r;break}l=l.sibling}if(!u)throw Error(Qt(189))}}if(n.alternate!==i)throw Error(Qt(190))}if(n.tag!==3)throw Error(Qt(188));return n.stateNode.current===n?t:e}function bF(t){return t=fX(t),t!==null?wF(t):null}function wF(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=wF(t);if(e!==null)return e;t=t.sibling}return null}var SF=Ha.unstable_scheduleCallback,EF=Ha.unstable_cancelCallback,pX=Ha.unstable_shouldYield,mX=Ha.unstable_requestPaint,ss=Ha.unstable_now,gX=Ha.unstable_getCurrentPriorityLevel,XT=Ha.unstable_ImmediatePriority,MF=Ha.unstable_UserBlockingPriority,nw=Ha.unstable_NormalPriority,vX=Ha.unstable_LowPriority,CF=Ha.unstable_IdlePriority,iw=null,nu=null;function yX(t){if(nu&&typeof nu.onCommitFiberRoot=="function")try{nu.onCommitFiberRoot(iw,t,void 0,(t.current.flags&128)===128)}catch{}}var fc=Math.clz32?Math.clz32:bX,_X=Math.log,xX=Math.LN2;function bX(t){return t>>>=0,t===0?32:31-(_X(t)/xX|0)|0}var rw=64,sw=4194304;function Xy(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function ow(t,e){var n=t.pendingLanes;if(n===0)return 0;var i=0,r=t.suspendedLanes,a=t.pingedLanes,u=n&268435455;if(u!==0){var l=u&~r;l!==0?i=Xy(l):(a&=u,a!==0&&(i=Xy(a)))}else u=n&~r,u!==0?i=Xy(u):a!==0&&(i=Xy(a));if(i===0)return 0;if(e!==0&&e!==i&&!(e&r)&&(r=i&-i,a=e&-e,r>=a||r===16&&(a&4194240)!==0))return e;if(i&4&&(i|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=i;0<e;)n=31-fc(e),r=1<<n,i|=t[n],e&=~r;return i}function wX(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function SX(t,e){for(var n=t.suspendedLanes,i=t.pingedLanes,r=t.expirationTimes,a=t.pendingLanes;0<a;){var u=31-fc(a),l=1<<u,f=r[u];f===-1?(!(l&n)||l&i)&&(r[u]=wX(l,e)):f<=e&&(t.expiredLanes|=l),a&=~l}}function ZT(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function TF(){var t=rw;return rw<<=1,!(rw&4194240)&&(rw=64),t}function YT(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Zy(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-fc(e),t[e]=n}function EX(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var i=t.eventTimes;for(t=t.expirationTimes;0<n;){var r=31-fc(n),a=1<<r;e[r]=0,i[r]=-1,t[r]=-1,n&=~a}}function KT(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var i=31-fc(n),r=1<<i;r&e|t[i]&e&&(t[i]|=e),n&=~r}}var lr=0;function AF(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var PF,JT,IF,RF,LF,QT=!1,aw=[],Id=null,Rd=null,Ld=null,Yy=new Map,Ky=new Map,kd=[],MX="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function kF(t,e){switch(t){case"focusin":case"focusout":Id=null;break;case"dragenter":case"dragleave":Rd=null;break;case"mouseover":case"mouseout":Ld=null;break;case"pointerover":case"pointerout":Yy.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ky.delete(e.pointerId)}}function Jy(t,e,n,i,r,a){return t===null||t.nativeEvent!==a?(t={blockedOn:e,domEventName:n,eventSystemFlags:i,nativeEvent:a,targetContainers:[r]},e!==null&&(e=d_(e),e!==null&&JT(e)),t):(t.eventSystemFlags|=i,e=t.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),t)}function CX(t,e,n,i,r){switch(e){case"focusin":return Id=Jy(Id,t,e,n,i,r),!0;case"dragenter":return Rd=Jy(Rd,t,e,n,i,r),!0;case"mouseover":return Ld=Jy(Ld,t,e,n,i,r),!0;case"pointerover":var a=r.pointerId;return Yy.set(a,Jy(Yy.get(a)||null,t,e,n,i,r)),!0;case"gotpointercapture":return a=r.pointerId,Ky.set(a,Jy(Ky.get(a)||null,t,e,n,i,r)),!0}return!1}function DF(t){var e=fp(t.target);if(e!==null){var n=dp(e);if(n!==null){if(e=n.tag,e===13){if(e=_F(n),e!==null){t.blockedOn=e,LF(t.priority,function(){IF(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function lw(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=tA(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var i=new n.constructor(n.type,n);$T=i,n.target.dispatchEvent(i),$T=null}else return e=d_(n),e!==null&&JT(e),t.blockedOn=n,!1;e.shift()}return!0}function OF(t,e,n){lw(t)&&n.delete(e)}function TX(){QT=!1,Id!==null&&lw(Id)&&(Id=null),Rd!==null&&lw(Rd)&&(Rd=null),Ld!==null&&lw(Ld)&&(Ld=null),Yy.forEach(OF),Ky.forEach(OF)}function Qy(t,e){t.blockedOn===e&&(t.blockedOn=null,QT||(QT=!0,Ha.unstable_scheduleCallback(Ha.unstable_NormalPriority,TX)))}function e_(t){function e(r){return Qy(r,t)}if(0<aw.length){Qy(aw[0],t);for(var n=1;n<aw.length;n++){var i=aw[n];i.blockedOn===t&&(i.blockedOn=null)}}for(Id!==null&&Qy(Id,t),Rd!==null&&Qy(Rd,t),Ld!==null&&Qy(Ld,t),Yy.forEach(e),Ky.forEach(e),n=0;n<kd.length;n++)i=kd[n],i.blockedOn===t&&(i.blockedOn=null);for(;0<kd.length&&(n=kd[0],n.blockedOn===null);)DF(n),n.blockedOn===null&&kd.shift()}var Xg=ch.ReactCurrentBatchConfig,cw=!0;function AX(t,e,n,i){var r=lr,a=Xg.transition;Xg.transition=null;try{lr=1,eA(t,e,n,i)}finally{lr=r,Xg.transition=a}}function PX(t,e,n,i){var r=lr,a=Xg.transition;Xg.transition=null;try{lr=4,eA(t,e,n,i)}finally{lr=r,Xg.transition=a}}function eA(t,e,n,i){if(cw){var r=tA(t,e,n,i);if(r===null)yA(t,e,i,uw,n),kF(t,i);else if(CX(r,t,e,n,i))i.stopPropagation();else if(kF(t,i),e&4&&-1<MX.indexOf(t)){for(;r!==null;){var a=d_(r);if(a!==null&&PF(a),a=tA(t,e,n,i),a===null&&yA(t,e,i,uw,n),a===r)break;r=a}r!==null&&i.stopPropagation()}else yA(t,e,i,null,n)}}var uw=null;function tA(t,e,n,i){if(uw=null,t=HT(i),t=fp(t),t!==null)if(e=dp(t),e===null)t=null;else if(n=e.tag,n===13){if(t=_F(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return uw=t,null}function FF(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(gX()){case XT:return 1;case MF:return 4;case nw:case vX:return 16;case CF:return 536870912;default:return 16}default:return 16}}var Dd=null,nA=null,hw=null;function zF(){if(hw)return hw;var t,e=nA,n=e.length,i,r="value"in Dd?Dd.value:Dd.textContent,a=r.length;for(t=0;t<n&&e[t]===r[t];t++);var u=n-t;for(i=1;i<=u&&e[n-i]===r[a-i];i++);return hw=r.slice(t,1<i?1-i:void 0)}function dw(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function fw(){return!0}function NF(){return!1}function Ga(t){function e(n,i,r,a,u){this._reactName=n,this._targetInst=r,this.type=i,this.nativeEvent=a,this.target=u,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(a):a[l]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?fw:NF,this.isPropagationStopped=NF,this}return $r(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=fw)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=fw)},persist:function(){},isPersistent:fw}),e}var Zg={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},iA=Ga(Zg),t_=$r({},Zg,{view:0,detail:0}),IX=Ga(t_),rA,sA,n_,pw=$r({},t_,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:aA,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==n_&&(n_&&t.type==="mousemove"?(rA=t.screenX-n_.screenX,sA=t.screenY-n_.screenY):sA=rA=0,n_=t),rA)},movementY:function(t){return"movementY"in t?t.movementY:sA}}),BF=Ga(pw),RX=$r({},pw,{dataTransfer:0}),LX=Ga(RX),kX=$r({},t_,{relatedTarget:0}),oA=Ga(kX),DX=$r({},Zg,{animationName:0,elapsedTime:0,pseudoElement:0}),OX=Ga(DX),FX=$r({},Zg,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),zX=Ga(FX),NX=$r({},Zg,{data:0}),UF=Ga(NX),BX={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},UX={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},VX={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function $X(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=VX[t])?!!e[t]:!1}function aA(){return $X}var HX=$r({},t_,{key:function(t){if(t.key){var e=BX[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=dw(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?UX[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:aA,charCode:function(t){return t.type==="keypress"?dw(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?dw(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),GX=Ga(HX),WX=$r({},pw,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),VF=Ga(WX),jX=$r({},t_,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:aA}),qX=Ga(jX),XX=$r({},Zg,{propertyName:0,elapsedTime:0,pseudoElement:0}),ZX=Ga(XX),YX=$r({},pw,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),KX=Ga(YX),JX=[9,13,27,32],lA=lh&&"CompositionEvent"in window,i_=null;lh&&"documentMode"in document&&(i_=document.documentMode);var QX=lh&&"TextEvent"in window&&!i_,$F=lh&&(!lA||i_&&8<i_&&11>=i_),HF=" ",GF=!1;function WF(t,e){switch(t){case"keyup":return JX.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function jF(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Yg=!1;function eZ(t,e){switch(t){case"compositionend":return jF(e);case"keypress":return e.which!==32?null:(GF=!0,HF);case"textInput":return t=e.data,t===HF&&GF?null:t;default:return null}}function tZ(t,e){if(Yg)return t==="compositionend"||!lA&&WF(t,e)?(t=zF(),hw=nA=Dd=null,Yg=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return $F&&e.locale!=="ko"?null:e.data;default:return null}}var nZ={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qF(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!nZ[t.type]:e==="textarea"}function XF(t,e,n,i){pF(i),e=_w(e,"onChange"),0<e.length&&(n=new iA("onChange","change",null,n,i),t.push({event:n,listeners:e}))}var r_=null,s_=null;function iZ(t){dz(t,0)}function mw(t){var e=tv(t);if(nF(e))return t}function rZ(t,e){if(t==="change")return e}var ZF=!1;if(lh){var cA;if(lh){var uA="oninput"in document;if(!uA){var YF=document.createElement("div");YF.setAttribute("oninput","return;"),uA=typeof YF.oninput=="function"}cA=uA}else cA=!1;ZF=cA&&(!document.documentMode||9<document.documentMode)}function KF(){r_&&(r_.detachEvent("onpropertychange",JF),s_=r_=null)}function JF(t){if(t.propertyName==="value"&&mw(s_)){var e=[];XF(e,s_,t,HT(t)),yF(iZ,e)}}function sZ(t,e,n){t==="focusin"?(KF(),r_=e,s_=n,r_.attachEvent("onpropertychange",JF)):t==="focusout"&&KF()}function oZ(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return mw(s_)}function aZ(t,e){if(t==="click")return mw(e)}function lZ(t,e){if(t==="input"||t==="change")return mw(e)}function cZ(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var pc=typeof Object.is=="function"?Object.is:cZ;function o_(t,e){if(pc(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!bT.call(e,r)||!pc(t[r],e[r]))return!1}return!0}function QF(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function ez(t,e){var n=QF(t);t=0;for(var i;n;){if(n.nodeType===3){if(i=t+n.textContent.length,t<=e&&i>=e)return{node:n,offset:e-t};t=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=QF(n)}}function tz(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?tz(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function nz(){for(var t=window,e=Jb();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Jb(t.document)}return e}function hA(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function uZ(t){var e=nz(),n=t.focusedElem,i=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&tz(n.ownerDocument.documentElement,n)){if(i!==null&&hA(n)){if(e=i.start,t=i.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var r=n.textContent.length,a=Math.min(i.start,r);i=i.end===void 0?a:Math.min(i.end,r),!t.extend&&a>i&&(r=i,i=a,a=r),r=ez(n,a);var u=ez(n,i);r&&u&&(t.rangeCount!==1||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==u.node||t.focusOffset!==u.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),t.removeAllRanges(),a>i?(t.addRange(e),t.extend(u.node,u.offset)):(e.setEnd(u.node,u.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var hZ=lh&&"documentMode"in document&&11>=document.documentMode,Kg=null,dA=null,a_=null,fA=!1;function iz(t,e,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;fA||Kg==null||Kg!==Jb(i)||(i=Kg,"selectionStart"in i&&hA(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),a_&&o_(a_,i)||(a_=i,i=_w(dA,"onSelect"),0<i.length&&(e=new iA("onSelect","select",null,e,n),t.push({event:e,listeners:i}),e.target=Kg)))}function gw(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Jg={animationend:gw("Animation","AnimationEnd"),animationiteration:gw("Animation","AnimationIteration"),animationstart:gw("Animation","AnimationStart"),transitionend:gw("Transition","TransitionEnd")},pA={},rz={};lh&&(rz=document.createElement("div").style,"AnimationEvent"in window||(delete Jg.animationend.animation,delete Jg.animationiteration.animation,delete Jg.animationstart.animation),"TransitionEvent"in window||delete Jg.transitionend.transition);function vw(t){if(pA[t])return pA[t];if(!Jg[t])return t;var e=Jg[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in rz)return pA[t]=e[n];return t}var sz=vw("animationend"),oz=vw("animationiteration"),az=vw("animationstart"),lz=vw("transitionend"),cz=new Map,uz="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Od(t,e){cz.set(t,e),hp(e,[t])}for(var mA=0;mA<uz.length;mA++){var gA=uz[mA],dZ=gA.toLowerCase(),fZ=gA[0].toUpperCase()+gA.slice(1);Od(dZ,"on"+fZ)}Od(sz,"onAnimationEnd"),Od(oz,"onAnimationIteration"),Od(az,"onAnimationStart"),Od("dblclick","onDoubleClick"),Od("focusin","onFocus"),Od("focusout","onBlur"),Od(lz,"onTransitionEnd"),$g("onMouseEnter",["mouseout","mouseover"]),$g("onMouseLeave",["mouseout","mouseover"]),$g("onPointerEnter",["pointerout","pointerover"]),$g("onPointerLeave",["pointerout","pointerover"]),hp("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),hp("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),hp("onBeforeInput",["compositionend","keypress","textInput","paste"]),hp("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),hp("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),hp("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var l_="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),pZ=new Set("cancel close invalid load scroll toggle".split(" ").concat(l_));function hz(t,e,n){var i=t.type||"unknown-event";t.currentTarget=n,dX(i,e,void 0,t),t.currentTarget=null}function dz(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var i=t[n],r=i.event;i=i.listeners;e:{var a=void 0;if(e)for(var u=i.length-1;0<=u;u--){var l=i[u],f=l.instance,g=l.currentTarget;if(l=l.listener,f!==a&&r.isPropagationStopped())break e;hz(r,l,g),a=f}else for(u=0;u<i.length;u++){if(l=i[u],f=l.instance,g=l.currentTarget,l=l.listener,f!==a&&r.isPropagationStopped())break e;hz(r,l,g),a=f}}}if(tw)throw t=qT,tw=!1,qT=null,t}function Cr(t,e){var n=e[EA];n===void 0&&(n=e[EA]=new Set);var i=t+"__bubble";n.has(i)||(fz(e,t,2,!1),n.add(i))}function vA(t,e,n){var i=0;e&&(i|=4),fz(n,t,i,e)}var yw="_reactListening"+Math.random().toString(36).slice(2);function c_(t){if(!t[yw]){t[yw]=!0,XO.forEach(function(n){n!=="selectionchange"&&(pZ.has(n)||vA(n,!1,t),vA(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[yw]||(e[yw]=!0,vA("selectionchange",!1,e))}}function fz(t,e,n,i){switch(FF(e)){case 1:var r=AX;break;case 4:r=PX;break;default:r=eA}n=r.bind(null,e,n,t),r=void 0,!jT||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),i?r!==void 0?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):r!==void 0?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function yA(t,e,n,i,r){var a=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var u=i.tag;if(u===3||u===4){var l=i.stateNode.containerInfo;if(l===r||l.nodeType===8&&l.parentNode===r)break;if(u===4)for(u=i.return;u!==null;){var f=u.tag;if((f===3||f===4)&&(f=u.stateNode.containerInfo,f===r||f.nodeType===8&&f.parentNode===r))return;u=u.return}for(;l!==null;){if(u=fp(l),u===null)return;if(f=u.tag,f===5||f===6){i=a=u;continue e}l=l.parentNode}}i=i.return}yF(function(){var g=a,y=HT(n),S=[];e:{var b=cz.get(t);if(b!==void 0){var A=iA,I=t;switch(t){case"keypress":if(dw(n)===0)break e;case"keydown":case"keyup":A=GX;break;case"focusin":I="focus",A=oA;break;case"focusout":I="blur",A=oA;break;case"beforeblur":case"afterblur":A=oA;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":A=BF;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":A=LX;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":A=qX;break;case sz:case oz:case az:A=OX;break;case lz:A=ZX;break;case"scroll":A=IX;break;case"wheel":A=KX;break;case"copy":case"cut":case"paste":A=zX;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":A=VF}var D=(e&4)!==0,L=!D&&t==="scroll",P=D?b!==null?b+"Capture":null:b;D=[];for(var N=g,B;N!==null;){B=N;var $=B.stateNode;if(B.tag===5&&$!==null&&(B=$,P!==null&&($=Wy(N,P),$!=null&&D.push(u_(N,$,B)))),L)break;N=N.return}0<D.length&&(b=new A(b,I,null,n,y),S.push({event:b,listeners:D}))}}if(!(e&7)){e:{if(b=t==="mouseover"||t==="pointerover",A=t==="mouseout"||t==="pointerout",b&&n!==$T&&(I=n.relatedTarget||n.fromElement)&&(fp(I)||I[uh]))break e;if((A||b)&&(b=y.window===y?y:(b=y.ownerDocument)?b.defaultView||b.parentWindow:window,A?(I=n.relatedTarget||n.toElement,A=g,I=I?fp(I):null,I!==null&&(L=dp(I),I!==L||I.tag!==5&&I.tag!==6)&&(I=null)):(A=null,I=g),A!==I)){if(D=BF,$="onMouseLeave",P="onMouseEnter",N="mouse",(t==="pointerout"||t==="pointerover")&&(D=VF,$="onPointerLeave",P="onPointerEnter",N="pointer"),L=A==null?b:tv(A),B=I==null?b:tv(I),b=new D($,N+"leave",A,n,y),b.target=L,b.relatedTarget=B,$=null,fp(y)===g&&(D=new D(P,N+"enter",I,n,y),D.target=B,D.relatedTarget=L,$=D),L=$,A&&I)t:{for(D=A,P=I,N=0,B=D;B;B=Qg(B))N++;for(B=0,$=P;$;$=Qg($))B++;for(;0<N-B;)D=Qg(D),N--;for(;0<B-N;)P=Qg(P),B--;for(;N--;){if(D===P||P!==null&&D===P.alternate)break t;D=Qg(D),P=Qg(P)}D=null}else D=null;A!==null&&pz(S,b,A,D,!1),I!==null&&L!==null&&pz(S,L,I,D,!0)}}e:{if(b=g?tv(g):window,A=b.nodeName&&b.nodeName.toLowerCase(),A==="select"||A==="input"&&b.type==="file")var K=rZ;else if(qF(b))if(ZF)K=lZ;else{K=oZ;var q=sZ}else(A=b.nodeName)&&A.toLowerCase()==="input"&&(b.type==="checkbox"||b.type==="radio")&&(K=aZ);if(K&&(K=K(t,g))){XF(S,K,n,y);break e}q&&q(t,b,g),t==="focusout"&&(q=b._wrapperState)&&q.controlled&&b.type==="number"&&zT(b,"number",b.value)}switch(q=g?tv(g):window,t){case"focusin":(qF(q)||q.contentEditable==="true")&&(Kg=q,dA=g,a_=null);break;case"focusout":a_=dA=Kg=null;break;case"mousedown":fA=!0;break;case"contextmenu":case"mouseup":case"dragend":fA=!1,iz(S,n,y);break;case"selectionchange":if(hZ)break;case"keydown":case"keyup":iz(S,n,y)}var W;if(lA)e:{switch(t){case"compositionstart":var ie="onCompositionStart";break e;case"compositionend":ie="onCompositionEnd";break e;case"compositionupdate":ie="onCompositionUpdate";break e}ie=void 0}else Yg?WF(t,n)&&(ie="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(ie="onCompositionStart");ie&&($F&&n.locale!=="ko"&&(Yg||ie!=="onCompositionStart"?ie==="onCompositionEnd"&&Yg&&(W=zF()):(Dd=y,nA="value"in Dd?Dd.value:Dd.textContent,Yg=!0)),q=_w(g,ie),0<q.length&&(ie=new UF(ie,t,null,n,y),S.push({event:ie,listeners:q}),W?ie.data=W:(W=jF(n),W!==null&&(ie.data=W)))),(W=QX?eZ(t,n):tZ(t,n))&&(g=_w(g,"onBeforeInput"),0<g.length&&(y=new UF("onBeforeInput","beforeinput",null,n,y),S.push({event:y,listeners:g}),y.data=W))}dz(S,e)})}function u_(t,e,n){return{instance:t,listener:e,currentTarget:n}}function _w(t,e){for(var n=e+"Capture",i=[];t!==null;){var r=t,a=r.stateNode;r.tag===5&&a!==null&&(r=a,a=Wy(t,n),a!=null&&i.unshift(u_(t,a,r)),a=Wy(t,e),a!=null&&i.push(u_(t,a,r))),t=t.return}return i}function Qg(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function pz(t,e,n,i,r){for(var a=e._reactName,u=[];n!==null&&n!==i;){var l=n,f=l.alternate,g=l.stateNode;if(f!==null&&f===i)break;l.tag===5&&g!==null&&(l=g,r?(f=Wy(n,a),f!=null&&u.unshift(u_(n,f,l))):r||(f=Wy(n,a),f!=null&&u.push(u_(n,f,l)))),n=n.return}u.length!==0&&t.push({event:e,listeners:u})}var mZ=/\r\n?/g,gZ=/\u0000|\uFFFD/g;function mz(t){return(typeof t=="string"?t:""+t).replace(mZ,`
`).replace(gZ,"")}function xw(t,e,n){if(e=mz(e),mz(t)!==e&&n)throw Error(Qt(425))}function bw(){}var _A=null,xA=null;function bA(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var wA=typeof setTimeout=="function"?setTimeout:void 0,vZ=typeof clearTimeout=="function"?clearTimeout:void 0,gz=typeof Promise=="function"?Promise:void 0,yZ=typeof queueMicrotask=="function"?queueMicrotask:typeof gz<"u"?function(t){return gz.resolve(null).then(t).catch(_Z)}:wA;function _Z(t){setTimeout(function(){throw t})}function SA(t,e){var n=e,i=0;do{var r=n.nextSibling;if(t.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(i===0){t.removeChild(r),e_(e);return}i--}else n!=="$"&&n!=="$?"&&n!=="$!"||i++;n=r}while(n);e_(e)}function Fd(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function vz(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var ev=Math.random().toString(36).slice(2),iu="__reactFiber$"+ev,h_="__reactProps$"+ev,uh="__reactContainer$"+ev,EA="__reactEvents$"+ev,xZ="__reactListeners$"+ev,bZ="__reactHandles$"+ev;function fp(t){var e=t[iu];if(e)return e;for(var n=t.parentNode;n;){if(e=n[uh]||n[iu]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=vz(t);t!==null;){if(n=t[iu])return n;t=vz(t)}return e}t=n,n=t.parentNode}return null}function d_(t){return t=t[iu]||t[uh],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function tv(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Qt(33))}function ww(t){return t[h_]||null}var MA=[],nv=-1;function zd(t){return{current:t}}function Tr(t){0>nv||(t.current=MA[nv],MA[nv]=null,nv--)}function br(t,e){nv++,MA[nv]=t.current,t.current=e}var Nd={},To=zd(Nd),pa=zd(!1),pp=Nd;function iv(t,e){var n=t.type.contextTypes;if(!n)return Nd;var i=t.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var r={},a;for(a in n)r[a]=e[a];return i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function ma(t){return t=t.childContextTypes,t!=null}function Sw(){Tr(pa),Tr(To)}function yz(t,e,n){if(To.current!==Nd)throw Error(Qt(168));br(To,e),br(pa,n)}function _z(t,e,n){var i=t.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return n;i=i.getChildContext();for(var r in i)if(!(r in e))throw Error(Qt(108,sX(t)||"Unknown",r));return $r({},n,i)}function Ew(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Nd,pp=To.current,br(To,t),br(pa,pa.current),!0}function xz(t,e,n){var i=t.stateNode;if(!i)throw Error(Qt(169));n?(t=_z(t,e,pp),i.__reactInternalMemoizedMergedChildContext=t,Tr(pa),Tr(To),br(To,t)):Tr(pa),br(pa,n)}var hh=null,Mw=!1,CA=!1;function bz(t){hh===null?hh=[t]:hh.push(t)}function wZ(t){Mw=!0,bz(t)}function Bd(){if(!CA&&hh!==null){CA=!0;var t=0,e=lr;try{var n=hh;for(lr=1;t<n.length;t++){var i=n[t];do i=i(!0);while(i!==null)}hh=null,Mw=!1}catch(r){throw hh!==null&&(hh=hh.slice(t+1)),SF(XT,Bd),r}finally{lr=e,CA=!1}}return null}var rv=[],sv=0,Cw=null,Tw=0,Tl=[],Al=0,mp=null,dh=1,fh="";function gp(t,e){rv[sv++]=Tw,rv[sv++]=Cw,Cw=t,Tw=e}function wz(t,e,n){Tl[Al++]=dh,Tl[Al++]=fh,Tl[Al++]=mp,mp=t;var i=dh;t=fh;var r=32-fc(i)-1;i&=~(1<<r),n+=1;var a=32-fc(e)+r;if(30<a){var u=r-r%5;a=(i&(1<<u)-1).toString(32),i>>=u,r-=u,dh=1<<32-fc(e)+r|n<<r|i,fh=a+t}else dh=1<<a|n<<r|i,fh=t}function TA(t){t.return!==null&&(gp(t,1),wz(t,1,0))}function AA(t){for(;t===Cw;)Cw=rv[--sv],rv[sv]=null,Tw=rv[--sv],rv[sv]=null;for(;t===mp;)mp=Tl[--Al],Tl[Al]=null,fh=Tl[--Al],Tl[Al]=null,dh=Tl[--Al],Tl[Al]=null}var Wa=null,ja=null,Dr=!1,mc=null;function Sz(t,e){var n=Ll(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Ez(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Wa=t,ja=Fd(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Wa=t,ja=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=mp!==null?{id:dh,overflow:fh}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Ll(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Wa=t,ja=null,!0):!1;default:return!1}}function PA(t){return(t.mode&1)!==0&&(t.flags&128)===0}function IA(t){if(Dr){var e=ja;if(e){var n=e;if(!Ez(t,e)){if(PA(t))throw Error(Qt(418));e=Fd(n.nextSibling);var i=Wa;e&&Ez(t,e)?Sz(i,n):(t.flags=t.flags&-4097|2,Dr=!1,Wa=t)}}else{if(PA(t))throw Error(Qt(418));t.flags=t.flags&-4097|2,Dr=!1,Wa=t}}}function Mz(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Wa=t}function Aw(t){if(t!==Wa)return!1;if(!Dr)return Mz(t),Dr=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!bA(t.type,t.memoizedProps)),e&&(e=ja)){if(PA(t))throw Cz(),Error(Qt(418));for(;e;)Sz(t,e),e=Fd(e.nextSibling)}if(Mz(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Qt(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){ja=Fd(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}ja=null}}else ja=Wa?Fd(t.stateNode.nextSibling):null;return!0}function Cz(){for(var t=ja;t;)t=Fd(t.nextSibling)}function ov(){ja=Wa=null,Dr=!1}function RA(t){mc===null?mc=[t]:mc.push(t)}var SZ=ch.ReactCurrentBatchConfig;function f_(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Qt(309));var i=n.stateNode}if(!i)throw Error(Qt(147,t));var r=i,a=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===a?e.ref:(e=function(u){var l=r.refs;u===null?delete l[a]:l[a]=u},e._stringRef=a,e)}if(typeof t!="string")throw Error(Qt(284));if(!n._owner)throw Error(Qt(290,t))}return t}function Pw(t,e){throw t=Object.prototype.toString.call(e),Error(Qt(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Tz(t){var e=t._init;return e(t._payload)}function Az(t){function e(P,N){if(t){var B=P.deletions;B===null?(P.deletions=[N],P.flags|=16):B.push(N)}}function n(P,N){if(!t)return null;for(;N!==null;)e(P,N),N=N.sibling;return null}function i(P,N){for(P=new Map;N!==null;)N.key!==null?P.set(N.key,N):P.set(N.index,N),N=N.sibling;return P}function r(P,N){return P=qd(P,N),P.index=0,P.sibling=null,P}function a(P,N,B){return P.index=B,t?(B=P.alternate,B!==null?(B=B.index,B<N?(P.flags|=2,N):B):(P.flags|=2,N)):(P.flags|=1048576,N)}function u(P){return t&&P.alternate===null&&(P.flags|=2),P}function l(P,N,B,$){return N===null||N.tag!==6?(N=wP(B,P.mode,$),N.return=P,N):(N=r(N,B),N.return=P,N)}function f(P,N,B,$){var K=B.type;return K===Gg?y(P,N,B.props.children,$,B.key):N!==null&&(N.elementType===K||typeof K=="object"&&K!==null&&K.$$typeof===Ad&&Tz(K)===N.type)?($=r(N,B.props),$.ref=f_(P,N,B),$.return=P,$):($=Qw(B.type,B.key,B.props,null,P.mode,$),$.ref=f_(P,N,B),$.return=P,$)}function g(P,N,B,$){return N===null||N.tag!==4||N.stateNode.containerInfo!==B.containerInfo||N.stateNode.implementation!==B.implementation?(N=SP(B,P.mode,$),N.return=P,N):(N=r(N,B.children||[]),N.return=P,N)}function y(P,N,B,$,K){return N===null||N.tag!==7?(N=Ep(B,P.mode,$,K),N.return=P,N):(N=r(N,B),N.return=P,N)}function S(P,N,B){if(typeof N=="string"&&N!==""||typeof N=="number")return N=wP(""+N,P.mode,B),N.return=P,N;if(typeof N=="object"&&N!==null){switch(N.$$typeof){case Yb:return B=Qw(N.type,N.key,N.props,null,P.mode,B),B.ref=f_(P,null,N),B.return=P,B;case Hg:return N=SP(N,P.mode,B),N.return=P,N;case Ad:var $=N._init;return S(P,$(N._payload),B)}if($y(N)||Uy(N))return N=Ep(N,P.mode,B,null),N.return=P,N;Pw(P,N)}return null}function b(P,N,B,$){var K=N!==null?N.key:null;if(typeof B=="string"&&B!==""||typeof B=="number")return K!==null?null:l(P,N,""+B,$);if(typeof B=="object"&&B!==null){switch(B.$$typeof){case Yb:return B.key===K?f(P,N,B,$):null;case Hg:return B.key===K?g(P,N,B,$):null;case Ad:return K=B._init,b(P,N,K(B._payload),$)}if($y(B)||Uy(B))return K!==null?null:y(P,N,B,$,null);Pw(P,B)}return null}function A(P,N,B,$,K){if(typeof $=="string"&&$!==""||typeof $=="number")return P=P.get(B)||null,l(N,P,""+$,K);if(typeof $=="object"&&$!==null){switch($.$$typeof){case Yb:return P=P.get($.key===null?B:$.key)||null,f(N,P,$,K);case Hg:return P=P.get($.key===null?B:$.key)||null,g(N,P,$,K);case Ad:var q=$._init;return A(P,N,B,q($._payload),K)}if($y($)||Uy($))return P=P.get(B)||null,y(N,P,$,K,null);Pw(N,$)}return null}function I(P,N,B,$){for(var K=null,q=null,W=N,ie=N=0,Z=null;W!==null&&ie<B.length;ie++){W.index>ie?(Z=W,W=null):Z=W.sibling;var X=b(P,W,B[ie],$);if(X===null){W===null&&(W=Z);break}t&&W&&X.alternate===null&&e(P,W),N=a(X,N,ie),q===null?K=X:q.sibling=X,q=X,W=Z}if(ie===B.length)return n(P,W),Dr&&gp(P,ie),K;if(W===null){for(;ie<B.length;ie++)W=S(P,B[ie],$),W!==null&&(N=a(W,N,ie),q===null?K=W:q.sibling=W,q=W);return Dr&&gp(P,ie),K}for(W=i(P,W);ie<B.length;ie++)Z=A(W,P,ie,B[ie],$),Z!==null&&(t&&Z.alternate!==null&&W.delete(Z.key===null?ie:Z.key),N=a(Z,N,ie),q===null?K=Z:q.sibling=Z,q=Z);return t&&W.forEach(function(se){return e(P,se)}),Dr&&gp(P,ie),K}function D(P,N,B,$){var K=Uy(B);if(typeof K!="function")throw Error(Qt(150));if(B=K.call(B),B==null)throw Error(Qt(151));for(var q=K=null,W=N,ie=N=0,Z=null,X=B.next();W!==null&&!X.done;ie++,X=B.next()){W.index>ie?(Z=W,W=null):Z=W.sibling;var se=b(P,W,X.value,$);if(se===null){W===null&&(W=Z);break}t&&W&&se.alternate===null&&e(P,W),N=a(se,N,ie),q===null?K=se:q.sibling=se,q=se,W=Z}if(X.done)return n(P,W),Dr&&gp(P,ie),K;if(W===null){for(;!X.done;ie++,X=B.next())X=S(P,X.value,$),X!==null&&(N=a(X,N,ie),q===null?K=X:q.sibling=X,q=X);return Dr&&gp(P,ie),K}for(W=i(P,W);!X.done;ie++,X=B.next())X=A(W,P,ie,X.value,$),X!==null&&(t&&X.alternate!==null&&W.delete(X.key===null?ie:X.key),N=a(X,N,ie),q===null?K=X:q.sibling=X,q=X);return t&&W.forEach(function(De){return e(P,De)}),Dr&&gp(P,ie),K}function L(P,N,B,$){if(typeof B=="object"&&B!==null&&B.type===Gg&&B.key===null&&(B=B.props.children),typeof B=="object"&&B!==null){switch(B.$$typeof){case Yb:e:{for(var K=B.key,q=N;q!==null;){if(q.key===K){if(K=B.type,K===Gg){if(q.tag===7){n(P,q.sibling),N=r(q,B.props.children),N.return=P,P=N;break e}}else if(q.elementType===K||typeof K=="object"&&K!==null&&K.$$typeof===Ad&&Tz(K)===q.type){n(P,q.sibling),N=r(q,B.props),N.ref=f_(P,q,B),N.return=P,P=N;break e}n(P,q);break}else e(P,q);q=q.sibling}B.type===Gg?(N=Ep(B.props.children,P.mode,$,B.key),N.return=P,P=N):($=Qw(B.type,B.key,B.props,null,P.mode,$),$.ref=f_(P,N,B),$.return=P,P=$)}return u(P);case Hg:e:{for(q=B.key;N!==null;){if(N.key===q)if(N.tag===4&&N.stateNode.containerInfo===B.containerInfo&&N.stateNode.implementation===B.implementation){n(P,N.sibling),N=r(N,B.children||[]),N.return=P,P=N;break e}else{n(P,N);break}else e(P,N);N=N.sibling}N=SP(B,P.mode,$),N.return=P,P=N}return u(P);case Ad:return q=B._init,L(P,N,q(B._payload),$)}if($y(B))return I(P,N,B,$);if(Uy(B))return D(P,N,B,$);Pw(P,B)}return typeof B=="string"&&B!==""||typeof B=="number"?(B=""+B,N!==null&&N.tag===6?(n(P,N.sibling),N=r(N,B),N.return=P,P=N):(n(P,N),N=wP(B,P.mode,$),N.return=P,P=N),u(P)):n(P,N)}return L}var av=Az(!0),Pz=Az(!1),Iw=zd(null),Rw=null,lv=null,LA=null;function kA(){LA=lv=Rw=null}function DA(t){var e=Iw.current;Tr(Iw),t._currentValue=e}function OA(t,e,n){for(;t!==null;){var i=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),t===n)break;t=t.return}}function cv(t,e){Rw=t,LA=lv=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(ga=!0),t.firstContext=null)}function Pl(t){var e=t._currentValue;if(LA!==t)if(t={context:t,memoizedValue:e,next:null},lv===null){if(Rw===null)throw Error(Qt(308));lv=t,Rw.dependencies={lanes:0,firstContext:t}}else lv=lv.next=t;return e}var vp=null;function FA(t){vp===null?vp=[t]:vp.push(t)}function Iz(t,e,n,i){var r=e.interleaved;return r===null?(n.next=n,FA(e)):(n.next=r.next,r.next=n),e.interleaved=n,ph(t,i)}function ph(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Ud=!1;function zA(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Rz(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function mh(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Vd(t,e,n){var i=t.updateQueue;if(i===null)return null;if(i=i.shared,Vi&2){var r=i.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),i.pending=e,ph(t,n)}return r=i.interleaved,r===null?(e.next=e,FA(i)):(e.next=r.next,r.next=e),i.interleaved=e,ph(t,n)}function Lw(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,KT(t,n)}}function Lz(t,e){var n=t.updateQueue,i=t.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var r=null,a=null;if(n=n.firstBaseUpdate,n!==null){do{var u={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};a===null?r=a=u:a=a.next=u,n=n.next}while(n!==null);a===null?r=a=e:a=a.next=e}else r=a=e;n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:a,shared:i.shared,effects:i.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function kw(t,e,n,i){var r=t.updateQueue;Ud=!1;var a=r.firstBaseUpdate,u=r.lastBaseUpdate,l=r.shared.pending;if(l!==null){r.shared.pending=null;var f=l,g=f.next;f.next=null,u===null?a=g:u.next=g,u=f;var y=t.alternate;y!==null&&(y=y.updateQueue,l=y.lastBaseUpdate,l!==u&&(l===null?y.firstBaseUpdate=g:l.next=g,y.lastBaseUpdate=f))}if(a!==null){var S=r.baseState;u=0,y=g=f=null,l=a;do{var b=l.lane,A=l.eventTime;if((i&b)===b){y!==null&&(y=y.next={eventTime:A,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var I=t,D=l;switch(b=e,A=n,D.tag){case 1:if(I=D.payload,typeof I=="function"){S=I.call(A,S,b);break e}S=I;break e;case 3:I.flags=I.flags&-65537|128;case 0:if(I=D.payload,b=typeof I=="function"?I.call(A,S,b):I,b==null)break e;S=$r({},S,b);break e;case 2:Ud=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,b=r.effects,b===null?r.effects=[l]:b.push(l))}else A={eventTime:A,lane:b,tag:l.tag,payload:l.payload,callback:l.callback,next:null},y===null?(g=y=A,f=S):y=y.next=A,u|=b;if(l=l.next,l===null){if(l=r.shared.pending,l===null)break;b=l,l=b.next,b.next=null,r.lastBaseUpdate=b,r.shared.pending=null}}while(!0);if(y===null&&(f=S),r.baseState=f,r.firstBaseUpdate=g,r.lastBaseUpdate=y,e=r.shared.interleaved,e!==null){r=e;do u|=r.lane,r=r.next;while(r!==e)}else a===null&&(r.shared.lanes=0);xp|=u,t.lanes=u,t.memoizedState=S}}function kz(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var i=t[e],r=i.callback;if(r!==null){if(i.callback=null,i=n,typeof r!="function")throw Error(Qt(191,r));r.call(i)}}}var p_={},ru=zd(p_),m_=zd(p_),g_=zd(p_);function yp(t){if(t===p_)throw Error(Qt(174));return t}function NA(t,e){switch(br(g_,e),br(m_,t),br(ru,p_),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:BT(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=BT(e,t)}Tr(ru),br(ru,e)}function uv(){Tr(ru),Tr(m_),Tr(g_)}function Dz(t){yp(g_.current);var e=yp(ru.current),n=BT(e,t.type);e!==n&&(br(m_,t),br(ru,n))}function BA(t){m_.current===t&&(Tr(ru),Tr(m_))}var Hr=zd(0);function Dw(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var UA=[];function VA(){for(var t=0;t<UA.length;t++)UA[t]._workInProgressVersionPrimary=null;UA.length=0}var Ow=ch.ReactCurrentDispatcher,$A=ch.ReactCurrentBatchConfig,_p=0,Gr=null,Ps=null,js=null,Fw=!1,v_=!1,y_=0,EZ=0;function Ao(){throw Error(Qt(321))}function HA(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!pc(t[n],e[n]))return!1;return!0}function GA(t,e,n,i,r,a){if(_p=a,Gr=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Ow.current=t===null||t.memoizedState===null?AZ:PZ,t=n(i,r),v_){a=0;do{if(v_=!1,y_=0,25<=a)throw Error(Qt(301));a+=1,js=Ps=null,e.updateQueue=null,Ow.current=IZ,t=n(i,r)}while(v_)}if(Ow.current=Bw,e=Ps!==null&&Ps.next!==null,_p=0,js=Ps=Gr=null,Fw=!1,e)throw Error(Qt(300));return t}function WA(){var t=y_!==0;return y_=0,t}function su(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return js===null?Gr.memoizedState=js=t:js=js.next=t,js}function Il(){if(Ps===null){var t=Gr.alternate;t=t!==null?t.memoizedState:null}else t=Ps.next;var e=js===null?Gr.memoizedState:js.next;if(e!==null)js=e,Ps=t;else{if(t===null)throw Error(Qt(310));Ps=t,t={memoizedState:Ps.memoizedState,baseState:Ps.baseState,baseQueue:Ps.baseQueue,queue:Ps.queue,next:null},js===null?Gr.memoizedState=js=t:js=js.next=t}return js}function __(t,e){return typeof e=="function"?e(t):e}function jA(t){var e=Il(),n=e.queue;if(n===null)throw Error(Qt(311));n.lastRenderedReducer=t;var i=Ps,r=i.baseQueue,a=n.pending;if(a!==null){if(r!==null){var u=r.next;r.next=a.next,a.next=u}i.baseQueue=r=a,n.pending=null}if(r!==null){a=r.next,i=i.baseState;var l=u=null,f=null,g=a;do{var y=g.lane;if((_p&y)===y)f!==null&&(f=f.next={lane:0,action:g.action,hasEagerState:g.hasEagerState,eagerState:g.eagerState,next:null}),i=g.hasEagerState?g.eagerState:t(i,g.action);else{var S={lane:y,action:g.action,hasEagerState:g.hasEagerState,eagerState:g.eagerState,next:null};f===null?(l=f=S,u=i):f=f.next=S,Gr.lanes|=y,xp|=y}g=g.next}while(g!==null&&g!==a);f===null?u=i:f.next=l,pc(i,e.memoizedState)||(ga=!0),e.memoizedState=i,e.baseState=u,e.baseQueue=f,n.lastRenderedState=i}if(t=n.interleaved,t!==null){r=t;do a=r.lane,Gr.lanes|=a,xp|=a,r=r.next;while(r!==t)}else r===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function qA(t){var e=Il(),n=e.queue;if(n===null)throw Error(Qt(311));n.lastRenderedReducer=t;var i=n.dispatch,r=n.pending,a=e.memoizedState;if(r!==null){n.pending=null;var u=r=r.next;do a=t(a,u.action),u=u.next;while(u!==r);pc(a,e.memoizedState)||(ga=!0),e.memoizedState=a,e.baseQueue===null&&(e.baseState=a),n.lastRenderedState=a}return[a,i]}function Oz(){}function Fz(t,e){var n=Gr,i=Il(),r=e(),a=!pc(i.memoizedState,r);if(a&&(i.memoizedState=r,ga=!0),i=i.queue,XA(Bz.bind(null,n,i,t),[t]),i.getSnapshot!==e||a||js!==null&&js.memoizedState.tag&1){if(n.flags|=2048,x_(9,Nz.bind(null,n,i,r,e),void 0,null),qs===null)throw Error(Qt(349));_p&30||zz(n,e,r)}return r}function zz(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Gr.updateQueue,e===null?(e={lastEffect:null,stores:null},Gr.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function Nz(t,e,n,i){e.value=n,e.getSnapshot=i,Uz(e)&&Vz(t)}function Bz(t,e,n){return n(function(){Uz(e)&&Vz(t)})}function Uz(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!pc(t,n)}catch{return!0}}function Vz(t){var e=ph(t,1);e!==null&&_c(e,t,1,-1)}function $z(t){var e=su();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:__,lastRenderedState:t},e.queue=t,t=t.dispatch=TZ.bind(null,Gr,t),[e.memoizedState,t]}function x_(t,e,n,i){return t={tag:t,create:e,destroy:n,deps:i,next:null},e=Gr.updateQueue,e===null?(e={lastEffect:null,stores:null},Gr.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(i=n.next,n.next=t,t.next=i,e.lastEffect=t)),t}function Hz(){return Il().memoizedState}function zw(t,e,n,i){var r=su();Gr.flags|=t,r.memoizedState=x_(1|e,n,void 0,i===void 0?null:i)}function Nw(t,e,n,i){var r=Il();i=i===void 0?null:i;var a=void 0;if(Ps!==null){var u=Ps.memoizedState;if(a=u.destroy,i!==null&&HA(i,u.deps)){r.memoizedState=x_(e,n,a,i);return}}Gr.flags|=t,r.memoizedState=x_(1|e,n,a,i)}function Gz(t,e){return zw(8390656,8,t,e)}function XA(t,e){return Nw(2048,8,t,e)}function Wz(t,e){return Nw(4,2,t,e)}function jz(t,e){return Nw(4,4,t,e)}function qz(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Xz(t,e,n){return n=n!=null?n.concat([t]):null,Nw(4,4,qz.bind(null,e,t),n)}function ZA(){}function Zz(t,e){var n=Il();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&HA(e,i[1])?i[0]:(n.memoizedState=[t,e],t)}function Yz(t,e){var n=Il();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&HA(e,i[1])?i[0]:(t=t(),n.memoizedState=[t,e],t)}function Kz(t,e,n){return _p&21?(pc(n,e)||(n=TF(),Gr.lanes|=n,xp|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,ga=!0),t.memoizedState=n)}function MZ(t,e){var n=lr;lr=n!==0&&4>n?n:4,t(!0);var i=$A.transition;$A.transition={};try{t(!1),e()}finally{lr=n,$A.transition=i}}function Jz(){return Il().memoizedState}function CZ(t,e,n){var i=Wd(t);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},Qz(t))e5(e,n);else if(n=Iz(t,e,n,i),n!==null){var r=Yo();_c(n,t,i,r),t5(n,e,i)}}function TZ(t,e,n){var i=Wd(t),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(Qz(t))e5(e,r);else{var a=t.alternate;if(t.lanes===0&&(a===null||a.lanes===0)&&(a=e.lastRenderedReducer,a!==null))try{var u=e.lastRenderedState,l=a(u,n);if(r.hasEagerState=!0,r.eagerState=l,pc(l,u)){var f=e.interleaved;f===null?(r.next=r,FA(e)):(r.next=f.next,f.next=r),e.interleaved=r;return}}catch{}finally{}n=Iz(t,e,r,i),n!==null&&(r=Yo(),_c(n,t,i,r),t5(n,e,i))}}function Qz(t){var e=t.alternate;return t===Gr||e!==null&&e===Gr}function e5(t,e){v_=Fw=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function t5(t,e,n){if(n&4194240){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,KT(t,n)}}var Bw={readContext:Pl,useCallback:Ao,useContext:Ao,useEffect:Ao,useImperativeHandle:Ao,useInsertionEffect:Ao,useLayoutEffect:Ao,useMemo:Ao,useReducer:Ao,useRef:Ao,useState:Ao,useDebugValue:Ao,useDeferredValue:Ao,useTransition:Ao,useMutableSource:Ao,useSyncExternalStore:Ao,useId:Ao,unstable_isNewReconciler:!1},AZ={readContext:Pl,useCallback:function(t,e){return su().memoizedState=[t,e===void 0?null:e],t},useContext:Pl,useEffect:Gz,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,zw(4194308,4,qz.bind(null,e,t),n)},useLayoutEffect:function(t,e){return zw(4194308,4,t,e)},useInsertionEffect:function(t,e){return zw(4,2,t,e)},useMemo:function(t,e){var n=su();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var i=su();return e=n!==void 0?n(e):e,i.memoizedState=i.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},i.queue=t,t=t.dispatch=CZ.bind(null,Gr,t),[i.memoizedState,t]},useRef:function(t){var e=su();return t={current:t},e.memoizedState=t},useState:$z,useDebugValue:ZA,useDeferredValue:function(t){return su().memoizedState=t},useTransition:function(){var t=$z(!1),e=t[0];return t=MZ.bind(null,t[1]),su().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var i=Gr,r=su();if(Dr){if(n===void 0)throw Error(Qt(407));n=n()}else{if(n=e(),qs===null)throw Error(Qt(349));_p&30||zz(i,e,n)}r.memoizedState=n;var a={value:n,getSnapshot:e};return r.queue=a,Gz(Bz.bind(null,i,a,t),[t]),i.flags|=2048,x_(9,Nz.bind(null,i,a,n,e),void 0,null),n},useId:function(){var t=su(),e=qs.identifierPrefix;if(Dr){var n=fh,i=dh;n=(i&~(1<<32-fc(i)-1)).toString(32)+n,e=":"+e+"R"+n,n=y_++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=EZ++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},PZ={readContext:Pl,useCallback:Zz,useContext:Pl,useEffect:XA,useImperativeHandle:Xz,useInsertionEffect:Wz,useLayoutEffect:jz,useMemo:Yz,useReducer:jA,useRef:Hz,useState:function(){return jA(__)},useDebugValue:ZA,useDeferredValue:function(t){var e=Il();return Kz(e,Ps.memoizedState,t)},useTransition:function(){var t=jA(__)[0],e=Il().memoizedState;return[t,e]},useMutableSource:Oz,useSyncExternalStore:Fz,useId:Jz,unstable_isNewReconciler:!1},IZ={readContext:Pl,useCallback:Zz,useContext:Pl,useEffect:XA,useImperativeHandle:Xz,useInsertionEffect:Wz,useLayoutEffect:jz,useMemo:Yz,useReducer:qA,useRef:Hz,useState:function(){return qA(__)},useDebugValue:ZA,useDeferredValue:function(t){var e=Il();return Ps===null?e.memoizedState=t:Kz(e,Ps.memoizedState,t)},useTransition:function(){var t=qA(__)[0],e=Il().memoizedState;return[t,e]},useMutableSource:Oz,useSyncExternalStore:Fz,useId:Jz,unstable_isNewReconciler:!1};function gc(t,e){if(t&&t.defaultProps){e=$r({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function YA(t,e,n,i){e=t.memoizedState,n=n(i,e),n=n==null?e:$r({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Uw={isMounted:function(t){return(t=t._reactInternals)?dp(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var i=Yo(),r=Wd(t),a=mh(i,r);a.payload=e,n!=null&&(a.callback=n),e=Vd(t,a,r),e!==null&&(_c(e,t,r,i),Lw(e,t,r))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var i=Yo(),r=Wd(t),a=mh(i,r);a.tag=1,a.payload=e,n!=null&&(a.callback=n),e=Vd(t,a,r),e!==null&&(_c(e,t,r,i),Lw(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Yo(),i=Wd(t),r=mh(n,i);r.tag=2,e!=null&&(r.callback=e),e=Vd(t,r,i),e!==null&&(_c(e,t,i,n),Lw(e,t,i))}};function n5(t,e,n,i,r,a,u){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(i,a,u):e.prototype&&e.prototype.isPureReactComponent?!o_(n,i)||!o_(r,a):!0}function i5(t,e,n){var i=!1,r=Nd,a=e.contextType;return typeof a=="object"&&a!==null?a=Pl(a):(r=ma(e)?pp:To.current,i=e.contextTypes,a=(i=i!=null)?iv(t,r):Nd),e=new e(n,a),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Uw,t.stateNode=e,e._reactInternals=t,i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=a),e}function r5(t,e,n,i){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,i),e.state!==t&&Uw.enqueueReplaceState(e,e.state,null)}function KA(t,e,n,i){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs={},zA(t);var a=e.contextType;typeof a=="object"&&a!==null?r.context=Pl(a):(a=ma(e)?pp:To.current,r.context=iv(t,a)),r.state=t.memoizedState,a=e.getDerivedStateFromProps,typeof a=="function"&&(YA(t,e,a,n),r.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&Uw.enqueueReplaceState(r,r.state,null),kw(t,n,r,i),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308)}function hv(t,e){try{var n="",i=e;do n+=rX(i),i=i.return;while(i);var r=n}catch(a){r=`
Error generating stack: `+a.message+`
`+a.stack}return{value:t,source:e,stack:r,digest:null}}function JA(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function QA(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var RZ=typeof WeakMap=="function"?WeakMap:Map;function s5(t,e,n){n=mh(-1,n),n.tag=3,n.payload={element:null};var i=e.value;return n.callback=function(){qw||(qw=!0,pP=i),QA(t,e)},n}function o5(t,e,n){n=mh(-1,n),n.tag=3;var i=t.type.getDerivedStateFromError;if(typeof i=="function"){var r=e.value;n.payload=function(){return i(r)},n.callback=function(){QA(t,e)}}var a=t.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(n.callback=function(){QA(t,e),typeof i!="function"&&(Hd===null?Hd=new Set([this]):Hd.add(this));var u=e.stack;this.componentDidCatch(e.value,{componentStack:u!==null?u:""})}),n}function a5(t,e,n){var i=t.pingCache;if(i===null){i=t.pingCache=new RZ;var r=new Set;i.set(e,r)}else r=i.get(e),r===void 0&&(r=new Set,i.set(e,r));r.has(n)||(r.add(n),t=WZ.bind(null,t,e,n),e.then(t,t))}function l5(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function c5(t,e,n,i,r){return t.mode&1?(t.flags|=65536,t.lanes=r,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=mh(-1,1),e.tag=2,Vd(n,e,1))),n.lanes|=1),t)}var LZ=ch.ReactCurrentOwner,ga=!1;function Zo(t,e,n,i){e.child=t===null?Pz(e,null,n,i):av(e,t.child,n,i)}function u5(t,e,n,i,r){n=n.render;var a=e.ref;return cv(e,r),i=GA(t,e,n,i,a,r),n=WA(),t!==null&&!ga?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,gh(t,e,r)):(Dr&&n&&TA(e),e.flags|=1,Zo(t,e,i,r),e.child)}function h5(t,e,n,i,r){if(t===null){var a=n.type;return typeof a=="function"&&!bP(a)&&a.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=a,d5(t,e,a,i,r)):(t=Qw(n.type,null,i,e,e.mode,r),t.ref=e.ref,t.return=e,e.child=t)}if(a=t.child,!(t.lanes&r)){var u=a.memoizedProps;if(n=n.compare,n=n!==null?n:o_,n(u,i)&&t.ref===e.ref)return gh(t,e,r)}return e.flags|=1,t=qd(a,i),t.ref=e.ref,t.return=e,e.child=t}function d5(t,e,n,i,r){if(t!==null){var a=t.memoizedProps;if(o_(a,i)&&t.ref===e.ref)if(ga=!1,e.pendingProps=i=a,(t.lanes&r)!==0)t.flags&131072&&(ga=!0);else return e.lanes=t.lanes,gh(t,e,r)}return eP(t,e,n,i,r)}function f5(t,e,n){var i=e.pendingProps,r=i.children,a=t!==null?t.memoizedState:null;if(i.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},br(fv,qa),qa|=n;else{if(!(n&1073741824))return t=a!==null?a.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,br(fv,qa),qa|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=a!==null?a.baseLanes:n,br(fv,qa),qa|=i}else a!==null?(i=a.baseLanes|n,e.memoizedState=null):i=n,br(fv,qa),qa|=i;return Zo(t,e,r,n),e.child}function p5(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function eP(t,e,n,i,r){var a=ma(n)?pp:To.current;return a=iv(e,a),cv(e,r),n=GA(t,e,n,i,a,r),i=WA(),t!==null&&!ga?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,gh(t,e,r)):(Dr&&i&&TA(e),e.flags|=1,Zo(t,e,n,r),e.child)}function m5(t,e,n,i,r){if(ma(n)){var a=!0;Ew(e)}else a=!1;if(cv(e,r),e.stateNode===null)$w(t,e),i5(e,n,i),KA(e,n,i,r),i=!0;else if(t===null){var u=e.stateNode,l=e.memoizedProps;u.props=l;var f=u.context,g=n.contextType;typeof g=="object"&&g!==null?g=Pl(g):(g=ma(n)?pp:To.current,g=iv(e,g));var y=n.getDerivedStateFromProps,S=typeof y=="function"||typeof u.getSnapshotBeforeUpdate=="function";S||typeof u.UNSAFE_componentWillReceiveProps!="function"&&typeof u.componentWillReceiveProps!="function"||(l!==i||f!==g)&&r5(e,u,i,g),Ud=!1;var b=e.memoizedState;u.state=b,kw(e,i,u,r),f=e.memoizedState,l!==i||b!==f||pa.current||Ud?(typeof y=="function"&&(YA(e,n,y,i),f=e.memoizedState),(l=Ud||n5(e,n,l,i,b,f,g))?(S||typeof u.UNSAFE_componentWillMount!="function"&&typeof u.componentWillMount!="function"||(typeof u.componentWillMount=="function"&&u.componentWillMount(),typeof u.UNSAFE_componentWillMount=="function"&&u.UNSAFE_componentWillMount()),typeof u.componentDidMount=="function"&&(e.flags|=4194308)):(typeof u.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=f),u.props=i,u.state=f,u.context=g,i=l):(typeof u.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{u=e.stateNode,Rz(t,e),l=e.memoizedProps,g=e.type===e.elementType?l:gc(e.type,l),u.props=g,S=e.pendingProps,b=u.context,f=n.contextType,typeof f=="object"&&f!==null?f=Pl(f):(f=ma(n)?pp:To.current,f=iv(e,f));var A=n.getDerivedStateFromProps;(y=typeof A=="function"||typeof u.getSnapshotBeforeUpdate=="function")||typeof u.UNSAFE_componentWillReceiveProps!="function"&&typeof u.componentWillReceiveProps!="function"||(l!==S||b!==f)&&r5(e,u,i,f),Ud=!1,b=e.memoizedState,u.state=b,kw(e,i,u,r);var I=e.memoizedState;l!==S||b!==I||pa.current||Ud?(typeof A=="function"&&(YA(e,n,A,i),I=e.memoizedState),(g=Ud||n5(e,n,g,i,b,I,f)||!1)?(y||typeof u.UNSAFE_componentWillUpdate!="function"&&typeof u.componentWillUpdate!="function"||(typeof u.componentWillUpdate=="function"&&u.componentWillUpdate(i,I,f),typeof u.UNSAFE_componentWillUpdate=="function"&&u.UNSAFE_componentWillUpdate(i,I,f)),typeof u.componentDidUpdate=="function"&&(e.flags|=4),typeof u.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof u.componentDidUpdate!="function"||l===t.memoizedProps&&b===t.memoizedState||(e.flags|=4),typeof u.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&b===t.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=I),u.props=i,u.state=I,u.context=f,i=g):(typeof u.componentDidUpdate!="function"||l===t.memoizedProps&&b===t.memoizedState||(e.flags|=4),typeof u.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&b===t.memoizedState||(e.flags|=1024),i=!1)}return tP(t,e,n,i,a,r)}function tP(t,e,n,i,r,a){p5(t,e);var u=(e.flags&128)!==0;if(!i&&!u)return r&&xz(e,n,!1),gh(t,e,a);i=e.stateNode,LZ.current=e;var l=u&&typeof n.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,t!==null&&u?(e.child=av(e,t.child,null,a),e.child=av(e,null,l,a)):Zo(t,e,l,a),e.memoizedState=i.state,r&&xz(e,n,!0),e.child}function g5(t){var e=t.stateNode;e.pendingContext?yz(t,e.pendingContext,e.pendingContext!==e.context):e.context&&yz(t,e.context,!1),NA(t,e.containerInfo)}function v5(t,e,n,i,r){return ov(),RA(r),e.flags|=256,Zo(t,e,n,i),e.child}var nP={dehydrated:null,treeContext:null,retryLane:0};function iP(t){return{baseLanes:t,cachePool:null,transitions:null}}function y5(t,e,n){var i=e.pendingProps,r=Hr.current,a=!1,u=(e.flags&128)!==0,l;if((l=u)||(l=t!==null&&t.memoizedState===null?!1:(r&2)!==0),l?(a=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(r|=1),br(Hr,r&1),t===null)return IA(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(u=i.children,t=i.fallback,a?(i=e.mode,a=e.child,u={mode:"hidden",children:u},!(i&1)&&a!==null?(a.childLanes=0,a.pendingProps=u):a=eS(u,i,0,null),t=Ep(t,i,n,null),a.return=e,t.return=e,a.sibling=t,e.child=a,e.child.memoizedState=iP(n),e.memoizedState=nP,t):rP(e,u));if(r=t.memoizedState,r!==null&&(l=r.dehydrated,l!==null))return kZ(t,e,u,i,l,r,n);if(a){a=i.fallback,u=e.mode,r=t.child,l=r.sibling;var f={mode:"hidden",children:i.children};return!(u&1)&&e.child!==r?(i=e.child,i.childLanes=0,i.pendingProps=f,e.deletions=null):(i=qd(r,f),i.subtreeFlags=r.subtreeFlags&14680064),l!==null?a=qd(l,a):(a=Ep(a,u,n,null),a.flags|=2),a.return=e,i.return=e,i.sibling=a,e.child=i,i=a,a=e.child,u=t.child.memoizedState,u=u===null?iP(n):{baseLanes:u.baseLanes|n,cachePool:null,transitions:u.transitions},a.memoizedState=u,a.childLanes=t.childLanes&~n,e.memoizedState=nP,i}return a=t.child,t=a.sibling,i=qd(a,{mode:"visible",children:i.children}),!(e.mode&1)&&(i.lanes=n),i.return=e,i.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=i,e.memoizedState=null,i}function rP(t,e){return e=eS({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Vw(t,e,n,i){return i!==null&&RA(i),av(e,t.child,null,n),t=rP(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function kZ(t,e,n,i,r,a,u){if(n)return e.flags&256?(e.flags&=-257,i=JA(Error(Qt(422))),Vw(t,e,u,i)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(a=i.fallback,r=e.mode,i=eS({mode:"visible",children:i.children},r,0,null),a=Ep(a,r,u,null),a.flags|=2,i.return=e,a.return=e,i.sibling=a,e.child=i,e.mode&1&&av(e,t.child,null,u),e.child.memoizedState=iP(u),e.memoizedState=nP,a);if(!(e.mode&1))return Vw(t,e,u,null);if(r.data==="$!"){if(i=r.nextSibling&&r.nextSibling.dataset,i)var l=i.dgst;return i=l,a=Error(Qt(419)),i=JA(a,i,void 0),Vw(t,e,u,i)}if(l=(u&t.childLanes)!==0,ga||l){if(i=qs,i!==null){switch(u&-u){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(i.suspendedLanes|u)?0:r,r!==0&&r!==a.retryLane&&(a.retryLane=r,ph(t,r),_c(i,t,r,-1))}return xP(),i=JA(Error(Qt(421))),Vw(t,e,u,i)}return r.data==="$?"?(e.flags|=128,e.child=t.child,e=jZ.bind(null,t),r._reactRetry=e,null):(t=a.treeContext,ja=Fd(r.nextSibling),Wa=e,Dr=!0,mc=null,t!==null&&(Tl[Al++]=dh,Tl[Al++]=fh,Tl[Al++]=mp,dh=t.id,fh=t.overflow,mp=e),e=rP(e,i.children),e.flags|=4096,e)}function _5(t,e,n){t.lanes|=e;var i=t.alternate;i!==null&&(i.lanes|=e),OA(t.return,e,n)}function sP(t,e,n,i,r){var a=t.memoizedState;a===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=i,a.tail=n,a.tailMode=r)}function x5(t,e,n){var i=e.pendingProps,r=i.revealOrder,a=i.tail;if(Zo(t,e,i.children,n),i=Hr.current,i&2)i=i&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&_5(t,n,e);else if(t.tag===19)_5(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}i&=1}if(br(Hr,i),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;n!==null;)t=n.alternate,t!==null&&Dw(t)===null&&(r=n),n=n.sibling;n=r,n===null?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),sP(e,!1,r,n,a);break;case"backwards":for(n=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&Dw(t)===null){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}sP(e,!0,n,null,a);break;case"together":sP(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function $w(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function gh(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),xp|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Qt(153));if(e.child!==null){for(t=e.child,n=qd(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=qd(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function DZ(t,e,n){switch(e.tag){case 3:g5(e),ov();break;case 5:Dz(e);break;case 1:ma(e.type)&&Ew(e);break;case 4:NA(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,r=e.memoizedProps.value;br(Iw,i._currentValue),i._currentValue=r;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?(br(Hr,Hr.current&1),e.flags|=128,null):n&e.child.childLanes?y5(t,e,n):(br(Hr,Hr.current&1),t=gh(t,e,n),t!==null?t.sibling:null);br(Hr,Hr.current&1);break;case 19:if(i=(n&e.childLanes)!==0,t.flags&128){if(i)return x5(t,e,n);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),br(Hr,Hr.current),i)break;return null;case 22:case 23:return e.lanes=0,f5(t,e,n)}return gh(t,e,n)}var b5,oP,w5,S5;b5=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},oP=function(){},w5=function(t,e,n,i){var r=t.memoizedProps;if(r!==i){t=e.stateNode,yp(ru.current);var a=null;switch(n){case"input":r=OT(t,r),i=OT(t,i),a=[];break;case"select":r=$r({},r,{value:void 0}),i=$r({},i,{value:void 0}),a=[];break;case"textarea":r=NT(t,r),i=NT(t,i),a=[];break;default:typeof r.onClick!="function"&&typeof i.onClick=="function"&&(t.onclick=bw)}UT(n,i);var u;n=null;for(g in r)if(!i.hasOwnProperty(g)&&r.hasOwnProperty(g)&&r[g]!=null)if(g==="style"){var l=r[g];for(u in l)l.hasOwnProperty(u)&&(n||(n={}),n[u]="")}else g!=="dangerouslySetInnerHTML"&&g!=="children"&&g!=="suppressContentEditableWarning"&&g!=="suppressHydrationWarning"&&g!=="autoFocus"&&(By.hasOwnProperty(g)?a||(a=[]):(a=a||[]).push(g,null));for(g in i){var f=i[g];if(l=r!=null?r[g]:void 0,i.hasOwnProperty(g)&&f!==l&&(f!=null||l!=null))if(g==="style")if(l){for(u in l)!l.hasOwnProperty(u)||f&&f.hasOwnProperty(u)||(n||(n={}),n[u]="");for(u in f)f.hasOwnProperty(u)&&l[u]!==f[u]&&(n||(n={}),n[u]=f[u])}else n||(a||(a=[]),a.push(g,n)),n=f;else g==="dangerouslySetInnerHTML"?(f=f?f.__html:void 0,l=l?l.__html:void 0,f!=null&&l!==f&&(a=a||[]).push(g,f)):g==="children"?typeof f!="string"&&typeof f!="number"||(a=a||[]).push(g,""+f):g!=="suppressContentEditableWarning"&&g!=="suppressHydrationWarning"&&(By.hasOwnProperty(g)?(f!=null&&g==="onScroll"&&Cr("scroll",t),a||l===f||(a=[])):(a=a||[]).push(g,f))}n&&(a=a||[]).push("style",n);var g=a;(e.updateQueue=g)&&(e.flags|=4)}},S5=function(t,e,n,i){n!==i&&(e.flags|=4)};function b_(t,e){if(!Dr)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:i.sibling=null}}function Po(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,i=0;if(e)for(var r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags&14680064,i|=r.flags&14680064,r.return=t,r=r.sibling;else for(r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=i,t.childLanes=n,e}function OZ(t,e,n){var i=e.pendingProps;switch(AA(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Po(e),null;case 1:return ma(e.type)&&Sw(),Po(e),null;case 3:return i=e.stateNode,uv(),Tr(pa),Tr(To),VA(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(t===null||t.child===null)&&(Aw(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,mc!==null&&(vP(mc),mc=null))),oP(t,e),Po(e),null;case 5:BA(e);var r=yp(g_.current);if(n=e.type,t!==null&&e.stateNode!=null)w5(t,e,n,i,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(Qt(166));return Po(e),null}if(t=yp(ru.current),Aw(e)){i=e.stateNode,n=e.type;var a=e.memoizedProps;switch(i[iu]=e,i[h_]=a,t=(e.mode&1)!==0,n){case"dialog":Cr("cancel",i),Cr("close",i);break;case"iframe":case"object":case"embed":Cr("load",i);break;case"video":case"audio":for(r=0;r<l_.length;r++)Cr(l_[r],i);break;case"source":Cr("error",i);break;case"img":case"image":case"link":Cr("error",i),Cr("load",i);break;case"details":Cr("toggle",i);break;case"input":iF(i,a),Cr("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!a.multiple},Cr("invalid",i);break;case"textarea":oF(i,a),Cr("invalid",i)}UT(n,a),r=null;for(var u in a)if(a.hasOwnProperty(u)){var l=a[u];u==="children"?typeof l=="string"?i.textContent!==l&&(a.suppressHydrationWarning!==!0&&xw(i.textContent,l,t),r=["children",l]):typeof l=="number"&&i.textContent!==""+l&&(a.suppressHydrationWarning!==!0&&xw(i.textContent,l,t),r=["children",""+l]):By.hasOwnProperty(u)&&l!=null&&u==="onScroll"&&Cr("scroll",i)}switch(n){case"input":Kb(i),sF(i,a,!0);break;case"textarea":Kb(i),lF(i);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(i.onclick=bw)}i=r,e.updateQueue=i,i!==null&&(e.flags|=4)}else{u=r.nodeType===9?r:r.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=cF(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=u.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof i.is=="string"?t=u.createElement(n,{is:i.is}):(t=u.createElement(n),n==="select"&&(u=t,i.multiple?u.multiple=!0:i.size&&(u.size=i.size))):t=u.createElementNS(t,n),t[iu]=e,t[h_]=i,b5(t,e,!1,!1),e.stateNode=t;e:{switch(u=VT(n,i),n){case"dialog":Cr("cancel",t),Cr("close",t),r=i;break;case"iframe":case"object":case"embed":Cr("load",t),r=i;break;case"video":case"audio":for(r=0;r<l_.length;r++)Cr(l_[r],t);r=i;break;case"source":Cr("error",t),r=i;break;case"img":case"image":case"link":Cr("error",t),Cr("load",t),r=i;break;case"details":Cr("toggle",t),r=i;break;case"input":iF(t,i),r=OT(t,i),Cr("invalid",t);break;case"option":r=i;break;case"select":t._wrapperState={wasMultiple:!!i.multiple},r=$r({},i,{value:void 0}),Cr("invalid",t);break;case"textarea":oF(t,i),r=NT(t,i),Cr("invalid",t);break;default:r=i}UT(n,r),l=r;for(a in l)if(l.hasOwnProperty(a)){var f=l[a];a==="style"?dF(t,f):a==="dangerouslySetInnerHTML"?(f=f?f.__html:void 0,f!=null&&uF(t,f)):a==="children"?typeof f=="string"?(n!=="textarea"||f!=="")&&Hy(t,f):typeof f=="number"&&Hy(t,""+f):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(By.hasOwnProperty(a)?f!=null&&a==="onScroll"&&Cr("scroll",t):f!=null&&ET(t,a,f,u))}switch(n){case"input":Kb(t),sF(t,i,!1);break;case"textarea":Kb(t),lF(t);break;case"option":i.value!=null&&t.setAttribute("value",""+Pd(i.value));break;case"select":t.multiple=!!i.multiple,a=i.value,a!=null?Wg(t,!!i.multiple,a,!1):i.defaultValue!=null&&Wg(t,!!i.multiple,i.defaultValue,!0);break;default:typeof r.onClick=="function"&&(t.onclick=bw)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Po(e),null;case 6:if(t&&e.stateNode!=null)S5(t,e,t.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(Qt(166));if(n=yp(g_.current),yp(ru.current),Aw(e)){if(i=e.stateNode,n=e.memoizedProps,i[iu]=e,(a=i.nodeValue!==n)&&(t=Wa,t!==null))switch(t.tag){case 3:xw(i.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&xw(i.nodeValue,n,(t.mode&1)!==0)}a&&(e.flags|=4)}else i=(n.nodeType===9?n:n.ownerDocument).createTextNode(i),i[iu]=e,e.stateNode=i}return Po(e),null;case 13:if(Tr(Hr),i=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Dr&&ja!==null&&e.mode&1&&!(e.flags&128))Cz(),ov(),e.flags|=98560,a=!1;else if(a=Aw(e),i!==null&&i.dehydrated!==null){if(t===null){if(!a)throw Error(Qt(318));if(a=e.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(Qt(317));a[iu]=e}else ov(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Po(e),a=!1}else mc!==null&&(vP(mc),mc=null),a=!0;if(!a)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(i=i!==null,i!==(t!==null&&t.memoizedState!==null)&&i&&(e.child.flags|=8192,e.mode&1&&(t===null||Hr.current&1?Is===0&&(Is=3):xP())),e.updateQueue!==null&&(e.flags|=4),Po(e),null);case 4:return uv(),oP(t,e),t===null&&c_(e.stateNode.containerInfo),Po(e),null;case 10:return DA(e.type._context),Po(e),null;case 17:return ma(e.type)&&Sw(),Po(e),null;case 19:if(Tr(Hr),a=e.memoizedState,a===null)return Po(e),null;if(i=(e.flags&128)!==0,u=a.rendering,u===null)if(i)b_(a,!1);else{if(Is!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(u=Dw(t),u!==null){for(e.flags|=128,b_(a,!1),i=u.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=n,n=e.child;n!==null;)a=n,t=i,a.flags&=14680066,u=a.alternate,u===null?(a.childLanes=0,a.lanes=t,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=u.childLanes,a.lanes=u.lanes,a.child=u.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=u.memoizedProps,a.memoizedState=u.memoizedState,a.updateQueue=u.updateQueue,a.type=u.type,t=u.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return br(Hr,Hr.current&1|2),e.child}t=t.sibling}a.tail!==null&&ss()>pv&&(e.flags|=128,i=!0,b_(a,!1),e.lanes=4194304)}else{if(!i)if(t=Dw(u),t!==null){if(e.flags|=128,i=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),b_(a,!0),a.tail===null&&a.tailMode==="hidden"&&!u.alternate&&!Dr)return Po(e),null}else 2*ss()-a.renderingStartTime>pv&&n!==1073741824&&(e.flags|=128,i=!0,b_(a,!1),e.lanes=4194304);a.isBackwards?(u.sibling=e.child,e.child=u):(n=a.last,n!==null?n.sibling=u:e.child=u,a.last=u)}return a.tail!==null?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=ss(),e.sibling=null,n=Hr.current,br(Hr,i?n&1|2:n&1),e):(Po(e),null);case 22:case 23:return _P(),i=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==i&&(e.flags|=8192),i&&e.mode&1?qa&1073741824&&(Po(e),e.subtreeFlags&6&&(e.flags|=8192)):Po(e),null;case 24:return null;case 25:return null}throw Error(Qt(156,e.tag))}function FZ(t,e){switch(AA(e),e.tag){case 1:return ma(e.type)&&Sw(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return uv(),Tr(pa),Tr(To),VA(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return BA(e),null;case 13:if(Tr(Hr),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Qt(340));ov()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Tr(Hr),null;case 4:return uv(),null;case 10:return DA(e.type._context),null;case 22:case 23:return _P(),null;case 24:return null;default:return null}}var Hw=!1,Io=!1,zZ=typeof WeakSet=="function"?WeakSet:Set,Rn=null;function dv(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(i){Jr(t,e,i)}else n.current=null}function aP(t,e,n){try{n()}catch(i){Jr(t,e,i)}}var E5=!1;function NZ(t,e){if(_A=cw,t=nz(),hA(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var r=i.anchorOffset,a=i.focusNode;i=i.focusOffset;try{n.nodeType,a.nodeType}catch{n=null;break e}var u=0,l=-1,f=-1,g=0,y=0,S=t,b=null;t:for(;;){for(var A;S!==n||r!==0&&S.nodeType!==3||(l=u+r),S!==a||i!==0&&S.nodeType!==3||(f=u+i),S.nodeType===3&&(u+=S.nodeValue.length),(A=S.firstChild)!==null;)b=S,S=A;for(;;){if(S===t)break t;if(b===n&&++g===r&&(l=u),b===a&&++y===i&&(f=u),(A=S.nextSibling)!==null)break;S=b,b=S.parentNode}S=A}n=l===-1||f===-1?null:{start:l,end:f}}else n=null}n=n||{start:0,end:0}}else n=null;for(xA={focusedElem:t,selectionRange:n},cw=!1,Rn=e;Rn!==null;)if(e=Rn,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Rn=t;else for(;Rn!==null;){e=Rn;try{var I=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(I!==null){var D=I.memoizedProps,L=I.memoizedState,P=e.stateNode,N=P.getSnapshotBeforeUpdate(e.elementType===e.type?D:gc(e.type,D),L);P.__reactInternalSnapshotBeforeUpdate=N}break;case 3:var B=e.stateNode.containerInfo;B.nodeType===1?B.textContent="":B.nodeType===9&&B.documentElement&&B.removeChild(B.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Qt(163))}}catch($){Jr(e,e.return,$)}if(t=e.sibling,t!==null){t.return=e.return,Rn=t;break}Rn=e.return}return I=E5,E5=!1,I}function w_(t,e,n){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var r=i=i.next;do{if((r.tag&t)===t){var a=r.destroy;r.destroy=void 0,a!==void 0&&aP(e,n,a)}r=r.next}while(r!==i)}}function Gw(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var i=n.create;n.destroy=i()}n=n.next}while(n!==e)}}function lP(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function M5(t){var e=t.alternate;e!==null&&(t.alternate=null,M5(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[iu],delete e[h_],delete e[EA],delete e[xZ],delete e[bZ])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function C5(t){return t.tag===5||t.tag===3||t.tag===4}function T5(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||C5(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function cP(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=bw));else if(i!==4&&(t=t.child,t!==null))for(cP(t,e,n),t=t.sibling;t!==null;)cP(t,e,n),t=t.sibling}function uP(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(i!==4&&(t=t.child,t!==null))for(uP(t,e,n),t=t.sibling;t!==null;)uP(t,e,n),t=t.sibling}var ao=null,vc=!1;function $d(t,e,n){for(n=n.child;n!==null;)A5(t,e,n),n=n.sibling}function A5(t,e,n){if(nu&&typeof nu.onCommitFiberUnmount=="function")try{nu.onCommitFiberUnmount(iw,n)}catch{}switch(n.tag){case 5:Io||dv(n,e);case 6:var i=ao,r=vc;ao=null,$d(t,e,n),ao=i,vc=r,ao!==null&&(vc?(t=ao,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):ao.removeChild(n.stateNode));break;case 18:ao!==null&&(vc?(t=ao,n=n.stateNode,t.nodeType===8?SA(t.parentNode,n):t.nodeType===1&&SA(t,n),e_(t)):SA(ao,n.stateNode));break;case 4:i=ao,r=vc,ao=n.stateNode.containerInfo,vc=!0,$d(t,e,n),ao=i,vc=r;break;case 0:case 11:case 14:case 15:if(!Io&&(i=n.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){r=i=i.next;do{var a=r,u=a.destroy;a=a.tag,u!==void 0&&(a&2||a&4)&&aP(n,e,u),r=r.next}while(r!==i)}$d(t,e,n);break;case 1:if(!Io&&(dv(n,e),i=n.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(l){Jr(n,e,l)}$d(t,e,n);break;case 21:$d(t,e,n);break;case 22:n.mode&1?(Io=(i=Io)||n.memoizedState!==null,$d(t,e,n),Io=i):$d(t,e,n);break;default:$d(t,e,n)}}function P5(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new zZ),e.forEach(function(i){var r=qZ.bind(null,t,i);n.has(i)||(n.add(i),i.then(r,r))})}}function yc(t,e){var n=e.deletions;if(n!==null)for(var i=0;i<n.length;i++){var r=n[i];try{var a=t,u=e,l=u;e:for(;l!==null;){switch(l.tag){case 5:ao=l.stateNode,vc=!1;break e;case 3:ao=l.stateNode.containerInfo,vc=!0;break e;case 4:ao=l.stateNode.containerInfo,vc=!0;break e}l=l.return}if(ao===null)throw Error(Qt(160));A5(a,u,r),ao=null,vc=!1;var f=r.alternate;f!==null&&(f.return=null),r.return=null}catch(g){Jr(r,e,g)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)I5(e,t),e=e.sibling}function I5(t,e){var n=t.alternate,i=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(yc(e,t),ou(t),i&4){try{w_(3,t,t.return),Gw(3,t)}catch(D){Jr(t,t.return,D)}try{w_(5,t,t.return)}catch(D){Jr(t,t.return,D)}}break;case 1:yc(e,t),ou(t),i&512&&n!==null&&dv(n,n.return);break;case 5:if(yc(e,t),ou(t),i&512&&n!==null&&dv(n,n.return),t.flags&32){var r=t.stateNode;try{Hy(r,"")}catch(D){Jr(t,t.return,D)}}if(i&4&&(r=t.stateNode,r!=null)){var a=t.memoizedProps,u=n!==null?n.memoizedProps:a,l=t.type,f=t.updateQueue;if(t.updateQueue=null,f!==null)try{l==="input"&&a.type==="radio"&&a.name!=null&&rF(r,a),VT(l,u);var g=VT(l,a);for(u=0;u<f.length;u+=2){var y=f[u],S=f[u+1];y==="style"?dF(r,S):y==="dangerouslySetInnerHTML"?uF(r,S):y==="children"?Hy(r,S):ET(r,y,S,g)}switch(l){case"input":FT(r,a);break;case"textarea":aF(r,a);break;case"select":var b=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!a.multiple;var A=a.value;A!=null?Wg(r,!!a.multiple,A,!1):b!==!!a.multiple&&(a.defaultValue!=null?Wg(r,!!a.multiple,a.defaultValue,!0):Wg(r,!!a.multiple,a.multiple?[]:"",!1))}r[h_]=a}catch(D){Jr(t,t.return,D)}}break;case 6:if(yc(e,t),ou(t),i&4){if(t.stateNode===null)throw Error(Qt(162));r=t.stateNode,a=t.memoizedProps;try{r.nodeValue=a}catch(D){Jr(t,t.return,D)}}break;case 3:if(yc(e,t),ou(t),i&4&&n!==null&&n.memoizedState.isDehydrated)try{e_(e.containerInfo)}catch(D){Jr(t,t.return,D)}break;case 4:yc(e,t),ou(t);break;case 13:yc(e,t),ou(t),r=t.child,r.flags&8192&&(a=r.memoizedState!==null,r.stateNode.isHidden=a,!a||r.alternate!==null&&r.alternate.memoizedState!==null||(fP=ss())),i&4&&P5(t);break;case 22:if(y=n!==null&&n.memoizedState!==null,t.mode&1?(Io=(g=Io)||y,yc(e,t),Io=g):yc(e,t),ou(t),i&8192){if(g=t.memoizedState!==null,(t.stateNode.isHidden=g)&&!y&&t.mode&1)for(Rn=t,y=t.child;y!==null;){for(S=Rn=y;Rn!==null;){switch(b=Rn,A=b.child,b.tag){case 0:case 11:case 14:case 15:w_(4,b,b.return);break;case 1:dv(b,b.return);var I=b.stateNode;if(typeof I.componentWillUnmount=="function"){i=b,n=b.return;try{e=i,I.props=e.memoizedProps,I.state=e.memoizedState,I.componentWillUnmount()}catch(D){Jr(i,n,D)}}break;case 5:dv(b,b.return);break;case 22:if(b.memoizedState!==null){k5(S);continue}}A!==null?(A.return=b,Rn=A):k5(S)}y=y.sibling}e:for(y=null,S=t;;){if(S.tag===5){if(y===null){y=S;try{r=S.stateNode,g?(a=r.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(l=S.stateNode,f=S.memoizedProps.style,u=f!=null&&f.hasOwnProperty("display")?f.display:null,l.style.display=hF("display",u))}catch(D){Jr(t,t.return,D)}}}else if(S.tag===6){if(y===null)try{S.stateNode.nodeValue=g?"":S.memoizedProps}catch(D){Jr(t,t.return,D)}}else if((S.tag!==22&&S.tag!==23||S.memoizedState===null||S===t)&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===t)break e;for(;S.sibling===null;){if(S.return===null||S.return===t)break e;y===S&&(y=null),S=S.return}y===S&&(y=null),S.sibling.return=S.return,S=S.sibling}}break;case 19:yc(e,t),ou(t),i&4&&P5(t);break;case 21:break;default:yc(e,t),ou(t)}}function ou(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(C5(n)){var i=n;break e}n=n.return}throw Error(Qt(160))}switch(i.tag){case 5:var r=i.stateNode;i.flags&32&&(Hy(r,""),i.flags&=-33);var a=T5(t);uP(t,a,r);break;case 3:case 4:var u=i.stateNode.containerInfo,l=T5(t);cP(t,l,u);break;default:throw Error(Qt(161))}}catch(f){Jr(t,t.return,f)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function BZ(t,e,n){Rn=t,R5(t)}function R5(t,e,n){for(var i=(t.mode&1)!==0;Rn!==null;){var r=Rn,a=r.child;if(r.tag===22&&i){var u=r.memoizedState!==null||Hw;if(!u){var l=r.alternate,f=l!==null&&l.memoizedState!==null||Io;l=Hw;var g=Io;if(Hw=u,(Io=f)&&!g)for(Rn=r;Rn!==null;)u=Rn,f=u.child,u.tag===22&&u.memoizedState!==null?D5(r):f!==null?(f.return=u,Rn=f):D5(r);for(;a!==null;)Rn=a,R5(a),a=a.sibling;Rn=r,Hw=l,Io=g}L5(t)}else r.subtreeFlags&8772&&a!==null?(a.return=r,Rn=a):L5(t)}}function L5(t){for(;Rn!==null;){var e=Rn;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Io||Gw(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!Io)if(n===null)i.componentDidMount();else{var r=e.elementType===e.type?n.memoizedProps:gc(e.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var a=e.updateQueue;a!==null&&kz(e,a,i);break;case 3:var u=e.updateQueue;if(u!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}kz(e,u,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var f=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":f.autoFocus&&n.focus();break;case"img":f.src&&(n.src=f.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var g=e.alternate;if(g!==null){var y=g.memoizedState;if(y!==null){var S=y.dehydrated;S!==null&&e_(S)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Qt(163))}Io||e.flags&512&&lP(e)}catch(b){Jr(e,e.return,b)}}if(e===t){Rn=null;break}if(n=e.sibling,n!==null){n.return=e.return,Rn=n;break}Rn=e.return}}function k5(t){for(;Rn!==null;){var e=Rn;if(e===t){Rn=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Rn=n;break}Rn=e.return}}function D5(t){for(;Rn!==null;){var e=Rn;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Gw(4,e)}catch(f){Jr(e,n,f)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var r=e.return;try{i.componentDidMount()}catch(f){Jr(e,r,f)}}var a=e.return;try{lP(e)}catch(f){Jr(e,a,f)}break;case 5:var u=e.return;try{lP(e)}catch(f){Jr(e,u,f)}}}catch(f){Jr(e,e.return,f)}if(e===t){Rn=null;break}var l=e.sibling;if(l!==null){l.return=e.return,Rn=l;break}Rn=e.return}}var UZ=Math.ceil,Ww=ch.ReactCurrentDispatcher,hP=ch.ReactCurrentOwner,Rl=ch.ReactCurrentBatchConfig,Vi=0,qs=null,fs=null,lo=0,qa=0,fv=zd(0),Is=0,S_=null,xp=0,jw=0,dP=0,E_=null,va=null,fP=0,pv=1/0,vh=null,qw=!1,pP=null,Hd=null,Xw=!1,Gd=null,Zw=0,M_=0,mP=null,Yw=-1,Kw=0;function Yo(){return Vi&6?ss():Yw!==-1?Yw:Yw=ss()}function Wd(t){return t.mode&1?Vi&2&&lo!==0?lo&-lo:SZ.transition!==null?(Kw===0&&(Kw=TF()),Kw):(t=lr,t!==0||(t=window.event,t=t===void 0?16:FF(t.type)),t):1}function _c(t,e,n,i){if(50<M_)throw M_=0,mP=null,Error(Qt(185));Zy(t,n,i),(!(Vi&2)||t!==qs)&&(t===qs&&(!(Vi&2)&&(jw|=n),Is===4&&jd(t,lo)),ya(t,i),n===1&&Vi===0&&!(e.mode&1)&&(pv=ss()+500,Mw&&Bd()))}function ya(t,e){var n=t.callbackNode;SX(t,e);var i=ow(t,t===qs?lo:0);if(i===0)n!==null&&EF(n),t.callbackNode=null,t.callbackPriority=0;else if(e=i&-i,t.callbackPriority!==e){if(n!=null&&EF(n),e===1)t.tag===0?wZ(F5.bind(null,t)):bz(F5.bind(null,t)),yZ(function(){!(Vi&6)&&Bd()}),n=null;else{switch(AF(i)){case 1:n=XT;break;case 4:n=MF;break;case 16:n=nw;break;case 536870912:n=CF;break;default:n=nw}n=G5(n,O5.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function O5(t,e){if(Yw=-1,Kw=0,Vi&6)throw Error(Qt(327));var n=t.callbackNode;if(mv()&&t.callbackNode!==n)return null;var i=ow(t,t===qs?lo:0);if(i===0)return null;if(i&30||i&t.expiredLanes||e)e=Jw(t,i);else{e=i;var r=Vi;Vi|=2;var a=N5();(qs!==t||lo!==e)&&(vh=null,pv=ss()+500,wp(t,e));do try{HZ();break}catch(l){z5(t,l)}while(!0);kA(),Ww.current=a,Vi=r,fs!==null?e=0:(qs=null,lo=0,e=Is)}if(e!==0){if(e===2&&(r=ZT(t),r!==0&&(i=r,e=gP(t,r))),e===1)throw n=S_,wp(t,0),jd(t,i),ya(t,ss()),n;if(e===6)jd(t,i);else{if(r=t.current.alternate,!(i&30)&&!VZ(r)&&(e=Jw(t,i),e===2&&(a=ZT(t),a!==0&&(i=a,e=gP(t,a))),e===1))throw n=S_,wp(t,0),jd(t,i),ya(t,ss()),n;switch(t.finishedWork=r,t.finishedLanes=i,e){case 0:case 1:throw Error(Qt(345));case 2:Sp(t,va,vh);break;case 3:if(jd(t,i),(i&130023424)===i&&(e=fP+500-ss(),10<e)){if(ow(t,0)!==0)break;if(r=t.suspendedLanes,(r&i)!==i){Yo(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=wA(Sp.bind(null,t,va,vh),e);break}Sp(t,va,vh);break;case 4:if(jd(t,i),(i&4194240)===i)break;for(e=t.eventTimes,r=-1;0<i;){var u=31-fc(i);a=1<<u,u=e[u],u>r&&(r=u),i&=~a}if(i=r,i=ss()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*UZ(i/1960))-i,10<i){t.timeoutHandle=wA(Sp.bind(null,t,va,vh),i);break}Sp(t,va,vh);break;case 5:Sp(t,va,vh);break;default:throw Error(Qt(329))}}}return ya(t,ss()),t.callbackNode===n?O5.bind(null,t):null}function gP(t,e){var n=E_;return t.current.memoizedState.isDehydrated&&(wp(t,e).flags|=256),t=Jw(t,e),t!==2&&(e=va,va=n,e!==null&&vP(e)),t}function vP(t){va===null?va=t:va.push.apply(va,t)}function VZ(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var i=0;i<n.length;i++){var r=n[i],a=r.getSnapshot;r=r.value;try{if(!pc(a(),r))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function jd(t,e){for(e&=~dP,e&=~jw,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-fc(e),i=1<<n;t[n]=-1,e&=~i}}function F5(t){if(Vi&6)throw Error(Qt(327));mv();var e=ow(t,0);if(!(e&1))return ya(t,ss()),null;var n=Jw(t,e);if(t.tag!==0&&n===2){var i=ZT(t);i!==0&&(e=i,n=gP(t,i))}if(n===1)throw n=S_,wp(t,0),jd(t,e),ya(t,ss()),n;if(n===6)throw Error(Qt(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Sp(t,va,vh),ya(t,ss()),null}function yP(t,e){var n=Vi;Vi|=1;try{return t(e)}finally{Vi=n,Vi===0&&(pv=ss()+500,Mw&&Bd())}}function bp(t){Gd!==null&&Gd.tag===0&&!(Vi&6)&&mv();var e=Vi;Vi|=1;var n=Rl.transition,i=lr;try{if(Rl.transition=null,lr=1,t)return t()}finally{lr=i,Rl.transition=n,Vi=e,!(Vi&6)&&Bd()}}function _P(){qa=fv.current,Tr(fv)}function wp(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,vZ(n)),fs!==null)for(n=fs.return;n!==null;){var i=n;switch(AA(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&Sw();break;case 3:uv(),Tr(pa),Tr(To),VA();break;case 5:BA(i);break;case 4:uv();break;case 13:Tr(Hr);break;case 19:Tr(Hr);break;case 10:DA(i.type._context);break;case 22:case 23:_P()}n=n.return}if(qs=t,fs=t=qd(t.current,null),lo=qa=e,Is=0,S_=null,dP=jw=xp=0,va=E_=null,vp!==null){for(e=0;e<vp.length;e++)if(n=vp[e],i=n.interleaved,i!==null){n.interleaved=null;var r=i.next,a=n.pending;if(a!==null){var u=a.next;a.next=r,i.next=u}n.pending=i}vp=null}return t}function z5(t,e){do{var n=fs;try{if(kA(),Ow.current=Bw,Fw){for(var i=Gr.memoizedState;i!==null;){var r=i.queue;r!==null&&(r.pending=null),i=i.next}Fw=!1}if(_p=0,js=Ps=Gr=null,v_=!1,y_=0,hP.current=null,n===null||n.return===null){Is=1,S_=e,fs=null;break}e:{var a=t,u=n.return,l=n,f=e;if(e=lo,l.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){var g=f,y=l,S=y.tag;if(!(y.mode&1)&&(S===0||S===11||S===15)){var b=y.alternate;b?(y.updateQueue=b.updateQueue,y.memoizedState=b.memoizedState,y.lanes=b.lanes):(y.updateQueue=null,y.memoizedState=null)}var A=l5(u);if(A!==null){A.flags&=-257,c5(A,u,l,a,e),A.mode&1&&a5(a,g,e),e=A,f=g;var I=e.updateQueue;if(I===null){var D=new Set;D.add(f),e.updateQueue=D}else I.add(f);break e}else{if(!(e&1)){a5(a,g,e),xP();break e}f=Error(Qt(426))}}else if(Dr&&l.mode&1){var L=l5(u);if(L!==null){!(L.flags&65536)&&(L.flags|=256),c5(L,u,l,a,e),RA(hv(f,l));break e}}a=f=hv(f,l),Is!==4&&(Is=2),E_===null?E_=[a]:E_.push(a),a=u;do{switch(a.tag){case 3:a.flags|=65536,e&=-e,a.lanes|=e;var P=s5(a,f,e);Lz(a,P);break e;case 1:l=f;var N=a.type,B=a.stateNode;if(!(a.flags&128)&&(typeof N.getDerivedStateFromError=="function"||B!==null&&typeof B.componentDidCatch=="function"&&(Hd===null||!Hd.has(B)))){a.flags|=65536,e&=-e,a.lanes|=e;var $=o5(a,l,e);Lz(a,$);break e}}a=a.return}while(a!==null)}U5(n)}catch(K){e=K,fs===n&&n!==null&&(fs=n=n.return);continue}break}while(!0)}function N5(){var t=Ww.current;return Ww.current=Bw,t===null?Bw:t}function xP(){(Is===0||Is===3||Is===2)&&(Is=4),qs===null||!(xp&268435455)&&!(jw&268435455)||jd(qs,lo)}function Jw(t,e){var n=Vi;Vi|=2;var i=N5();(qs!==t||lo!==e)&&(vh=null,wp(t,e));do try{$Z();break}catch(r){z5(t,r)}while(!0);if(kA(),Vi=n,Ww.current=i,fs!==null)throw Error(Qt(261));return qs=null,lo=0,Is}function $Z(){for(;fs!==null;)B5(fs)}function HZ(){for(;fs!==null&&!pX();)B5(fs)}function B5(t){var e=H5(t.alternate,t,qa);t.memoizedProps=t.pendingProps,e===null?U5(t):fs=e,hP.current=null}function U5(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=FZ(n,e),n!==null){n.flags&=32767,fs=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Is=6,fs=null;return}}else if(n=OZ(n,e,qa),n!==null){fs=n;return}if(e=e.sibling,e!==null){fs=e;return}fs=e=t}while(e!==null);Is===0&&(Is=5)}function Sp(t,e,n){var i=lr,r=Rl.transition;try{Rl.transition=null,lr=1,GZ(t,e,n,i)}finally{Rl.transition=r,lr=i}return null}function GZ(t,e,n,i){do mv();while(Gd!==null);if(Vi&6)throw Error(Qt(327));n=t.finishedWork;var r=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(Qt(177));t.callbackNode=null,t.callbackPriority=0;var a=n.lanes|n.childLanes;if(EX(t,a),t===qs&&(fs=qs=null,lo=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Xw||(Xw=!0,G5(nw,function(){return mv(),null})),a=(n.flags&15990)!==0,n.subtreeFlags&15990||a){a=Rl.transition,Rl.transition=null;var u=lr;lr=1;var l=Vi;Vi|=4,hP.current=null,NZ(t,n),I5(n,t),uZ(xA),cw=!!_A,xA=_A=null,t.current=n,BZ(n),mX(),Vi=l,lr=u,Rl.transition=a}else t.current=n;if(Xw&&(Xw=!1,Gd=t,Zw=r),a=t.pendingLanes,a===0&&(Hd=null),yX(n.stateNode),ya(t,ss()),e!==null)for(i=t.onRecoverableError,n=0;n<e.length;n++)r=e[n],i(r.value,{componentStack:r.stack,digest:r.digest});if(qw)throw qw=!1,t=pP,pP=null,t;return Zw&1&&t.tag!==0&&mv(),a=t.pendingLanes,a&1?t===mP?M_++:(M_=0,mP=t):M_=0,Bd(),null}function mv(){if(Gd!==null){var t=AF(Zw),e=Rl.transition,n=lr;try{if(Rl.transition=null,lr=16>t?16:t,Gd===null)var i=!1;else{if(t=Gd,Gd=null,Zw=0,Vi&6)throw Error(Qt(331));var r=Vi;for(Vi|=4,Rn=t.current;Rn!==null;){var a=Rn,u=a.child;if(Rn.flags&16){var l=a.deletions;if(l!==null){for(var f=0;f<l.length;f++){var g=l[f];for(Rn=g;Rn!==null;){var y=Rn;switch(y.tag){case 0:case 11:case 15:w_(8,y,a)}var S=y.child;if(S!==null)S.return=y,Rn=S;else for(;Rn!==null;){y=Rn;var b=y.sibling,A=y.return;if(M5(y),y===g){Rn=null;break}if(b!==null){b.return=A,Rn=b;break}Rn=A}}}var I=a.alternate;if(I!==null){var D=I.child;if(D!==null){I.child=null;do{var L=D.sibling;D.sibling=null,D=L}while(D!==null)}}Rn=a}}if(a.subtreeFlags&2064&&u!==null)u.return=a,Rn=u;else e:for(;Rn!==null;){if(a=Rn,a.flags&2048)switch(a.tag){case 0:case 11:case 15:w_(9,a,a.return)}var P=a.sibling;if(P!==null){P.return=a.return,Rn=P;break e}Rn=a.return}}var N=t.current;for(Rn=N;Rn!==null;){u=Rn;var B=u.child;if(u.subtreeFlags&2064&&B!==null)B.return=u,Rn=B;else e:for(u=N;Rn!==null;){if(l=Rn,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Gw(9,l)}}catch(K){Jr(l,l.return,K)}if(l===u){Rn=null;break e}var $=l.sibling;if($!==null){$.return=l.return,Rn=$;break e}Rn=l.return}}if(Vi=r,Bd(),nu&&typeof nu.onPostCommitFiberRoot=="function")try{nu.onPostCommitFiberRoot(iw,t)}catch{}i=!0}return i}finally{lr=n,Rl.transition=e}}return!1}function V5(t,e,n){e=hv(n,e),e=s5(t,e,1),t=Vd(t,e,1),e=Yo(),t!==null&&(Zy(t,1,e),ya(t,e))}function Jr(t,e,n){if(t.tag===3)V5(t,t,n);else for(;e!==null;){if(e.tag===3){V5(e,t,n);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(Hd===null||!Hd.has(i))){t=hv(n,t),t=o5(e,t,1),e=Vd(e,t,1),t=Yo(),e!==null&&(Zy(e,1,t),ya(e,t));break}}e=e.return}}function WZ(t,e,n){var i=t.pingCache;i!==null&&i.delete(e),e=Yo(),t.pingedLanes|=t.suspendedLanes&n,qs===t&&(lo&n)===n&&(Is===4||Is===3&&(lo&130023424)===lo&&500>ss()-fP?wp(t,0):dP|=n),ya(t,e)}function $5(t,e){e===0&&(t.mode&1?(e=sw,sw<<=1,!(sw&130023424)&&(sw=4194304)):e=1);var n=Yo();t=ph(t,e),t!==null&&(Zy(t,e,n),ya(t,n))}function jZ(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),$5(t,n)}function qZ(t,e){var n=0;switch(t.tag){case 13:var i=t.stateNode,r=t.memoizedState;r!==null&&(n=r.retryLane);break;case 19:i=t.stateNode;break;default:throw Error(Qt(314))}i!==null&&i.delete(e),$5(t,n)}var H5;H5=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||pa.current)ga=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return ga=!1,DZ(t,e,n);ga=!!(t.flags&131072)}else ga=!1,Dr&&e.flags&1048576&&wz(e,Tw,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;$w(t,e),t=e.pendingProps;var r=iv(e,To.current);cv(e,n),r=GA(null,e,i,t,r,n);var a=WA();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,ma(i)?(a=!0,Ew(e)):a=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,zA(e),r.updater=Uw,e.stateNode=r,r._reactInternals=e,KA(e,i,t,n),e=tP(null,e,i,!0,a,n)):(e.tag=0,Dr&&a&&TA(e),Zo(null,e,r,n),e=e.child),e;case 16:i=e.elementType;e:{switch($w(t,e),t=e.pendingProps,r=i._init,i=r(i._payload),e.type=i,r=e.tag=ZZ(i),t=gc(i,t),r){case 0:e=eP(null,e,i,t,n);break e;case 1:e=m5(null,e,i,t,n);break e;case 11:e=u5(null,e,i,t,n);break e;case 14:e=h5(null,e,i,gc(i.type,t),n);break e}throw Error(Qt(306,i,""))}return e;case 0:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:gc(i,r),eP(t,e,i,r,n);case 1:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:gc(i,r),m5(t,e,i,r,n);case 3:e:{if(g5(e),t===null)throw Error(Qt(387));i=e.pendingProps,a=e.memoizedState,r=a.element,Rz(t,e),kw(e,i,null,n);var u=e.memoizedState;if(i=u.element,a.isDehydrated)if(a={element:i,isDehydrated:!1,cache:u.cache,pendingSuspenseBoundaries:u.pendingSuspenseBoundaries,transitions:u.transitions},e.updateQueue.baseState=a,e.memoizedState=a,e.flags&256){r=hv(Error(Qt(423)),e),e=v5(t,e,i,n,r);break e}else if(i!==r){r=hv(Error(Qt(424)),e),e=v5(t,e,i,n,r);break e}else for(ja=Fd(e.stateNode.containerInfo.firstChild),Wa=e,Dr=!0,mc=null,n=Pz(e,null,i,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(ov(),i===r){e=gh(t,e,n);break e}Zo(t,e,i,n)}e=e.child}return e;case 5:return Dz(e),t===null&&IA(e),i=e.type,r=e.pendingProps,a=t!==null?t.memoizedProps:null,u=r.children,bA(i,r)?u=null:a!==null&&bA(i,a)&&(e.flags|=32),p5(t,e),Zo(t,e,u,n),e.child;case 6:return t===null&&IA(e),null;case 13:return y5(t,e,n);case 4:return NA(e,e.stateNode.containerInfo),i=e.pendingProps,t===null?e.child=av(e,null,i,n):Zo(t,e,i,n),e.child;case 11:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:gc(i,r),u5(t,e,i,r,n);case 7:return Zo(t,e,e.pendingProps,n),e.child;case 8:return Zo(t,e,e.pendingProps.children,n),e.child;case 12:return Zo(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(i=e.type._context,r=e.pendingProps,a=e.memoizedProps,u=r.value,br(Iw,i._currentValue),i._currentValue=u,a!==null)if(pc(a.value,u)){if(a.children===r.children&&!pa.current){e=gh(t,e,n);break e}}else for(a=e.child,a!==null&&(a.return=e);a!==null;){var l=a.dependencies;if(l!==null){u=a.child;for(var f=l.firstContext;f!==null;){if(f.context===i){if(a.tag===1){f=mh(-1,n&-n),f.tag=2;var g=a.updateQueue;if(g!==null){g=g.shared;var y=g.pending;y===null?f.next=f:(f.next=y.next,y.next=f),g.pending=f}}a.lanes|=n,f=a.alternate,f!==null&&(f.lanes|=n),OA(a.return,n,e),l.lanes|=n;break}f=f.next}}else if(a.tag===10)u=a.type===e.type?null:a.child;else if(a.tag===18){if(u=a.return,u===null)throw Error(Qt(341));u.lanes|=n,l=u.alternate,l!==null&&(l.lanes|=n),OA(u,n,e),u=a.sibling}else u=a.child;if(u!==null)u.return=a;else for(u=a;u!==null;){if(u===e){u=null;break}if(a=u.sibling,a!==null){a.return=u.return,u=a;break}u=u.return}a=u}Zo(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,i=e.pendingProps.children,cv(e,n),r=Pl(r),i=i(r),e.flags|=1,Zo(t,e,i,n),e.child;case 14:return i=e.type,r=gc(i,e.pendingProps),r=gc(i.type,r),h5(t,e,i,r,n);case 15:return d5(t,e,e.type,e.pendingProps,n);case 17:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:gc(i,r),$w(t,e),e.tag=1,ma(i)?(t=!0,Ew(e)):t=!1,cv(e,n),i5(e,i,r),KA(e,i,r,n),tP(null,e,i,!0,t,n);case 19:return x5(t,e,n);case 22:return f5(t,e,n)}throw Error(Qt(156,e.tag))};function G5(t,e){return SF(t,e)}function XZ(t,e,n,i){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ll(t,e,n,i){return new XZ(t,e,n,i)}function bP(t){return t=t.prototype,!(!t||!t.isReactComponent)}function ZZ(t){if(typeof t=="function")return bP(t)?1:0;if(t!=null){if(t=t.$$typeof,t===TT)return 11;if(t===IT)return 14}return 2}function qd(t,e){var n=t.alternate;return n===null?(n=Ll(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Qw(t,e,n,i,r,a){var u=2;if(i=t,typeof t=="function")bP(t)&&(u=1);else if(typeof t=="string")u=5;else e:switch(t){case Gg:return Ep(n.children,r,a,e);case MT:u=8,r|=8;break;case CT:return t=Ll(12,n,e,r|2),t.elementType=CT,t.lanes=a,t;case AT:return t=Ll(13,n,e,r),t.elementType=AT,t.lanes=a,t;case PT:return t=Ll(19,n,e,r),t.elementType=PT,t.lanes=a,t;case QO:return eS(n,r,a,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case KO:u=10;break e;case JO:u=9;break e;case TT:u=11;break e;case IT:u=14;break e;case Ad:u=16,i=null;break e}throw Error(Qt(130,t==null?t:typeof t,""))}return e=Ll(u,n,e,r),e.elementType=t,e.type=i,e.lanes=a,e}function Ep(t,e,n,i){return t=Ll(7,t,i,e),t.lanes=n,t}function eS(t,e,n,i){return t=Ll(22,t,i,e),t.elementType=QO,t.lanes=n,t.stateNode={isHidden:!1},t}function wP(t,e,n){return t=Ll(6,t,null,e),t.lanes=n,t}function SP(t,e,n){return e=Ll(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function YZ(t,e,n,i,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=YT(0),this.expirationTimes=YT(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=YT(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function EP(t,e,n,i,r,a,u,l,f){return t=new YZ(t,e,n,l,f),e===1?(e=1,a===!0&&(e|=8)):e=0,a=Ll(3,null,null,e),t.current=a,a.stateNode=t,a.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},zA(a),t}function KZ(t,e,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Hg,key:i==null?null:""+i,children:t,containerInfo:e,implementation:n}}function W5(t){if(!t)return Nd;t=t._reactInternals;e:{if(dp(t)!==t||t.tag!==1)throw Error(Qt(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(ma(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Qt(171))}if(t.tag===1){var n=t.type;if(ma(n))return _z(t,n,e)}return e}function j5(t,e,n,i,r,a,u,l,f){return t=EP(n,i,!0,t,r,a,u,l,f),t.context=W5(null),n=t.current,i=Yo(),r=Wd(n),a=mh(i,r),a.callback=e??null,Vd(n,a,r),t.current.lanes=r,Zy(t,r,i),ya(t,i),t}function tS(t,e,n,i){var r=e.current,a=Yo(),u=Wd(r);return n=W5(n),e.context===null?e.context=n:e.pendingContext=n,e=mh(a,u),e.payload={element:t},i=i===void 0?null:i,i!==null&&(e.callback=i),t=Vd(r,e,u),t!==null&&(_c(t,r,u,a),Lw(t,r,u)),u}function nS(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function q5(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function MP(t,e){q5(t,e),(t=t.alternate)&&q5(t,e)}function JZ(){return null}var X5=typeof reportError=="function"?reportError:function(t){console.error(t)};function CP(t){this._internalRoot=t}iS.prototype.render=CP.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Qt(409));tS(t,e,null,null)},iS.prototype.unmount=CP.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;bp(function(){tS(null,t,null,null)}),e[uh]=null}};function iS(t){this._internalRoot=t}iS.prototype.unstable_scheduleHydration=function(t){if(t){var e=RF();t={blockedOn:null,target:t,priority:e};for(var n=0;n<kd.length&&e!==0&&e<kd[n].priority;n++);kd.splice(n,0,t),n===0&&DF(t)}};function TP(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function rS(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Z5(){}function QZ(t,e,n,i,r){if(r){if(typeof i=="function"){var a=i;i=function(){var g=nS(u);a.call(g)}}var u=j5(e,i,t,0,null,!1,!1,"",Z5);return t._reactRootContainer=u,t[uh]=u.current,c_(t.nodeType===8?t.parentNode:t),bp(),u}for(;r=t.lastChild;)t.removeChild(r);if(typeof i=="function"){var l=i;i=function(){var g=nS(f);l.call(g)}}var f=EP(t,0,!1,null,null,!1,!1,"",Z5);return t._reactRootContainer=f,t[uh]=f.current,c_(t.nodeType===8?t.parentNode:t),bp(function(){tS(e,f,n,i)}),f}function sS(t,e,n,i,r){var a=n._reactRootContainer;if(a){var u=a;if(typeof r=="function"){var l=r;r=function(){var f=nS(u);l.call(f)}}tS(e,u,t,r)}else u=QZ(n,e,t,r,i);return nS(u)}PF=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Xy(e.pendingLanes);n!==0&&(KT(e,n|1),ya(e,ss()),!(Vi&6)&&(pv=ss()+500,Bd()))}break;case 13:bp(function(){var i=ph(t,1);if(i!==null){var r=Yo();_c(i,t,1,r)}}),MP(t,1)}},JT=function(t){if(t.tag===13){var e=ph(t,134217728);if(e!==null){var n=Yo();_c(e,t,134217728,n)}MP(t,134217728)}},IF=function(t){if(t.tag===13){var e=Wd(t),n=ph(t,e);if(n!==null){var i=Yo();_c(n,t,e,i)}MP(t,e)}},RF=function(){return lr},LF=function(t,e){var n=lr;try{return lr=t,e()}finally{lr=n}},GT=function(t,e,n){switch(e){case"input":if(FT(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var i=n[e];if(i!==t&&i.form===t.form){var r=ww(i);if(!r)throw Error(Qt(90));nF(i),FT(i,r)}}}break;case"textarea":aF(t,n);break;case"select":e=n.value,e!=null&&Wg(t,!!n.multiple,e,!1)}},gF=yP,vF=bp;var eY={usingClientEntryPoint:!1,Events:[d_,tv,ww,pF,mF,yP]},C_={findFiberByHostInstance:fp,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},tY={bundleType:C_.bundleType,version:C_.version,rendererPackageName:C_.rendererPackageName,rendererConfig:C_.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ch.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=bF(t),t===null?null:t.stateNode},findFiberByHostInstance:C_.findFiberByHostInstance||JZ,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var oS=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!oS.isDisabled&&oS.supportsFiber)try{iw=oS.inject(tY),nu=oS}catch{}}$a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eY,$a.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!TP(e))throw Error(Qt(200));return KZ(t,e,null,n)},$a.createRoot=function(t,e){if(!TP(t))throw Error(Qt(299));var n=!1,i="",r=X5;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=EP(t,1,!1,null,null,n,!1,i,r),t[uh]=e.current,c_(t.nodeType===8?t.parentNode:t),new CP(e)},$a.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Qt(188)):(t=Object.keys(t).join(","),Error(Qt(268,t)));return t=bF(e),t=t===null?null:t.stateNode,t},$a.flushSync=function(t){return bp(t)},$a.hydrate=function(t,e,n){if(!rS(e))throw Error(Qt(200));return sS(null,t,e,!0,n)},$a.hydrateRoot=function(t,e,n){if(!TP(t))throw Error(Qt(405));var i=n!=null&&n.hydratedSources||null,r=!1,a="",u=X5;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(a=n.identifierPrefix),n.onRecoverableError!==void 0&&(u=n.onRecoverableError)),e=j5(e,null,t,1,n??null,r,!1,a,u),t[uh]=e.current,c_(t),i)for(t=0;t<i.length;t++)n=i[t],r=n._getVersion,r=r(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,r]:e.mutableSourceEagerHydrationData.push(n,r);return new iS(e)},$a.render=function(t,e,n){if(!rS(e))throw Error(Qt(200));return sS(null,t,e,!1,n)},$a.unmountComponentAtNode=function(t){if(!rS(t))throw Error(Qt(40));return t._reactRootContainer?(bp(function(){sS(null,null,t,!1,function(){t._reactRootContainer=null,t[uh]=null})}),!0):!1},$a.unstable_batchedUpdates=yP,$a.unstable_renderSubtreeIntoContainer=function(t,e,n,i){if(!rS(n))throw Error(Qt(200));if(t==null||t._reactInternals===void 0)throw Error(Qt(38));return sS(t,e,n,!1,i)},$a.version="18.3.1-next-f1338f8080-20240426";function Y5(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Y5)}catch(t){console.error(t)}}Y5(),WO.exports=$a;var AP=WO.exports;const gv=cb(AP),nY=_l({__proto__:null,default:gv},[AP]);function K5(t){return t instanceof HTMLElement||t instanceof SVGElement}function iY(t){return t&&ai(t)==="object"&&K5(t.nativeElement)?t.nativeElement:K5(t)?t:null}function rY(t){var e=iY(t);if(e)return e;if(t instanceof un.Component){var n;return(n=gv.findDOMNode)===null||n===void 0?void 0:n.call(gv,t)}return null}function PP(t,e,n){var i=he.useRef({});return(!("value"in i.current)||n(i.current.condition,e))&&(i.current.value=t(),i.current.condition=e),i.current.value}var J5=function(e,n){typeof e=="function"?e(n):ai(e)==="object"&&e&&"current"in e&&(e.current=n)},aS=function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];var r=n.filter(Boolean);return r.length<=1?r[0]:function(a){n.forEach(function(u){J5(u,a)})}},Q5=function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return PP(function(){return aS.apply(void 0,n)},n,function(r,a){return r.length!==a.length||r.every(function(u,l){return u!==a[l]})})},IP=function(e){var n,i,r=Ny.isMemo(e)?e.type.type:e.type;return!(typeof r=="function"&&!((n=r.prototype)!==null&&n!==void 0&&n.render)&&r.$$typeof!==Ny.ForwardRef||typeof e=="function"&&!((i=e.prototype)!==null&&i!==void 0&&i.render)&&e.$$typeof!==Ny.ForwardRef)};function eN(t){return he.isValidElement(t)&&!Ny.isFragment(t)}Number(he.version.split(".")[0])>=19;function Ko(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function tN(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,HO(i.key),i)}}function Jo(t,e,n){return e&&tN(t.prototype,e),n&&tN(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function T_(t,e){return T_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},T_(t,e)}function vv(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&T_(t,e)}function A_(t){return A_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},A_(t)}function RP(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(RP=function(){return!!t})()}function bi(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function sY(t,e){if(e&&(ai(e)=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bi(t)}function yv(t){var e=RP();return function(){var n,i=A_(t);if(e){var r=A_(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return sY(this,n)}}function lS(t,e){var n=Object.assign({},t);return Array.isArray(e)&&e.forEach(function(i){delete n[i]}),n}function LP(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function oY(t){if(Array.isArray(t))return LP(t)}function nN(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function kP(t,e){if(t){if(typeof t=="string")return LP(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?LP(t,e):void 0}}function aY(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Gn(t){return oY(t)||nN(t)||kP(t)||aY()}var iN=function(e){return+setTimeout(e,16)},rN=function(e){return clearTimeout(e)};typeof window<"u"&&"requestAnimationFrame"in window&&(iN=function(e){return window.requestAnimationFrame(e)},rN=function(e){return window.cancelAnimationFrame(e)});var sN=0,DP=new Map;function oN(t){DP.delete(t)}var Mp=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;sN+=1;var i=sN;function r(a){if(a===0)oN(i),e();else{var u=iN(function(){r(a-1)});DP.set(i,u)}}return r(n),i};Mp.cancel=function(t){var e=DP.get(t);return oN(t),rN(e)};function aN(t){if(Array.isArray(t))return t}function lY(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i,r,a,u,l=[],f=!0,g=!1;try{if(a=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;f=!1}else for(;!(f=(i=a.call(n)).done)&&(l.push(i.value),l.length!==e);f=!0);}catch(y){g=!0,r=y}finally{try{if(!f&&n.return!=null&&(u=n.return(),Object(u)!==u))return}finally{if(g)throw r}}return l}}function lN(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Xn(t,e){return aN(t)||lY(t,e)||kP(t,e)||lN()}function P_(t){for(var e=0,n,i=0,r=t.length;r>=4;++i,r-=4)n=t.charCodeAt(i)&255|(t.charCodeAt(++i)&255)<<8|(t.charCodeAt(++i)&255)<<16|(t.charCodeAt(++i)&255)<<24,n=(n&65535)*1540483477+((n>>>16)*59797<<16),n^=n>>>24,e=(n&65535)*1540483477+((n>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(r){case 3:e^=(t.charCodeAt(i+2)&255)<<16;case 2:e^=(t.charCodeAt(i+1)&255)<<8;case 1:e^=t.charCodeAt(i)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}function _a(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}function OP(t,e){if(!t)return!1;if(t.contains)return t.contains(e);for(var n=e;n;){if(n===t)return!0;n=n.parentNode}return!1}var cN="data-rc-order",uN="data-rc-priority",cY="rc-util-key",FP=new Map;function hN(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=t.mark;return e?e.startsWith("data-")?e:"data-".concat(e):cY}function cS(t){if(t.attachTo)return t.attachTo;var e=document.querySelector("head");return e||document.body}function uY(t){return t==="queue"?"prependQueue":t?"prepend":"append"}function zP(t){return Array.from((FP.get(t)||t).children).filter(function(e){return e.tagName==="STYLE"})}function dN(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!_a())return null;var n=e.csp,i=e.prepend,r=e.priority,a=r===void 0?0:r,u=uY(i),l=u==="prependQueue",f=document.createElement("style");f.setAttribute(cN,u),l&&a&&f.setAttribute(uN,"".concat(a)),n!=null&&n.nonce&&(f.nonce=n==null?void 0:n.nonce),f.innerHTML=t;var g=cS(e),y=g.firstChild;if(i){if(l){var S=(e.styles||zP(g)).filter(function(b){if(!["prepend","prependQueue"].includes(b.getAttribute(cN)))return!1;var A=Number(b.getAttribute(uN)||0);return a>=A});if(S.length)return g.insertBefore(f,S[S.length-1].nextSibling),f}g.insertBefore(f,y)}else g.appendChild(f);return f}function fN(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=cS(e);return(e.styles||zP(n)).find(function(i){return i.getAttribute(hN(e))===t})}function I_(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=fN(t,e);if(n){var i=cS(e);i.removeChild(n)}}function hY(t,e){var n=FP.get(t);if(!n||!OP(document,n)){var i=dN("",e),r=i.parentNode;FP.set(t,r),t.removeChild(i)}}function yh(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=cS(n),r=zP(i),a=It(It({},n),{},{styles:r});hY(i,a);var u=fN(e,a);if(u){var l,f;if((l=a.csp)!==null&&l!==void 0&&l.nonce&&u.nonce!==((f=a.csp)===null||f===void 0?void 0:f.nonce)){var g;u.nonce=(g=a.csp)===null||g===void 0?void 0:g.nonce}return u.innerHTML!==t&&(u.innerHTML=t),u}var y=dN(t,a);return y.setAttribute(hN(a),e),y}function dY(t,e){if(t==null)return{};var n={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(e.includes(i))continue;n[i]=t[i]}return n}function Xd(t,e){if(t==null)return{};var n,i,r=dY(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(i=0;i<a.length;i++)n=a[i],e.includes(n)||{}.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function NP(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=new Set;function r(a,u){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,f=i.has(a);if(Va(!f,"Warning: There may be circular references"),f)return!1;if(a===u)return!0;if(n&&l>1)return!1;i.add(a);var g=l+1;if(Array.isArray(a)){if(!Array.isArray(u)||a.length!==u.length)return!1;for(var y=0;y<a.length;y++)if(!r(a[y],u[y],g))return!1;return!0}if(a&&u&&ai(a)==="object"&&ai(u)==="object"){var S=Object.keys(a);return S.length!==Object.keys(u).length?!1:S.every(function(b){return r(a[b],u[b],g)})}return!1}return r(t,e)}var fY="%";function BP(t){return t.join(fY)}var pY=function(){function t(e){Ko(this,t),vt(this,"instanceId",void 0),vt(this,"cache",new Map),this.instanceId=e}return Jo(t,[{key:"get",value:function(n){return this.opGet(BP(n))}},{key:"opGet",value:function(n){return this.cache.get(n)||null}},{key:"update",value:function(n,i){return this.opUpdate(BP(n),i)}},{key:"opUpdate",value:function(n,i){var r=this.cache.get(n),a=i(r);a===null?this.cache.delete(n):this.cache.set(n,a)}}]),t}(),_v="data-token-hash",xc="data-css-hash",Zd="__cssinjs_instance__";function mY(){var t=Math.random().toString(12).slice(2);if(typeof document<"u"&&document.head&&document.body){var e=document.body.querySelectorAll("style[".concat(xc,"]"))||[],n=document.head.firstChild;Array.from(e).forEach(function(r){r[Zd]=r[Zd]||t,r[Zd]===t&&document.head.insertBefore(r,n)});var i={};Array.from(document.querySelectorAll("style[".concat(xc,"]"))).forEach(function(r){var a=r.getAttribute(xc);if(i[a]){if(r[Zd]===t){var u;(u=r.parentNode)===null||u===void 0||u.removeChild(r)}}else i[a]=!0})}return new pY(t)}var uS=he.createContext({hashPriority:"low",cache:mY(),defaultCache:!0});function gY(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}var UP=function(){function t(){Ko(this,t),vt(this,"cache",void 0),vt(this,"keys",void 0),vt(this,"cacheCallTimes",void 0),this.cache=new Map,this.keys=[],this.cacheCallTimes=0}return Jo(t,[{key:"size",value:function(){return this.keys.length}},{key:"internalGet",value:function(n){var i,r,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,u={map:this.cache};return n.forEach(function(l){if(!u)u=void 0;else{var f;u=(f=u)===null||f===void 0||(f=f.map)===null||f===void 0?void 0:f.get(l)}}),(i=u)!==null&&i!==void 0&&i.value&&a&&(u.value[1]=this.cacheCallTimes++),(r=u)===null||r===void 0?void 0:r.value}},{key:"get",value:function(n){var i;return(i=this.internalGet(n,!0))===null||i===void 0?void 0:i[0]}},{key:"has",value:function(n){return!!this.internalGet(n)}},{key:"set",value:function(n,i){var r=this;if(!this.has(n)){if(this.size()+1>t.MAX_CACHE_SIZE+t.MAX_CACHE_OFFSET){var a=this.keys.reduce(function(g,y){var S=Xn(g,2),b=S[1];return r.internalGet(y)[1]<b?[y,r.internalGet(y)[1]]:g},[this.keys[0],this.cacheCallTimes]),u=Xn(a,1),l=u[0];this.delete(l)}this.keys.push(n)}var f=this.cache;n.forEach(function(g,y){if(y===n.length-1)f.set(g,{value:[i,r.cacheCallTimes++]});else{var S=f.get(g);S?S.map||(S.map=new Map):f.set(g,{map:new Map}),f=f.get(g).map}})}},{key:"deleteByPath",value:function(n,i){var r=n.get(i[0]);if(i.length===1){var a;return r.map?n.set(i[0],{map:r.map}):n.delete(i[0]),(a=r.value)===null||a===void 0?void 0:a[0]}var u=this.deleteByPath(r.map,i.slice(1));return(!r.map||r.map.size===0)&&!r.value&&n.delete(i[0]),u}},{key:"delete",value:function(n){if(this.has(n))return this.keys=this.keys.filter(function(i){return!gY(i,n)}),this.deleteByPath(this.cache,n)}}]),t}();vt(UP,"MAX_CACHE_SIZE",20),vt(UP,"MAX_CACHE_OFFSET",5);var pN=0,mN=function(){function t(e){Ko(this,t),vt(this,"derivatives",void 0),vt(this,"id",void 0),this.derivatives=Array.isArray(e)?e:[e],this.id=pN,e.length===0&&(e.length>0,void 0),pN+=1}return Jo(t,[{key:"getDerivativeToken",value:function(n){return this.derivatives.reduce(function(i,r){return r(n,i)},void 0)}}]),t}(),VP=new UP;function $P(t){var e=Array.isArray(t)?t:[t];return VP.has(e)||VP.set(e,new mN(e)),VP.get(e)}var vY=new WeakMap,HP={};function yY(t,e){for(var n=vY,i=0;i<e.length;i+=1){var r=e[i];n.has(r)||n.set(r,new WeakMap),n=n.get(r)}return n.has(HP)||n.set(HP,t()),n.get(HP)}var gN=new WeakMap;function R_(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=gN.get(t)||"";return n||(Object.keys(t).forEach(function(i){var r=t[i];n+=i,r instanceof mN?n+=r.id:r&&ai(r)==="object"?n+=R_(r,e):n+=r}),e&&(n=P_(n)),gN.set(t,n)),n}function vN(t,e){return P_("".concat(e,"_").concat(R_(t,!0)))}var GP=_a();function cr(t){return typeof t=="number"?"".concat(t,"px"):t}function hS(t,e,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(r)return t;var a=It(It({},i),{},vt(vt({},_v,e),xc,n)),u=Object.keys(a).map(function(l){var f=a[l];return f?"".concat(l,'="').concat(f,'"'):null}).filter(function(l){return l}).join(" ");return"<style ".concat(u,">").concat(t,"</style>")}var dS=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return"--".concat(n?"".concat(n,"-"):"").concat(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").replace(/([A-Z]+)([A-Z][a-z0-9]+)/g,"$1-$2").replace(/([a-z])([A-Z0-9])/g,"$1-$2").toLowerCase()},_Y=function(e,n,i){return Object.keys(e).length?".".concat(n).concat(i!=null&&i.scope?".".concat(i.scope):"","{").concat(Object.entries(e).map(function(r){var a=Xn(r,2),u=a[0],l=a[1];return"".concat(u,":").concat(l,";")}).join(""),"}"):""},yN=function(e,n,i){var r={},a={};return Object.entries(e).forEach(function(u){var l,f,g=Xn(u,2),y=g[0],S=g[1];if(i!=null&&(l=i.preserve)!==null&&l!==void 0&&l[y])a[y]=S;else if((typeof S=="string"||typeof S=="number")&&!(i!=null&&(f=i.ignore)!==null&&f!==void 0&&f[y])){var b,A=dS(y,i==null?void 0:i.prefix);r[A]=typeof S=="number"&&!(i!=null&&(b=i.unitless)!==null&&b!==void 0&&b[y])?"".concat(S,"px"):String(S),a[y]="var(".concat(A,")")}}),[a,_Y(r,n,{scope:i==null?void 0:i.scope})]},_N=_a()?he.useLayoutEffect:he.useEffect,fS=function(e,n){var i=he.useRef(!0);_N(function(){return e(i.current)},n),_N(function(){return i.current=!1,function(){i.current=!0}},[])},xY=It({},Bb),xN=xY.useInsertionEffect,bY=function(e,n,i){he.useMemo(e,i),fS(function(){return n(!0)},i)},wY=xN?function(t,e,n){return xN(function(){return t(),e()},n)}:bY,SY=It({},Bb),EY=SY.useInsertionEffect,MY=function(e){var n=[],i=!1;function r(a){i||n.push(a)}return he.useEffect(function(){return i=!1,function(){i=!0,n.length&&n.forEach(function(a){return a()})}},e),r},CY=function(){return function(e){e()}},TY=typeof EY<"u"?MY:CY;function WP(t,e,n,i,r){var a=he.useContext(uS),u=a.cache,l=[t].concat(Gn(e)),f=BP(l),g=TY([f]),y=function(I){u.opUpdate(f,function(D){var L=D||[void 0,void 0],P=Xn(L,2),N=P[0],B=N===void 0?0:N,$=P[1],K=$,q=K||n(),W=[B,q];return I?I(W):W})};he.useMemo(function(){y()},[f]);var S=u.opGet(f),b=S[1];return wY(function(){r==null||r(b)},function(A){return y(function(I){var D=Xn(I,2),L=D[0],P=D[1];return A&&L===0&&(r==null||r(b)),[L+1,P]}),function(){u.opUpdate(f,function(I){var D=I||[],L=Xn(D,2),P=L[0],N=P===void 0?0:P,B=L[1],$=N-1;return $===0?(g(function(){(A||!u.opGet(f))&&(i==null||i(B,!1))}),null):[N-1,B]})}},[f]),b}var AY={},PY="css",Cp=new Map;function IY(t){Cp.set(t,(Cp.get(t)||0)+1)}function RY(t,e){if(typeof document<"u"){var n=document.querySelectorAll("style[".concat(_v,'="').concat(t,'"]'));n.forEach(function(i){if(i[Zd]===e){var r;(r=i.parentNode)===null||r===void 0||r.removeChild(i)}})}}var LY=0;function kY(t,e){Cp.set(t,(Cp.get(t)||0)-1);var n=Array.from(Cp.keys()),i=n.filter(function(r){var a=Cp.get(r)||0;return a<=0});n.length-i.length>LY&&i.forEach(function(r){RY(r,e),Cp.delete(r)})}var DY=function(e,n,i,r){var a=i.getDerivativeToken(e),u=It(It({},a),n);return r&&(u=r(u)),u},bN="token";function OY(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=he.useContext(uS),r=i.cache.instanceId,a=i.container,u=n.salt,l=u===void 0?"":u,f=n.override,g=f===void 0?AY:f,y=n.formatToken,S=n.getComputedToken,b=n.cssVar,A=yY(function(){return Object.assign.apply(Object,[{}].concat(Gn(e)))},e),I=R_(A),D=R_(g),L=b?R_(b):"",P=WP(bN,[l,t.id,I,D,L],function(){var N,B=S?S(A,g,t):DY(A,g,t,y),$=It({},B),K="";if(b){var q=yN(B,b.key,{prefix:b.prefix,ignore:b.ignore,unitless:b.unitless,preserve:b.preserve}),W=Xn(q,2);B=W[0],K=W[1]}var ie=vN(B,l);B._tokenKey=ie,$._tokenKey=vN($,l);var Z=(N=b==null?void 0:b.key)!==null&&N!==void 0?N:ie;B._themeKey=Z,IY(Z);var X="".concat(PY,"-").concat(P_(ie));return B._hashId=X,[B,X,$,K,(b==null?void 0:b.key)||""]},function(N){kY(N[0]._themeKey,r)},function(N){var B=Xn(N,4),$=B[0],K=B[3];if(b&&K){var q=yh(K,P_("css-variables-".concat($._themeKey)),{mark:xc,prepend:"queue",attachTo:a,priority:-999});q[Zd]=r,q.setAttribute(_v,$._themeKey)}});return P}var FY=function(e,n,i){var r=Xn(e,5),a=r[2],u=r[3],l=r[4],f=i||{},g=f.plain;if(!u)return null;var y=a._tokenKey,S=-999,b={"data-rc-order":"prependQueue","data-rc-priority":"".concat(S)},A=hS(u,l,y,b,g);return[S,y,A]},zY={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},wN="comm",SN="rule",EN="decl",NY="@import",BY="@keyframes",UY="@layer",MN=Math.abs,jP=String.fromCharCode;function CN(t){return t.trim()}function pS(t,e,n){return t.replace(e,n)}function VY(t,e,n){return t.indexOf(e,n)}function L_(t,e){return t.charCodeAt(e)|0}function k_(t,e,n){return t.slice(e,n)}function _h(t){return t.length}function $Y(t){return t.length}function mS(t,e){return e.push(t),t}var gS=1,xv=1,TN=0,kl=0,ps=0,bv="";function qP(t,e,n,i,r,a,u,l){return{value:t,root:e,parent:n,type:i,props:r,children:a,line:gS,column:xv,length:u,return:"",siblings:l}}function HY(){return ps}function GY(){return ps=kl>0?L_(bv,--kl):0,xv--,ps===10&&(xv=1,gS--),ps}function bc(){return ps=kl<TN?L_(bv,kl++):0,xv++,ps===10&&(xv=1,gS++),ps}function Tp(){return L_(bv,kl)}function vS(){return kl}function yS(t,e){return k_(bv,t,e)}function XP(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function WY(t){return gS=xv=1,TN=_h(bv=t),kl=0,[]}function jY(t){return bv="",t}function ZP(t){return CN(yS(kl-1,YP(t===91?t+2:t===40?t+1:t)))}function qY(t){for(;(ps=Tp())&&ps<33;)bc();return XP(t)>2||XP(ps)>3?"":" "}function XY(t,e){for(;--e&&bc()&&!(ps<48||ps>102||ps>57&&ps<65||ps>70&&ps<97););return yS(t,vS()+(e<6&&Tp()==32&&bc()==32))}function YP(t){for(;bc();)switch(ps){case t:return kl;case 34:case 39:t!==34&&t!==39&&YP(ps);break;case 40:t===41&&YP(t);break;case 92:bc();break}return kl}function ZY(t,e){for(;bc()&&t+ps!==57;)if(t+ps===84&&Tp()===47)break;return"/*"+yS(e,kl-1)+"*"+jP(t===47?t:bc())}function YY(t){for(;!XP(Tp());)bc();return yS(t,kl)}function KY(t){return jY(_S("",null,null,null,[""],t=WY(t),0,[0],t))}function _S(t,e,n,i,r,a,u,l,f){for(var g=0,y=0,S=u,b=0,A=0,I=0,D=1,L=1,P=1,N=0,B="",$=r,K=a,q=i,W=B;L;)switch(I=N,N=bc()){case 40:if(I!=108&&L_(W,S-1)==58){VY(W+=pS(ZP(N),"&","&\f"),"&\f",MN(g?l[g-1]:0))!=-1&&(P=-1);break}case 34:case 39:case 91:W+=ZP(N);break;case 9:case 10:case 13:case 32:W+=qY(I);break;case 92:W+=XY(vS()-1,7);continue;case 47:switch(Tp()){case 42:case 47:mS(JY(ZY(bc(),vS()),e,n,f),f);break;default:W+="/"}break;case 123*D:l[g++]=_h(W)*P;case 125*D:case 59:case 0:switch(N){case 0:case 125:L=0;case 59+y:P==-1&&(W=pS(W,/\f/g,"")),A>0&&_h(W)-S&&mS(A>32?PN(W+";",i,n,S-1,f):PN(pS(W," ","")+";",i,n,S-2,f),f);break;case 59:W+=";";default:if(mS(q=AN(W,e,n,g,y,r,l,B,$=[],K=[],S,a),a),N===123)if(y===0)_S(W,e,q,q,$,a,S,l,K);else switch(b===99&&L_(W,3)===110?100:b){case 100:case 108:case 109:case 115:_S(t,q,q,i&&mS(AN(t,q,q,0,0,r,l,B,r,$=[],S,K),K),r,K,S,l,i?$:K);break;default:_S(W,q,q,q,[""],K,0,l,K)}}g=y=A=0,D=P=1,B=W="",S=u;break;case 58:S=1+_h(W),A=I;default:if(D<1){if(N==123)--D;else if(N==125&&D++==0&&GY()==125)continue}switch(W+=jP(N),N*D){case 38:P=y>0?1:(W+="\f",-1);break;case 44:l[g++]=(_h(W)-1)*P,P=1;break;case 64:Tp()===45&&(W+=ZP(bc())),b=Tp(),y=S=_h(B=W+=YY(vS())),N++;break;case 45:I===45&&_h(W)==2&&(D=0)}}return a}function AN(t,e,n,i,r,a,u,l,f,g,y,S){for(var b=r-1,A=r===0?a:[""],I=$Y(A),D=0,L=0,P=0;D<i;++D)for(var N=0,B=k_(t,b+1,b=MN(L=u[D])),$=t;N<I;++N)($=CN(L>0?A[N]+" "+B:pS(B,/&\f/g,A[N])))&&(f[P++]=$);return qP(t,e,n,r===0?SN:l,f,g,y,S)}function JY(t,e,n,i){return qP(t,e,n,wN,jP(HY()),k_(t,2,-2),0,i)}function PN(t,e,n,i,r){return qP(t,e,n,EN,k_(t,0,i),k_(t,i+1,-1),i,r)}function KP(t,e){for(var n="",i=0;i<t.length;i++)n+=e(t[i],i,t,e)||"";return n}function QY(t,e,n,i){switch(t.type){case UY:if(t.children.length)break;case NY:case EN:return t.return=t.return||t.value;case wN:return"";case BY:return t.return=t.value+"{"+KP(t.children,i)+"}";case SN:if(!_h(t.value=t.props.join(",")))return""}return _h(n=KP(t.children,i))?t.return=t.value+"{"+n+"}":""}var IN="data-ant-cssinjs-cache-path",RN="_FILE_STYLE__",Ap,LN=!0;function eK(){if(!Ap&&(Ap={},_a())){var t=document.createElement("div");t.className=IN,t.style.position="fixed",t.style.visibility="hidden",t.style.top="-9999px",document.body.appendChild(t);var e=getComputedStyle(t).content||"";e=e.replace(/^"/,"").replace(/"$/,""),e.split(";").forEach(function(r){var a=r.split(":"),u=Xn(a,2),l=u[0],f=u[1];Ap[l]=f});var n=document.querySelector("style[".concat(IN,"]"));if(n){var i;LN=!1,(i=n.parentNode)===null||i===void 0||i.removeChild(n)}document.body.removeChild(t)}}function tK(t){return eK(),!!Ap[t]}function nK(t){var e=Ap[t],n=null;if(e&&_a())if(LN)n=RN;else{var i=document.querySelector("style[".concat(xc,'="').concat(Ap[t],'"]'));i?n=i.innerHTML:delete Ap[t]}return[n,e]}var iK="_skip_check_",kN="_multi_value_";function xS(t){var e=KP(KY(t),QY);return e.replace(/\{%%%\:[^;];}/g,";")}function rK(t){return ai(t)==="object"&&t&&(iK in t||kN in t)}function sK(t,e,n){if(!e)return t;var i=".".concat(e),r=n==="low"?":where(".concat(i,")"):i,a=t.split(",").map(function(u){var l,f=u.trim().split(/\s+/),g=f[0]||"",y=((l=g.match(/^\w+/))===null||l===void 0?void 0:l[0])||"";return g="".concat(y).concat(r).concat(g.slice(y.length)),[g].concat(Gn(f.slice(1))).join(" ")});return a.join(",")}var oK=function t(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{root:!0,parentSelectors:[]},r=i.root,a=i.injectHash,u=i.parentSelectors,l=n.hashId,f=n.layer;n.path;var g=n.hashPriority,y=n.transformers,S=y===void 0?[]:y;n.linters;var b="",A={};function I(P){var N=P.getName(l);if(!A[N]){var B=t(P.style,n,{root:!1,parentSelectors:u}),$=Xn(B,1),K=$[0];A[N]="@keyframes ".concat(P.getName(l)).concat(K)}}function D(P){var N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return P.forEach(function(B){Array.isArray(B)?D(B,N):B&&N.push(B)}),N}var L=D(Array.isArray(e)?e:[e]);return L.forEach(function(P){var N=typeof P=="string"&&!r?{}:P;if(typeof N=="string")b+="".concat(N,`
`);else if(N._keyframe)I(N);else{var B=S.reduce(function($,K){var q;return(K==null||(q=K.visit)===null||q===void 0?void 0:q.call(K,$))||$},N);Object.keys(B).forEach(function($){var K=B[$];if(ai(K)==="object"&&K&&($!=="animationName"||!K._keyframe)&&!rK(K)){var q=!1,W=$.trim(),ie=!1;(r||a)&&l?W.startsWith("@")?q=!0:W=sK($,l,g):r&&!l&&(W==="&"||W==="")&&(W="",ie=!0);var Z=t(K,n,{root:ie,injectHash:q,parentSelectors:[].concat(Gn(u),[W])}),X=Xn(Z,2),se=X[0],De=X[1];A=It(It({},A),De),b+="".concat(W).concat(se)}else{let Ye=function(ye,Ce){var ge=ye.replace(/[A-Z]/g,function(Ze){return"-".concat(Ze.toLowerCase())}),Be=Ce;!zY[ye]&&typeof Be=="number"&&Be!==0&&(Be="".concat(Be,"px")),ye==="animationName"&&Ce!==null&&Ce!==void 0&&Ce._keyframe&&(I(Ce),Be=Ce.getName(l)),b+="".concat(ge,":").concat(Be,";")};var Se,Me=(Se=K==null?void 0:K.value)!==null&&Se!==void 0?Se:K;ai(K)==="object"&&K!==null&&K!==void 0&&K[kN]&&Array.isArray(Me)?Me.forEach(function(ye){Ye($,ye)}):Ye($,Me)}})}}),r?f&&(b="@layer ".concat(f.name," {").concat(b,"}"),f.dependencies&&(A["@layer ".concat(f.name)]=f.dependencies.map(function(P){return"@layer ".concat(P,", ").concat(f.name,";")}).join(`
`))):b="{".concat(b,"}"),[b,A]};function DN(t,e){return P_("".concat(t.join("%")).concat(e))}function aK(){return null}var ON="style";function JP(t,e){var n=t.token,i=t.path,r=t.hashId,a=t.layer,u=t.nonce,l=t.clientOnly,f=t.order,g=f===void 0?0:f,y=he.useContext(uS),S=y.autoClear;y.mock;var b=y.defaultCache,A=y.hashPriority,I=y.container,D=y.ssrInline,L=y.transformers,P=y.linters,N=y.cache,B=y.layer,$=n._tokenKey,K=[$];B&&K.push("layer"),K.push.apply(K,Gn(i));var q=GP,W=WP(ON,K,function(){var De=K.join("|");if(tK(De)){var Se=nK(De),Me=Xn(Se,2),Ye=Me[0],ye=Me[1];if(Ye)return[Ye,$,ye,{},l,g]}var Ce=e(),ge=oK(Ce,{hashId:r,hashPriority:A,layer:B?a:void 0,path:i.join("-"),transformers:L,linters:P}),Be=Xn(ge,2),Ze=Be[0],je=Be[1],wt=xS(Ze),Xt=DN(K,wt);return[wt,$,Xt,je,l,g]},function(De,Se){var Me=Xn(De,3),Ye=Me[2];(Se||S)&&GP&&I_(Ye,{mark:xc})},function(De){var Se=Xn(De,4),Me=Se[0];Se[1];var Ye=Se[2],ye=Se[3];if(q&&Me!==RN){var Ce={mark:xc,prepend:B?!1:"queue",attachTo:I,priority:g},ge=typeof u=="function"?u():u;ge&&(Ce.csp={nonce:ge});var Be=[],Ze=[];Object.keys(ye).forEach(function(wt){wt.startsWith("@layer")?Be.push(wt):Ze.push(wt)}),Be.forEach(function(wt){yh(xS(ye[wt]),"_layer-".concat(wt),It(It({},Ce),{},{prepend:!0}))});var je=yh(Me,Ye,Ce);je[Zd]=N.instanceId,je.setAttribute(_v,$),Ze.forEach(function(wt){yh(xS(ye[wt]),"_effect-".concat(wt),Ce)})}}),ie=Xn(W,3),Z=ie[0],X=ie[1],se=ie[2];return function(De){var Se;return!D||q||!b?Se=he.createElement(aK,null):Se=he.createElement("style",Kr({},vt(vt({},_v,X),xc,se),{dangerouslySetInnerHTML:{__html:Z}})),he.createElement(he.Fragment,null,Se,De)}}var lK=function(e,n,i){var r=Xn(e,6),a=r[0],u=r[1],l=r[2],f=r[3],g=r[4],y=r[5],S=i||{},b=S.plain;if(g)return null;var A=a,I={"data-rc-order":"prependQueue","data-rc-priority":"".concat(y)};return A=hS(a,u,l,I,b),f&&Object.keys(f).forEach(function(D){if(!n[D]){n[D]=!0;var L=xS(f[D]),P=hS(L,u,"_effect-".concat(D),I,b);D.startsWith("@layer")?A=P+A:A+=P}}),[y,l,A]},FN="cssVar",cK=function(e,n){var i=e.key,r=e.prefix,a=e.unitless,u=e.ignore,l=e.token,f=e.scope,g=f===void 0?"":f,y=he.useContext(uS),S=y.cache.instanceId,b=y.container,A=l._tokenKey,I=[].concat(Gn(e.path),[i,g,A]),D=WP(FN,I,function(){var L=n(),P=yN(L,i,{prefix:r,unitless:a,ignore:u,scope:g}),N=Xn(P,2),B=N[0],$=N[1],K=DN(I,$);return[B,$,K,i]},function(L){var P=Xn(L,3),N=P[2];GP&&I_(N,{mark:xc})},function(L){var P=Xn(L,3),N=P[1],B=P[2];if(N){var $=yh(N,B,{mark:xc,prepend:"queue",attachTo:b,priority:-999});$[Zd]=S,$.setAttribute(_v,i)}});return D},uK=function(e,n,i){var r=Xn(e,4),a=r[1],u=r[2],l=r[3],f=i||{},g=f.plain;if(!a)return null;var y=-999,S={"data-rc-order":"prependQueue","data-rc-priority":"".concat(y)},b=hS(a,l,u,S,g);return[y,u,b]};vt(vt(vt({},ON,lK),bN,FY),FN,uK);var Qo=function(){function t(e,n){Ko(this,t),vt(this,"name",void 0),vt(this,"style",void 0),vt(this,"_keyframe",!0),this.name=e,this.style=n}return Jo(t,[{key:"getName",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return n?"".concat(n,"-").concat(this.name):this.name}}]),t}();function wv(t){return t.notSplit=!0,t}wv(["borderTop","borderBottom"]),wv(["borderTop"]),wv(["borderBottom"]),wv(["borderLeft","borderRight"]),wv(["borderLeft"]),wv(["borderRight"]);var QP=he.createContext({});function hK(t){return aN(t)||nN(t)||kP(t)||lN()}function au(t,e){for(var n=t,i=0;i<e.length;i+=1){if(n==null)return;n=n[e[i]]}return n}function zN(t,e,n,i){if(!e.length)return n;var r=hK(e),a=r[0],u=r.slice(1),l;return!t&&typeof a=="number"?l=[]:Array.isArray(t)?l=Gn(t):l=It({},t),i&&n===void 0&&u.length===1?delete l[a][u[0]]:l[a]=zN(l[a],u,n,i),l}function wc(t,e,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;return e.length&&i&&n===void 0&&!au(t,e.slice(0,-1))?t:zN(t,e,n,i)}function dK(t){return ai(t)==="object"&&t!==null&&Object.getPrototypeOf(t)===Object.prototype}function NN(t){return Array.isArray(t)?[]:{}}var fK=typeof Reflect>"u"?Object.keys:Reflect.ownKeys;function Sv(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i=NN(e[0]);return e.forEach(function(r){function a(u,l){var f=new Set(l),g=au(r,u),y=Array.isArray(g);if(y||dK(g)){if(!f.has(g)){f.add(g);var S=au(i,u);y?i=wc(i,u,[]):(!S||ai(S)!=="object")&&(i=wc(i,u,NN(g))),fK(g).forEach(function(b){a([].concat(Gn(u),[b]),f)})}}else i=wc(i,u,g)}a([])}),i}const pK=he.createContext({}),mK=he.createContext(void 0);var gK={items_per_page:"/ page",jump_to:"Go to",jump_to_confirm:"confirm",page:"Page",prev_page:"Previous Page",next_page:"Next Page",prev_5:"Previous 5 Pages",next_5:"Next 5 Pages",prev_3:"Previous 3 Pages",next_3:"Next 3 Pages",page_size:"Page Size"},vK={yearFormat:"YYYY",dayFormat:"D",cellMeridiemFormat:"A",monthBeforeYear:!0},yK=It(It({},vK),{},{locale:"en_US",today:"Today",now:"Now",backToToday:"Back to today",ok:"OK",clear:"Clear",month:"Month",year:"Year",timeSelect:"select time",dateSelect:"select date",weekSelect:"Choose a week",monthSelect:"Choose a month",yearSelect:"Choose a year",decadeSelect:"Choose a decade",dateFormat:"M/D/YYYY",dateTimeFormat:"M/D/YYYY HH:mm:ss",previousMonth:"Previous month (PageUp)",nextMonth:"Next month (PageDown)",previousYear:"Last year (Control + left)",nextYear:"Next year (Control + right)",previousDecade:"Last decade",nextDecade:"Next decade",previousCentury:"Last century",nextCentury:"Next century"});const BN={placeholder:"Select time",rangePlaceholder:["Start time","End time"]},UN={lang:Object.assign({placeholder:"Select date",yearPlaceholder:"Select year",quarterPlaceholder:"Select quarter",monthPlaceholder:"Select month",weekPlaceholder:"Select week",rangePlaceholder:["Start date","End date"],rangeYearPlaceholder:["Start year","End year"],rangeQuarterPlaceholder:["Start quarter","End quarter"],rangeMonthPlaceholder:["Start month","End month"],rangeWeekPlaceholder:["Start week","End week"]},yK),timePickerLocale:Object.assign({},BN)},Xa="${label} is not a valid ${type}",Pp={locale:"en",Pagination:gK,DatePicker:UN,TimePicker:BN,Calendar:UN,global:{placeholder:"Please select"},Table:{filterTitle:"Filter menu",filterConfirm:"OK",filterReset:"Reset",filterEmptyText:"No filters",filterCheckall:"Select all items",filterSearchPlaceholder:"Search in filters",emptyText:"No data",selectAll:"Select current page",selectInvert:"Invert current page",selectNone:"Clear all data",selectionAll:"Select all data",sortTitle:"Sort",expand:"Expand row",collapse:"Collapse row",triggerDesc:"Click to sort descending",triggerAsc:"Click to sort ascending",cancelSort:"Click to cancel sorting"},Tour:{Next:"Next",Previous:"Previous",Finish:"Finish"},Modal:{okText:"OK",cancelText:"Cancel",justOkText:"OK"},Popconfirm:{okText:"OK",cancelText:"Cancel"},Transfer:{titles:["",""],searchPlaceholder:"Search here",itemUnit:"item",itemsUnit:"items",remove:"Remove",selectCurrent:"Select current page",removeCurrent:"Remove current page",selectAll:"Select all data",deselectAll:"Deselect all data",removeAll:"Remove all data",selectInvert:"Invert current page"},Upload:{uploading:"Uploading...",removeFile:"Remove file",uploadError:"Upload error",previewFile:"Preview file",downloadFile:"Download file"},Empty:{description:"No data"},Icon:{icon:"icon"},Text:{edit:"Edit",copy:"Copy",copied:"Copied",expand:"Expand",collapse:"Collapse"},Form:{optional:"(optional)",defaultValidateMessages:{default:"Field validation error for ${label}",required:"Please enter ${label}",enum:"${label} must be one of [${enum}]",whitespace:"${label} cannot be a blank character",date:{format:"${label} date format is invalid",parse:"${label} cannot be converted to a date",invalid:"${label} is an invalid date"},types:{string:Xa,method:Xa,array:Xa,object:Xa,number:Xa,date:Xa,boolean:Xa,integer:Xa,float:Xa,regexp:Xa,email:Xa,url:Xa,hex:Xa},string:{len:"${label} must be ${len} characters",min:"${label} must be at least ${min} characters",max:"${label} must be up to ${max} characters",range:"${label} must be between ${min}-${max} characters"},number:{len:"${label} must be equal to ${len}",min:"${label} must be minimum ${min}",max:"${label} must be maximum ${max}",range:"${label} must be between ${min}-${max}"},array:{len:"Must be ${len} ${label}",min:"At least ${min} ${label}",max:"At most ${max} ${label}",range:"The amount of ${label} must be between ${min}-${max}"},pattern:{mismatch:"${label} does not match the pattern ${pattern}"}}},Image:{preview:"Preview"},QRCode:{expired:"QR code expired",refresh:"Refresh",scanned:"Scanned"},ColorPicker:{presetEmpty:"Empty",transparent:"Transparent",singleColor:"Single",gradientColor:"Gradient"}};let bS=Object.assign({},Pp.Modal),wS=[];const VN=()=>wS.reduce((t,e)=>Object.assign(Object.assign({},t),e),Pp.Modal);function _K(t){if(t){const e=Object.assign({},t);return wS.push(e),bS=VN(),()=>{wS=wS.filter(n=>n!==e),bS=VN()}}bS=Object.assign({},Pp.Modal)}function $N(){return bS}const e3=he.createContext(void 0),t3=(t,e)=>{const n=he.useContext(e3),i=he.useMemo(()=>{var a;const u=e||Pp[t],l=(a=n==null?void 0:n[t])!==null&&a!==void 0?a:{};return Object.assign(Object.assign({},typeof u=="function"?u():u),l||{})},[t,e,n]),r=he.useMemo(()=>{const a=n==null?void 0:n.locale;return n!=null&&n.exist&&!a?Pp.locale:a},[n]);return[i,r]},xK="internalMark",bK=t=>{const{locale:e={},children:n,_ANT_MARK__:i}=t;he.useEffect(()=>_K(e==null?void 0:e.Modal),[e]);const r=he.useMemo(()=>Object.assign(Object.assign({},e),{exist:!0}),[e]);return he.createElement(e3.Provider,{value:r},n)};function co(t,e){wK(t)&&(t="100%");var n=SK(t);return t=e===360?t:Math.min(e,Math.max(0,parseFloat(t))),n&&(t=parseInt(String(t*e),10)/100),Math.abs(t-e)<1e-6?1:(e===360?t=(t<0?t%e+e:t%e)/parseFloat(String(e)):t=t%e/parseFloat(String(e)),t)}function SS(t){return Math.min(1,Math.max(0,t))}function wK(t){return typeof t=="string"&&t.indexOf(".")!==-1&&parseFloat(t)===1}function SK(t){return typeof t=="string"&&t.indexOf("%")!==-1}function HN(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function ES(t){return t<=1?"".concat(Number(t)*100,"%"):t}function Ip(t){return t.length===1?"0"+t:String(t)}function EK(t,e,n){return{r:co(t,255)*255,g:co(e,255)*255,b:co(n,255)*255}}function GN(t,e,n){t=co(t,255),e=co(e,255),n=co(n,255);var i=Math.max(t,e,n),r=Math.min(t,e,n),a=0,u=0,l=(i+r)/2;if(i===r)u=0,a=0;else{var f=i-r;switch(u=l>.5?f/(2-i-r):f/(i+r),i){case t:a=(e-n)/f+(e<n?6:0);break;case e:a=(n-t)/f+2;break;case n:a=(t-e)/f+4;break}a/=6}return{h:a,s:u,l}}function n3(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*(6*n):n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function MK(t,e,n){var i,r,a;if(t=co(t,360),e=co(e,100),n=co(n,100),e===0)r=n,a=n,i=n;else{var u=n<.5?n*(1+e):n+e-n*e,l=2*n-u;i=n3(l,u,t+1/3),r=n3(l,u,t),a=n3(l,u,t-1/3)}return{r:i*255,g:r*255,b:a*255}}function i3(t,e,n){t=co(t,255),e=co(e,255),n=co(n,255);var i=Math.max(t,e,n),r=Math.min(t,e,n),a=0,u=i,l=i-r,f=i===0?0:l/i;if(i===r)a=0;else{switch(i){case t:a=(e-n)/l+(e<n?6:0);break;case e:a=(n-t)/l+2;break;case n:a=(t-e)/l+4;break}a/=6}return{h:a,s:f,v:u}}function CK(t,e,n){t=co(t,360)*6,e=co(e,100),n=co(n,100);var i=Math.floor(t),r=t-i,a=n*(1-e),u=n*(1-r*e),l=n*(1-(1-r)*e),f=i%6,g=[n,u,a,a,l,n][f],y=[l,n,n,u,a,a][f],S=[a,a,l,n,n,u][f];return{r:g*255,g:y*255,b:S*255}}function r3(t,e,n,i){var r=[Ip(Math.round(t).toString(16)),Ip(Math.round(e).toString(16)),Ip(Math.round(n).toString(16))];return i&&r[0].startsWith(r[0].charAt(1))&&r[1].startsWith(r[1].charAt(1))&&r[2].startsWith(r[2].charAt(1))?r[0].charAt(0)+r[1].charAt(0)+r[2].charAt(0):r.join("")}function TK(t,e,n,i,r){var a=[Ip(Math.round(t).toString(16)),Ip(Math.round(e).toString(16)),Ip(Math.round(n).toString(16)),Ip(AK(i))];return r&&a[0].startsWith(a[0].charAt(1))&&a[1].startsWith(a[1].charAt(1))&&a[2].startsWith(a[2].charAt(1))&&a[3].startsWith(a[3].charAt(1))?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0)+a[3].charAt(0):a.join("")}function AK(t){return Math.round(parseFloat(t)*255).toString(16)}function WN(t){return Za(t)/255}function Za(t){return parseInt(t,16)}function PK(t){return{r:t>>16,g:(t&65280)>>8,b:t&255}}var s3={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function Ev(t){var e={r:0,g:0,b:0},n=1,i=null,r=null,a=null,u=!1,l=!1;return typeof t=="string"&&(t=LK(t)),typeof t=="object"&&(xh(t.r)&&xh(t.g)&&xh(t.b)?(e=EK(t.r,t.g,t.b),u=!0,l=String(t.r).substr(-1)==="%"?"prgb":"rgb"):xh(t.h)&&xh(t.s)&&xh(t.v)?(i=ES(t.s),r=ES(t.v),e=CK(t.h,i,r),u=!0,l="hsv"):xh(t.h)&&xh(t.s)&&xh(t.l)&&(i=ES(t.s),a=ES(t.l),e=MK(t.h,i,a),u=!0,l="hsl"),Object.prototype.hasOwnProperty.call(t,"a")&&(n=t.a)),n=HN(n),{ok:u,format:t.format||l,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:n}}var IK="[-\\+]?\\d+%?",RK="[-\\+]?\\d*\\.\\d+%?",Yd="(?:".concat(RK,")|(?:").concat(IK,")"),o3="[\\s|\\(]+(".concat(Yd,")[,|\\s]+(").concat(Yd,")[,|\\s]+(").concat(Yd,")\\s*\\)?"),a3="[\\s|\\(]+(".concat(Yd,")[,|\\s]+(").concat(Yd,")[,|\\s]+(").concat(Yd,")[,|\\s]+(").concat(Yd,")\\s*\\)?"),Sc={CSS_UNIT:new RegExp(Yd),rgb:new RegExp("rgb"+o3),rgba:new RegExp("rgba"+a3),hsl:new RegExp("hsl"+o3),hsla:new RegExp("hsla"+a3),hsv:new RegExp("hsv"+o3),hsva:new RegExp("hsva"+a3),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function LK(t){if(t=t.trim().toLowerCase(),t.length===0)return!1;var e=!1;if(s3[t])t=s3[t],e=!0;else if(t==="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var n=Sc.rgb.exec(t);return n?{r:n[1],g:n[2],b:n[3]}:(n=Sc.rgba.exec(t),n?{r:n[1],g:n[2],b:n[3],a:n[4]}:(n=Sc.hsl.exec(t),n?{h:n[1],s:n[2],l:n[3]}:(n=Sc.hsla.exec(t),n?{h:n[1],s:n[2],l:n[3],a:n[4]}:(n=Sc.hsv.exec(t),n?{h:n[1],s:n[2],v:n[3]}:(n=Sc.hsva.exec(t),n?{h:n[1],s:n[2],v:n[3],a:n[4]}:(n=Sc.hex8.exec(t),n?{r:Za(n[1]),g:Za(n[2]),b:Za(n[3]),a:WN(n[4]),format:e?"name":"hex8"}:(n=Sc.hex6.exec(t),n?{r:Za(n[1]),g:Za(n[2]),b:Za(n[3]),format:e?"name":"hex"}:(n=Sc.hex4.exec(t),n?{r:Za(n[1]+n[1]),g:Za(n[2]+n[2]),b:Za(n[3]+n[3]),a:WN(n[4]+n[4]),format:e?"name":"hex8"}:(n=Sc.hex3.exec(t),n?{r:Za(n[1]+n[1]),g:Za(n[2]+n[2]),b:Za(n[3]+n[3]),format:e?"name":"hex"}:!1)))))))))}function xh(t){return!!Sc.CSS_UNIT.exec(String(t))}var Ya=function(){function t(e,n){e===void 0&&(e=""),n===void 0&&(n={});var i;if(e instanceof t)return e;typeof e=="number"&&(e=PK(e)),this.originalInput=e;var r=Ev(e);this.originalInput=e,this.r=r.r,this.g=r.g,this.b=r.b,this.a=r.a,this.roundA=Math.round(100*this.a)/100,this.format=(i=n.format)!==null&&i!==void 0?i:r.format,this.gradientType=n.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=r.ok}return t.prototype.isDark=function(){return this.getBrightness()<128},t.prototype.isLight=function(){return!this.isDark()},t.prototype.getBrightness=function(){var e=this.toRgb();return(e.r*299+e.g*587+e.b*114)/1e3},t.prototype.getLuminance=function(){var e=this.toRgb(),n,i,r,a=e.r/255,u=e.g/255,l=e.b/255;return a<=.03928?n=a/12.92:n=Math.pow((a+.055)/1.055,2.4),u<=.03928?i=u/12.92:i=Math.pow((u+.055)/1.055,2.4),l<=.03928?r=l/12.92:r=Math.pow((l+.055)/1.055,2.4),.2126*n+.7152*i+.0722*r},t.prototype.getAlpha=function(){return this.a},t.prototype.setAlpha=function(e){return this.a=HN(e),this.roundA=Math.round(100*this.a)/100,this},t.prototype.isMonochrome=function(){var e=this.toHsl().s;return e===0},t.prototype.toHsv=function(){var e=i3(this.r,this.g,this.b);return{h:e.h*360,s:e.s,v:e.v,a:this.a}},t.prototype.toHsvString=function(){var e=i3(this.r,this.g,this.b),n=Math.round(e.h*360),i=Math.round(e.s*100),r=Math.round(e.v*100);return this.a===1?"hsv(".concat(n,", ").concat(i,"%, ").concat(r,"%)"):"hsva(".concat(n,", ").concat(i,"%, ").concat(r,"%, ").concat(this.roundA,")")},t.prototype.toHsl=function(){var e=GN(this.r,this.g,this.b);return{h:e.h*360,s:e.s,l:e.l,a:this.a}},t.prototype.toHslString=function(){var e=GN(this.r,this.g,this.b),n=Math.round(e.h*360),i=Math.round(e.s*100),r=Math.round(e.l*100);return this.a===1?"hsl(".concat(n,", ").concat(i,"%, ").concat(r,"%)"):"hsla(".concat(n,", ").concat(i,"%, ").concat(r,"%, ").concat(this.roundA,")")},t.prototype.toHex=function(e){return e===void 0&&(e=!1),r3(this.r,this.g,this.b,e)},t.prototype.toHexString=function(e){return e===void 0&&(e=!1),"#"+this.toHex(e)},t.prototype.toHex8=function(e){return e===void 0&&(e=!1),TK(this.r,this.g,this.b,this.a,e)},t.prototype.toHex8String=function(e){return e===void 0&&(e=!1),"#"+this.toHex8(e)},t.prototype.toHexShortString=function(e){return e===void 0&&(e=!1),this.a===1?this.toHexString(e):this.toHex8String(e)},t.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},t.prototype.toRgbString=function(){var e=Math.round(this.r),n=Math.round(this.g),i=Math.round(this.b);return this.a===1?"rgb(".concat(e,", ").concat(n,", ").concat(i,")"):"rgba(".concat(e,", ").concat(n,", ").concat(i,", ").concat(this.roundA,")")},t.prototype.toPercentageRgb=function(){var e=function(n){return"".concat(Math.round(co(n,255)*100),"%")};return{r:e(this.r),g:e(this.g),b:e(this.b),a:this.a}},t.prototype.toPercentageRgbString=function(){var e=function(n){return Math.round(co(n,255)*100)};return this.a===1?"rgb(".concat(e(this.r),"%, ").concat(e(this.g),"%, ").concat(e(this.b),"%)"):"rgba(".concat(e(this.r),"%, ").concat(e(this.g),"%, ").concat(e(this.b),"%, ").concat(this.roundA,")")},t.prototype.toName=function(){if(this.a===0)return"transparent";if(this.a<1)return!1;for(var e="#"+r3(this.r,this.g,this.b,!1),n=0,i=Object.entries(s3);n<i.length;n++){var r=i[n],a=r[0],u=r[1];if(e===u)return a}return!1},t.prototype.toString=function(e){var n=!!e;e=e??this.format;var i=!1,r=this.a<1&&this.a>=0,a=!n&&r&&(e.startsWith("hex")||e==="name");return a?e==="name"&&this.a===0?this.toName():this.toRgbString():(e==="rgb"&&(i=this.toRgbString()),e==="prgb"&&(i=this.toPercentageRgbString()),(e==="hex"||e==="hex6")&&(i=this.toHexString()),e==="hex3"&&(i=this.toHexString(!0)),e==="hex4"&&(i=this.toHex8String(!0)),e==="hex8"&&(i=this.toHex8String()),e==="name"&&(i=this.toName()),e==="hsl"&&(i=this.toHslString()),e==="hsv"&&(i=this.toHsvString()),i||this.toHexString())},t.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},t.prototype.clone=function(){return new t(this.toString())},t.prototype.lighten=function(e){e===void 0&&(e=10);var n=this.toHsl();return n.l+=e/100,n.l=SS(n.l),new t(n)},t.prototype.brighten=function(e){e===void 0&&(e=10);var n=this.toRgb();return n.r=Math.max(0,Math.min(255,n.r-Math.round(255*-(e/100)))),n.g=Math.max(0,Math.min(255,n.g-Math.round(255*-(e/100)))),n.b=Math.max(0,Math.min(255,n.b-Math.round(255*-(e/100)))),new t(n)},t.prototype.darken=function(e){e===void 0&&(e=10);var n=this.toHsl();return n.l-=e/100,n.l=SS(n.l),new t(n)},t.prototype.tint=function(e){return e===void 0&&(e=10),this.mix("white",e)},t.prototype.shade=function(e){return e===void 0&&(e=10),this.mix("black",e)},t.prototype.desaturate=function(e){e===void 0&&(e=10);var n=this.toHsl();return n.s-=e/100,n.s=SS(n.s),new t(n)},t.prototype.saturate=function(e){e===void 0&&(e=10);var n=this.toHsl();return n.s+=e/100,n.s=SS(n.s),new t(n)},t.prototype.greyscale=function(){return this.desaturate(100)},t.prototype.spin=function(e){var n=this.toHsl(),i=(n.h+e)%360;return n.h=i<0?360+i:i,new t(n)},t.prototype.mix=function(e,n){n===void 0&&(n=50);var i=this.toRgb(),r=new t(e).toRgb(),a=n/100,u={r:(r.r-i.r)*a+i.r,g:(r.g-i.g)*a+i.g,b:(r.b-i.b)*a+i.b,a:(r.a-i.a)*a+i.a};return new t(u)},t.prototype.analogous=function(e,n){e===void 0&&(e=6),n===void 0&&(n=30);var i=this.toHsl(),r=360/n,a=[this];for(i.h=(i.h-(r*e>>1)+720)%360;--e;)i.h=(i.h+r)%360,a.push(new t(i));return a},t.prototype.complement=function(){var e=this.toHsl();return e.h=(e.h+180)%360,new t(e)},t.prototype.monochromatic=function(e){e===void 0&&(e=6);for(var n=this.toHsv(),i=n.h,r=n.s,a=n.v,u=[],l=1/e;e--;)u.push(new t({h:i,s:r,v:a})),a=(a+l)%1;return u},t.prototype.splitcomplement=function(){var e=this.toHsl(),n=e.h;return[this,new t({h:(n+72)%360,s:e.s,l:e.l}),new t({h:(n+216)%360,s:e.s,l:e.l})]},t.prototype.onBackground=function(e){var n=this.toRgb(),i=new t(e).toRgb(),r=n.a+i.a*(1-n.a);return new t({r:(n.r*n.a+i.r*i.a*(1-n.a))/r,g:(n.g*n.a+i.g*i.a*(1-n.a))/r,b:(n.b*n.a+i.b*i.a*(1-n.a))/r,a:r})},t.prototype.triad=function(){return this.polyad(3)},t.prototype.tetrad=function(){return this.polyad(4)},t.prototype.polyad=function(e){for(var n=this.toHsl(),i=n.h,r=[this],a=360/e,u=1;u<e;u++)r.push(new t({h:(i+u*a)%360,s:n.s,l:n.l}));return r},t.prototype.equals=function(e){return this.toRgbString()===new t(e).toRgbString()},t}(),MS=2,jN=.16,kK=.05,DK=.05,OK=.15,qN=5,XN=4,FK=[{index:7,opacity:.15},{index:6,opacity:.25},{index:5,opacity:.3},{index:5,opacity:.45},{index:5,opacity:.65},{index:5,opacity:.85},{index:4,opacity:.9},{index:3,opacity:.95},{index:2,opacity:.97},{index:1,opacity:.98}];function ZN(t){var e=t.r,n=t.g,i=t.b,r=i3(e,n,i);return{h:r.h*360,s:r.s,v:r.v}}function CS(t){var e=t.r,n=t.g,i=t.b;return"#".concat(r3(e,n,i,!1))}function zK(t,e,n){var i=n/100,r={r:(e.r-t.r)*i+t.r,g:(e.g-t.g)*i+t.g,b:(e.b-t.b)*i+t.b};return r}function YN(t,e,n){var i;return Math.round(t.h)>=60&&Math.round(t.h)<=240?i=n?Math.round(t.h)-MS*e:Math.round(t.h)+MS*e:i=n?Math.round(t.h)+MS*e:Math.round(t.h)-MS*e,i<0?i+=360:i>=360&&(i-=360),i}function KN(t,e,n){if(t.h===0&&t.s===0)return t.s;var i;return n?i=t.s-jN*e:e===XN?i=t.s+jN:i=t.s+kK*e,i>1&&(i=1),n&&e===qN&&i>.1&&(i=.1),i<.06&&(i=.06),Number(i.toFixed(2))}function JN(t,e,n){var i;return n?i=t.v+DK*e:i=t.v-OK*e,i>1&&(i=1),Number(i.toFixed(2))}function D_(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=[],i=Ev(t),r=qN;r>0;r-=1){var a=ZN(i),u=CS(Ev({h:YN(a,r,!0),s:KN(a,r,!0),v:JN(a,r,!0)}));n.push(u)}n.push(CS(i));for(var l=1;l<=XN;l+=1){var f=ZN(i),g=CS(Ev({h:YN(f,l),s:KN(f,l),v:JN(f,l)}));n.push(g)}return e.theme==="dark"?FK.map(function(y){var S=y.index,b=y.opacity,A=CS(zK(Ev(e.backgroundColor||"#141414"),Ev(n[S]),b*100));return A}):n}var l3={red:"#F5222D",volcano:"#FA541C",orange:"#FA8C16",gold:"#FAAD14",yellow:"#FADB14",lime:"#A0D911",green:"#52C41A",cyan:"#13C2C2",blue:"#1677FF",geekblue:"#2F54EB",purple:"#722ED1",magenta:"#EB2F96",grey:"#666666"},c3=["#fff1f0","#ffccc7","#ffa39e","#ff7875","#ff4d4f","#f5222d","#cf1322","#a8071a","#820014","#5c0011"];c3.primary=c3[5];var u3=["#fff2e8","#ffd8bf","#ffbb96","#ff9c6e","#ff7a45","#fa541c","#d4380d","#ad2102","#871400","#610b00"];u3.primary=u3[5];var h3=["#fff7e6","#ffe7ba","#ffd591","#ffc069","#ffa940","#fa8c16","#d46b08","#ad4e00","#873800","#612500"];h3.primary=h3[5];var d3=["#fffbe6","#fff1b8","#ffe58f","#ffd666","#ffc53d","#faad14","#d48806","#ad6800","#874d00","#613400"];d3.primary=d3[5];var f3=["#feffe6","#ffffb8","#fffb8f","#fff566","#ffec3d","#fadb14","#d4b106","#ad8b00","#876800","#614700"];f3.primary=f3[5];var p3=["#fcffe6","#f4ffb8","#eaff8f","#d3f261","#bae637","#a0d911","#7cb305","#5b8c00","#3f6600","#254000"];p3.primary=p3[5];var m3=["#f6ffed","#d9f7be","#b7eb8f","#95de64","#73d13d","#52c41a","#389e0d","#237804","#135200","#092b00"];m3.primary=m3[5];var g3=["#e6fffb","#b5f5ec","#87e8de","#5cdbd3","#36cfc9","#13c2c2","#08979c","#006d75","#00474f","#002329"];g3.primary=g3[5];var TS=["#e6f4ff","#bae0ff","#91caff","#69b1ff","#4096ff","#1677ff","#0958d9","#003eb3","#002c8c","#001d66"];TS.primary=TS[5];var v3=["#f0f5ff","#d6e4ff","#adc6ff","#85a5ff","#597ef7","#2f54eb","#1d39c4","#10239e","#061178","#030852"];v3.primary=v3[5];var y3=["#f9f0ff","#efdbff","#d3adf7","#b37feb","#9254de","#722ed1","#531dab","#391085","#22075e","#120338"];y3.primary=y3[5];var _3=["#fff0f6","#ffd6e7","#ffadd2","#ff85c0","#f759ab","#eb2f96","#c41d7f","#9e1068","#780650","#520339"];_3.primary=_3[5];var x3=["#a6a6a6","#999999","#8c8c8c","#808080","#737373","#666666","#404040","#1a1a1a","#000000","#000000"];x3.primary=x3[5];var b3={red:c3,volcano:u3,orange:h3,gold:d3,yellow:f3,lime:p3,green:m3,cyan:g3,blue:TS,geekblue:v3,purple:y3,magenta:_3,grey:x3};const QN={blue:"#1677FF",purple:"#722ED1",cyan:"#13C2C2",green:"#52C41A",magenta:"#EB2F96",pink:"#EB2F96",red:"#F5222D",orange:"#FA8C16",yellow:"#FADB14",volcano:"#FA541C",geekblue:"#2F54EB",gold:"#FAAD14",lime:"#A0D911"},O_=Object.assign(Object.assign({},QN),{colorPrimary:"#1677ff",colorSuccess:"#52c41a",colorWarning:"#faad14",colorError:"#ff4d4f",colorInfo:"#1677ff",colorLink:"",colorTextBase:"",colorBgBase:"",fontFamily:`-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial,
'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol',
'Noto Color Emoji'`,fontFamilyCode:"'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace",fontSize:14,lineWidth:1,lineType:"solid",motionUnit:.1,motionBase:0,motionEaseOutCirc:"cubic-bezier(0.08, 0.82, 0.17, 1)",motionEaseInOutCirc:"cubic-bezier(0.78, 0.14, 0.15, 0.86)",motionEaseOut:"cubic-bezier(0.215, 0.61, 0.355, 1)",motionEaseInOut:"cubic-bezier(0.645, 0.045, 0.355, 1)",motionEaseOutBack:"cubic-bezier(0.12, 0.4, 0.29, 1.46)",motionEaseInBack:"cubic-bezier(0.71, -0.46, 0.88, 0.6)",motionEaseInQuint:"cubic-bezier(0.755, 0.05, 0.855, 0.06)",motionEaseOutQuint:"cubic-bezier(0.23, 1, 0.32, 1)",borderRadius:6,sizeUnit:4,sizeStep:4,sizePopupArrow:16,controlHeight:32,zIndexBase:0,zIndexPopupBase:1e3,opacityImage:1,wireframe:!1,motion:!0});function NK(t,e){let{generateColorPalettes:n,generateNeutralColorPalettes:i}=e;const{colorSuccess:r,colorWarning:a,colorError:u,colorInfo:l,colorPrimary:f,colorBgBase:g,colorTextBase:y}=t,S=n(f),b=n(r),A=n(a),I=n(u),D=n(l),L=i(g,y),P=t.colorLink||t.colorInfo,N=n(P);return Object.assign(Object.assign({},L),{colorPrimaryBg:S[1],colorPrimaryBgHover:S[2],colorPrimaryBorder:S[3],colorPrimaryBorderHover:S[4],colorPrimaryHover:S[5],colorPrimary:S[6],colorPrimaryActive:S[7],colorPrimaryTextHover:S[8],colorPrimaryText:S[9],colorPrimaryTextActive:S[10],colorSuccessBg:b[1],colorSuccessBgHover:b[2],colorSuccessBorder:b[3],colorSuccessBorderHover:b[4],colorSuccessHover:b[4],colorSuccess:b[6],colorSuccessActive:b[7],colorSuccessTextHover:b[8],colorSuccessText:b[9],colorSuccessTextActive:b[10],colorErrorBg:I[1],colorErrorBgHover:I[2],colorErrorBgActive:I[3],colorErrorBorder:I[3],colorErrorBorderHover:I[4],colorErrorHover:I[5],colorError:I[6],colorErrorActive:I[7],colorErrorTextHover:I[8],colorErrorText:I[9],colorErrorTextActive:I[10],colorWarningBg:A[1],colorWarningBgHover:A[2],colorWarningBorder:A[3],colorWarningBorderHover:A[4],colorWarningHover:A[4],colorWarning:A[6],colorWarningActive:A[7],colorWarningTextHover:A[8],colorWarningText:A[9],colorWarningTextActive:A[10],colorInfoBg:D[1],colorInfoBgHover:D[2],colorInfoBorder:D[3],colorInfoBorderHover:D[4],colorInfoHover:D[4],colorInfo:D[6],colorInfoActive:D[7],colorInfoTextHover:D[8],colorInfoText:D[9],colorInfoTextActive:D[10],colorLinkHover:N[4],colorLink:N[6],colorLinkActive:N[7],colorBgMask:new Ya("#000").setAlpha(.45).toRgbString(),colorWhite:"#fff"})}const BK=t=>{let e=t,n=t,i=t,r=t;return t<6&&t>=5?e=t+1:t<16&&t>=6?e=t+2:t>=16&&(e=16),t<7&&t>=5?n=4:t<8&&t>=7?n=5:t<14&&t>=8?n=6:t<16&&t>=14?n=7:t>=16&&(n=8),t<6&&t>=2?i=1:t>=6&&(i=2),t>4&&t<8?r=4:t>=8&&(r=6),{borderRadius:t,borderRadiusXS:i,borderRadiusSM:n,borderRadiusLG:e,borderRadiusOuter:r}};function UK(t){const{motionUnit:e,motionBase:n,borderRadius:i,lineWidth:r}=t;return Object.assign({motionDurationFast:`${(n+e).toFixed(1)}s`,motionDurationMid:`${(n+e*2).toFixed(1)}s`,motionDurationSlow:`${(n+e*3).toFixed(1)}s`,lineWidthBold:r+1},BK(i))}const VK=t=>{const{controlHeight:e}=t;return{controlHeightSM:e*.75,controlHeightXS:e*.5,controlHeightLG:e*1.25}};function AS(t){return(t+8)/t}function $K(t){const e=new Array(10).fill(null).map((n,i)=>{const r=i-1,a=t*Math.pow(Math.E,r/5),u=i>1?Math.floor(a):Math.ceil(a);return Math.floor(u/2)*2});return e[1]=t,e.map(n=>({size:n,lineHeight:AS(n)}))}const HK=t=>{const e=$K(t),n=e.map(y=>y.size),i=e.map(y=>y.lineHeight),r=n[1],a=n[0],u=n[2],l=i[1],f=i[0],g=i[2];return{fontSizeSM:a,fontSize:r,fontSizeLG:u,fontSizeXL:n[3],fontSizeHeading1:n[6],fontSizeHeading2:n[5],fontSizeHeading3:n[4],fontSizeHeading4:n[3],fontSizeHeading5:n[2],lineHeight:l,lineHeightLG:g,lineHeightSM:f,fontHeight:Math.round(l*r),fontHeightLG:Math.round(g*u),fontHeightSM:Math.round(f*a),lineHeightHeading1:i[6],lineHeightHeading2:i[5],lineHeightHeading3:i[4],lineHeightHeading4:i[3],lineHeightHeading5:i[2]}};function GK(t){const{sizeUnit:e,sizeStep:n}=t;return{sizeXXL:e*(n+8),sizeXL:e*(n+4),sizeLG:e*(n+2),sizeMD:e*(n+1),sizeMS:e*n,size:e*n,sizeSM:e*(n-1),sizeXS:e*(n-2),sizeXXS:e*(n-3)}}const bh=(t,e)=>new Ya(t).setAlpha(e).toRgbString(),F_=(t,e)=>new Ya(t).darken(e).toHexString(),WK=t=>{const e=D_(t);return{1:e[0],2:e[1],3:e[2],4:e[3],5:e[4],6:e[5],7:e[6],8:e[4],9:e[5],10:e[6]}},jK=(t,e)=>{const n=t||"#fff",i=e||"#000";return{colorBgBase:n,colorTextBase:i,colorText:bh(i,.88),colorTextSecondary:bh(i,.65),colorTextTertiary:bh(i,.45),colorTextQuaternary:bh(i,.25),colorFill:bh(i,.15),colorFillSecondary:bh(i,.06),colorFillTertiary:bh(i,.04),colorFillQuaternary:bh(i,.02),colorBgLayout:F_(n,4),colorBgContainer:F_(n,0),colorBgElevated:F_(n,0),colorBgSpotlight:bh(i,.85),colorBgBlur:"transparent",colorBorder:F_(n,15),colorBorderSecondary:F_(n,6)}};function qK(t){l3.pink=l3.magenta,b3.pink=b3.magenta;const e=Object.keys(QN).map(n=>{const i=t[n]===l3[n]?b3[n]:D_(t[n]);return new Array(10).fill(1).reduce((r,a,u)=>(r[`${n}-${u+1}`]=i[u],r[`${n}${u+1}`]=i[u],r),{})}).reduce((n,i)=>(n=Object.assign(Object.assign({},n),i),n),{});return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},t),e),NK(t,{generateColorPalettes:WK,generateNeutralColorPalettes:jK})),HK(t.fontSize)),GK(t)),VK(t)),UK(t))}const eB=$P(qK),w3={token:O_,override:{override:O_},hashed:!0},tB=un.createContext(w3),PS="ant",S3="anticon",XK=(t,e)=>e||(t?`${PS}-${t}`:PS),ms=he.createContext({getPrefixCls:XK,iconPrefixCls:S3}),{Consumer:gle}=ms,ZK=`-ant-${Date.now()}-${Math.random()}`;function YK(t,e){const n={},i=(u,l)=>{let f=u.clone();return f=(l==null?void 0:l(f))||f,f.toRgbString()},r=(u,l)=>{const f=new Ya(u),g=D_(f.toRgbString());n[`${l}-color`]=i(f),n[`${l}-color-disabled`]=g[1],n[`${l}-color-hover`]=g[4],n[`${l}-color-active`]=g[6],n[`${l}-color-outline`]=f.clone().setAlpha(.2).toRgbString(),n[`${l}-color-deprecated-bg`]=g[0],n[`${l}-color-deprecated-border`]=g[2]};if(e.primaryColor){r(e.primaryColor,"primary");const u=new Ya(e.primaryColor),l=D_(u.toRgbString());l.forEach((g,y)=>{n[`primary-${y+1}`]=g}),n["primary-color-deprecated-l-35"]=i(u,g=>g.lighten(35)),n["primary-color-deprecated-l-20"]=i(u,g=>g.lighten(20)),n["primary-color-deprecated-t-20"]=i(u,g=>g.tint(20)),n["primary-color-deprecated-t-50"]=i(u,g=>g.tint(50)),n["primary-color-deprecated-f-12"]=i(u,g=>g.setAlpha(g.getAlpha()*.12));const f=new Ya(l[0]);n["primary-color-active-deprecated-f-30"]=i(f,g=>g.setAlpha(g.getAlpha()*.3)),n["primary-color-active-deprecated-d-02"]=i(f,g=>g.darken(2))}return e.successColor&&r(e.successColor,"success"),e.warningColor&&r(e.warningColor,"warning"),e.errorColor&&r(e.errorColor,"error"),e.infoColor&&r(e.infoColor,"info"),`
  :root {
    ${Object.keys(n).map(u=>`--${t}-${u}: ${n[u]};`).join(`
`)}
  }
  `.trim()}function KK(t,e){const n=YK(t,e);_a()&&yh(n,`${ZK}-dynamic-theme`)}const IS=he.createContext(!1),nB=t=>{let{children:e,disabled:n}=t;const i=he.useContext(IS);return he.createElement(IS.Provider,{value:n??i},e)},Mv=he.createContext(void 0),JK=t=>{let{children:e,size:n}=t;const i=he.useContext(Mv);return he.createElement(Mv.Provider,{value:n||i},e)};function QK(){const t=he.useContext(IS),e=he.useContext(Mv);return{componentDisabled:t,componentSize:e}}var iB=Jo(function t(){Ko(this,t)}),rB="CALC_UNIT",eJ=new RegExp(rB,"g");function E3(t){return typeof t=="number"?"".concat(t).concat(rB):t}var tJ=function(t){vv(n,t);var e=yv(n);function n(i,r){var a;Ko(this,n),a=e.call(this),vt(bi(a),"result",""),vt(bi(a),"unitlessCssVar",void 0),vt(bi(a),"lowPriority",void 0);var u=ai(i);return a.unitlessCssVar=r,i instanceof n?a.result="(".concat(i.result,")"):u==="number"?a.result=E3(i):u==="string"&&(a.result=i),a}return Jo(n,[{key:"add",value:function(r){return r instanceof n?this.result="".concat(this.result," + ").concat(r.getResult()):(typeof r=="number"||typeof r=="string")&&(this.result="".concat(this.result," + ").concat(E3(r))),this.lowPriority=!0,this}},{key:"sub",value:function(r){return r instanceof n?this.result="".concat(this.result," - ").concat(r.getResult()):(typeof r=="number"||typeof r=="string")&&(this.result="".concat(this.result," - ").concat(E3(r))),this.lowPriority=!0,this}},{key:"mul",value:function(r){return this.lowPriority&&(this.result="(".concat(this.result,")")),r instanceof n?this.result="".concat(this.result," * ").concat(r.getResult(!0)):(typeof r=="number"||typeof r=="string")&&(this.result="".concat(this.result," * ").concat(r)),this.lowPriority=!1,this}},{key:"div",value:function(r){return this.lowPriority&&(this.result="(".concat(this.result,")")),r instanceof n?this.result="".concat(this.result," / ").concat(r.getResult(!0)):(typeof r=="number"||typeof r=="string")&&(this.result="".concat(this.result," / ").concat(r)),this.lowPriority=!1,this}},{key:"getResult",value:function(r){return this.lowPriority||r?"(".concat(this.result,")"):this.result}},{key:"equal",value:function(r){var a=this,u=r||{},l=u.unit,f=!0;return typeof l=="boolean"?f=l:Array.from(this.unitlessCssVar).some(function(g){return a.result.includes(g)})&&(f=!1),this.result=this.result.replace(eJ,f?"px":""),typeof this.lowPriority<"u"?"calc(".concat(this.result,")"):this.result}}]),n}(iB),nJ=function(t){vv(n,t);var e=yv(n);function n(i){var r;return Ko(this,n),r=e.call(this),vt(bi(r),"result",0),i instanceof n?r.result=i.result:typeof i=="number"&&(r.result=i),r}return Jo(n,[{key:"add",value:function(r){return r instanceof n?this.result+=r.result:typeof r=="number"&&(this.result+=r),this}},{key:"sub",value:function(r){return r instanceof n?this.result-=r.result:typeof r=="number"&&(this.result-=r),this}},{key:"mul",value:function(r){return r instanceof n?this.result*=r.result:typeof r=="number"&&(this.result*=r),this}},{key:"div",value:function(r){return r instanceof n?this.result/=r.result:typeof r=="number"&&(this.result/=r),this}},{key:"equal",value:function(){return this.result}}]),n}(iB),iJ=function(e,n){var i=e==="css"?tJ:nJ;return function(r){return new i(r,n)}},sB=function(e,n){return"".concat([n,e.replace(/([A-Z]+)([A-Z][a-z]+)/g,"$1-$2").replace(/([a-z])([A-Z])/g,"$1-$2")].filter(Boolean).join("-"))};function z_(t){var e=he.useRef();e.current=t;var n=he.useCallback(function(){for(var i,r=arguments.length,a=new Array(r),u=0;u<r;u++)a[u]=arguments[u];return(i=e.current)===null||i===void 0?void 0:i.call.apply(i,[e].concat(a))},[]);return n}function RS(t){var e=he.useRef(!1),n=he.useState(t),i=Xn(n,2),r=i[0],a=i[1];he.useEffect(function(){return e.current=!1,function(){e.current=!0}},[]);function u(l,f){f&&e.current||a(l)}return[r,u]}function oB(t,e,n,i){var r=It({},e[t]);if(i!=null&&i.deprecatedTokens){var a=i.deprecatedTokens;a.forEach(function(l){var f=Xn(l,2),g=f[0],y=f[1];if(r!=null&&r[g]||r!=null&&r[y]){var S;(S=r[y])!==null&&S!==void 0||(r[y]=r==null?void 0:r[g])}})}var u=It(It({},n),r);return Object.keys(u).forEach(function(l){u[l]===e[l]&&delete u[l]}),u}var aB=typeof CSSINJS_STATISTIC<"u",M3=!0;function Kd(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];if(!aB)return Object.assign.apply(Object,[{}].concat(e));M3=!1;var i={};return e.forEach(function(r){if(ai(r)==="object"){var a=Object.keys(r);a.forEach(function(u){Object.defineProperty(i,u,{configurable:!0,enumerable:!0,get:function(){return r[u]}})})}}),M3=!0,i}var lB={};function rJ(){}var sJ=function(e){var n,i=e,r=rJ;return aB&&typeof Proxy<"u"&&(n=new Set,i=new Proxy(e,{get:function(u,l){return M3&&n.add(l),u[l]}}),r=function(u,l){var f;lB[u]={global:Array.from(n),component:It(It({},(f=lB[u])===null||f===void 0?void 0:f.component),l)}}),{token:i,keys:n,flush:r}};function cB(t,e,n){if(typeof n=="function"){var i;return n(Kd(e,(i=e[t])!==null&&i!==void 0?i:{}))}return n??{}}function oJ(t){return t==="js"?{max:Math.max,min:Math.min}:{max:function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return"max(".concat(i.map(function(a){return cr(a)}).join(","),")")},min:function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return"min(".concat(i.map(function(a){return cr(a)}).join(","),")")}}}var aJ=1e3*60*10,lJ=function(){function t(){Ko(this,t),vt(this,"map",new Map),vt(this,"objectIDMap",new WeakMap),vt(this,"nextID",0),vt(this,"lastAccessBeat",new Map),vt(this,"accessBeat",0)}return Jo(t,[{key:"set",value:function(n,i){this.clear();var r=this.getCompositeKey(n);this.map.set(r,i),this.lastAccessBeat.set(r,Date.now())}},{key:"get",value:function(n){var i=this.getCompositeKey(n),r=this.map.get(i);return this.lastAccessBeat.set(i,Date.now()),this.accessBeat+=1,r}},{key:"getCompositeKey",value:function(n){var i=this,r=n.map(function(a){return a&&ai(a)==="object"?"obj_".concat(i.getObjectID(a)):"".concat(ai(a),"_").concat(a)});return r.join("|")}},{key:"getObjectID",value:function(n){if(this.objectIDMap.has(n))return this.objectIDMap.get(n);var i=this.nextID;return this.objectIDMap.set(n,i),this.nextID+=1,i}},{key:"clear",value:function(){var n=this;if(this.accessBeat>1e4){var i=Date.now();this.lastAccessBeat.forEach(function(r,a){i-r>aJ&&(n.map.delete(a),n.lastAccessBeat.delete(a))}),this.accessBeat=0}}}]),t}(),uB=new lJ;function cJ(t,e){return un.useMemo(function(){var n=uB.get(e);if(n)return n;var i=t();return uB.set(e,i),i},e)}var uJ=function(){return{}};function hJ(t){var e=t.useCSP,n=e===void 0?uJ:e,i=t.useToken,r=t.usePrefix,a=t.getResetStyles,u=t.getCommonStyle,l=t.getCompUnitless;function f(b,A,I,D){var L=Array.isArray(b)?b[0]:b;function P(ie){return"".concat(String(L)).concat(ie.slice(0,1).toUpperCase()).concat(ie.slice(1))}var N=(D==null?void 0:D.unitless)||{},B=typeof l=="function"?l(b):{},$=It(It({},B),{},vt({},P("zIndexPopup"),!0));Object.keys(N).forEach(function(ie){$[P(ie)]=N[ie]});var K=It(It({},D),{},{unitless:$,prefixToken:P}),q=y(b,A,I,K),W=g(L,I,K);return function(ie){var Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ie,X=q(ie,Z),se=Xn(X,2),De=se[1],Se=W(Z),Me=Xn(Se,2),Ye=Me[0],ye=Me[1];return[Ye,De,ye]}}function g(b,A,I){var D=I.unitless,L=I.injectStyle,P=L===void 0?!0:L,N=I.prefixToken,B=I.ignore,$=function(W){var ie=W.rootCls,Z=W.cssVar,X=Z===void 0?{}:Z,se=i(),De=se.realToken;return cK({path:[b],prefix:X.prefix,key:X.key,unitless:D,ignore:B,token:De,scope:ie},function(){var Se=cB(b,De,A),Me=oB(b,De,Se,{deprecatedTokens:I==null?void 0:I.deprecatedTokens});return Object.keys(Se).forEach(function(Ye){Me[N(Ye)]=Me[Ye],delete Me[Ye]}),Me}),null},K=function(W){var ie=i(),Z=ie.cssVar;return[function(X){return P&&Z?un.createElement(un.Fragment,null,un.createElement($,{rootCls:W,cssVar:Z,component:b}),X):X},Z==null?void 0:Z.key]};return K}function y(b,A,I){var D=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},L=Array.isArray(b)?b:[b,b],P=Xn(L,1),N=P[0],B=L.join("-");return function($){var K=arguments.length>1&&arguments[1]!==void 0?arguments[1]:$,q=i(),W=q.theme,ie=q.realToken,Z=q.hashId,X=q.token,se=q.cssVar,De=r(),Se=De.rootPrefixCls,Me=De.iconPrefixCls,Ye=n(),ye=se?"css":"js",Ce=cJ(function(){var Xt=new Set;return se&&Object.keys(D.unitless||{}).forEach(function(Ke){Xt.add(dS(Ke,se.prefix)),Xt.add(dS(Ke,sB(N,se.prefix)))}),iJ(ye,Xt)},[ye,N,se==null?void 0:se.prefix]),ge=oJ(ye),Be=ge.max,Ze=ge.min,je={theme:W,token:X,hashId:Z,nonce:function(){return Ye.nonce},clientOnly:D.clientOnly,layer:{name:"antd"},order:D.order||-999};JP(It(It({},je),{},{clientOnly:!1,path:["Shared",Se]}),function(){return typeof a=="function"?a(X):[]});var wt=JP(It(It({},je),{},{path:[B,$,Me]}),function(){if(D.injectStyle===!1)return[];var Xt=sJ(X),Ke=Xt.token,_t=Xt.flush,zt=cB(N,ie,I),Rt=".".concat($),fn=oB(N,ie,zt,{deprecatedTokens:D.deprecatedTokens});se&&ai(zt)==="object"&&Object.keys(zt).forEach(function(Re){zt[Re]="var(".concat(dS(Re,sB(N,se.prefix)),")")});var Mn=Kd(Ke,{componentCls:Rt,prefixCls:$,iconCls:".".concat(Me),antCls:".".concat(Se),calc:Ce,max:Be,min:Ze},se?zt:fn),Bt=A(Mn,{hashId:Z,prefixCls:$,rootPrefixCls:Se,iconPrefixCls:Me});_t(N,fn);var Kn=typeof u=="function"?u(Mn,$,K,D.resetFont):null;return[D.resetStyle===!1?null:Kn,Bt]});return[wt,Z]}}function S(b,A,I){var D=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},L=y(b,A,I,It({resetStyle:!1,order:-998},D)),P=function(B){var $=B.prefixCls,K=B.rootCls,q=K===void 0?$:K;return L($,q),null};return P}return{genStyleHooks:f,genSubStyleComponent:S,genComponentStyleHook:y}}const dJ="5.20.1";function C3(t){return t>=0&&t<=255}function LS(t,e){const{r:n,g:i,b:r,a}=new Ya(t).toRgb();if(a<1)return t;const{r:u,g:l,b:f}=new Ya(e).toRgb();for(let g=.01;g<=1;g+=.01){const y=Math.round((n-u*(1-g))/g),S=Math.round((i-l*(1-g))/g),b=Math.round((r-f*(1-g))/g);if(C3(y)&&C3(S)&&C3(b))return new Ya({r:y,g:S,b,a:Math.round(g*100)/100}).toRgbString()}return new Ya({r:n,g:i,b:r,a:1}).toRgbString()}var fJ=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};function hB(t){const{override:e}=t,n=fJ(t,["override"]),i=Object.assign({},e);Object.keys(O_).forEach(b=>{delete i[b]});const r=Object.assign(Object.assign({},n),i),a=480,u=576,l=768,f=992,g=1200,y=1600;if(r.motion===!1){const b="0s";r.motionDurationFast=b,r.motionDurationMid=b,r.motionDurationSlow=b}return Object.assign(Object.assign(Object.assign({},r),{colorFillContent:r.colorFillSecondary,colorFillContentHover:r.colorFill,colorFillAlter:r.colorFillQuaternary,colorBgContainerDisabled:r.colorFillTertiary,colorBorderBg:r.colorBgContainer,colorSplit:LS(r.colorBorderSecondary,r.colorBgContainer),colorTextPlaceholder:r.colorTextQuaternary,colorTextDisabled:r.colorTextQuaternary,colorTextHeading:r.colorText,colorTextLabel:r.colorTextSecondary,colorTextDescription:r.colorTextTertiary,colorTextLightSolid:r.colorWhite,colorHighlight:r.colorError,colorBgTextHover:r.colorFillSecondary,colorBgTextActive:r.colorFill,colorIcon:r.colorTextTertiary,colorIconHover:r.colorText,colorErrorOutline:LS(r.colorErrorBg,r.colorBgContainer),colorWarningOutline:LS(r.colorWarningBg,r.colorBgContainer),fontSizeIcon:r.fontSizeSM,lineWidthFocus:r.lineWidth*4,lineWidth:r.lineWidth,controlOutlineWidth:r.lineWidth*2,controlInteractiveSize:r.controlHeight/2,controlItemBgHover:r.colorFillTertiary,controlItemBgActive:r.colorPrimaryBg,controlItemBgActiveHover:r.colorPrimaryBgHover,controlItemBgActiveDisabled:r.colorFill,controlTmpOutline:r.colorFillQuaternary,controlOutline:LS(r.colorPrimaryBg,r.colorBgContainer),lineType:r.lineType,borderRadius:r.borderRadius,borderRadiusXS:r.borderRadiusXS,borderRadiusSM:r.borderRadiusSM,borderRadiusLG:r.borderRadiusLG,fontWeightStrong:600,opacityLoading:.65,linkDecoration:"none",linkHoverDecoration:"none",linkFocusDecoration:"none",controlPaddingHorizontal:12,controlPaddingHorizontalSM:8,paddingXXS:r.sizeXXS,paddingXS:r.sizeXS,paddingSM:r.sizeSM,padding:r.size,paddingMD:r.sizeMD,paddingLG:r.sizeLG,paddingXL:r.sizeXL,paddingContentHorizontalLG:r.sizeLG,paddingContentVerticalLG:r.sizeMS,paddingContentHorizontal:r.sizeMS,paddingContentVertical:r.sizeSM,paddingContentHorizontalSM:r.size,paddingContentVerticalSM:r.sizeXS,marginXXS:r.sizeXXS,marginXS:r.sizeXS,marginSM:r.sizeSM,margin:r.size,marginMD:r.sizeMD,marginLG:r.sizeLG,marginXL:r.sizeXL,marginXXL:r.sizeXXL,boxShadow:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowSecondary:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowTertiary:`
      0 1px 2px 0 rgba(0, 0, 0, 0.03),
      0 1px 6px -1px rgba(0, 0, 0, 0.02),
      0 2px 4px 0 rgba(0, 0, 0, 0.02)
    `,screenXS:a,screenXSMin:a,screenXSMax:u-1,screenSM:u,screenSMMin:u,screenSMMax:l-1,screenMD:l,screenMDMin:l,screenMDMax:f-1,screenLG:f,screenLGMin:f,screenLGMax:g-1,screenXL:g,screenXLMin:g,screenXLMax:y-1,screenXXL:y,screenXXLMin:y,boxShadowPopoverArrow:"2px 2px 5px rgba(0, 0, 0, 0.05)",boxShadowCard:`
      0 1px 2px -2px ${new Ya("rgba(0, 0, 0, 0.16)").toRgbString()},
      0 3px 6px 0 ${new Ya("rgba(0, 0, 0, 0.12)").toRgbString()},
      0 5px 12px 4px ${new Ya("rgba(0, 0, 0, 0.09)").toRgbString()}
    `,boxShadowDrawerRight:`
      -6px 0 16px 0 rgba(0, 0, 0, 0.08),
      -3px 0 6px -4px rgba(0, 0, 0, 0.12),
      -9px 0 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerLeft:`
      6px 0 16px 0 rgba(0, 0, 0, 0.08),
      3px 0 6px -4px rgba(0, 0, 0, 0.12),
      9px 0 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerUp:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerDown:`
      0 -6px 16px 0 rgba(0, 0, 0, 0.08),
      0 -3px 6px -4px rgba(0, 0, 0, 0.12),
      0 -9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowTabsOverflowLeft:"inset 10px 0 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowRight:"inset -10px 0 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowTop:"inset 0 10px 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowBottom:"inset 0 -10px 8px -8px rgba(0, 0, 0, 0.08)"}),i)}var dB=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};const fB={lineHeight:!0,lineHeightSM:!0,lineHeightLG:!0,lineHeightHeading1:!0,lineHeightHeading2:!0,lineHeightHeading3:!0,lineHeightHeading4:!0,lineHeightHeading5:!0,opacityLoading:!0,fontWeightStrong:!0,zIndexPopupBase:!0,zIndexBase:!0,opacityImage:!0},pJ={size:!0,sizeSM:!0,sizeLG:!0,sizeMD:!0,sizeXS:!0,sizeXXS:!0,sizeMS:!0,sizeXL:!0,sizeXXL:!0,sizeUnit:!0,sizeStep:!0,motionBase:!0,motionUnit:!0},mJ={screenXS:!0,screenXSMin:!0,screenXSMax:!0,screenSM:!0,screenSMMin:!0,screenSMMax:!0,screenMD:!0,screenMDMin:!0,screenMDMax:!0,screenLG:!0,screenLGMin:!0,screenLGMax:!0,screenXL:!0,screenXLMin:!0,screenXLMax:!0,screenXXL:!0,screenXXLMin:!0},pB=(t,e,n)=>{const i=n.getDerivativeToken(t),{override:r}=e,a=dB(e,["override"]);let u=Object.assign(Object.assign({},i),{override:r});return u=hB(u),a&&Object.entries(a).forEach(l=>{let[f,g]=l;const{theme:y}=g,S=dB(g,["theme"]);let b=S;y&&(b=pB(Object.assign(Object.assign({},u),S),{override:S},y)),u[f]=b}),u};function Jd(){const{token:t,hashed:e,theme:n,override:i,cssVar:r}=un.useContext(tB),a=`${dJ}-${e||""}`,u=n||eB,[l,f,g]=OY(u,[O_,t],{salt:a,override:i,getComputedToken:pB,formatToken:hB,cssVar:r&&{prefix:r.prefix,key:r.key,unitless:fB,ignore:pJ,preserve:mJ}});return[u,g,e?f:"",l,r]}const gJ=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return{boxSizing:"border-box",margin:0,padding:0,color:t.colorText,fontSize:t.fontSize,lineHeight:t.lineHeight,listStyle:"none",fontFamily:e?"inherit":t.fontFamily}},vJ=()=>({display:"inline-flex",alignItems:"center",color:"inherit",fontStyle:"normal",lineHeight:0,textAlign:"center",textTransform:"none",verticalAlign:"-0.125em",textRendering:"optimizeLegibility","-webkit-font-smoothing":"antialiased","-moz-osx-font-smoothing":"grayscale","> *":{lineHeight:1},svg:{display:"inline-block"}}),yJ=()=>({"&::before":{display:"table",content:'""'},"&::after":{display:"table",clear:"both",content:'""'}}),_J=t=>({a:{color:t.colorLink,textDecoration:t.linkDecoration,backgroundColor:"transparent",outline:"none",cursor:"pointer",transition:`color ${t.motionDurationSlow}`,"-webkit-text-decoration-skip":"objects","&:hover":{color:t.colorLinkHover},"&:active":{color:t.colorLinkActive},"&:active, &:hover":{textDecoration:t.linkHoverDecoration,outline:0},"&:focus":{textDecoration:t.linkFocusDecoration,outline:0},"&[disabled]":{color:t.colorTextDisabled,cursor:"not-allowed"}}}),xJ=(t,e,n,i)=>{const r=`[class^="${e}"], [class*=" ${e}"]`,a=n?`.${n}`:r,u={boxSizing:"border-box","&::before, &::after":{boxSizing:"border-box"}};let l={};return i!==!1&&(l={fontFamily:t.fontFamily,fontSize:t.fontSize}),{[a]:Object.assign(Object.assign(Object.assign({},l),u),{[r]:u})}},bJ=t=>({outline:`${cr(t.lineWidthFocus)} solid ${t.colorPrimaryBorder}`,outlineOffset:1,transition:"outline-offset 0s, outline 0s"}),mB=t=>({"&:focus-visible":Object.assign({},bJ(t))}),gB=(t,e)=>{const[n,i]=Jd();return JP({token:i,hashId:"",path:["ant-design-icons",t],nonce:()=>e==null?void 0:e.nonce,layer:{name:"antd"}},()=>[{[`.${t}`]:Object.assign(Object.assign({},vJ()),{[`.${t} .${t}-icon`]:{display:"block"}})}])},{genStyleHooks:T3,genComponentStyleHook:wJ,genSubStyleComponent:vB}=hJ({usePrefix:()=>{const{getPrefixCls:t,iconPrefixCls:e}=he.useContext(ms);return{rootPrefixCls:t(),iconPrefixCls:e}},useToken:()=>{const[t,e,n,i,r]=Jd();return{theme:t,realToken:e,hashId:n,token:i,cssVar:r}},useCSP:()=>{const{csp:t,iconPrefixCls:e}=he.useContext(ms);return gB(e,t),t??{}},getResetStyles:t=>[{"&":_J(t)}],getCommonStyle:xJ,getCompUnitless:()=>fB}),SJ=Object.assign({},Bb),{useId:yB}=SJ,EJ=typeof yB>"u"?()=>"":yB;function MJ(t,e,n){var i;const r=t||{},a=r.inherit===!1||!e?Object.assign(Object.assign({},w3),{hashed:(i=e==null?void 0:e.hashed)!==null&&i!==void 0?i:w3.hashed,cssVar:e==null?void 0:e.cssVar}):e,u=EJ();return PP(()=>{var l,f;if(!t)return e;const g=Object.assign({},a.components);Object.keys(t.components||{}).forEach(b=>{g[b]=Object.assign(Object.assign({},g[b]),t.components[b])});const y=`css-var-${u.replace(/:/g,"")}`,S=((l=r.cssVar)!==null&&l!==void 0?l:a.cssVar)&&Object.assign(Object.assign(Object.assign({prefix:n==null?void 0:n.prefixCls},typeof a.cssVar=="object"?a.cssVar:{}),typeof r.cssVar=="object"?r.cssVar:{}),{key:typeof r.cssVar=="object"&&((f=r.cssVar)===null||f===void 0?void 0:f.key)||y});return Object.assign(Object.assign(Object.assign({},a),r),{token:Object.assign(Object.assign({},a.token),r.token),components:g,cssVar:S})},[r,a],(l,f)=>l.some((g,y)=>{const S=f[y];return!NP(g,S,!0)}))}var CJ=["children"],_B=he.createContext({});function TJ(t){var e=t.children,n=Xd(t,CJ);return he.createElement(_B.Provider,{value:n},e)}var AJ=function(t){vv(n,t);var e=yv(n);function n(){return Ko(this,n),e.apply(this,arguments)}return Jo(n,[{key:"render",value:function(){return this.props.children}}]),n}(he.Component);function PJ(t){var e=he.useReducer(function(l){return l+1},0),n=Xn(e,2),i=n[1],r=he.useRef(t),a=z_(function(){return r.current}),u=z_(function(l){r.current=typeof l=="function"?l(r.current):l,i()});return[a,u]}var Qd="none",kS="appear",DS="enter",OS="leave",xB="none",Ec="prepare",Cv="start",Tv="active",A3="end",bB="prepared";function wB(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit".concat(t)]="webkit".concat(e),n["Moz".concat(t)]="moz".concat(e),n["ms".concat(t)]="MS".concat(e),n["O".concat(t)]="o".concat(e.toLowerCase()),n}function IJ(t,e){var n={animationend:wB("Animation","AnimationEnd"),transitionend:wB("Transition","TransitionEnd")};return t&&("AnimationEvent"in e||delete n.animationend.animation,"TransitionEvent"in e||delete n.transitionend.transition),n}var RJ=IJ(_a(),typeof window<"u"?window:{}),SB={};if(_a()){var LJ=document.createElement("div");SB=LJ.style}var FS={};function EB(t){if(FS[t])return FS[t];var e=RJ[t];if(e)for(var n=Object.keys(e),i=n.length,r=0;r<i;r+=1){var a=n[r];if(Object.prototype.hasOwnProperty.call(e,a)&&a in SB)return FS[t]=e[a],FS[t]}return""}var MB=EB("animationend"),CB=EB("transitionend"),TB=!!(MB&&CB),AB=MB||"animationend",PB=CB||"transitionend";function IB(t,e){if(!t)return null;if(ai(t)==="object"){var n=e.replace(/-\w/g,function(i){return i[1].toUpperCase()});return t[n]}return"".concat(t,"-").concat(e)}const kJ=function(t){var e=he.useRef();function n(r){r&&(r.removeEventListener(PB,t),r.removeEventListener(AB,t))}function i(r){e.current&&e.current!==r&&n(e.current),r&&r!==e.current&&(r.addEventListener(PB,t),r.addEventListener(AB,t),e.current=r)}return he.useEffect(function(){return function(){n(e.current)}},[]),[i,n]};var RB=_a()?he.useLayoutEffect:he.useEffect;const DJ=function(){var t=he.useRef(null);function e(){Mp.cancel(t.current)}function n(i){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2;e();var a=Mp(function(){r<=1?i({isCanceled:function(){return a!==t.current}}):n(i,r-1)});t.current=a}return he.useEffect(function(){return function(){e()}},[]),[n,e]};var OJ=[Ec,Cv,Tv,A3],FJ=[Ec,bB],LB=!1,zJ=!0;function kB(t){return t===Tv||t===A3}const NJ=function(t,e,n){var i=RS(xB),r=Xn(i,2),a=r[0],u=r[1],l=DJ(),f=Xn(l,2),g=f[0],y=f[1];function S(){u(Ec,!0)}var b=e?FJ:OJ;return RB(function(){if(a!==xB&&a!==A3){var A=b.indexOf(a),I=b[A+1],D=n(a);D===LB?u(I,!0):I&&g(function(L){function P(){L.isCanceled()||u(I,!0)}D===!0?P():Promise.resolve(D).then(P)})}},[t,a]),he.useEffect(function(){return function(){y()}},[]),[S,a]};function BJ(t,e,n,i){var r=i.motionEnter,a=r===void 0?!0:r,u=i.motionAppear,l=u===void 0?!0:u,f=i.motionLeave,g=f===void 0?!0:f,y=i.motionDeadline,S=i.motionLeaveImmediately,b=i.onAppearPrepare,A=i.onEnterPrepare,I=i.onLeavePrepare,D=i.onAppearStart,L=i.onEnterStart,P=i.onLeaveStart,N=i.onAppearActive,B=i.onEnterActive,$=i.onLeaveActive,K=i.onAppearEnd,q=i.onEnterEnd,W=i.onLeaveEnd,ie=i.onVisibleChanged,Z=RS(),X=Xn(Z,2),se=X[0],De=X[1],Se=PJ(Qd),Me=Xn(Se,2),Ye=Me[0],ye=Me[1],Ce=RS(null),ge=Xn(Ce,2),Be=ge[0],Ze=ge[1],je=Ye(),wt=he.useRef(!1),Xt=he.useRef(null);function Ke(){return n()}var _t=he.useRef(!1);function zt(){ye(Qd),Ze(null,!0)}var Rt=z_(function(ve){var re=Ye();if(re!==Qd){var Xe=Ke();if(!(ve&&!ve.deadline&&ve.target!==Xe)){var Ge=_t.current,st;re===kS&&Ge?st=K==null?void 0:K(Xe,ve):re===DS&&Ge?st=q==null?void 0:q(Xe,ve):re===OS&&Ge&&(st=W==null?void 0:W(Xe,ve)),Ge&&st!==!1&&zt()}}}),fn=kJ(Rt),Mn=Xn(fn,1),Bt=Mn[0],Kn=function(re){switch(re){case kS:return vt(vt(vt({},Ec,b),Cv,D),Tv,N);case DS:return vt(vt(vt({},Ec,A),Cv,L),Tv,B);case OS:return vt(vt(vt({},Ec,I),Cv,P),Tv,$);default:return{}}},Re=he.useMemo(function(){return Kn(je)},[je]),Jn=NJ(je,!t,function(ve){if(ve===Ec){var re=Re[Ec];return re?re(Ke()):LB}if(Ue in Re){var Xe;Ze(((Xe=Re[Ue])===null||Xe===void 0?void 0:Xe.call(Re,Ke(),null))||null)}return Ue===Tv&&je!==Qd&&(Bt(Ke()),y>0&&(clearTimeout(Xt.current),Xt.current=setTimeout(function(){Rt({deadline:!0})},y))),Ue===bB&&zt(),zJ}),Ln=Xn(Jn,2),Cn=Ln[0],Ue=Ln[1],xt=kB(Ue);_t.current=xt,RB(function(){De(e);var ve=wt.current;wt.current=!0;var re;!ve&&e&&l&&(re=kS),ve&&e&&a&&(re=DS),(ve&&!e&&g||!ve&&S&&!e&&g)&&(re=OS);var Xe=Kn(re);re&&(t||Xe[Ec])?(ye(re),Cn()):ye(Qd)},[e]),he.useEffect(function(){(je===kS&&!l||je===DS&&!a||je===OS&&!g)&&ye(Qd)},[l,a,g]),he.useEffect(function(){return function(){wt.current=!1,clearTimeout(Xt.current)}},[]);var Pt=he.useRef(!1);he.useEffect(function(){se&&(Pt.current=!0),se!==void 0&&je===Qd&&((Pt.current||se)&&(ie==null||ie(se)),Pt.current=!0)},[se,je]);var mt=Be;return Re[Ec]&&Ue===Cv&&(mt=It({transition:"none"},mt)),[je,Ue,mt,se??e]}function UJ(t){var e=t;ai(t)==="object"&&(e=t.transitionSupport);function n(r,a){return!!(r.motionName&&e&&a!==!1)}var i=he.forwardRef(function(r,a){var u=r.visible,l=u===void 0?!0:u,f=r.removeOnLeave,g=f===void 0?!0:f,y=r.forceRender,S=r.children,b=r.motionName,A=r.leavedClassName,I=r.eventProps,D=he.useContext(_B),L=D.motion,P=n(r,L),N=he.useRef(),B=he.useRef();function $(){try{return N.current instanceof HTMLElement?N.current:rY(B.current)}catch{return null}}var K=BJ(P,l,$,r),q=Xn(K,4),W=q[0],ie=q[1],Z=q[2],X=q[3],se=he.useRef(X);X&&(se.current=!0);var De=he.useCallback(function(Be){N.current=Be,J5(a,Be)},[a]),Se,Me=It(It({},I),{},{visible:l});if(!S)Se=null;else if(W===Qd)X?Se=S(It({},Me),De):!g&&se.current&&A?Se=S(It(It({},Me),{},{className:A}),De):y||!g&&!A?Se=S(It(It({},Me),{},{style:{display:"none"}}),De):Se=null;else{var Ye;ie===Ec?Ye="prepare":kB(ie)?Ye="active":ie===Cv&&(Ye="start");var ye=IB(b,"".concat(W,"-").concat(Ye));Se=S(It(It({},Me),{},{className:pi(IB(b,W),vt(vt({},ye,ye&&Ye),b,typeof b=="string")),style:Z}),De)}if(he.isValidElement(Se)&&IP(Se)){var Ce=Se,ge=Ce.ref;ge||(Se=he.cloneElement(Se,{ref:De}))}return he.createElement(AJ,{ref:B},Se)});return i.displayName="CSSMotion",i}const N_=UJ(TB);var P3="add",I3="keep",R3="remove",L3="removed";function VJ(t){var e;return t&&ai(t)==="object"&&"key"in t?e=t:e={key:t},It(It({},e),{},{key:String(e.key)})}function k3(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return t.map(VJ)}function $J(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=[],i=0,r=e.length,a=k3(t),u=k3(e);a.forEach(function(g){for(var y=!1,S=i;S<r;S+=1){var b=u[S];if(b.key===g.key){i<S&&(n=n.concat(u.slice(i,S).map(function(A){return It(It({},A),{},{status:P3})})),i=S),n.push(It(It({},b),{},{status:I3})),i+=1,y=!0;break}}y||n.push(It(It({},g),{},{status:R3}))}),i<r&&(n=n.concat(u.slice(i).map(function(g){return It(It({},g),{},{status:P3})})));var l={};n.forEach(function(g){var y=g.key;l[y]=(l[y]||0)+1});var f=Object.keys(l).filter(function(g){return l[g]>1});return f.forEach(function(g){n=n.filter(function(y){var S=y.key,b=y.status;return S!==g||b!==R3}),n.forEach(function(y){y.key===g&&(y.status=I3)})}),n}var HJ=["component","children","onVisibleChanged","onAllRemoved"],GJ=["status"],WJ=["eventProps","visible","children","motionName","motionAppear","motionEnter","motionLeave","motionLeaveImmediately","motionDeadline","removeOnLeave","leavedClassName","onAppearPrepare","onAppearStart","onAppearActive","onAppearEnd","onEnterStart","onEnterActive","onEnterEnd","onLeaveStart","onLeaveActive","onLeaveEnd"];function jJ(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:N_,n=function(i){vv(a,i);var r=yv(a);function a(){var u;Ko(this,a);for(var l=arguments.length,f=new Array(l),g=0;g<l;g++)f[g]=arguments[g];return u=r.call.apply(r,[this].concat(f)),vt(bi(u),"state",{keyEntities:[]}),vt(bi(u),"removeKey",function(y){var S=u.state.keyEntities,b=S.map(function(A){return A.key!==y?A:It(It({},A),{},{status:L3})});return u.setState({keyEntities:b}),b.filter(function(A){var I=A.status;return I!==L3}).length}),u}return Jo(a,[{key:"render",value:function(){var l=this,f=this.state.keyEntities,g=this.props,y=g.component,S=g.children,b=g.onVisibleChanged,A=g.onAllRemoved,I=Xd(g,HJ),D=y||he.Fragment,L={};return WJ.forEach(function(P){L[P]=I[P],delete I[P]}),delete I.keys,he.createElement(D,I,f.map(function(P,N){var B=P.status,$=Xd(P,GJ),K=B===P3||B===I3;return he.createElement(e,Kr({},L,{key:$.key,visible:K,eventProps:$,onVisibleChanged:function(W){if(b==null||b(W,{key:$.key}),!W){var ie=l.removeKey($.key);ie===0&&A&&A()}}}),function(q,W){return S(It(It({},q),{},{index:N}),W)})}))}}],[{key:"getDerivedStateFromProps",value:function(l,f){var g=l.keys,y=f.keyEntities,S=k3(g),b=$J(y,S);return{keyEntities:b.filter(function(A){var I=y.find(function(D){var L=D.key;return A.key===L});return!(I&&I.status===L3&&A.status===R3)})}}}]),a}(he.Component);return vt(n,"defaultProps",{component:"div"}),n}jJ(TB);function qJ(t){const{children:e}=t,[,n]=Jd(),{motion:i}=n,r=he.useRef(!1);return r.current=r.current||i===!1,r.current?he.createElement(TJ,{motion:i},e):e}const XJ=()=>null;var ZJ=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};const YJ=["getTargetContainer","getPopupContainer","renderEmpty","input","pagination","form","select","button"];let zS,DB,OB,FB;function NS(){return zS||PS}function KJ(){return DB||S3}function JJ(t){return Object.keys(t).some(e=>e.endsWith("Color"))}const QJ=t=>{const{prefixCls:e,iconPrefixCls:n,theme:i,holderRender:r}=t;e!==void 0&&(zS=e),n!==void 0&&(DB=n),"holderRender"in t&&(FB=r),i&&(JJ(i)?KK(NS(),i):OB=i)},eQ=()=>({getPrefixCls:(t,e)=>e||(t?`${NS()}-${t}`:NS()),getIconPrefixCls:KJ,getRootPrefixCls:()=>zS||NS(),getTheme:()=>OB,holderRender:FB}),tQ=t=>{const{children:e,csp:n,autoInsertSpaceInButton:i,alert:r,anchor:a,form:u,locale:l,componentSize:f,direction:g,space:y,virtual:S,dropdownMatchSelectWidth:b,popupMatchSelectWidth:A,popupOverflow:I,legacyLocale:D,parentContext:L,iconPrefixCls:P,theme:N,componentDisabled:B,segmented:$,statistic:K,spin:q,calendar:W,carousel:ie,cascader:Z,collapse:X,typography:se,checkbox:De,descriptions:Se,divider:Me,drawer:Ye,skeleton:ye,steps:Ce,image:ge,layout:Be,list:Ze,mentions:je,modal:wt,progress:Xt,result:Ke,slider:_t,breadcrumb:zt,menu:Rt,pagination:fn,input:Mn,textArea:Bt,empty:Kn,badge:Re,radio:Jn,rate:Ln,switch:Cn,transfer:Ue,avatar:xt,message:Pt,tag:mt,table:ve,card:re,tabs:Xe,timeline:Ge,timePicker:st,upload:ft,notification:Ht,tree:$t,colorPicker:it,datePicker:On,rangePicker:Nt,flex:on,wave:Wn,dropdown:yt,warning:Tt,tour:Vt,floatButtonGroup:kn,variant:ii,inputNumber:Ne,treeSelect:Gt}=t,Et=he.useCallback((Ie,ut)=>{const{prefixCls:bt}=t;if(ut)return ut;const ct=bt||L.getPrefixCls("");return Ie?`${ct}-${Ie}`:ct},[L.getPrefixCls,t.prefixCls]),Ct=P||L.iconPrefixCls||S3,Zt=n||L.csp;gB(Ct,Zt);const xe=MJ(N,L.theme,{prefixCls:Et("")}),te={csp:Zt,autoInsertSpaceInButton:i,alert:r,anchor:a,locale:l||D,direction:g,space:y,virtual:S,popupMatchSelectWidth:A??b,popupOverflow:I,getPrefixCls:Et,iconPrefixCls:Ct,theme:xe,segmented:$,statistic:K,spin:q,calendar:W,carousel:ie,cascader:Z,collapse:X,typography:se,checkbox:De,descriptions:Se,divider:Me,drawer:Ye,skeleton:ye,steps:Ce,image:ge,input:Mn,textArea:Bt,layout:Be,list:Ze,mentions:je,modal:wt,progress:Xt,result:Ke,slider:_t,breadcrumb:zt,menu:Rt,pagination:fn,empty:Kn,badge:Re,radio:Jn,rate:Ln,switch:Cn,transfer:Ue,avatar:xt,message:Pt,tag:mt,table:ve,card:re,tabs:Xe,timeline:Ge,timePicker:st,upload:ft,notification:Ht,tree:$t,colorPicker:it,datePicker:On,rangePicker:Nt,flex:on,wave:Wn,dropdown:yt,warning:Tt,tour:Vt,floatButtonGroup:kn,variant:ii,inputNumber:Ne,treeSelect:Gt},ne=Object.assign({},L);Object.keys(te).forEach(Ie=>{te[Ie]!==void 0&&(ne[Ie]=te[Ie])}),YJ.forEach(Ie=>{const ut=t[Ie];ut&&(ne[Ie]=ut)}),typeof i<"u"&&(ne.button=Object.assign({autoInsertSpace:i},ne.button));const de=PP(()=>ne,ne,(Ie,ut)=>{const bt=Object.keys(Ie),ct=Object.keys(ut);return bt.length!==ct.length||bt.some(Wt=>Ie[Wt]!==ut[Wt])}),we=he.useMemo(()=>({prefixCls:Ct,csp:Zt}),[Ct,Zt]);let Fe=he.createElement(he.Fragment,null,he.createElement(XJ,{dropdownMatchSelectWidth:b}),e);const He=he.useMemo(()=>{var Ie,ut,bt,ct;return Sv(((Ie=Pp.Form)===null||Ie===void 0?void 0:Ie.defaultValidateMessages)||{},((bt=(ut=de.locale)===null||ut===void 0?void 0:ut.Form)===null||bt===void 0?void 0:bt.defaultValidateMessages)||{},((ct=de.form)===null||ct===void 0?void 0:ct.validateMessages)||{},(u==null?void 0:u.validateMessages)||{})},[de,u==null?void 0:u.validateMessages]);Object.keys(He).length>0&&(Fe=he.createElement(mK.Provider,{value:He},Fe)),l&&(Fe=he.createElement(bK,{locale:l,_ANT_MARK__:xK},Fe)),Fe=he.createElement(QP.Provider,{value:we},Fe),f&&(Fe=he.createElement(JK,{size:f},Fe)),Fe=he.createElement(qJ,null,Fe);const nt=he.useMemo(()=>{const Ie=xe||{},{algorithm:ut,token:bt,components:ct,cssVar:Wt}=Ie,bn=ZJ(Ie,["algorithm","token","components","cssVar"]),Sn=ut&&(!Array.isArray(ut)||ut.length>0)?$P(ut):eB,Bn={};Object.entries(ct||{}).forEach(Vn=>{let[Di,qi]=Vn;const me=Object.assign({},qi);"algorithm"in me&&(me.algorithm===!0?me.theme=Sn:(Array.isArray(me.algorithm)||typeof me.algorithm=="function")&&(me.theme=$P(me.algorithm)),delete me.algorithm),Bn[Di]=me});const ui=Object.assign(Object.assign({},O_),bt);return Object.assign(Object.assign({},bn),{theme:Sn,token:ui,components:Bn,override:Object.assign({override:ui},Bn),cssVar:Wt})},[xe]);return N&&(Fe=he.createElement(tB.Provider,{value:nt},Fe)),de.warning&&(Fe=he.createElement(pK.Provider,{value:de.warning},Fe)),B!==void 0&&(Fe=he.createElement(nB,{disabled:B},Fe)),he.createElement(ms.Provider,{value:de},Fe)},ef=t=>{const e=he.useContext(ms),n=he.useContext(e3);return he.createElement(tQ,Object.assign({parentContext:e,legacyLocale:n},t))};ef.ConfigContext=ms,ef.SizeContext=Mv,ef.config=QJ,ef.useConfig=QK,Object.defineProperty(ef,"SizeContext",{get:()=>Mv});var nQ={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm193.5 301.7l-210.6 292a31.8 31.8 0 01-51.7 0L318.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.2 0 19.9 4.9 25.9 13.3l71.2 98.8 157.2-218c6-8.3 15.6-13.3 25.9-13.3H699c6.5 0 10.3 7.4 6.5 12.7z"}}]},name:"check-circle",theme:"filled"};function zB(t){var e;return t==null||(e=t.getRootNode)===null||e===void 0?void 0:e.call(t)}function iQ(t){return zB(t)instanceof ShadowRoot}function rQ(t){return iQ(t)?zB(t):null}function sQ(t){return t.replace(/-(.)/g,function(e,n){return n.toUpperCase()})}function oQ(t,e){Va(t,"[@ant-design/icons] ".concat(e))}function NB(t){return ai(t)==="object"&&typeof t.name=="string"&&typeof t.theme=="string"&&(ai(t.icon)==="object"||typeof t.icon=="function")}function BB(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.keys(t).reduce(function(e,n){var i=t[n];switch(n){case"class":e.className=i,delete e.class;break;default:delete e[n],e[sQ(n)]=i}return e},{})}function D3(t,e,n){return n?un.createElement(t.tag,It(It({key:e},BB(t.attrs)),n),(t.children||[]).map(function(i,r){return D3(i,"".concat(e,"-").concat(t.tag,"-").concat(r))})):un.createElement(t.tag,It({key:e},BB(t.attrs)),(t.children||[]).map(function(i,r){return D3(i,"".concat(e,"-").concat(t.tag,"-").concat(r))}))}function UB(t){return D_(t)[0]}function VB(t){return t?Array.isArray(t)?t:[t]:[]}var aQ=`
.anticon {
  display: inline-flex;
  align-items: center;
  color: inherit;
  font-style: normal;
  line-height: 0;
  text-align: center;
  text-transform: none;
  vertical-align: -0.125em;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

.anticon > * {
  line-height: 1;
}

.anticon svg {
  display: inline-block;
}

.anticon::before {
  display: none;
}

.anticon .anticon-icon {
  display: block;
}

.anticon[tabindex] {
  cursor: pointer;
}

.anticon-spin::before,
.anticon-spin {
  display: inline-block;
  -webkit-animation: loadingCircle 1s infinite linear;
  animation: loadingCircle 1s infinite linear;
}

@-webkit-keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}

@keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}
`,lQ=function(e){var n=he.useContext(QP),i=n.csp,r=n.prefixCls,a=aQ;r&&(a=a.replace(/anticon/g,r)),he.useEffect(function(){var u=e.current,l=rQ(u);yh(a,"@ant-design-icons",{prepend:!0,csp:i,attachTo:l})},[])},cQ=["icon","className","onClick","style","primaryColor","secondaryColor"],B_={primaryColor:"#333",secondaryColor:"#E6E6E6",calculated:!1};function uQ(t){var e=t.primaryColor,n=t.secondaryColor;B_.primaryColor=e,B_.secondaryColor=n||UB(e),B_.calculated=!!n}function hQ(){return It({},B_)}var Av=function(e){var n=e.icon,i=e.className,r=e.onClick,a=e.style,u=e.primaryColor,l=e.secondaryColor,f=Xd(e,cQ),g=he.useRef(),y=B_;if(u&&(y={primaryColor:u,secondaryColor:l||UB(u)}),lQ(g),oQ(NB(n),"icon should be icon definiton, but got ".concat(n)),!NB(n))return null;var S=n;return S&&typeof S.icon=="function"&&(S=It(It({},S),{},{icon:S.icon(y.primaryColor,y.secondaryColor)})),D3(S.icon,"svg-".concat(S.name),It(It({className:i,onClick:r,style:a,"data-icon":S.name,width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true"},f),{},{ref:g}))};Av.displayName="IconReact",Av.getTwoToneColors=hQ,Av.setTwoToneColors=uQ;function $B(t){var e=VB(t),n=Xn(e,2),i=n[0],r=n[1];return Av.setTwoToneColors({primaryColor:i,secondaryColor:r})}function dQ(){var t=Av.getTwoToneColors();return t.calculated?[t.primaryColor,t.secondaryColor]:t.primaryColor}var fQ=["className","icon","spin","rotate","tabIndex","onClick","twoToneColor"];$B(TS.primary);var lu=he.forwardRef(function(t,e){var n=t.className,i=t.icon,r=t.spin,a=t.rotate,u=t.tabIndex,l=t.onClick,f=t.twoToneColor,g=Xd(t,fQ),y=he.useContext(QP),S=y.prefixCls,b=S===void 0?"anticon":S,A=y.rootClassName,I=pi(A,b,vt(vt({},"".concat(b,"-").concat(i.name),!!i.name),"".concat(b,"-spin"),!!r||i.name==="loading"),n),D=u;D===void 0&&l&&(D=-1);var L=a?{msTransform:"rotate(".concat(a,"deg)"),transform:"rotate(".concat(a,"deg)")}:void 0,P=VB(f),N=Xn(P,2),B=N[0],$=N[1];return he.createElement("span",Kr({role:"img","aria-label":i.name},g,{ref:e,tabIndex:D,onClick:l,className:I}),he.createElement(Av,{icon:i,primaryColor:B,secondaryColor:$,style:L}))});lu.displayName="AntdIcon",lu.getTwoToneColor=dQ,lu.setTwoToneColor=$B;var pQ=function(e,n){return he.createElement(lu,Kr({},e,{ref:n,icon:nQ}))},mQ=he.forwardRef(pQ),gQ={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64zm127.98 274.82h-.04l-.08.06L512 466.75 384.14 338.88c-.04-.05-.06-.06-.08-.06a.12.12 0 00-.07 0c-.03 0-.05.01-.09.05l-45.02 45.02a.2.2 0 00-.05.09.12.12 0 000 .07v.02a.27.27 0 00.06.06L466.75 512 338.88 639.86c-.05.04-.06.06-.06.08a.12.12 0 000 .07c0 .03.01.05.05.09l45.02 45.02a.2.2 0 00.09.05.12.12 0 00.07 0c.02 0 .04-.01.08-.05L512 557.25l127.86 127.87c.04.04.06.05.08.05a.12.12 0 00.07 0c.03 0 .05-.01.09-.05l45.02-45.02a.2.2 0 00.05-.09.12.12 0 000-.07v-.02a.27.27 0 00-.05-.06L557.25 512l127.87-127.86c.04-.04.05-.06.05-.08a.12.12 0 000-.07c0-.03-.01-.05-.05-.09l-45.02-45.02a.2.2 0 00-.09-.05.12.12 0 00-.07 0z"}}]},name:"close-circle",theme:"filled"},vQ=function(e,n){return he.createElement(lu,Kr({},e,{ref:n,icon:gQ}))},yQ=he.forwardRef(vQ),_Q={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M799.86 166.31c.02 0 .04.02.08.06l57.69 57.7c.04.03.05.05.06.08a.12.12 0 010 .06c0 .03-.02.05-.06.09L569.93 512l287.7 287.7c.04.04.05.06.06.09a.12.12 0 010 .07c0 .02-.02.04-.06.08l-57.7 57.69c-.03.04-.05.05-.07.06a.12.12 0 01-.07 0c-.03 0-.05-.02-.09-.06L512 569.93l-287.7 287.7c-.04.04-.06.05-.09.06a.12.12 0 01-.07 0c-.02 0-.04-.02-.08-.06l-57.69-57.7c-.04-.03-.05-.05-.06-.07a.12.12 0 010-.07c0-.03.02-.05.06-.09L454.07 512l-287.7-287.7c-.04-.04-.05-.06-.06-.09a.12.12 0 010-.07c0-.02.02-.04.06-.08l57.7-57.69c.03-.04.05-.05.07-.06a.12.12 0 01.07 0c.03 0 .05.02.09.06L512 454.07l287.7-287.7c.04-.04.06-.05.09-.06a.12.12 0 01.07 0z"}}]},name:"close",theme:"outlined"},xQ=function(e,n){return he.createElement(lu,Kr({},e,{ref:n,icon:_Q}))},O3=he.forwardRef(xQ),bQ={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm-32 232c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V296zm32 440a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"}}]},name:"exclamation-circle",theme:"filled"},wQ=function(e,n){return he.createElement(lu,Kr({},e,{ref:n,icon:bQ}))},SQ=he.forwardRef(wQ),EQ={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm32 664c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V456c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272zm-32-344a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"}}]},name:"info-circle",theme:"filled"},MQ=function(e,n){return he.createElement(lu,Kr({},e,{ref:n,icon:EQ}))},CQ=he.forwardRef(MQ),TQ=`accept acceptCharset accessKey action allowFullScreen allowTransparency
    alt async autoComplete autoFocus autoPlay capture cellPadding cellSpacing challenge
    charSet checked classID className colSpan cols content contentEditable contextMenu
    controls coords crossOrigin data dateTime default defer dir disabled download draggable
    encType form formAction formEncType formMethod formNoValidate formTarget frameBorder
    headers height hidden high href hrefLang htmlFor httpEquiv icon id inputMode integrity
    is keyParams keyType kind label lang list loop low manifest marginHeight marginWidth max maxLength media
    mediaGroup method min minLength multiple muted name noValidate nonce open
    optimum pattern placeholder poster preload radioGroup readOnly rel required
    reversed role rowSpan rows sandbox scope scoped scrolling seamless selected
    shape size sizes span spellCheck src srcDoc srcLang srcSet start step style
    summary tabIndex target title type useMap value width wmode wrap`,AQ=`onCopy onCut onPaste onCompositionEnd onCompositionStart onCompositionUpdate onKeyDown
    onKeyPress onKeyUp onFocus onBlur onChange onInput onSubmit onClick onContextMenu onDoubleClick
    onDrag onDragEnd onDragEnter onDragExit onDragLeave onDragOver onDragStart onDrop onMouseDown
    onMouseEnter onMouseLeave onMouseMove onMouseOut onMouseOver onMouseUp onSelect onTouchCancel
    onTouchEnd onTouchMove onTouchStart onScroll onWheel onAbort onCanPlay onCanPlayThrough
    onDurationChange onEmptied onEncrypted onEnded onError onLoadedData onLoadedMetadata
    onLoadStart onPause onPlay onPlaying onProgress onRateChange onSeeked onSeeking onStalled onSuspend onTimeUpdate onVolumeChange onWaiting onLoad onError`,PQ="".concat(TQ," ").concat(AQ).split(/[\s\n]+/),IQ="aria-",RQ="data-";function HB(t,e){return t.indexOf(e)===0}function F3(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n;e===!1?n={aria:!0,data:!0,attr:!0}:e===!0?n={aria:!0}:n=It({},e);var i={};return Object.keys(t).forEach(function(r){(n.aria&&(r==="role"||HB(r,IQ))||n.data&&HB(r,RQ)||n.attr&&PQ.includes(r))&&(i[r]=t[r])}),i}function LQ(t){return t&&un.isValidElement(t)&&t.type===un.Fragment}const kQ=(t,e,n)=>un.isValidElement(t)?un.cloneElement(t,typeof n=="function"?n(t.props||{}):n):e;function GB(t,e){return kQ(t,t,e)}const WB=t=>{const[,,,,e]=Jd();return e?`${t}-css-var`:""};var jB={TAB:9,ESC:27},DQ={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M988 548c-19.9 0-36-16.1-36-36 0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 00-94.3-139.9 437.71 437.71 0 00-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.3C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3.1 19.9-16 36-35.9 36z"}}]},name:"loading",theme:"outlined"},OQ=function(e,n){return he.createElement(lu,Kr({},e,{ref:n,icon:DQ}))},FQ=he.forwardRef(OQ);const qB=un.createContext(void 0),Rp=100,zQ=Rp*10,XB={Modal:Rp,Drawer:Rp,Popover:Rp,Popconfirm:Rp,Tooltip:Rp,Tour:Rp},NQ={SelectLike:50,Dropdown:50,DatePicker:50,Menu:50,ImagePreview:1};function BQ(t){return t in XB}function UQ(t,e){const[,n]=Jd(),i=un.useContext(qB),r=BQ(t);let a;if(e!==void 0)a=[e,e];else{let u=i??0;r?u+=(i?0:n.zIndexPopupBase)+XB[t]:u+=NQ[t],a=[i===void 0?e:u,u]}return a}function VQ(){const[t,e]=he.useState([]),n=he.useCallback(i=>(e(r=>[].concat(Gn(r),[i])),()=>{e(r=>r.filter(a=>a!==i))}),[]);return[t,n]}function ea(){ea=function(){return e};var t,e={},n=Object.prototype,i=n.hasOwnProperty,r=Object.defineProperty||function(ye,Ce,ge){ye[Ce]=ge.value},a=typeof Symbol=="function"?Symbol:{},u=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",f=a.toStringTag||"@@toStringTag";function g(ye,Ce,ge){return Object.defineProperty(ye,Ce,{value:ge,enumerable:!0,configurable:!0,writable:!0}),ye[Ce]}try{g({},"")}catch{g=function(ge,Be,Ze){return ge[Be]=Ze}}function y(ye,Ce,ge,Be){var Ze=Ce&&Ce.prototype instanceof P?Ce:P,je=Object.create(Ze.prototype),wt=new Me(Be||[]);return r(je,"_invoke",{value:X(ye,ge,wt)}),je}function S(ye,Ce,ge){try{return{type:"normal",arg:ye.call(Ce,ge)}}catch(Be){return{type:"throw",arg:Be}}}e.wrap=y;var b="suspendedStart",A="suspendedYield",I="executing",D="completed",L={};function P(){}function N(){}function B(){}var $={};g($,u,function(){return this});var K=Object.getPrototypeOf,q=K&&K(K(Ye([])));q&&q!==n&&i.call(q,u)&&($=q);var W=B.prototype=P.prototype=Object.create($);function ie(ye){["next","throw","return"].forEach(function(Ce){g(ye,Ce,function(ge){return this._invoke(Ce,ge)})})}function Z(ye,Ce){function ge(Ze,je,wt,Xt){var Ke=S(ye[Ze],ye,je);if(Ke.type!=="throw"){var _t=Ke.arg,zt=_t.value;return zt&&ai(zt)=="object"&&i.call(zt,"__await")?Ce.resolve(zt.__await).then(function(Rt){ge("next",Rt,wt,Xt)},function(Rt){ge("throw",Rt,wt,Xt)}):Ce.resolve(zt).then(function(Rt){_t.value=Rt,wt(_t)},function(Rt){return ge("throw",Rt,wt,Xt)})}Xt(Ke.arg)}var Be;r(this,"_invoke",{value:function(je,wt){function Xt(){return new Ce(function(Ke,_t){ge(je,wt,Ke,_t)})}return Be=Be?Be.then(Xt,Xt):Xt()}})}function X(ye,Ce,ge){var Be=b;return function(Ze,je){if(Be===I)throw Error("Generator is already running");if(Be===D){if(Ze==="throw")throw je;return{value:t,done:!0}}for(ge.method=Ze,ge.arg=je;;){var wt=ge.delegate;if(wt){var Xt=se(wt,ge);if(Xt){if(Xt===L)continue;return Xt}}if(ge.method==="next")ge.sent=ge._sent=ge.arg;else if(ge.method==="throw"){if(Be===b)throw Be=D,ge.arg;ge.dispatchException(ge.arg)}else ge.method==="return"&&ge.abrupt("return",ge.arg);Be=I;var Ke=S(ye,Ce,ge);if(Ke.type==="normal"){if(Be=ge.done?D:A,Ke.arg===L)continue;return{value:Ke.arg,done:ge.done}}Ke.type==="throw"&&(Be=D,ge.method="throw",ge.arg=Ke.arg)}}}function se(ye,Ce){var ge=Ce.method,Be=ye.iterator[ge];if(Be===t)return Ce.delegate=null,ge==="throw"&&ye.iterator.return&&(Ce.method="return",Ce.arg=t,se(ye,Ce),Ce.method==="throw")||ge!=="return"&&(Ce.method="throw",Ce.arg=new TypeError("The iterator does not provide a '"+ge+"' method")),L;var Ze=S(Be,ye.iterator,Ce.arg);if(Ze.type==="throw")return Ce.method="throw",Ce.arg=Ze.arg,Ce.delegate=null,L;var je=Ze.arg;return je?je.done?(Ce[ye.resultName]=je.value,Ce.next=ye.nextLoc,Ce.method!=="return"&&(Ce.method="next",Ce.arg=t),Ce.delegate=null,L):je:(Ce.method="throw",Ce.arg=new TypeError("iterator result is not an object"),Ce.delegate=null,L)}function De(ye){var Ce={tryLoc:ye[0]};1 in ye&&(Ce.catchLoc=ye[1]),2 in ye&&(Ce.finallyLoc=ye[2],Ce.afterLoc=ye[3]),this.tryEntries.push(Ce)}function Se(ye){var Ce=ye.completion||{};Ce.type="normal",delete Ce.arg,ye.completion=Ce}function Me(ye){this.tryEntries=[{tryLoc:"root"}],ye.forEach(De,this),this.reset(!0)}function Ye(ye){if(ye||ye===""){var Ce=ye[u];if(Ce)return Ce.call(ye);if(typeof ye.next=="function")return ye;if(!isNaN(ye.length)){var ge=-1,Be=function Ze(){for(;++ge<ye.length;)if(i.call(ye,ge))return Ze.value=ye[ge],Ze.done=!1,Ze;return Ze.value=t,Ze.done=!0,Ze};return Be.next=Be}}throw new TypeError(ai(ye)+" is not iterable")}return N.prototype=B,r(W,"constructor",{value:B,configurable:!0}),r(B,"constructor",{value:N,configurable:!0}),N.displayName=g(B,f,"GeneratorFunction"),e.isGeneratorFunction=function(ye){var Ce=typeof ye=="function"&&ye.constructor;return!!Ce&&(Ce===N||(Ce.displayName||Ce.name)==="GeneratorFunction")},e.mark=function(ye){return Object.setPrototypeOf?Object.setPrototypeOf(ye,B):(ye.__proto__=B,g(ye,f,"GeneratorFunction")),ye.prototype=Object.create(W),ye},e.awrap=function(ye){return{__await:ye}},ie(Z.prototype),g(Z.prototype,l,function(){return this}),e.AsyncIterator=Z,e.async=function(ye,Ce,ge,Be,Ze){Ze===void 0&&(Ze=Promise);var je=new Z(y(ye,Ce,ge,Be),Ze);return e.isGeneratorFunction(Ce)?je:je.next().then(function(wt){return wt.done?wt.value:je.next()})},ie(W),g(W,f,"Generator"),g(W,u,function(){return this}),g(W,"toString",function(){return"[object Generator]"}),e.keys=function(ye){var Ce=Object(ye),ge=[];for(var Be in Ce)ge.push(Be);return ge.reverse(),function Ze(){for(;ge.length;){var je=ge.pop();if(je in Ce)return Ze.value=je,Ze.done=!1,Ze}return Ze.done=!0,Ze}},e.values=Ye,Me.prototype={constructor:Me,reset:function(Ce){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(Se),!Ce)for(var ge in this)ge.charAt(0)==="t"&&i.call(this,ge)&&!isNaN(+ge.slice(1))&&(this[ge]=t)},stop:function(){this.done=!0;var Ce=this.tryEntries[0].completion;if(Ce.type==="throw")throw Ce.arg;return this.rval},dispatchException:function(Ce){if(this.done)throw Ce;var ge=this;function Be(_t,zt){return wt.type="throw",wt.arg=Ce,ge.next=_t,zt&&(ge.method="next",ge.arg=t),!!zt}for(var Ze=this.tryEntries.length-1;Ze>=0;--Ze){var je=this.tryEntries[Ze],wt=je.completion;if(je.tryLoc==="root")return Be("end");if(je.tryLoc<=this.prev){var Xt=i.call(je,"catchLoc"),Ke=i.call(je,"finallyLoc");if(Xt&&Ke){if(this.prev<je.catchLoc)return Be(je.catchLoc,!0);if(this.prev<je.finallyLoc)return Be(je.finallyLoc)}else if(Xt){if(this.prev<je.catchLoc)return Be(je.catchLoc,!0)}else{if(!Ke)throw Error("try statement without catch or finally");if(this.prev<je.finallyLoc)return Be(je.finallyLoc)}}}},abrupt:function(Ce,ge){for(var Be=this.tryEntries.length-1;Be>=0;--Be){var Ze=this.tryEntries[Be];if(Ze.tryLoc<=this.prev&&i.call(Ze,"finallyLoc")&&this.prev<Ze.finallyLoc){var je=Ze;break}}je&&(Ce==="break"||Ce==="continue")&&je.tryLoc<=ge&&ge<=je.finallyLoc&&(je=null);var wt=je?je.completion:{};return wt.type=Ce,wt.arg=ge,je?(this.method="next",this.next=je.finallyLoc,L):this.complete(wt)},complete:function(Ce,ge){if(Ce.type==="throw")throw Ce.arg;return Ce.type==="break"||Ce.type==="continue"?this.next=Ce.arg:Ce.type==="return"?(this.rval=this.arg=Ce.arg,this.method="return",this.next="end"):Ce.type==="normal"&&ge&&(this.next=ge),L},finish:function(Ce){for(var ge=this.tryEntries.length-1;ge>=0;--ge){var Be=this.tryEntries[ge];if(Be.finallyLoc===Ce)return this.complete(Be.completion,Be.afterLoc),Se(Be),L}},catch:function(Ce){for(var ge=this.tryEntries.length-1;ge>=0;--ge){var Be=this.tryEntries[ge];if(Be.tryLoc===Ce){var Ze=Be.completion;if(Ze.type==="throw"){var je=Ze.arg;Se(Be)}return je}}throw Error("illegal catch attempt")},delegateYield:function(Ce,ge,Be){return this.delegate={iterator:Ye(Ce),resultName:ge,nextLoc:Be},this.method==="next"&&(this.arg=t),L}},e}function ZB(t,e,n,i,r,a,u){try{var l=t[a](u),f=l.value}catch(g){return void n(g)}l.done?e(f):Promise.resolve(f).then(i,r)}function Lp(t){return function(){var e=this,n=arguments;return new Promise(function(i,r){var a=t.apply(e,n);function u(f){ZB(a,i,r,u,l,"next",f)}function l(f){ZB(a,i,r,u,l,"throw",f)}u(void 0)})}}var U_=It({},nY),$Q=U_.version,HQ=U_.render,GQ=U_.unmountComponentAtNode,BS;try{var WQ=Number(($Q||"").split(".")[0]);WQ>=18&&(BS=U_.createRoot)}catch{}function YB(t){var e=U_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;e&&ai(e)==="object"&&(e.usingClientEntryPoint=t)}var US="__rc_react_root__";function jQ(t,e){YB(!0);var n=e[US]||BS(e);YB(!1),n.render(t),e[US]=n}function qQ(t,e){HQ(t,e)}function KB(t,e){if(BS){jQ(t,e);return}qQ(t,e)}function XQ(t){return z3.apply(this,arguments)}function z3(){return z3=Lp(ea().mark(function t(e){return ea().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",Promise.resolve().then(function(){var r;(r=e[US])===null||r===void 0||r.unmount(),delete e[US]}));case 1:case"end":return i.stop()}},t)})),z3.apply(this,arguments)}function ZQ(t){GQ(t)}function JB(t){return N3.apply(this,arguments)}function N3(){return N3=Lp(ea().mark(function t(e){return ea().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(BS===void 0){i.next=2;break}return i.abrupt("return",XQ(e));case 2:ZQ(e);case 3:case"end":return i.stop()}},t)})),N3.apply(this,arguments)}const VS=(t,e,n)=>n!==void 0?n:`${t}-${e}`,YQ=function(t){if(!t)return!1;if(t instanceof Element){if(t.offsetParent)return!0;if(t.getBBox){var e=t.getBBox(),n=e.width,i=e.height;if(n||i)return!0}if(t.getBoundingClientRect){var r=t.getBoundingClientRect(),a=r.width,u=r.height;if(a||u)return!0}}return!1},KQ=t=>{const{componentCls:e,colorPrimary:n}=t;return{[e]:{position:"absolute",background:"transparent",pointerEvents:"none",boxSizing:"border-box",color:`var(--wave-color, ${n})`,boxShadow:"0 0 0 0 currentcolor",opacity:.2,"&.wave-motion-appear":{transition:[`box-shadow 0.4s ${t.motionEaseOutCirc}`,`opacity 2s ${t.motionEaseOutCirc}`].join(","),"&-active":{boxShadow:"0 0 0 6px currentcolor",opacity:0},"&.wave-quick":{transition:[`box-shadow ${t.motionDurationSlow} ${t.motionEaseInOut}`,`opacity ${t.motionDurationSlow} ${t.motionEaseInOut}`].join(",")}}}}},JQ=wJ("Wave",t=>[KQ(t)]),QB=`${PS}-wave-target`;function QQ(t){const e=(t||"").match(/rgba?\((\d*), (\d*), (\d*)(, [\d.]*)?\)/);return e&&e[1]&&e[2]&&e[3]?!(e[1]===e[2]&&e[2]===e[3]):!0}function B3(t){return t&&t!=="#fff"&&t!=="#ffffff"&&t!=="rgb(255, 255, 255)"&&t!=="rgba(255, 255, 255, 1)"&&QQ(t)&&!/rgba\((?:\d*, ){3}0\)/.test(t)&&t!=="transparent"}function eee(t){const{borderTopColor:e,borderColor:n,backgroundColor:i}=getComputedStyle(t);return B3(e)?e:B3(n)?n:B3(i)?i:null}function U3(t){return Number.isNaN(t)?0:t}const tee=t=>{const{className:e,target:n,component:i}=t,r=he.useRef(null),[a,u]=he.useState(null),[l,f]=he.useState([]),[g,y]=he.useState(0),[S,b]=he.useState(0),[A,I]=he.useState(0),[D,L]=he.useState(0),[P,N]=he.useState(!1),B={left:g,top:S,width:A,height:D,borderRadius:l.map(q=>`${q}px`).join(" ")};a&&(B["--wave-color"]=a);function $(){const q=getComputedStyle(n);u(eee(n));const W=q.position==="static",{borderLeftWidth:ie,borderTopWidth:Z}=q;y(W?n.offsetLeft:U3(-parseFloat(ie))),b(W?n.offsetTop:U3(-parseFloat(Z))),I(n.offsetWidth),L(n.offsetHeight);const{borderTopLeftRadius:X,borderTopRightRadius:se,borderBottomLeftRadius:De,borderBottomRightRadius:Se}=q;f([X,se,Se,De].map(Me=>U3(parseFloat(Me))))}if(he.useEffect(()=>{if(n){const q=Mp(()=>{$(),N(!0)});let W;return typeof ResizeObserver<"u"&&(W=new ResizeObserver($),W.observe(n)),()=>{Mp.cancel(q),W==null||W.disconnect()}}},[]),!P)return null;const K=(i==="Checkbox"||i==="Radio")&&(n==null?void 0:n.classList.contains(QB));return he.createElement(N_,{visible:!0,motionAppear:!0,motionName:"wave-motion",motionDeadline:5e3,onAppearEnd:(q,W)=>{var ie;if(W.deadline||W.propertyName==="opacity"){const Z=(ie=r.current)===null||ie===void 0?void 0:ie.parentElement;JB(Z).then(()=>{Z==null||Z.remove()})}return!1}},(q,W)=>{let{className:ie}=q;return he.createElement("div",{ref:aS(r,W),className:pi(e,ie,{"wave-quick":K}),style:B})})},nee=(t,e)=>{var n;const{component:i}=e;if(i==="Checkbox"&&!(!((n=t.querySelector("input"))===null||n===void 0)&&n.checked))return;const r=document.createElement("div");r.style.position="absolute",r.style.left="0px",r.style.top="0px",t==null||t.insertBefore(r,t==null?void 0:t.firstChild),KB(he.createElement(tee,Object.assign({},e,{target:t})),r)},iee=(t,e,n)=>{const{wave:i}=he.useContext(ms),[,r,a]=Jd(),u=z_(g=>{const y=t.current;if(i!=null&&i.disabled||!y)return;const S=y.querySelector(`.${QB}`)||y,{showEffect:b}=i||{};(b||nee)(S,{className:e,token:r,component:n,event:g,hashId:a})}),l=he.useRef();return g=>{Mp.cancel(l.current),l.current=Mp(()=>{u(g)})}},ree=t=>{const{children:e,disabled:n,component:i}=t,{getPrefixCls:r}=he.useContext(ms),a=he.useRef(null),u=r("wave"),[,l]=JQ(u),f=iee(a,pi(u,l),i);if(un.useEffect(()=>{const y=a.current;if(!y||y.nodeType!==1||n)return;const S=b=>{!YQ(b.target)||!y.getAttribute||y.getAttribute("disabled")||y.disabled||y.className.includes("disabled")||y.className.includes("-leave")||f(b)};return y.addEventListener("click",S,!0),()=>{y.removeEventListener("click",S,!0)}},[n]),!un.isValidElement(e))return e??null;const g=IP(e)?aS(e.ref,a):a;return GB(e,{ref:g})},see=t=>{const e=un.useContext(Mv);return un.useMemo(()=>t?typeof t=="string"?t??e:t instanceof Function?t(e):e:e,[t,e])},e6=he.createContext(null),oee=(t,e)=>{const n=he.useContext(e6),i=he.useMemo(()=>{if(!n)return"";const{compactDirection:r,isFirstItem:a,isLastItem:u}=n,l=r==="vertical"?"-vertical-":"-";return pi(`${t}-compact${l}item`,{[`${t}-compact${l}first-item`]:a,[`${t}-compact${l}last-item`]:u,[`${t}-compact${l}item-rtl`]:e==="rtl"})},[t,e,n]);return{compactSize:n==null?void 0:n.compactSize,compactDirection:n==null?void 0:n.compactDirection,compactItemClassnames:i}},aee=t=>{let{children:e}=t;return he.createElement(e6.Provider,{value:null},e)};var lee=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};const t6=he.createContext(void 0),cee=t=>{const{getPrefixCls:e,direction:n}=he.useContext(ms),{prefixCls:i,size:r,className:a}=t,u=lee(t,["prefixCls","size","className"]),l=e("btn-group",i),[,,f]=Jd();let g="";switch(r){case"large":g="lg";break;case"small":g="sm";break}const y=pi(l,{[`${l}-${g}`]:g,[`${l}-rtl`]:n==="rtl"},a,f);return he.createElement(t6.Provider,{value:r},he.createElement("div",Object.assign({},u,{className:y})))},n6=/^[\u4e00-\u9fa5]{2}$/,V3=n6.test.bind(n6);function i6(t){return t==="danger"?{danger:!0}:{type:t}}function r6(t){return typeof t=="string"}function $3(t){return t==="text"||t==="link"}function uee(t,e){if(t==null)return;const n=e?" ":"";return typeof t!="string"&&typeof t!="number"&&r6(t.type)&&V3(t.props.children)?GB(t,{children:t.props.children.split("").join(n)}):r6(t)?V3(t)?un.createElement("span",null,t.split("").join(n)):un.createElement("span",null,t):LQ(t)?un.createElement("span",null,t):t}function hee(t,e){let n=!1;const i=[];return un.Children.forEach(t,r=>{const a=typeof r,u=a==="string"||a==="number";if(n&&u){const l=i.length-1,f=i[l];i[l]=`${f}${r}`}else i.push(r);n=u}),un.Children.map(i,r=>uee(r,e))}const s6=he.forwardRef((t,e)=>{const{className:n,style:i,children:r,prefixCls:a}=t,u=pi(`${a}-icon`,n);return un.createElement("span",{ref:e,className:u,style:i},r)}),o6=he.forwardRef((t,e)=>{const{prefixCls:n,className:i,style:r,iconClassName:a}=t,u=pi(`${n}-loading-icon`,i);return un.createElement(s6,{prefixCls:n,className:u,style:r,ref:e},un.createElement(FQ,{className:a}))}),H3=()=>({width:0,opacity:0,transform:"scale(0)"}),G3=t=>({width:t.scrollWidth,opacity:1,transform:"scale(1)"}),dee=t=>{const{prefixCls:e,loading:n,existIcon:i,className:r,style:a}=t,u=!!n;return i?un.createElement(o6,{prefixCls:e,className:r,style:a}):un.createElement(N_,{visible:u,motionName:`${e}-loading-icon-motion`,motionLeave:u,removeOnLeave:!0,onAppearStart:H3,onAppearActive:G3,onEnterStart:H3,onEnterActive:G3,onLeaveStart:G3,onLeaveActive:H3},(l,f)=>{let{className:g,style:y}=l;return un.createElement(o6,{prefixCls:e,className:r,style:Object.assign(Object.assign({},a),y),ref:f,iconClassName:g})})},a6=(t,e)=>({[`> span, > ${t}`]:{"&:not(:last-child)":{[`&, & > ${t}`]:{"&:not(:disabled)":{borderInlineEndColor:e}}},"&:not(:first-child)":{[`&, & > ${t}`]:{"&:not(:disabled)":{borderInlineStartColor:e}}}}}),fee=t=>{const{componentCls:e,fontSize:n,lineWidth:i,groupBorderColor:r,colorErrorHover:a}=t;return{[`${e}-group`]:[{position:"relative",display:"inline-flex",[`> span, > ${e}`]:{"&:not(:last-child)":{[`&, & > ${e}`]:{borderStartEndRadius:0,borderEndEndRadius:0}},"&:not(:first-child)":{marginInlineStart:t.calc(i).mul(-1).equal(),[`&, & > ${e}`]:{borderStartStartRadius:0,borderEndStartRadius:0}}},[e]:{position:"relative",zIndex:1,"&:hover, &:focus, &:active":{zIndex:2},"&[disabled]":{zIndex:0}},[`${e}-icon-only`]:{fontSize:n}},a6(`${e}-primary`,r),a6(`${e}-danger`,a)]}},l6=t=>{const{paddingInline:e,onlyIconSize:n,paddingBlock:i}=t;return Kd(t,{buttonPaddingHorizontal:e,buttonPaddingVertical:i,buttonIconOnlyFontSize:n})},c6=t=>{var e,n,i,r,a,u;const l=(e=t.contentFontSize)!==null&&e!==void 0?e:t.fontSize,f=(n=t.contentFontSizeSM)!==null&&n!==void 0?n:t.fontSize,g=(i=t.contentFontSizeLG)!==null&&i!==void 0?i:t.fontSizeLG,y=(r=t.contentLineHeight)!==null&&r!==void 0?r:AS(l),S=(a=t.contentLineHeightSM)!==null&&a!==void 0?a:AS(f),b=(u=t.contentLineHeightLG)!==null&&u!==void 0?u:AS(g);return{fontWeight:400,defaultShadow:`0 ${t.controlOutlineWidth}px 0 ${t.controlTmpOutline}`,primaryShadow:`0 ${t.controlOutlineWidth}px 0 ${t.controlOutline}`,dangerShadow:`0 ${t.controlOutlineWidth}px 0 ${t.colorErrorOutline}`,primaryColor:t.colorTextLightSolid,dangerColor:t.colorTextLightSolid,borderColorDisabled:t.colorBorder,defaultGhostColor:t.colorBgContainer,ghostBg:"transparent",defaultGhostBorderColor:t.colorBgContainer,paddingInline:t.paddingContentHorizontal-t.lineWidth,paddingInlineLG:t.paddingContentHorizontal-t.lineWidth,paddingInlineSM:8-t.lineWidth,onlyIconSize:t.fontSizeLG,onlyIconSizeSM:t.fontSizeLG-2,onlyIconSizeLG:t.fontSizeLG+2,groupBorderColor:t.colorPrimaryHover,linkHoverBg:"transparent",textHoverBg:t.colorBgTextHover,defaultColor:t.colorText,defaultBg:t.colorBgContainer,defaultBorderColor:t.colorBorder,defaultBorderColorDisabled:t.colorBorder,defaultHoverBg:t.colorBgContainer,defaultHoverColor:t.colorPrimaryHover,defaultHoverBorderColor:t.colorPrimaryHover,defaultActiveBg:t.colorBgContainer,defaultActiveColor:t.colorPrimaryActive,defaultActiveBorderColor:t.colorPrimaryActive,contentFontSize:l,contentFontSizeSM:f,contentFontSizeLG:g,contentLineHeight:y,contentLineHeightSM:S,contentLineHeightLG:b,paddingBlock:Math.max((t.controlHeight-l*y)/2-t.lineWidth,0),paddingBlockSM:Math.max((t.controlHeightSM-f*S)/2-t.lineWidth,0),paddingBlockLG:Math.max((t.controlHeightLG-g*b)/2-t.lineWidth,0)}},pee=t=>{const{componentCls:e,iconCls:n,fontWeight:i}=t;return{[e]:{outline:"none",position:"relative",display:"inline-flex",gap:t.marginXS,alignItems:"center",justifyContent:"center",fontWeight:i,whiteSpace:"nowrap",textAlign:"center",backgroundImage:"none",background:"transparent",border:`${cr(t.lineWidth)} ${t.lineType} transparent`,cursor:"pointer",transition:`all ${t.motionDurationMid} ${t.motionEaseInOut}`,userSelect:"none",touchAction:"manipulation",color:t.colorText,"&:disabled > *":{pointerEvents:"none"},"> span":{display:"inline-block"},[`${e}-icon`]:{lineHeight:1},"> a":{color:"currentColor"},"&:not(:disabled)":Object.assign({},mB(t)),[`&${e}-two-chinese-chars::first-letter`]:{letterSpacing:"0.34em"},[`&${e}-two-chinese-chars > *:not(${n})`]:{marginInlineEnd:"-0.34em",letterSpacing:"0.34em"},"&-icon-end":{flexDirection:"row-reverse"}}}},wh=(t,e,n)=>({[`&:not(:disabled):not(${t}-disabled)`]:{"&:hover":e,"&:active":n}}),mee=t=>({minWidth:t.controlHeight,paddingInlineStart:0,paddingInlineEnd:0,borderRadius:"50%"}),gee=t=>({borderRadius:t.controlHeight,paddingInlineStart:t.calc(t.controlHeight).div(2).equal(),paddingInlineEnd:t.calc(t.controlHeight).div(2).equal()}),vee=t=>({cursor:"not-allowed",borderColor:t.borderColorDisabled,color:t.colorTextDisabled,background:t.colorBgContainerDisabled,boxShadow:"none"}),V_=(t,e,n,i,r,a,u,l)=>({[`&${t}-background-ghost`]:Object.assign(Object.assign({color:n||void 0,background:e,borderColor:i||void 0,boxShadow:"none"},wh(t,Object.assign({background:e},u),Object.assign({background:e},l))),{"&:disabled":{cursor:"not-allowed",color:r||void 0,borderColor:a||void 0}})}),W3=t=>({[`&:disabled, &${t.componentCls}-disabled`]:Object.assign({},vee(t))}),u6=t=>Object.assign({},W3(t)),$S=t=>({[`&:disabled, &${t.componentCls}-disabled`]:{cursor:"not-allowed",color:t.colorTextDisabled}}),h6=t=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},u6(t)),{background:t.defaultBg,borderColor:t.defaultBorderColor,color:t.defaultColor,boxShadow:t.defaultShadow}),wh(t.componentCls,{color:t.defaultHoverColor,borderColor:t.defaultHoverBorderColor,background:t.defaultHoverBg},{color:t.defaultActiveColor,borderColor:t.defaultActiveBorderColor,background:t.defaultActiveBg})),V_(t.componentCls,t.ghostBg,t.defaultGhostColor,t.defaultGhostBorderColor,t.colorTextDisabled,t.colorBorder)),{[`&${t.componentCls}-dangerous`]:Object.assign(Object.assign(Object.assign({color:t.colorError,borderColor:t.colorError},wh(t.componentCls,{color:t.colorErrorHover,borderColor:t.colorErrorBorderHover},{color:t.colorErrorActive,borderColor:t.colorErrorActive})),V_(t.componentCls,t.ghostBg,t.colorError,t.colorError,t.colorTextDisabled,t.colorBorder)),W3(t))}),yee=t=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},u6(t)),{color:t.primaryColor,background:t.colorPrimary,boxShadow:t.primaryShadow}),wh(t.componentCls,{color:t.colorTextLightSolid,background:t.colorPrimaryHover},{color:t.colorTextLightSolid,background:t.colorPrimaryActive})),V_(t.componentCls,t.ghostBg,t.colorPrimary,t.colorPrimary,t.colorTextDisabled,t.colorBorder,{color:t.colorPrimaryHover,borderColor:t.colorPrimaryHover},{color:t.colorPrimaryActive,borderColor:t.colorPrimaryActive})),{[`&${t.componentCls}-dangerous`]:Object.assign(Object.assign(Object.assign({background:t.colorError,boxShadow:t.dangerShadow,color:t.dangerColor},wh(t.componentCls,{background:t.colorErrorHover},{background:t.colorErrorActive})),V_(t.componentCls,t.ghostBg,t.colorError,t.colorError,t.colorTextDisabled,t.colorBorder,{color:t.colorErrorHover,borderColor:t.colorErrorHover},{color:t.colorErrorActive,borderColor:t.colorErrorActive})),W3(t))}),_ee=t=>Object.assign(Object.assign({},h6(t)),{borderStyle:"dashed"}),xee=t=>Object.assign(Object.assign(Object.assign({color:t.colorLink},wh(t.componentCls,{color:t.colorLinkHover,background:t.linkHoverBg},{color:t.colorLinkActive})),$S(t)),{[`&${t.componentCls}-dangerous`]:Object.assign(Object.assign({color:t.colorError},wh(t.componentCls,{color:t.colorErrorHover},{color:t.colorErrorActive})),$S(t))}),bee=t=>Object.assign(Object.assign(Object.assign({},wh(t.componentCls,{color:t.colorText,background:t.textHoverBg},{color:t.colorText,background:t.colorBgTextActive})),$S(t)),{[`&${t.componentCls}-dangerous`]:Object.assign(Object.assign({color:t.colorError},$S(t)),wh(t.componentCls,{color:t.colorErrorHover,background:t.colorErrorBg},{color:t.colorErrorHover,background:t.colorErrorBgActive}))}),wee=t=>{const{componentCls:e}=t;return{[`${e}-default`]:h6(t),[`${e}-primary`]:yee(t),[`${e}-dashed`]:_ee(t),[`${e}-link`]:xee(t),[`${e}-text`]:bee(t),[`${e}-ghost`]:V_(t.componentCls,t.ghostBg,t.colorBgContainer,t.colorBgContainer,t.colorTextDisabled,t.colorBorder)}},j3=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const{componentCls:n,controlHeight:i,fontSize:r,lineHeight:a,borderRadius:u,buttonPaddingHorizontal:l,iconCls:f,buttonPaddingVertical:g}=t,y=`${n}-icon-only`;return[{[e]:{fontSize:r,lineHeight:a,height:i,padding:`${cr(g)} ${cr(l)}`,borderRadius:u,[`&${y}`]:{width:i,paddingInline:0,[`&${n}-compact-item`]:{flex:"none"},[`&${n}-round`]:{width:"auto"},[f]:{fontSize:t.buttonIconOnlyFontSize}},[`&${n}-loading`]:{opacity:t.opacityLoading,cursor:"default"},[`${n}-loading-icon`]:{transition:`width ${t.motionDurationSlow} ${t.motionEaseInOut}, opacity ${t.motionDurationSlow} ${t.motionEaseInOut}`}}},{[`${n}${n}-circle${e}`]:mee(t)},{[`${n}${n}-round${e}`]:gee(t)}]},See=t=>{const e=Kd(t,{fontSize:t.contentFontSize,lineHeight:t.contentLineHeight});return j3(e,t.componentCls)},Eee=t=>{const e=Kd(t,{controlHeight:t.controlHeightSM,fontSize:t.contentFontSizeSM,lineHeight:t.contentLineHeightSM,padding:t.paddingXS,buttonPaddingHorizontal:t.paddingInlineSM,buttonPaddingVertical:t.paddingBlockSM,borderRadius:t.borderRadiusSM,buttonIconOnlyFontSize:t.onlyIconSizeSM});return j3(e,`${t.componentCls}-sm`)},Mee=t=>{const e=Kd(t,{controlHeight:t.controlHeightLG,fontSize:t.contentFontSizeLG,lineHeight:t.contentLineHeightLG,buttonPaddingHorizontal:t.paddingInlineLG,buttonPaddingVertical:t.paddingBlockLG,borderRadius:t.borderRadiusLG,buttonIconOnlyFontSize:t.onlyIconSizeLG});return j3(e,`${t.componentCls}-lg`)},Cee=t=>{const{componentCls:e}=t;return{[e]:{[`&${e}-block`]:{width:"100%"}}}},Tee=T3("Button",t=>{const e=l6(t);return[pee(e),See(e),Eee(e),Mee(e),Cee(e),wee(e),fee(e)]},c6,{unitless:{fontWeight:!0,contentLineHeight:!0,contentLineHeightSM:!0,contentLineHeightLG:!0}});function Aee(t,e,n){const{focusElCls:i,focus:r,borderElCls:a}=n,u=a?"> *":"",l=["hover",r?"focus":null,"active"].filter(Boolean).map(f=>`&:${f} ${u}`).join(",");return{[`&-item:not(${e}-last-item)`]:{marginInlineEnd:t.calc(t.lineWidth).mul(-1).equal()},"&-item":Object.assign(Object.assign({[l]:{zIndex:2}},i?{[`&${i}`]:{zIndex:2}}:{}),{[`&[disabled] ${u}`]:{zIndex:0}})}}function Pee(t,e,n){const{borderElCls:i}=n,r=i?`> ${i}`:"";return{[`&-item:not(${e}-first-item):not(${e}-last-item) ${r}`]:{borderRadius:0},[`&-item:not(${e}-last-item)${e}-first-item`]:{[`& ${r}, &${t}-sm ${r}, &${t}-lg ${r}`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`&-item:not(${e}-first-item)${e}-last-item`]:{[`& ${r}, &${t}-sm ${r}, &${t}-lg ${r}`]:{borderStartStartRadius:0,borderEndStartRadius:0}}}}function Iee(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{focus:!0};const{componentCls:n}=t,i=`${n}-compact`;return{[i]:Object.assign(Object.assign({},Aee(t,i,e)),Pee(n,i,e))}}function Ree(t,e){return{[`&-item:not(${e}-last-item)`]:{marginBottom:t.calc(t.lineWidth).mul(-1).equal()},"&-item":{"&:hover,&:focus,&:active":{zIndex:2},"&[disabled]":{zIndex:0}}}}function Lee(t,e){return{[`&-item:not(${e}-first-item):not(${e}-last-item)`]:{borderRadius:0},[`&-item${e}-first-item:not(${e}-last-item)`]:{[`&, &${t}-sm, &${t}-lg`]:{borderEndEndRadius:0,borderEndStartRadius:0}},[`&-item${e}-last-item:not(${e}-first-item)`]:{[`&, &${t}-sm, &${t}-lg`]:{borderStartStartRadius:0,borderStartEndRadius:0}}}}function kee(t){const e=`${t.componentCls}-compact-vertical`;return{[e]:Object.assign(Object.assign({},Ree(t,e)),Lee(t.componentCls,e))}}const Dee=t=>{const{componentCls:e,calc:n}=t;return{[e]:{[`&-compact-item${e}-primary`]:{[`&:not([disabled]) + ${e}-compact-item${e}-primary:not([disabled])`]:{position:"relative","&:before":{position:"absolute",top:n(t.lineWidth).mul(-1).equal(),insetInlineStart:n(t.lineWidth).mul(-1).equal(),display:"inline-block",width:t.lineWidth,height:`calc(100% + ${cr(t.lineWidth)} * 2)`,backgroundColor:t.colorPrimaryHover,content:'""'}}},"&-compact-vertical-item":{[`&${e}-primary`]:{[`&:not([disabled]) + ${e}-compact-vertical-item${e}-primary:not([disabled])`]:{position:"relative","&:before":{position:"absolute",top:n(t.lineWidth).mul(-1).equal(),insetInlineStart:n(t.lineWidth).mul(-1).equal(),display:"inline-block",width:`calc(100% + ${cr(t.lineWidth)} * 2)`,height:t.lineWidth,backgroundColor:t.colorPrimaryHover,content:'""'}}}}}}},Oee=vB(["Button","compact"],t=>{const e=l6(t);return[Iee(e),kee(e),Dee(e)]},c6);var Fee=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};function zee(t){if(typeof t=="object"&&t){let e=t==null?void 0:t.delay;return e=!Number.isNaN(e)&&typeof e=="number"?e:0,{loading:e<=0,delay:e}}return{loading:!!t,delay:0}}const $_=un.forwardRef((t,e)=>{var n,i,r;const{loading:a=!1,prefixCls:u,type:l,danger:f=!1,shape:g="default",size:y,styles:S,disabled:b,className:A,rootClassName:I,children:D,icon:L,iconPosition:P="start",ghost:N=!1,block:B=!1,htmlType:$="button",classNames:K,style:q={},autoInsertSpace:W}=t,ie=Fee(t,["loading","prefixCls","type","danger","shape","size","styles","disabled","className","rootClassName","children","icon","iconPosition","ghost","block","htmlType","classNames","style","autoInsertSpace"]),Z=l||"default",{getPrefixCls:X,direction:se,button:De}=he.useContext(ms),Se=(n=W??(De==null?void 0:De.autoInsertSpace))!==null&&n!==void 0?n:!0,Me=X("btn",u),[Ye,ye,Ce]=Tee(Me),ge=he.useContext(IS),Be=b??ge,Ze=he.useContext(t6),je=he.useMemo(()=>zee(a),[a]),[wt,Xt]=he.useState(je.loading),[Ke,_t]=he.useState(!1),Rt=aS(e,he.createRef()),fn=he.Children.count(D)===1&&!L&&!$3(Z);he.useEffect(()=>{let st=null;je.delay>0?st=setTimeout(()=>{st=null,Xt(!0)},je.delay):Xt(je.loading);function ft(){st&&(clearTimeout(st),st=null)}return ft},[je]),he.useEffect(()=>{if(!Rt||!Rt.current||!Se)return;const st=Rt.current.textContent;fn&&V3(st)?Ke||_t(!0):Ke&&_t(!1)},[Rt]);const Mn=st=>{const{onClick:ft}=t;if(wt||Be){st.preventDefault();return}ft==null||ft(st)},{compactSize:Bt,compactItemClassnames:Kn}=oee(Me,se),Re={large:"lg",small:"sm",middle:void 0},Jn=see(st=>{var ft,Ht;return(Ht=(ft=y??Bt)!==null&&ft!==void 0?ft:Ze)!==null&&Ht!==void 0?Ht:st}),Ln=Jn&&Re[Jn]||"",Cn=wt?"loading":L,Ue=lS(ie,["navigate"]),xt=pi(Me,ye,Ce,{[`${Me}-${g}`]:g!=="default"&&g,[`${Me}-${Z}`]:Z,[`${Me}-${Ln}`]:Ln,[`${Me}-icon-only`]:!D&&D!==0&&!!Cn,[`${Me}-background-ghost`]:N&&!$3(Z),[`${Me}-loading`]:wt,[`${Me}-two-chinese-chars`]:Ke&&Se&&!wt,[`${Me}-block`]:B,[`${Me}-dangerous`]:f,[`${Me}-rtl`]:se==="rtl",[`${Me}-icon-end`]:P==="end"},Kn,A,I,De==null?void 0:De.className),Pt=Object.assign(Object.assign({},De==null?void 0:De.style),q),mt=pi(K==null?void 0:K.icon,(i=De==null?void 0:De.classNames)===null||i===void 0?void 0:i.icon),ve=Object.assign(Object.assign({},(S==null?void 0:S.icon)||{}),((r=De==null?void 0:De.styles)===null||r===void 0?void 0:r.icon)||{}),re=L&&!wt?un.createElement(s6,{prefixCls:Me,className:mt,style:ve},L):un.createElement(dee,{existIcon:!!L,prefixCls:Me,loading:wt}),Xe=D||D===0?hee(D,fn&&Se):null;if(Ue.href!==void 0)return Ye(un.createElement("a",Object.assign({},Ue,{className:pi(xt,{[`${Me}-disabled`]:Be}),href:Be?void 0:Ue.href,style:Pt,onClick:Mn,ref:Rt,tabIndex:Be?-1:0}),re,Xe));let Ge=un.createElement("button",Object.assign({},ie,{type:$,className:xt,style:Pt,onClick:Mn,disabled:Be,ref:Rt}),re,Xe,!!Kn&&un.createElement(Oee,{key:"compact",prefixCls:Me}));return $3(Z)||(Ge=un.createElement(ree,{component:"Button",disabled:wt},Ge)),Ye(Ge)});$_.Group=cee,$_.__ANT_BUTTON=!0;function q3(t){return!!(t!=null&&t.then)}const d6=t=>{const{type:e,children:n,prefixCls:i,buttonProps:r,close:a,autoFocus:u,emitEvent:l,isSilent:f,quitOnNullishReturnValue:g,actionFn:y}=t,S=he.useRef(!1),b=he.useRef(null),[A,I]=RS(!1),D=function(){a==null||a.apply(void 0,arguments)};he.useEffect(()=>{let N=null;return u&&(N=setTimeout(()=>{var B;(B=b.current)===null||B===void 0||B.focus()})),()=>{N&&clearTimeout(N)}},[]);const L=N=>{q3(N)&&(I(!0),N.then(function(){I(!1,!0),D.apply(void 0,arguments),S.current=!1},B=>{if(I(!1,!0),S.current=!1,!(f!=null&&f()))return Promise.reject(B)}))},P=N=>{if(S.current)return;if(S.current=!0,!y){D();return}let B;if(l){if(B=y(N),g&&!q3(B)){S.current=!1,D(N);return}}else if(y.length)B=y(a),S.current=!1;else if(B=y(),!q3(B)){D();return}L(B)};return he.createElement($_,Object.assign({},i6(e),{onClick:P,loading:A,prefixCls:i},r,{ref:b}),n)},H_=un.createContext({}),{Provider:f6}=H_,p6=()=>{const{autoFocusButton:t,cancelButtonProps:e,cancelTextLocale:n,isSilent:i,mergedOkCancel:r,rootPrefixCls:a,close:u,onCancel:l,onConfirm:f}=he.useContext(H_);return r?un.createElement(d6,{isSilent:i,actionFn:l,close:function(){u==null||u.apply(void 0,arguments),f==null||f(!1)},autoFocus:t==="cancel",buttonProps:e,prefixCls:`${a}-btn`},n):null},m6=()=>{const{autoFocusButton:t,close:e,isSilent:n,okButtonProps:i,rootPrefixCls:r,okTextLocale:a,okType:u,onConfirm:l,onOk:f}=he.useContext(H_);return un.createElement(d6,{isSilent:n,type:u||"primary",actionFn:f,close:function(){e==null||e.apply(void 0,arguments),l==null||l(!0)},autoFocus:t==="ok",buttonProps:i,prefixCls:`${r}-btn`},a)};var g6=he.createContext(null),v6=[];function Nee(t,e){var n=he.useState(function(){if(!_a())return null;var I=document.createElement("div");return I}),i=Xn(n,1),r=i[0],a=he.useRef(!1),u=he.useContext(g6),l=he.useState(v6),f=Xn(l,2),g=f[0],y=f[1],S=u||(a.current?void 0:function(I){y(function(D){var L=[I].concat(Gn(D));return L})});function b(){r.parentElement||document.body.appendChild(r),a.current=!0}function A(){var I;(I=r.parentElement)===null||I===void 0||I.removeChild(r),a.current=!1}return fS(function(){return t?u?u(b):b():A(),A},[t]),fS(function(){g.length&&(g.forEach(function(I){return I()}),y(v6))},[g]),[r,S]}function Bee(t){var e="rc-scrollbar-measure-".concat(Math.random().toString(36).substring(7)),n=document.createElement("div");n.id=e;var i=n.style;i.position="absolute",i.left="0",i.top="0",i.width="100px",i.height="100px",i.overflow="scroll";var r,a;if(t){var u=getComputedStyle(t);i.scrollbarColor=u.scrollbarColor,i.scrollbarWidth=u.scrollbarWidth;var l=getComputedStyle(t,"::-webkit-scrollbar"),f=parseInt(l.width,10),g=parseInt(l.height,10);try{var y=f?"width: ".concat(l.width,";"):"",S=g?"height: ".concat(l.height,";"):"";yh(`
#`.concat(e,`::-webkit-scrollbar {
`).concat(y,`
`).concat(S,`
}`),e)}catch(I){console.error(I),r=f,a=g}}document.body.appendChild(n);var b=t&&r&&!isNaN(r)?r:n.offsetWidth-n.clientWidth,A=t&&a&&!isNaN(a)?a:n.offsetHeight-n.clientHeight;return document.body.removeChild(n),I_(e),{width:b,height:A}}function Uee(t){return typeof document>"u"||!t||!(t instanceof Element)?{width:0,height:0}:Bee(t)}function Vee(){return document.body.scrollHeight>(window.innerHeight||document.documentElement.clientHeight)&&window.innerWidth>document.body.offsetWidth}var $ee="rc-util-locker-".concat(Date.now()),y6=0;function Hee(t){var e=!!t,n=he.useState(function(){return y6+=1,"".concat($ee,"_").concat(y6)}),i=Xn(n,1),r=i[0];fS(function(){if(e){var a=Uee(document.body).width,u=Vee();yh(`
html body {
  overflow-y: hidden;
  `.concat(u?"width: calc(100% - ".concat(a,"px);"):"",`
}`),r)}else I_(r);return function(){I_(r)}},[e,r])}var Gee=!1;function Wee(t){return Gee}var _6=function(e){return e===!1?!1:!_a()||!e?null:typeof e=="string"?document.querySelector(e):typeof e=="function"?e():e},jee=he.forwardRef(function(t,e){var n=t.open,i=t.autoLock,r=t.getContainer;t.debug;var a=t.autoDestroy,u=a===void 0?!0:a,l=t.children,f=he.useState(n),g=Xn(f,2),y=g[0],S=g[1],b=y||n;he.useEffect(function(){(u||n)&&S(n)},[n,u]);var A=he.useState(function(){return _6(r)}),I=Xn(A,2),D=I[0],L=I[1];he.useEffect(function(){var se=_6(r);L(se??null)});var P=Nee(b&&!D),N=Xn(P,2),B=N[0],$=N[1],K=D??B;Hee(i&&n&&_a()&&(K===B||K===document.body));var q=null;if(l&&IP(l)&&e){var W=l;q=W.ref}var ie=Q5(q,e);if(!b||!_a()||D===void 0)return null;var Z=K===!1||Wee(),X=l;return e&&(X=he.cloneElement(l,{ref:ie})),he.createElement(g6.Provider,{value:$},Z?X:AP.createPortal(X,K))}),x6=he.createContext({});function qee(){var t=It({},Bb);return t.useId}var b6=0,w6=qee();const Xee=w6?function(e){var n=w6();return e||n}:function(e){var n=he.useState("ssr-id"),i=Xn(n,2),r=i[0],a=i[1];return he.useEffect(function(){var u=b6;b6+=1,a("rc_unique_".concat(u))},[]),e||r};function S6(t,e,n){var i=e;return!i&&n&&(i="".concat(t,"-").concat(n)),i}function E6(t,e){var n=t["page".concat(e?"Y":"X","Offset")],i="scroll".concat(e?"Top":"Left");if(typeof n!="number"){var r=t.document;n=r.documentElement[i],typeof n!="number"&&(n=r.body[i])}return n}function Zee(t){var e=t.getBoundingClientRect(),n={left:e.left,top:e.top},i=t.ownerDocument,r=i.defaultView||i.parentWindow;return n.left+=E6(r),n.top+=E6(r,!0),n}const Yee=he.memo(function(t){var e=t.children;return e},function(t,e){var n=e.shouldUpdate;return!n});var M6={width:0,height:0,overflow:"hidden",outline:"none"},Kee={outline:"none"},C6=un.forwardRef(function(t,e){var n=t.prefixCls,i=t.className,r=t.style,a=t.title,u=t.ariaId,l=t.footer,f=t.closable,g=t.closeIcon,y=t.onClose,S=t.children,b=t.bodyStyle,A=t.bodyProps,I=t.modalRender,D=t.onMouseDown,L=t.onMouseUp,P=t.holderRef,N=t.visible,B=t.forceRender,$=t.width,K=t.height,q=t.classNames,W=t.styles,ie=un.useContext(x6),Z=ie.panel,X=Q5(P,Z),se=he.useRef(),De=he.useRef(),Se=he.useRef();un.useImperativeHandle(e,function(){return{focus:function(){var Xt;(Xt=Se.current)===null||Xt===void 0||Xt.focus({preventScroll:!0})},changeActive:function(Xt){var Ke=document,_t=Ke.activeElement;Xt&&_t===De.current?se.current.focus({preventScroll:!0}):!Xt&&_t===se.current&&De.current.focus({preventScroll:!0})}}});var Me={};$!==void 0&&(Me.width=$),K!==void 0&&(Me.height=K);var Ye=l?un.createElement("div",{className:pi("".concat(n,"-footer"),q==null?void 0:q.footer),style:It({},W==null?void 0:W.footer)},l):null,ye=a?un.createElement("div",{className:pi("".concat(n,"-header"),q==null?void 0:q.header),style:It({},W==null?void 0:W.header)},un.createElement("div",{className:"".concat(n,"-title"),id:u},a)):null,Ce=he.useMemo(function(){return ai(f)==="object"&&f!==null?f:f?{closeIcon:g??un.createElement("span",{className:"".concat(n,"-close-x")})}:{}},[f,g,n]),ge=F3(Ce,!0),Be=ai(f)==="object"&&f.disabled,Ze=f?un.createElement("button",Kr({type:"button",onClick:y,"aria-label":"Close"},ge,{className:"".concat(n,"-close"),disabled:Be}),Ce.closeIcon):null,je=un.createElement("div",{className:pi("".concat(n,"-content"),q==null?void 0:q.content),style:W==null?void 0:W.content},Ze,ye,un.createElement("div",Kr({className:pi("".concat(n,"-body"),q==null?void 0:q.body),style:It(It({},b),W==null?void 0:W.body)},A),S),Ye);return un.createElement("div",{key:"dialog-element",role:"dialog","aria-labelledby":a?u:null,"aria-modal":"true",ref:X,style:It(It({},r),Me),className:pi(n,i),onMouseDown:D,onMouseUp:L},un.createElement("div",{tabIndex:0,ref:se,style:M6,"aria-hidden":"true"}),un.createElement("div",{ref:Se,tabIndex:-1,style:Kee},un.createElement(Yee,{shouldUpdate:N||B},I?I(je):je)),un.createElement("div",{tabIndex:0,ref:De,style:M6,"aria-hidden":"true"}))}),T6=he.forwardRef(function(t,e){var n=t.prefixCls,i=t.title,r=t.style,a=t.className,u=t.visible,l=t.forceRender,f=t.destroyOnClose,g=t.motionName,y=t.ariaId,S=t.onVisibleChanged,b=t.mousePosition,A=he.useRef(),I=he.useState(),D=Xn(I,2),L=D[0],P=D[1],N={};L&&(N.transformOrigin=L);function B(){var $=Zee(A.current);P(b&&(b.x||b.y)?"".concat(b.x-$.left,"px ").concat(b.y-$.top,"px"):"")}return he.createElement(N_,{visible:u,onVisibleChanged:S,onAppearPrepare:B,onEnterPrepare:B,forceRender:l,motionName:g,removeOnLeave:f,ref:A},function($,K){var q=$.className,W=$.style;return he.createElement(C6,Kr({},t,{ref:e,title:i,ariaId:y,prefixCls:n,holderRef:K,style:It(It(It({},W),r),N),className:pi(a,q)}))})});T6.displayName="Content";var Jee=function(e){var n=e.prefixCls,i=e.style,r=e.visible,a=e.maskProps,u=e.motionName,l=e.className;return he.createElement(N_,{key:"mask",visible:r,motionName:u,leavedClassName:"".concat(n,"-mask-hidden")},function(f,g){var y=f.className,S=f.style;return he.createElement("div",Kr({ref:g,style:It(It({},S),i),className:pi("".concat(n,"-mask"),y,l)},a))})},Qee=function(e){var n=e.prefixCls,i=n===void 0?"rc-dialog":n,r=e.zIndex,a=e.visible,u=a===void 0?!1:a,l=e.keyboard,f=l===void 0?!0:l,g=e.focusTriggerAfterClose,y=g===void 0?!0:g,S=e.wrapStyle,b=e.wrapClassName,A=e.wrapProps,I=e.onClose,D=e.afterOpenChange,L=e.afterClose,P=e.transitionName,N=e.animation,B=e.closable,$=B===void 0?!0:B,K=e.mask,q=K===void 0?!0:K,W=e.maskTransitionName,ie=e.maskAnimation,Z=e.maskClosable,X=Z===void 0?!0:Z,se=e.maskStyle,De=e.maskProps,Se=e.rootClassName,Me=e.classNames,Ye=e.styles,ye=he.useRef(),Ce=he.useRef(),ge=he.useRef(),Be=he.useState(u),Ze=Xn(Be,2),je=Ze[0],wt=Ze[1],Xt=Xee();function Ke(){OP(Ce.current,document.activeElement)||(ye.current=document.activeElement)}function _t(){if(!OP(Ce.current,document.activeElement)){var Cn;(Cn=ge.current)===null||Cn===void 0||Cn.focus()}}function zt(Cn){if(Cn)_t();else{if(wt(!1),q&&ye.current&&y){try{ye.current.focus({preventScroll:!0})}catch{}ye.current=null}je&&(L==null||L())}D==null||D(Cn)}function Rt(Cn){I==null||I(Cn)}var fn=he.useRef(!1),Mn=he.useRef(),Bt=function(){clearTimeout(Mn.current),fn.current=!0},Kn=function(){Mn.current=setTimeout(function(){fn.current=!1})},Re=null;X&&(Re=function(Ue){fn.current?fn.current=!1:Ce.current===Ue.target&&Rt(Ue)});function Jn(Cn){if(f&&Cn.keyCode===jB.ESC){Cn.stopPropagation(),Rt(Cn);return}u&&Cn.keyCode===jB.TAB&&ge.current.changeActive(!Cn.shiftKey)}he.useEffect(function(){u&&(wt(!0),Ke())},[u]),he.useEffect(function(){return function(){clearTimeout(Mn.current)}},[]);var Ln=It(It(It({zIndex:r},S),Ye==null?void 0:Ye.wrapper),{},{display:je?null:"none"});return he.createElement("div",Kr({className:pi("".concat(i,"-root"),Se)},F3(e,{data:!0})),he.createElement(Jee,{prefixCls:i,visible:q&&u,motionName:S6(i,W,ie),style:It(It({zIndex:r},se),Ye==null?void 0:Ye.mask),maskProps:De,className:Me==null?void 0:Me.mask}),he.createElement("div",Kr({tabIndex:-1,onKeyDown:Jn,className:pi("".concat(i,"-wrap"),b,Me==null?void 0:Me.wrapper),ref:Ce,onClick:Re,style:Ln},A),he.createElement(T6,Kr({},e,{onMouseDown:Bt,onMouseUp:Kn,ref:ge,closable:$,ariaId:Xt,prefixCls:i,visible:u&&je,onClose:Rt,onVisibleChanged:zt,motionName:S6(i,P,N)}))))},A6=function(e){var n=e.visible,i=e.getContainer,r=e.forceRender,a=e.destroyOnClose,u=a===void 0?!1:a,l=e.afterClose,f=e.panelRef,g=he.useState(n),y=Xn(g,2),S=y[0],b=y[1],A=he.useMemo(function(){return{panel:f}},[f]);return he.useEffect(function(){n&&b(!0)},[n]),!r&&u&&!S?null:he.createElement(x6.Provider,{value:A},he.createElement(jee,{open:n||r||S,autoDestroy:!1,getContainer:i,autoLock:n||S},he.createElement(Qee,Kr({},e,{destroyOnClose:u,afterClose:function(){l==null||l(),b(!1)}}))))};A6.displayName="Dialog";var kp="RC_FORM_INTERNAL_HOOKS",mr=function(){Va(!1,"Can not find FormContext. Please make sure you wrap Field under Form.")},Pv=he.createContext({getFieldValue:mr,getFieldsValue:mr,getFieldError:mr,getFieldWarning:mr,getFieldsError:mr,isFieldsTouched:mr,isFieldTouched:mr,isFieldValidating:mr,isFieldsValidating:mr,resetFields:mr,setFields:mr,setFieldValue:mr,setFieldsValue:mr,validateFields:mr,submit:mr,getInternalHooks:function(){return mr(),{dispatch:mr,initEntityValue:mr,registerField:mr,useSubscribe:mr,setInitialValues:mr,destroyForm:mr,setCallbacks:mr,registerWatch:mr,getFields:mr,setValidateMessages:mr,setPreserve:mr,getInitialValue:mr}}}),HS=he.createContext(null);function X3(t){return t==null?[]:Array.isArray(t)?t:[t]}function ete(t){return t&&!!t._init}function Z3(){return{default:"Validation error on field %s",required:"%s is required",enum:"%s must be one of %s",whitespace:"%s cannot be empty",date:{format:"%s date %s is invalid for format %s",parse:"%s date could not be parsed, %s is invalid ",invalid:"%s date %s is invalid"},types:{string:"%s is not a %s",method:"%s is not a %s (function)",array:"%s is not an %s",object:"%s is not an %s",number:"%s is not a %s",date:"%s is not a %s",boolean:"%s is not a %s",integer:"%s is not an %s",float:"%s is not a %s",regexp:"%s is not a valid %s",email:"%s is not a valid %s",url:"%s is not a valid %s",hex:"%s is not a valid %s"},string:{len:"%s must be exactly %s characters",min:"%s must be at least %s characters",max:"%s cannot be longer than %s characters",range:"%s must be between %s and %s characters"},number:{len:"%s must equal %s",min:"%s cannot be less than %s",max:"%s cannot be greater than %s",range:"%s must be between %s and %s"},array:{len:"%s must be exactly %s in length",min:"%s cannot be less than %s in length",max:"%s cannot be greater than %s in length",range:"%s must be between %s and %s in length"},pattern:{mismatch:"%s value %s does not match pattern %s"},clone:function(){var e=JSON.parse(JSON.stringify(this));return e.clone=this.clone,e}}}var Y3=Z3();function tte(t){try{return Function.toString.call(t).indexOf("[native code]")!==-1}catch{return typeof t=="function"}}function nte(t,e,n){if(RP())return Reflect.construct.apply(null,arguments);var i=[null];i.push.apply(i,e);var r=new(t.bind.apply(t,i));return n&&T_(r,n.prototype),r}function K3(t){var e=typeof Map=="function"?new Map:void 0;return K3=function(i){if(i===null||!tte(i))return i;if(typeof i!="function")throw new TypeError("Super expression must either be null or a function");if(e!==void 0){if(e.has(i))return e.get(i);e.set(i,r)}function r(){return nte(i,arguments,A_(this).constructor)}return r.prototype=Object.create(i.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),T_(r,i)},K3(t)}var ite=/%[sdj%]/g,rte=function(){};typeof process<"u"&&process.env;function J3(t){if(!t||!t.length)return null;var e={};return t.forEach(function(n){var i=n.field;e[i]=e[i]||[],e[i].push(n)}),e}function Ka(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];var r=0,a=n.length;if(typeof t=="function")return t.apply(null,n);if(typeof t=="string"){var u=t.replace(ite,function(l){if(l==="%%")return"%";if(r>=a)return l;switch(l){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch{return"[Circular]"}break;default:return l}});return u}return t}function ste(t){return t==="string"||t==="url"||t==="hex"||t==="email"||t==="date"||t==="pattern"}function Rs(t,e){return!!(t==null||e==="array"&&Array.isArray(t)&&!t.length||ste(e)&&typeof t=="string"&&!t)}function ote(t,e,n){var i=[],r=0,a=t.length;function u(l){i.push.apply(i,Gn(l||[])),r++,r===a&&n(i)}t.forEach(function(l){e(l,u)})}function P6(t,e,n){var i=0,r=t.length;function a(u){if(u&&u.length){n(u);return}var l=i;i=i+1,l<r?e(t[l],a):n([])}a([])}function ate(t){var e=[];return Object.keys(t).forEach(function(n){e.push.apply(e,Gn(t[n]||[]))}),e}var I6=function(t){vv(n,t);var e=yv(n);function n(i,r){var a;return Ko(this,n),a=e.call(this,"Async Validation Error"),vt(bi(a),"errors",void 0),vt(bi(a),"fields",void 0),a.errors=i,a.fields=r,a}return Jo(n)}(K3(Error));function lte(t,e,n,i,r){if(e.first){var a=new Promise(function(b,A){var I=function(P){return i(P),P.length?A(new I6(P,J3(P))):b(r)},D=ate(t);P6(D,n,I)});return a.catch(function(b){return b}),a}var u=e.firstFields===!0?Object.keys(t):e.firstFields||[],l=Object.keys(t),f=l.length,g=0,y=[],S=new Promise(function(b,A){var I=function(L){if(y.push.apply(y,L),g++,g===f)return i(y),y.length?A(new I6(y,J3(y))):b(r)};l.length||(i(y),b(r)),l.forEach(function(D){var L=t[D];u.indexOf(D)!==-1?P6(L,n,I):ote(L,n,I)})});return S.catch(function(b){return b}),S}function cte(t){return!!(t&&t.message!==void 0)}function ute(t,e){for(var n=t,i=0;i<e.length;i++){if(n==null)return n;n=n[e[i]]}return n}function R6(t,e){return function(n){var i;return t.fullFields?i=ute(e,t.fullFields):i=e[n.field||t.fullField],cte(n)?(n.field=n.field||t.fullField,n.fieldValue=i,n):{message:typeof n=="function"?n():n,fieldValue:i,field:n.field||t.fullField}}}function L6(t,e){if(e){for(var n in e)if(e.hasOwnProperty(n)){var i=e[n];ai(i)==="object"&&ai(t[n])==="object"?t[n]=It(It({},t[n]),i):t[n]=i}}return t}var Iv="enum",hte=function(e,n,i,r,a){e[Iv]=Array.isArray(e[Iv])?e[Iv]:[],e[Iv].indexOf(n)===-1&&r.push(Ka(a.messages[Iv],e.fullField,e[Iv].join(", ")))},dte=function(e,n,i,r,a){if(e.pattern){if(e.pattern instanceof RegExp)e.pattern.lastIndex=0,e.pattern.test(n)||r.push(Ka(a.messages.pattern.mismatch,e.fullField,n,e.pattern));else if(typeof e.pattern=="string"){var u=new RegExp(e.pattern);u.test(n)||r.push(Ka(a.messages.pattern.mismatch,e.fullField,n,e.pattern))}}},fte=function(e,n,i,r,a){var u=typeof e.len=="number",l=typeof e.min=="number",f=typeof e.max=="number",g=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,y=n,S=null,b=typeof n=="number",A=typeof n=="string",I=Array.isArray(n);if(b?S="number":A?S="string":I&&(S="array"),!S)return!1;I&&(y=n.length),A&&(y=n.replace(g,"_").length),u?y!==e.len&&r.push(Ka(a.messages[S].len,e.fullField,e.len)):l&&!f&&y<e.min?r.push(Ka(a.messages[S].min,e.fullField,e.min)):f&&!l&&y>e.max?r.push(Ka(a.messages[S].max,e.fullField,e.max)):l&&f&&(y<e.min||y>e.max)&&r.push(Ka(a.messages[S].range,e.fullField,e.min,e.max))},k6=function(e,n,i,r,a,u){e.required&&(!i.hasOwnProperty(e.field)||Rs(n,u||e.type))&&r.push(Ka(a.messages.required,e.fullField))},GS;const pte=function(){if(GS)return GS;var t="[a-fA-F\\d:]",e=function(q){return q&&q.includeBoundaries?"(?:(?<=\\s|^)(?=".concat(t,")|(?<=").concat(t,")(?=\\s|$))"):""},n="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",i="[a-fA-F\\d]{1,4}",r=["(?:".concat(i,":){7}(?:").concat(i,"|:)"),"(?:".concat(i,":){6}(?:").concat(n,"|:").concat(i,"|:)"),"(?:".concat(i,":){5}(?::").concat(n,"|(?::").concat(i,"){1,2}|:)"),"(?:".concat(i,":){4}(?:(?::").concat(i,"){0,1}:").concat(n,"|(?::").concat(i,"){1,3}|:)"),"(?:".concat(i,":){3}(?:(?::").concat(i,"){0,2}:").concat(n,"|(?::").concat(i,"){1,4}|:)"),"(?:".concat(i,":){2}(?:(?::").concat(i,"){0,3}:").concat(n,"|(?::").concat(i,"){1,5}|:)"),"(?:".concat(i,":){1}(?:(?::").concat(i,"){0,4}:").concat(n,"|(?::").concat(i,"){1,6}|:)"),"(?::(?:(?::".concat(i,"){0,5}:").concat(n,"|(?::").concat(i,"){1,7}|:))")],a="(?:%[0-9a-zA-Z]{1,})?",u="(?:".concat(r.join("|"),")").concat(a),l=new RegExp("(?:^".concat(n,"$)|(?:^").concat(u,"$)")),f=new RegExp("^".concat(n,"$")),g=new RegExp("^".concat(u,"$")),y=function(q){return q&&q.exact?l:new RegExp("(?:".concat(e(q)).concat(n).concat(e(q),")|(?:").concat(e(q)).concat(u).concat(e(q),")"),"g")};y.v4=function(K){return K&&K.exact?f:new RegExp("".concat(e(K)).concat(n).concat(e(K)),"g")},y.v6=function(K){return K&&K.exact?g:new RegExp("".concat(e(K)).concat(u).concat(e(K)),"g")};var S="(?:(?:[a-z]+:)?//)",b="(?:\\S+(?::\\S*)?@)?",A=y.v4().source,I=y.v6().source,D="(?:(?:[a-z\\u00a1-\\uffff0-9][-_]*)*[a-z\\u00a1-\\uffff0-9]+)",L="(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*",P="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))",N="(?::\\d{2,5})?",B='(?:[/?#][^\\s"]*)?',$="(?:".concat(S,"|www\\.)").concat(b,"(?:localhost|").concat(A,"|").concat(I,"|").concat(D).concat(L).concat(P,")").concat(N).concat(B);return GS=new RegExp("(?:^".concat($,"$)"),"i"),GS};var D6={email:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+\.)+[a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}))$/,hex:/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i},G_={integer:function(e){return G_.number(e)&&parseInt(e,10)===e},float:function(e){return G_.number(e)&&!G_.integer(e)},array:function(e){return Array.isArray(e)},regexp:function(e){if(e instanceof RegExp)return!0;try{return!!new RegExp(e)}catch{return!1}},date:function(e){return typeof e.getTime=="function"&&typeof e.getMonth=="function"&&typeof e.getYear=="function"&&!isNaN(e.getTime())},number:function(e){return isNaN(e)?!1:typeof e=="number"},object:function(e){return ai(e)==="object"&&!G_.array(e)},method:function(e){return typeof e=="function"},email:function(e){return typeof e=="string"&&e.length<=320&&!!e.match(D6.email)},url:function(e){return typeof e=="string"&&e.length<=2048&&!!e.match(pte())},hex:function(e){return typeof e=="string"&&!!e.match(D6.hex)}},mte=function(e,n,i,r,a){if(e.required&&n===void 0){k6(e,n,i,r,a);return}var u=["integer","float","array","regexp","object","method","email","number","date","url","hex"],l=e.type;u.indexOf(l)>-1?G_[l](n)||r.push(Ka(a.messages.types[l],e.fullField,e.type)):l&&ai(n)!==e.type&&r.push(Ka(a.messages.types[l],e.fullField,e.type))},gte=function(e,n,i,r,a){(/^\s+$/.test(n)||n==="")&&r.push(Ka(a.messages.whitespace,e.fullField))};const Ii={required:k6,whitespace:gte,type:mte,range:fte,enum:hte,pattern:dte};var vte=function(e,n,i,r,a){var u=[],l=e.required||!e.required&&r.hasOwnProperty(e.field);if(l){if(Rs(n)&&!e.required)return i();Ii.required(e,n,r,u,a)}i(u)},yte=function(e,n,i,r,a){var u=[],l=e.required||!e.required&&r.hasOwnProperty(e.field);if(l){if(n==null&&!e.required)return i();Ii.required(e,n,r,u,a,"array"),n!=null&&(Ii.type(e,n,r,u,a),Ii.range(e,n,r,u,a))}i(u)},_te=function(e,n,i,r,a){var u=[],l=e.required||!e.required&&r.hasOwnProperty(e.field);if(l){if(Rs(n)&&!e.required)return i();Ii.required(e,n,r,u,a),n!==void 0&&Ii.type(e,n,r,u,a)}i(u)},xte=function(e,n,i,r,a){var u=[],l=e.required||!e.required&&r.hasOwnProperty(e.field);if(l){if(Rs(n,"date")&&!e.required)return i();if(Ii.required(e,n,r,u,a),!Rs(n,"date")){var f;n instanceof Date?f=n:f=new Date(n),Ii.type(e,f,r,u,a),f&&Ii.range(e,f.getTime(),r,u,a)}}i(u)},bte="enum",wte=function(e,n,i,r,a){var u=[],l=e.required||!e.required&&r.hasOwnProperty(e.field);if(l){if(Rs(n)&&!e.required)return i();Ii.required(e,n,r,u,a),n!==void 0&&Ii[bte](e,n,r,u,a)}i(u)},Ste=function(e,n,i,r,a){var u=[],l=e.required||!e.required&&r.hasOwnProperty(e.field);if(l){if(Rs(n)&&!e.required)return i();Ii.required(e,n,r,u,a),n!==void 0&&(Ii.type(e,n,r,u,a),Ii.range(e,n,r,u,a))}i(u)},Ete=function(e,n,i,r,a){var u=[],l=e.required||!e.required&&r.hasOwnProperty(e.field);if(l){if(Rs(n)&&!e.required)return i();Ii.required(e,n,r,u,a),n!==void 0&&(Ii.type(e,n,r,u,a),Ii.range(e,n,r,u,a))}i(u)},Mte=function(e,n,i,r,a){var u=[],l=e.required||!e.required&&r.hasOwnProperty(e.field);if(l){if(Rs(n)&&!e.required)return i();Ii.required(e,n,r,u,a),n!==void 0&&Ii.type(e,n,r,u,a)}i(u)},Cte=function(e,n,i,r,a){var u=[],l=e.required||!e.required&&r.hasOwnProperty(e.field);if(l){if(n===""&&(n=void 0),Rs(n)&&!e.required)return i();Ii.required(e,n,r,u,a),n!==void 0&&(Ii.type(e,n,r,u,a),Ii.range(e,n,r,u,a))}i(u)},Tte=function(e,n,i,r,a){var u=[],l=e.required||!e.required&&r.hasOwnProperty(e.field);if(l){if(Rs(n)&&!e.required)return i();Ii.required(e,n,r,u,a),n!==void 0&&Ii.type(e,n,r,u,a)}i(u)},Ate=function(e,n,i,r,a){var u=[],l=e.required||!e.required&&r.hasOwnProperty(e.field);if(l){if(Rs(n,"string")&&!e.required)return i();Ii.required(e,n,r,u,a),Rs(n,"string")||Ii.pattern(e,n,r,u,a)}i(u)},Pte=function(e,n,i,r,a){var u=[],l=e.required||!e.required&&r.hasOwnProperty(e.field);if(l){if(Rs(n)&&!e.required)return i();Ii.required(e,n,r,u,a),Rs(n)||Ii.type(e,n,r,u,a)}i(u)},Ite=function(e,n,i,r,a){var u=[],l=Array.isArray(n)?"array":ai(n);Ii.required(e,n,r,u,a,l),i(u)},Rte=function(e,n,i,r,a){var u=[],l=e.required||!e.required&&r.hasOwnProperty(e.field);if(l){if(Rs(n,"string")&&!e.required)return i();Ii.required(e,n,r,u,a,"string"),Rs(n,"string")||(Ii.type(e,n,r,u,a),Ii.range(e,n,r,u,a),Ii.pattern(e,n,r,u,a),e.whitespace===!0&&Ii.whitespace(e,n,r,u,a))}i(u)},Q3=function(e,n,i,r,a){var u=e.type,l=[],f=e.required||!e.required&&r.hasOwnProperty(e.field);if(f){if(Rs(n,u)&&!e.required)return i();Ii.required(e,n,r,l,a,u),Rs(n,u)||Ii.type(e,n,r,l,a)}i(l)};const W_={string:Rte,method:Mte,number:Cte,boolean:_te,regexp:Pte,integer:Ete,float:Ste,array:yte,object:Tte,enum:wte,pattern:Ate,date:xte,url:Q3,hex:Q3,email:Q3,required:Ite,any:vte};var j_=function(){function t(e){Ko(this,t),vt(this,"rules",null),vt(this,"_messages",Y3),this.define(e)}return Jo(t,[{key:"define",value:function(n){var i=this;if(!n)throw new Error("Cannot configure a schema with no rules");if(ai(n)!=="object"||Array.isArray(n))throw new Error("Rules must be an object");this.rules={},Object.keys(n).forEach(function(r){var a=n[r];i.rules[r]=Array.isArray(a)?a:[a]})}},{key:"messages",value:function(n){return n&&(this._messages=L6(Z3(),n)),this._messages}},{key:"validate",value:function(n){var i=this,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){},u=n,l=r,f=a;if(typeof l=="function"&&(f=l,l={}),!this.rules||Object.keys(this.rules).length===0)return f&&f(null,u),Promise.resolve(u);function g(I){var D=[],L={};function P(B){if(Array.isArray(B)){var $;D=($=D).concat.apply($,Gn(B))}else D.push(B)}for(var N=0;N<I.length;N++)P(I[N]);D.length?(L=J3(D),f(D,L)):f(null,u)}if(l.messages){var y=this.messages();y===Y3&&(y=Z3()),L6(y,l.messages),l.messages=y}else l.messages=this.messages();var S={},b=l.keys||Object.keys(this.rules);b.forEach(function(I){var D=i.rules[I],L=u[I];D.forEach(function(P){var N=P;typeof N.transform=="function"&&(u===n&&(u=It({},u)),L=u[I]=N.transform(L),L!=null&&(N.type=N.type||(Array.isArray(L)?"array":ai(L)))),typeof N=="function"?N={validator:N}:N=It({},N),N.validator=i.getValidationMethod(N),N.validator&&(N.field=I,N.fullField=N.fullField||I,N.type=i.getType(N),S[I]=S[I]||[],S[I].push({rule:N,value:L,source:u,field:I}))})});var A={};return lte(S,l,function(I,D){var L=I.rule,P=(L.type==="object"||L.type==="array")&&(ai(L.fields)==="object"||ai(L.defaultField)==="object");P=P&&(L.required||!L.required&&I.value),L.field=I.field;function N(W,ie){return It(It({},ie),{},{fullField:"".concat(L.fullField,".").concat(W),fullFields:L.fullFields?[].concat(Gn(L.fullFields),[W]):[W]})}function B(){var W=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],ie=Array.isArray(W)?W:[W];!l.suppressWarning&&ie.length&&t.warning("async-validator:",ie),ie.length&&L.message!==void 0&&(ie=[].concat(L.message));var Z=ie.map(R6(L,u));if(l.first&&Z.length)return A[L.field]=1,D(Z);if(!P)D(Z);else{if(L.required&&!I.value)return L.message!==void 0?Z=[].concat(L.message).map(R6(L,u)):l.error&&(Z=[l.error(L,Ka(l.messages.required,L.field))]),D(Z);var X={};L.defaultField&&Object.keys(I.value).map(function(Se){X[Se]=L.defaultField}),X=It(It({},X),I.rule.fields);var se={};Object.keys(X).forEach(function(Se){var Me=X[Se],Ye=Array.isArray(Me)?Me:[Me];se[Se]=Ye.map(N.bind(null,Se))});var De=new t(se);De.messages(l.messages),I.rule.options&&(I.rule.options.messages=l.messages,I.rule.options.error=l.error),De.validate(I.value,I.rule.options||l,function(Se){var Me=[];Z&&Z.length&&Me.push.apply(Me,Gn(Z)),Se&&Se.length&&Me.push.apply(Me,Gn(Se)),D(Me.length?Me:null)})}}var $;if(L.asyncValidator)$=L.asyncValidator(L,I.value,B,I.source,l);else if(L.validator){try{$=L.validator(L,I.value,B,I.source,l)}catch(W){var K,q;(K=(q=console).error)===null||K===void 0||K.call(q,W),l.suppressValidatorError||setTimeout(function(){throw W},0),B(W.message)}$===!0?B():$===!1?B(typeof L.message=="function"?L.message(L.fullField||L.field):L.message||"".concat(L.fullField||L.field," fails")):$ instanceof Array?B($):$ instanceof Error&&B($.message)}$&&$.then&&$.then(function(){return B()},function(W){return B(W)})},function(I){g(I)},u)}},{key:"getType",value:function(n){if(n.type===void 0&&n.pattern instanceof RegExp&&(n.type="pattern"),typeof n.validator!="function"&&n.type&&!W_.hasOwnProperty(n.type))throw new Error(Ka("Unknown rule type %s",n.type));return n.type||"string"}},{key:"getValidationMethod",value:function(n){if(typeof n.validator=="function")return n.validator;var i=Object.keys(n),r=i.indexOf("message");return r!==-1&&i.splice(r,1),i.length===1&&i[0]==="required"?W_.required:W_[this.getType(n)]||void 0}}]),t}();vt(j_,"register",function(e,n){if(typeof n!="function")throw new Error("Cannot register a validator by type, validator is not a function");W_[e]=n}),vt(j_,"warning",rte),vt(j_,"messages",Y3),vt(j_,"validators",W_);var Ja="'${name}' is not a valid ${type}",O6={default:"Validation error on field '${name}'",required:"'${name}' is required",enum:"'${name}' must be one of [${enum}]",whitespace:"'${name}' cannot be empty",date:{format:"'${name}' is invalid for format date",parse:"'${name}' could not be parsed as date",invalid:"'${name}' is invalid date"},types:{string:Ja,method:Ja,array:Ja,object:Ja,number:Ja,date:Ja,boolean:Ja,integer:Ja,float:Ja,regexp:Ja,email:Ja,url:Ja,hex:Ja},string:{len:"'${name}' must be exactly ${len} characters",min:"'${name}' must be at least ${min} characters",max:"'${name}' cannot be longer than ${max} characters",range:"'${name}' must be between ${min} and ${max} characters"},number:{len:"'${name}' must equal ${len}",min:"'${name}' cannot be less than ${min}",max:"'${name}' cannot be greater than ${max}",range:"'${name}' must be between ${min} and ${max}"},array:{len:"'${name}' must be exactly ${len} in length",min:"'${name}' cannot be less than ${min} in length",max:"'${name}' cannot be greater than ${max} in length",range:"'${name}' must be between ${min} and ${max} in length"},pattern:{mismatch:"'${name}' does not match pattern ${pattern}"}},F6=j_;function Lte(t,e){return t.replace(/\$\{\w+\}/g,function(n){var i=n.slice(2,-1);return e[i]})}var z6="CODE_LOGIC_ERROR";function eI(t,e,n,i,r){return tI.apply(this,arguments)}function tI(){return tI=Lp(ea().mark(function t(e,n,i,r,a){var u,l,f,g,y,S,b,A,I;return ea().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return u=It({},i),delete u.ruleIndex,F6.warning=function(){},u.validator&&(l=u.validator,u.validator=function(){try{return l.apply(void 0,arguments)}catch(P){return console.error(P),Promise.reject(z6)}}),f=null,u&&u.type==="array"&&u.defaultField&&(f=u.defaultField,delete u.defaultField),g=new F6(vt({},e,[u])),y=Sv(O6,r.validateMessages),g.messages(y),S=[],L.prev=10,L.next=13,Promise.resolve(g.validate(vt({},e,n),It({},r)));case 13:L.next=18;break;case 15:L.prev=15,L.t0=L.catch(10),L.t0.errors&&(S=L.t0.errors.map(function(P,N){var B=P.message,$=B===z6?y.default:B;return he.isValidElement($)?he.cloneElement($,{key:"error_".concat(N)}):$}));case 18:if(!(!S.length&&f)){L.next=23;break}return L.next=21,Promise.all(n.map(function(P,N){return eI("".concat(e,".").concat(N),P,f,r,a)}));case 21:return b=L.sent,L.abrupt("return",b.reduce(function(P,N){return[].concat(Gn(P),Gn(N))},[]));case 23:return A=It(It({},i),{},{name:e,enum:(i.enum||[]).join(", ")},a),I=S.map(function(P){return typeof P=="string"?Lte(P,A):P}),L.abrupt("return",I);case 26:case"end":return L.stop()}},t,null,[[10,15]])})),tI.apply(this,arguments)}function kte(t,e,n,i,r,a){var u=t.join("."),l=n.map(function(y,S){var b=y.validator,A=It(It({},y),{},{ruleIndex:S});return b&&(A.validator=function(I,D,L){var P=!1,N=function(){for(var K=arguments.length,q=new Array(K),W=0;W<K;W++)q[W]=arguments[W];Promise.resolve().then(function(){Va(!P,"Your validator function has already return a promise. `callback` will be ignored."),P||L.apply(void 0,q)})},B=b(I,D,N);P=B&&typeof B.then=="function"&&typeof B.catch=="function",Va(P,"`callback` is deprecated. Please return a promise instead."),P&&B.then(function(){L()}).catch(function($){L($||" ")})}),A}).sort(function(y,S){var b=y.warningOnly,A=y.ruleIndex,I=S.warningOnly,D=S.ruleIndex;return!!b==!!I?A-D:b?1:-1}),f;if(r===!0)f=new Promise(function(){var y=Lp(ea().mark(function S(b,A){var I,D,L;return ea().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:I=0;case 1:if(!(I<l.length)){N.next=12;break}return D=l[I],N.next=5,eI(u,e,D,i,a);case 5:if(L=N.sent,!L.length){N.next=9;break}return A([{errors:L,rule:D}]),N.abrupt("return");case 9:I+=1,N.next=1;break;case 12:b([]);case 13:case"end":return N.stop()}},S)}));return function(S,b){return y.apply(this,arguments)}}());else{var g=l.map(function(y){return eI(u,e,y,i,a).then(function(S){return{errors:S,rule:y}})});f=(r?Ote(g):Dte(g)).then(function(y){return Promise.reject(y)})}return f.catch(function(y){return y}),f}function Dte(t){return nI.apply(this,arguments)}function nI(){return nI=Lp(ea().mark(function t(e){return ea().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",Promise.all(e).then(function(r){var a,u=(a=[]).concat.apply(a,Gn(r));return u}));case 1:case"end":return i.stop()}},t)})),nI.apply(this,arguments)}function Ote(t){return iI.apply(this,arguments)}function iI(){return iI=Lp(ea().mark(function t(e){var n;return ea().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n=0,r.abrupt("return",new Promise(function(a){e.forEach(function(u){u.then(function(l){l.errors.length&&a([l]),n+=1,n===e.length&&a([])})})}));case 2:case"end":return r.stop()}},t)})),iI.apply(this,arguments)}function os(t){return X3(t)}function N6(t,e){var n={};return e.forEach(function(i){var r=au(t,i);n=wc(n,i,r)}),n}function Rv(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return t&&t.some(function(i){return B6(e,i,n)})}function B6(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return!t||!e||!n&&t.length!==e.length?!1:e.every(function(i,r){return t[r]===i})}function Fte(t,e){if(t===e)return!0;if(!t&&e||t&&!e||!t||!e||ai(t)!=="object"||ai(e)!=="object")return!1;var n=Object.keys(t),i=Object.keys(e),r=new Set([].concat(n,i));return Gn(r).every(function(a){var u=t[a],l=e[a];return typeof u=="function"&&typeof l=="function"?!0:u===l})}function zte(t){var e=arguments.length<=1?void 0:arguments[1];return e&&e.target&&ai(e.target)==="object"&&t in e.target?e.target[t]:e}function U6(t,e,n){var i=t.length;if(e<0||e>=i||n<0||n>=i)return t;var r=t[e],a=e-n;return a>0?[].concat(Gn(t.slice(0,n)),[r],Gn(t.slice(n,e)),Gn(t.slice(e+1,i))):a<0?[].concat(Gn(t.slice(0,e)),Gn(t.slice(e+1,n+1)),[r],Gn(t.slice(n+1,i))):t}var Nte=["name"],Dl=[];function rI(t,e,n,i,r,a){return typeof t=="function"?t(e,n,"source"in a?{source:a.source}:{}):i!==r}var sI=function(t){vv(n,t);var e=yv(n);function n(i){var r;if(Ko(this,n),r=e.call(this,i),vt(bi(r),"state",{resetCount:0}),vt(bi(r),"cancelRegisterFunc",null),vt(bi(r),"mounted",!1),vt(bi(r),"touched",!1),vt(bi(r),"dirty",!1),vt(bi(r),"validatePromise",void 0),vt(bi(r),"prevValidating",void 0),vt(bi(r),"errors",Dl),vt(bi(r),"warnings",Dl),vt(bi(r),"cancelRegister",function(){var f=r.props,g=f.preserve,y=f.isListField,S=f.name;r.cancelRegisterFunc&&r.cancelRegisterFunc(y,g,os(S)),r.cancelRegisterFunc=null}),vt(bi(r),"getNamePath",function(){var f=r.props,g=f.name,y=f.fieldContext,S=y.prefixName,b=S===void 0?[]:S;return g!==void 0?[].concat(Gn(b),Gn(g)):[]}),vt(bi(r),"getRules",function(){var f=r.props,g=f.rules,y=g===void 0?[]:g,S=f.fieldContext;return y.map(function(b){return typeof b=="function"?b(S):b})}),vt(bi(r),"refresh",function(){r.mounted&&r.setState(function(f){var g=f.resetCount;return{resetCount:g+1}})}),vt(bi(r),"metaCache",null),vt(bi(r),"triggerMetaEvent",function(f){var g=r.props.onMetaChange;if(g){var y=It(It({},r.getMeta()),{},{destroy:f});NP(r.metaCache,y)||g(y),r.metaCache=y}else r.metaCache=null}),vt(bi(r),"onStoreChange",function(f,g,y){var S=r.props,b=S.shouldUpdate,A=S.dependencies,I=A===void 0?[]:A,D=S.onReset,L=y.store,P=r.getNamePath(),N=r.getValue(f),B=r.getValue(L),$=g&&Rv(g,P);switch(y.type==="valueUpdate"&&y.source==="external"&&!NP(N,B)&&(r.touched=!0,r.dirty=!0,r.validatePromise=null,r.errors=Dl,r.warnings=Dl,r.triggerMetaEvent()),y.type){case"reset":if(!g||$){r.touched=!1,r.dirty=!1,r.validatePromise=void 0,r.errors=Dl,r.warnings=Dl,r.triggerMetaEvent(),D==null||D(),r.refresh();return}break;case"remove":{if(b&&rI(b,f,L,N,B,y)){r.reRender();return}break}case"setField":{var K=y.data;if($){"touched"in K&&(r.touched=K.touched),"validating"in K&&!("originRCField"in K)&&(r.validatePromise=K.validating?Promise.resolve([]):null),"errors"in K&&(r.errors=K.errors||Dl),"warnings"in K&&(r.warnings=K.warnings||Dl),r.dirty=!0,r.triggerMetaEvent(),r.reRender();return}else if("value"in K&&Rv(g,P,!0)){r.reRender();return}if(b&&!P.length&&rI(b,f,L,N,B,y)){r.reRender();return}break}case"dependenciesUpdate":{var q=I.map(os);if(q.some(function(W){return Rv(y.relatedFields,W)})){r.reRender();return}break}default:if($||(!I.length||P.length||b)&&rI(b,f,L,N,B,y)){r.reRender();return}break}b===!0&&r.reRender()}),vt(bi(r),"validateRules",function(f){var g=r.getNamePath(),y=r.getValue(),S=f||{},b=S.triggerName,A=S.validateOnly,I=A===void 0?!1:A,D=Promise.resolve().then(Lp(ea().mark(function L(){var P,N,B,$,K,q,W;return ea().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:if(r.mounted){Z.next=2;break}return Z.abrupt("return",[]);case 2:if(P=r.props,N=P.validateFirst,B=N===void 0?!1:N,$=P.messageVariables,K=P.validateDebounce,q=r.getRules(),b&&(q=q.filter(function(X){return X}).filter(function(X){var se=X.validateTrigger;if(!se)return!0;var De=X3(se);return De.includes(b)})),!(K&&b)){Z.next=10;break}return Z.next=8,new Promise(function(X){setTimeout(X,K)});case 8:if(r.validatePromise===D){Z.next=10;break}return Z.abrupt("return",[]);case 10:return W=kte(g,y,q,f,B,$),W.catch(function(X){return X}).then(function(){var X=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Dl;if(r.validatePromise===D){var se;r.validatePromise=null;var De=[],Se=[];(se=X.forEach)===null||se===void 0||se.call(X,function(Me){var Ye=Me.rule.warningOnly,ye=Me.errors,Ce=ye===void 0?Dl:ye;Ye?Se.push.apply(Se,Gn(Ce)):De.push.apply(De,Gn(Ce))}),r.errors=De,r.warnings=Se,r.triggerMetaEvent(),r.reRender()}}),Z.abrupt("return",W);case 13:case"end":return Z.stop()}},L)})));return I||(r.validatePromise=D,r.dirty=!0,r.errors=Dl,r.warnings=Dl,r.triggerMetaEvent(),r.reRender()),D}),vt(bi(r),"isFieldValidating",function(){return!!r.validatePromise}),vt(bi(r),"isFieldTouched",function(){return r.touched}),vt(bi(r),"isFieldDirty",function(){if(r.dirty||r.props.initialValue!==void 0)return!0;var f=r.props.fieldContext,g=f.getInternalHooks(kp),y=g.getInitialValue;return y(r.getNamePath())!==void 0}),vt(bi(r),"getErrors",function(){return r.errors}),vt(bi(r),"getWarnings",function(){return r.warnings}),vt(bi(r),"isListField",function(){return r.props.isListField}),vt(bi(r),"isList",function(){return r.props.isList}),vt(bi(r),"isPreserve",function(){return r.props.preserve}),vt(bi(r),"getMeta",function(){r.prevValidating=r.isFieldValidating();var f={touched:r.isFieldTouched(),validating:r.prevValidating,errors:r.errors,warnings:r.warnings,name:r.getNamePath(),validated:r.validatePromise===null};return f}),vt(bi(r),"getOnlyChild",function(f){if(typeof f=="function"){var g=r.getMeta();return It(It({},r.getOnlyChild(f(r.getControlled(),g,r.props.fieldContext))),{},{isFunction:!0})}var y=_T(f);return y.length!==1||!he.isValidElement(y[0])?{child:y,isFunction:!1}:{child:y[0],isFunction:!1}}),vt(bi(r),"getValue",function(f){var g=r.props.fieldContext.getFieldsValue,y=r.getNamePath();return au(f||g(!0),y)}),vt(bi(r),"getControlled",function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},g=r.props,y=g.name,S=g.trigger,b=g.validateTrigger,A=g.getValueFromEvent,I=g.normalize,D=g.valuePropName,L=g.getValueProps,P=g.fieldContext,N=b!==void 0?b:P.validateTrigger,B=r.getNamePath(),$=P.getInternalHooks,K=P.getFieldsValue,q=$(kp),W=q.dispatch,ie=r.getValue(),Z=L||function(Me){return vt({},D,Me)},X=f[S],se=y!==void 0?Z(ie):{},De=It(It({},f),se);De[S]=function(){r.touched=!0,r.dirty=!0,r.triggerMetaEvent();for(var Me,Ye=arguments.length,ye=new Array(Ye),Ce=0;Ce<Ye;Ce++)ye[Ce]=arguments[Ce];A?Me=A.apply(void 0,ye):Me=zte.apply(void 0,[D].concat(ye)),I&&(Me=I(Me,ie,K(!0))),W({type:"updateValue",namePath:B,value:Me}),X&&X.apply(void 0,ye)};var Se=X3(N||[]);return Se.forEach(function(Me){var Ye=De[Me];De[Me]=function(){Ye&&Ye.apply(void 0,arguments);var ye=r.props.rules;ye&&ye.length&&W({type:"validateField",namePath:B,triggerName:Me})}}),De}),i.fieldContext){var a=i.fieldContext.getInternalHooks,u=a(kp),l=u.initEntityValue;l(bi(r))}return r}return Jo(n,[{key:"componentDidMount",value:function(){var r=this.props,a=r.shouldUpdate,u=r.fieldContext;if(this.mounted=!0,u){var l=u.getInternalHooks,f=l(kp),g=f.registerField;this.cancelRegisterFunc=g(this)}a===!0&&this.reRender()}},{key:"componentWillUnmount",value:function(){this.cancelRegister(),this.triggerMetaEvent(!0),this.mounted=!1}},{key:"reRender",value:function(){this.mounted&&this.forceUpdate()}},{key:"render",value:function(){var r=this.state.resetCount,a=this.props.children,u=this.getOnlyChild(a),l=u.child,f=u.isFunction,g;return f?g=l:he.isValidElement(l)?g=he.cloneElement(l,this.getControlled(l.props)):(Va(!l,"`children` of Field is not validate ReactElement."),g=l),he.createElement(he.Fragment,{key:r},g)}}]),n}(he.Component);vt(sI,"contextType",Pv),vt(sI,"defaultProps",{trigger:"onChange",valuePropName:"value"});function V6(t){var e=t.name,n=Xd(t,Nte),i=he.useContext(Pv),r=he.useContext(HS),a=e!==void 0?os(e):void 0,u="keep";return n.isListField||(u="_".concat((a||[]).join("_"))),he.createElement(sI,Kr({key:u,name:a,isListField:!!r},n,{fieldContext:i}))}function Bte(t){var e=t.name,n=t.initialValue,i=t.children,r=t.rules,a=t.validateTrigger,u=t.isListField,l=he.useContext(Pv),f=he.useContext(HS),g=he.useRef({keys:[],id:0}),y=g.current,S=he.useMemo(function(){var D=os(l.prefixName)||[];return[].concat(Gn(D),Gn(os(e)))},[l.prefixName,e]),b=he.useMemo(function(){return It(It({},l),{},{prefixName:S})},[l,S]),A=he.useMemo(function(){return{getKey:function(L){var P=S.length,N=L[P];return[y.keys[N],L.slice(P+1)]}}},[S]);if(typeof i!="function")return Va(!1,"Form.List only accepts function as children."),null;var I=function(L,P,N){var B=N.source;return B==="internal"?!1:L!==P};return he.createElement(HS.Provider,{value:A},he.createElement(Pv.Provider,{value:b},he.createElement(V6,{name:[],shouldUpdate:I,rules:r,validateTrigger:a,initialValue:n,isList:!0,isListField:u??!!f},function(D,L){var P=D.value,N=P===void 0?[]:P,B=D.onChange,$=l.getFieldValue,K=function(){var Z=$(S||[]);return Z||[]},q={add:function(Z,X){var se=K();X>=0&&X<=se.length?(y.keys=[].concat(Gn(y.keys.slice(0,X)),[y.id],Gn(y.keys.slice(X))),B([].concat(Gn(se.slice(0,X)),[Z],Gn(se.slice(X))))):(y.keys=[].concat(Gn(y.keys),[y.id]),B([].concat(Gn(se),[Z]))),y.id+=1},remove:function(Z){var X=K(),se=new Set(Array.isArray(Z)?Z:[Z]);se.size<=0||(y.keys=y.keys.filter(function(De,Se){return!se.has(Se)}),B(X.filter(function(De,Se){return!se.has(Se)})))},move:function(Z,X){if(Z!==X){var se=K();Z<0||Z>=se.length||X<0||X>=se.length||(y.keys=U6(y.keys,Z,X),B(U6(se,Z,X)))}}},W=N||[];return Array.isArray(W)||(W=[]),i(W.map(function(ie,Z){var X=y.keys[Z];return X===void 0&&(y.keys[Z]=y.id,X=y.keys[Z],y.id+=1),{name:Z,key:X,isListField:!0}}),q,L)})))}function Ute(t){var e=!1,n=t.length,i=[];return t.length?new Promise(function(r,a){t.forEach(function(u,l){u.catch(function(f){return e=!0,f}).then(function(f){n-=1,i[l]=f,!(n>0)&&(e&&a(i),r(i))})})}):Promise.resolve([])}var $6="__@field_split__";function oI(t){return t.map(function(e){return"".concat(ai(e),":").concat(e)}).join($6)}var Lv=function(){function t(){Ko(this,t),vt(this,"kvs",new Map)}return Jo(t,[{key:"set",value:function(n,i){this.kvs.set(oI(n),i)}},{key:"get",value:function(n){return this.kvs.get(oI(n))}},{key:"update",value:function(n,i){var r=this.get(n),a=i(r);a?this.set(n,a):this.delete(n)}},{key:"delete",value:function(n){this.kvs.delete(oI(n))}},{key:"map",value:function(n){return Gn(this.kvs.entries()).map(function(i){var r=Xn(i,2),a=r[0],u=r[1],l=a.split($6);return n({key:l.map(function(f){var g=f.match(/^([^:]*):(.*)$/),y=Xn(g,3),S=y[1],b=y[2];return S==="number"?Number(b):b}),value:u})})}},{key:"toJSON",value:function(){var n={};return this.map(function(i){var r=i.key,a=i.value;return n[r.join(".")]=a,null}),n}}]),t}(),Vte=["name"],$te=Jo(function t(e){var n=this;Ko(this,t),vt(this,"formHooked",!1),vt(this,"forceRootUpdate",void 0),vt(this,"subscribable",!0),vt(this,"store",{}),vt(this,"fieldEntities",[]),vt(this,"initialValues",{}),vt(this,"callbacks",{}),vt(this,"validateMessages",null),vt(this,"preserve",null),vt(this,"lastValidatePromise",null),vt(this,"getForm",function(){return{getFieldValue:n.getFieldValue,getFieldsValue:n.getFieldsValue,getFieldError:n.getFieldError,getFieldWarning:n.getFieldWarning,getFieldsError:n.getFieldsError,isFieldsTouched:n.isFieldsTouched,isFieldTouched:n.isFieldTouched,isFieldValidating:n.isFieldValidating,isFieldsValidating:n.isFieldsValidating,resetFields:n.resetFields,setFields:n.setFields,setFieldValue:n.setFieldValue,setFieldsValue:n.setFieldsValue,validateFields:n.validateFields,submit:n.submit,_init:!0,getInternalHooks:n.getInternalHooks}}),vt(this,"getInternalHooks",function(i){return i===kp?(n.formHooked=!0,{dispatch:n.dispatch,initEntityValue:n.initEntityValue,registerField:n.registerField,useSubscribe:n.useSubscribe,setInitialValues:n.setInitialValues,destroyForm:n.destroyForm,setCallbacks:n.setCallbacks,setValidateMessages:n.setValidateMessages,getFields:n.getFields,setPreserve:n.setPreserve,getInitialValue:n.getInitialValue,registerWatch:n.registerWatch}):(Va(!1,"`getInternalHooks` is internal usage. Should not call directly."),null)}),vt(this,"useSubscribe",function(i){n.subscribable=i}),vt(this,"prevWithoutPreserves",null),vt(this,"setInitialValues",function(i,r){if(n.initialValues=i||{},r){var a,u=Sv(i,n.store);(a=n.prevWithoutPreserves)===null||a===void 0||a.map(function(l){var f=l.key;u=wc(u,f,au(i,f))}),n.prevWithoutPreserves=null,n.updateStore(u)}}),vt(this,"destroyForm",function(i){if(i)n.updateStore({});else{var r=new Lv;n.getFieldEntities(!0).forEach(function(a){n.isMergedPreserve(a.isPreserve())||r.set(a.getNamePath(),!0)}),n.prevWithoutPreserves=r}}),vt(this,"getInitialValue",function(i){var r=au(n.initialValues,i);return i.length?Sv(r):r}),vt(this,"setCallbacks",function(i){n.callbacks=i}),vt(this,"setValidateMessages",function(i){n.validateMessages=i}),vt(this,"setPreserve",function(i){n.preserve=i}),vt(this,"watchList",[]),vt(this,"registerWatch",function(i){return n.watchList.push(i),function(){n.watchList=n.watchList.filter(function(r){return r!==i})}}),vt(this,"notifyWatch",function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];if(n.watchList.length){var r=n.getFieldsValue(),a=n.getFieldsValue(!0);n.watchList.forEach(function(u){u(r,a,i)})}}),vt(this,"timeoutId",null),vt(this,"warningUnhooked",function(){}),vt(this,"updateStore",function(i){n.store=i}),vt(this,"getFieldEntities",function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return i?n.fieldEntities.filter(function(r){return r.getNamePath().length}):n.fieldEntities}),vt(this,"getFieldsMap",function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=new Lv;return n.getFieldEntities(i).forEach(function(a){var u=a.getNamePath();r.set(u,a)}),r}),vt(this,"getFieldEntitiesForNamePathList",function(i){if(!i)return n.getFieldEntities(!0);var r=n.getFieldsMap(!0);return i.map(function(a){var u=os(a);return r.get(u)||{INVALIDATE_NAME_PATH:os(a)}})}),vt(this,"getFieldsValue",function(i,r){n.warningUnhooked();var a,u,l;if(i===!0||Array.isArray(i)?(a=i,u=r):i&&ai(i)==="object"&&(l=i.strict,u=i.filter),a===!0&&!u)return n.store;var f=n.getFieldEntitiesForNamePathList(Array.isArray(a)?a:null),g=[];return f.forEach(function(y){var S,b,A="INVALIDATE_NAME_PATH"in y?y.INVALIDATE_NAME_PATH:y.getNamePath();if(l){var I,D;if((I=(D=y).isList)!==null&&I!==void 0&&I.call(D))return}else if(!a&&(S=(b=y).isListField)!==null&&S!==void 0&&S.call(b))return;if(!u)g.push(A);else{var L="getMeta"in y?y.getMeta():null;u(L)&&g.push(A)}}),N6(n.store,g.map(os))}),vt(this,"getFieldValue",function(i){n.warningUnhooked();var r=os(i);return au(n.store,r)}),vt(this,"getFieldsError",function(i){n.warningUnhooked();var r=n.getFieldEntitiesForNamePathList(i);return r.map(function(a,u){return a&&!("INVALIDATE_NAME_PATH"in a)?{name:a.getNamePath(),errors:a.getErrors(),warnings:a.getWarnings()}:{name:os(i[u]),errors:[],warnings:[]}})}),vt(this,"getFieldError",function(i){n.warningUnhooked();var r=os(i),a=n.getFieldsError([r])[0];return a.errors}),vt(this,"getFieldWarning",function(i){n.warningUnhooked();var r=os(i),a=n.getFieldsError([r])[0];return a.warnings}),vt(this,"isFieldsTouched",function(){n.warningUnhooked();for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];var u=r[0],l=r[1],f,g=!1;r.length===0?f=null:r.length===1?Array.isArray(u)?(f=u.map(os),g=!1):(f=null,g=u):(f=u.map(os),g=l);var y=n.getFieldEntities(!0),S=function(L){return L.isFieldTouched()};if(!f)return g?y.every(function(D){return S(D)||D.isList()}):y.some(S);var b=new Lv;f.forEach(function(D){b.set(D,[])}),y.forEach(function(D){var L=D.getNamePath();f.forEach(function(P){P.every(function(N,B){return L[B]===N})&&b.update(P,function(N){return[].concat(Gn(N),[D])})})});var A=function(L){return L.some(S)},I=b.map(function(D){var L=D.value;return L});return g?I.every(A):I.some(A)}),vt(this,"isFieldTouched",function(i){return n.warningUnhooked(),n.isFieldsTouched([i])}),vt(this,"isFieldsValidating",function(i){n.warningUnhooked();var r=n.getFieldEntities();if(!i)return r.some(function(u){return u.isFieldValidating()});var a=i.map(os);return r.some(function(u){var l=u.getNamePath();return Rv(a,l)&&u.isFieldValidating()})}),vt(this,"isFieldValidating",function(i){return n.warningUnhooked(),n.isFieldsValidating([i])}),vt(this,"resetWithFieldInitialValue",function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=new Lv,a=n.getFieldEntities(!0);a.forEach(function(f){var g=f.props.initialValue,y=f.getNamePath();if(g!==void 0){var S=r.get(y)||new Set;S.add({entity:f,value:g}),r.set(y,S)}});var u=function(g){g.forEach(function(y){var S=y.props.initialValue;if(S!==void 0){var b=y.getNamePath(),A=n.getInitialValue(b);if(A!==void 0)Va(!1,"Form already set 'initialValues' with path '".concat(b.join("."),"'. Field can not overwrite it."));else{var I=r.get(b);if(I&&I.size>1)Va(!1,"Multiple Field with path '".concat(b.join("."),"' set 'initialValue'. Can not decide which one to pick."));else if(I){var D=n.getFieldValue(b),L=y.isListField();!L&&(!i.skipExist||D===void 0)&&n.updateStore(wc(n.store,b,Gn(I)[0].value))}}}})},l;i.entities?l=i.entities:i.namePathList?(l=[],i.namePathList.forEach(function(f){var g=r.get(f);if(g){var y;(y=l).push.apply(y,Gn(Gn(g).map(function(S){return S.entity})))}})):l=a,u(l)}),vt(this,"resetFields",function(i){n.warningUnhooked();var r=n.store;if(!i){n.updateStore(Sv(n.initialValues)),n.resetWithFieldInitialValue(),n.notifyObservers(r,null,{type:"reset"}),n.notifyWatch();return}var a=i.map(os);a.forEach(function(u){var l=n.getInitialValue(u);n.updateStore(wc(n.store,u,l))}),n.resetWithFieldInitialValue({namePathList:a}),n.notifyObservers(r,a,{type:"reset"}),n.notifyWatch(a)}),vt(this,"setFields",function(i){n.warningUnhooked();var r=n.store,a=[];i.forEach(function(u){var l=u.name,f=Xd(u,Vte),g=os(l);a.push(g),"value"in f&&n.updateStore(wc(n.store,g,f.value)),n.notifyObservers(r,[g],{type:"setField",data:u})}),n.notifyWatch(a)}),vt(this,"getFields",function(){var i=n.getFieldEntities(!0),r=i.map(function(a){var u=a.getNamePath(),l=a.getMeta(),f=It(It({},l),{},{name:u,value:n.getFieldValue(u)});return Object.defineProperty(f,"originRCField",{value:!0}),f});return r}),vt(this,"initEntityValue",function(i){var r=i.props.initialValue;if(r!==void 0){var a=i.getNamePath(),u=au(n.store,a);u===void 0&&n.updateStore(wc(n.store,a,r))}}),vt(this,"isMergedPreserve",function(i){var r=i!==void 0?i:n.preserve;return r??!0}),vt(this,"registerField",function(i){n.fieldEntities.push(i);var r=i.getNamePath();if(n.notifyWatch([r]),i.props.initialValue!==void 0){var a=n.store;n.resetWithFieldInitialValue({entities:[i],skipExist:!0}),n.notifyObservers(a,[i.getNamePath()],{type:"valueUpdate",source:"internal"})}return function(u,l){var f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];if(n.fieldEntities=n.fieldEntities.filter(function(S){return S!==i}),!n.isMergedPreserve(l)&&(!u||f.length>1)){var g=u?void 0:n.getInitialValue(r);if(r.length&&n.getFieldValue(r)!==g&&n.fieldEntities.every(function(S){return!B6(S.getNamePath(),r)})){var y=n.store;n.updateStore(wc(y,r,g,!0)),n.notifyObservers(y,[r],{type:"remove"}),n.triggerDependenciesUpdate(y,r)}}n.notifyWatch([r])}}),vt(this,"dispatch",function(i){switch(i.type){case"updateValue":{var r=i.namePath,a=i.value;n.updateValue(r,a);break}case"validateField":{var u=i.namePath,l=i.triggerName;n.validateFields([u],{triggerName:l});break}}}),vt(this,"notifyObservers",function(i,r,a){if(n.subscribable){var u=It(It({},a),{},{store:n.getFieldsValue(!0)});n.getFieldEntities().forEach(function(l){var f=l.onStoreChange;f(i,r,u)})}else n.forceRootUpdate()}),vt(this,"triggerDependenciesUpdate",function(i,r){var a=n.getDependencyChildrenFields(r);return a.length&&n.validateFields(a),n.notifyObservers(i,a,{type:"dependenciesUpdate",relatedFields:[r].concat(Gn(a))}),a}),vt(this,"updateValue",function(i,r){var a=os(i),u=n.store;n.updateStore(wc(n.store,a,r)),n.notifyObservers(u,[a],{type:"valueUpdate",source:"internal"}),n.notifyWatch([a]);var l=n.triggerDependenciesUpdate(u,a),f=n.callbacks.onValuesChange;if(f){var g=N6(n.store,[a]);f(g,n.getFieldsValue())}n.triggerOnFieldsChange([a].concat(Gn(l)))}),vt(this,"setFieldsValue",function(i){n.warningUnhooked();var r=n.store;if(i){var a=Sv(n.store,i);n.updateStore(a)}n.notifyObservers(r,null,{type:"valueUpdate",source:"external"}),n.notifyWatch()}),vt(this,"setFieldValue",function(i,r){n.setFields([{name:i,value:r}])}),vt(this,"getDependencyChildrenFields",function(i){var r=new Set,a=[],u=new Lv;n.getFieldEntities().forEach(function(f){var g=f.props.dependencies;(g||[]).forEach(function(y){var S=os(y);u.update(S,function(){var b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new Set;return b.add(f),b})})});var l=function f(g){var y=u.get(g)||new Set;y.forEach(function(S){if(!r.has(S)){r.add(S);var b=S.getNamePath();S.isFieldDirty()&&b.length&&(a.push(b),f(b))}})};return l(i),a}),vt(this,"triggerOnFieldsChange",function(i,r){var a=n.callbacks.onFieldsChange;if(a){var u=n.getFields();if(r){var l=new Lv;r.forEach(function(g){var y=g.name,S=g.errors;l.set(y,S)}),u.forEach(function(g){g.errors=l.get(g.name)||g.errors})}var f=u.filter(function(g){var y=g.name;return Rv(i,y)});f.length&&a(f,u)}}),vt(this,"validateFields",function(i,r){n.warningUnhooked();var a,u;Array.isArray(i)||typeof i=="string"||typeof r=="string"?(a=i,u=r):u=i;var l=!!a,f=l?a.map(os):[],g=[],y=String(Date.now()),S=new Set,b=u||{},A=b.recursive,I=b.dirty;n.getFieldEntities(!0).forEach(function(N){if(l||f.push(N.getNamePath()),!(!N.props.rules||!N.props.rules.length)&&!(I&&!N.isFieldDirty())){var B=N.getNamePath();if(S.add(B.join(y)),!l||Rv(f,B,A)){var $=N.validateRules(It({validateMessages:It(It({},O6),n.validateMessages)},u));g.push($.then(function(){return{name:B,errors:[],warnings:[]}}).catch(function(K){var q,W=[],ie=[];return(q=K.forEach)===null||q===void 0||q.call(K,function(Z){var X=Z.rule.warningOnly,se=Z.errors;X?ie.push.apply(ie,Gn(se)):W.push.apply(W,Gn(se))}),W.length?Promise.reject({name:B,errors:W,warnings:ie}):{name:B,errors:W,warnings:ie}}))}}});var D=Ute(g);n.lastValidatePromise=D,D.catch(function(N){return N}).then(function(N){var B=N.map(function($){var K=$.name;return K});n.notifyObservers(n.store,B,{type:"validateFinish"}),n.triggerOnFieldsChange(B,N)});var L=D.then(function(){return n.lastValidatePromise===D?Promise.resolve(n.getFieldsValue(f)):Promise.reject([])}).catch(function(N){var B=N.filter(function($){return $&&$.errors.length});return Promise.reject({values:n.getFieldsValue(f),errorFields:B,outOfDate:n.lastValidatePromise!==D})});L.catch(function(N){return N});var P=f.filter(function(N){return S.has(N.join(y))});return n.triggerOnFieldsChange(P),L}),vt(this,"submit",function(){n.warningUnhooked(),n.validateFields().then(function(i){var r=n.callbacks.onFinish;if(r)try{r(i)}catch(a){console.error(a)}}).catch(function(i){var r=n.callbacks.onFinishFailed;r&&r(i)})}),this.forceRootUpdate=e});function H6(t){var e=he.useRef(),n=he.useState({}),i=Xn(n,2),r=i[1];if(!e.current)if(t)e.current=t;else{var a=function(){r({})},u=new $te(a);e.current=u.getForm()}return[e.current]}var aI=he.createContext({triggerFormChange:function(){},triggerFormFinish:function(){},registerForm:function(){},unregisterForm:function(){}}),Hte=function(e){var n=e.validateMessages,i=e.onFormChange,r=e.onFormFinish,a=e.children,u=he.useContext(aI),l=he.useRef({});return he.createElement(aI.Provider,{value:It(It({},u),{},{validateMessages:It(It({},u.validateMessages),n),triggerFormChange:function(g,y){i&&i(g,{changedFields:y,forms:l.current}),u.triggerFormChange(g,y)},triggerFormFinish:function(g,y){r&&r(g,{values:y,forms:l.current}),u.triggerFormFinish(g,y)},registerForm:function(g,y){g&&(l.current=It(It({},l.current),{},vt({},g,y))),u.registerForm(g,y)},unregisterForm:function(g){var y=It({},l.current);delete y[g],l.current=y,u.unregisterForm(g)}})},a)},Gte=["name","initialValues","fields","form","preserve","children","component","validateMessages","validateTrigger","onValuesChange","onFieldsChange","onFinish","onFinishFailed","clearOnDestroy"],Wte=function(e,n){var i=e.name,r=e.initialValues,a=e.fields,u=e.form,l=e.preserve,f=e.children,g=e.component,y=g===void 0?"form":g,S=e.validateMessages,b=e.validateTrigger,A=b===void 0?"onChange":b,I=e.onValuesChange,D=e.onFieldsChange,L=e.onFinish,P=e.onFinishFailed,N=e.clearOnDestroy,B=Xd(e,Gte),$=he.useRef(null),K=he.useContext(aI),q=H6(u),W=Xn(q,1),ie=W[0],Z=ie.getInternalHooks(kp),X=Z.useSubscribe,se=Z.setInitialValues,De=Z.setCallbacks,Se=Z.setValidateMessages,Me=Z.setPreserve,Ye=Z.destroyForm;he.useImperativeHandle(n,function(){return It(It({},ie),{},{nativeElement:$.current})}),he.useEffect(function(){return K.registerForm(i,ie),function(){K.unregisterForm(i)}},[K,ie,i]),Se(It(It({},K.validateMessages),S)),De({onValuesChange:I,onFieldsChange:function(Ke){if(K.triggerFormChange(i,Ke),D){for(var _t=arguments.length,zt=new Array(_t>1?_t-1:0),Rt=1;Rt<_t;Rt++)zt[Rt-1]=arguments[Rt];D.apply(void 0,[Ke].concat(zt))}},onFinish:function(Ke){K.triggerFormFinish(i,Ke),L&&L(Ke)},onFinishFailed:P}),Me(l);var ye=he.useRef(null);se(r,!ye.current),ye.current||(ye.current=!0),he.useEffect(function(){return function(){return Ye(N)}},[]);var Ce,ge=typeof f=="function";if(ge){var Be=ie.getFieldsValue(!0);Ce=f(Be,ie)}else Ce=f;X(!ge);var Ze=he.useRef();he.useEffect(function(){Fte(Ze.current||[],a||[])||ie.setFields(a||[]),Ze.current=a},[a,ie]);var je=he.useMemo(function(){return It(It({},ie),{},{validateTrigger:A})},[ie,A]),wt=he.createElement(HS.Provider,{value:null},he.createElement(Pv.Provider,{value:je},Ce));return y===!1?wt:he.createElement(y,Kr({},B,{ref:$,onSubmit:function(Ke){Ke.preventDefault(),Ke.stopPropagation(),ie.submit()},onReset:function(Ke){var _t;Ke.preventDefault(),ie.resetFields(),(_t=B.onReset)===null||_t===void 0||_t.call(B,Ke)}}),wt)};function G6(t){try{return JSON.stringify(t)}catch{return Math.random()}}function jte(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i=e[0],r=e[1],a=r===void 0?{}:r,u=ete(a)?{form:a}:a,l=u.form,f=he.useState(),g=Xn(f,2),y=g[0],S=g[1],b=he.useMemo(function(){return G6(y)},[y]),A=he.useRef(b);A.current=b;var I=he.useContext(Pv),D=l||I,L=D&&D._init,P=os(i),N=he.useRef(P);return N.current=P,he.useEffect(function(){if(L){var B=D.getFieldsValue,$=D.getInternalHooks,K=$(kp),q=K.registerWatch,W=function(se,De){var Se=u.preserve?De:se;return typeof i=="function"?i(Se):au(Se,N.current)},ie=q(function(X,se){var De=W(X,se),Se=G6(De);A.current!==Se&&(A.current=Se,S(De))}),Z=W(B(),B(!0));return y!==Z&&S(Z),ie}},[L]),y}var qte=he.forwardRef(Wte),q_=qte;q_.FormProvider=Hte,q_.Field=V6,q_.List=Bte,q_.useForm=H6,q_.useWatch=jte;const W6=he.createContext({}),Xte=t=>{let{children:e,status:n,override:i}=t;const r=he.useContext(W6),a=he.useMemo(()=>{const u=Object.assign({},r);return i&&delete u.isFormItemInput,n&&(delete u.status,delete u.hasFeedback,delete u.feedbackIcon),u},[n,i,r]);return he.createElement(W6.Provider,{value:a},e)},Zte=t=>{const{space:e,form:n,children:i}=t;if(i==null)return null;let r=i;return n&&(r=un.createElement(Xte,{override:!0,status:!0},r)),e&&(r=un.createElement(aee,null,r)),r};function j6(t){if(t)return{closable:t.closable,closeIcon:t.closeIcon}}function q6(t){const{closable:e,closeIcon:n}=t||{};return un.useMemo(()=>{if(!e&&(e===!1||n===!1||n===null))return!1;if(e===void 0&&n===void 0)return null;let i={closeIcon:typeof n!="boolean"&&n!==null?n:void 0};return e&&typeof e=="object"&&(i=Object.assign(Object.assign({},i),e)),i},[e,n])}function X6(){const t={};for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return n.forEach(r=>{r&&Object.keys(r).forEach(a=>{r[a]!==void 0&&(t[a]=r[a])})}),t}const Yte={};function Kte(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Yte;const i=q6(t),r=q6(e),a=un.useMemo(()=>Object.assign({closeIcon:un.createElement(O3,null)},n),[n]),u=un.useMemo(()=>i===!1?!1:i?X6(a,r,i):r===!1?!1:r?X6(a,r):a.closable?a:!1,[i,r,a]);return un.useMemo(()=>{if(u===!1)return[!1,null];const{closeIconRender:l}=a,{closeIcon:f}=u;let g=f;if(g!=null){l&&(g=l(f));const y=F3(u,!0);Object.keys(y).length&&(g=un.isValidElement(g)?un.cloneElement(g,y):un.createElement("span",Object.assign({},y),g))}return[!0,g]},[u,a])}const Jte=()=>_a()&&window.document.documentElement,WS=t=>{const{prefixCls:e,className:n,style:i,size:r,shape:a}=t,u=pi({[`${e}-lg`]:r==="large",[`${e}-sm`]:r==="small"}),l=pi({[`${e}-circle`]:a==="circle",[`${e}-square`]:a==="square",[`${e}-round`]:a==="round"}),f=he.useMemo(()=>typeof r=="number"?{width:r,height:r,lineHeight:`${r}px`}:{},[r]);return he.createElement("span",{className:pi(e,u,l,n),style:Object.assign(Object.assign({},f),i)})},Qte=new Qo("ant-skeleton-loading",{"0%":{backgroundPosition:"100% 50%"},"100%":{backgroundPosition:"0 50%"}}),jS=t=>({height:t,lineHeight:cr(t)}),kv=t=>Object.assign({width:t},jS(t)),ene=t=>({background:t.skeletonLoadingBackground,backgroundSize:"400% 100%",animationName:Qte,animationDuration:t.skeletonLoadingMotionDuration,animationTimingFunction:"ease",animationIterationCount:"infinite"}),lI=(t,e)=>Object.assign({width:e(t).mul(5).equal(),minWidth:e(t).mul(5).equal()},jS(t)),tne=t=>{const{skeletonAvatarCls:e,gradientFromColor:n,controlHeight:i,controlHeightLG:r,controlHeightSM:a}=t;return{[e]:Object.assign({display:"inline-block",verticalAlign:"top",background:n},kv(i)),[`${e}${e}-circle`]:{borderRadius:"50%"},[`${e}${e}-lg`]:Object.assign({},kv(r)),[`${e}${e}-sm`]:Object.assign({},kv(a))}},nne=t=>{const{controlHeight:e,borderRadiusSM:n,skeletonInputCls:i,controlHeightLG:r,controlHeightSM:a,gradientFromColor:u,calc:l}=t;return{[i]:Object.assign({display:"inline-block",verticalAlign:"top",background:u,borderRadius:n},lI(e,l)),[`${i}-lg`]:Object.assign({},lI(r,l)),[`${i}-sm`]:Object.assign({},lI(a,l))}},Z6=t=>Object.assign({width:t},jS(t)),ine=t=>{const{skeletonImageCls:e,imageSizeBase:n,gradientFromColor:i,borderRadiusSM:r,calc:a}=t;return{[e]:Object.assign(Object.assign({display:"flex",alignItems:"center",justifyContent:"center",verticalAlign:"top",background:i,borderRadius:r},Z6(a(n).mul(2).equal())),{[`${e}-path`]:{fill:"#bfbfbf"},[`${e}-svg`]:Object.assign(Object.assign({},Z6(n)),{maxWidth:a(n).mul(4).equal(),maxHeight:a(n).mul(4).equal()}),[`${e}-svg${e}-svg-circle`]:{borderRadius:"50%"}}),[`${e}${e}-circle`]:{borderRadius:"50%"}}},cI=(t,e,n)=>{const{skeletonButtonCls:i}=t;return{[`${n}${i}-circle`]:{width:e,minWidth:e,borderRadius:"50%"},[`${n}${i}-round`]:{borderRadius:e}}},uI=(t,e)=>Object.assign({width:e(t).mul(2).equal(),minWidth:e(t).mul(2).equal()},jS(t)),rne=t=>{const{borderRadiusSM:e,skeletonButtonCls:n,controlHeight:i,controlHeightLG:r,controlHeightSM:a,gradientFromColor:u,calc:l}=t;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({[n]:Object.assign({display:"inline-block",verticalAlign:"top",background:u,borderRadius:e,width:l(i).mul(2).equal(),minWidth:l(i).mul(2).equal()},uI(i,l))},cI(t,i,n)),{[`${n}-lg`]:Object.assign({},uI(r,l))}),cI(t,r,`${n}-lg`)),{[`${n}-sm`]:Object.assign({},uI(a,l))}),cI(t,a,`${n}-sm`))},sne=t=>{const{componentCls:e,skeletonAvatarCls:n,skeletonTitleCls:i,skeletonParagraphCls:r,skeletonButtonCls:a,skeletonInputCls:u,skeletonImageCls:l,controlHeight:f,controlHeightLG:g,controlHeightSM:y,gradientFromColor:S,padding:b,marginSM:A,borderRadius:I,titleHeight:D,blockRadius:L,paragraphLiHeight:P,controlHeightXS:N,paragraphMarginTop:B}=t;return{[e]:{display:"table",width:"100%",[`${e}-header`]:{display:"table-cell",paddingInlineEnd:b,verticalAlign:"top",[n]:Object.assign({display:"inline-block",verticalAlign:"top",background:S},kv(f)),[`${n}-circle`]:{borderRadius:"50%"},[`${n}-lg`]:Object.assign({},kv(g)),[`${n}-sm`]:Object.assign({},kv(y))},[`${e}-content`]:{display:"table-cell",width:"100%",verticalAlign:"top",[i]:{width:"100%",height:D,background:S,borderRadius:L,[`+ ${r}`]:{marginBlockStart:y}},[r]:{padding:0,"> li":{width:"100%",height:P,listStyle:"none",background:S,borderRadius:L,"+ li":{marginBlockStart:N}}},[`${r}> li:last-child:not(:first-child):not(:nth-child(2))`]:{width:"61%"}},[`&-round ${e}-content`]:{[`${i}, ${r} > li`]:{borderRadius:I}}},[`${e}-with-avatar ${e}-content`]:{[i]:{marginBlockStart:A,[`+ ${r}`]:{marginBlockStart:B}}},[`${e}${e}-element`]:Object.assign(Object.assign(Object.assign(Object.assign({display:"inline-block",width:"auto"},rne(t)),tne(t)),nne(t)),ine(t)),[`${e}${e}-block`]:{width:"100%",[a]:{width:"100%"},[u]:{width:"100%"}},[`${e}${e}-active`]:{[`
        ${i},
        ${r} > li,
        ${n},
        ${a},
        ${u},
        ${l}
      `]:Object.assign({},ene(t))}}},Dv=T3("Skeleton",t=>{const{componentCls:e,calc:n}=t,i=Kd(t,{skeletonAvatarCls:`${e}-avatar`,skeletonTitleCls:`${e}-title`,skeletonParagraphCls:`${e}-paragraph`,skeletonButtonCls:`${e}-button`,skeletonInputCls:`${e}-input`,skeletonImageCls:`${e}-image`,imageSizeBase:n(t.controlHeight).mul(1.5).equal(),borderRadius:100,skeletonLoadingBackground:`linear-gradient(90deg, ${t.gradientFromColor} 25%, ${t.gradientToColor} 37%, ${t.gradientFromColor} 63%)`,skeletonLoadingMotionDuration:"1.4s"});return[sne(i)]},t=>{const{colorFillContent:e,colorFill:n}=t,i=e,r=n;return{color:i,colorGradientEnd:r,gradientFromColor:i,gradientToColor:r,titleHeight:t.controlHeight/2,blockRadius:t.borderRadiusSM,paragraphMarginTop:t.marginLG+t.marginXXS,paragraphLiHeight:t.controlHeight/2}},{deprecatedTokens:[["color","gradientFromColor"],["colorGradientEnd","gradientToColor"]]}),one=t=>{const{prefixCls:e,className:n,rootClassName:i,active:r,shape:a="circle",size:u="default"}=t,{getPrefixCls:l}=he.useContext(ms),f=l("skeleton",e),[g,y,S]=Dv(f),b=lS(t,["prefixCls","className"]),A=pi(f,`${f}-element`,{[`${f}-active`]:r},n,i,y,S);return g(he.createElement("div",{className:A},he.createElement(WS,Object.assign({prefixCls:`${f}-avatar`,shape:a,size:u},b))))},ane=t=>{const{prefixCls:e,className:n,rootClassName:i,active:r,block:a=!1,size:u="default"}=t,{getPrefixCls:l}=he.useContext(ms),f=l("skeleton",e),[g,y,S]=Dv(f),b=lS(t,["prefixCls"]),A=pi(f,`${f}-element`,{[`${f}-active`]:r,[`${f}-block`]:a},n,i,y,S);return g(he.createElement("div",{className:A},he.createElement(WS,Object.assign({prefixCls:`${f}-button`,size:u},b))))},lne="M365.714286 329.142857q0 45.714286-32.036571 77.677714t-77.677714 32.036571-77.677714-32.036571-32.036571-77.677714 32.036571-77.677714 77.677714-32.036571 77.677714 32.036571 32.036571 77.677714zM950.857143 548.571429l0 256-804.571429 0 0-109.714286 182.857143-182.857143 91.428571 91.428571 292.571429-292.571429zM1005.714286 146.285714l-914.285714 0q-7.460571 0-12.873143 5.412571t-5.412571 12.873143l0 694.857143q0 7.460571 5.412571 12.873143t12.873143 5.412571l914.285714 0q7.460571 0 12.873143-5.412571t5.412571-12.873143l0-694.857143q0-7.460571-5.412571-12.873143t-12.873143-5.412571zM1097.142857 164.571429l0 694.857143q0 37.741714-26.843429 64.585143t-64.585143 26.843429l-914.285714 0q-37.741714 0-64.585143-26.843429t-26.843429-64.585143l0-694.857143q0-37.741714 26.843429-64.585143t64.585143-26.843429l914.285714 0q37.741714 0 64.585143 26.843429t26.843429 64.585143z",cne=t=>{const{prefixCls:e,className:n,rootClassName:i,style:r,active:a}=t,{getPrefixCls:u}=he.useContext(ms),l=u("skeleton",e),[f,g,y]=Dv(l),S=pi(l,`${l}-element`,{[`${l}-active`]:a},n,i,g,y);return f(he.createElement("div",{className:S},he.createElement("div",{className:pi(`${l}-image`,n),style:r},he.createElement("svg",{viewBox:"0 0 1098 1024",xmlns:"http://www.w3.org/2000/svg",className:`${l}-image-svg`},he.createElement("title",null,"Image placeholder"),he.createElement("path",{d:lne,className:`${l}-image-path`})))))},une=t=>{const{prefixCls:e,className:n,rootClassName:i,active:r,block:a,size:u="default"}=t,{getPrefixCls:l}=he.useContext(ms),f=l("skeleton",e),[g,y,S]=Dv(f),b=lS(t,["prefixCls"]),A=pi(f,`${f}-element`,{[`${f}-active`]:r,[`${f}-block`]:a},n,i,y,S);return g(he.createElement("div",{className:A},he.createElement(WS,Object.assign({prefixCls:`${f}-input`,size:u},b))))};var hne={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M888 792H200V168c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h752c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM288 604a64 64 0 10128 0 64 64 0 10-128 0zm118-224a48 48 0 1096 0 48 48 0 10-96 0zm158 228a96 96 0 10192 0 96 96 0 10-192 0zm148-314a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"dot-chart",theme:"outlined"},dne=function(e,n){return he.createElement(lu,Kr({},e,{ref:n,icon:hne}))},fne=he.forwardRef(dne);const pne=t=>{const{prefixCls:e,className:n,rootClassName:i,style:r,active:a,children:u}=t,{getPrefixCls:l}=he.useContext(ms),f=l("skeleton",e),[g,y,S]=Dv(f),b=pi(f,`${f}-element`,{[`${f}-active`]:a},y,n,i,S),A=u??he.createElement(fne,null);return g(he.createElement("div",{className:b},he.createElement("div",{className:pi(`${f}-image`,n),style:r},A)))},mne=(t,e)=>{const{width:n,rows:i=2}=e;if(Array.isArray(n))return n[t];if(i-1===t)return n},gne=t=>{const{prefixCls:e,className:n,style:i,rows:r}=t,a=Gn(Array(r)).map((u,l)=>he.createElement("li",{key:l,style:{width:mne(l,t)}}));return he.createElement("ul",{className:pi(e,n),style:i},a)},vne=t=>{let{prefixCls:e,className:n,width:i,style:r}=t;return he.createElement("h3",{className:pi(e,n),style:Object.assign({width:i},r)})};function hI(t){return t&&typeof t=="object"?t:{}}function yne(t,e){return t&&!e?{size:"large",shape:"square"}:{size:"large",shape:"circle"}}function _ne(t,e){return!t&&e?{width:"38%"}:t&&e?{width:"50%"}:{}}function xne(t,e){const n={};return(!t||!e)&&(n.width="61%"),!t&&e?n.rows=3:n.rows=2,n}const Ov=t=>{const{prefixCls:e,loading:n,className:i,rootClassName:r,style:a,children:u,avatar:l=!1,title:f=!0,paragraph:g=!0,active:y,round:S}=t,{getPrefixCls:b,direction:A,skeleton:I}=he.useContext(ms),D=b("skeleton",e),[L,P,N]=Dv(D);if(n||!("loading"in t)){const B=!!l,$=!!f,K=!!g;let q;if(B){const Z=Object.assign(Object.assign({prefixCls:`${D}-avatar`},yne($,K)),hI(l));q=he.createElement("div",{className:`${D}-header`},he.createElement(WS,Object.assign({},Z)))}let W;if($||K){let Z;if($){const se=Object.assign(Object.assign({prefixCls:`${D}-title`},_ne(B,K)),hI(f));Z=he.createElement(vne,Object.assign({},se))}let X;if(K){const se=Object.assign(Object.assign({prefixCls:`${D}-paragraph`},xne(B,$)),hI(g));X=he.createElement(gne,Object.assign({},se))}W=he.createElement("div",{className:`${D}-content`},Z,X)}const ie=pi(D,{[`${D}-with-avatar`]:B,[`${D}-active`]:y,[`${D}-rtl`]:A==="rtl",[`${D}-round`]:S},I==null?void 0:I.className,i,r,P,N);return L(he.createElement("div",{className:ie,style:Object.assign(Object.assign({},I==null?void 0:I.style),a)},q,W))}return u??null};Ov.Button=ane,Ov.Avatar=one,Ov.Input=une,Ov.Image=cne,Ov.Node=pne;function Y6(){}const bne=he.createContext({add:Y6,remove:Y6});function wne(t){const e=he.useContext(bne),n=he.useRef();return z_(r=>{if(r){const a=t?r.querySelector(t):r;e.add(a),n.current=a}else e.remove(n.current)})}const K6=()=>{const{cancelButtonProps:t,cancelTextLocale:e,onCancel:n}=he.useContext(H_);return un.createElement($_,Object.assign({onClick:n},t),e)},J6=()=>{const{confirmLoading:t,okButtonProps:e,okType:n,okTextLocale:i,onOk:r}=he.useContext(H_);return un.createElement($_,Object.assign({},i6(n),{loading:t,onClick:r},e),i)};function Q6(t,e){return un.createElement("span",{className:`${t}-close-x`},e||un.createElement(O3,{className:`${t}-close-icon`}))}const eU=t=>{const{okText:e,okType:n="primary",cancelText:i,confirmLoading:r,onOk:a,onCancel:u,okButtonProps:l,cancelButtonProps:f,footer:g}=t,[y]=t3("Modal",$N()),S=e||(y==null?void 0:y.okText),b=i||(y==null?void 0:y.cancelText),A={confirmLoading:r,okButtonProps:l,cancelButtonProps:f,okTextLocale:S,cancelTextLocale:b,okType:n,onOk:a,onCancel:u},I=un.useMemo(()=>A,Gn(Object.values(A)));let D;return typeof g=="function"||typeof g>"u"?(D=un.createElement(un.Fragment,null,un.createElement(K6,null),un.createElement(J6,null)),typeof g=="function"&&(D=g(D,{OkBtn:J6,CancelBtn:K6})),D=un.createElement(f6,{value:I},D)):D=g,un.createElement(nB,{disabled:!1},D)},Sne=t=>({animationDuration:t,animationFillMode:"both"}),Ene=t=>({animationDuration:t,animationFillMode:"both"}),tU=function(t,e,n,i){const a=(arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1)?"&":"";return{[`
      ${a}${t}-enter,
      ${a}${t}-appear
    `]:Object.assign(Object.assign({},Sne(i)),{animationPlayState:"paused"}),[`${a}${t}-leave`]:Object.assign(Object.assign({},Ene(i)),{animationPlayState:"paused"}),[`
      ${a}${t}-enter${t}-enter-active,
      ${a}${t}-appear${t}-appear-active
    `]:{animationName:e,animationPlayState:"running"},[`${a}${t}-leave${t}-leave-active`]:{animationName:n,animationPlayState:"running",pointerEvents:"none"}}},Mne=new Qo("antFadeIn",{"0%":{opacity:0},"100%":{opacity:1}}),Cne=new Qo("antFadeOut",{"0%":{opacity:1},"100%":{opacity:0}}),Tne=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{antCls:n}=t,i=`${n}-fade`,r=e?"&":"";return[tU(i,Mne,Cne,t.motionDurationMid,e),{[`
        ${r}${i}-enter,
        ${r}${i}-appear
      `]:{opacity:0,animationTimingFunction:"linear"},[`${r}${i}-leave`]:{animationTimingFunction:"linear"}}]},Ane=new Qo("antZoomIn",{"0%":{transform:"scale(0.2)",opacity:0},"100%":{transform:"scale(1)",opacity:1}}),Pne=new Qo("antZoomOut",{"0%":{transform:"scale(1)"},"100%":{transform:"scale(0.2)",opacity:0}}),nU=new Qo("antZoomBigIn",{"0%":{transform:"scale(0.8)",opacity:0},"100%":{transform:"scale(1)",opacity:1}}),iU=new Qo("antZoomBigOut",{"0%":{transform:"scale(1)"},"100%":{transform:"scale(0.8)",opacity:0}}),Ine=new Qo("antZoomUpIn",{"0%":{transform:"scale(0.8)",transformOrigin:"50% 0%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"50% 0%"}}),Rne=new Qo("antZoomUpOut",{"0%":{transform:"scale(1)",transformOrigin:"50% 0%"},"100%":{transform:"scale(0.8)",transformOrigin:"50% 0%",opacity:0}}),Lne=new Qo("antZoomLeftIn",{"0%":{transform:"scale(0.8)",transformOrigin:"0% 50%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"0% 50%"}}),kne=new Qo("antZoomLeftOut",{"0%":{transform:"scale(1)",transformOrigin:"0% 50%"},"100%":{transform:"scale(0.8)",transformOrigin:"0% 50%",opacity:0}}),Dne=new Qo("antZoomRightIn",{"0%":{transform:"scale(0.8)",transformOrigin:"100% 50%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"100% 50%"}}),One=new Qo("antZoomRightOut",{"0%":{transform:"scale(1)",transformOrigin:"100% 50%"},"100%":{transform:"scale(0.8)",transformOrigin:"100% 50%",opacity:0}}),Fne=new Qo("antZoomDownIn",{"0%":{transform:"scale(0.8)",transformOrigin:"50% 100%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"50% 100%"}}),zne=new Qo("antZoomDownOut",{"0%":{transform:"scale(1)",transformOrigin:"50% 100%"},"100%":{transform:"scale(0.8)",transformOrigin:"50% 100%",opacity:0}}),Nne={zoom:{inKeyframes:Ane,outKeyframes:Pne},"zoom-big":{inKeyframes:nU,outKeyframes:iU},"zoom-big-fast":{inKeyframes:nU,outKeyframes:iU},"zoom-left":{inKeyframes:Lne,outKeyframes:kne},"zoom-right":{inKeyframes:Dne,outKeyframes:One},"zoom-up":{inKeyframes:Ine,outKeyframes:Rne},"zoom-down":{inKeyframes:Fne,outKeyframes:zne}},Bne=(t,e)=>{const{antCls:n}=t,i=`${n}-${e}`,{inKeyframes:r,outKeyframes:a}=Nne[e];return[tU(i,r,a,t.motionDurationMid),{[`
        ${i}-enter,
        ${i}-appear
      `]:{transform:"scale(0)",opacity:0,animationTimingFunction:t.motionEaseOutCirc,"&-prepare":{transform:"none"}},[`${i}-leave`]:{animationTimingFunction:t.motionEaseInOutCirc}}]};function rU(t){return{position:t,inset:0}}const Une=t=>{const{componentCls:e,antCls:n}=t;return[{[`${e}-root`]:{[`${e}${n}-zoom-enter, ${e}${n}-zoom-appear`]:{transform:"none",opacity:0,animationDuration:t.motionDurationSlow,userSelect:"none"},[`${e}${n}-zoom-leave ${e}-content`]:{pointerEvents:"none"},[`${e}-mask`]:Object.assign(Object.assign({},rU("fixed")),{zIndex:t.zIndexPopupBase,height:"100%",backgroundColor:t.colorBgMask,pointerEvents:"none",[`${e}-hidden`]:{display:"none"}}),[`${e}-wrap`]:Object.assign(Object.assign({},rU("fixed")),{zIndex:t.zIndexPopupBase,overflow:"auto",outline:0,WebkitOverflowScrolling:"touch"})}},{[`${e}-root`]:Tne(t)}]},Vne=t=>{const{componentCls:e}=t;return[{[`${e}-root`]:{[`${e}-wrap-rtl`]:{direction:"rtl"},[`${e}-centered`]:{textAlign:"center","&::before":{display:"inline-block",width:0,height:"100%",verticalAlign:"middle",content:'""'},[e]:{top:0,display:"inline-block",paddingBottom:0,textAlign:"start",verticalAlign:"middle"}},[`@media (max-width: ${t.screenSMMax}px)`]:{[e]:{maxWidth:"calc(100vw - 16px)",margin:`${cr(t.marginXS)} auto`},[`${e}-centered`]:{[e]:{flex:1}}}}},{[e]:Object.assign(Object.assign({},gJ(t)),{pointerEvents:"none",position:"relative",top:100,width:"auto",maxWidth:`calc(100vw - ${cr(t.calc(t.margin).mul(2).equal())})`,margin:"0 auto",paddingBottom:t.paddingLG,[`${e}-title`]:{margin:0,color:t.titleColor,fontWeight:t.fontWeightStrong,fontSize:t.titleFontSize,lineHeight:t.titleLineHeight,wordWrap:"break-word"},[`${e}-content`]:{position:"relative",backgroundColor:t.contentBg,backgroundClip:"padding-box",border:0,borderRadius:t.borderRadiusLG,boxShadow:t.boxShadow,pointerEvents:"auto",padding:t.contentPadding},[`${e}-close`]:Object.assign({position:"absolute",top:t.calc(t.modalHeaderHeight).sub(t.modalCloseBtnSize).div(2).equal(),insetInlineEnd:t.calc(t.modalHeaderHeight).sub(t.modalCloseBtnSize).div(2).equal(),zIndex:t.calc(t.zIndexPopupBase).add(10).equal(),padding:0,color:t.modalCloseIconColor,fontWeight:t.fontWeightStrong,lineHeight:1,textDecoration:"none",background:"transparent",borderRadius:t.borderRadiusSM,width:t.modalCloseBtnSize,height:t.modalCloseBtnSize,border:0,outline:0,cursor:"pointer",transition:`color ${t.motionDurationMid}, background-color ${t.motionDurationMid}`,"&-x":{display:"flex",fontSize:t.fontSizeLG,fontStyle:"normal",lineHeight:cr(t.modalCloseBtnSize),justifyContent:"center",textTransform:"none",textRendering:"auto"},"&:hover":{color:t.modalCloseIconHoverColor,backgroundColor:t.colorBgTextHover,textDecoration:"none"},"&:active":{backgroundColor:t.colorBgTextActive}},mB(t)),[`${e}-header`]:{color:t.colorText,background:t.headerBg,borderRadius:`${cr(t.borderRadiusLG)} ${cr(t.borderRadiusLG)} 0 0`,marginBottom:t.headerMarginBottom,padding:t.headerPadding,borderBottom:t.headerBorderBottom},[`${e}-body`]:{fontSize:t.fontSize,lineHeight:t.lineHeight,wordWrap:"break-word",padding:t.bodyPadding,[`${e}-body-skeleton`]:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",margin:`${cr(t.margin)} auto`}},[`${e}-footer`]:{textAlign:"end",background:t.footerBg,marginTop:t.footerMarginTop,padding:t.footerPadding,borderTop:t.footerBorderTop,borderRadius:t.footerBorderRadius,[`> ${t.antCls}-btn + ${t.antCls}-btn`]:{marginInlineStart:t.marginXS}},[`${e}-open`]:{overflow:"hidden"}})},{[`${e}-pure-panel`]:{top:"auto",padding:0,display:"flex",flexDirection:"column",[`${e}-content,
          ${e}-body,
          ${e}-confirm-body-wrapper`]:{display:"flex",flexDirection:"column",flex:"auto"},[`${e}-confirm-body`]:{marginBottom:"auto"}}}]},$ne=t=>{const{componentCls:e}=t;return{[`${e}-root`]:{[`${e}-wrap-rtl`]:{direction:"rtl",[`${e}-confirm-body`]:{direction:"rtl"}}}}},sU=t=>{const e=t.padding,n=t.fontSizeHeading5,i=t.lineHeightHeading5;return Kd(t,{modalHeaderHeight:t.calc(t.calc(i).mul(n).equal()).add(t.calc(e).mul(2).equal()).equal(),modalFooterBorderColorSplit:t.colorSplit,modalFooterBorderStyle:t.lineType,modalFooterBorderWidth:t.lineWidth,modalCloseIconColor:t.colorIcon,modalCloseIconHoverColor:t.colorIconHover,modalCloseBtnSize:t.controlHeight,modalConfirmIconSize:t.fontHeight,modalTitleHeight:t.calc(t.titleFontSize).mul(t.titleLineHeight).equal()})},oU=t=>({footerBg:"transparent",headerBg:t.colorBgElevated,titleLineHeight:t.lineHeightHeading5,titleFontSize:t.fontSizeHeading5,contentBg:t.colorBgElevated,titleColor:t.colorTextHeading,contentPadding:t.wireframe?0:`${cr(t.paddingMD)} ${cr(t.paddingContentHorizontalLG)}`,headerPadding:t.wireframe?`${cr(t.padding)} ${cr(t.paddingLG)}`:0,headerBorderBottom:t.wireframe?`${cr(t.lineWidth)} ${t.lineType} ${t.colorSplit}`:"none",headerMarginBottom:t.wireframe?0:t.marginXS,bodyPadding:t.wireframe?t.paddingLG:0,footerPadding:t.wireframe?`${cr(t.paddingXS)} ${cr(t.padding)}`:0,footerBorderTop:t.wireframe?`${cr(t.lineWidth)} ${t.lineType} ${t.colorSplit}`:"none",footerBorderRadius:t.wireframe?`0 0 ${cr(t.borderRadiusLG)} ${cr(t.borderRadiusLG)}`:0,footerMarginTop:t.wireframe?0:t.marginSM,confirmBodyPadding:t.wireframe?`${cr(t.padding*2)} ${cr(t.padding*2)} ${cr(t.paddingLG)}`:0,confirmIconMarginInlineEnd:t.wireframe?t.margin:t.marginSM,confirmBtnsMarginTop:t.wireframe?t.marginLG:t.marginSM}),aU=T3("Modal",t=>{const e=sU(t);return[Vne(e),$ne(e),Une(e),Bne(e,"zoom")]},oU,{unitless:{titleLineHeight:!0}});var Hne=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};let dI;const Gne=t=>{dI={x:t.pageX,y:t.pageY},setTimeout(()=>{dI=null},100)};Jte()&&document.documentElement.addEventListener("click",Gne,!0);const lU=t=>{var e;const{getPopupContainer:n,getPrefixCls:i,direction:r,modal:a}=he.useContext(ms),u=wt=>{const{onCancel:Xt}=t;Xt==null||Xt(wt)},l=wt=>{const{onOk:Xt}=t;Xt==null||Xt(wt)},{prefixCls:f,className:g,rootClassName:y,open:S,wrapClassName:b,centered:A,getContainer:I,focusTriggerAfterClose:D=!0,style:L,visible:P,width:N=520,footer:B,classNames:$,styles:K,children:q,loading:W}=t,ie=Hne(t,["prefixCls","className","rootClassName","open","wrapClassName","centered","getContainer","focusTriggerAfterClose","style","visible","width","footer","classNames","styles","children","loading"]),Z=i("modal",f),X=i(),se=WB(Z),[De,Se,Me]=aU(Z,se),Ye=pi(b,{[`${Z}-centered`]:!!A,[`${Z}-wrap-rtl`]:r==="rtl"}),ye=B!==null&&!W?he.createElement(eU,Object.assign({},t,{onOk:l,onCancel:u})):null,[Ce,ge]=Kte(j6(t),j6(a),{closable:!0,closeIcon:he.createElement(O3,{className:`${Z}-close-icon`}),closeIconRender:wt=>Q6(Z,wt)}),Be=wne(`.${Z}-content`),[Ze,je]=UQ("Modal",ie.zIndex);return De(he.createElement(Zte,{form:!0,space:!0},he.createElement(qB.Provider,{value:je},he.createElement(A6,Object.assign({width:N},ie,{zIndex:Ze,getContainer:I===void 0?n:I,prefixCls:Z,rootClassName:pi(Se,y,Me,se),footer:ye,visible:S??P,mousePosition:(e=ie.mousePosition)!==null&&e!==void 0?e:dI,onClose:u,closable:Ce,closeIcon:ge,focusTriggerAfterClose:D,transitionName:VS(X,"zoom",t.transitionName),maskTransitionName:VS(X,"fade",t.maskTransitionName),className:pi(Se,g,a==null?void 0:a.className),style:Object.assign(Object.assign({},a==null?void 0:a.style),L),classNames:Object.assign(Object.assign(Object.assign({},a==null?void 0:a.classNames),$),{wrapper:pi(Ye,$==null?void 0:$.wrapper)}),styles:Object.assign(Object.assign({},a==null?void 0:a.styles),K),panelRef:Be}),W?he.createElement(Ov,{active:!0,title:!1,paragraph:{rows:4},className:`${Z}-body-skeleton`}):q))))},Wne=t=>{const{componentCls:e,titleFontSize:n,titleLineHeight:i,modalConfirmIconSize:r,fontSize:a,lineHeight:u,modalTitleHeight:l,fontHeight:f,confirmBodyPadding:g}=t,y=`${e}-confirm`;return{[y]:{"&-rtl":{direction:"rtl"},[`${t.antCls}-modal-header`]:{display:"none"},[`${y}-body-wrapper`]:Object.assign({},yJ()),[`&${e} ${e}-body`]:{padding:g},[`${y}-body`]:{display:"flex",flexWrap:"nowrap",alignItems:"start",[`> ${t.iconCls}`]:{flex:"none",fontSize:r,marginInlineEnd:t.confirmIconMarginInlineEnd,marginTop:t.calc(t.calc(f).sub(r).equal()).div(2).equal()},[`&-has-title > ${t.iconCls}`]:{marginTop:t.calc(t.calc(l).sub(r).equal()).div(2).equal()}},[`${y}-paragraph`]:{display:"flex",flexDirection:"column",flex:"auto",rowGap:t.marginXS},[`${t.iconCls} + ${y}-paragraph`]:{maxWidth:`calc(100% - ${cr(t.calc(t.modalConfirmIconSize).add(t.marginSM).equal())})`},[`${y}-title`]:{color:t.colorTextHeading,fontWeight:t.fontWeightStrong,fontSize:n,lineHeight:i},[`${y}-content`]:{color:t.colorText,fontSize:a,lineHeight:u},[`${y}-btns`]:{textAlign:"end",marginTop:t.confirmBtnsMarginTop,[`${t.antCls}-btn + ${t.antCls}-btn`]:{marginBottom:0,marginInlineStart:t.marginXS}}},[`${y}-error ${y}-body > ${t.iconCls}`]:{color:t.colorError},[`${y}-warning ${y}-body > ${t.iconCls},
        ${y}-confirm ${y}-body > ${t.iconCls}`]:{color:t.colorWarning},[`${y}-info ${y}-body > ${t.iconCls}`]:{color:t.colorInfo},[`${y}-success ${y}-body > ${t.iconCls}`]:{color:t.colorSuccess}}},jne=vB(["Modal","confirm"],t=>{const e=sU(t);return[Wne(e)]},oU,{order:-1e3});var qne=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};function cU(t){const{prefixCls:e,icon:n,okText:i,cancelText:r,confirmPrefixCls:a,type:u,okCancel:l,footer:f,locale:g}=t,y=qne(t,["prefixCls","icon","okText","cancelText","confirmPrefixCls","type","okCancel","footer","locale"]);let S=n;if(!n&&n!==null)switch(u){case"info":S=he.createElement(CQ,null);break;case"success":S=he.createElement(mQ,null);break;case"error":S=he.createElement(yQ,null);break;default:S=he.createElement(SQ,null)}const b=l??u==="confirm",A=t.autoFocusButton===null?!1:t.autoFocusButton||"ok",[I]=t3("Modal"),D=g||I,L=i||(b?D==null?void 0:D.okText:D==null?void 0:D.justOkText),P=r||(D==null?void 0:D.cancelText),N=Object.assign({autoFocusButton:A,cancelTextLocale:P,okTextLocale:L,mergedOkCancel:b},y),B=he.useMemo(()=>N,Gn(Object.values(N))),$=he.createElement(he.Fragment,null,he.createElement(p6,null),he.createElement(m6,null)),K=t.title!==void 0&&t.title!==null,q=`${a}-body`;return he.createElement("div",{className:`${a}-body-wrapper`},he.createElement("div",{className:pi(q,{[`${q}-has-title`]:K})},S,he.createElement("div",{className:`${a}-paragraph`},K&&he.createElement("span",{className:`${a}-title`},t.title),he.createElement("div",{className:`${a}-content`},t.content))),f===void 0||typeof f=="function"?he.createElement(f6,{value:B},he.createElement("div",{className:`${a}-btns`},typeof f=="function"?f($,{OkBtn:m6,CancelBtn:p6}):$)):f,he.createElement(jne,{prefixCls:e}))}const Xne=t=>{const{close:e,zIndex:n,afterClose:i,open:r,keyboard:a,centered:u,getContainer:l,maskStyle:f,direction:g,prefixCls:y,wrapClassName:S,rootPrefixCls:b,bodyStyle:A,closable:I=!1,closeIcon:D,modalRender:L,focusTriggerAfterClose:P,onConfirm:N,styles:B}=t,$=`${y}-confirm`,K=t.width||416,q=t.style||{},W=t.mask===void 0?!0:t.mask,ie=t.maskClosable===void 0?!1:t.maskClosable,Z=pi($,`${$}-${t.type}`,{[`${$}-rtl`]:g==="rtl"},t.className),[,X]=Jd(),se=he.useMemo(()=>n!==void 0?n:X.zIndexPopupBase+zQ,[n,X]);return he.createElement(lU,{prefixCls:y,className:Z,wrapClassName:pi({[`${$}-centered`]:!!t.centered},S),onCancel:()=>{e==null||e({triggerCancel:!0}),N==null||N(!1)},open:r,title:"",footer:null,transitionName:VS(b||"","zoom",t.transitionName),maskTransitionName:VS(b||"","fade",t.maskTransitionName),mask:W,maskClosable:ie,style:q,styles:Object.assign({body:A,mask:f},B),width:K,zIndex:se,afterClose:i,keyboard:a,centered:u,getContainer:l,closable:I,closeIcon:D,modalRender:L,focusTriggerAfterClose:P},he.createElement(cU,Object.assign({},t,{confirmPrefixCls:$})))},uU=t=>{const{rootPrefixCls:e,iconPrefixCls:n,direction:i,theme:r}=t;return he.createElement(ef,{prefixCls:e,iconPrefixCls:n,direction:i,theme:r},he.createElement(Xne,Object.assign({},t)))},Dp=[];let hU="";function dU(){return hU}const Zne=t=>{var e,n;const{prefixCls:i,getContainer:r,direction:a}=t,u=$N(),l=he.useContext(ms),f=dU()||l.getPrefixCls(),g=i||`${f}-modal`;let y=r;return y===!1&&(y=void 0),un.createElement(uU,Object.assign({},t,{rootPrefixCls:f,prefixCls:g,iconPrefixCls:l.iconPrefixCls,theme:l.theme,direction:a??l.direction,locale:(n=(e=l.locale)===null||e===void 0?void 0:e.Modal)!==null&&n!==void 0?n:u,getContainer:y}))};function X_(t){const e=eQ(),n=document.createDocumentFragment();let i=Object.assign(Object.assign({},t),{close:l,open:!0}),r;function a(){for(var g,y=arguments.length,S=new Array(y),b=0;b<y;b++)S[b]=arguments[b];if(S.some(D=>D==null?void 0:D.triggerCancel)){var I;(g=t.onCancel)===null||g===void 0||(I=g).call.apply(I,[t,()=>{}].concat(Gn(S.slice(1))))}for(let D=0;D<Dp.length;D++)if(Dp[D]===l){Dp.splice(D,1);break}JB(n)}function u(g){clearTimeout(r),r=setTimeout(()=>{const y=e.getPrefixCls(void 0,dU()),S=e.getIconPrefixCls(),b=e.getTheme(),A=un.createElement(Zne,Object.assign({},g));KB(un.createElement(ef,{prefixCls:y,iconPrefixCls:S,theme:b},e.holderRender?e.holderRender(A):A),n)})}function l(){for(var g=arguments.length,y=new Array(g),S=0;S<g;S++)y[S]=arguments[S];i=Object.assign(Object.assign({},i),{open:!1,afterClose:()=>{typeof t.afterClose=="function"&&t.afterClose(),a.apply(this,y)}}),i.visible&&delete i.visible,u(i)}function f(g){typeof g=="function"?i=g(i):i=Object.assign(Object.assign({},i),g),u(i)}return u(i),Dp.push(l),{destroy:l,update:f}}function fU(t){return Object.assign(Object.assign({},t),{type:"warning"})}function pU(t){return Object.assign(Object.assign({},t),{type:"info"})}function mU(t){return Object.assign(Object.assign({},t),{type:"success"})}function gU(t){return Object.assign(Object.assign({},t),{type:"error"})}function vU(t){return Object.assign(Object.assign({},t),{type:"confirm"})}function Yne(t){let{rootPrefixCls:e}=t;hU=e}var Kne=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};const Jne=(t,e)=>{var n,{afterClose:i,config:r}=t,a=Kne(t,["afterClose","config"]);const[u,l]=he.useState(!0),[f,g]=he.useState(r),{direction:y,getPrefixCls:S}=he.useContext(ms),b=S("modal"),A=S(),I=()=>{var N;i(),(N=f.afterClose)===null||N===void 0||N.call(f)},D=function(){var N;l(!1);for(var B=arguments.length,$=new Array(B),K=0;K<B;K++)$[K]=arguments[K];if($.some(ie=>ie==null?void 0:ie.triggerCancel)){var W;(N=f.onCancel)===null||N===void 0||(W=N).call.apply(W,[f,()=>{}].concat(Gn($.slice(1))))}};he.useImperativeHandle(e,()=>({destroy:D,update:N=>{g(B=>Object.assign(Object.assign({},B),N))}}));const L=(n=f.okCancel)!==null&&n!==void 0?n:f.type==="confirm",[P]=t3("Modal",Pp.Modal);return he.createElement(uU,Object.assign({prefixCls:b,rootPrefixCls:A},f,{close:D,open:u,afterClose:I,okText:f.okText||(L?P==null?void 0:P.okText:P==null?void 0:P.justOkText),direction:f.direction||y,cancelText:f.cancelText||(P==null?void 0:P.cancelText)},a))},Qne=he.forwardRef(Jne);let yU=0;const eie=he.memo(he.forwardRef((t,e)=>{const[n,i]=VQ();return he.useImperativeHandle(e,()=>({patchElement:i}),[]),he.createElement(he.Fragment,null,n)}));function tie(){const t=he.useRef(null),[e,n]=he.useState([]);he.useEffect(()=>{e.length&&(Gn(e).forEach(u=>{u()}),n([]))},[e]);const i=he.useCallback(a=>function(l){var f;yU+=1;const g=he.createRef();let y;const S=new Promise(L=>{y=L});let b=!1,A;const I=he.createElement(Qne,{key:`modal-${yU}`,config:a(l),ref:g,afterClose:()=>{A==null||A()},isSilent:()=>b,onConfirm:L=>{y(L)}});return A=(f=t.current)===null||f===void 0?void 0:f.patchElement(I),A&&Dp.push(A),{destroy:()=>{function L(){var P;(P=g.current)===null||P===void 0||P.destroy()}g.current?L():n(P=>[].concat(Gn(P),[L]))},update:L=>{function P(){var N;(N=g.current)===null||N===void 0||N.update(L)}g.current?P():n(N=>[].concat(Gn(N),[P]))},then:L=>(b=!0,S.then(L))}},[]);return[he.useMemo(()=>({info:i(pU),success:i(mU),error:i(gU),warning:i(fU),confirm:i(vU)}),[]),he.createElement(eie,{key:"modal-holder",ref:t})]}function nie(t){return e=>he.createElement(ef,{theme:{token:{motion:!1,zIndexPopupBase:0}}},he.createElement(t,Object.assign({},e)))}var iie=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};const rie=nie(t=>{const{prefixCls:e,className:n,closeIcon:i,closable:r,type:a,title:u,children:l,footer:f}=t,g=iie(t,["prefixCls","className","closeIcon","closable","type","title","children","footer"]),{getPrefixCls:y}=he.useContext(ms),S=y(),b=e||y("modal"),A=WB(S),[I,D,L]=aU(b,A),P=`${b}-confirm`;let N={};return a?N={closable:r??!1,title:"",footer:"",children:he.createElement(cU,Object.assign({},t,{prefixCls:b,confirmPrefixCls:P,rootPrefixCls:S,content:l}))}:N={closable:r??!0,title:u,footer:f!==null&&he.createElement(eU,Object.assign({},t)),children:l},I(he.createElement(C6,Object.assign({prefixCls:b,className:pi(D,`${b}-pure-panel`,a&&P,a&&`${P}-${a}`,n,L,A)},g,{closeIcon:Q6(b,i),closable:r},N)))});function _U(t){return X_(fU(t))}const Qa=lU;Qa.useModal=tie,Qa.info=function(e){return X_(pU(e))},Qa.success=function(e){return X_(mU(e))},Qa.error=function(e){return X_(gU(e))},Qa.warning=_U,Qa.warn=_U,Qa.confirm=function(e){return X_(vU(e))},Qa.destroyAll=function(){for(;Dp.length;){const e=Dp.pop();e&&e()}},Qa.config=Yne,Qa._InternalPanelDoNotUseOrYouWillBeFired=rie;const sie=(...t)=>{console!=null&&console.warn&&(Op(t[0])&&(t[0]=`react-i18next:: ${t[0]}`),console.warn(...t))},xU={},fI=(...t)=>{Op(t[0])&&xU[t[0]]||(Op(t[0])&&(xU[t[0]]=new Date),sie(...t))},bU=(t,e)=>()=>{if(t.isInitialized)e();else{const n=()=>{setTimeout(()=>{t.off("initialized",n)},0),e()};t.on("initialized",n)}},wU=(t,e,n)=>{t.loadNamespaces(e,bU(t,n))},SU=(t,e,n,i)=>{Op(n)&&(n=[n]),n.forEach(r=>{t.options.ns.indexOf(r)<0&&t.options.ns.push(r)}),t.loadLanguages(e,bU(t,i))},oie=(t,e,n={})=>!e.languages||!e.languages.length?(fI("i18n.languages were undefined or empty",e.languages),!0):e.hasLoadedNamespace(t,{lng:n.lng,precheck:(i,r)=>{var a;if(((a=n.bindI18n)==null?void 0:a.indexOf("languageChanging"))>-1&&i.services.backendConnector.backend&&i.isLanguageChangingTo&&!r(i.isLanguageChangingTo,t))return!1}}),Op=t=>typeof t=="string",aie=t=>typeof t=="object"&&t!==null,lie=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,cie={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"","&#169;":"","&reg;":"","&#174;":"","&hellip;":"","&#8230;":"","&#x2F;":"/","&#47;":"/"},uie=t=>cie[t];let hie={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:t=>t.replace(lie,uie)};const die=()=>hie;let fie;const pie=()=>fie,mie=he.createContext();class gie{constructor(){this.usedNamespaces={}}addUsedNamespaces(e){e.forEach(n=>{var i;(i=this.usedNamespaces)[n]??(i[n]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}const vie=(t,e)=>{const n=he.useRef();return he.useEffect(()=>{n.current=t},[t,e]),n.current},EU=(t,e,n,i)=>t.getFixedT(e,n,i),yie=(t,e,n,i)=>he.useCallback(EU(t,e,n,i),[t,e,n,i]),pI=(t,e={})=>{var $,K,q,W;const{i18n:n}=e,{i18n:i,defaultNS:r}=he.useContext(mie)||{},a=n||i||pie();if(a&&!a.reportNamespaces&&(a.reportNamespaces=new gie),!a){fI("You will need to pass in an i18next instance by using initReactI18next");const ie=(X,se)=>Op(se)?se:aie(se)&&Op(se.defaultValue)?se.defaultValue:Array.isArray(X)?X[X.length-1]:X,Z=[ie,{},!1];return Z.t=ie,Z.i18n={},Z.ready=!1,Z}($=a.options.react)!=null&&$.wait&&fI("It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");const u={...die(),...a.options.react,...e},{useSuspense:l,keyPrefix:f}=u;let g=r||((K=a.options)==null?void 0:K.defaultNS);g=Op(g)?[g]:g||["translation"],(W=(q=a.reportNamespaces).addUsedNamespaces)==null||W.call(q,g);const y=(a.isInitialized||a.initializedStoreOnce)&&g.every(ie=>oie(ie,a,u)),S=yie(a,e.lng||null,u.nsMode==="fallback"?g:g[0],f),b=()=>S,A=()=>EU(a,e.lng||null,u.nsMode==="fallback"?g:g[0],f),[I,D]=he.useState(b);let L=g.join();e.lng&&(L=`${e.lng}${L}`);const P=vie(L),N=he.useRef(!0);he.useEffect(()=>{const{bindI18n:ie,bindI18nStore:Z}=u;N.current=!0,!y&&!l&&(e.lng?SU(a,e.lng,g,()=>{N.current&&D(A)}):wU(a,g,()=>{N.current&&D(A)})),y&&P&&P!==L&&N.current&&D(A);const X=()=>{N.current&&D(A)};return ie&&(a==null||a.on(ie,X)),Z&&(a==null||a.store.on(Z,X)),()=>{N.current=!1,a&&(ie==null||ie.split(" ").forEach(se=>a.off(se,X))),Z&&a&&Z.split(" ").forEach(se=>a.store.off(se,X))}},[a,L]),he.useEffect(()=>{N.current&&y&&D(b)},[a,f,y]);const B=[I,a,y];if(B.t=I,B.i18n=a,B.ready=y,y||!y&&!l)return B;throw new Promise(ie=>{e.lng?SU(a,e.lng,g,()=>ie()):wU(a,g,()=>ie())})},_ie=({onOk:t,onCancel:e})=>{const[n,i]=he.useState(!0),{t:r}=pI(),a=()=>{i(!1),t&&t()},u=()=>{i(!1),e&&e()};return Ws.jsx(Ws.Fragment,{children:Ws.jsxs(Qa,{className:"modal-geolocate",closeIcon:null,open:n,onOk:a,onCancel:u,okText:r("Allow"),cancelText:r("Deny"),centered:!0,children:[Ws.jsx("h2",{children:r("Allow location access")}),Ws.jsxs("p",{children:[r("Helps you view turn-by-turn directions, find nearby places, and receive real-time traffic updates. Please allow Streetview.vn to access your location.")," (",r("Learn more at")," ",Ws.jsx("a",{href:"#",children:r("Privacy Policy")}),")"]})]})})},xie=()=>new Promise(t=>{const e=Ws.jsx(_ie,{onCancel:()=>t(!1),onOk:()=>t(!0)}),n=document.createElement("div");document.body.appendChild(n),gv.render(e,n)}),{GeolocateControl:bie,GeolocateControlOptions:Sle}=PD;class wie extends bie{constructor(e){super(e)}async getGeolocationPermission(){return window.navigator.permissions?(await window.navigator.permissions.query({name:"geolocation"})).state:geolocationPermissions.UNSUPPORTED}async trigger(){await this.getGeolocationPermission()==="prompt"&&!await xie()||super.trigger()}}const Sie=`<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<g opacity="0.48">
<path d="M7.99609 18.8343C6.58478 18.9923 4.94184 19.9152 3.73236 20.728C3.02399 21.204 1.99609 20.7091 1.99609 19.8557V10.1863C1.99609 9.60107 2.25147 9.04435 2.71824 8.69142C3.72813 7.92782 5.63209 6.62242 7.35306 6.19238M7.99609 18.8343C11.3144 18.4629 12.6778 22.3958 15.9961 22.0244M7.99609 18.8343V9.37839M15.9961 22.0244C17.8634 21.8154 20.1361 20.2673 21.2739 19.407C21.7407 19.054 21.9961 18.4973 21.9961 17.9121V8.24273C21.9961 7.38927 20.9682 6.89437 20.2598 7.37039C19.2649 8.03897 17.9767 8.78208 16.7654 9.11264M15.9961 22.0244V11.2113" stroke="white" stroke-width="1.5"/>
<path d="M17.458 6.86348C17.458 9.51444 14.958 14.0635 12.458 14.0635C9.95801 14.0635 7.45801 9.51444 7.45801 6.86348C7.45801 4.21251 9.69658 2.06348 12.458 2.06348C15.2194 2.06348 17.458 4.21251 17.458 6.86348Z" stroke="white" stroke-width="1.5"/>
<path d="M13.958 6.56348C13.958 7.3919 13.2864 8.06348 12.458 8.06348C11.6296 8.06348 10.958 7.3919 10.958 6.56348C10.958 5.73505 11.6296 5.06348 12.458 5.06348C13.2864 5.06348 13.958 5.73505 13.958 6.56348Z" stroke="white" stroke-width="1.5"/>
</g>
</svg>
`;var Z_=(t=>(t[t.DEFAULT=0]="DEFAULT",t[t.DIAGONAL=1]="DIAGONAL",t[t.HORIZONTAL=2]="HORIZONTAL",t[t.VERTICAL=3]="VERTICAL",t))(Z_||{});const qS={top:"bottom",bottom:"top",left:"right",right:"left"};function Eie(t,e){switch(e){case 1:return[qS[t[0]],qS[t[1]]];case 2:return[t[0],qS[t[1]]];case 3:return[qS[t[0]],t[1]];default:return t}}class XS extends da{constructor(e,n){super(e,{}),this.plan=e,this.position=n,this.viewer=e==null?void 0:e.viewer}applyConfig(){this.container.className=`psv-plan__button psv-plan__button--${Eie(this.plan.config.position,this.position).join("-")}`,this.update()}update(){}}const mI=`<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M16.2431 7.75738L7.75781 16.2427M16.2431 16.2426L7.75781 7.75732" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
`;class Mie extends XS{constructor(e){super(e,Z_.DEFAULT),this.container.addEventListener("click",n=>{e.toggleCollapse(),n.stopPropagation()})}applyConfig(){super.applyConfig(),this.container.classList.add("psv-plan__button-close")}update(){this.container.innerHTML=this.plan.collapsed?Sie:mI,this.container.title=this.plan.collapsed?this.viewer.config.lang.map:this.viewer.config.lang.close}}const Cie=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="20 20 60 60" fill="currentColor"><path d="M21.94,40.2,49.22,51.84a2,2,0,0,0,1.57,0L78.06,40.2a2,2,0,0,0,0-3.68L50.78,24.89a2,2,0,0,0-1.57,0L21.94,36.52a2,2,0,0,0,0,3.68Z"/><path d="M76.49,59.8,50,71.1,23.51,59.8a2,2,0,0,0-1.57,3.68L49.22,75.11a2,2,0,0,0,1.57,0L78.06,63.48a2,2,0,0,0-1.57-3.68Z"/><path d="M76.49,48.16,50,59.46,23.51,48.16a2,2,0,0,0-1.57,3.68L49.22,63.48a2,2,0,0,0,1.57,0L78.06,51.84a2,2,0,0,0-1.57-3.68Z"/><!-- Created by Prithvi from the Noun Project --></svg>
`;class Tie extends XS{constructor(n){super(n,Z_.VERTICAL);yn(this,"select");const i=this.viewer.config.lang.mapLayers;this.container.title=i,this.container.innerHTML=Cie,this.select=document.createElement("select"),this.select.className="psv-plan__layers-select",this.select.setAttribute("aria-label",i);const r=document.createElement("option");r.disabled=!0,r.innerText=i,this.select.appendChild(r),this.select.addEventListener("change",()=>{n.setLayer(this.select.value),this.__setSelected()}),this.container.appendChild(this.select),this.hide()}setLayers(n){this.show(),n.forEach(i=>{const r=document.createElement("option");r.value=i,r.innerText=i,this.select.appendChild(r)}),this.select.value=n[0],this.__setSelected()}__setSelected(){var n;(n=this.select.querySelector("[selected]"))==null||n.removeAttribute("selected"),this.select.querySelector(`[value="${this.select.value}"]`).setAttribute("selected","selected")}}const MU=`<svg width="24" height="25" viewBox="0 0 24 25" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M13.4961 6.93555H17.9961M17.9961 6.93555V11.4355M17.9961 6.93555L5.99609 18.9355M5.99609 18.9355V14.4355M5.99609 18.9355H10.4961" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
`,Aie=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path d="M14 6V0h-2v8h8V6zM0 12v2h6v6h2v-8H6z"/><!-- Created by Stepan Voevodin from the Noun Project --></svg>
`,Pie={"bottom-left":0,"bottom-right":-90,"top-right":180,"top-left":90};class Iie extends XS{constructor(e){super(e,Z_.DIAGONAL),this.container.addEventListener("click",n=>{e.toggleMaximized(),n.stopPropagation()})}update(){this.container.innerHTML=this.plan.maximized?Aie:MU,this.container.querySelector("svg").style.transform=`rotate3d(0, 0, 1, ${Pie[this.plan.config.position.join("-")]}deg)`,this.container.title=this.plan.maximized?this.viewer.config.lang.mapMinimize:this.viewer.config.lang.mapMaximize}}function CU(){return typeof window>"u"?!1:window.innerWidth<=768}const Rie={type:"logger",log(t){this.output("log",t)},warn(t){this.output("warn",t)},error(t){this.output("error",t)},output(t,e){console&&console[t]&&console[t].apply(console,e)}};class ZS{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.init(e,n)}init(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.prefix=n.prefix||"i18next:",this.logger=e||Rie,this.options=n,this.debug=n.debug}log(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return this.forward(n,"log","",!0)}warn(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return this.forward(n,"warn","",!0)}error(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return this.forward(n,"error","")}deprecate(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return this.forward(n,"warn","WARNING DEPRECATED: ",!0)}forward(e,n,i,r){return r&&!this.debug?null:(typeof e[0]=="string"&&(e[0]=`${i}${this.prefix} ${e[0]}`),this.logger[n](e))}create(e){return new ZS(this.logger,{prefix:`${this.prefix}:${e}:`,...this.options})}clone(e){return e=e||this.options,e.prefix=e.prefix||this.prefix,new ZS(this.logger,e)}}var cu=new ZS;class YS{constructor(){this.observers={}}on(e,n){return e.split(" ").forEach(i=>{this.observers[i]||(this.observers[i]=new Map);const r=this.observers[i].get(n)||0;this.observers[i].set(n,r+1)}),this}off(e,n){if(this.observers[e]){if(!n){delete this.observers[e];return}this.observers[e].delete(n)}}emit(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];this.observers[e]&&Array.from(this.observers[e].entries()).forEach(u=>{let[l,f]=u;for(let g=0;g<f;g++)l(...i)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(u=>{let[l,f]=u;for(let g=0;g<f;g++)l.apply(l,[e,...i])})}}const Y_=()=>{let t,e;const n=new Promise((i,r)=>{t=i,e=r});return n.resolve=t,n.reject=e,n},TU=t=>t==null?"":""+t,Lie=(t,e,n)=>{t.forEach(i=>{e[i]&&(n[i]=e[i])})},kie=/###/g,AU=t=>t&&t.indexOf("###")>-1?t.replace(kie,"."):t,PU=t=>!t||typeof t=="string",K_=(t,e,n)=>{const i=typeof e!="string"?e:e.split(".");let r=0;for(;r<i.length-1;){if(PU(t))return{};const a=AU(i[r]);!t[a]&&n&&(t[a]=new n),Object.prototype.hasOwnProperty.call(t,a)?t=t[a]:t={},++r}return PU(t)?{}:{obj:t,k:AU(i[r])}},IU=(t,e,n)=>{const{obj:i,k:r}=K_(t,e,Object);if(i!==void 0||e.length===1){i[r]=n;return}let a=e[e.length-1],u=e.slice(0,e.length-1),l=K_(t,u,Object);for(;l.obj===void 0&&u.length;)a=`${u[u.length-1]}.${a}`,u=u.slice(0,u.length-1),l=K_(t,u,Object),l&&l.obj&&typeof l.obj[`${l.k}.${a}`]<"u"&&(l.obj=void 0);l.obj[`${l.k}.${a}`]=n},Die=(t,e,n,i)=>{const{obj:r,k:a}=K_(t,e,Object);r[a]=r[a]||[],r[a].push(n)},KS=(t,e)=>{const{obj:n,k:i}=K_(t,e);if(n)return n[i]},Oie=(t,e,n)=>{const i=KS(t,n);return i!==void 0?i:KS(e,n)},RU=(t,e,n)=>{for(const i in e)i!=="__proto__"&&i!=="constructor"&&(i in t?typeof t[i]=="string"||t[i]instanceof String||typeof e[i]=="string"||e[i]instanceof String?n&&(t[i]=e[i]):RU(t[i],e[i],n):t[i]=e[i]);return t},Fv=t=>t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var Fie={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const zie=t=>typeof t=="string"?t.replace(/[&<>"'\/]/g,e=>Fie[e]):t;class Nie{constructor(e){this.capacity=e,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(e){const n=this.regExpMap.get(e);if(n!==void 0)return n;const i=new RegExp(e);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(e,i),this.regExpQueue.push(e),i}}const Bie=[" ",",","?","!",";"],Uie=new Nie(20),Vie=(t,e,n)=>{e=e||"",n=n||"";const i=Bie.filter(u=>e.indexOf(u)<0&&n.indexOf(u)<0);if(i.length===0)return!0;const r=Uie.getRegExp(`(${i.map(u=>u==="?"?"\\?":u).join("|")})`);let a=!r.test(t);if(!a){const u=t.indexOf(n);u>0&&!r.test(t.substring(0,u))&&(a=!0)}return a},gI=function(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:".";if(!t)return;if(t[e])return t[e];const i=e.split(n);let r=t;for(let a=0;a<i.length;){if(!r||typeof r!="object")return;let u,l="";for(let f=a;f<i.length;++f)if(f!==a&&(l+=n),l+=i[f],u=r[l],u!==void 0){if(["string","number","boolean"].indexOf(typeof u)>-1&&f<i.length-1)continue;a+=f-a+1;break}r=u}return r},JS=t=>t&&t.indexOf("_")>0?t.replace("_","-"):t;class LU extends YS{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{ns:["translation"],defaultNS:"translation"};super(),this.data=e||{},this.options=n,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}removeNamespaces(e){const n=this.options.ns.indexOf(e);n>-1&&this.options.ns.splice(n,1)}getResource(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const a=r.keySeparator!==void 0?r.keySeparator:this.options.keySeparator,u=r.ignoreJSONStructure!==void 0?r.ignoreJSONStructure:this.options.ignoreJSONStructure;let l;e.indexOf(".")>-1?l=e.split("."):(l=[e,n],i&&(Array.isArray(i)?l.push(...i):typeof i=="string"&&a?l.push(...i.split(a)):l.push(i)));const f=KS(this.data,l);return!f&&!n&&!i&&e.indexOf(".")>-1&&(e=l[0],n=l[1],i=l.slice(2).join(".")),f||!u||typeof i!="string"?f:gI(this.data&&this.data[e]&&this.data[e][n],i,a)}addResource(e,n,i,r){let a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{silent:!1};const u=a.keySeparator!==void 0?a.keySeparator:this.options.keySeparator;let l=[e,n];i&&(l=l.concat(u?i.split(u):i)),e.indexOf(".")>-1&&(l=e.split("."),r=n,n=l[1]),this.addNamespaces(n),IU(this.data,l,r),a.silent||this.emit("added",e,n,i,r)}addResources(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{silent:!1};for(const a in i)(typeof i[a]=="string"||Array.isArray(i[a]))&&this.addResource(e,n,a,i[a],{silent:!0});r.silent||this.emit("added",e,n,i)}addResourceBundle(e,n,i,r,a){let u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{silent:!1,skipCopy:!1},l=[e,n];e.indexOf(".")>-1&&(l=e.split("."),r=i,i=n,n=l[1]),this.addNamespaces(n);let f=KS(this.data,l)||{};u.skipCopy||(i=JSON.parse(JSON.stringify(i))),r?RU(f,i,a):f={...f,...i},IU(this.data,l,f),u.silent||this.emit("added",e,n,i)}removeResourceBundle(e,n){this.hasResourceBundle(e,n)&&delete this.data[e][n],this.removeNamespaces(n),this.emit("removed",e,n)}hasResourceBundle(e,n){return this.getResource(e,n)!==void 0}getResourceBundle(e,n){return n||(n=this.options.defaultNS),this.options.compatibilityAPI==="v1"?{...this.getResource(e,n)}:this.getResource(e,n)}getDataByLanguage(e){return this.data[e]}hasLanguageSomeTranslations(e){const n=this.getDataByLanguage(e);return!!(n&&Object.keys(n)||[]).find(r=>n[r]&&Object.keys(n[r]).length>0)}toJSON(){return this.data}}var kU={processors:{},addPostProcessor(t){this.processors[t.name]=t},handle(t,e,n,i,r){return t.forEach(a=>{this.processors[a]&&(e=this.processors[a].process(e,n,i,r))}),e}};const DU={};class QS extends YS{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Lie(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],e,this),this.options=n,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=cu.create("translator")}changeLanguage(e){e&&(this.language=e)}exists(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};if(e==null)return!1;const i=this.resolve(e,n);return i&&i.res!==void 0}extractFromKey(e,n){let i=n.nsSeparator!==void 0?n.nsSeparator:this.options.nsSeparator;i===void 0&&(i=":");const r=n.keySeparator!==void 0?n.keySeparator:this.options.keySeparator;let a=n.ns||this.options.defaultNS||[];const u=i&&e.indexOf(i)>-1,l=!this.options.userDefinedKeySeparator&&!n.keySeparator&&!this.options.userDefinedNsSeparator&&!n.nsSeparator&&!Vie(e,i,r);if(u&&!l){const f=e.match(this.interpolator.nestingRegexp);if(f&&f.length>0)return{key:e,namespaces:a};const g=e.split(i);(i!==r||i===r&&this.options.ns.indexOf(g[0])>-1)&&(a=g.shift()),e=g.join(r)}return typeof a=="string"&&(a=[a]),{key:e,namespaces:a}}translate(e,n,i){if(typeof n!="object"&&this.options.overloadTranslationOptionHandler&&(n=this.options.overloadTranslationOptionHandler(arguments)),typeof n=="object"&&(n={...n}),n||(n={}),e==null)return"";Array.isArray(e)||(e=[String(e)]);const r=n.returnDetails!==void 0?n.returnDetails:this.options.returnDetails,a=n.keySeparator!==void 0?n.keySeparator:this.options.keySeparator,{key:u,namespaces:l}=this.extractFromKey(e[e.length-1],n),f=l[l.length-1],g=n.lng||this.language,y=n.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(g&&g.toLowerCase()==="cimode"){if(y){const $=n.nsSeparator||this.options.nsSeparator;return r?{res:`${f}${$}${u}`,usedKey:u,exactUsedKey:u,usedLng:g,usedNS:f,usedParams:this.getUsedParamsDetails(n)}:`${f}${$}${u}`}return r?{res:u,usedKey:u,exactUsedKey:u,usedLng:g,usedNS:f,usedParams:this.getUsedParamsDetails(n)}:u}const S=this.resolve(e,n);let b=S&&S.res;const A=S&&S.usedKey||u,I=S&&S.exactUsedKey||u,D=Object.prototype.toString.apply(b),L=["[object Number]","[object Function]","[object RegExp]"],P=n.joinArrays!==void 0?n.joinArrays:this.options.joinArrays,N=!this.i18nFormat||this.i18nFormat.handleAsObject;if(N&&b&&(typeof b!="string"&&typeof b!="boolean"&&typeof b!="number")&&L.indexOf(D)<0&&!(typeof P=="string"&&Array.isArray(b))){if(!n.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const $=this.options.returnedObjectHandler?this.options.returnedObjectHandler(A,b,{...n,ns:l}):`key '${u} (${this.language})' returned an object instead of string.`;return r?(S.res=$,S.usedParams=this.getUsedParamsDetails(n),S):$}if(a){const $=Array.isArray(b),K=$?[]:{},q=$?I:A;for(const W in b)if(Object.prototype.hasOwnProperty.call(b,W)){const ie=`${q}${a}${W}`;K[W]=this.translate(ie,{...n,joinArrays:!1,ns:l}),K[W]===ie&&(K[W]=b[W])}b=K}}else if(N&&typeof P=="string"&&Array.isArray(b))b=b.join(P),b&&(b=this.extendTranslation(b,e,n,i));else{let $=!1,K=!1;const q=n.count!==void 0&&typeof n.count!="string",W=QS.hasDefaultValue(n),ie=q?this.pluralResolver.getSuffix(g,n.count,n):"",Z=n.ordinal&&q?this.pluralResolver.getSuffix(g,n.count,{ordinal:!1}):"",X=q&&!n.ordinal&&n.count===0&&this.pluralResolver.shouldUseIntlApi(),se=X&&n[`defaultValue${this.options.pluralSeparator}zero`]||n[`defaultValue${ie}`]||n[`defaultValue${Z}`]||n.defaultValue;!this.isValidLookup(b)&&W&&($=!0,b=se),this.isValidLookup(b)||(K=!0,b=u);const Se=(n.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&K?void 0:b,Me=W&&se!==b&&this.options.updateMissing;if(K||$||Me){if(this.logger.log(Me?"updateKey":"missingKey",g,f,u,Me?se:b),a){const ge=this.resolve(u,{...n,keySeparator:!1});ge&&ge.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let Ye=[];const ye=this.languageUtils.getFallbackCodes(this.options.fallbackLng,n.lng||this.language);if(this.options.saveMissingTo==="fallback"&&ye&&ye[0])for(let ge=0;ge<ye.length;ge++)Ye.push(ye[ge]);else this.options.saveMissingTo==="all"?Ye=this.languageUtils.toResolveHierarchy(n.lng||this.language):Ye.push(n.lng||this.language);const Ce=(ge,Be,Ze)=>{const je=W&&Ze!==b?Ze:Se;this.options.missingKeyHandler?this.options.missingKeyHandler(ge,f,Be,je,Me,n):this.backendConnector&&this.backendConnector.saveMissing&&this.backendConnector.saveMissing(ge,f,Be,je,Me,n),this.emit("missingKey",ge,f,Be,b)};this.options.saveMissing&&(this.options.saveMissingPlurals&&q?Ye.forEach(ge=>{const Be=this.pluralResolver.getSuffixes(ge,n);X&&n[`defaultValue${this.options.pluralSeparator}zero`]&&Be.indexOf(`${this.options.pluralSeparator}zero`)<0&&Be.push(`${this.options.pluralSeparator}zero`),Be.forEach(Ze=>{Ce([ge],u+Ze,n[`defaultValue${Ze}`]||se)})}):Ce(Ye,u,se))}b=this.extendTranslation(b,e,n,S,i),K&&b===u&&this.options.appendNamespaceToMissingKey&&(b=`${f}:${u}`),(K||$)&&this.options.parseMissingKeyHandler&&(this.options.compatibilityAPI!=="v1"?b=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${f}:${u}`:u,$?b:void 0):b=this.options.parseMissingKeyHandler(b))}return r?(S.res=b,S.usedParams=this.getUsedParamsDetails(n),S):b}extendTranslation(e,n,i,r,a){var u=this;if(this.i18nFormat&&this.i18nFormat.parse)e=this.i18nFormat.parse(e,{...this.options.interpolation.defaultVariables,...i},i.lng||this.language||r.usedLng,r.usedNS,r.usedKey,{resolved:r});else if(!i.skipInterpolation){i.interpolation&&this.interpolator.init({...i,interpolation:{...this.options.interpolation,...i.interpolation}});const g=typeof e=="string"&&(i&&i.interpolation&&i.interpolation.skipOnVariables!==void 0?i.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let y;if(g){const b=e.match(this.interpolator.nestingRegexp);y=b&&b.length}let S=i.replace&&typeof i.replace!="string"?i.replace:i;if(this.options.interpolation.defaultVariables&&(S={...this.options.interpolation.defaultVariables,...S}),e=this.interpolator.interpolate(e,S,i.lng||this.language||r.usedLng,i),g){const b=e.match(this.interpolator.nestingRegexp),A=b&&b.length;y<A&&(i.nest=!1)}!i.lng&&this.options.compatibilityAPI!=="v1"&&r&&r.res&&(i.lng=this.language||r.usedLng),i.nest!==!1&&(e=this.interpolator.nest(e,function(){for(var b=arguments.length,A=new Array(b),I=0;I<b;I++)A[I]=arguments[I];return a&&a[0]===A[0]&&!i.context?(u.logger.warn(`It seems you are nesting recursively key: ${A[0]} in key: ${n[0]}`),null):u.translate(...A,n)},i)),i.interpolation&&this.interpolator.reset()}const l=i.postProcess||this.options.postProcess,f=typeof l=="string"?[l]:l;return e!=null&&f&&f.length&&i.applyPostProcessor!==!1&&(e=kU.handle(f,e,n,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...r,usedParams:this.getUsedParamsDetails(i)},...i}:i,this)),e}resolve(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i,r,a,u,l;return typeof e=="string"&&(e=[e]),e.forEach(f=>{if(this.isValidLookup(i))return;const g=this.extractFromKey(f,n),y=g.key;r=y;let S=g.namespaces;this.options.fallbackNS&&(S=S.concat(this.options.fallbackNS));const b=n.count!==void 0&&typeof n.count!="string",A=b&&!n.ordinal&&n.count===0&&this.pluralResolver.shouldUseIntlApi(),I=n.context!==void 0&&(typeof n.context=="string"||typeof n.context=="number")&&n.context!=="",D=n.lngs?n.lngs:this.languageUtils.toResolveHierarchy(n.lng||this.language,n.fallbackLng);S.forEach(L=>{this.isValidLookup(i)||(l=L,!DU[`${D[0]}-${L}`]&&this.utils&&this.utils.hasLoadedNamespace&&!this.utils.hasLoadedNamespace(l)&&(DU[`${D[0]}-${L}`]=!0,this.logger.warn(`key "${r}" for languages "${D.join(", ")}" won't get resolved as namespace "${l}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),D.forEach(P=>{if(this.isValidLookup(i))return;u=P;const N=[y];if(this.i18nFormat&&this.i18nFormat.addLookupKeys)this.i18nFormat.addLookupKeys(N,y,P,L,n);else{let $;b&&($=this.pluralResolver.getSuffix(P,n.count,n));const K=`${this.options.pluralSeparator}zero`,q=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(b&&(N.push(y+$),n.ordinal&&$.indexOf(q)===0&&N.push(y+$.replace(q,this.options.pluralSeparator)),A&&N.push(y+K)),I){const W=`${y}${this.options.contextSeparator}${n.context}`;N.push(W),b&&(N.push(W+$),n.ordinal&&$.indexOf(q)===0&&N.push(W+$.replace(q,this.options.pluralSeparator)),A&&N.push(W+K))}}let B;for(;B=N.pop();)this.isValidLookup(i)||(a=B,i=this.getResource(P,L,B,n))}))})}),{res:i,usedKey:r,exactUsedKey:a,usedLng:u,usedNS:l}}isValidLookup(e){return e!==void 0&&!(!this.options.returnNull&&e===null)&&!(!this.options.returnEmptyString&&e==="")}getResource(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(e,n,i,r):this.resourceStore.getResource(e,n,i,r)}getUsedParamsDetails(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],i=e.replace&&typeof e.replace!="string";let r=i?e.replace:e;if(i&&typeof e.count<"u"&&(r.count=e.count),this.options.interpolation.defaultVariables&&(r={...this.options.interpolation.defaultVariables,...r}),!i){r={...r};for(const a of n)delete r[a]}return r}static hasDefaultValue(e){const n="defaultValue";for(const i in e)if(Object.prototype.hasOwnProperty.call(e,i)&&n===i.substring(0,n.length)&&e[i]!==void 0)return!0;return!1}}const vI=t=>t.charAt(0).toUpperCase()+t.slice(1);class OU{constructor(e){this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=cu.create("languageUtils")}getScriptPartFromCode(e){if(e=JS(e),!e||e.indexOf("-")<0)return null;const n=e.split("-");return n.length===2||(n.pop(),n[n.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(n.join("-"))}getLanguagePartFromCode(e){if(e=JS(e),!e||e.indexOf("-")<0)return e;const n=e.split("-");return this.formatLanguageCode(n[0])}formatLanguageCode(e){if(typeof e=="string"&&e.indexOf("-")>-1){const n=["hans","hant","latn","cyrl","cans","mong","arab"];let i=e.split("-");return this.options.lowerCaseLng?i=i.map(r=>r.toLowerCase()):i.length===2?(i[0]=i[0].toLowerCase(),i[1]=i[1].toUpperCase(),n.indexOf(i[1].toLowerCase())>-1&&(i[1]=vI(i[1].toLowerCase()))):i.length===3&&(i[0]=i[0].toLowerCase(),i[1].length===2&&(i[1]=i[1].toUpperCase()),i[0]!=="sgn"&&i[2].length===2&&(i[2]=i[2].toUpperCase()),n.indexOf(i[1].toLowerCase())>-1&&(i[1]=vI(i[1].toLowerCase())),n.indexOf(i[2].toLowerCase())>-1&&(i[2]=vI(i[2].toLowerCase()))),i.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}isSupportedCode(e){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}getBestMatchFromCodes(e){if(!e)return null;let n;return e.forEach(i=>{if(n)return;const r=this.formatLanguageCode(i);(!this.options.supportedLngs||this.isSupportedCode(r))&&(n=r)}),!n&&this.options.supportedLngs&&e.forEach(i=>{if(n)return;const r=this.getLanguagePartFromCode(i);if(this.isSupportedCode(r))return n=r;n=this.options.supportedLngs.find(a=>{if(a===r)return a;if(!(a.indexOf("-")<0&&r.indexOf("-")<0)&&(a.indexOf("-")>0&&r.indexOf("-")<0&&a.substring(0,a.indexOf("-"))===r||a.indexOf(r)===0&&r.length>1))return a})}),n||(n=this.getFallbackCodes(this.options.fallbackLng)[0]),n}getFallbackCodes(e,n){if(!e)return[];if(typeof e=="function"&&(e=e(n)),typeof e=="string"&&(e=[e]),Array.isArray(e))return e;if(!n)return e.default||[];let i=e[n];return i||(i=e[this.getScriptPartFromCode(n)]),i||(i=e[this.formatLanguageCode(n)]),i||(i=e[this.getLanguagePartFromCode(n)]),i||(i=e.default),i||[]}toResolveHierarchy(e,n){const i=this.getFallbackCodes(n||this.options.fallbackLng||[],e),r=[],a=u=>{u&&(this.isSupportedCode(u)?r.push(u):this.logger.warn(`rejecting language code not found in supportedLngs: ${u}`))};return typeof e=="string"&&(e.indexOf("-")>-1||e.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&a(this.formatLanguageCode(e)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&a(this.getScriptPartFromCode(e)),this.options.load!=="currentOnly"&&a(this.getLanguagePartFromCode(e))):typeof e=="string"&&a(this.formatLanguageCode(e)),i.forEach(u=>{r.indexOf(u)<0&&a(this.formatLanguageCode(u))}),r}}let $ie=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kk","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],Hie={1:t=>+(t>1),2:t=>+(t!=1),3:t=>0,4:t=>t%10==1&&t%100!=11?0:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?1:2,5:t=>t==0?0:t==1?1:t==2?2:t%100>=3&&t%100<=10?3:t%100>=11?4:5,6:t=>t==1?0:t>=2&&t<=4?1:2,7:t=>t==1?0:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?1:2,8:t=>t==1?0:t==2?1:t!=8&&t!=11?2:3,9:t=>+(t>=2),10:t=>t==1?0:t==2?1:t<7?2:t<11?3:4,11:t=>t==1||t==11?0:t==2||t==12?1:t>2&&t<20?2:3,12:t=>+(t%10!=1||t%100==11),13:t=>+(t!==0),14:t=>t==1?0:t==2?1:t==3?2:3,15:t=>t%10==1&&t%100!=11?0:t%10>=2&&(t%100<10||t%100>=20)?1:2,16:t=>t%10==1&&t%100!=11?0:t!==0?1:2,17:t=>t==1||t%10==1&&t%100!=11?0:1,18:t=>t==0?0:t==1?1:2,19:t=>t==1?0:t==0||t%100>1&&t%100<11?1:t%100>10&&t%100<20?2:3,20:t=>t==1?0:t==0||t%100>0&&t%100<20?1:2,21:t=>t%100==1?1:t%100==2?2:t%100==3||t%100==4?3:0,22:t=>t==1?0:t==2?1:(t<0||t>10)&&t%10==0?2:3};const Gie=["v1","v2","v3"],Wie=["v4"],FU={zero:0,one:1,two:2,few:3,many:4,other:5},jie=()=>{const t={};return $ie.forEach(e=>{e.lngs.forEach(n=>{t[n]={numbers:e.nr,plurals:Hie[e.fc]}})}),t};class qie{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.languageUtils=e,this.options=n,this.logger=cu.create("pluralResolver"),(!this.options.compatibilityJSON||Wie.includes(this.options.compatibilityJSON))&&(typeof Intl>"u"||!Intl.PluralRules)&&(this.options.compatibilityJSON="v3",this.logger.error("Your environment seems not to be Intl API compatible, use an Intl.PluralRules polyfill. Will fallback to the compatibilityJSON v3 format handling.")),this.rules=jie(),this.pluralRulesCache={}}addRule(e,n){this.rules[e]=n}clearCache(){this.pluralRulesCache={}}getRule(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.shouldUseIntlApi())try{const i=JS(e==="dev"?"en":e),r=n.ordinal?"ordinal":"cardinal",a=JSON.stringify({cleanedCode:i,type:r});if(a in this.pluralRulesCache)return this.pluralRulesCache[a];const u=new Intl.PluralRules(i,{type:r});return this.pluralRulesCache[a]=u,u}catch{return}return this.rules[e]||this.rules[this.languageUtils.getLanguagePartFromCode(e)]}needsPlural(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i=this.getRule(e,n);return this.shouldUseIntlApi()?i&&i.resolvedOptions().pluralCategories.length>1:i&&i.numbers.length>1}getPluralFormsOfKey(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.getSuffixes(e,i).map(r=>`${n}${r}`)}getSuffixes(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i=this.getRule(e,n);return i?this.shouldUseIntlApi()?i.resolvedOptions().pluralCategories.sort((r,a)=>FU[r]-FU[a]).map(r=>`${this.options.prepend}${n.ordinal?`ordinal${this.options.prepend}`:""}${r}`):i.numbers.map(r=>this.getSuffix(e,r,n)):[]}getSuffix(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=this.getRule(e,i);return r?this.shouldUseIntlApi()?`${this.options.prepend}${i.ordinal?`ordinal${this.options.prepend}`:""}${r.select(n)}`:this.getSuffixRetroCompatible(r,n):(this.logger.warn(`no plural rule found for: ${e}`),"")}getSuffixRetroCompatible(e,n){const i=e.noAbs?e.plurals(n):e.plurals(Math.abs(n));let r=e.numbers[i];this.options.simplifyPluralSuffix&&e.numbers.length===2&&e.numbers[0]===1&&(r===2?r="plural":r===1&&(r=""));const a=()=>this.options.prepend&&r.toString()?this.options.prepend+r.toString():r.toString();return this.options.compatibilityJSON==="v1"?r===1?"":typeof r=="number"?`_plural_${r.toString()}`:a():this.options.compatibilityJSON==="v2"||this.options.simplifyPluralSuffix&&e.numbers.length===2&&e.numbers[0]===1?a():this.options.prepend&&i.toString()?this.options.prepend+i.toString():i.toString()}shouldUseIntlApi(){return!Gie.includes(this.options.compatibilityJSON)}}const zU=function(t,e,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:".",r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,a=Oie(t,e,n);return!a&&r&&typeof n=="string"&&(a=gI(t,n,i),a===void 0&&(a=gI(e,n,i))),a},yI=t=>t.replace(/\$/g,"$$$$");class Xie{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=cu.create("interpolator"),this.options=e,this.format=e.interpolation&&e.interpolation.format||(n=>n),this.init(e)}init(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.interpolation||(e.interpolation={escapeValue:!0});const{escape:n,escapeValue:i,useRawValueToEscape:r,prefix:a,prefixEscaped:u,suffix:l,suffixEscaped:f,formatSeparator:g,unescapeSuffix:y,unescapePrefix:S,nestingPrefix:b,nestingPrefixEscaped:A,nestingSuffix:I,nestingSuffixEscaped:D,nestingOptionsSeparator:L,maxReplaces:P,alwaysFormat:N}=e.interpolation;this.escape=n!==void 0?n:zie,this.escapeValue=i!==void 0?i:!0,this.useRawValueToEscape=r!==void 0?r:!1,this.prefix=a?Fv(a):u||"{{",this.suffix=l?Fv(l):f||"}}",this.formatSeparator=g||",",this.unescapePrefix=y?"":S||"-",this.unescapeSuffix=this.unescapePrefix?"":y||"",this.nestingPrefix=b?Fv(b):A||Fv("$t("),this.nestingSuffix=I?Fv(I):D||Fv(")"),this.nestingOptionsSeparator=L||",",this.maxReplaces=P||1e3,this.alwaysFormat=N!==void 0?N:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const e=(n,i)=>n&&n.source===i?(n.lastIndex=0,n):new RegExp(i,"g");this.regexp=e(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=e(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=e(this.nestingRegexp,`${this.nestingPrefix}(.+?)${this.nestingSuffix}`)}interpolate(e,n,i,r){let a,u,l;const f=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},g=A=>{if(A.indexOf(this.formatSeparator)<0){const P=zU(n,f,A,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(P,void 0,i,{...r,...n,interpolationkey:A}):P}const I=A.split(this.formatSeparator),D=I.shift().trim(),L=I.join(this.formatSeparator).trim();return this.format(zU(n,f,D,this.options.keySeparator,this.options.ignoreJSONStructure),L,i,{...r,...n,interpolationkey:D})};this.resetRegExp();const y=r&&r.missingInterpolationHandler||this.options.missingInterpolationHandler,S=r&&r.interpolation&&r.interpolation.skipOnVariables!==void 0?r.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:A=>yI(A)},{regex:this.regexp,safeValue:A=>this.escapeValue?yI(this.escape(A)):yI(A)}].forEach(A=>{for(l=0;a=A.regex.exec(e);){const I=a[1].trim();if(u=g(I),u===void 0)if(typeof y=="function"){const L=y(e,a,r);u=typeof L=="string"?L:""}else if(r&&Object.prototype.hasOwnProperty.call(r,I))u="";else if(S){u=a[0];continue}else this.logger.warn(`missed to pass in variable ${I} for interpolating ${e}`),u="";else typeof u!="string"&&!this.useRawValueToEscape&&(u=TU(u));const D=A.safeValue(u);if(e=e.replace(a[0],D),S?(A.regex.lastIndex+=u.length,A.regex.lastIndex-=a[0].length):A.regex.lastIndex=0,l++,l>=this.maxReplaces)break}}),e}nest(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r,a,u;const l=(f,g)=>{const y=this.nestingOptionsSeparator;if(f.indexOf(y)<0)return f;const S=f.split(new RegExp(`${y}[ ]*{`));let b=`{${S[1]}`;f=S[0],b=this.interpolate(b,u);const A=b.match(/'/g),I=b.match(/"/g);(A&&A.length%2===0&&!I||I.length%2!==0)&&(b=b.replace(/'/g,'"'));try{u=JSON.parse(b),g&&(u={...g,...u})}catch(D){return this.logger.warn(`failed parsing options string in nesting for key ${f}`,D),`${f}${y}${b}`}return u.defaultValue&&u.defaultValue.indexOf(this.prefix)>-1&&delete u.defaultValue,f};for(;r=this.nestingRegexp.exec(e);){let f=[];u={...i},u=u.replace&&typeof u.replace!="string"?u.replace:u,u.applyPostProcessor=!1,delete u.defaultValue;let g=!1;if(r[0].indexOf(this.formatSeparator)!==-1&&!/{.*}/.test(r[1])){const y=r[1].split(this.formatSeparator).map(S=>S.trim());r[1]=y.shift(),f=y,g=!0}if(a=n(l.call(this,r[1].trim(),u),u),a&&r[0]===e&&typeof a!="string")return a;typeof a!="string"&&(a=TU(a)),a||(this.logger.warn(`missed to resolve ${r[1]} for nesting ${e}`),a=""),g&&(a=f.reduce((y,S)=>this.format(y,S,i.lng,{...i,interpolationkey:r[1].trim()}),a.trim())),e=e.replace(r[0],a),this.regexp.lastIndex=0}return e}}const Zie=t=>{let e=t.toLowerCase().trim();const n={};if(t.indexOf("(")>-1){const i=t.split("(");e=i[0].toLowerCase().trim();const r=i[1].substring(0,i[1].length-1);e==="currency"&&r.indexOf(":")<0?n.currency||(n.currency=r.trim()):e==="relativetime"&&r.indexOf(":")<0?n.range||(n.range=r.trim()):r.split(";").forEach(u=>{if(u){const[l,...f]=u.split(":"),g=f.join(":").trim().replace(/^'+|'+$/g,""),y=l.trim();n[y]||(n[y]=g),g==="false"&&(n[y]=!1),g==="true"&&(n[y]=!0),isNaN(g)||(n[y]=parseInt(g,10))}})}return{formatName:e,formatOptions:n}},zv=t=>{const e={};return(n,i,r)=>{let a=r;r&&r.interpolationkey&&r.formatParams&&r.formatParams[r.interpolationkey]&&r[r.interpolationkey]&&(a={...a,[r.interpolationkey]:void 0});const u=i+JSON.stringify(a);let l=e[u];return l||(l=t(JS(i),r),e[u]=l),l(n)}};class Yie{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=cu.create("formatter"),this.options=e,this.formats={number:zv((n,i)=>{const r=new Intl.NumberFormat(n,{...i});return a=>r.format(a)}),currency:zv((n,i)=>{const r=new Intl.NumberFormat(n,{...i,style:"currency"});return a=>r.format(a)}),datetime:zv((n,i)=>{const r=new Intl.DateTimeFormat(n,{...i});return a=>r.format(a)}),relativetime:zv((n,i)=>{const r=new Intl.RelativeTimeFormat(n,{...i});return a=>r.format(a,i.range||"day")}),list:zv((n,i)=>{const r=new Intl.ListFormat(n,{...i});return a=>r.format(a)})},this.init(e)}init(e){const i=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}}).interpolation;this.formatSeparator=i.formatSeparator?i.formatSeparator:i.formatSeparator||","}add(e,n){this.formats[e.toLowerCase().trim()]=n}addCached(e,n){this.formats[e.toLowerCase().trim()]=zv(n)}format(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const a=n.split(this.formatSeparator);if(a.length>1&&a[0].indexOf("(")>1&&a[0].indexOf(")")<0&&a.find(l=>l.indexOf(")")>-1)){const l=a.findIndex(f=>f.indexOf(")")>-1);a[0]=[a[0],...a.splice(1,l)].join(this.formatSeparator)}return a.reduce((l,f)=>{const{formatName:g,formatOptions:y}=Zie(f);if(this.formats[g]){let S=l;try{const b=r&&r.formatParams&&r.formatParams[r.interpolationkey]||{},A=b.locale||b.lng||r.locale||r.lng||i;S=this.formats[g](l,A,{...y,...r,...b})}catch(b){this.logger.warn(b)}return S}else this.logger.warn(`there was no format function for ${g}`);return l},e)}}const Kie=(t,e)=>{t.pending[e]!==void 0&&(delete t.pending[e],t.pendingCount--)};class Jie extends YS{constructor(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};super(),this.backend=e,this.store=n,this.services=i,this.languageUtils=i.languageUtils,this.options=r,this.logger=cu.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=r.maxParallelReads||10,this.readingCalls=0,this.maxRetries=r.maxRetries>=0?r.maxRetries:5,this.retryTimeout=r.retryTimeout>=1?r.retryTimeout:350,this.state={},this.queue=[],this.backend&&this.backend.init&&this.backend.init(i,r.backend,r)}queueLoad(e,n,i,r){const a={},u={},l={},f={};return e.forEach(g=>{let y=!0;n.forEach(S=>{const b=`${g}|${S}`;!i.reload&&this.store.hasResourceBundle(g,S)?this.state[b]=2:this.state[b]<0||(this.state[b]===1?u[b]===void 0&&(u[b]=!0):(this.state[b]=1,y=!1,u[b]===void 0&&(u[b]=!0),a[b]===void 0&&(a[b]=!0),f[S]===void 0&&(f[S]=!0)))}),y||(l[g]=!0)}),(Object.keys(a).length||Object.keys(u).length)&&this.queue.push({pending:u,pendingCount:Object.keys(u).length,loaded:{},errors:[],callback:r}),{toLoad:Object.keys(a),pending:Object.keys(u),toLoadLanguages:Object.keys(l),toLoadNamespaces:Object.keys(f)}}loaded(e,n,i){const r=e.split("|"),a=r[0],u=r[1];n&&this.emit("failedLoading",a,u,n),!n&&i&&this.store.addResourceBundle(a,u,i,void 0,void 0,{skipCopy:!0}),this.state[e]=n?-1:2,n&&i&&(this.state[e]=0);const l={};this.queue.forEach(f=>{Die(f.loaded,[a],u),Kie(f,e),n&&f.errors.push(n),f.pendingCount===0&&!f.done&&(Object.keys(f.loaded).forEach(g=>{l[g]||(l[g]={});const y=f.loaded[g];y.length&&y.forEach(S=>{l[g][S]===void 0&&(l[g][S]=!0)})}),f.done=!0,f.errors.length?f.callback(f.errors):f.callback())}),this.emit("loaded",l),this.queue=this.queue.filter(f=>!f.done)}read(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:this.retryTimeout,u=arguments.length>5?arguments[5]:void 0;if(!e.length)return u(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:e,ns:n,fcName:i,tried:r,wait:a,callback:u});return}this.readingCalls++;const l=(g,y)=>{if(this.readingCalls--,this.waitingReads.length>0){const S=this.waitingReads.shift();this.read(S.lng,S.ns,S.fcName,S.tried,S.wait,S.callback)}if(g&&y&&r<this.maxRetries){setTimeout(()=>{this.read.call(this,e,n,i,r+1,a*2,u)},a);return}u(g,y)},f=this.backend[i].bind(this.backend);if(f.length===2){try{const g=f(e,n);g&&typeof g.then=="function"?g.then(y=>l(null,y)).catch(l):l(null,g)}catch(g){l(g)}return}return f(e,n,l)}prepareLoading(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),r&&r();typeof e=="string"&&(e=this.languageUtils.toResolveHierarchy(e)),typeof n=="string"&&(n=[n]);const a=this.queueLoad(e,n,i,r);if(!a.toLoad.length)return a.pending.length||r(),null;a.toLoad.forEach(u=>{this.loadOne(u)})}load(e,n,i){this.prepareLoading(e,n,{},i)}reload(e,n,i){this.prepareLoading(e,n,{reload:!0},i)}loadOne(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const i=e.split("|"),r=i[0],a=i[1];this.read(r,a,"read",void 0,void 0,(u,l)=>{u&&this.logger.warn(`${n}loading namespace ${a} for language ${r} failed`,u),!u&&l&&this.logger.log(`${n}loaded namespace ${a} for language ${r}`,l),this.loaded(e,u,l)})}saveMissing(e,n,i,r,a){let u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},l=arguments.length>6&&arguments[6]!==void 0?arguments[6]:()=>{};if(this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(n)){this.logger.warn(`did not save key "${i}" as the namespace "${n}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(i==null||i==="")){if(this.backend&&this.backend.create){const f={...u,isUpdate:a},g=this.backend.create.bind(this.backend);if(g.length<6)try{let y;g.length===5?y=g(e,n,i,r,f):y=g(e,n,i,r),y&&typeof y.then=="function"?y.then(S=>l(null,S)).catch(l):l(null,y)}catch(y){l(y)}else g(e,n,i,r,l,f)}!e||!e[0]||this.store.addResource(e[0],n,i,r)}}}const NU=()=>({debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:t=>{let e={};if(typeof t[1]=="object"&&(e=t[1]),typeof t[1]=="string"&&(e.defaultValue=t[1]),typeof t[2]=="string"&&(e.tDescription=t[2]),typeof t[2]=="object"||typeof t[3]=="object"){const n=t[3]||t[2];Object.keys(n).forEach(i=>{e[i]=n[i]})}return e},interpolation:{escapeValue:!0,format:t=>t,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}),BU=t=>(typeof t.ns=="string"&&(t.ns=[t.ns]),typeof t.fallbackLng=="string"&&(t.fallbackLng=[t.fallbackLng]),typeof t.fallbackNS=="string"&&(t.fallbackNS=[t.fallbackNS]),t.supportedLngs&&t.supportedLngs.indexOf("cimode")<0&&(t.supportedLngs=t.supportedLngs.concat(["cimode"])),t),e2=()=>{},Qie=t=>{Object.getOwnPropertyNames(Object.getPrototypeOf(t)).forEach(n=>{typeof t[n]=="function"&&(t[n]=t[n].bind(t))})};class J_ extends YS{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;if(super(),this.options=BU(e),this.services={},this.logger=cu,this.modules={external:[]},Qie(this),n&&!this.isInitialized&&!e.isClone){if(!this.options.initImmediate)return this.init(e,n),this;setTimeout(()=>{this.init(e,n)},0)}}init(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0;this.isInitializing=!0,typeof n=="function"&&(i=n,n={}),!n.defaultNS&&n.defaultNS!==!1&&n.ns&&(typeof n.ns=="string"?n.defaultNS=n.ns:n.ns.indexOf("translation")<0&&(n.defaultNS=n.ns[0]));const r=NU();this.options={...r,...this.options,...BU(n)},this.options.compatibilityAPI!=="v1"&&(this.options.interpolation={...r.interpolation,...this.options.interpolation}),n.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=n.keySeparator),n.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=n.nsSeparator);const a=y=>y?typeof y=="function"?new y:y:null;if(!this.options.isClone){this.modules.logger?cu.init(a(this.modules.logger),this.options):cu.init(null,this.options);let y;this.modules.formatter?y=this.modules.formatter:typeof Intl<"u"&&(y=Yie);const S=new OU(this.options);this.store=new LU(this.options.resources,this.options);const b=this.services;b.logger=cu,b.resourceStore=this.store,b.languageUtils=S,b.pluralResolver=new qie(S,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),y&&(!this.options.interpolation.format||this.options.interpolation.format===r.interpolation.format)&&(b.formatter=a(y),b.formatter.init(b,this.options),this.options.interpolation.format=b.formatter.format.bind(b.formatter)),b.interpolator=new Xie(this.options),b.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},b.backendConnector=new Jie(a(this.modules.backend),b.resourceStore,b,this.options),b.backendConnector.on("*",function(A){for(var I=arguments.length,D=new Array(I>1?I-1:0),L=1;L<I;L++)D[L-1]=arguments[L];e.emit(A,...D)}),this.modules.languageDetector&&(b.languageDetector=a(this.modules.languageDetector),b.languageDetector.init&&b.languageDetector.init(b,this.options.detection,this.options)),this.modules.i18nFormat&&(b.i18nFormat=a(this.modules.i18nFormat),b.i18nFormat.init&&b.i18nFormat.init(this)),this.translator=new QS(this.services,this.options),this.translator.on("*",function(A){for(var I=arguments.length,D=new Array(I>1?I-1:0),L=1;L<I;L++)D[L-1]=arguments[L];e.emit(A,...D)}),this.modules.external.forEach(A=>{A.init&&A.init(this)})}if(this.format=this.options.interpolation.format,i||(i=e2),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const y=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);y.length>0&&y[0]!=="dev"&&(this.options.lng=y[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(y=>{this[y]=function(){return e.store[y](...arguments)}}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(y=>{this[y]=function(){return e.store[y](...arguments),e}});const f=Y_(),g=()=>{const y=(S,b)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),f.resolve(b),i(S,b)};if(this.languages&&this.options.compatibilityAPI!=="v1"&&!this.isInitialized)return y(null,this.t.bind(this));this.changeLanguage(this.options.lng,y)};return this.options.resources||!this.options.initImmediate?g():setTimeout(g,0),f}loadResources(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e2;const r=typeof e=="string"?e:this.language;if(typeof e=="function"&&(i=e),!this.options.resources||this.options.partialBundledLanguages){if(r&&r.toLowerCase()==="cimode"&&(!this.options.preload||this.options.preload.length===0))return i();const a=[],u=l=>{if(!l||l==="cimode")return;this.services.languageUtils.toResolveHierarchy(l).forEach(g=>{g!=="cimode"&&a.indexOf(g)<0&&a.push(g)})};r?u(r):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(f=>u(f)),this.options.preload&&this.options.preload.forEach(l=>u(l)),this.services.backendConnector.load(a,this.options.ns,l=>{!l&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),i(l)})}else i(null)}reloadResources(e,n,i){const r=Y_();return typeof e=="function"&&(i=e,e=void 0),typeof n=="function"&&(i=n,n=void 0),e||(e=this.languages),n||(n=this.options.ns),i||(i=e2),this.services.backendConnector.reload(e,n,a=>{r.resolve(),i(a)}),r}use(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return e.type==="backend"&&(this.modules.backend=e),(e.type==="logger"||e.log&&e.warn&&e.error)&&(this.modules.logger=e),e.type==="languageDetector"&&(this.modules.languageDetector=e),e.type==="i18nFormat"&&(this.modules.i18nFormat=e),e.type==="postProcessor"&&kU.addPostProcessor(e),e.type==="formatter"&&(this.modules.formatter=e),e.type==="3rdParty"&&this.modules.external.push(e),this}setResolvedLanguage(e){if(!(!e||!this.languages)&&!(["cimode","dev"].indexOf(e)>-1))for(let n=0;n<this.languages.length;n++){const i=this.languages[n];if(!(["cimode","dev"].indexOf(i)>-1)&&this.store.hasLanguageSomeTranslations(i)){this.resolvedLanguage=i;break}}}changeLanguage(e,n){var i=this;this.isLanguageChangingTo=e;const r=Y_();this.emit("languageChanging",e);const a=f=>{this.language=f,this.languages=this.services.languageUtils.toResolveHierarchy(f),this.resolvedLanguage=void 0,this.setResolvedLanguage(f)},u=(f,g)=>{g?(a(g),this.translator.changeLanguage(g),this.isLanguageChangingTo=void 0,this.emit("languageChanged",g),this.logger.log("languageChanged",g)):this.isLanguageChangingTo=void 0,r.resolve(function(){return i.t(...arguments)}),n&&n(f,function(){return i.t(...arguments)})},l=f=>{!e&&!f&&this.services.languageDetector&&(f=[]);const g=typeof f=="string"?f:this.services.languageUtils.getBestMatchFromCodes(f);g&&(this.language||a(g),this.translator.language||this.translator.changeLanguage(g),this.services.languageDetector&&this.services.languageDetector.cacheUserLanguage&&this.services.languageDetector.cacheUserLanguage(g)),this.loadResources(g,y=>{u(y,g)})};return!e&&this.services.languageDetector&&!this.services.languageDetector.async?l(this.services.languageDetector.detect()):!e&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(l):this.services.languageDetector.detect(l):l(e),r}getFixedT(e,n,i){var r=this;const a=function(u,l){let f;if(typeof l!="object"){for(var g=arguments.length,y=new Array(g>2?g-2:0),S=2;S<g;S++)y[S-2]=arguments[S];f=r.options.overloadTranslationOptionHandler([u,l].concat(y))}else f={...l};f.lng=f.lng||a.lng,f.lngs=f.lngs||a.lngs,f.ns=f.ns||a.ns,f.keyPrefix!==""&&(f.keyPrefix=f.keyPrefix||i||a.keyPrefix);const b=r.options.keySeparator||".";let A;return f.keyPrefix&&Array.isArray(u)?A=u.map(I=>`${f.keyPrefix}${b}${I}`):A=f.keyPrefix?`${f.keyPrefix}${b}${u}`:u,r.t(A,f)};return typeof e=="string"?a.lng=e:a.lngs=e,a.ns=n,a.keyPrefix=i,a}t(){return this.translator&&this.translator.translate(...arguments)}exists(){return this.translator&&this.translator.exists(...arguments)}setDefaultNamespace(e){this.options.defaultNS=e}hasLoadedNamespace(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const i=n.lng||this.resolvedLanguage||this.languages[0],r=this.options?this.options.fallbackLng:!1,a=this.languages[this.languages.length-1];if(i.toLowerCase()==="cimode")return!0;const u=(l,f)=>{const g=this.services.backendConnector.state[`${l}|${f}`];return g===-1||g===0||g===2};if(n.precheck){const l=n.precheck(this,u);if(l!==void 0)return l}return!!(this.hasResourceBundle(i,e)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||u(i,e)&&(!r||u(a,e)))}loadNamespaces(e,n){const i=Y_();return this.options.ns?(typeof e=="string"&&(e=[e]),e.forEach(r=>{this.options.ns.indexOf(r)<0&&this.options.ns.push(r)}),this.loadResources(r=>{i.resolve(),n&&n(r)}),i):(n&&n(),Promise.resolve())}loadLanguages(e,n){const i=Y_();typeof e=="string"&&(e=[e]);const r=this.options.preload||[],a=e.filter(u=>r.indexOf(u)<0&&this.services.languageUtils.isSupportedCode(u));return a.length?(this.options.preload=r.concat(a),this.loadResources(u=>{i.resolve(),n&&n(u)}),i):(n&&n(),Promise.resolve())}dir(e){if(e||(e=this.resolvedLanguage||(this.languages&&this.languages.length>0?this.languages[0]:this.language)),!e)return"rtl";const n=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],i=this.services&&this.services.languageUtils||new OU(NU());return n.indexOf(i.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;return new J_(e,n)}cloneInstance(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e2;const i=e.forkResourceStore;i&&delete e.forkResourceStore;const r={...this.options,...e,isClone:!0},a=new J_(r);return(e.debug!==void 0||e.prefix!==void 0)&&(a.logger=a.logger.clone(e)),["store","services","language"].forEach(l=>{a[l]=this[l]}),a.services={...this.services},a.services.utils={hasLoadedNamespace:a.hasLoadedNamespace.bind(a)},i&&(a.store=new LU(this.store.data,r),a.services.resourceStore=a.store),a.translator=new QS(a.services,r),a.translator.on("*",function(l){for(var f=arguments.length,g=new Array(f>1?f-1:0),y=1;y<f;y++)g[y-1]=arguments[y];a.emit(l,...g)}),a.init(r,n),a.translator.options=r,a.translator.backendConnector.services.utils={hasLoadedNamespace:a.hasLoadedNamespace.bind(a)},a}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const Wr=J_.createInstance();Wr.createInstance=J_.createInstance,Wr.createInstance,Wr.dir,Wr.init,Wr.loadResources,Wr.reloadResources,Wr.use,Wr.changeLanguage,Wr.getFixedT,Wr.t,Wr.exists,Wr.setDefaultNamespace,Wr.hasLoadedNamespace,Wr.loadNamespaces,Wr.loadLanguages;class ere extends XS{constructor(n){super(n,Z_.HORIZONTAL);yn(this,"renderContent",()=>{CU()?this.container.innerHTML=`
        <div class="copyright-container">
          2025 
          <a href="https://44plus.vn" target="_blank" rel="noopener noreferrer" class="copyright-link">44+ Technologies</a>
        </div>
      `:this.container.innerHTML=`
        <div class="copyright-container">
          2025 
          <a href="https://44plus.vn" target="_blank" rel="noopener noreferrer" class="copyright-link">44+ Technologies</a> |
          <a href="https://enterprise.streetview.vn/terms-of-use" target="_blank" rel="noopener noreferrer" class="copyright-link">${Wr.t("Terms")||"Terms"}</a> | 
          <a href="https://enterprise.streetview.vn/privacy-policy" target="_blank" rel="noopener noreferrer" class="copyright-link">${Wr.t("Privacy")||"Privacy"}</a> | 
          <a href="https://enterprise.streetview.vn/disclaimer" target="_blank" rel="noopener noreferrer" class="copyright-link">${Wr.t("Disclaimer")||"Disclaimer"}</a>
        </div>
      `});this.container.title=this.viewer.config.lang.mapReset,this.renderContent(),window.addEventListener("resize",this.renderContent),Wr.on("languageChanged",this.renderContent),this.container.className=pd.CAPTURE_EVENTS_CLASS,this.container.style.background="none",this.container.style.width="112px",this.container.style.height="32px",this.container.addEventListener("click",i=>{n.reset(),i.stopPropagation()})}applyConfig(){super.applyConfig(),this.container.classList.add("psv-plan__button-reset")}}class tre{constructor(e,n){yn(this,"viewer");yn(this,"children",[]);yn(this,"container",document.createElement("div"));yn(this,"state",{visible:!0});this.parent=e,this.viewer=e instanceof da?e.viewer:e,this.container.className=n.className||"",this.parent.children.push(this),this.parent.parent.appendChild(this.container)}destroy(){this.parent.parent.removeChild(this.container);const e=this.parent.children.indexOf(this);e!==-1&&this.parent.children.splice(e,1),this.children.slice().forEach(n=>n.destroy()),this.children.length=0}toggle(e=!this.isVisible()){e?this.show():this.hide()}hide(){this.container.style.display="none",this.state.visible=!1}show(){this.container.style.display="",this.state.visible=!0}isVisible(){return this.state.visible}}const nre=`<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--gis" preserveAspectRatio="xMidYMid meet"><path d="M0 21.127v57.746c.001 1.82 1.886 3.03 3.541 2.272c0 0 3.455-1.604 11.104-3.297c7.649-1.693 19.34-3.405 35.355-3.405c16.015 0 27.706 1.712 35.355 3.405c7.65 1.693 11.104 3.297 11.104 3.297c1.655.757 3.54-.451 3.541-2.272V21.127c-.001-1.79-1.827-2.998-3.475-2.3c0 0-15.746 6.73-46.525 6.73c-30.779 0-46.525-6.73-46.525-6.73c-1.688-.603-3.434.953-3.475 2.3zm5 3.504c6.39 2.027 21.643 5.926 45 5.926s38.61-3.899 45-5.926v44.426c-7.977.228-16.18-.56-24.992-4.09L51.795 44.604L36.416 57.508l-7.424-4.95L14.4 68.042c-3.017 1.35-5.923 3.034-9.4 3.004zm70.04 12.846a6.718 6.718 0 0 0-6.628 6.716a6.718 6.718 0 1 0 6.627-6.716z" fill="currentColor"></path></svg>
`;var t2={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */t2.exports,function(t,e){(function(){var n,i="4.17.21",r=200,a="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",u="Expected a function",l="Invalid `variable` option passed into `_.template`",f="__lodash_hash_undefined__",g=500,y="__lodash_placeholder__",S=1,b=2,A=4,I=1,D=2,L=1,P=2,N=4,B=8,$=16,K=32,q=64,W=128,ie=256,Z=512,X=30,se="...",De=800,Se=16,Me=1,Ye=2,ye=3,Ce=1/0,ge=9007199254740991,Be=17976931348623157e292,Ze=NaN,je=4294967295,wt=je-1,Xt=je>>>1,Ke=[["ary",W],["bind",L],["bindKey",P],["curry",B],["curryRight",$],["flip",Z],["partial",K],["partialRight",q],["rearg",ie]],_t="[object Arguments]",zt="[object Array]",Rt="[object AsyncFunction]",fn="[object Boolean]",Mn="[object Date]",Bt="[object DOMException]",Kn="[object Error]",Re="[object Function]",Jn="[object GeneratorFunction]",Ln="[object Map]",Cn="[object Number]",Ue="[object Null]",xt="[object Object]",Pt="[object Promise]",mt="[object Proxy]",ve="[object RegExp]",re="[object Set]",Xe="[object String]",Ge="[object Symbol]",st="[object Undefined]",ft="[object WeakMap]",Ht="[object WeakSet]",$t="[object ArrayBuffer]",it="[object DataView]",On="[object Float32Array]",Nt="[object Float64Array]",on="[object Int8Array]",Wn="[object Int16Array]",yt="[object Int32Array]",Tt="[object Uint8Array]",Vt="[object Uint8ClampedArray]",kn="[object Uint16Array]",ii="[object Uint32Array]",Ne=/\b__p \+= '';/g,Gt=/\b(__p \+=) '' \+/g,Et=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Ct=/&(?:amp|lt|gt|quot|#39);/g,Zt=/[&<>"']/g,xe=RegExp(Ct.source),te=RegExp(Zt.source),ne=/<%-([\s\S]+?)%>/g,de=/<%([\s\S]+?)%>/g,we=/<%=([\s\S]+?)%>/g,Fe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,He=/^\w*$/,nt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ie=/[\\^$.*+?()[\]{}|]/g,ut=RegExp(Ie.source),bt=/^\s+/,ct=/\s/,Wt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,bn=/\{\n\/\* \[wrapped with (.+)\] \*/,Sn=/,? & /,Bn=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ui=/[()=,{}\[\]\/\s]/,Vn=/\\(\\)?/g,Di=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,qi=/\w*$/,me=/^[-+]0x[0-9a-f]+$/i,$e=/^0b[01]+$/i,ot=/^\[object .+?Constructor\]$/,lt=/^0o[0-7]+$/i,Je=/^(?:0|[1-9]\d*)$/,jt=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,en=/($^)/,En=/['\n\r\u2028\u2029\\]/g,Yt="\\ud800-\\udfff",jn="\\u0300-\\u036f",Zn="\\ufe20-\\ufe2f",In="\\u20d0-\\u20ff",ri=jn+Zn+In,ur="\\u2700-\\u27bf",mi="a-z\\xdf-\\xf6\\xf8-\\xff",Ni="\\xac\\xb1\\xd7\\xf7",wi="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Fn="\\u2000-\\u206f",di=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",li="A-Z\\xc0-\\xd6\\xd8-\\xde",Or="\\ufe0e\\ufe0f",$i=Ni+wi+Fn+di,Fr="[']",vs="["+Yt+"]",Qi="["+$i+"]",zr="["+ri+"]",Ol="\\d+",Qr="["+ur+"]",uo="["+mi+"]",yi="[^"+Yt+$i+Ol+ur+mi+li+"]",il="\\ud83c[\\udffb-\\udfff]",zp="(?:"+zr+"|"+il+")",du="[^"+Yt+"]",fu="(?:\\ud83c[\\udde6-\\uddff]){2}",pu="[\\ud800-\\udbff][\\udc00-\\udfff]",rl="["+li+"]",Eh="\\u200d",mu="(?:"+uo+"|"+yi+")",gu="(?:"+rl+"|"+yi+")",Gv="(?:"+Fr+"(?:d|ll|m|re|s|t|ve))?",Wv="(?:"+Fr+"(?:D|LL|M|RE|S|T|VE))?",Np=zp+"?",jv="["+Or+"]?",Fl="(?:"+Eh+"(?:"+[du,fu,pu].join("|")+")"+jv+Np+")*",Mh="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",ho="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Xs=jv+Np+Fl,Ch="(?:"+[Qr,fu,pu].join("|")+")"+Xs,sf="(?:"+[du+zr+"?",zr,fu,pu,vs].join("|")+")",qv=RegExp(Fr,"g"),Xv=RegExp(zr,"g"),sl=RegExp(il+"(?="+il+")|"+sf+Xs,"g"),Zv=RegExp([rl+"?"+uo+"+"+Gv+"(?="+[Qi,rl,"$"].join("|")+")",gu+"+"+Wv+"(?="+[Qi,rl+mu,"$"].join("|")+")",rl+"?"+mu+"+"+Gv,rl+"+"+Wv,ho,Mh,Ol,Ch].join("|"),"g"),fx=RegExp("["+Eh+Yt+ri+Or+"]"),px=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Yv=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Kv=-1,hr={};hr[On]=hr[Nt]=hr[on]=hr[Wn]=hr[yt]=hr[Tt]=hr[Vt]=hr[kn]=hr[ii]=!0,hr[_t]=hr[zt]=hr[$t]=hr[fn]=hr[it]=hr[Mn]=hr[Kn]=hr[Re]=hr[Ln]=hr[Cn]=hr[xt]=hr[ve]=hr[re]=hr[Xe]=hr[ft]=!1;var Hi={};Hi[_t]=Hi[zt]=Hi[$t]=Hi[it]=Hi[fn]=Hi[Mn]=Hi[On]=Hi[Nt]=Hi[on]=Hi[Wn]=Hi[yt]=Hi[Ln]=Hi[Cn]=Hi[xt]=Hi[ve]=Hi[re]=Hi[Xe]=Hi[Ge]=Hi[Tt]=Hi[Vt]=Hi[kn]=Hi[ii]=!0,Hi[Kn]=Hi[Re]=Hi[ft]=!1;var Bp={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},of={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Up={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Vp={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ba=parseFloat,$p=parseInt,Cc=typeof Dn=="object"&&Dn&&Dn.Object===Object&&Dn,_i=typeof self=="object"&&self&&self.Object===Object&&self,Ar=Cc||_i||Function("return this")(),Hp=e&&!e.nodeType&&e,wa=Hp&&!0&&t&&!t.nodeType&&t,Jv=wa&&wa.exports===Hp,zl=Jv&&Cc.process,Lo=function(){try{var et=wa&&wa.require&&wa.require("util").types;return et||zl&&zl.binding&&zl.binding("util")}catch{}}(),Gp=Lo&&Lo.isArrayBuffer,Qv=Lo&&Lo.isDate,Wp=Lo&&Lo.isMap,af=Lo&&Lo.isRegExp,jp=Lo&&Lo.isSet,qp=Lo&&Lo.isTypedArray;function Zs(et,Mt,gt){switch(gt.length){case 0:return et.call(Mt);case 1:return et.call(Mt,gt[0]);case 2:return et.call(Mt,gt[0],gt[1]);case 3:return et.call(Mt,gt[0],gt[1],gt[2])}return et.apply(Mt,gt)}function e0(et,Mt,gt,_n){for(var Qn=-1,gi=et==null?0:et.length;++Qn<gi;){var Pr=et[Qn];Mt(_n,Pr,gt(Pr),et)}return _n}function es(et,Mt){for(var gt=-1,_n=et==null?0:et.length;++gt<_n&&Mt(et[gt],gt,et)!==!1;);return et}function t0(et,Mt){for(var gt=et==null?0:et.length;gt--&&Mt(et[gt],gt,et)!==!1;);return et}function n0(et,Mt){for(var gt=-1,_n=et==null?0:et.length;++gt<_n;)if(!Mt(et[gt],gt,et))return!1;return!0}function Nl(et,Mt){for(var gt=-1,_n=et==null?0:et.length,Qn=0,gi=[];++gt<_n;){var Pr=et[gt];Mt(Pr,gt,et)&&(gi[Qn++]=Pr)}return gi}function Th(et,Mt){var gt=et==null?0:et.length;return!!gt&&Ys(et,Mt,0)>-1}function Tc(et,Mt,gt){for(var _n=-1,Qn=et==null?0:et.length;++_n<Qn;)if(gt(Mt,et[_n]))return!0;return!1}function gr(et,Mt){for(var gt=-1,_n=et==null?0:et.length,Qn=Array(_n);++gt<_n;)Qn[gt]=Mt(et[gt],gt,et);return Qn}function ta(et,Mt){for(var gt=-1,_n=Mt.length,Qn=et.length;++gt<_n;)et[Qn+gt]=Mt[gt];return et}function Xp(et,Mt,gt,_n){var Qn=-1,gi=et==null?0:et.length;for(_n&&gi&&(gt=et[++Qn]);++Qn<gi;)gt=Mt(gt,et[Qn],Qn,et);return gt}function mx(et,Mt,gt,_n){var Qn=et==null?0:et.length;for(_n&&Qn&&(gt=et[--Qn]);Qn--;)gt=Mt(gt,et[Qn],Qn,et);return gt}function lf(et,Mt){for(var gt=-1,_n=et==null?0:et.length;++gt<_n;)if(Mt(et[gt],gt,et))return!0;return!1}var i0=hf("length");function r0(et){return et.split("")}function Zp(et){return et.match(Bn)||[]}function Yp(et,Mt,gt){var _n;return gt(et,function(Qn,gi,Pr){if(Mt(Qn,gi,Pr))return _n=gi,!1}),_n}function Ac(et,Mt,gt,_n){for(var Qn=et.length,gi=gt+(_n?1:-1);_n?gi--:++gi<Qn;)if(Mt(et[gi],gi,et))return gi;return-1}function Ys(et,Mt,gt){return Mt===Mt?s0(et,Mt,gt):Ac(et,cf,gt)}function Ah(et,Mt,gt,_n){for(var Qn=gt-1,gi=et.length;++Qn<gi;)if(_n(et[Qn],Mt))return Qn;return-1}function cf(et){return et!==et}function uf(et,Mt){var gt=et==null?0:et.length;return gt?ci(et,Mt)/gt:Ze}function hf(et){return function(Mt){return Mt==null?n:Mt[et]}}function Ph(et){return function(Mt){return et==null?n:et[Mt]}}function Xi(et,Mt,gt,_n,Qn){return Qn(et,function(gi,Pr,Gi){gt=_n?(_n=!1,gi):Mt(gt,gi,Pr,Gi)}),gt}function Kp(et,Mt){var gt=et.length;for(et.sort(Mt);gt--;)et[gt]=et[gt].value;return et}function ci(et,Mt){for(var gt,_n=-1,Qn=et.length;++_n<Qn;){var gi=Mt(et[_n]);gi!==n&&(gt=gt===n?gi:gt+gi)}return gt}function Ih(et,Mt){for(var gt=-1,_n=Array(et);++gt<et;)_n[gt]=Mt(gt);return _n}function dr(et,Mt){return gr(Mt,function(gt){return[gt,et[gt]]})}function er(et){return et&&et.slice(0,Rc(et)+1).replace(bt,"")}function as(et){return function(Mt){return et(Mt)}}function df(et,Mt){return gr(Mt,function(gt){return et[gt]})}function Pc(et,Mt){return et.has(Mt)}function Rh(et,Mt){for(var gt=-1,_n=et.length;++gt<_n&&Ys(Mt,et[gt],0)>-1;);return gt}function Lh(et,Mt){for(var gt=et.length;gt--&&Ys(Mt,et[gt],0)>-1;);return gt}function ff(et,Mt){for(var gt=et.length,_n=0;gt--;)et[gt]===Mt&&++_n;return _n}var Jp=Ph(Bp),Bl=Ph(of);function Ic(et){return"\\"+Vp[et]}function fo(et,Mt){return et==null?n:et[Mt]}function Ul(et){return fx.test(et)}function pf(et){return px.test(et)}function Qp(et){for(var Mt,gt=[];!(Mt=et.next()).done;)gt.push(Mt.value);return gt}function ol(et){var Mt=-1,gt=Array(et.size);return et.forEach(function(_n,Qn){gt[++Mt]=[Qn,_n]}),gt}function kh(et,Mt){return function(gt){return et(Mt(gt))}}function na(et,Mt){for(var gt=-1,_n=et.length,Qn=0,gi=[];++gt<_n;){var Pr=et[gt];(Pr===Mt||Pr===y)&&(et[gt]=y,gi[Qn++]=gt)}return gi}function Vl(et){var Mt=-1,gt=Array(et.size);return et.forEach(function(_n){gt[++Mt]=_n}),gt}function mf(et){var Mt=-1,gt=Array(et.size);return et.forEach(function(_n){gt[++Mt]=[_n,_n]}),gt}function s0(et,Mt,gt){for(var _n=gt-1,Qn=et.length;++_n<Qn;)if(et[_n]===Mt)return _n;return-1}function vu(et,Mt,gt){for(var _n=gt+1;_n--;)if(et[_n]===Mt)return _n;return _n}function ko(et){return Ul(et)?Dh(et):i0(et)}function po(et){return Ul(et)?o0(et):r0(et)}function Rc(et){for(var Mt=et.length;Mt--&&ct.test(et.charAt(Mt)););return Mt}var Ei=Ph(Up);function Dh(et){for(var Mt=sl.lastIndex=0;sl.test(et);)++Mt;return Mt}function o0(et){return et.match(sl)||[]}function a0(et){return et.match(Zv)||[]}var Lc=function et(Mt){Mt=Mt==null?Ar:al.defaults(Ar.Object(),Mt,al.pick(Ar,Yv));var gt=Mt.Array,_n=Mt.Date,Qn=Mt.Error,gi=Mt.Function,Pr=Mt.Math,Gi=Mt.Object,gf=Mt.RegExp,vf=Mt.String,ks=Mt.TypeError,ll=gt.prototype,yf=gi.prototype,Nr=Gi.prototype,$l=Mt["__core-js_shared__"],yu=yf.toString,Ri=Nr.hasOwnProperty,em=0,kc=function(){var m=/[^.]+$/.exec($l&&$l.keys&&$l.keys.IE_PROTO||"");return m?"Symbol(src)_1."+m:""}(),_u=Nr.toString,xu=yu.call(Gi),tm=Ar._,nm=gf("^"+yu.call(Ri).replace(Ie,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Oh=Jv?Mt.Buffer:n,Ti=Mt.Symbol,Sa=Mt.Uint8Array,Ds=Oh?Oh.allocUnsafe:n,Dc=kh(Gi.getPrototypeOf,Gi),bu=Gi.create,_f=Nr.propertyIsEnumerable,Ea=ll.splice,wu=Ti?Ti.isConcatSpreadable:n,cl=Ti?Ti.iterator:n,ia=Ti?Ti.toStringTag:n,Su=function(){try{var m=Bc(Gi,"defineProperty");return m({},"",{}),m}catch{}}(),im=Mt.clearTimeout!==Ar.clearTimeout&&Mt.clearTimeout,rm=_n&&_n.now!==Ar.Date.now&&_n.now,sm=Mt.setTimeout!==Ar.setTimeout&&Mt.setTimeout,Do=Pr.ceil,Eu=Pr.floor,xf=Gi.getOwnPropertySymbols,om=Oh?Oh.isBuffer:n,am=Mt.isFinite,lm=ll.join,cm=kh(Gi.keys,Gi),Ir=Pr.max,jr=Pr.min,l0=_n.now,Oo=Mt.parseInt,Fo=Pr.random,um=ll.reverse,mo=Bc(Mt,"DataView"),go=Bc(Mt,"Map"),hm=Bc(Mt,"Promise"),Hl=Bc(Mt,"Set"),Fh=Bc(Mt,"WeakMap"),zh=Bc(Gi,"create"),Mu=Fh&&new Fh,ra={},Ma=Nu(mo),dn=Nu(go),c0=Nu(hm),dm=Nu(Hl),u0=Nu(Fh),Gl=Ti?Ti.prototype:n,Ks=Gl?Gl.valueOf:n,fm=Gl?Gl.toString:n;function oe(m){if(Sr(m)&&!oi(m)&&!(m instanceof fi)){if(m instanceof vo)return m;if(Ri.call(m,"__wrapped__"))return kx(m)}return new vo(m)}var Wl=function(){function m(){}return function(w){if(!fr(w))return{};if(bu)return bu(w);m.prototype=w;var k=new m;return m.prototype=n,k}}();function bf(){}function vo(m,w){this.__wrapped__=m,this.__actions__=[],this.__chain__=!!w,this.__index__=0,this.__values__=n}oe.templateSettings={escape:ne,evaluate:de,interpolate:we,variable:"",imports:{_:oe}},oe.prototype=bf.prototype,oe.prototype.constructor=oe,vo.prototype=Wl(bf.prototype),vo.prototype.constructor=vo;function fi(m){this.__wrapped__=m,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=je,this.__views__=[]}function h0(){var m=new fi(this.__wrapped__);return m.__actions__=Fs(this.__actions__),m.__dir__=this.__dir__,m.__filtered__=this.__filtered__,m.__iteratees__=Fs(this.__iteratees__),m.__takeCount__=this.__takeCount__,m.__views__=Fs(this.__views__),m}function jl(){if(this.__filtered__){var m=new fi(this);m.__dir__=-1,m.__filtered__=!0}else m=this.clone(),m.__dir__*=-1;return m}function d0(){var m=this.__wrapped__.value(),w=this.__dir__,k=oi(m),j=w<0,le=k?m.length:0,_e=sR(0,le,this.__views__),ze=_e.start,We=_e.end,at=We-ze,Dt=j?We:ze-1,Ot=this.__iteratees__,qt=Ot.length,vn=0,Nn=jr(at,this.__takeCount__);if(!k||!j&&le==at&&Nn==at)return y0(m,this.__actions__);var ti=[];e:for(;at--&&vn<Nn;){Dt+=w;for(var xi=-1,ni=m[Dt];++xi<qt;){var Ai=Ot[xi],zi=Ai.iteratee,vl=Ai.type,ca=zi(ni);if(vl==Ye)ni=ca;else if(!ca){if(vl==Me)continue e;break e}}ti[vn++]=ni}return ti}fi.prototype=Wl(bf.prototype),fi.prototype.constructor=fi;function ul(m){var w=-1,k=m==null?0:m.length;for(this.clear();++w<k;){var j=m[w];this.set(j[0],j[1])}}function ql(){this.__data__=zh?zh(null):{},this.size=0}function tr(m){var w=this.has(m)&&delete this.__data__[m];return this.size-=w?1:0,w}function wf(m){var w=this.__data__;if(zh){var k=w[m];return k===f?n:k}return Ri.call(w,m)?w[m]:n}function Cu(m){var w=this.__data__;return zh?w[m]!==n:Ri.call(w,m)}function Tu(m,w){var k=this.__data__;return this.size+=this.has(m)?0:1,k[m]=zh&&w===n?f:w,this}ul.prototype.clear=ql,ul.prototype.delete=tr,ul.prototype.get=wf,ul.prototype.has=Cu,ul.prototype.set=Tu;function Ca(m){var w=-1,k=m==null?0:m.length;for(this.clear();++w<k;){var j=m[w];this.set(j[0],j[1])}}function pm(){this.__data__=[],this.size=0}function Nh(m){var w=this.__data__,k=qe(w,m);if(k<0)return!1;var j=w.length-1;return k==j?w.pop():Ea.call(w,k,1),--this.size,!0}function Ta(m){var w=this.__data__,k=qe(w,m);return k<0?n:w[k][1]}function Sf(m){return qe(this.__data__,m)>-1}function Tn(m,w){var k=this.__data__,j=qe(k,m);return j<0?(++this.size,k.push([m,w])):k[j][1]=w,this}Ca.prototype.clear=pm,Ca.prototype.delete=Nh,Ca.prototype.get=Ta,Ca.prototype.has=Sf,Ca.prototype.set=Tn;function An(m){var w=-1,k=m==null?0:m.length;for(this.clear();++w<k;){var j=m[w];this.set(j[0],j[1])}}function M(){this.size=0,this.__data__={hash:new ul,map:new(go||Ca),string:new ul}}function o(m){var w=Fu(this,m).delete(m);return this.size-=w?1:0,w}function d(m){return Fu(this,m).get(m)}function v(m){return Fu(this,m).has(m)}function _(m,w){var k=Fu(this,m),j=k.size;return k.set(m,w),this.size+=k.size==j?0:1,this}An.prototype.clear=M,An.prototype.delete=o,An.prototype.get=d,An.prototype.has=v,An.prototype.set=_;function E(m){var w=-1,k=m==null?0:m.length;for(this.__data__=new An;++w<k;)this.add(m[w])}function O(m){return this.__data__.set(m,f),this}function z(m){return this.__data__.has(m)}E.prototype.add=E.prototype.push=O,E.prototype.has=z;function V(m){var w=this.__data__=new Ca(m);this.size=w.size}function H(){this.__data__=new Ca,this.size=0}function J(m){var w=this.__data__,k=w.delete(m);return this.size=w.size,k}function Q(m){return this.__data__.get(m)}function ce(m){return this.__data__.has(m)}function fe(m,w){var k=this.__data__;if(k instanceof Ca){var j=k.__data__;if(!go||j.length<r-1)return j.push([m,w]),this.size=++k.size,this;k=this.__data__=new An(j)}return k.set(m,w),this.size=k.size,this}V.prototype.clear=H,V.prototype.delete=J,V.prototype.get=Q,V.prototype.has=ce,V.prototype.set=fe;function be(m,w){var k=oi(m),j=!k&&Vc(m),le=!k&&!j&&$c(m),_e=!k&&!j&&!le&&Y(m),ze=k||j||le||_e,We=ze?Ih(m.length,vf):[],at=We.length;for(var Dt in m)(w||Ri.call(m,Dt))&&!(ze&&(Dt=="length"||le&&(Dt=="offset"||Dt=="parent")||_e&&(Dt=="buffer"||Dt=="byteLength"||Dt=="byteOffset")||No(Dt,at)))&&We.push(Dt);return We}function Pe(m){var w=m.length;return w?m[vm(0,w-1)]:n}function Te(m,w){return L0(Fs(m),sn(w,0,m.length))}function ke(m){return L0(Fs(m))}function Ve(m,w,k){(k!==n&&!Qs(m[w],k)||k===n&&!(w in m))&&Ft(m,w,k)}function Ee(m,w,k){var j=m[w];(!(Ri.call(m,w)&&Qs(j,k))||k===n&&!(w in m))&&Ft(m,w,k)}function qe(m,w){for(var k=m.length;k--;)if(Qs(m[k][0],w))return k;return-1}function rt(m,w,k,j){return tn(m,function(le,_e,ze){w(j,le,k(le),ze)}),j}function ht(m,w){return m&&Zl(w,Fi(w),m)}function At(m,w){return m&&Zl(w,ji(w),m)}function Ft(m,w,k){w=="__proto__"&&Su?Su(m,w,{configurable:!0,enumerable:!0,value:k,writable:!0}):m[w]=k}function an(m,w){for(var k=-1,j=w.length,le=gt(j),_e=m==null;++k<j;)le[k]=_e?n:ws(m,w[k]);return le}function sn(m,w,k){return m===m&&(k!==n&&(m=m<=k?m:k),w!==n&&(m=m>=w?m:w)),m}function kt(m,w,k,j,le,_e){var ze,We=w&S,at=w&b,Dt=w&A;if(k&&(ze=le?k(m,j,le,_e):k(m)),ze!==n)return ze;if(!fr(m))return m;var Ot=oi(m);if(Ot){if(ze=aR(m),!We)return Fs(m,ze)}else{var qt=zs(m),vn=qt==Re||qt==Jn;if($c(m))return wm(m,We);if(qt==xt||qt==_t||vn&&!le){if(ze=at||vn?{}:H2(m),!We)return at?F2(m,At(ze,m)):O2(m,ht(ze,m))}else{if(!Hi[qt])return le?m:{};ze=zu(m,qt,We)}}_e||(_e=new V);var Nn=_e.get(m);if(Nn)return Nn;_e.set(m,ze),F(m)?m.forEach(function(ni){ze.add(kt(ni,w,k,ni,m,_e))}):X0(m)&&m.forEach(function(ni,Ai){ze.set(Ai,kt(ni,w,k,Ai,m,_e))});var ti=Dt?at?Of:I0:at?ji:Fi,xi=Ot?n:ti(m);return es(xi||m,function(ni,Ai){xi&&(Ai=ni,ni=m[Ai]),Ee(ze,Ai,kt(ni,w,k,Ai,m,_e))}),ze}function Kt(m){var w=Fi(m);return function(k){return pn(k,m,w)}}function pn(m,w,k){var j=k.length;if(m==null)return!j;for(m=Gi(m);j--;){var le=k[j],_e=w[le],ze=m[le];if(ze===n&&!(le in m)||!_e(ze))return!1}return!0}function $n(m,w,k){if(typeof m!="function")throw new ks(u);return Nf(function(){m.apply(n,k)},w)}function Jt(m,w,k,j){var le=-1,_e=Th,ze=!0,We=m.length,at=[],Dt=w.length;if(!We)return at;k&&(w=gr(w,as(k))),j?(_e=Tc,ze=!1):w.length>=r&&(_e=Pc,ze=!1,w=new E(w));e:for(;++le<We;){var Ot=m[le],qt=k==null?Ot:k(Ot);if(Ot=j||Ot!==0?Ot:0,ze&&qt===qt){for(var vn=Dt;vn--;)if(w[vn]===qt)continue e;at.push(Ot)}else _e(w,qt,j)||at.push(Ot)}return at}var tn=E0(_r),Un=E0(ls,!0);function rr(m,w){var k=!0;return tn(m,function(j,le,_e){return k=!!w(j,le,_e),k}),k}function ei(m,w,k){for(var j=-1,le=m.length;++j<le;){var _e=m[j],ze=w(_e);if(ze!=null&&(We===n?ze===ze&&!G(ze):k(ze,We)))var We=ze,at=_e}return at}function hi(m,w,k,j){var le=m.length;for(k=Le(k),k<0&&(k=-k>le?0:le+k),j=j===n||j>le?le:Le(j),j<0&&(j+=le),j=k>j?0:Qe(j);k<j;)m[k++]=w;return m}function nr(m,w){var k=[];return tn(m,function(j,le,_e){w(j,le,_e)&&k.push(j)}),k}function Li(m,w,k,j,le){var _e=-1,ze=m.length;for(k||(k=G2),le||(le=[]);++_e<ze;){var We=m[_e];w>0&&k(We)?w>1?Li(We,w-1,k,j,le):ta(le,We):j||(le[le.length]=We)}return le}var yo=xx(),ir=xx(!0);function _r(m,w){return m&&yo(m,w,Fi)}function ls(m,w){return m&&ir(m,w,Fi)}function qr(m,w){return Nl(w,function(k){return Kl(m[k])})}function wr(m,w){w=sa(w,m);for(var k=0,j=w.length;m!=null&&k<j;)m=m[Yl(w[k++])];return k&&k==j?m:n}function zo(m,w,k){var j=w(m);return oi(m)?j:ta(j,k(m))}function Rr(m){return m==null?m===n?st:Ue:ia&&ia in Gi(m)?Ex(m):hR(m)}function Au(m,w){return m>w}function Pu(m,w){return m!=null&&Ri.call(m,w)}function Oc(m,w){return m!=null&&w in Gi(m)}function Ef(m,w,k){return m>=jr(w,k)&&m<Ir(w,k)}function Bh(m,w,k){for(var j=k?Tc:Th,le=m[0].length,_e=m.length,ze=_e,We=gt(_e),at=1/0,Dt=[];ze--;){var Ot=m[ze];ze&&w&&(Ot=gr(Ot,as(w))),at=jr(Ot.length,at),We[ze]=!k&&(w||le>=120&&Ot.length>=120)?new E(ze&&Ot):n}Ot=m[0];var qt=-1,vn=We[0];e:for(;++qt<le&&Dt.length<at;){var Nn=Ot[qt],ti=w?w(Nn):Nn;if(Nn=k||Nn!==0?Nn:0,!(vn?Pc(vn,ti):j(Dt,ti,k))){for(ze=_e;--ze;){var xi=We[ze];if(!(xi?Pc(xi,ti):j(m[ze],ti,k)))continue e}vn&&vn.push(ti),Dt.push(Nn)}}return Dt}function cs(m,w,k,j){return _r(m,function(le,_e,ze){w(j,k(le),_e,ze)}),j}function Os(m,w,k){w=sa(w,m),m=Px(m,w);var j=m==null?m:m[Yl(Ra(w))];return j==null?n:Zs(j,m,k)}function hl(m){return Sr(m)&&Rr(m)==_t}function Iu(m){return Sr(m)&&Rr(m)==$t}function ys(m){return Sr(m)&&Rr(m)==Mn}function Br(m,w,k,j,le){return m===w?!0:m==null||w==null||!Sr(m)&&!Sr(w)?m!==m&&w!==w:ts(m,w,k,j,Br,le)}function ts(m,w,k,j,le,_e){var ze=oi(m),We=oi(w),at=ze?zt:zs(m),Dt=We?zt:zs(w);at=at==_t?xt:at,Dt=Dt==_t?xt:Dt;var Ot=at==xt,qt=Dt==xt,vn=at==Dt;if(vn&&$c(m)){if(!$c(w))return!1;ze=!0,Ot=!1}if(vn&&!Ot)return _e||(_e=new V),ze||Y(m)?jh(m,w,k,j,le,_e):rR(m,w,at,k,j,le,_e);if(!(k&I)){var Nn=Ot&&Ri.call(m,"__wrapped__"),ti=qt&&Ri.call(w,"__wrapped__");if(Nn||ti){var xi=Nn?m.value():m,ni=ti?w.value():w;return _e||(_e=new V),le(xi,ni,k,j,_e)}}return vn?(_e||(_e=new V),Lr(m,w,k,j,le,_e)):!1}function vr(m){return Sr(m)&&zs(m)==Ln}function Xl(m,w,k,j){var le=k.length,_e=le,ze=!j;if(m==null)return!_e;for(m=Gi(m);le--;){var We=k[le];if(ze&&We[2]?We[1]!==m[We[0]]:!(We[0]in m))return!1}for(;++le<_e;){We=k[le];var at=We[0],Dt=m[at],Ot=We[1];if(ze&&We[2]){if(Dt===n&&!(at in m))return!1}else{var qt=new V;if(j)var vn=j(Dt,Ot,at,m,w,qt);if(!(vn===n?Br(Ot,Dt,I|D,j,qt):vn))return!1}}return!0}function Mf(m){if(!fr(m)||W2(m))return!1;var w=Kl(m)?nm:ot;return w.test(Nu(m))}function Xr(m){return Sr(m)&&Rr(m)==ve}function f0(m){return Sr(m)&&zs(m)==re}function Cf(m){return Sr(m)&&Zh(m.length)&&!!hr[Rr(m)]}function Uh(m){return typeof m=="function"?m:m==null?Da:typeof m=="object"?oi(m)?$h(m[0],m[1]):Af(m):U8(m)}function Aa(m){if(!Tm(m))return cm(m);var w=[];for(var k in Gi(m))Ri.call(m,k)&&k!="constructor"&&w.push(k);return w}function p0(m){if(!fr(m))return Ax(m);var w=Tm(m),k=[];for(var j in m)j=="constructor"&&(w||!Ri.call(m,j))||k.push(j);return k}function Vh(m,w){return m<w}function Tf(m,w){var k=-1,j=eo(m)?gt(m.length):[];return tn(m,function(le,_e,ze){j[++k]=w(le,_e,ze)}),j}function Af(m){var w=Mm(m);return w.length==1&&w[0][2]?q2(w[0][0],w[0][1]):function(k){return k===m||Xl(k,m,w)}}function $h(m,w){return Cx(m)&&j2(w)?q2(Yl(m),w):function(k){var j=ws(k,m);return j===n&&j===w?yr(k,m):Br(w,j,I|D)}}function dl(m,w,k,j,le){m!==w&&yo(w,function(_e,ze){if(le||(le=new V),fr(_e))A2(m,w,ze,k,dl,j,le);else{var We=j?j(Ix(m,ze),_e,ze+"",m,w,le):n;We===n&&(We=_e),Ve(m,ze,We)}},ji)}function A2(m,w,k,j,le,_e,ze){var We=Ix(m,k),at=Ix(w,k),Dt=ze.get(at);if(Dt){Ve(m,k,Dt);return}var Ot=_e?_e(We,at,k+"",m,w,ze):n,qt=Ot===n;if(qt){var vn=oi(at),Nn=!vn&&$c(at),ti=!vn&&!Nn&&Y(at);Ot=at,vn||Nn||ti?oi(We)?Ot=We:Zr(We)?Ot=Fs(We):Nn?(qt=!1,Ot=wm(at,!0)):ti?(qt=!1,Ot=Gh(at,!0)):Ot=[]:C(at)||Vc(at)?(Ot=We,Vc(We)?Ot=Ut(We):(!fr(We)||Kl(We))&&(Ot=H2(at))):qt=!1}qt&&(ze.set(at,Ot),le(Ot,at,j,_e,ze),ze.delete(at)),Ve(m,k,Ot)}function m0(m,w){var k=m.length;if(k)return w+=w<0?k:0,No(w,k)?m[w]:n}function mm(m,w,k){w.length?w=gr(w,function(_e){return oi(_e)?function(ze){return wr(ze,_e.length===1?_e[0]:_e)}:_e}):w=[Da];var j=-1;w=gr(w,as(Yn()));var le=Tf(m,function(_e,ze,We){var at=gr(w,function(Dt){return Dt(_e)});return{criteria:at,index:++j,value:_e}});return Kp(le,function(_e,ze){return k2(_e,ze,k)})}function Hh(m,w){return gm(m,w,function(k,j){return yr(m,j)})}function gm(m,w,k){for(var j=-1,le=w.length,_e={};++j<le;){var ze=w[j],We=wr(m,ze);k(We,ze)&&Pf(_e,sa(ze,m),We)}return _e}function P2(m){return function(w){return wr(w,m)}}function g0(m,w,k,j){var le=j?Ah:Ys,_e=-1,ze=w.length,We=m;for(m===w&&(w=Fs(w)),k&&(We=gr(m,as(k)));++_e<ze;)for(var at=0,Dt=w[_e],Ot=k?k(Dt):Dt;(at=le(We,Ot,at,j))>-1;)We!==m&&Ea.call(We,at,1),Ea.call(m,at,1);return m}function I2(m,w){for(var k=m?w.length:0,j=k-1;k--;){var le=w[k];if(k==j||le!==_e){var _e=le;No(le)?Ea.call(m,le,1):vx(m,le)}}return m}function vm(m,w){return m+Eu(Fo()*(w-m+1))}function ym(m,w,k,j){for(var le=-1,_e=Ir(Do((w-m)/(k||1)),0),ze=gt(_e);_e--;)ze[j?_e:++le]=m,m+=k;return ze}function Ru(m,w){var k="";if(!m||w<1||w>ge)return k;do w%2&&(k+=m),w=Eu(w/2),w&&(m+=m);while(w);return k}function si(m,w){return Rx(X2(m,w,Da),m+"")}function fl(m){return Pe(Hu(m))}function Lu(m,w){var k=Hu(m);return L0(k,sn(w,0,k.length))}function Pf(m,w,k,j){if(!fr(m))return m;w=sa(w,m);for(var le=-1,_e=w.length,ze=_e-1,We=m;We!=null&&++le<_e;){var at=Yl(w[le]),Dt=k;if(at==="__proto__"||at==="constructor"||at==="prototype")return m;if(le!=ze){var Ot=We[at];Dt=j?j(Ot,at,We):n,Dt===n&&(Dt=fr(Ot)?Ot:No(w[le+1])?[]:{})}Ee(We,at,Dt),We=We[at]}return m}var ku=Mu?function(m,w){return Mu.set(m,w),m}:Da,JI=Su?function(m,w){return Su(m,"toString",{configurable:!0,enumerable:!1,value:sL(w),writable:!0})}:Da;function R2(m){return L0(Hu(m))}function Oi(m,w,k){var j=-1,le=m.length;w<0&&(w=-w>le?0:le+w),k=k>le?le:k,k<0&&(k+=le),le=w>k?0:k-w>>>0,w>>>=0;for(var _e=gt(le);++j<le;)_e[j]=m[j+w];return _e}function gx(m,w){var k;return tn(m,function(j,le,_e){return k=w(j,le,_e),!k}),!!k}function _m(m,w,k){var j=0,le=m==null?j:m.length;if(typeof w=="number"&&w===w&&le<=Xt){for(;j<le;){var _e=j+le>>>1,ze=m[_e];ze!==null&&!G(ze)&&(k?ze<=w:ze<w)?j=_e+1:le=_e}return le}return Fc(m,w,Da,k)}function Fc(m,w,k,j){var le=0,_e=m==null?0:m.length;if(_e===0)return 0;w=k(w);for(var ze=w!==w,We=w===null,at=G(w),Dt=w===n;le<_e;){var Ot=Eu((le+_e)/2),qt=k(m[Ot]),vn=qt!==n,Nn=qt===null,ti=qt===qt,xi=G(qt);if(ze)var ni=j||ti;else Dt?ni=ti&&(j||vn):We?ni=ti&&vn&&(j||!Nn):at?ni=ti&&vn&&!Nn&&(j||!xi):Nn||xi?ni=!1:ni=j?qt<=w:qt<w;ni?le=Ot+1:_e=Ot}return jr(_e,wt)}function Du(m,w){for(var k=-1,j=m.length,le=0,_e=[];++k<j;){var ze=m[k],We=w?w(ze):ze;if(!k||!Qs(We,at)){var at=We;_e[le++]=ze===0?0:ze}}return _e}function xm(m){return typeof m=="number"?m:G(m)?Ze:+m}function _o(m){if(typeof m=="string")return m;if(oi(m))return gr(m,_o)+"";if(G(m))return fm?fm.call(m):"";var w=m+"";return w=="0"&&1/m==-1/0?"-0":w}function zc(m,w,k){var j=-1,le=Th,_e=m.length,ze=!0,We=[],at=We;if(k)ze=!1,le=Tc;else if(_e>=r){var Dt=w?null:nR(m);if(Dt)return Vl(Dt);ze=!1,le=Pc,at=new E}else at=w?[]:We;e:for(;++j<_e;){var Ot=m[j],qt=w?w(Ot):Ot;if(Ot=k||Ot!==0?Ot:0,ze&&qt===qt){for(var vn=at.length;vn--;)if(at[vn]===qt)continue e;w&&at.push(qt),We.push(Ot)}else le(at,qt,k)||(at!==We&&at.push(qt),We.push(Ot))}return We}function vx(m,w){return w=sa(w,m),m=Px(m,w),m==null||delete m[Yl(Ra(w))]}function yx(m,w,k,j){return Pf(m,w,k(wr(m,w)),j)}function v0(m,w,k,j){for(var le=m.length,_e=j?le:-1;(j?_e--:++_e<le)&&w(m[_e],_e,m););return k?Oi(m,j?0:_e,j?_e+1:le):Oi(m,j?_e+1:0,j?le:_e)}function y0(m,w){var k=m;return k instanceof fi&&(k=k.value()),Xp(w,function(j,le){return le.func.apply(le.thisArg,ta([j],le.args))},k)}function _x(m,w,k){var j=m.length;if(j<2)return j?zc(m[0]):[];for(var le=-1,_e=gt(j);++le<j;)for(var ze=m[le],We=-1;++We<j;)We!=le&&(_e[le]=Jt(_e[le]||ze,m[We],w,k));return zc(Li(_e,1),w,k)}function _0(m,w,k){for(var j=-1,le=m.length,_e=w.length,ze={};++j<le;){var We=j<_e?w[j]:n;k(ze,m[j],We)}return ze}function x0(m){return Zr(m)?m:[]}function b0(m){return typeof m=="function"?m:Da}function sa(m,w){return oi(m)?m:Cx(m,w)?[m]:K2(nn(m))}var QI=si;function Pa(m,w,k){var j=m.length;return k=k===n?j:k,!w&&k>=j?m:Oi(m,w,k)}var bm=im||function(m){return Ar.clearTimeout(m)};function wm(m,w){if(w)return m.slice();var k=m.length,j=Ds?Ds(k):new m.constructor(k);return m.copy(j),j}function w0(m){var w=new m.constructor(m.byteLength);return new Sa(w).set(new Sa(m)),w}function L2(m,w){var k=w?w0(m.buffer):m.buffer;return new m.constructor(k,m.byteOffset,m.byteLength)}function eR(m){var w=new m.constructor(m.source,qi.exec(m));return w.lastIndex=m.lastIndex,w}function Js(m){return Ks?Gi(Ks.call(m)):{}}function Gh(m,w){var k=w?w0(m.buffer):m.buffer;return new m.constructor(k,m.byteOffset,m.length)}function S0(m,w){if(m!==w){var k=m!==n,j=m===null,le=m===m,_e=G(m),ze=w!==n,We=w===null,at=w===w,Dt=G(w);if(!We&&!Dt&&!_e&&m>w||_e&&ze&&at&&!We&&!Dt||j&&ze&&at||!k&&at||!le)return 1;if(!j&&!_e&&!Dt&&m<w||Dt&&k&&le&&!j&&!_e||We&&k&&le||!ze&&le||!at)return-1}return 0}function k2(m,w,k){for(var j=-1,le=m.criteria,_e=w.criteria,ze=le.length,We=k.length;++j<ze;){var at=S0(le[j],_e[j]);if(at){if(j>=We)return at;var Dt=k[j];return at*(Dt=="desc"?-1:1)}}return m.index-w.index}function If(m,w,k,j){for(var le=-1,_e=m.length,ze=k.length,We=-1,at=w.length,Dt=Ir(_e-ze,0),Ot=gt(at+Dt),qt=!j;++We<at;)Ot[We]=w[We];for(;++le<ze;)(qt||le<_e)&&(Ot[k[le]]=m[le]);for(;Dt--;)Ot[We++]=m[le++];return Ot}function D2(m,w,k,j){for(var le=-1,_e=m.length,ze=-1,We=k.length,at=-1,Dt=w.length,Ot=Ir(_e-We,0),qt=gt(Ot+Dt),vn=!j;++le<Ot;)qt[le]=m[le];for(var Nn=le;++at<Dt;)qt[Nn+at]=w[at];for(;++ze<We;)(vn||le<_e)&&(qt[Nn+k[ze]]=m[le++]);return qt}function Fs(m,w){var k=-1,j=m.length;for(w||(w=gt(j));++k<j;)w[k]=m[k];return w}function Zl(m,w,k,j){var le=!k;k||(k={});for(var _e=-1,ze=w.length;++_e<ze;){var We=w[_e],at=j?j(k[We],m[We],We,k,m):n;at===n&&(at=m[We]),le?Ft(k,We,at):Ee(k,We,at)}return k}function O2(m,w){return Zl(m,Cm(m),w)}function F2(m,w){return Zl(m,Mx(m),w)}function Sm(m,w){return function(k,j){var le=oi(k)?e0:rt,_e=w?w():{};return le(k,m,Yn(j,2),_e)}}function Rf(m){return si(function(w,k){var j=-1,le=k.length,_e=le>1?k[le-1]:n,ze=le>2?k[2]:n;for(_e=m.length>3&&typeof _e=="function"?(le--,_e):n,ze&&xo(k[0],k[1],ze)&&(_e=le<3?n:_e,le=1),w=Gi(w);++j<le;){var We=k[j];We&&m(w,We,j,_e)}return w})}function E0(m,w){return function(k,j){if(k==null)return k;if(!eo(k))return m(k,j);for(var le=k.length,_e=w?le:-1,ze=Gi(k);(w?_e--:++_e<le)&&j(ze[_e],_e,ze)!==!1;);return k}}function xx(m){return function(w,k,j){for(var le=-1,_e=Gi(w),ze=j(w),We=ze.length;We--;){var at=ze[m?We:++le];if(k(_e[at],at,_e)===!1)break}return w}}function bx(m,w,k){var j=w&L,le=kf(m);function _e(){var ze=this&&this!==Ar&&this instanceof _e?le:m;return ze.apply(j?k:this,arguments)}return _e}function Lf(m){return function(w){w=nn(w);var k=Ul(w)?po(w):n,j=k?k[0]:w.charAt(0),le=k?Pa(k,1).join(""):w.slice(1);return j[m]()+le}}function _s(m){return function(w){return Xp(N8(jE(w).replace(qv,"")),m,"")}}function kf(m){return function(){var w=arguments;switch(w.length){case 0:return new m;case 1:return new m(w[0]);case 2:return new m(w[0],w[1]);case 3:return new m(w[0],w[1],w[2]);case 4:return new m(w[0],w[1],w[2],w[3]);case 5:return new m(w[0],w[1],w[2],w[3],w[4]);case 6:return new m(w[0],w[1],w[2],w[3],w[4],w[5]);case 7:return new m(w[0],w[1],w[2],w[3],w[4],w[5],w[6])}var k=Wl(m.prototype),j=m.apply(k,w);return fr(j)?j:k}}function tR(m,w,k){var j=kf(m);function le(){for(var _e=arguments.length,ze=gt(_e),We=_e,at=qh(le);We--;)ze[We]=arguments[We];var Dt=_e<3&&ze[0]!==at&&ze[_e-1]!==at?[]:na(ze,at);if(_e-=Dt.length,_e<k)return B2(m,w,M0,le.placeholder,n,ze,Dt,n,n,k-_e);var Ot=this&&this!==Ar&&this instanceof le?j:m;return Zs(Ot,this,ze)}return le}function wx(m){return function(w,k,j){var le=Gi(w);if(!eo(w)){var _e=Yn(k,3);w=Fi(w),k=function(We){return _e(le[We],We,le)}}var ze=m(w,k,j);return ze>-1?le[_e?w[ze]:ze]:n}}function z2(m){return Ia(function(w){var k=w.length,j=k,le=vo.prototype.thru;for(m&&w.reverse();j--;){var _e=w[j];if(typeof _e!="function")throw new ks(u);if(le&&!ze&&Ou(_e)=="wrapper")var ze=new vo([],!0)}for(j=ze?j:k;++j<k;){_e=w[j];var We=Ou(_e),at=We=="wrapper"?Ff(_e):n;at&&R0(at[0])&&at[1]==(W|B|K|ie)&&!at[4].length&&at[9]==1?ze=ze[Ou(at[0])].apply(ze,at[3]):ze=_e.length==1&&R0(_e)?ze[We]():ze.thru(_e)}return function(){var Dt=arguments,Ot=Dt[0];if(ze&&Dt.length==1&&oi(Ot))return ze.plant(Ot).value();for(var qt=0,vn=k?w[qt].apply(this,Dt):Ot;++qt<k;)vn=w[qt].call(this,vn);return vn}})}function M0(m,w,k,j,le,_e,ze,We,at,Dt){var Ot=w&W,qt=w&L,vn=w&P,Nn=w&(B|$),ti=w&Z,xi=vn?n:kf(m);function ni(){for(var Ai=arguments.length,zi=gt(Ai),vl=Ai;vl--;)zi[vl]=arguments[vl];if(Nn)var ca=qh(ni),yl=ff(zi,ca);if(j&&(zi=If(zi,j,le,Nn)),_e&&(zi=D2(zi,_e,ze,Nn)),Ai-=yl,Nn&&Ai<Dt){var us=na(zi,ca);return B2(m,w,M0,ni.placeholder,k,zi,us,We,at,Dt-Ai)}var Wc=qt?k:this,Qh=vn?Wc[m]:m;return Ai=zi.length,We?zi=dR(zi,We):ti&&Ai>1&&zi.reverse(),Ot&&at<Ai&&(zi.length=at),this&&this!==Ar&&this instanceof ni&&(Qh=xi||kf(Qh)),Qh.apply(Wc,zi)}return ni}function N2(m,w){return function(k,j){return cs(k,m,w(j),{})}}function C0(m,w){return function(k,j){var le;if(k===n&&j===n)return w;if(k!==n&&(le=k),j!==n){if(le===n)return j;typeof k=="string"||typeof j=="string"?(k=_o(k),j=_o(j)):(k=xm(k),j=xm(j)),le=m(k,j)}return le}}function T0(m){return Ia(function(w){return w=gr(w,as(Yn())),si(function(k){var j=this;return m(w,function(le){return Zs(le,j,k)})})})}function Em(m,w){w=w===n?" ":_o(w);var k=w.length;if(k<2)return k?Ru(w,m):w;var j=Ru(w,Do(m/ko(w)));return Ul(w)?Pa(po(j),0,m).join(""):j.slice(0,m)}function Wh(m,w,k,j){var le=w&L,_e=kf(m);function ze(){for(var We=-1,at=arguments.length,Dt=-1,Ot=j.length,qt=gt(Ot+at),vn=this&&this!==Ar&&this instanceof ze?_e:m;++Dt<Ot;)qt[Dt]=j[Dt];for(;at--;)qt[Dt++]=arguments[++We];return Zs(vn,le?k:this,qt)}return ze}function Df(m){return function(w,k,j){return j&&typeof j!="number"&&xo(w,k,j)&&(k=j=n),w=tt(w),k===n?(k=w,w=0):k=tt(k),j=j===n?w<k?1:-1:tt(j),ym(w,k,j,m)}}function A0(m){return function(w,k){return typeof w=="string"&&typeof k=="string"||(w=dt(w),k=dt(k)),m(w,k)}}function B2(m,w,k,j,le,_e,ze,We,at,Dt){var Ot=w&B,qt=Ot?ze:n,vn=Ot?n:ze,Nn=Ot?_e:n,ti=Ot?n:_e;w|=Ot?K:q,w&=~(Ot?q:K),w&N||(w&=-4);var xi=[m,w,le,Nn,qt,ti,vn,We,at,Dt],ni=k.apply(n,xi);return R0(m)&&zf(ni,xi),ni.placeholder=j,Z2(ni,m,w)}function Sx(m){var w=Pr[m];return function(k,j){if(k=dt(k),j=j==null?0:jr(Le(j),292),j&&am(k)){var le=(nn(k)+"e").split("e"),_e=w(le[0]+"e"+(+le[1]+j));return le=(nn(_e)+"e").split("e"),+(le[0]+"e"+(+le[1]-j))}return w(k)}}var nR=Hl&&1/Vl(new Hl([,-0]))[1]==Ce?function(m){return new Hl(m)}:lL;function U2(m){return function(w){var k=zs(w);return k==Ln?ol(w):k==re?mf(w):dr(w,m(w))}}function Nc(m,w,k,j,le,_e,ze,We){var at=w&P;if(!at&&typeof m!="function")throw new ks(u);var Dt=j?j.length:0;if(Dt||(w&=-97,j=le=n),ze=ze===n?ze:Ir(Le(ze),0),We=We===n?We:Le(We),Dt-=le?le.length:0,w&q){var Ot=j,qt=le;j=le=n}var vn=at?n:Ff(m),Nn=[m,w,k,j,le,Ot,qt,_e,ze,We];if(vn&&Am(Nn,vn),m=Nn[0],w=Nn[1],k=Nn[2],j=Nn[3],le=Nn[4],We=Nn[9]=Nn[9]===n?at?0:m.length:Ir(Nn[9]-Dt,0),!We&&w&(B|$)&&(w&=-25),!w||w==L)var ti=bx(m,w,k);else w==B||w==$?ti=tR(m,w,We):(w==K||w==(L|K))&&!le.length?ti=Wh(m,w,k,j):ti=M0.apply(n,Nn);var xi=vn?ku:zf;return Z2(xi(ti,Nn),m,w)}function V2(m,w,k,j){return m===n||Qs(m,Nr[k])&&!Ri.call(j,k)?w:m}function P0(m,w,k,j,le,_e){return fr(m)&&fr(w)&&(_e.set(w,m),dl(m,w,n,P0,_e),_e.delete(w)),m}function iR(m){return C(m)?n:m}function jh(m,w,k,j,le,_e){var ze=k&I,We=m.length,at=w.length;if(We!=at&&!(ze&&at>We))return!1;var Dt=_e.get(m),Ot=_e.get(w);if(Dt&&Ot)return Dt==w&&Ot==m;var qt=-1,vn=!0,Nn=k&D?new E:n;for(_e.set(m,w),_e.set(w,m);++qt<We;){var ti=m[qt],xi=w[qt];if(j)var ni=ze?j(xi,ti,qt,w,m,_e):j(ti,xi,qt,m,w,_e);if(ni!==n){if(ni)continue;vn=!1;break}if(Nn){if(!lf(w,function(Ai,zi){if(!Pc(Nn,zi)&&(ti===Ai||le(ti,Ai,k,j,_e)))return Nn.push(zi)})){vn=!1;break}}else if(!(ti===xi||le(ti,xi,k,j,_e))){vn=!1;break}}return _e.delete(m),_e.delete(w),vn}function rR(m,w,k,j,le,_e,ze){switch(k){case it:if(m.byteLength!=w.byteLength||m.byteOffset!=w.byteOffset)return!1;m=m.buffer,w=w.buffer;case $t:return!(m.byteLength!=w.byteLength||!_e(new Sa(m),new Sa(w)));case fn:case Mn:case Cn:return Qs(+m,+w);case Kn:return m.name==w.name&&m.message==w.message;case ve:case Xe:return m==w+"";case Ln:var We=ol;case re:var at=j&I;if(We||(We=Vl),m.size!=w.size&&!at)return!1;var Dt=ze.get(m);if(Dt)return Dt==w;j|=D,ze.set(m,w);var Ot=jh(We(m),We(w),j,le,_e,ze);return ze.delete(m),Ot;case Ge:if(Ks)return Ks.call(m)==Ks.call(w)}return!1}function Lr(m,w,k,j,le,_e){var ze=k&I,We=I0(m),at=We.length,Dt=I0(w),Ot=Dt.length;if(at!=Ot&&!ze)return!1;for(var qt=at;qt--;){var vn=We[qt];if(!(ze?vn in w:Ri.call(w,vn)))return!1}var Nn=_e.get(m),ti=_e.get(w);if(Nn&&ti)return Nn==w&&ti==m;var xi=!0;_e.set(m,w),_e.set(w,m);for(var ni=ze;++qt<at;){vn=We[qt];var Ai=m[vn],zi=w[vn];if(j)var vl=ze?j(zi,Ai,vn,w,m,_e):j(Ai,zi,vn,m,w,_e);if(!(vl===n?Ai===zi||le(Ai,zi,k,j,_e):vl)){xi=!1;break}ni||(ni=vn=="constructor")}if(xi&&!ni){var ca=m.constructor,yl=w.constructor;ca!=yl&&"constructor"in m&&"constructor"in w&&!(typeof ca=="function"&&ca instanceof ca&&typeof yl=="function"&&yl instanceof yl)&&(xi=!1)}return _e.delete(m),_e.delete(w),xi}function Ia(m){return Rx(X2(m,n,Ur),m+"")}function I0(m){return zo(m,Fi,Cm)}function Of(m){return zo(m,ji,Mx)}var Ff=Mu?function(m){return Mu.get(m)}:lL;function Ou(m){for(var w=m.name+"",k=ra[w],j=Ri.call(ra,w)?k.length:0;j--;){var le=k[j],_e=le.func;if(_e==null||_e==m)return le.name}return w}function qh(m){var w=Ri.call(oe,"placeholder")?oe:m;return w.placeholder}function Yn(){var m=oe.iteratee||oL;return m=m===oL?Uh:m,arguments.length?m(arguments[0],arguments[1]):m}function Fu(m,w){var k=m.__data__;return cR(w)?k[typeof w=="string"?"string":"hash"]:k.map}function Mm(m){for(var w=Fi(m),k=w.length;k--;){var j=w[k],le=m[j];w[k]=[j,le,j2(le)]}return w}function Bc(m,w){var k=fo(m,w);return Mf(k)?k:n}function Ex(m){var w=Ri.call(m,ia),k=m[ia];try{m[ia]=n;var j=!0}catch{}var le=_u.call(m);return j&&(w?m[ia]=k:delete m[ia]),le}var Cm=xf?function(m){return m==null?[]:(m=Gi(m),Nl(xf(m),function(w){return _f.call(m,w)}))}:cL,Mx=xf?function(m){for(var w=[];m;)ta(w,Cm(m)),m=Dc(m);return w}:cL,zs=Rr;(mo&&zs(new mo(new ArrayBuffer(1)))!=it||go&&zs(new go)!=Ln||hm&&zs(hm.resolve())!=Pt||Hl&&zs(new Hl)!=re||Fh&&zs(new Fh)!=ft)&&(zs=function(m){var w=Rr(m),k=w==xt?m.constructor:n,j=k?Nu(k):"";if(j)switch(j){case Ma:return it;case dn:return Ln;case c0:return Pt;case dm:return re;case u0:return ft}return w});function sR(m,w,k){for(var j=-1,le=k.length;++j<le;){var _e=k[j],ze=_e.size;switch(_e.type){case"drop":m+=ze;break;case"dropRight":w-=ze;break;case"take":w=jr(w,m+ze);break;case"takeRight":m=Ir(m,w-ze);break}}return{start:m,end:w}}function oR(m){var w=m.match(bn);return w?w[1].split(Sn):[]}function $2(m,w,k){w=sa(w,m);for(var j=-1,le=w.length,_e=!1;++j<le;){var ze=Yl(w[j]);if(!(_e=m!=null&&k(m,ze)))break;m=m[ze]}return _e||++j!=le?_e:(le=m==null?0:m.length,!!le&&Zh(le)&&No(ze,le)&&(oi(m)||Vc(m)))}function aR(m){var w=m.length,k=new m.constructor(w);return w&&typeof m[0]=="string"&&Ri.call(m,"index")&&(k.index=m.index,k.input=m.input),k}function H2(m){return typeof m.constructor=="function"&&!Tm(m)?Wl(Dc(m)):{}}function zu(m,w,k){var j=m.constructor;switch(w){case $t:return w0(m);case fn:case Mn:return new j(+m);case it:return L2(m,k);case On:case Nt:case on:case Wn:case yt:case Tt:case Vt:case kn:case ii:return Gh(m,k);case Ln:return new j;case Cn:case Xe:return new j(m);case ve:return eR(m);case re:return new j;case Ge:return Js(m)}}function lR(m,w){var k=w.length;if(!k)return m;var j=k-1;return w[j]=(k>1?"& ":"")+w[j],w=w.join(k>2?", ":" "),m.replace(Wt,`{
/* [wrapped with `+w+`] */
`)}function G2(m){return oi(m)||Vc(m)||!!(wu&&m&&m[wu])}function No(m,w){var k=typeof m;return w=w??ge,!!w&&(k=="number"||k!="symbol"&&Je.test(m))&&m>-1&&m%1==0&&m<w}function xo(m,w,k){if(!fr(k))return!1;var j=typeof w;return(j=="number"?eo(k)&&No(w,k.length):j=="string"&&w in k)?Qs(k[w],m):!1}function Cx(m,w){if(oi(m))return!1;var k=typeof m;return k=="number"||k=="symbol"||k=="boolean"||m==null||G(m)?!0:He.test(m)||!Fe.test(m)||w!=null&&m in Gi(w)}function cR(m){var w=typeof m;return w=="string"||w=="number"||w=="symbol"||w=="boolean"?m!=="__proto__":m===null}function R0(m){var w=Ou(m),k=oe[w];if(typeof k!="function"||!(w in fi.prototype))return!1;if(m===k)return!0;var j=Ff(k);return!!j&&m===j[0]}function W2(m){return!!kc&&kc in m}var uR=$l?Kl:uL;function Tm(m){var w=m&&m.constructor,k=typeof w=="function"&&w.prototype||Nr;return m===k}function j2(m){return m===m&&!fr(m)}function q2(m,w){return function(k){return k==null?!1:k[m]===w&&(w!==n||m in Gi(k))}}function Tx(m){var w=pl(m,function(j){return k.size===g&&k.clear(),j}),k=w.cache;return w}function Am(m,w){var k=m[1],j=w[1],le=k|j,_e=le<(L|P|W),ze=j==W&&k==B||j==W&&k==ie&&m[7].length<=w[8]||j==(W|ie)&&w[7].length<=w[8]&&k==B;if(!(_e||ze))return m;j&L&&(m[2]=w[2],le|=k&L?0:N);var We=w[3];if(We){var at=m[3];m[3]=at?If(at,We,w[4]):We,m[4]=at?na(m[3],y):w[4]}return We=w[5],We&&(at=m[5],m[5]=at?D2(at,We,w[6]):We,m[6]=at?na(m[5],y):w[6]),We=w[7],We&&(m[7]=We),j&W&&(m[8]=m[8]==null?w[8]:jr(m[8],w[8])),m[9]==null&&(m[9]=w[9]),m[0]=w[0],m[1]=le,m}function Ax(m){var w=[];if(m!=null)for(var k in Gi(m))w.push(k);return w}function hR(m){return _u.call(m)}function X2(m,w,k){return w=Ir(w===n?m.length-1:w,0),function(){for(var j=arguments,le=-1,_e=Ir(j.length-w,0),ze=gt(_e);++le<_e;)ze[le]=j[w+le];le=-1;for(var We=gt(w+1);++le<w;)We[le]=j[le];return We[w]=k(ze),Zs(m,this,We)}}function Px(m,w){return w.length<2?m:wr(m,Oi(w,0,-1))}function dR(m,w){for(var k=m.length,j=jr(w.length,k),le=Fs(m);j--;){var _e=w[j];m[j]=No(_e,k)?le[_e]:n}return m}function Ix(m,w){if(!(w==="constructor"&&typeof m[w]=="function")&&w!="__proto__")return m[w]}var zf=Y2(ku),Nf=sm||function(m,w){return Ar.setTimeout(m,w)},Rx=Y2(JI);function Z2(m,w,k){var j=w+"";return Rx(m,lR(j,Lx(oR(j),k)))}function Y2(m){var w=0,k=0;return function(){var j=l0(),le=Se-(j-k);if(k=j,le>0){if(++w>=De)return arguments[0]}else w=0;return m.apply(n,arguments)}}function L0(m,w){var k=-1,j=m.length,le=j-1;for(w=w===n?j:w;++k<w;){var _e=vm(k,le),ze=m[_e];m[_e]=m[k],m[k]=ze}return m.length=w,m}var K2=Tx(function(m){var w=[];return m.charCodeAt(0)===46&&w.push(""),m.replace(nt,function(k,j,le,_e){w.push(le?_e.replace(Vn,"$1"):j||k)}),w});function Yl(m){if(typeof m=="string"||G(m))return m;var w=m+"";return w=="0"&&1/m==-1/0?"-0":w}function Nu(m){if(m!=null){try{return yu.call(m)}catch{}try{return m+""}catch{}}return""}function Lx(m,w){return es(Ke,function(k){var j="_."+k[0];w&k[1]&&!Th(m,j)&&m.push(j)}),m.sort()}function kx(m){if(m instanceof fi)return m.clone();var w=new vo(m.__wrapped__,m.__chain__);return w.__actions__=Fs(m.__actions__),w.__index__=m.__index__,w.__values__=m.__values__,w}function J2(m,w,k){(k?xo(m,w,k):w===n)?w=1:w=Ir(Le(w),0);var j=m==null?0:m.length;if(!j||w<1)return[];for(var le=0,_e=0,ze=gt(Do(j/w));le<j;)ze[_e++]=Oi(m,le,le+=w);return ze}function Q2(m){for(var w=-1,k=m==null?0:m.length,j=0,le=[];++w<k;){var _e=m[w];_e&&(le[j++]=_e)}return le}function fR(){var m=arguments.length;if(!m)return[];for(var w=gt(m-1),k=arguments[0],j=m;j--;)w[j-1]=arguments[j];return ta(oi(k)?Fs(k):[k],Li(w,1))}var k0=si(function(m,w){return Zr(m)?Jt(m,Li(w,1,Zr,!0)):[]}),pR=si(function(m,w){var k=Ra(w);return Zr(k)&&(k=n),Zr(m)?Jt(m,Li(w,1,Zr,!0),Yn(k,2)):[]}),eE=si(function(m,w){var k=Ra(w);return Zr(k)&&(k=n),Zr(m)?Jt(m,Li(w,1,Zr,!0),n,k):[]});function mR(m,w,k){var j=m==null?0:m.length;return j?(w=k||w===n?1:Le(w),Oi(m,w<0?0:w,j)):[]}function gR(m,w,k){var j=m==null?0:m.length;return j?(w=k||w===n?1:Le(w),w=j-w,Oi(m,0,w<0?0:w)):[]}function vR(m,w){return m&&m.length?v0(m,Yn(w,3),!0,!0):[]}function tE(m,w){return m&&m.length?v0(m,Yn(w,3),!0):[]}function yR(m,w,k,j){var le=m==null?0:m.length;return le?(k&&typeof k!="number"&&xo(m,w,k)&&(k=0,j=le),hi(m,w,k,j)):[]}function nE(m,w,k){var j=m==null?0:m.length;if(!j)return-1;var le=k==null?0:Le(k);return le<0&&(le=Ir(j+le,0)),Ac(m,Yn(w,3),le)}function Bf(m,w,k){var j=m==null?0:m.length;if(!j)return-1;var le=j-1;return k!==n&&(le=Le(k),le=k<0?Ir(j+le,0):jr(le,j-1)),Ac(m,Yn(w,3),le,!0)}function Ur(m){var w=m==null?0:m.length;return w?Li(m,1):[]}function iE(m){var w=m==null?0:m.length;return w?Li(m,Ce):[]}function rE(m,w){var k=m==null?0:m.length;return k?(w=w===n?1:Le(w),Li(m,w)):[]}function sE(m){for(var w=-1,k=m==null?0:m.length,j={};++w<k;){var le=m[w];j[le[0]]=le[1]}return j}function Bi(m){return m&&m.length?m[0]:n}function Dx(m,w,k){var j=m==null?0:m.length;if(!j)return-1;var le=k==null?0:Le(k);return le<0&&(le=Ir(j+le,0)),Ys(m,w,le)}function oE(m){var w=m==null?0:m.length;return w?Oi(m,0,-1):[]}var aE=si(function(m){var w=gr(m,x0);return w.length&&w[0]===m[0]?Bh(w):[]}),Uc=si(function(m){var w=Ra(m),k=gr(m,x0);return w===Ra(k)?w=n:k.pop(),k.length&&k[0]===m[0]?Bh(k,Yn(w,2)):[]}),Uf=si(function(m){var w=Ra(m),k=gr(m,x0);return w=typeof w=="function"?w:n,w&&k.pop(),k.length&&k[0]===m[0]?Bh(k,n,w):[]});function lE(m,w){return m==null?"":lm.call(m,w)}function Ra(m){var w=m==null?0:m.length;return w?m[w-1]:n}function _R(m,w,k){var j=m==null?0:m.length;if(!j)return-1;var le=j;return k!==n&&(le=Le(k),le=le<0?Ir(j+le,0):jr(le,j-1)),w===w?vu(m,w,le):Ac(m,cf,le,!0)}function xR(m,w){return m&&m.length?m0(m,Le(w)):n}var bR=si(cE);function cE(m,w){return m&&m.length&&w&&w.length?g0(m,w):m}function wR(m,w,k){return m&&m.length&&w&&w.length?g0(m,w,Yn(k,2)):m}function SR(m,w,k){return m&&m.length&&w&&w.length?g0(m,w,n,k):m}var ER=Ia(function(m,w){var k=m==null?0:m.length,j=an(m,w);return I2(m,gr(w,function(le){return No(le,k)?+le:le}).sort(S0)),j});function MR(m,w){var k=[];if(!(m&&m.length))return k;var j=-1,le=[],_e=m.length;for(w=Yn(w,3);++j<_e;){var ze=m[j];w(ze,j,m)&&(k.push(ze),le.push(j))}return I2(m,le),k}function Vf(m){return m==null?m:um.call(m)}function $f(m,w,k){var j=m==null?0:m.length;return j?(k&&typeof k!="number"&&xo(m,w,k)?(w=0,k=j):(w=w==null?0:Le(w),k=k===n?j:Le(k)),Oi(m,w,k)):[]}function uE(m,w){return _m(m,w)}function Ox(m,w,k){return Fc(m,w,Yn(k,2))}function Fx(m,w){var k=m==null?0:m.length;if(k){var j=_m(m,w);if(j<k&&Qs(m[j],w))return j}return-1}function CR(m,w){return _m(m,w,!0)}function TR(m,w,k){return Fc(m,w,Yn(k,2),!0)}function AR(m,w){var k=m==null?0:m.length;if(k){var j=_m(m,w,!0)-1;if(Qs(m[j],w))return j}return-1}function PR(m){return m&&m.length?Du(m):[]}function hE(m,w){return m&&m.length?Du(m,Yn(w,2)):[]}function bo(m){var w=m==null?0:m.length;return w?Oi(m,1,w):[]}function zx(m,w,k){return m&&m.length?(w=k||w===n?1:Le(w),Oi(m,0,w<0?0:w)):[]}function dE(m,w,k){var j=m==null?0:m.length;return j?(w=k||w===n?1:Le(w),w=j-w,Oi(m,w<0?0:w,j)):[]}function Bu(m,w){return m&&m.length?v0(m,Yn(w,3),!1,!0):[]}function Pm(m,w){return m&&m.length?v0(m,Yn(w,3)):[]}var Im=si(function(m){return zc(Li(m,1,Zr,!0))}),Hf=si(function(m){var w=Ra(m);return Zr(w)&&(w=n),zc(Li(m,1,Zr,!0),Yn(w,2))}),D0=si(function(m){var w=Ra(m);return w=typeof w=="function"?w:n,zc(Li(m,1,Zr,!0),n,w)});function O0(m){return m&&m.length?zc(m):[]}function IR(m,w){return m&&m.length?zc(m,Yn(w,2)):[]}function RR(m,w){return w=typeof w=="function"?w:n,m&&m.length?zc(m,n,w):[]}function F0(m){if(!(m&&m.length))return[];var w=0;return m=Nl(m,function(k){if(Zr(k))return w=Ir(k.length,w),!0}),Ih(w,function(k){return gr(m,hf(k))})}function Nx(m,w){if(!(m&&m.length))return[];var k=F0(m);return w==null?k:gr(k,function(j){return Zs(w,n,j)})}var LR=si(function(m,w){return Zr(m)?Jt(m,w):[]}),fE=si(function(m){return _x(Nl(m,Zr))}),pE=si(function(m){var w=Ra(m);return Zr(w)&&(w=n),_x(Nl(m,Zr),Yn(w,2))}),Bx=si(function(m){var w=Ra(m);return w=typeof w=="function"?w:n,_x(Nl(m,Zr),n,w)}),Ux=si(F0);function kR(m,w){return _0(m||[],w||[],Ee)}function DR(m,w){return _0(m||[],w||[],Pf)}var mE=si(function(m){var w=m.length,k=w>1?m[w-1]:n;return k=typeof k=="function"?(m.pop(),k):n,Nx(m,k)});function Vx(m){var w=oe(m);return w.__chain__=!0,w}function Rm(m,w){return w(m),m}function oa(m,w){return w(m)}var Uu=Ia(function(m){var w=m.length,k=w?m[0]:0,j=this.__wrapped__,le=function(_e){return an(_e,m)};return w>1||this.__actions__.length||!(j instanceof fi)||!No(k)?this.thru(le):(j=j.slice(k,+k+(w?1:0)),j.__actions__.push({func:oa,args:[le],thisArg:n}),new vo(j,this.__chain__).thru(function(_e){return w&&!_e.length&&_e.push(n),_e}))});function gE(){return Vx(this)}function $x(){return new vo(this.value(),this.__chain__)}function OR(){this.__values__===n&&(this.__values__=Oe(this.value()));var m=this.__index__>=this.__values__.length,w=m?n:this.__values__[this.__index__++];return{done:m,value:w}}function FR(){return this}function z0(m){for(var w,k=this;k instanceof bf;){var j=kx(k);j.__index__=0,j.__values__=n,w?le.__wrapped__=j:w=j;var le=j;k=k.__wrapped__}return le.__wrapped__=m,w}function Hx(){var m=this.__wrapped__;if(m instanceof fi){var w=m;return this.__actions__.length&&(w=new fi(this)),w=w.reverse(),w.__actions__.push({func:oa,args:[Vf],thisArg:n}),new vo(w,this.__chain__)}return this.thru(Vf)}function zR(){return y0(this.__wrapped__,this.__actions__)}var Gx=Sm(function(m,w,k){Ri.call(m,k)?++m[k]:Ft(m,k,1)});function Wx(m,w,k){var j=oi(m)?n0:rr;return k&&xo(m,w,k)&&(w=n),j(m,Yn(w,3))}function Gf(m,w){var k=oi(m)?Nl:nr;return k(m,Yn(w,3))}var vE=wx(nE),yE=wx(Bf);function jx(m,w){return Li(B0(m,w),1)}function _E(m,w){return Li(B0(m,w),Ce)}function N0(m,w,k){return k=k===n?1:Le(k),Li(B0(m,w),k)}function qx(m,w){var k=oi(m)?es:tn;return k(m,Yn(w,3))}function xE(m,w){var k=oi(m)?t0:Un;return k(m,Yn(w,3))}var NR=Sm(function(m,w,k){Ri.call(m,k)?m[k].push(w):Ft(m,k,[w])});function bE(m,w,k,j){m=eo(m)?m:Hu(m),k=k&&!j?Le(k):0;var le=m.length;return k<0&&(k=Ir(le+k,0)),U(m)?k<=le&&m.indexOf(w,k)>-1:!!le&&Ys(m,w,k)>-1}var BR=si(function(m,w,k){var j=-1,le=typeof w=="function",_e=eo(m)?gt(m.length):[];return tn(m,function(ze){_e[++j]=le?Zs(w,ze,k):Os(ze,w,k)}),_e}),UR=Sm(function(m,w,k){Ft(m,k,w)});function B0(m,w){var k=oi(m)?gr:Tf;return k(m,Yn(w,3))}function VR(m,w,k,j){return m==null?[]:(oi(w)||(w=w==null?[]:[w]),k=j?n:k,oi(k)||(k=k==null?[]:[k]),mm(m,w,k))}var Xx=Sm(function(m,w,k){m[k?0:1].push(w)},function(){return[[],[]]});function Vu(m,w,k){var j=oi(m)?Xp:Xi,le=arguments.length<3;return j(m,Yn(w,4),k,le,tn)}function wE(m,w,k){var j=oi(m)?mx:Xi,le=arguments.length<3;return j(m,Yn(w,4),k,le,Un)}function SE(m,w){var k=oi(m)?Nl:nr;return k(m,Lm(Yn(w,3)))}function EE(m){var w=oi(m)?Pe:fl;return w(m)}function ME(m,w,k){(k?xo(m,w,k):w===n)?w=1:w=Le(w);var j=oi(m)?Te:Lu;return j(m,w)}function CE(m){var w=oi(m)?ke:R2;return w(m)}function Zx(m){if(m==null)return 0;if(eo(m))return U(m)?ko(m):m.length;var w=zs(m);return w==Ln||w==re?m.size:Aa(m).length}function U0(m,w,k){var j=oi(m)?lf:gx;return k&&xo(m,w,k)&&(w=n),j(m,Yn(w,3))}var TE=si(function(m,w){if(m==null)return[];var k=w.length;return k>1&&xo(m,w[0],w[1])?w=[]:k>2&&xo(w[0],w[1],w[2])&&(w=[w[0]]),mm(m,Li(w,1),[])}),Wf=rm||function(){return Ar.Date.now()};function AE(m,w){if(typeof w!="function")throw new ks(u);return m=Le(m),function(){if(--m<1)return w.apply(this,arguments)}}function Bo(m,w,k){return w=k?n:w,w=m&&w==null?m.length:w,Nc(m,W,n,n,n,n,w)}function jf(m,w){var k;if(typeof w!="function")throw new ks(u);return m=Le(m),function(){return--m>0&&(k=w.apply(this,arguments)),m<=1&&(w=n),k}}var V0=si(function(m,w,k){var j=L;if(k.length){var le=na(k,qh(V0));j|=K}return Nc(m,j,w,k,le)}),Yx=si(function(m,w,k){var j=L|P;if(k.length){var le=na(k,qh(Yx));j|=K}return Nc(w,j,m,k,le)});function Kx(m,w,k){w=k?n:w;var j=Nc(m,B,n,n,n,n,n,w);return j.placeholder=Kx.placeholder,j}function Jx(m,w,k){w=k?n:w;var j=Nc(m,$,n,n,n,n,n,w);return j.placeholder=Jx.placeholder,j}function Qx(m,w,k){var j,le,_e,ze,We,at,Dt=0,Ot=!1,qt=!1,vn=!0;if(typeof m!="function")throw new ks(u);w=dt(w)||0,fr(k)&&(Ot=!!k.leading,qt="maxWait"in k,_e=qt?Ir(dt(k.maxWait)||0,w):_e,vn="trailing"in k?!!k.trailing:vn);function Nn(us){var Wc=j,Qh=le;return j=le=n,Dt=us,ze=m.apply(Qh,Wc),ze}function ti(us){return Dt=us,We=Nf(Ai,w),Ot?Nn(us):ze}function xi(us){var Wc=us-at,Qh=us-Dt,V8=w-Wc;return qt?jr(V8,_e-Qh):V8}function ni(us){var Wc=us-at,Qh=us-Dt;return at===n||Wc>=w||Wc<0||qt&&Qh>=_e}function Ai(){var us=Wf();if(ni(us))return zi(us);We=Nf(Ai,xi(us))}function zi(us){return We=n,vn&&j?Nn(us):(j=le=n,ze)}function vl(){We!==n&&bm(We),Dt=0,j=at=le=We=n}function ca(){return We===n?ze:zi(Wf())}function yl(){var us=Wf(),Wc=ni(us);if(j=arguments,le=this,at=us,Wc){if(We===n)return ti(at);if(qt)return bm(We),We=Nf(Ai,w),Nn(at)}return We===n&&(We=Nf(Ai,w)),ze}return yl.cancel=vl,yl.flush=ca,yl}var PE=si(function(m,w){return $n(m,1,w)}),$R=si(function(m,w,k){return $n(m,dt(w)||0,k)});function IE(m){return Nc(m,Z)}function pl(m,w){if(typeof m!="function"||w!=null&&typeof w!="function")throw new ks(u);var k=function(){var j=arguments,le=w?w.apply(this,j):j[0],_e=k.cache;if(_e.has(le))return _e.get(le);var ze=m.apply(this,j);return k.cache=_e.set(le,ze)||_e,ze};return k.cache=new(pl.Cache||An),k}pl.Cache=An;function Lm(m){if(typeof m!="function")throw new ks(u);return function(){var w=arguments;switch(w.length){case 0:return!m.call(this);case 1:return!m.call(this,w[0]);case 2:return!m.call(this,w[0],w[1]);case 3:return!m.call(this,w[0],w[1],w[2])}return!m.apply(this,w)}}function RE(m){return jf(2,m)}var LE=QI(function(m,w){w=w.length==1&&oi(w[0])?gr(w[0],as(Yn())):gr(Li(w,1),as(Yn()));var k=w.length;return si(function(j){for(var le=-1,_e=jr(j.length,k);++le<_e;)j[le]=w[le].call(this,j[le]);return Zs(m,this,j)})}),$0=si(function(m,w){var k=na(w,qh($0));return Nc(m,K,n,w,k)}),kE=si(function(m,w){var k=na(w,qh(kE));return Nc(m,q,n,w,k)}),HR=Ia(function(m,w){return Nc(m,ie,n,n,n,w)});function DE(m,w){if(typeof m!="function")throw new ks(u);return w=w===n?w:Le(w),si(m,w)}function km(m,w){if(typeof m!="function")throw new ks(u);return w=w==null?0:Ir(Le(w),0),si(function(k){var j=k[w],le=Pa(k,0,w);return j&&ta(le,j),Zs(m,this,le)})}function OE(m,w,k){var j=!0,le=!0;if(typeof m!="function")throw new ks(u);return fr(k)&&(j="leading"in k?!!k.leading:j,le="trailing"in k?!!k.trailing:le),Qx(m,w,{leading:j,maxWait:w,trailing:le})}function H0(m){return Bo(m,1)}function FE(m,w){return $0(b0(w),m)}function G0(){if(!arguments.length)return[];var m=arguments[0];return oi(m)?m:[m]}function W0(m){return kt(m,A)}function j0(m,w){return w=typeof w=="function"?w:n,kt(m,A,w)}function GR(m){return kt(m,S|A)}function WR(m,w){return w=typeof w=="function"?w:n,kt(m,S|A,w)}function jR(m,w){return w==null||pn(m,w,Fi(w))}function Qs(m,w){return m===w||m!==m&&w!==w}var xs=A0(Au),$u=A0(function(m,w){return m>=w}),Vc=hl(function(){return arguments}())?hl:function(m){return Sr(m)&&Ri.call(m,"callee")&&!_f.call(m,"callee")},oi=gt.isArray,zE=Gp?as(Gp):Iu;function eo(m){return m!=null&&Zh(m.length)&&!Kl(m)}function Zr(m){return Sr(m)&&eo(m)}function NE(m){return m===!0||m===!1||Sr(m)&&Rr(m)==fn}var $c=om||uL,qR=Qv?as(Qv):ys;function BE(m){return Sr(m)&&m.nodeType===1&&!C(m)}function e1(m){if(m==null)return!0;if(eo(m)&&(oi(m)||typeof m=="string"||typeof m.splice=="function"||$c(m)||Y(m)||Vc(m)))return!m.length;var w=zs(m);if(w==Ln||w==re)return!m.size;if(Tm(m))return!Aa(m).length;for(var k in m)if(Ri.call(m,k))return!1;return!0}function t1(m,w){return Br(m,w)}function UE(m,w,k){k=typeof k=="function"?k:n;var j=k?k(m,w):n;return j===n?Br(m,w,n,k):!!j}function Xh(m){if(!Sr(m))return!1;var w=Rr(m);return w==Kn||w==Bt||typeof m.message=="string"&&typeof m.name=="string"&&!C(m)}function n1(m){return typeof m=="number"&&am(m)}function Kl(m){if(!fr(m))return!1;var w=Rr(m);return w==Re||w==Jn||w==Rt||w==mt}function q0(m){return typeof m=="number"&&m==Le(m)}function Zh(m){return typeof m=="number"&&m>-1&&m%1==0&&m<=ge}function fr(m){var w=typeof m;return m!=null&&(w=="object"||w=="function")}function Sr(m){return m!=null&&typeof m=="object"}var X0=Wp?as(Wp):vr;function i1(m,w){return m===w||Xl(m,w,Mm(w))}function XR(m,w,k){return k=typeof k=="function"?k:n,Xl(m,w,Mm(w),k)}function c(m){return x(m)&&m!=+m}function s(m){if(uR(m))throw new Qn(a);return Mf(m)}function h(m){return m===null}function p(m){return m==null}function x(m){return typeof m=="number"||Sr(m)&&Rr(m)==Cn}function C(m){if(!Sr(m)||Rr(m)!=xt)return!1;var w=Dc(m);if(w===null)return!0;var k=Ri.call(w,"constructor")&&w.constructor;return typeof k=="function"&&k instanceof k&&yu.call(k)==xu}var T=af?as(af):Xr;function R(m){return q0(m)&&m>=-9007199254740991&&m<=ge}var F=jp?as(jp):f0;function U(m){return typeof m=="string"||!oi(m)&&Sr(m)&&Rr(m)==Xe}function G(m){return typeof m=="symbol"||Sr(m)&&Rr(m)==Ge}var Y=qp?as(qp):Cf;function ee(m){return m===n}function ae(m){return Sr(m)&&zs(m)==ft}function ue(m){return Sr(m)&&Rr(m)==Ht}var pe=A0(Vh),Ae=A0(function(m,w){return m<=w});function Oe(m){if(!m)return[];if(eo(m))return U(m)?po(m):Fs(m);if(cl&&m[cl])return Qp(m[cl]());var w=zs(m),k=w==Ln?ol:w==re?Vl:Hu;return k(m)}function tt(m){if(!m)return m===0?m:0;if(m=dt(m),m===Ce||m===-1/0){var w=m<0?-1:1;return w*Be}return m===m?m:0}function Le(m){var w=tt(m),k=w%1;return w===w?k?w-k:w:0}function Qe(m){return m?sn(Le(m),0,je):0}function dt(m){if(typeof m=="number")return m;if(G(m))return Ze;if(fr(m)){var w=typeof m.valueOf=="function"?m.valueOf():m;m=fr(w)?w+"":w}if(typeof m!="string")return m===0?m:+m;m=er(m);var k=$e.test(m);return k||lt.test(m)?$p(m.slice(2),k?2:8):me.test(m)?Ze:+m}function Ut(m){return Zl(m,ji(m))}function cn(m){return m?sn(Le(m),-9007199254740991,ge):m===0?m:0}function nn(m){return m==null?"":_o(m)}var ln=Rf(function(m,w){if(Tm(w)||eo(w)){Zl(w,Fi(w),m);return}for(var k in w)Ri.call(w,k)&&Ee(m,k,w[k])}),rn=Rf(function(m,w){Zl(w,ji(w),m)}),xn=Rf(function(m,w,k,j){Zl(w,ji(w),m,j)}),mn=Rf(function(m,w,k,j){Zl(w,Fi(w),m,j)}),hn=Ia(an);function St(m,w){var k=Wl(m);return w==null?k:ht(k,w)}var Pn=si(function(m,w){m=Gi(m);var k=-1,j=w.length,le=j>2?w[2]:n;for(le&&xo(w[0],w[1],le)&&(j=1);++k<j;)for(var _e=w[k],ze=ji(_e),We=-1,at=ze.length;++We<at;){var Dt=ze[We],Ot=m[Dt];(Ot===n||Qs(Ot,Nr[Dt])&&!Ri.call(m,Dt))&&(m[Dt]=_e[Dt])}return m}),wn=si(function(m){return m.push(n,P0),Zs(Yi,n,m)});function Hn(m,w){return Yp(m,Yn(w,3),_r)}function Zi(m,w){return Yp(m,Yn(w,3),ls)}function Wi(m,w){return m==null?m:yo(m,Yn(w,3),ji)}function ns(m,w){return m==null?m:ir(m,Yn(w,3),ji)}function La(m,w){return m&&_r(m,Yn(w,3))}function bs(m,w){return m&&ls(m,Yn(w,3))}function Er(m){return m==null?[]:qr(m,Fi(m))}function to(m){return m==null?[]:qr(m,ji(m))}function ws(m,w,k){var j=m==null?n:wr(m,w);return j===n?k:j}function no(m,w){return m!=null&&$2(m,w,Pu)}function yr(m,w){return m!=null&&$2(m,w,Oc)}var is=N2(function(m,w,k){w!=null&&typeof w.toString!="function"&&(w=_u.call(w)),m[w]=k},sL(Da)),Ns=N2(function(m,w,k){w!=null&&typeof w.toString!="function"&&(w=_u.call(w)),Ri.call(m,w)?m[w].push(k):m[w]=[k]},Yn),Ss=si(Os);function Fi(m){return eo(m)?be(m):Aa(m)}function ji(m){return eo(m)?be(m,!0):p0(m)}function aa(m,w){var k={};return w=Yn(w,3),_r(m,function(j,le,_e){Ft(k,w(j,le,_e),j)}),k}function wo(m,w){var k={};return w=Yn(w,3),_r(m,function(j,le,_e){Ft(k,le,w(j,le,_e))}),k}var Mi=Rf(function(m,w,k){dl(m,w,k)}),Yi=Rf(function(m,w,k,j){dl(m,w,k,j)}),sr=Ia(function(m,w){var k={};if(m==null)return k;var j=!1;w=gr(w,function(_e){return _e=sa(_e,m),j||(j=_e.length>1),_e}),Zl(m,Of(m),k),j&&(k=kt(k,S|b|A,iR));for(var le=w.length;le--;)vx(k,w[le]);return k});function Uo(m,w){return Yh(m,Lm(Yn(w)))}var xr=Ia(function(m,w){return m==null?{}:Hh(m,w)});function Yh(m,w){if(m==null)return{};var k=gr(Of(m),function(j){return[j]});return w=Yn(w),gm(m,k,function(j,le){return w(j,le[0])})}function Jl(m,w,k){w=sa(w,m);var j=-1,le=w.length;for(le||(le=1,m=n);++j<le;){var _e=m==null?n:m[Yl(w[j])];_e===n&&(j=le,_e=k),m=Kl(_e)?_e.call(m):_e}return m}function Ql(m,w,k){return m==null?m:Pf(m,w,k)}function ka(m,w,k,j){return j=typeof j=="function"?j:n,m==null?m:Pf(m,w,k,j)}var Vo=U2(Fi),rs=U2(ji);function Hc(m,w,k){var j=oi(m),le=j||$c(m)||Y(m);if(w=Yn(w,4),k==null){var _e=m&&m.constructor;le?k=j?new _e:[]:fr(m)?k=Kl(_e)?Wl(Dc(m)):{}:k={}}return(le?es:_r)(m,function(ze,We,at){return w(k,ze,We,at)}),k}function Dm(m,w){return m==null?!0:vx(m,w)}function VE(m,w,k){return m==null?m:yx(m,w,b0(k))}function $E(m,w,k,j){return j=typeof j=="function"?j:n,m==null?m:yx(m,w,b0(k),j)}function Hu(m){return m==null?[]:df(m,Fi(m))}function r1(m){return m==null?[]:df(m,ji(m))}function Gc(m,w,k){return k===n&&(k=w,w=n),k!==n&&(k=dt(k),k=k===k?k:0),w!==n&&(w=dt(w),w=w===w?w:0),sn(dt(m),w,k)}function HE(m,w,k){return w=tt(w),k===n?(k=w,w=0):k=tt(k),m=dt(m),Ef(m,w,k)}function GE(m,w,k){if(k&&typeof k!="boolean"&&xo(m,w,k)&&(w=k=n),k===n&&(typeof w=="boolean"?(k=w,w=n):typeof m=="boolean"&&(k=m,m=n)),m===n&&w===n?(m=0,w=1):(m=tt(m),w===n?(w=m,m=0):w=tt(w)),m>w){var j=m;m=w,w=j}if(k||m%1||w%1){var le=Fo();return jr(m+le*(w-m+ba("1e-"+((le+"").length-1))),w)}return vm(m,w)}var ZR=_s(function(m,w,k){return w=w.toLowerCase(),m+(k?WE(w):w)});function WE(m){return rL(nn(m).toLowerCase())}function jE(m){return m=nn(m),m&&m.replace(jt,Jp).replace(Xv,"")}function YR(m,w,k){m=nn(m),w=_o(w);var j=m.length;k=k===n?j:sn(Le(k),0,j);var le=k;return k-=w.length,k>=0&&m.slice(k,le)==w}function KR(m){return m=nn(m),m&&te.test(m)?m.replace(Zt,Bl):m}function JR(m){return m=nn(m),m&&ut.test(m)?m.replace(Ie,"\\$&"):m}var QR=_s(function(m,w,k){return m+(k?"-":"")+w.toLowerCase()}),eL=_s(function(m,w,k){return m+(k?" ":"")+w.toLowerCase()}),ml=Lf("toLowerCase");function Z0(m,w,k){m=nn(m),w=Le(w);var j=w?ko(m):0;if(!w||j>=w)return m;var le=(w-j)/2;return Em(Eu(le),k)+m+Em(Do(le),k)}function qE(m,w,k){m=nn(m),w=Le(w);var j=w?ko(m):0;return w&&j<w?m+Em(w-j,k):m}function tL(m,w,k){m=nn(m),w=Le(w);var j=w?ko(m):0;return w&&j<w?Em(w-j,k)+m:m}function nL(m,w,k){return k||w==null?w=0:w&&(w=+w),Oo(nn(m).replace(bt,""),w||0)}function iL(m,w,k){return(k?xo(m,w,k):w===n)?w=1:w=Le(w),Ru(nn(m),w)}function Bs(){var m=arguments,w=nn(m[0]);return m.length<3?w:w.replace(m[1],m[2])}var la=_s(function(m,w,k){return m+(k?"_":"")+w.toLowerCase()});function Kh(m,w,k){return k&&typeof k!="number"&&xo(m,w,k)&&(w=k=n),k=k===n?je:k>>>0,k?(m=nn(m),m&&(typeof w=="string"||w!=null&&!T(w))&&(w=_o(w),!w&&Ul(m))?Pa(po(m),0,k):m.split(w,k)):[]}var gl=_s(function(m,w,k){return m+(k?" ":"")+rL(w)});function Jh(m,w,k){return m=nn(m),k=k==null?0:sn(Le(k),0,m.length),w=_o(w),m.slice(k,k+w.length)==w}function ec(m,w,k){var j=oe.templateSettings;k&&xo(m,w,k)&&(w=n),m=nn(m),w=xn({},w,j,V2);var le=xn({},w.imports,j.imports,V2),_e=Fi(le),ze=df(le,_e),We,at,Dt=0,Ot=w.interpolate||en,qt="__p += '",vn=gf((w.escape||en).source+"|"+Ot.source+"|"+(Ot===we?Di:en).source+"|"+(w.evaluate||en).source+"|$","g"),Nn="//# sourceURL="+(Ri.call(w,"sourceURL")?(w.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Kv+"]")+`
`;m.replace(vn,function(ni,Ai,zi,vl,ca,yl){return zi||(zi=vl),qt+=m.slice(Dt,yl).replace(En,Ic),Ai&&(We=!0,qt+=`' +
__e(`+Ai+`) +
'`),ca&&(at=!0,qt+=`';
`+ca+`;
__p += '`),zi&&(qt+=`' +
((__t = (`+zi+`)) == null ? '' : __t) +
'`),Dt=yl+ni.length,ni}),qt+=`';
`;var ti=Ri.call(w,"variable")&&w.variable;if(!ti)qt=`with (obj) {
`+qt+`
}
`;else if(ui.test(ti))throw new Qn(l);qt=(at?qt.replace(Ne,""):qt).replace(Gt,"$1").replace(Et,"$1;"),qt="function("+(ti||"obj")+`) {
`+(ti?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(We?", __e = _.escape":"")+(at?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+qt+`return __p
}`;var xi=B8(function(){return gi(_e,Nn+"return "+qt).apply(n,ze)});if(xi.source=qt,Xh(xi))throw xi;return xi}function Voe(m){return nn(m).toLowerCase()}function $oe(m){return nn(m).toUpperCase()}function Hoe(m,w,k){if(m=nn(m),m&&(k||w===n))return er(m);if(!m||!(w=_o(w)))return m;var j=po(m),le=po(w),_e=Rh(j,le),ze=Lh(j,le)+1;return Pa(j,_e,ze).join("")}function Goe(m,w,k){if(m=nn(m),m&&(k||w===n))return m.slice(0,Rc(m)+1);if(!m||!(w=_o(w)))return m;var j=po(m),le=Lh(j,po(w))+1;return Pa(j,0,le).join("")}function Woe(m,w,k){if(m=nn(m),m&&(k||w===n))return m.replace(bt,"");if(!m||!(w=_o(w)))return m;var j=po(m),le=Rh(j,po(w));return Pa(j,le).join("")}function joe(m,w){var k=X,j=se;if(fr(w)){var le="separator"in w?w.separator:le;k="length"in w?Le(w.length):k,j="omission"in w?_o(w.omission):j}m=nn(m);var _e=m.length;if(Ul(m)){var ze=po(m);_e=ze.length}if(k>=_e)return m;var We=k-ko(j);if(We<1)return j;var at=ze?Pa(ze,0,We).join(""):m.slice(0,We);if(le===n)return at+j;if(ze&&(We+=at.length-We),T(le)){if(m.slice(We).search(le)){var Dt,Ot=at;for(le.global||(le=gf(le.source,nn(qi.exec(le))+"g")),le.lastIndex=0;Dt=le.exec(Ot);)var qt=Dt.index;at=at.slice(0,qt===n?We:qt)}}else if(m.indexOf(_o(le),We)!=We){var vn=at.lastIndexOf(le);vn>-1&&(at=at.slice(0,vn))}return at+j}function qoe(m){return m=nn(m),m&&xe.test(m)?m.replace(Ct,Ei):m}var Xoe=_s(function(m,w,k){return m+(k?" ":"")+w.toUpperCase()}),rL=Lf("toUpperCase");function N8(m,w,k){return m=nn(m),w=k?n:w,w===n?pf(m)?a0(m):Zp(m):m.match(w)||[]}var B8=si(function(m,w){try{return Zs(m,n,w)}catch(k){return Xh(k)?k:new Qn(k)}}),Zoe=Ia(function(m,w){return es(w,function(k){k=Yl(k),Ft(m,k,V0(m[k],m))}),m});function Yoe(m){var w=m==null?0:m.length,k=Yn();return m=w?gr(m,function(j){if(typeof j[1]!="function")throw new ks(u);return[k(j[0]),j[1]]}):[],si(function(j){for(var le=-1;++le<w;){var _e=m[le];if(Zs(_e[0],this,j))return Zs(_e[1],this,j)}})}function Koe(m){return Kt(kt(m,S))}function sL(m){return function(){return m}}function Joe(m,w){return m==null||m!==m?w:m}var Qoe=z2(),eae=z2(!0);function Da(m){return m}function oL(m){return Uh(typeof m=="function"?m:kt(m,S))}function tae(m){return Af(kt(m,S))}function nae(m,w){return $h(m,kt(w,S))}var iae=si(function(m,w){return function(k){return Os(k,m,w)}}),rae=si(function(m,w){return function(k){return Os(m,k,w)}});function aL(m,w,k){var j=Fi(w),le=qr(w,j);k==null&&!(fr(w)&&(le.length||!j.length))&&(k=w,w=m,m=this,le=qr(w,Fi(w)));var _e=!(fr(k)&&"chain"in k)||!!k.chain,ze=Kl(m);return es(le,function(We){var at=w[We];m[We]=at,ze&&(m.prototype[We]=function(){var Dt=this.__chain__;if(_e||Dt){var Ot=m(this.__wrapped__),qt=Ot.__actions__=Fs(this.__actions__);return qt.push({func:at,args:arguments,thisArg:m}),Ot.__chain__=Dt,Ot}return at.apply(m,ta([this.value()],arguments))})}),m}function sae(){return Ar._===this&&(Ar._=tm),this}function lL(){}function oae(m){return m=Le(m),si(function(w){return m0(w,m)})}var aae=T0(gr),lae=T0(n0),cae=T0(lf);function U8(m){return Cx(m)?hf(Yl(m)):P2(m)}function uae(m){return function(w){return m==null?n:wr(m,w)}}var hae=Df(),dae=Df(!0);function cL(){return[]}function uL(){return!1}function fae(){return{}}function pae(){return""}function mae(){return!0}function gae(m,w){if(m=Le(m),m<1||m>ge)return[];var k=je,j=jr(m,je);w=Yn(w),m-=je;for(var le=Ih(j,w);++k<m;)w(k);return le}function vae(m){return oi(m)?gr(m,Yl):G(m)?[m]:Fs(K2(nn(m)))}function yae(m){var w=++em;return nn(m)+w}var _ae=C0(function(m,w){return m+w},0),xae=Sx("ceil"),bae=C0(function(m,w){return m/w},1),wae=Sx("floor");function Sae(m){return m&&m.length?ei(m,Da,Au):n}function Eae(m,w){return m&&m.length?ei(m,Yn(w,2),Au):n}function Mae(m){return uf(m,Da)}function Cae(m,w){return uf(m,Yn(w,2))}function Tae(m){return m&&m.length?ei(m,Da,Vh):n}function Aae(m,w){return m&&m.length?ei(m,Yn(w,2),Vh):n}var Pae=C0(function(m,w){return m*w},1),Iae=Sx("round"),Rae=C0(function(m,w){return m-w},0);function Lae(m){return m&&m.length?ci(m,Da):0}function kae(m,w){return m&&m.length?ci(m,Yn(w,2)):0}return oe.after=AE,oe.ary=Bo,oe.assign=ln,oe.assignIn=rn,oe.assignInWith=xn,oe.assignWith=mn,oe.at=hn,oe.before=jf,oe.bind=V0,oe.bindAll=Zoe,oe.bindKey=Yx,oe.castArray=G0,oe.chain=Vx,oe.chunk=J2,oe.compact=Q2,oe.concat=fR,oe.cond=Yoe,oe.conforms=Koe,oe.constant=sL,oe.countBy=Gx,oe.create=St,oe.curry=Kx,oe.curryRight=Jx,oe.debounce=Qx,oe.defaults=Pn,oe.defaultsDeep=wn,oe.defer=PE,oe.delay=$R,oe.difference=k0,oe.differenceBy=pR,oe.differenceWith=eE,oe.drop=mR,oe.dropRight=gR,oe.dropRightWhile=vR,oe.dropWhile=tE,oe.fill=yR,oe.filter=Gf,oe.flatMap=jx,oe.flatMapDeep=_E,oe.flatMapDepth=N0,oe.flatten=Ur,oe.flattenDeep=iE,oe.flattenDepth=rE,oe.flip=IE,oe.flow=Qoe,oe.flowRight=eae,oe.fromPairs=sE,oe.functions=Er,oe.functionsIn=to,oe.groupBy=NR,oe.initial=oE,oe.intersection=aE,oe.intersectionBy=Uc,oe.intersectionWith=Uf,oe.invert=is,oe.invertBy=Ns,oe.invokeMap=BR,oe.iteratee=oL,oe.keyBy=UR,oe.keys=Fi,oe.keysIn=ji,oe.map=B0,oe.mapKeys=aa,oe.mapValues=wo,oe.matches=tae,oe.matchesProperty=nae,oe.memoize=pl,oe.merge=Mi,oe.mergeWith=Yi,oe.method=iae,oe.methodOf=rae,oe.mixin=aL,oe.negate=Lm,oe.nthArg=oae,oe.omit=sr,oe.omitBy=Uo,oe.once=RE,oe.orderBy=VR,oe.over=aae,oe.overArgs=LE,oe.overEvery=lae,oe.overSome=cae,oe.partial=$0,oe.partialRight=kE,oe.partition=Xx,oe.pick=xr,oe.pickBy=Yh,oe.property=U8,oe.propertyOf=uae,oe.pull=bR,oe.pullAll=cE,oe.pullAllBy=wR,oe.pullAllWith=SR,oe.pullAt=ER,oe.range=hae,oe.rangeRight=dae,oe.rearg=HR,oe.reject=SE,oe.remove=MR,oe.rest=DE,oe.reverse=Vf,oe.sampleSize=ME,oe.set=Ql,oe.setWith=ka,oe.shuffle=CE,oe.slice=$f,oe.sortBy=TE,oe.sortedUniq=PR,oe.sortedUniqBy=hE,oe.split=Kh,oe.spread=km,oe.tail=bo,oe.take=zx,oe.takeRight=dE,oe.takeRightWhile=Bu,oe.takeWhile=Pm,oe.tap=Rm,oe.throttle=OE,oe.thru=oa,oe.toArray=Oe,oe.toPairs=Vo,oe.toPairsIn=rs,oe.toPath=vae,oe.toPlainObject=Ut,oe.transform=Hc,oe.unary=H0,oe.union=Im,oe.unionBy=Hf,oe.unionWith=D0,oe.uniq=O0,oe.uniqBy=IR,oe.uniqWith=RR,oe.unset=Dm,oe.unzip=F0,oe.unzipWith=Nx,oe.update=VE,oe.updateWith=$E,oe.values=Hu,oe.valuesIn=r1,oe.without=LR,oe.words=N8,oe.wrap=FE,oe.xor=fE,oe.xorBy=pE,oe.xorWith=Bx,oe.zip=Ux,oe.zipObject=kR,oe.zipObjectDeep=DR,oe.zipWith=mE,oe.entries=Vo,oe.entriesIn=rs,oe.extend=rn,oe.extendWith=xn,aL(oe,oe),oe.add=_ae,oe.attempt=B8,oe.camelCase=ZR,oe.capitalize=WE,oe.ceil=xae,oe.clamp=Gc,oe.clone=W0,oe.cloneDeep=GR,oe.cloneDeepWith=WR,oe.cloneWith=j0,oe.conformsTo=jR,oe.deburr=jE,oe.defaultTo=Joe,oe.divide=bae,oe.endsWith=YR,oe.eq=Qs,oe.escape=KR,oe.escapeRegExp=JR,oe.every=Wx,oe.find=vE,oe.findIndex=nE,oe.findKey=Hn,oe.findLast=yE,oe.findLastIndex=Bf,oe.findLastKey=Zi,oe.floor=wae,oe.forEach=qx,oe.forEachRight=xE,oe.forIn=Wi,oe.forInRight=ns,oe.forOwn=La,oe.forOwnRight=bs,oe.get=ws,oe.gt=xs,oe.gte=$u,oe.has=no,oe.hasIn=yr,oe.head=Bi,oe.identity=Da,oe.includes=bE,oe.indexOf=Dx,oe.inRange=HE,oe.invoke=Ss,oe.isArguments=Vc,oe.isArray=oi,oe.isArrayBuffer=zE,oe.isArrayLike=eo,oe.isArrayLikeObject=Zr,oe.isBoolean=NE,oe.isBuffer=$c,oe.isDate=qR,oe.isElement=BE,oe.isEmpty=e1,oe.isEqual=t1,oe.isEqualWith=UE,oe.isError=Xh,oe.isFinite=n1,oe.isFunction=Kl,oe.isInteger=q0,oe.isLength=Zh,oe.isMap=X0,oe.isMatch=i1,oe.isMatchWith=XR,oe.isNaN=c,oe.isNative=s,oe.isNil=p,oe.isNull=h,oe.isNumber=x,oe.isObject=fr,oe.isObjectLike=Sr,oe.isPlainObject=C,oe.isRegExp=T,oe.isSafeInteger=R,oe.isSet=F,oe.isString=U,oe.isSymbol=G,oe.isTypedArray=Y,oe.isUndefined=ee,oe.isWeakMap=ae,oe.isWeakSet=ue,oe.join=lE,oe.kebabCase=QR,oe.last=Ra,oe.lastIndexOf=_R,oe.lowerCase=eL,oe.lowerFirst=ml,oe.lt=pe,oe.lte=Ae,oe.max=Sae,oe.maxBy=Eae,oe.mean=Mae,oe.meanBy=Cae,oe.min=Tae,oe.minBy=Aae,oe.stubArray=cL,oe.stubFalse=uL,oe.stubObject=fae,oe.stubString=pae,oe.stubTrue=mae,oe.multiply=Pae,oe.nth=xR,oe.noConflict=sae,oe.noop=lL,oe.now=Wf,oe.pad=Z0,oe.padEnd=qE,oe.padStart=tL,oe.parseInt=nL,oe.random=GE,oe.reduce=Vu,oe.reduceRight=wE,oe.repeat=iL,oe.replace=Bs,oe.result=Jl,oe.round=Iae,oe.runInContext=et,oe.sample=EE,oe.size=Zx,oe.snakeCase=la,oe.some=U0,oe.sortedIndex=uE,oe.sortedIndexBy=Ox,oe.sortedIndexOf=Fx,oe.sortedLastIndex=CR,oe.sortedLastIndexBy=TR,oe.sortedLastIndexOf=AR,oe.startCase=gl,oe.startsWith=Jh,oe.subtract=Rae,oe.sum=Lae,oe.sumBy=kae,oe.template=ec,oe.times=gae,oe.toFinite=tt,oe.toInteger=Le,oe.toLength=Qe,oe.toLower=Voe,oe.toNumber=dt,oe.toSafeInteger=cn,oe.toString=nn,oe.toUpper=$oe,oe.trim=Hoe,oe.trimEnd=Goe,oe.trimStart=Woe,oe.truncate=joe,oe.unescape=qoe,oe.uniqueId=yae,oe.upperCase=Xoe,oe.upperFirst=rL,oe.each=qx,oe.eachRight=xE,oe.first=Bi,aL(oe,function(){var m={};return _r(oe,function(w,k){Ri.call(oe.prototype,k)||(m[k]=w)}),m}(),{chain:!1}),oe.VERSION=i,es(["bind","bindKey","curry","curryRight","partial","partialRight"],function(m){oe[m].placeholder=oe}),es(["drop","take"],function(m,w){fi.prototype[m]=function(k){k=k===n?1:Ir(Le(k),0);var j=this.__filtered__&&!w?new fi(this):this.clone();return j.__filtered__?j.__takeCount__=jr(k,j.__takeCount__):j.__views__.push({size:jr(k,je),type:m+(j.__dir__<0?"Right":"")}),j},fi.prototype[m+"Right"]=function(k){return this.reverse()[m](k).reverse()}}),es(["filter","map","takeWhile"],function(m,w){var k=w+1,j=k==Me||k==ye;fi.prototype[m]=function(le){var _e=this.clone();return _e.__iteratees__.push({iteratee:Yn(le,3),type:k}),_e.__filtered__=_e.__filtered__||j,_e}}),es(["head","last"],function(m,w){var k="take"+(w?"Right":"");fi.prototype[m]=function(){return this[k](1).value()[0]}}),es(["initial","tail"],function(m,w){var k="drop"+(w?"":"Right");fi.prototype[m]=function(){return this.__filtered__?new fi(this):this[k](1)}}),fi.prototype.compact=function(){return this.filter(Da)},fi.prototype.find=function(m){return this.filter(m).head()},fi.prototype.findLast=function(m){return this.reverse().find(m)},fi.prototype.invokeMap=si(function(m,w){return typeof m=="function"?new fi(this):this.map(function(k){return Os(k,m,w)})}),fi.prototype.reject=function(m){return this.filter(Lm(Yn(m)))},fi.prototype.slice=function(m,w){m=Le(m);var k=this;return k.__filtered__&&(m>0||w<0)?new fi(k):(m<0?k=k.takeRight(-m):m&&(k=k.drop(m)),w!==n&&(w=Le(w),k=w<0?k.dropRight(-w):k.take(w-m)),k)},fi.prototype.takeRightWhile=function(m){return this.reverse().takeWhile(m).reverse()},fi.prototype.toArray=function(){return this.take(je)},_r(fi.prototype,function(m,w){var k=/^(?:filter|find|map|reject)|While$/.test(w),j=/^(?:head|last)$/.test(w),le=oe[j?"take"+(w=="last"?"Right":""):w],_e=j||/^find/.test(w);le&&(oe.prototype[w]=function(){var ze=this.__wrapped__,We=j?[1]:arguments,at=ze instanceof fi,Dt=We[0],Ot=at||oi(ze),qt=function(Ai){var zi=le.apply(oe,ta([Ai],We));return j&&vn?zi[0]:zi};Ot&&k&&typeof Dt=="function"&&Dt.length!=1&&(at=Ot=!1);var vn=this.__chain__,Nn=!!this.__actions__.length,ti=_e&&!vn,xi=at&&!Nn;if(!_e&&Ot){ze=xi?ze:new fi(this);var ni=m.apply(ze,We);return ni.__actions__.push({func:oa,args:[qt],thisArg:n}),new vo(ni,vn)}return ti&&xi?m.apply(this,We):(ni=this.thru(qt),ti?j?ni.value()[0]:ni.value():ni)})}),es(["pop","push","shift","sort","splice","unshift"],function(m){var w=ll[m],k=/^(?:push|sort|unshift)$/.test(m)?"tap":"thru",j=/^(?:pop|shift)$/.test(m);oe.prototype[m]=function(){var le=arguments;if(j&&!this.__chain__){var _e=this.value();return w.apply(oi(_e)?_e:[],le)}return this[k](function(ze){return w.apply(oi(ze)?ze:[],le)})}}),_r(fi.prototype,function(m,w){var k=oe[w];if(k){var j=k.name+"";Ri.call(ra,j)||(ra[j]=[]),ra[j].push({name:w,func:k})}}),ra[M0(n,P).name]=[{name:"wrapper",func:n}],fi.prototype.clone=h0,fi.prototype.reverse=jl,fi.prototype.value=d0,oe.prototype.at=Uu,oe.prototype.chain=gE,oe.prototype.commit=$x,oe.prototype.next=OR,oe.prototype.plant=z0,oe.prototype.reverse=Hx,oe.prototype.toJSON=oe.prototype.valueOf=oe.prototype.value=zR,oe.prototype.first=oe.prototype.head,cl&&(oe.prototype[cl]=FR),oe},al=Lc();wa?((wa.exports=al)._=al,Hp._=al):Ar._=al}).call(Dn)}(t2,t2.exports);var ire=t2.exports;const{Map:rre,Marker:sre,ScaleControl:ore,NavigationControl:are}=PD;class lre extends tre{constructor(n,i){var u,l,f;super(n,{className:`psv-plan ${pd.CAPTURE_EVENTS_CLASS}`});yn(this,"state",{visible:!1,maximized:!1,collapsed:!1,viewerCollapsed:!1,layers:{},pinMarker:null,hotspots:{},forceRender:!1,needsUpdate:!1,renderLoop:null});yn(this,"map");yn(this,"resetButton");yn(this,"closeButton");yn(this,"maximizeButton");yn(this,"layersButton");yn(this,"viewerCloseButton");yn(this,"viewerMaximizeButton");this.plugin=i;const r=document.createElement("div");r.className="psv-plan__container",this.map=new rre({container:r,attributionControl:!1}),this.map.addControl(new are({showCompass:!0}),"bottom-right"),this.map.addControl(new wie({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0}),"bottom-right"),this.map.addControl(new ore({maxWidth:120,unit:"metric"})),this.container.appendChild(r),this.container.addEventListener("transitionstart",this),this.container.addEventListener("transitionend",this),this.map.on("load",()=>{this.map.resize()}),this.map.on("render",ire.debounce(()=>{this.updateBearing()},100)),this.map.on("moveend",()=>{var g;(g=this.config)!=null&&g.onChangeCenter&&this.config.onChangeCenter(this.map.getCenter())}),this.layersButton=new Tie(this),this.config.buttons.reset&&(this.resetButton=new ere(this)),this.config.buttons.maximize&&(this.maximizeButton=new Iie(this)),this.config.buttons.close&&(this.closeButton=new Mie(this)),this.viewerCloseButton=document.createElement("div"),this.viewerCloseButton.className=`psv-plan-viewer-btn psv-plan-viewer-btn__close ${pd.CAPTURE_EVENTS_CLASS}`,this.viewerCloseButton.innerHTML=mI,this.viewerMaximizeButton=document.createElement("div"),this.viewerMaximizeButton.className=`psv-plan-viewer-btn psv-plan-viewer-btn__maximize ${pd.CAPTURE_EVENTS_CLASS}`,this.viewerMaximizeButton.innerHTML=MU,this.viewerMaximizeButton.addEventListener("click",()=>{this.toggleMaximized()}),this.viewerCloseButton.addEventListener("click",()=>{this.toogleViewerClose()}),this.viewer.container.appendChild(this.viewerCloseButton),this.viewer.container.appendChild(this.viewerMaximizeButton);const a=()=>{this.isVisible()&&(this.state.needsUpdate||this.state.forceRender)&&(this.state.needsUpdate=!1),this.state.renderLoop=requestAnimationFrame(a)};if(a(),this.applyConfig(),this.hide(),this.config.visibleOnLoad||this.toggleCollapse(),this.config.configureLeaflet)this.config.configureLeaflet(this.map);else{this.state.layers=this.config.layers.reduce((y,S,b)=>(S.name||(S.name=`Layer ${b+1}`),S.urlTemplate?y[S.name]=S.urlTemplate:S.layer?(S.attribution&&(S.layer.options.attribution=S.attribution),y[S.name]=S.layer):zn.logWarn(`Layer #${b} is missing "urlTemplate" or "layer" property.`),y),{}),Object.values(this.state.layers).length||(zn.logWarn("No layer configured, fallback to OSM."),this.state.layers[EO]=`${xq}?apiKey=${((u=this.config)==null?void 0:u.apiKey)||((f=(l=this.viewer)==null?void 0:l._config)==null?void 0:f.apiKey)}`);const g=Object.keys(this.state.layers);this.setLayer(g[0]),g.length>1&&this.layersButton.setLayers(g)}this.config.coordinates&&this.recenter()}get config(){return this.plugin.config}get maximized(){return this.state.maximized}get collapsed(){return this.state.collapsed}destroy(){cancelAnimationFrame(this.state.renderLoop),super.destroy()}handleEvent(n){if(!zn.getClosest(n.target,`.${pd.CAPTURE_EVENTS_CLASS}:not(.psv-plan)`))switch(n.type){case"transitionstart":this.state.forceRender=!0;break;case"transitionend":this.state.forceRender=!1;break}}applyConfig(){var n,i,r;this.container.classList.remove("psv-plan--top-right","psv-plan--top-left","psv-plan--bottom-right","psv-plan--bottom-left"),this.container.classList.add(`psv-plan--${this.config.position.join("-")}`),this.container.style.width=this.config.size.width,this.container.style.height=this.config.size.height,this.layersButton.applyConfig(),(n=this.resetButton)==null||n.applyConfig(),(i=this.closeButton)==null||i.applyConfig(),(r=this.maximizeButton)==null||r.applyConfig(),this.state.needsUpdate=!0}updatePin(){this.state.pinMarker&&(this.state.pinMarker.remove(),this.state.pinMarker=null),this.recenter()}isVisible(){return this.state.visible&&!this.state.collapsed}show(){super.show(),this.state.needsUpdate=!0}hide(){super.hide(),this.state.forceRender=!1}changeTheme(n){this.state.layers=this.config.layers.reduce((r,a,u)=>(a.name||(a.name=`Layer ${u+1}`),n?r[a.name]=n:a.layer?(a.attribution&&(a.layer.options.attribution=a.attribution),r[a.name]=a.layer):zn.logWarn(`Layer #${u} is missing "urlTemplate" or "layer" property.`),r),{});const i=Object.keys(this.state.layers);this.setLayer(i[0])}updateBearing(n=this.viewer.getPosition()){var i;if(this.state.pinMarker){const r=this.state.pinMarker.getElement().firstElementChild;r.style.rotate=`${eu.radToDeg(n.yaw+this.config.bearing)-((i=this.map)==null?void 0:i.getBearing())}deg`}}setLayer(n){this.map.setStyle(this.state.layers[n])}reset(){this.map.flyTo({center:this.config.coordinates,zoom:this.state.pinMarker?14:this.config.defaultZoom})}recenter(n){if(this.state.pinMarker)this.state.pinMarker.setLngLat(this.config.coordinates);else{const i=document.createElement("div");i.style.width=`${this.config.pinSize}px`,i.style.height=`${this.config.pinSize}px`,i.innerHTML=this.config.pinImage,this.state.pinMarker=new sre({element:i}),this.state.pinMarker.setLngLat(this.config.coordinates),this.state.pinMarker.addTo(this.map),this.updateBearing()}this.map.getZoom()<this.config.defaultZoom?this.reset():this.map.flyTo({center:this.config.coordinates,zoom:n||14})}fitBBox(n){var i;(i=this.map)==null||i.fitBounds(n,{padding:{top:20,bottom:20}})}toogleViewerClose(){this.state.viewerCollapsed=!this.state.viewerCollapsed,zn.toggleClass(this.viewer.container,"psv-plan-viewer--collapsed",this.state.viewerCollapsed),this.viewerCloseButton.innerHTML=this.state.viewerCollapsed?nre:mI}toggleCollapse(){var n;this.state.maximized&&this.toggleMaximized(),this.state.collapsed=!this.state.collapsed,zn.toggleClass(this.container,"psv-plan--collapsed",this.state.collapsed),setTimeout(()=>{!this.state.collapsed&&this.map&&this.reset()},500),(n=this.closeButton)==null||n.update()}toggleMaximized(){var n,i,r,a,u,l,f;if(this.state.collapsed){(n=this.config)!=null&&n.onMinimize&&((i=this.config)==null||i.onMinimize());return}this.state.maximized=!this.state.maximized,zn.toggleClass(this.container,"psv-plan--maximized",this.state.maximized),zn.toggleClass(this.viewer.container,"plan-maximized",this.state.maximized),this.state.maximized?(this.viewer.container.style.width=this.config.size.width,this.viewer.container.style.height=this.config.size.height):(this.viewer.container.style.width=null,this.viewer.container.style.height=null),this.state.maximized?((r=this.config)!=null&&r.onMaximized&&((a=this.config)==null||a.onMaximized()),this.map.getContainer().focus()):(u=this.config)!=null&&u.onMinimize&&((l=this.config)==null||l.onMinimize()),setTimeout(()=>{this.reset()},1e3),(f=this.maximizeButton)==null||f.update()}zoom(n){this.map.setZoom(n)}}const cre=zn.getConfigParser({coordinates:null,bearing:0,size:{width:"300px",height:"200px"},position:["bottom","left"],visibleOnLoad:!0,pinImage:`<svg viewBox="0 0 700 700" xmlns="http://www.w3.org/2000/svg">
    <circle cx="350" cy="350" r="160" fill="white"/>
    <circle cx="350" cy="350" r="120" fill="rgb(255,127,62)"/>
    <path fill="rgba(255,127,62,0.8)" d="M222,222 L103,103 A353,353,0,0,1,597,103 L478,222 A180,180,0,0,0,222,222"/>
</svg>
`,pinSize:35,enabledLocate:!0,onMaximized:()=>{},onMinimize:()=>{},onChangeCenter:()=>{},spotStyle:{size:15,image:null,color:"white",hoverSize:null,hoverImage:null,hoverColor:null,hoverBorderSize:4,hoverBorderColor:"rgba(255, 255, 255, 0.8)"},defaultZoom:15,apiKey:null,layers:[{urlTemplate:null,attribution:bq,name:EO}],configureLeaflet:null,buttons:{maximize:!0,close:!0,reset:!0}},{spotStyle:(t,{defValue:e})=>({...e,...t}),position:(t,{defValue:e})=>zn.cleanCssPosition(t,{allowCenter:!1,cssOrder:!0})||e,bearing:t=>zn.parseAngle(t),buttons:(t,{defValue:e})=>({...e,...t})});class tf extends sp{constructor(n,i){super(n,i);yn(this,"component");this.component=new lre(this.viewer,this)}getMap(){return this.component.map}init(){super.init(),zn.checkStylesheet(this.viewer.container,"plan-plugin"),this.viewer.addEventListener(Pi.PositionUpdatedEvent.type,this),this.viewer.addEventListener(Pi.ReadyEvent.type,this,{once:!0})}destroy(){this.viewer.removeEventListener(Pi.PositionUpdatedEvent.type,this),this.viewer.removeEventListener(Pi.ReadyEvent.type,this),this.component.destroy(),super.destroy()}handleEvent(n){switch(n.type){case Pi.ReadyEvent.type:this.component.show();break;case Pi.PositionUpdatedEvent.type:this.component.updateBearing(n.position);break}}setOptions(n){super.setOptions(n),n.coordinates&&this.component.recenter(),zn.isNil(n.bearing)||this.component.updateBearing(),(n.pinImage||n.pinSize)&&this.component.updatePin(),this.component.applyConfig()}hide(){this.component.hide()}show(){this.component.show()}close(){this.component.collapsed||this.component.toggleCollapse()}open(){this.component.collapsed&&this.component.toggleCollapse()}minimize(){this.component.maximized&&this.component.toggleMaximized()}maximize(){this.component.maximized||this.component.toggleMaximized()}setCoordinates(n,i){this.config.coordinates=n,setTimeout(()=>{this.component.recenter(i)},500)}fitBBox(n){this.component.fitBBox(n)}updateStyle(n){this.component.updateStyle(n)}changeTheme(n){this.component.changeTheme(n)}}yn(tf,"id","plan"),yn(tf,"configParser",cre),yn(tf,"readonlyOptions",["visibleOnLoad","defaultZoom","layers","configureLeaflet","buttons"]),Qc.lang.map="Map",Qc.lang.mapMaximize="Maximize",Qc.lang.mapMinimize="Minimize",Qc.lang.mapReset="Reset",Qc.lang.mapLayers="Base layer";const ure=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="50" fill="rgba(0, 0, 0, 0.9)"/><path fill="rgba(255, 255, 255, 0.8)" d="M50 97.1A47 47 0 0 1 32.5 6.5l.8 1.8a45 45 0 1 0 33.4 0l.8-1.8A47 47 0 0 1 50 97Zm0-42a5 5 0 1 1 5-5 5 5 0 0 1-5 5Zm4-41.7h-1.6a.4.4 0 0 1-.4-.2l-4.6-7.7V13a.3.3 0 0 1-.3.3h-1.6a.3.3 0 0 1-.3-.3V1.8a.3.3 0 0 1 .3-.3h1.6a.3.3 0 0 1 .4.2L52 9.4V1.8a.3.3 0 0 1 .3-.3H54c.2 0 .3 0 .3.3V13c0 .2-.1.3-.3.3Z"/></svg>
`,UU=1/40;class hre extends da{constructor(n,i){super(n,{});yn(this,"state",{visible:!0,mouse:null,mousedown:!1,markers:[]});yn(this,"canvas");yn(this,"background");this.plugin=i,this.background=document.createElement("div"),this.canvas=document.createElement("canvas"),this.container.appendChild(this.background),this.container.appendChild(this.canvas),this.config.navigation&&(this.container.addEventListener("mouseenter",this),this.container.addEventListener("mouseleave",this),this.container.addEventListener("mousemove",this),this.container.addEventListener("mousedown",this),this.container.addEventListener("mouseup",this),this.container.addEventListener("touchstart",this),this.container.addEventListener("touchmove",this),this.container.addEventListener("touchend",this)),this.applyConfig(),this.hide()}get config(){return this.plugin.config}handleEvent(n){var i,r;switch(n.type){case"mouseenter":case"mousemove":case"touchmove":this.state.mouse=((i=n.changedTouches)==null?void 0:i[0])||n,this.state.mousedown?this.click():this.update(),n.stopPropagation(),n.preventDefault();break;case"mousedown":case"touchstart":this.state.mousedown=!0,n.stopPropagation(),n.preventDefault();break;case"mouseup":case"touchend":this.state.mouse=((r=n.changedTouches)==null?void 0:r[0])||n,this.state.mousedown=!1,this.click(),n.changedTouches&&(this.state.mouse=null,this.update()),n.stopPropagation(),n.preventDefault();break;case"mouseleave":this.state.mouse=null,this.state.mousedown=!1,this.update();break}}destroy(){this.canvas.width=0,this.canvas.height=0,super.destroy()}applyConfig(){this.container.className=`psv-compass psv-compass--${this.config.position.join("-")}`,this.config.className&&this.container.classList.add(this.config.className),this.background.innerHTML=this.config.backgroundSvg,this.container.style.width=this.config.size,this.container.style.height=this.config.size,this.container.style.marginTop=this.config.position[0]==="center"?`calc(-${this.config.size} / 2)`:"",this.container.style.marginLeft=this.config.position[1]==="center"?`calc(-${this.config.size} / 2)`:""}show(){super.show(),this.update()}setMarkers(n){this.state.markers=n,this.update()}update(){var u;if(!this.isVisible())return;this.canvas.width=this.container.clientWidth*Ts.pixelRatio,this.canvas.height=this.container.clientWidth*Ts.pixelRatio;const n=this.canvas.getContext("2d");n.clearRect(0,0,this.canvas.width,this.canvas.height);const i=this.viewer.getPosition().yaw,r=eu.degToRad(this.viewer.state.hFov);this.__drawCone(n,this.config.coneColor,i,r);const a=this.__getMouseAngle();a!==null&&this.__drawCone(n,this.config.navigationColor,a,r),this.state.markers.forEach(l=>{this.__drawMarker(n,l)}),(u=this.config.hotspots)==null||u.forEach(l=>{"yaw"in l&&!("pitch"in l)&&(l.pitch=0);const f=this.viewer.dataHelper.cleanPosition(l);this.__drawPoint(n,l.color||this.config.hotspotColor,f.yaw,f.pitch)})}click(){const n=this.__getMouseAngle();n!==null&&this.viewer.rotate({yaw:n,pitch:0})}__drawCone(n,i,r,a){const u=r-Math.PI/2-a/2,l=u+a,f=this.canvas.width/2;n.beginPath(),n.moveTo(f,f),n.lineTo(f+Math.cos(u)*f,f+Math.sin(u)*f),n.arc(f,f,f,u,l,!1),n.lineTo(f,f),n.fillStyle=i,n.fill()}__drawMarker(n,i){let r=this.config.hotspotColor;if(typeof i.data.compass=="string"&&(r=i.data.compass),i.isPoly())n.beginPath(),i.definition.forEach(([a,u],l)=>{const f=a-Math.PI/2,g=(u+Math.PI/2)/Math.PI,y=this.canvas.width/2;n[l===0?"moveTo":"lineTo"](y+Math.cos(f)*y*g,y+Math.sin(f)*y*g)}),i.type.startsWith("polygon")?(n.fillStyle=r,n.fill()):(n.strokeStyle=r,n.lineWidth=Math.max(1,this.canvas.width*UU/2),n.stroke());else{const a=i.state.position;this.__drawPoint(n,r,a.yaw,a.pitch)}}__drawPoint(n,i,r,a){const u=r-Math.PI/2,l=(a+Math.PI/2)/Math.PI,f=this.canvas.width/2,g=Math.max(2,this.canvas.width*UU);n.beginPath(),n.ellipse(f+Math.cos(u)*f*l,f+Math.sin(u)*f*l,g,g,0,0,Math.PI*2),n.fillStyle=i,n.fill()}__getMouseAngle(){if(!this.state.mouse)return null;const n=this.container.getBoundingClientRect(),i=this.state.mouse.clientX-n.left-n.width/2,r=this.state.mouse.clientY-n.top-n.width/2;return Math.sqrt(i*i+r*r)>n.width/2?null:Math.atan2(r,i)+Math.PI/2}}const dre=zn.getConfigParser({size:"120px",position:["top","left"],backgroundSvg:ure,coneColor:"rgba(255, 255, 255, 0.5)",navigation:!0,navigationColor:"rgba(255, 0, 0, 0.2)",hotspots:[],hotspotColor:"rgba(0, 0, 0, 0.5)",className:null},{position:(t,{defValue:e})=>zn.cleanCssPosition(t,{allowCenter:!0,cssOrder:!0})||e});class n2 extends sp{constructor(n,i){super(n,i);yn(this,"markers");yn(this,"component");this.component=new hre(this.viewer,this)}init(){super.init(),zn.checkStylesheet(this.viewer.container,"compass-plugin"),this.markers=this.viewer.getPlugin("markers"),this.viewer.addEventListener(Pi.RenderEvent.type,this),this.viewer.addEventListener(Pi.ReadyEvent.type,this,{once:!0}),this.markers&&this.markers.addEventListener("set-markers",this)}destroy(){this.viewer.removeEventListener(Pi.RenderEvent.type,this),this.viewer.removeEventListener(Pi.ReadyEvent.type,this),this.markers&&this.markers.removeEventListener("set-markers",this),this.component.destroy(),delete this.markers,super.destroy()}setOptions(n){super.setOptions(n),this.component.applyConfig(),this.component.update()}handleEvent(n){switch(n.type){case Pi.ReadyEvent.type:this.component.show();break;case Pi.RenderEvent.type:this.component.update();break;case"set-markers":this.component.setMarkers(n.markers.filter(i=>{var r;return(r=i.data)==null?void 0:r.compass}));break}}hide(){this.component.hide()}show(){this.component.show()}setHotspots(n){this.config.hotspots=n,this.component.update()}clearHotspots(){this.setHotspots(null)}}yn(n2,"id","compass"),yn(n2,"configParser",dre),yn(n2,"readonlyOptions",["navigation"]);/*!
 * Photo Sphere Viewer / Equirectangular Tiles Adapter 5.10.0
 * @copyright 2015-2024 Damien "Mistic" Sorel
 * @licence MIT (https://opensource.org/licenses/MIT)
 */var fre=class{constructor(t,e,n){this.id=t,this.priority=e,this.fn=n,this.status=1}start(){return this.status=2,this.fn(this).then(()=>{this.status=4},()=>{this.status=5})}cancel(){this.status=3}isCancelled(){return this.status===3}},pre=class{constructor(t=4){this.concurency=t,this.runningTasks={},this.tasks={}}enqueue(t){this.tasks[t.id]=t}clear(){Object.values(this.tasks).forEach(t=>t.cancel()),this.tasks={},this.runningTasks={}}setPriority(t,e){const n=this.tasks[t];n&&(n.priority=e,n.status===0&&(n.status=1))}disableAllTasks(){Object.values(this.tasks).forEach(t=>{t.status=0})}start(){if(Object.keys(this.runningTasks).length>=this.concurency)return;const t=Object.values(this.tasks).filter(e=>e.status===1).sort((e,n)=>n.priority-e.priority).pop();t&&(this.runningTasks[t.id]=!0,t.start().then(()=>{t.isCancelled()||(delete this.tasks[t.id],delete this.runningTasks[t.id],this.start())}),this.start())}};function mre(t){let e=0;t.forEach((n,i)=>{if(!n.zoomRange||n.zoomRange.length!==2)throw new qn(`Tiles level ${i} is missing "zoomRange" property`);if(n.zoomRange[0]>=n.zoomRange[1]||n.zoomRange[0]!==e||i===0&&n.zoomRange[0]!==0||i===t.length-1&&n.zoomRange[1]!==100)throw new qn(`Tiles levels' "zoomRange" are not orderer or are not covering the whole 0-100 range`);e=n.zoomRange[1]})}function gre(t,e){return t.findIndex(n=>e>=n.zoomRange[0]&&e<=n.zoomRange[1])}function vre(){const t=document.createElement("canvas");t.width=512,t.height=512;const e=t.getContext("2d");return e.fillStyle="#333",e.fillRect(0,0,t.width,t.height),e.font=`${t.width/5}px serif`,e.fillStyle="#a22",e.textAlign="center",e.textBaseline="middle",e.fillText("",t.width/2,t.height/2),new Dy({map:zn.createTexture(t)})}function yre(t){const e=new yq(t),n=new vq(e);return n.material.depthTest=!1,n.material.opacity=.25,n.material.transparent=!0,n}var VU=["dodgerblue","limegreen","indianred"];function _re(t,e,n){const i=document.createElement("canvas");i.width=t.width,i.height=t.height;const r=i.getContext("2d");r.fillStyle=VU[e%VU.length],r.fillRect(0,0,i.width,i.height),r.globalCompositeOperation="multiply",r.drawImage(t,0,0);const a=t.width/7;return r.globalCompositeOperation="source-over",r.fillStyle="white",r.font=`${a}px monospace`,r.textAlign="center",n.split(`
`).forEach((u,l)=>{r.fillText(u,t.width/2,t.height/2+a*(.3+l))}),i}function _I(t){return!!t.levels}function $U(t,e,n){return{...t,level:e,colSize:t.width/t.cols,rowSize:t.width/2/t.rows,facesByCol:n.SPHERE_SEGMENTS/t.cols,facesByRow:n.SPHERE_HORIZONTAL_SEGMENTS/t.rows}}function HU(t,e,n){let i,r;return _I(t)?(r=gre(t.levels,e),i=t.levels[r]):(r=0,i={...t,zoomRange:[0,100]}),$U(i,r,n)}function xre(t,e,n){return!_I(t)||!t.levels[e]?null:$U(t.levels[e],e,n)}function bre(t,e){if(typeof t!="object"||!t.tileUrl)throw new qn("Invalid panorama configuration, are you using the right adapter?");_I(t)?(t.levels.forEach(n=>GU(n,e)),mre(t.levels)):GU(t,e)}function GU(t,e){if(!t.width||!t.cols||!t.rows)throw new qn("Invalid panorama configuration, are you using the right adapter?");if(t.cols>e.SPHERE_SEGMENTS)throw new qn(`Panorama cols must not be greater than ${e.SPHERE_SEGMENTS}.`);if(t.rows>e.SPHERE_HORIZONTAL_SEGMENTS)throw new qn(`Panorama rows must not be greater than ${e.SPHERE_HORIZONTAL_SEGMENTS}.`);if(!eu.isPowerOfTwo(t.cols)||!eu.isPowerOfTwo(t.rows))throw new qn("Panorama cols and rows must be powers of 2.")}var Q_=6,xa=3,xI="uv",WU="originaluv",wre="position",jU=-1;function bI(t){return`${t.col}x${t.row}/${t.config.level}`}var Sre=zn.getConfigParser({backgroundColor:"#000",resolution:64,showErrorTile:!0,baseBlur:!0,antialias:!0,debug:!1,useXmpData:!1},{resolution:t=>{if(!t||!eu.isPowerOfTwo(t))throw new qn("EquirectangularTilesAdapter resolution must be power of two");return t}}),i2=new Lt,r2=class extends rb{constructor(t,e){super(t),this.state={tileConfig:null,tiles:{},faces:{},geom:null,materials:[],errorMaterial:null,inTransition:!1},this.queue=new pre,this.config=Sre(e),this.SPHERE_SEGMENTS=this.config.resolution,this.SPHERE_HORIZONTAL_SEGMENTS=this.SPHERE_SEGMENTS/2,this.NB_VERTICES=2*this.SPHERE_SEGMENTS*xa+(this.SPHERE_HORIZONTAL_SEGMENTS-2)*this.SPHERE_SEGMENTS*Q_,this.NB_GROUPS=this.SPHERE_SEGMENTS*this.SPHERE_HORIZONTAL_SEGMENTS,this.viewer.config.requestHeaders&&zn.logWarn('EquirectangularTilesAdapter fallbacks to file loader because "requestHeaders" where provided. Consider removing "requestHeaders" if you experience performances issues.')}init(){super.init(),this.viewer.addEventListener(Pi.PositionUpdatedEvent.type,this),this.viewer.addEventListener(Pi.ZoomUpdatedEvent.type,this)}destroy(){var t,e,n,i;this.viewer.addEventListener(Pi.PositionUpdatedEvent.type,this),this.viewer.addEventListener(Pi.ZoomUpdatedEvent.type,this),this.__cleanup(),(e=(t=this.state.errorMaterial)==null?void 0:t.map)==null||e.dispose(),(n=this.state.errorMaterial)==null||n.dispose(),(i=this.adapter)==null||i.destroy(),delete this.adapter,delete this.state.geom,delete this.state.errorMaterial,super.destroy()}handleEvent(t){(t instanceof Pi.PositionUpdatedEvent||t instanceof Pi.ZoomUpdatedEvent)&&this.__refresh()}supportsTransition(t){return!!t.baseUrl}supportsPreload(t){return!!t.baseUrl}textureCoordsToSphericalCoords(t,e){return this.getAdapter().textureCoordsToSphericalCoords(t,e)}sphericalCoordsToTextureCoords(t,e){return this.getAdapter().sphericalCoordsToTextureCoords(t,e)}loadTexture(t,e=!0){try{bre(t,this)}catch(r){return Promise.reject(r)}const n=HU(t,0,this),i={isEquirectangular:!0,fullWidth:n.width,fullHeight:n.width/2,croppedWidth:n.width,croppedHeight:n.width/2,croppedX:0,croppedY:0,poseHeading:0,posePitch:0,poseRoll:0};return t.baseUrl?this.getAdapter().loadTexture(t.baseUrl,e,t.basePanoData,!1).then(r=>({panorama:t,panoData:i,cacheKey:r.cacheKey,texture:r.texture})):Promise.resolve({panorama:t,panoData:i,cacheKey:t.tileUrl(0,0,0),texture:null})}createMesh(){const t=new hT(pd.SPHERE_RADIUS,this.SPHERE_SEGMENTS,this.SPHERE_HORIZONTAL_SEGMENTS,-Math.PI/2).scale(-1,1,1).toNonIndexed();t.clearGroups();let e=0,n=0;for(;e<this.SPHERE_SEGMENTS*xa;e+=xa)t.addGroup(e,xa,n++);for(;e<this.NB_VERTICES-this.SPHERE_SEGMENTS*xa;e+=Q_)t.addGroup(e,Q_,n++);for(;e<this.NB_VERTICES;e+=xa)t.addGroup(e,xa,n++);return t.setAttribute(WU,t.getAttribute(xI).clone()),new lq(t,[])}setTexture(t,e,n){const{texture:i}=e;if(n){this.state.inTransition=!0,this.__setTexture(t,i,!0);return}if(this.__cleanup(),this.__setTexture(t,i,!1),this.state.materials=t.material,this.state.geom=t.geometry,this.state.geom.setAttribute(xI,this.state.geom.getAttribute(WU).clone()),this.config.debug){const r=yre(this.state.geom);this.viewer.renderer.addObject(r),this.viewer.renderer.setSphereCorrection(this.viewer.config.sphereCorrection,r)}setTimeout(()=>this.__refresh())}__setTexture(t,e,n){let i;e?i=new Dy({map:e}):i=new Dy({color:this.config.backgroundColor}),n&&(i.depthTest=!1,i.depthWrite=!1);for(let r=0;r<this.NB_GROUPS;r++)t.material.push(i)}setTextureOpacity(t,e){t.material[0].opacity=e,t.material[0].transparent=e<1}disposeTexture(t){var e;(e=t.texture)==null||e.dispose()}__refresh(){if(!this.state.geom||this.state.inTransition)return;const t=this.viewer.config.panorama,e=this.viewer.getZoomLevel(),n=HU(t,e,this),i=this.state.geom.getAttribute(wre),r={};for(let a=0;a<this.NB_VERTICES;a+=1)if(i2.fromBufferAttribute(i,a),i2.applyEuler(this.viewer.renderer.sphereCorrection),this.viewer.renderer.isObjectVisible(i2)){let u;a<this.SPHERE_SEGMENTS*xa?u=Math.floor(a/3):a<this.NB_VERTICES-this.SPHERE_SEGMENTS*xa?u=Math.floor((a/3-this.SPHERE_SEGMENTS)/2)+this.SPHERE_SEGMENTS:u=Math.floor((a-this.NB_VERTICES-this.SPHERE_SEGMENTS*xa)/3)+this.SPHERE_HORIZONTAL_SEGMENTS*(this.SPHERE_SEGMENTS-1);const l=Math.floor(u/this.SPHERE_SEGMENTS),f=u-l*this.SPHERE_SEGMENTS;let g=n;for(;g;){const y=Math.floor(l/g.facesByRow),S=Math.floor(f/g.facesByCol);let b=i2.angleTo(this.viewer.state.direction);(y===0||y===g.rows-1)&&(b*=2);const A={row:y,col:S,angle:b,config:g,url:null},I=bI(A);if(r[I]){r[I].angle=Math.min(r[I].angle,b);break}else if(A.url=t.tileUrl(S,y,g.level),A.url){r[I]=A;break}else g=xre(t,g.level-1,this)}}this.state.tileConfig=n,this.__loadTiles(Object.values(r))}__loadTiles(t){this.queue.disableAllTasks(),t.forEach(e=>{const n=bI(e);this.state.tiles[n]?this.queue.setPriority(n,e.angle):(this.state.tiles[n]=!0,this.queue.enqueue(new fre(n,e.angle,i=>this.__loadTile(e,i))))}),this.queue.start()}__loadTile(t,e){return this.viewer.textureLoader.loadImage(t.url,null,this.viewer.state.textureData.cacheKey).then(n=>{if(!e.isCancelled()){this.config.debug&&(n=_re(n,t.config.level,bI(t)));const i=this.config.antialias&&t.config.level>0,r=new Dy({map:zn.createTexture(n,i)});this.__swapMaterial(t,r,!1),this.viewer.needsUpdate()}}).catch(n=>{!zn.isAbortError(n)&&!e.isCancelled()&&this.config.showErrorTile&&(this.state.errorMaterial||(this.state.errorMaterial=vre()),this.__swapMaterial(t,this.state.errorMaterial,!0),this.viewer.needsUpdate())})}__swapMaterial(t,e,n){const i=this.state.geom.getAttribute(xI);for(let r=0;r<t.config.facesByCol;r++)for(let a=0;a<t.config.facesByRow;a++){const u=t.col*t.config.facesByCol+r,l=t.row*t.config.facesByRow+a,f=l===0,g=l===this.SPHERE_HORIZONTAL_SEGMENTS-1;let y;if(f?y=u*xa:g?y=this.NB_VERTICES-this.SPHERE_SEGMENTS*xa+u*xa:y=this.SPHERE_SEGMENTS*xa+(l-1)*this.SPHERE_SEGMENTS*Q_+u*Q_,n&&this.state.faces[y]>jU||this.state.faces[y]>t.config.level)continue;this.state.faces[y]=n?jU:t.config.level;const S=this.state.geom.groups.find(L=>L.start===y).materialIndex;this.state.materials[S]=e;const b=1-a/t.config.facesByRow,A=1-(a+1)/t.config.facesByRow,I=r/t.config.facesByCol,D=(r+1)/t.config.facesByCol;f?(i.setXY(y,(I+D)/2,b),i.setXY(y+1,I,A),i.setXY(y+2,D,A)):g?(i.setXY(y,D,b),i.setXY(y+1,I,b),i.setXY(y+2,(I+D)/2,A)):(i.setXY(y,D,b),i.setXY(y+1,I,b),i.setXY(y+2,D,A),i.setXY(y+3,I,b),i.setXY(y+4,I,A),i.setXY(y+5,D,A))}i.needsUpdate=!0}__cleanup(){this.queue.clear(),this.state.tiles={},this.state.faces={},this.state.inTransition=!1,this.state.materials.forEach(t=>{var e;(e=t==null?void 0:t.map)==null||e.dispose(),t==null||t.dispose()}),this.state.materials.length=0}getAdapter(){return this.adapter||(this.adapter=new vg(this.viewer,{backgroundColor:this.config.backgroundColor,interpolateBackground:!1,blur:this.config.baseBlur})),this.adapter}};r2.id="equirectangular-tiles",r2.VERSION="5.10.0",r2.supportsDownload=!1;class Ere extends r2{constructor(e,n){super(e,n),this._shouldGoFast=n.shouldGoFast||(()=>!0)}loadTexture(e,n){return e.origBaseUrl?e.baseUrl=e.origBaseUrl:e.origBaseUrl=e.baseUrl,this._shouldGoFast()&&e.thumbUrl&&!e.hdLoaded&&e.rows==1&&(e.baseUrl=e.thumbUrl),super.loadTexture(e,n).then(i=>(e.baseUrl===e.origBaseUrl&&(e.hdLoaded=!0),i))}__loadTiles(e){this._shouldGoFast()||super.__loadTiles(e)}}const M2=class M2 extends nb{constructor(n,i){super(M2.type);yn(this,"type");this.node=n,this.data=i}};yn(M2,"type","node-changed");let wI=M2;const C2=class C2 extends nb{constructor(n,i){super(C2.type);yn(this,"type");this.link=n,this.node=i}};yn(C2,"type","enter-arrow");let SI=C2;const T2=class T2 extends nb{constructor(n,i){super(T2.type);yn(this,"type");this.link=n,this.node=i}};yn(T2,"type","leave-arrow");let EI=T2;const MI="https://api.streetview.vn/v1/search",Mre="https://api.streetview.vn/v1/tracking",qU="https://api.streetview.vn/v1",XU="https://www.streetview.vn/track-sources.json";class Cre extends da{constructor(e,n){super(e,{}),this.plugin=n}}const Tre=`<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M20.2354 4.13657C19.598 4.6089 19.1849 5.36666 19.1849 6.22092C19.1849 7.65277 18.0241 8.81351 16.5923 8.81351C15.1604 8.81351 13.9997 9.97426 13.9997 11.4061C13.9997 12.838 15.1604 13.9987 16.5923 13.9987C18.0241 13.9987 19.1849 15.1594 19.1849 16.5913C19.1849 18.0231 20.3456 19.1839 21.7775 19.1839H24.4536M20.2354 4.13657C18.4317 2.99371 16.293 2.33203 13.9997 2.33203C7.99451 2.33203 3.04905 6.86913 2.40421 12.7024M20.2354 4.13657C23.4995 6.20473 25.6663 9.84867 25.6663 13.9987C25.6663 20.442 20.443 25.6654 13.9997 25.6654C11.2213 25.6654 8.66981 24.6942 6.66609 23.0728M6.66609 23.0728L10.1108 23.0728C11.5426 23.0728 12.7034 21.912 12.7034 20.4802C12.7034 19.0483 11.5426 17.8876 10.1108 17.8876C8.67894 17.8876 7.51819 16.7268 7.51819 15.295C7.51819 13.8631 6.35745 12.7024 4.9256 12.7024H2.40421M6.66609 23.0728C4.02295 20.9339 2.33301 17.6637 2.33301 13.9987C2.33301 13.5605 2.35716 13.128 2.40421 12.7024" stroke="#28303F" stroke-width="1.5" stroke-linecap="round"/>
</svg>
`,Are=`<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M18.084 25.0846C16.9173 25.668 16.9173 25.668 14.0007 25.6679C11.2223 25.6679 8.67079 24.6968 6.66707 23.0753M2.91732 9.91797C2.91732 9.91797 2.64879 10.5013 2.40519 12.705M6.66707 23.0753L10.1118 23.0754C11.5436 23.0754 12.7044 21.9146 12.7044 20.4828C12.7044 19.0509 11.5436 17.8902 10.1118 17.8902C8.67991 17.8902 7.51917 16.7294 7.51917 15.2976C7.51917 13.8657 6.35843 12.705 4.92658 12.705H2.40519M6.66707 23.0753C4.02392 20.9365 2.33398 17.6663 2.33398 14.0013C2.33398 13.5631 2.35814 13.1306 2.40519 12.705" stroke="#28303F" stroke-width="1.5" stroke-linecap="round"/>
<path d="M2.33398 4.66797L23.334 25.668" stroke="#28303F" stroke-width="2" stroke-linecap="round"/>
<path d="M23.3333 20.9987C25.0833 18.0172 25.6667 18.082 25.6667 13.9987C25.6667 9.84867 23.4998 6.20473 20.2357 4.13657M20.2357 4.13657C19.5984 4.6089 19.1852 5.36666 19.1852 6.22092C19.1852 7.65277 18.0244 8.81351 16.5926 8.81351C15.1607 8.81351 14 9.97426 14 11.4061C14 12.838 15.1607 13.9987 16.5926 13.9987C18.0244 13.9987 19.1852 15.1594 19.1852 16.5913C19.1852 18.0231 20.3459 19.1839 21.7778 19.1839L24.1656 19.3799M20.2357 4.13657C18.432 2.99371 16.2933 2.33203 14 2.33203C9.91667 2.33203 7.58333 4.08203 7 4.66536" stroke="#28303F" stroke-width="1.5" stroke-linecap="round"/>
</svg>
`,ZU=Tre,Pre=Are;class Ire extends da{constructor(n,i){super(n,{});yn(this,"currentLink",null);this.plugin=i,this.container.addEventListener("click",this),this.container.addEventListener("touchend",this),this.applyConfig(),this.disabled(),i.config.onlyMode&&this.hide()}get config(){return this.plugin.config}handleEvent(n){var i,r;switch(n.type){case"click":case"touchend":this.currentLink&&((r=this.viewer.getPlugin(Sh))==null||r.setCurrentNode((i=this.currentLink)==null?void 0:i.nodeId,null,this.currentLink));break}}destroy(){this.hide(),super.destroy()}hide(){this.container.style.display="none"}applyConfig(){this.container.className=`psv-view-mode psv-view-mode--${this.config.position.join("-")}`,this.config.className&&this.container.classList.add(this.config.className),this.container.innerHTML=ZU,this.container.style.width=this.config.size,this.container.style.height=this.config.size,this.container.style.marginTop=this.config.position[0]==="center"?`calc(-${this.config.size} / 2)`:"",this.container.style.marginLeft=this.config.position[1]==="center"?`calc(-${this.config.size} / 2)`:""}update(n,i){var r;switch(this.setCurrentLink(i),i?this.enabled():this.disabled(),(r=n==null?void 0:n.properties)==null?void 0:r.view_mode){case"street":this.container.innerHTML=ZU;break;case"fly":this.container.innerHTML=Pre;break}}setCurrentLink(n){this.currentLink=n}disabled(){this.container.classList.add("psv-view-mode--disabled")}enabled(){this.container.classList.remove("psv-view-mode--disabled")}}const Rre=zn.getConfigParser({size:"40px",position:["top","right"],className:null,onlyMode:null},{position:(t,{defValue:e})=>zn.cleanCssPosition(t,{allowCenter:!0,cssOrder:!0})||e});class Nv extends sp{constructor(n,i){super(n,i);yn(this,"component");this.component=new Ire(this.viewer,this)}update(n,i){this.component.update(n,i)}}yn(Nv,"id","view-mode"),yn(Nv,"configParser",Rre);class s2 extends sp{constructor(n,i){super(n,i);yn(this,"component");yn(this,"hoveredStateId");yn(this,"map");yn(this,"initSource",()=>{this.map&&this.map.once("load",()=>{this.map.addSource("streetview_vn",{type:"vector",url:XU}),this.updateLayers(),this.map.on("mousemove","streetview_vn_pictures",n=>{n.features.length>0&&(this.map.getCanvas().style.cursor="pointer",this.hoveredStateId=n.features[0].properties.id)}),this.map.on("mouseleave","streetview_vn_pictures",()=>{this.hoveredStateId=null,this.map.getCanvas().style.cursor="grabbing"}),this.map.on("mouseleave","streetview_vn_sequences",()=>{this.hoveredStateId=null,this.map.getCanvas().style.cursor="grabbing"}),this.map.on("click","streetview_vn_pictures",n=>{var i;n.features.length>0&&!n.features[0].properties.hidden&&(this.map.getCanvas().style.cursor="pointer",(i=this.viewer.getPlugin(Sh))==null||i.setCurrentNode(n.features[0].properties.id))}),this.map.on("mousemove","streetview_vn_sequences",n=>{n.features.length>0&&(this.map.getCanvas().style.cursor="pointer",this.hoveredStateId=n.features[0].properties.id)}),this.map.on("click","streetview_vn_sequences",n=>{var i;n.features.length>0&&!n.features[0].properties.hidden&&(this.hoveredStateId=n.features[0].properties.id,this.map.getCanvas().style.cursor="pointer",(i=this.viewer.getPlugin(Sh))==null||i.setCurrentBBOX(n.lngLat,n.features[0].properties.id))}),this.map.on("mouseleave","streetview_vn_grid",()=>{this.hoveredStateId=null,this.map.getCanvas().style.cursor="grabbing"}),this.map.on("mousemove","streetview_vn_grid",n=>{n.features.length>0&&(this.map.getCanvas().style.cursor="pointer")}),this.map.on("click","streetview_vn_grid",n=>{var i;n.features.length>0&&(this.map.getCanvas().style.cursor="pointer",(i=this.viewer.getPlugin(Sh))==null||i.setCurrentBBOX(n.lngLat,"",.5))})})});yn(this,"reloadSource",()=>{this.map&&(this.map.addSource("streetview_vn",{type:"vector",url:XU}),this.updateLayers())});yn(this,"updateSource",n=>{var i,r;((i=this.map.getSource("streetview_vn"))==null?void 0:i.tiles[0])!==n[0]&&((r=this.map.getSource("streetview_vn"))==null||r.setTiles(n))});this.options={loadSource:!0,...i},this.component=new Cre(this.viewer,this)}init(){var n,i;this.map=(n=this.viewer.getPlugin(tf))==null?void 0:n.getMap(),this.map&&(i=this.options)!=null&&i.loadSource&&this.initSource()}handlerFilter(n){var y;let{startDate:i,endDate:r,viewMode:a,accountId:u}=n;this.viewer.getPlugin(Nv)&&(a=((y=this.viewer.getPlugin(Nv).config)==null?void 0:y.onlyMode)||a);const l=this.createFilter(null,null,!1,a,u),f=this.createFilter(i,r,!1,a,u),g=this.createFilter(i,r,!0,a,u);this.map.getLayer("streetview_vn_sequences")&&(this.map.setFilter("streetview_vn_sequences",l),this.map.setFilter("streetview_vn_sequences",f)),this.map.getLayer("streetview_vn_pictures")&&(this.map.setFilter("streetview_vn_pictures",l),this.map.setFilter("streetview_vn_pictures",g))}createFilter(n,i,r,a,u){const l=["all"];return n&&l.push([">=",r?["slice",["get","ts"],0,10]:["get","date"],n]),i&&l.push(["<=",r?["slice",["get","ts"],0,10]:["get","date"],i]),a&&l.push(["==",["get","view_mode"],a]),u&&l.push(["==",["get","account_id"],u]),l}updateLayers(){const n=this.map.getStyle().layers.find(this.isLabelLayer);this.map.addLayer({id:"streetview_vn_sequences",layout:{"line-cap":"square"},paint:{"line-color":["match",["get","view_mode"],"street","#43C6B8","fly","#6F88FF","#43C6B8"],"line-opacity":["interpolate",["linear"],["zoom"],6+.25,0,7,1],"line-width":["interpolate",["linear"],["zoom"],0,.5,10,2,14,4,16,5,22,3]},source:"streetview_vn","source-layer":"sequences",type:"line"},n==null?void 0:n.id),this.map.addLayer({id:"streetview_vn_pictures",paint:{"circle-color":["case",["boolean",["feature-state","hover"],!1],"rgb(255, 127, 62)",["match",["get","view_mode"],"street","#43C6B8","fly","#6F88FF","#43C6B8"]],"circle-opacity":["interpolate",["linear"],["zoom"],15,0,16,1],"circle-radius":["interpolate",["linear"],["zoom"],15,4.5,17,8,22,12],"circle-stroke-color":"#ffffff","circle-stroke-width":["interpolate",["linear"],["zoom"],17,0,20,2]},source:"streetview_vn","source-layer":"pictures",type:"circle"},"streetview_vn_sequences"),this.map.addLayer({id:"streetview_vn_grid",source:"streetview_vn","source-layer":"grid",type:"circle",layout:{"circle-sort-key":["get","coef"]},paint:{"circle-radius":["interpolate",["linear"],["zoom"],1,["match",["get","coef"],0,0,1],4,["match",["get","coef"],0,0,6],5,["match",["get","coef"],0,0,2.5],6,["match",["get","coef"],0,0,4],7,["match",["get","coef"],0,0,7]],"circle-color":["interpolate",["linear"],["get","coef"],0,"#FFA726",.5,"#14B8A6",1,"#3E2723"],"circle-opacity":["interpolate",["linear"],["zoom"],4,.5,5,1,6+.75,1,7,0]}})}reloadStyleForSeq(n){this.map.getLayer("streetview_vn_pictures")&&this.map.getLayer("streetview_vn_sequences")?this.updateStyle(n):this.map.once("load",()=>{this.updateStyle(n)})}isLabelLayer(n){var i;return n.type==="symbol"&&((i=n==null?void 0:n.layout)==null?void 0:i["text-field"])&&(n.minzoom===void 0||n.minzoom<15)}updateStyle(n){}}yn(s2,"id","track"),yn(s2,"configParser",()=>{});class Lre extends fa{constructor(e=document.createElement("div")){super(),this.isCSS2DObject=!0,this.element=e,this.element.style.position="absolute",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.center=new so(.5,.5),this.addEventListener("removed",function(){this.traverse(function(n){n.element instanceof Element&&n.element.parentNode!==null&&n.element.parentNode.removeChild(n.element)})})}copy(e,n){return super.copy(e,n),this.element=e.element.cloneNode(!0),this.center=e.center,this}}const Bv=new Lt,YU=new As,KU=new As,JU=new Lt,QU=new Lt;class kre{constructor(e={}){const n=this;let i,r,a,u;const l={objects:new WeakMap},f=e.element!==void 0?e.element:document.createElement("div");f.style.overflow="hidden",this.domElement=f,this.getSize=function(){return{width:i,height:r}},this.render=function(I,D){I.matrixWorldAutoUpdate===!0&&I.updateMatrixWorld(),D.parent===null&&D.matrixWorldAutoUpdate===!0&&D.updateMatrixWorld(),YU.copy(D.matrixWorldInverse),KU.multiplyMatrices(D.projectionMatrix,YU),y(I,I,D),A(I)},this.setSize=function(I,D){i=I,r=D,a=i/2,u=r/2,f.style.width=I+"px",f.style.height=D+"px"};function g(I){I.isCSS2DObject&&(I.element.style.display="none");for(let D=0,L=I.children.length;D<L;D++)g(I.children[D])}function y(I,D,L){if(I.visible===!1){g(I);return}if(I.isCSS2DObject){Bv.setFromMatrixPosition(I.matrixWorld),Bv.applyMatrix4(KU);const P=Bv.z>=-1&&Bv.z<=1&&I.layers.test(L.layers)===!0,N=I.element;N.style.display=P===!0?"":"none",P===!0&&(I.onBeforeRender(n,D,L),N.style.transform="translate("+-100*I.center.x+"%,"+-100*I.center.y+"%)translate("+(Bv.x*a+a)+"px,"+(-Bv.y*u+u)+"px)",N.parentNode!==f&&f.appendChild(N),I.onAfterRender(n,D,L));const B={distanceToCameraSquared:S(L,I)};l.objects.set(I,B)}for(let P=0,N=I.children.length;P<N;P++)y(I.children[P],D,L)}function S(I,D){return JU.setFromMatrixPosition(I.matrixWorld),QU.setFromMatrixPosition(D.matrixWorld),JU.distanceToSquared(QU)}function b(I){const D=[];return I.traverseVisible(function(L){L.isCSS2DObject&&D.push(L)}),D}function A(I){const D=b(I).sort(function(P,N){if(P.renderOrder!==N.renderOrder)return N.renderOrder-P.renderOrder;const B=l.objects.get(P).distanceToCameraSquared,$=l.objects.get(N).distanceToCameraSquared;return B-$}),L=D.length;for(let P=0,N=D.length;P<N;P++)D[P].element.style.zIndex=L-P}}}const e8=new Lt,Dre=new Cg,t8=new Lt;class Ore extends fa{constructor(e=document.createElement("div")){super(),this.isCSS3DObject=!0,this.element=e,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.addEventListener("removed",function(){this.traverse(function(n){n.element instanceof Element&&n.element.parentNode!==null&&n.element.parentNode.removeChild(n.element)})})}copy(e,n){return super.copy(e,n),this.element=e.element.cloneNode(!0),this}}const uu=new As,Fre=new As;class zre{constructor(e={}){const n=this;let i,r,a,u;const l={camera:{style:""},objects:new WeakMap},f=e.element!==void 0?e.element:document.createElement("div");f.style.overflow="hidden",this.domElement=f;const g=document.createElement("div");g.style.transformOrigin="0 0",g.style.pointerEvents="none",f.appendChild(g);const y=document.createElement("div");y.style.transformStyle="preserve-3d",g.appendChild(y),this.getSize=function(){return{width:i,height:r}},this.render=function(L,P){const N=P.projectionMatrix.elements[5]*u;P.view&&P.view.enabled?(g.style.transform=`translate( ${-P.view.offsetX*(i/P.view.width)}px, ${-P.view.offsetY*(r/P.view.height)}px )`,g.style.transform+=`scale( ${P.view.fullWidth/P.view.width}, ${P.view.fullHeight/P.view.height} )`):g.style.transform="",L.matrixWorldAutoUpdate===!0&&L.updateMatrixWorld(),P.parent===null&&P.matrixWorldAutoUpdate===!0&&P.updateMatrixWorld();let B,$;P.isOrthographicCamera&&(B=-(P.right+P.left)/2,$=(P.top+P.bottom)/2);const K=P.view&&P.view.enabled?P.view.height/P.view.fullHeight:1,q=P.isOrthographicCamera?`scale( ${K} )scale(`+N+")translate("+S(B)+"px,"+S($)+"px)"+b(P.matrixWorldInverse):`scale( ${K} )translateZ(`+N+"px)"+b(P.matrixWorldInverse),ie=(P.isPerspectiveCamera?"perspective("+N+"px) ":"")+q+"translate("+a+"px,"+u+"px)";l.camera.style!==ie&&(y.style.transform=ie,l.camera.style=ie),D(L,L,P)},this.setSize=function(L,P){i=L,r=P,a=i/2,u=r/2,f.style.width=L+"px",f.style.height=P+"px",g.style.width=L+"px",g.style.height=P+"px",y.style.width=L+"px",y.style.height=P+"px"};function S(L){return Math.abs(L)<1e-10?0:L}function b(L){const P=L.elements;return"matrix3d("+S(P[0])+","+S(-P[1])+","+S(P[2])+","+S(P[3])+","+S(P[4])+","+S(-P[5])+","+S(P[6])+","+S(P[7])+","+S(P[8])+","+S(-P[9])+","+S(P[10])+","+S(P[11])+","+S(P[12])+","+S(-P[13])+","+S(P[14])+","+S(P[15])+")"}function A(L){const P=L.elements;return"translate(-50%,-50%)"+("matrix3d("+S(P[0])+","+S(P[1])+","+S(P[2])+","+S(P[3])+","+S(-P[4])+","+S(-P[5])+","+S(-P[6])+","+S(-P[7])+","+S(P[8])+","+S(P[9])+","+S(P[10])+","+S(P[11])+","+S(P[12])+","+S(P[13])+","+S(P[14])+","+S(P[15])+")")}function I(L){L.isCSS3DObject&&(L.element.style.display="none");for(let P=0,N=L.children.length;P<N;P++)I(L.children[P])}function D(L,P,N,B){if(L.visible===!1){I(L);return}if(L.isCSS3DObject){const $=L.layers.test(N.layers)===!0,K=L.element;if(K.style.display=$===!0?"":"none",$===!0){L.onBeforeRender(n,P,N);let q;L.isCSS3DSprite?(uu.copy(N.matrixWorldInverse),uu.transpose(),L.rotation2D!==0&&uu.multiply(Fre.makeRotationZ(L.rotation2D)),L.matrixWorld.decompose(e8,Dre,t8),uu.setPosition(e8),uu.scale(t8),uu.elements[3]=0,uu.elements[7]=0,uu.elements[11]=0,uu.elements[15]=1,q=A(uu)):q=A(L.matrixWorld);const W=l.objects.get(L);if(W===void 0||W.style!==q){K.style.transform=q;const ie={style:q};l.objects.set(L,ie)}K.parentNode!==y&&y.appendChild(K),L.onAfterRender(n,P,N)}}for(let $=0,K=L.children.length;$<K;$++)D(L.children[$],P,N)}}}const n8=()=>window.innerWidth<=767,Nre=`<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 58.77">
    <path fill="#FFFFFF" d="M97.44,43.82L56.18,2.56a8.75,8.75,0,0,0-12.37,0h0L2.56,43.8A8.75,8.75,0,0,0,14.94,56.18l35-35L85.05,56.2A8.75,8.75,0,1,0,97.44,43.82h0Z"/>
</svg>
`,o2="tourLink",a2="__tour-link__",i8=0,Bre=0,Ure={className:"psv-virtual-tour-tooltip",content:'<div class="psv-virtual-tour-loader"><div></div><div></div><div></div></div>'},Vre={element:()=>{const t=document.createElement("button");return t.className="psv-virtual-tour-arrow",t.innerHTML=Nre,t},enabledTooltip:!1,size:{width:60,height:60}},$re=({onOk:t,onCancel:e})=>{const[n,i]=he.useState(!0),{t:r}=pI(),a=()=>{var l;i(!1),(l=document==null?void 0:document.getElementById("open-login"))==null||l.click(),t&&t()},u=()=>{i(!1),e&&e()};return Ws.jsx(Ws.Fragment,{children:Ws.jsxs(Qa,{className:"modal-Login",closeIcon:null,open:n,onOk:a,onCancel:u,okText:r("OK"),cancelText:r("Cancel"),centered:!0,children:[Ws.jsx("h3",{children:r("Login Required")}),Ws.jsx("p",{children:r("You need to login to view image")})]})})},CI=()=>new Promise(t=>{const e=Ws.jsx($re,{onCancel:()=>t(!1),onOk:()=>t(!0)}),n=document.createElement("div");document.body.appendChild(n),gv.render(e,n)}),Hre=({onOk:t,onCancel:e})=>{const[n,i]=he.useState(!0),{t:r}=pI(),a=()=>{i(!1),e&&e()},u=()=>{i(!1),window.open("/dashboard#plans","_blank")};return Ws.jsx(Ws.Fragment,{children:Ws.jsx(Qa,{className:"modal-Limit",closeIcon:null,open:n,onOk:u,onCancel:a,okText:r("Buy Premium"),cancelText:r("Cancel"),centered:!0,children:Ws.jsx("h3",{children:r("You have run out of views for today")})})})},TI=()=>new Promise(t=>{const e=Ws.jsx(Hre,{onCancel:()=>t(!1),onOk:()=>t(!0)}),n=document.createElement("div");document.body.appendChild(n),gv.render(e,n)});function r8(t,e){const n=s8(t),i=s8(e),r=t[2]??0,a=e[2]??0;let u=0;return r!==a&&(u=Math.atan((a-r)/Gre(n,i))),{yaw:Wre(n,i),pitch:u}}function s8(t){return[eu.degToRad(t[0]),eu.degToRad(t[1])]}function Gre(t,e){return zn.greatArcDistance(t,e)*6371e3}function Wre(t,e){const[n,i]=t,[r,a]=e,u=Math.sin(r-n)*Math.cos(a),l=Math.cos(i)*Math.sin(a)-Math.sin(i)*Math.cos(a)*Math.cos(r-n);return Math.atan2(u,l)}function o8(t){if(t&&["color","hoverColor","outlineColor"].some(e=>e in t)){zn.logWarn('VirtualTourPlugin: "arrowStyle" does not support color, hoverColor, outlineColor anymore');return}return t&&typeof t.size=="number"&&(zn.logWarn('VirtualTourPlugin: "arrowStyle.size" must be an object (width + height, in pixels)'),delete t.size),t}const jre=async(t,e="",n)=>{var B,$,K,q,W,ie,Z,X,se,De,Se,Me,Ye;const i=await fetch(`${MI}?apiKey=${e}&ids=${t}&view_mode=${n}`,{method:"GET"});(!e||i.status===401)&&CI(),i.status==429&&TI();const r=await i.json();if(!((B=r.features)!=null&&B.length))throw zn.getAbortError();const a=r.features[0],u=a,l=($=Object.values(a.assets).find(ye=>{var Ce;return((Ce=ye.roles)==null?void 0:Ce.includes("thumbnail"))&&ye.type==="image/jpeg"}))==null?void 0:$.href,f=Object.values(a.assets).find(ye=>{var Ce;return((Ce=ye.roles)==null?void 0:Ce.includes("visual"))&&ye.type==="image/webp"}),g=Object.values(a.assets).find(ye=>{var Ce;return((Ce=ye.roles)==null?void 0:Ce.includes("visual"))&&ye.type==="image/jpeg"}),y=(f||g).href,S=(Object.values(a.assets).find(ye=>{var Ce;return(Ce=ye.roles)==null?void 0:Ce.includes("data")})||{}).href,b=((q=(K=a.properties)==null?void 0:K["pers:interior_orientation"])==null?void 0:q.field_of_view)!=null;let A=b?parseInt(a.properties["pers:interior_orientation"].field_of_view):70;const I=A===360,D=a.properties.exif["Xmp.GPano.PoseHeadingDegrees"]||a.properties.exif["Xmp.GPano.InitialViewHeadingDegrees"]||i8,L=a.links.find(ye=>(ye==null?void 0:ye.rel)==="prev"&&(ye==null?void 0:ye.type)==="application/geo+json"),P=a.links.find(ye=>(ye==null?void 0:ye.rel)==="next"&&(ye==null?void 0:ye.type)==="application/geo+json");return{...a,links:a.links.filter(ye=>ye.geometry).map(ye=>({...ye,gps:ye.geometry.coordinates,nodeId:ye.id})),sphereCorrection:(W=a.properties)!=null&&W["view:azimuth"]?{pan:-a.properties["view:azimuth"]*(Math.PI/180)-D}:{pan:-D},properties:a.properties,gps:a.geometry.coordinates,sequence:{id:a.collection,nextPic:P?P.id:void 0,prevPic:L?L.id:void 0},thumbnail:l,panorama:I?{baseUrl:`${y}`,origBaseUrl:`${y}`,hdUrl:`${S}`,thumbUrl:`${l}`,cols:(Z=(ie=a==null?void 0:a.properties)==null?void 0:ie["tiles:tile_matrix_sets"])==null?void 0:Z.streetview_vn.tileMatrix[0].matrixWidth,rows:(se=(X=a==null?void 0:a.properties)==null?void 0:X["tiles:tile_matrix_sets"])==null?void 0:se.streetview_vn.tileMatrix[0].matrixHeight,width:((Se=(De=a==null?void 0:a.properties)==null?void 0:De["tiles:tile_matrix_sets"])==null?void 0:Se.streetview_vn.tileMatrix[0].matrixWidth)*((Ye=(Me=a==null?void 0:a.properties)==null?void 0:Me["tiles:tile_matrix_sets"])==null?void 0:Ye.streetview_vn.tileMatrix[0].tileWidth),tileUrl:(ye,Ce)=>`${a.asset_templates.tiles.href.replace(/\{TileCol\}/g,ye).replace(/\{TileRow\}/g,Ce)}`}:{baseUrl:y,origBaseUrl:y,hdUrl:S,thumbUrl:l,basePanoData:ye=>{ye.width<ye.height&&!b&&(A=35);const Ce=A*ye.height/ye.width,ge=ye.width*360/A,Be=ye.height*180/Ce;return{fullWidth:ge,fullHeight:Be,croppedWidth:ye.width,croppedHeight:ye.height,croppedX:(ge-ye.width)/2,croppedY:(Be-ye.height)/2,poseHeading:u.properties["view:azimuth"]||0}},cols:2,rows:1,width:2,tileUrl:()=>null},horizontalFov:A}},AI="arrow";class qre extends da{constructor(n,i){var r,a,u;super(n,{className:`psv-virtual-tour-arrows ${(r=i==null?void 0:i.config)!=null&&r.arrowEnabled?"":"disabled"}`});yn(this,"renderer");yn(this,"scene");yn(this,"camera");this.plugin=i,this.renderer=this.is3D?new zre({element:this.container}):new kre({element:this.container}),this.camera=this.is3D?new hq(30,1):null,this.scene=new pq,this.viewer.addEventListener(Pi.ReadyEvent.type,this,{once:!0}),this.viewer.addEventListener(Pi.PositionUpdatedEvent.type,this),this.viewer.addEventListener(Pi.SizeUpdatedEvent.type,this),this.viewer.addEventListener(Pi.RenderEvent.type,this),this.viewer.addEventListener(Pi.ClickEvent.type,this),this.container.addEventListener("touchend",this),(u=(a=this.plugin.config)==null?void 0:a.arrowStyle)!=null&&u.enabledTooltip&&(this.container.addEventListener("touchmove",this),this.container.addEventListener("mouseenter",this,!0),this.container.addEventListener("mouseleave",this,!0),this.container.addEventListener("mousemove",this,!0))}get is3D(){return this.plugin.is3D}get arrowsPosition(){return this.plugin.config.arrowsPosition}get arrowStyle(){return this.plugin.config.arrowStyle}destroy(){this.viewer.removeEventListener(Pi.ReadyEvent.type,this),this.viewer.removeEventListener(Pi.PositionUpdatedEvent.type,this),this.viewer.removeEventListener(Pi.SizeUpdatedEvent.type,this),this.viewer.removeEventListener(Pi.RenderEvent.type,this),this.viewer.removeEventListener(Pi.ClickEvent.type,this),super.destroy()}handleEvent(n){var i,r,a,u;switch(n.type){case Pi.ReadyEvent.type:case Pi.SizeUpdatedEvent.type:case Pi.PositionUpdatedEvent.type:this.__updateCamera();break;case Pi.RenderEvent.type:this.render();break;case"touchmove":{const l=this.getTargetLink(n.target,!0);l&&(n8()&&((r=(i=this.viewer)==null?void 0:i.getPlugin(tf))==null||r.close()),this.plugin.setCurrentNode(l.nodeId,null,l));break}case Pi.ClickEvent.type:{const l=this.getTargetLink(n.data.target,!0);l&&(n8()&&((u=(a=this.viewer)==null?void 0:a.getPlugin(tf))==null||u.close()),this.plugin.setCurrentNode(l.nodeId,null,l));break}case"mouseenter":{const l=this.getTargetLink(n.target);l&&this.plugin.__onEnterArrow(l,n);break}case"mouseleave":{const l=this.getTargetLink(n.target);l&&this.plugin.__onLeaveArrow(l);break}case"mousemove":{this.getTargetLink(n.target,!0)&&this.plugin.__onHoverArrow(n);break}}}__updateCamera(){const n=this.viewer.getSize();if(this.renderer.setSize(n.width,n.height),this.is3D){const i=this.viewer.getPosition();i.pitch=eu.clamp(i.pitch,-this.arrowsPosition.maxPitch,-this.arrowsPosition.minPitch),this.viewer.dataHelper.sphericalCoordsToVector3(i,this.camera.position,n.height*2).negate(),this.camera.lookAt(0,0,0),this.camera.translateY(n.height/3),this.camera.updateProjectionMatrix()}}render(){if(this.is3D){const n=this.viewer.getPosition(),i=[];let r=Number.MAX_SAFE_INTEGER;this.scene.children.forEach(a=>{const u=a.userData[AI];if(u.conflict){const l=Math.abs(zn.getShortestArc(n.yaw,u.yaw));r=Math.min(r,l),i.push([a,l])}}),i.forEach(([a,u])=>{const l=u!==r;a.element.style.opacity=l?"0.5":null,a.element.style.zIndex=l?"-1":null,l?a.element.classList.add("hidden-label"):a.element.classList.remove("hidden-label")}),this.renderer.render(this.scene,this.camera)}else this.renderer.render(this.scene,this.viewer.renderer.camera)}clear(){this.scene.clear()}__buildArrowElement(n,i){if(i!=null&&i.image){const r=document.createElement("img");return r.src=i.image,r}else if(i!=null&&i.element)return typeof i.element=="function"?i.element(n):i.element}async asyncGetStreet(n,i){var u,l,f;const r=await fetch(`https://api.streetview.vn/v1/routing/locale?apiKey=${((u=this.config)==null?void 0:u.apiKey)||((f=(l=this.viewer)==null?void 0:l._config)==null?void 0:f.apiKey)}&admin_v2=true&json=${JSON.stringify({verbose:!0,locations:[{lat:i==null?void 0:i.gps[1],lon:i==null?void 0:i.gps[0]}],costing:"auto",directions_options:{units:"miles"}})}`).then(g=>g.json()),a=r==null?void 0:r.data;a&&(n.innerHTML=`<div class='street-label'>${a}</div>`+n.innerHTML)}addLinkArrow(n,i,r=1){let a=this.__buildArrowElement(n,n.arrowStyle);a||(a=this.__buildArrowElement(n,this.arrowStyle)),a[o2]=n;const u={...this.arrowStyle,...o8(n.arrowStyle)};if(a.classList.add("psv-virtual-tour-link"),(n==null?void 0:n.rel)=="related"&&a.classList.add("ref-label"),u.className&&zn.addClasses(a,u.className),u.style&&Object.assign(a.style,u.style),this.is3D){this.asyncGetStreet(a,n);let l=!1;this.scene.children.forEach(g=>{const y=g.userData[AI];Math.abs(zn.getShortestArc(y.yaw,i.yaw))<this.arrowsPosition.linkOverlapAngle&&(y.conflict=!0,l=!0)});const f=new Ore(a);f.userData[AI]={yaw:i.yaw,conflict:l},f.rotation.set(-Math.PI/2,0,Math.PI-i.yaw),this.viewer.dataHelper.sphericalCoordsToVector3({yaw:i.yaw,pitch:0},f.position,r*100),this.scene.add(f)}else{const l=new Lre(a);this.viewer.dataHelper.sphericalCoordsToVector3(i,l.position),this.scene.add(l)}}getTargetLink(n,i=!1){const r=i?zn.getClosest(n,".psv-virtual-tour-link"):n;return r?r[o2]:void 0}}class a8{constructor(e,n){yn(this,"nodes",{});this.plugin=e,this.viewer=n}destroy(){}checkNode(e){var n,i;if(!e.id)throw new qn("No id given for node");if(!e.panorama)throw new qn(`No panorama provided for node ${e.id}`);if("position"in e&&(zn.logWarn('Use the "gps" property to configure the GPS position of a virtual node'),e.gps=e.position),this.plugin.isGps&&!(((n=e.gps)==null?void 0:n.length)>=2))throw new qn(`No GPS position provided for node ${e.id}`);if(!this.plugin.isGps&&((i=e.markers)!=null&&i.some(r=>r.gps&&!r.position)))throw new qn("Cannot use GPS positioning for markers in manual mode")}checkLink(e,n){if(!n.nodeId)throw new qn(`Link of node ${e.id} has no target id`);if(Array.isArray(n.position)&&(zn.logWarn('Use the "gps" property to configure the GPS position of a virtual link'),n.gps=n.position,delete n.position),zn.isExtendedPosition(n)&&(zn.logWarn('Use the "position" property to configure the position of a virtual link'),n.position=this.viewer.dataHelper.cleanPosition(n)),!this.plugin.isGps&&!zn.isExtendedPosition(n.position))throw new qn(`No position provided for link ${n.nodeId} of node ${e.id}`);if(this.plugin.isGps&&!n.gps)throw new qn(`No GPS position provided for link ${n.nodeId} of node ${e.id}`)}}class Xre extends a8{loadNode(e){return this.nodes[e]?Promise.resolve(this.nodes[e]):Promise.reject(new qn(`Node ${e} not found`))}setNodes(e){if(!(e!=null&&e.length))throw new qn("No nodes provided");const n={},i={};e.forEach(r=>{if(this.checkNode(r),n[r.id])throw new qn(`Duplicate node ${r.id}`);r.links||(zn.logWarn(`Node ${r.id} has no links`),r.links=[]),n[r.id]=r}),e.forEach(r=>{r.links.forEach(a=>{if(!n[a.nodeId])throw new qn(`Target node ${a.nodeId} of node ${r.id} does not exists`);a.gps=a.gps||n[a.nodeId].gps,this.checkLink(r,a),i[a.nodeId]=!0})}),e.forEach(r=>{i[r.id]||zn.logWarn(`Node ${r.id} is never linked to`)}),this.nodes=n}}class Zre extends a8{constructor(n,i){super(n,i);yn(this,"nodeResolver");if(!n.config.getNode)throw new qn("Missing getNode() option.");this.nodeResolver=n.config.getNode}loadNode(n,i){var r,a;if(this.nodes[n])return Promise.resolve(this.nodes[n]);{const u=((a=(r=this.viewer.getPlugin(Nv))==null?void 0:r.config)==null?void 0:a.onlyMode)||null;return Promise.resolve(this.nodeResolver(n,i,u)).then(l=>(this.checkNode(l),l.links||(zn.logWarn(`Node ${l.id} has no links`),l.links=[]),l.links.forEach(f=>{this.nodes[f.nodeId]&&(f.gps=f.gps||this.nodes[f.nodeId].gps),this.checkLink(l,f)}),this.nodes[n]=l,l))}}}const PI=zn.getConfigParser({dataMode:"server",positionMode:"gps",renderMode:"3d",apiKey:null,nodes:null,getNode:jre,onLoadNode:()=>{},startNodeId:null,preload:!0,updateCoordinatesPlan:!0,speed:null,transitionOptions:{showLoader:!1,speed:500,zoomTo:Bre,fadeIn:!0,rotation:!0},linksOnCompass:!0,getLinkTooltip:null,markerStyle:null,arrowStyle:Vre,markerPitchOffset:null,arrowPosition:null,arrowsPosition:{minPitch:.3,maxPitch:Math.PI/2,linkOverlapAngle:Math.PI/4,linkPitchOffset:-.1},map:null,arrowEnabled:!1},{dataMode(t){if(t!=="client"&&t!=="server")throw new qn("VirtualTourPlugin: invalid dataMode");return t},positionMode(t){if(t!=="gps"&&t!=="manual")throw new qn("VirtualTourPlugin: invalid positionMode");return t},renderMode(t){if(t==="markers")return zn.logWarn('VirtualTourPlugin: "renderMode" markers has been replaced by 2d'),"2d";if(t!=="3d"&&t!=="2d")throw new qn("VirtualTourPlugin: invalid renderMode");return t},markerStyle(t){return t&&zn.logWarn('VirtualTourPlugin: "markerStyle" is deprecated'),null},arrowPosition(t){return t&&zn.logWarn('VirtualTourPlugin: "arrowPosition" is deprecated'),null},arrowsPosition(t,{defValue:e,rawConfig:n}){return zn.isNil(n.markerPitchOffset)||(zn.logWarn('VirtualTourPlugin: "markerPitchOffset" is deprecated, use "arrowsPosition.linkPitchOffset" instead'),t.linkPitchOffset=n.markerPitchOffset),{...e,...t}},arrowStyle(t,{defValue:e}){return{...e,...o8(t)}},map(t,{rawConfig:e}){if(t){if(e.dataMode==="server")return zn.logWarn("VirtualTourPlugin: The map cannot be used in server side mode"),null;if(!t.imageUrl)return zn.logWarn('VirtualTourPlugin: configuring the map requires at least "imageUrl"'),null}return t}});class Sh extends sp{constructor(n,i){super(n,i);yn(this,"state",{currentNode:null,currentTooltip:null,loadingNode:null,preload:{}});yn(this,"datasource");yn(this,"arrowsRenderer");yn(this,"map");yn(this,"plan");yn(this,"track");yn(this,"markers");yn(this,"compass");yn(this,"gallery");yn(this,"viewMode");this.arrowsRenderer=new qre(this.viewer,this)}get is3D(){return this.config.renderMode==="3d"}get isServerSide(){return this.config.dataMode==="server"}get isGps(){return this.config.positionMode==="gps"}init(){var n,i;super.init(),zn.checkStylesheet(this.viewer.container,"virtual-tour-plugin"),this.markers=this.viewer.getPlugin("markers"),this.compass=this.viewer.getPlugin("compass"),this.gallery=this.viewer.getPlugin("gallery"),this.viewMode=this.viewer.getPlugin("view-mode"),(n=this.markers)!=null&&n.config.markers&&(zn.logWarn("No default markers can be configured on Markers plugin when using VirtualTour plugin. Consider defining `markers` on each tour node."),delete this.markers.config.markers),this.config.map&&(this.map=this.viewer.getPlugin("map"),this.map||zn.logWarn("The map is configured on the VirtualTourPlugin but the MapPlugin is not loaded.")),this.isGps&&(this.plan=this.viewer.getPlugin("plan")),this.track=this.viewer.getPlugin(s2),this.datasource=this.isServerSide?new Zre(this,this.viewer):new Xre(this,this.viewer),this.map&&(this.map.addEventListener("select-hotspot",this),this.map.setImage(this.config.map.imageUrl)),(i=this.plan)==null||i.addEventListener("select-hotspot",this),this.isServerSide?this.config.startNodeId&&this.setCurrentNode(this.config.startNodeId):this.config.nodes&&(this.setNodes(this.config.nodes,this.config.startNodeId),delete this.config.nodes)}destroy(){var n,i;(n=this.map)==null||n.removeEventListener("select-hotspot",this),(i=this.plan)==null||i.removeEventListener("select-hotspot",this),this.datasource.destroy(),this.arrowsRenderer.destroy(),delete this.datasource,delete this.markers,delete this.compass,delete this.gallery,delete this.arrowsRenderer,delete this.viewMode,super.destroy()}handleEvent(n){var i;if(n instanceof Pi.ClickEvent){const r=(i=n.data.objects.find(a=>a.userData[o2]))==null?void 0:i.userData[o2];r&&this.setCurrentNode(r.nodeId,null,r)}else if(n.type==="select-hotspot"){const r=n.hotspotId;r.startsWith(a2)&&this.setCurrentNode(r.substring(a2.length))}}setSpeed(n){this.config.speed=n}getCurrentNode(){return this.state.currentNode}setNodes(n,i){var r;if(this.isServerSide)throw new qn("Cannot set nodes in server side mode");(r=this.state.currentTooltip)==null||r.hide(),this.state.currentTooltip=null,this.state.currentNode=null,this.datasource.setNodes(n),i?this.datasource.nodes[i]||(i=n[0].id,zn.logWarn(`startNodeId not found is provided nodes, resetted to ${i}`)):i=n[0].id,this.setCurrentNode(i),this.gallery&&this.gallery.setItems(n.map(a=>({id:a.id,panorama:a.panorama,name:a.name,thumbnail:a.thumbnail,options:{caption:a.caption,panoData:a.panoData,sphereCorrection:a.sphereCorrection,description:a.description}})),a=>{this.setCurrentNode(a)}),this.map&&this.map.setHotspots([...n.map(a=>({...a.map||{},...this.__getNodeMapPosition(a),id:a2+a.id,tooltip:a.name}))]),this.plan&&this.plan.setHotspots([...n.map(a=>({...a.plan||{},coordinates:a.gps,id:a2+a.id,tooltip:a.name}))])}setPlanCoordinates([n,i],r){var a,u;(a=this.config)!=null&&a.updateCoordinatesPlan&&((u=this.plan)==null||u.setCoordinates([n,i],r))}setPlanToBBox(n){var i;(i=this.plan)==null||i.fitBBox(n)}async setCurrentLatLng(n,i,r=!0){var g,y,S,b,A,I,D,L;const{lat:a,lng:u}=n;if(!r)return Promise.resolve(this.setPlanCoordinates([u,a],17));const l=await fetch(`${MI}?apiKey=${((g=this.config)==null?void 0:g.apiKey)||((S=(y=this.viewer)==null?void 0:y._config)==null?void 0:S.apiKey)}&place_position=${u},${a}&place_distance=0-500000&limit=1
    &view_mode=${((A=(b=this.viewMode)==null?void 0:b.config)==null?void 0:A.onlyMode)||null}`,{method:"GET"}),f=await l.json();if(!((I=this.config)!=null&&I.apiKey||(L=(D=this.viewer)==null?void 0:D._config)!=null&&L.apiKey)||l.status===401)return CI(),this.setPlanCoordinates([u,a],18),!0;if(l.status==429)return TI(),this.setPlanCoordinates([u,a],18),!0;if(f.features.length){const P=f.features[0].id;return this.setCurrentNode(P,i)}else return this.setPlanCoordinates([u,a],18),!1}async setCurrentBBOX(n,i,r){var y,S,b,A,I,D,L,P;const{lat:a,lng:u}=n;r||(r=5e-4);const l=[u-r,a-r,u+r,a+r].map(N=>N.toFixed(4)).join(","),f=await fetch(`${MI}?apiKey=${((y=this.config)==null?void 0:y.apiKey)||((b=(S=this.viewer)==null?void 0:S._config)==null?void 0:b.apiKey)}&bbox=${l}&sequence=${i}
    &view_mode=${((I=(A=this.viewMode)==null?void 0:A.config)==null?void 0:I.onlyMode)||null}`,{method:"GET"}),g=await f.json();if((!((D=this.config)!=null&&D.apiKey||(P=(L=this.viewer)==null?void 0:L._config)!=null&&P.apiKey)||f.status===401)&&CI(),f.status==429&&TI(),g.features.length){const N=g.features[0].id;return this.setCurrentNode(N)}}setCurrentNode(n,i,r){var l;if(n===((l=this.state.currentNode)==null?void 0:l.id))return Promise.resolve(!0);this.viewer.hideError(),this.state.loadingNode=n;const a=this.state.currentNode,u=a&&r?this.__getLinkPosition(a,r):null;return Promise.resolve(this.state.preload[n]).then(()=>{var f,g,y;if(this.state.loadingNode!==n)throw zn.getAbortError();return this.datasource.loadNode(n,((f=this.config)==null?void 0:f.apiKey)||((y=(g=this.viewer)==null?void 0:g._config)==null?void 0:y.apiKey))}).then(f=>{var b,A,I,D;const g={...f,custom_name:i==null?void 0:i.marker_custom_name};if((b=this.config)!=null&&b.onLoadNode&&((A=this.config)==null||A.onLoadNode(g)),(D=this.track)==null||D.reloadStyleForSeq((I=g==null?void 0:g.sequence)==null?void 0:I.id),this.state.loadingNode!==n)throw zn.getAbortError();const y=g.properties.exif["Xmp.GPano.PoseHeadingDegrees"]||g.properties.exif["Xmp.GPano.InitialViewHeadingDegrees"]||i8,S={...PI.defaults.transitionOptions,rotateTo:u||{pitch:0,yaw:-g.sphereCorrection.pan-y},...typeof this.config.transitionOptions=="function"?this.config.transitionOptions(g,a,r):this.config.transitionOptions,...i};return S.speed=this.config.speed||S.speed,S.rotation&&!S.fadeIn?this.viewer.animate({...S.rotateTo,speed:S.speed}).then(()=>[g,S]):Promise.resolve([g,S])}).then(([f,g])=>{var y,S,b,A,I;if(this.state.loadingNode!==n)throw zn.getAbortError();return g.showLoader&&this.viewer.loader.show(),this.state.currentNode=f,this.state.currentTooltip&&(this.state.currentTooltip.hide(),this.state.currentTooltip=null),this.arrowsRenderer.clear(),(y=this.gallery)!=null&&y.config.hideOnClick&&this.gallery.hide(),(S=this.markers)==null||S.clearMarkers(),(b=this.compass)==null||b.clearHotspots(),(A=this.map)==null||A.minimize(),(I=this.plan)==null||I.minimize(),this.viewer.setPanorama(f.panorama,{caption:f.caption,description:f.description,panoData:f.panoData,sphereCorrection:f.sphereCorrection,transition:g.fadeIn?g.rotation?!0:"fade-only":!1,showLoader:g.showLoader,speed:g.speed,position:g.rotateTo,zoom:g.zoomTo}).then(D=>{if(!D)throw zn.getAbortError()})}).then(()=>{if(this.state.loadingNode!==n)throw zn.getAbortError();const f=this.state.currentNode;if(this.map){const g=this.__getNodeMapPosition(f);this.map.setCenter(g)}return this.setPlanCoordinates(f.gps),f.markers&&this.__addNodeMarkers(f),this.__renderLinks(f),this.__preload(f),this.state.loadingNode=null,this.dispatchEvent(new wI(f,{fromNode:a,fromLink:r,fromLinkPosition:u})),!0}).catch(f=>{if(zn.isAbortError(f))return!1;throw this.viewer.showError(this.viewer.config.lang.loadError),this.viewer.loader.hide(),this.viewer.navbar.setCaption(""),this.state.loadingNode=null,f})}__renderLinks(n){var r;const i=[];n.links.filter(a=>a.view_mode==n.properties.view_mode).forEach(a=>{var l,f,g;const u=this.__getLinkPosition(n,a);u.yaw+=((l=a.linkOffset)==null?void 0:l.yaw)??0,u.pitch+=((f=a.linkOffset)==null?void 0:f.pitch)??0,this.isGps&&!this.is3D&&(u.pitch+=this.config.arrowsPosition.linkPitchOffset),i.push(u),this.arrowsRenderer.addLinkArrow(a,u,(g=a.linkOffset)==null?void 0:g.depth)}),this.arrowsRenderer.render(),this.config.linksOnCompass&&((r=this.compass)==null||r.setHotspots(i)),this.viewMode&&this.viewMode.update(n,n.links.find(a=>a.view_mode!=n.properties.view_mode))}__getLinkPosition(n,i){return this.isGps?r8(n.gps,i.gps):this.viewer.dataHelper.cleanPosition(i.position)}async __getTooltipContent(n){const i=await this.datasource.loadNode(n.nodeId,localStorage.getItem("apiKeyUser")),r=[];(i.name||i.thumbnail||i.caption)&&(i.name&&r.push(`<h3>${i.name}</h3>`),i.thumbnail&&r.push(`<img src="${i.thumbnail}">`),i.caption&&r.push(`<p>${i.caption}</p>`));let a=r.join("");return this.config.getLinkTooltip&&(a=this.config.getLinkTooltip(a,n,i)),a||(a=i.id),a}__onEnterArrow(n,i){const r=zn.getPosition(this.viewer.container),a={x:i.clientX-r.x,y:i.clientY-r.y};this.state.currentTooltip=this.viewer.createTooltip({...Ure,left:a.x,top:a.y,box:{width:20,height:20}}),this.__getTooltipContent(n).then(u=>{this.state.currentTooltip.update(u)}),this.dispatchEvent(new SI(n,this.state.currentNode))}__onHoverArrow(n){const i=zn.getPosition(this.viewer.container),r={x:n.clientX-i.x,y:n.clientY-i.y};this.state.currentTooltip&&this.state.currentTooltip.move({left:r.x,top:r.y})}__onLeaveArrow(n){this.state.currentTooltip&&(this.state.currentTooltip.hide(),this.state.currentTooltip=null),this.dispatchEvent(new EI(n,this.state.currentNode))}__preload(n){this.config.preload&&(this.state.preload[n.id]=!0,this.state.currentNode.links.filter(i=>!this.state.preload[i.nodeId]).filter(i=>typeof this.config.preload=="function"?this.config.preload(this.state.currentNode,i):!0).forEach(i=>{var r,a,u;this.state.preload[i.nodeId]=this.datasource.loadNode(i.nodeId,((r=this.config)==null?void 0:r.apiKey)||((u=(a=this.viewer)==null?void 0:a._config)==null?void 0:u.apiKey)).then(l=>this.viewer.textureLoader.preloadPanorama(l.panorama)).then(()=>{this.state.preload[i.nodeId]=!0}).catch(()=>{delete this.state.preload[i.nodeId]})}))}__addNodeMarkers(n){this.markers?this.markers.setMarkers(n.markers.map(i=>{var r,a;return i.gps&&this.isGps&&(i.position=r8(n.gps,i.gps),(r=i.data)!=null&&r.map&&Object.assign(i.data.map,this.__getGpsMapPosition(i.gps)),(a=i.data)!=null&&a.plan&&(i.data.plan.coordinates=i.gps)),i})):zn.logWarn(`Node ${n.id} markers ignored because the plugin is not loaded.`)}__getNodeMapPosition(n){const i=this.__getGpsMapPosition(n.gps);return i||(n.map?{x:n.map.x,y:n.map.y}:null)}__getGpsMapPosition(n){const i=this.config.map;return this.isGps&&i.extent&&i.size?{x:eu.mapLinear(n[0],i.extent[0],i.extent[2],0,i.size.width),y:eu.mapLinear(n[1],i.extent[1],i.extent[3],0,i.size.height)}:null}}yn(Sh,"id","virtual-tour"),yn(Sh,"configParser",PI),yn(Sh,"readonlyOptions",Object.keys(PI.defaults));const Yre="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20220%20220'%3e%3cdefs%3e%3cstyle%3e.cls-1{isolation:isolate;}.cls-2{fill:%233b9b76;}.cls-3,.cls-8{opacity:0.25;}.cls-11,.cls-3{mix-blend-mode:multiply;}.cls-4{fill:%23606060;}.cls-5{fill:%23ffdaa4;}.cls-6{fill:%23848484;}.cls-7{fill:%234c4c4c;}.cls-9{fill:%23fff;}.cls-10{fill:%232b2b2b;}.cls-11{opacity:0.35;}.cls-12{fill:%232d2d2d;}.cls-13{fill:%2359d1a6;}.cls-14{fill:%23b6b6bf;}.cls-15{fill:%23000323;}.cls-16{fill:%23000342;}.cls-17{opacity:0.15;}.cls-18{fill:%23f9d210;}.cls-19{fill:%23ffe576;}.cls-20{opacity:0.18;}.cls-21{fill:%2300af68;}.cls-22{fill:%231ded93;}.cls-23{fill:%2300e08a;}%3c/style%3e%3c/defs%3e%3cg%20class='cls-1'%3e%3cg%20id='_1'%20data-name='%201'%3e%3cpath%20class='cls-2'%20d='M128.51,58.57,126,95.25c-.44,6.4-5.53,11.6-12.22,13a18,18,0,0,1-3.78.4c-8.47,0-15.47-5.89-16-13.45L91.5,58.57a13.13,13.13,0,0,1,2.82-9,16.58,16.58,0,0,1,13.17-6.17h5C121.75,43.37,129.08,50.33,128.51,58.57Z'/%3e%3cg%20class='cls-3'%3e%3cpath%20class='cls-4'%20d='M128.51,58.57,126,95.25c-.44,6.4-5.53,11.6-12.22,13,.25-8.58,2.64-27.83-1.75-41.68-3.34-10.51-20.47-10.51-20.47-10.51,2.88-3.72,10.45-12.74,15.93-12.74h5C121.75,43.37,129.08,50.33,128.51,58.57Z'/%3e%3c/g%3e%3cpath%20class='cls-5'%20d='M80.71,65.64h0a.82.82,0,0,1-.44-1.06l1.61-3.9a.81.81,0,0,1,1.06-.45h0a.83.83,0,0,1,.44,1.07l-1.61,3.9A.82.82,0,0,1,80.71,65.64Z'/%3e%3cpath%20class='cls-5'%20d='M139.29,65.64h0a.82.82,0,0,0,.44-1.06l-1.61-3.9a.81.81,0,0,0-1.06-.45h0a.83.83,0,0,0-.44,1.07l1.61,3.9A.82.82,0,0,0,139.29,65.64Z'/%3e%3cpath%20class='cls-6'%20d='M70.37,53.71a1.5,1.5,0,0,1-1-2.62l4.71-4.19a1.51,1.51,0,0,1,1.81-.14l4.64,3a1.5,1.5,0,1,1-1.63,2.52L75.22,49.9l-3.86,3.43A1.45,1.45,0,0,1,70.37,53.71Z'/%3e%3cpath%20class='cls-6'%20d='M149.63,53.71a1.47,1.47,0,0,1-1-.38l-3.9-3.43L141,52.28a1.5,1.5,0,0,1-1.61-2.53l4.67-3a1.51,1.51,0,0,1,1.8.14l4.75,4.18a1.5,1.5,0,0,1-1,2.63Z'/%3e%3cpath%20d='M76,64.46h0a2.9,2.9,0,0,1-.78-4l4.61-6.83a2.89,2.89,0,0,1,4-.77h0a2.88,2.88,0,0,1,.78,4L80,63.68A2.89,2.89,0,0,1,76,64.46Z'/%3e%3cpath%20d='M144,64.46h0a2.9,2.9,0,0,0,.78-4l-4.61-6.83a2.89,2.89,0,0,0-4-.77h0a2.88,2.88,0,0,0-.78,4l4.6,6.82A2.89,2.89,0,0,0,144,64.46Z'/%3e%3cpath%20class='cls-7'%20d='M110,213.59h0a7.59,7.59,0,0,1-7.59-7.59V177.87a7.59,7.59,0,0,1,7.59-7.59h0a7.59,7.59,0,0,1,7.59,7.59V206A7.59,7.59,0,0,1,110,213.59Z'/%3e%3cg%20class='cls-3'%3e%3cpath%20class='cls-4'%20d='M110,204.81h0a7.59,7.59,0,0,1-7.59-7.59V169.08a7.59,7.59,0,0,1,7.59-7.59h0a7.59,7.59,0,0,1,7.59,7.59v28.14A7.59,7.59,0,0,1,110,204.81Z'/%3e%3c/g%3e%3cpath%20class='cls-2'%20d='M132.67,153.78v9.68a22.68,22.68,0,0,1-14,20.95v7.17a8.71,8.71,0,0,1-8.67,8.66,8,8,0,0,1-1.21-.09,8.68,8.68,0,0,1-7.45-8.57v-7.17a22.68,22.68,0,0,1-14-20.95v-9.68a22.67,22.67,0,0,1,21.45-22.64c.4,0,.8,0,1.21,0A22.67,22.67,0,0,1,132.67,153.78Z'/%3e%3cg%20class='cls-8'%3e%3cpath%20class='cls-9'%20d='M110,200.24a8.69,8.69,0,0,1-8.66-8.66v-7.17c-10.89-4.52-14-13.06-14-20.95v-9.68A22.66,22.66,0,0,1,110,131.11c.41,0,.81,0,1.22,0a22.67,22.67,0,0,0-21.45,22.64v9.68a22.68,22.68,0,0,0,14,20.95v7.17A8.91,8.91,0,0,0,110,200.24Z'/%3e%3c/g%3e%3cg%20class='cls-8'%3e%3cpath%20class='cls-10'%20d='M110,200.24a8.69,8.69,0,0,0,8.66-8.66v-7.17c10.88-4.51,14-13.06,14-20.95v-9.68A22.66,22.66,0,0,0,110,131.11c-.41,0-.81,0-1.22,0a22.67,22.67,0,0,1,21.45,22.64v9.68a22.68,22.68,0,0,1-14,20.95v7.17C116.24,198.37,109.59,200.24,110,200.24Z'/%3e%3c/g%3e%3cpath%20class='cls-7'%20d='M110,49.72h0a7.59,7.59,0,0,1-7.59-7.59V14A7.59,7.59,0,0,1,110,6.41h0A7.59,7.59,0,0,1,117.59,14V42.13A7.59,7.59,0,0,1,110,49.72Z'/%3e%3cg%20class='cls-3'%3e%3cpath%20class='cls-4'%20d='M110,53.58h0A7.59,7.59,0,0,1,102.41,46V25.66A7.59,7.59,0,0,1,110,18.07h0a7.59,7.59,0,0,1,7.59,7.59V46A7.59,7.59,0,0,1,110,53.58Z'/%3e%3c/g%3e%3cpath%20class='cls-2'%20d='M117.59,28.84V44.76a7.59,7.59,0,0,1-15.18,0V28.84a7.59,7.59,0,1,1,15.18,0Z'/%3e%3cg%20class='cls-3'%3e%3cpath%20class='cls-4'%20d='M117.59,34.19v8c0,2.09-3.39,3.79-7.59,3.79s-7.59-1.7-7.59-3.79v-8c0-2.1,3.4-3.8,7.59-3.8a12.4,12.4,0,0,1,5.37,1.11C116.74,32.19,117.59,33.14,117.59,34.19Z'/%3e%3c/g%3e%3cg%20class='cls-8'%3e%3cpath%20class='cls-9'%20d='M117.59,28.84v1a7.59,7.59,0,0,0-15.18,0v-1a7.59,7.59,0,1,1,15.18,0Z'/%3e%3c/g%3e%3cg%20class='cls-11'%3e%3cpath%20class='cls-4'%20d='M110,171.07h0a12.53,12.53,0,0,1-12.53-12.54V128.27A12.53,12.53,0,0,1,110,115.74h0a12.53,12.53,0,0,1,12.53,12.53v30.26A12.53,12.53,0,0,1,110,171.07Z'/%3e%3c/g%3e%3cpath%20class='cls-12'%20d='M110,167.78h0a12.53,12.53,0,0,1-12.53-12.54V125A12.53,12.53,0,0,1,110,112.45h0A12.53,12.53,0,0,1,122.53,125v30.26A12.53,12.53,0,0,1,110,167.78Z'/%3e%3cpath%20class='cls-13'%20d='M137.63,56.11H82.38a3,3,0,0,1-2.87-4,3.1,3.1,0,0,1,.47-.85c6.28-8.06,17.4-13.42,30-13.42s23.75,5.36,30,13.42a2.91,2.91,0,0,1,.47.86A3,3,0,0,1,137.63,56.11Z'/%3e%3cg%20class='cls-8'%3e%3cpath%20class='cls-9'%20d='M140.5,54.06a2.91,2.91,0,0,0-.47-.86c-6.28-8.06-17.4-13.42-30-13.42S86.26,45.14,80,53.2a3.1,3.1,0,0,0-.47.85A2.93,2.93,0,0,1,80,51.23c6.28-8.06,17.4-13.43,30-13.43s23.75,5.37,30,13.43A3,3,0,0,1,140.5,54.06Z'/%3e%3c/g%3e%3crect%20class='cls-12'%20x='99.53'%20y='33.78'%20width='20.94'%20height='4.88'%20rx='1.72'/%3e%3crect%20class='cls-6'%20x='99.53'%20y='32.89'%20width='20.94'%20height='4.05'%20rx='1.72'/%3e%3cpath%20class='cls-14'%20d='M106.1,36.33h-1.79a1.73,1.73,0,0,1-1.72-1.72h0a1.72,1.72,0,0,1,1.72-1.72h1.79a1.73,1.73,0,0,1,1.72,1.72h0A1.73,1.73,0,0,1,106.1,36.33Z'/%3e%3cpath%20class='cls-14'%20d='M115.69,36.33h-5.23a1.73,1.73,0,0,1-1.72-1.72h0a1.73,1.73,0,0,1,1.72-1.72h5.23a1.72,1.72,0,0,1,1.72,1.72h0A1.73,1.73,0,0,1,115.69,36.33Z'/%3e%3cellipse%20class='cls-5'%20cx='76.16'%20cy='63.33'%20rx='5.52'%20ry='5.57'/%3e%3cellipse%20class='cls-5'%20cx='143.39'%20cy='63.33'%20rx='5.52'%20ry='5.57'/%3e%3cg%20class='cls-11'%3e%3cpath%20class='cls-4'%20d='M109.77,161.12h0a12.54,12.54,0,0,1-12.54-12.53V113.85a12.54,12.54,0,0,1,12.54-12.53h0a12.53,12.53,0,0,1,12.53,12.53v34.74A12.53,12.53,0,0,1,109.77,161.12Z'/%3e%3c/g%3e%3ccircle%20class='cls-15'%20cx='110.15'%20cy='139.29'%20r='17.1'%20transform='translate(-66.23%20118.68)%20rotate(-45)'/%3e%3cpath%20class='cls-15'%20d='M104.36,150.91a8.58,8.58,0,0,1-4.8.29,8.4,8.4,0,0,1-4.7-2.85,2.35,2.35,0,0,1-.7-1.78l-13.4-31.31a5.66,5.66,0,0,1-.58-5,7.65,7.65,0,0,1,4.76-4.73,8.57,8.57,0,0,1,3.63-.47,8.28,8.28,0,0,1,7,4.81l6.08,14.24,1.08,2.5,6.23,14.58a7.24,7.24,0,0,1-4.55,9.75Z'/%3e%3cpath%20class='cls-16'%20d='M109.4,142.89a7.66,7.66,0,0,1-4.76,4.72,8.62,8.62,0,0,1-9.49-2.56,7.21,7.21,0,0,1-1.09-1.78L93.53,142,80.67,112s0,0,0,0a7.66,7.66,0,0,1-.48-1.69s0,0,0,0,.09-.24.14-.37.1-.25.16-.37l.1-.2c.06-.13.13-.25.2-.37a4.21,4.21,0,0,1,.28-.45c.09-.14.2-.29.31-.43s.23-.28.37-.43a3.91,3.91,0,0,1,.35-.36,3.42,3.42,0,0,1,.4-.36l.09-.08a6.88,6.88,0,0,1,.81-.57,3.83,3.83,0,0,1,.44-.25,10.08,10.08,0,0,1,1.11-.49,8.57,8.57,0,0,1,3.63-.47,8.28,8.28,0,0,1,7,4.81l6.08,14.24a14.18,14.18,0,0,1,1.35-.81l1.14,2.65,5.1,11.94A7.06,7.06,0,0,1,109.4,142.89Z'/%3e%3cg%20class='cls-17'%3e%3cpath%20class='cls-9'%20d='M93.3,110.48a8.52,8.52,0,0,0-5-2.15,8.4,8.4,0,0,0-3.63.47,7.74,7.74,0,0,0-4,3.14,7.66,7.66,0,0,1-.48-1.69l.14-.39c.05-.13.1-.25.16-.37l.1-.2c.06-.13.13-.25.2-.37a4.21,4.21,0,0,1,.28-.45c.09-.14.2-.29.31-.43s.23-.28.37-.43a3.91,3.91,0,0,1,.35-.36,3.42,3.42,0,0,1,.4-.36l.09-.08a8.31,8.31,0,0,1,.81-.57,3.83,3.83,0,0,1,.44-.25,10.08,10.08,0,0,1,1.11-.49,8.57,8.57,0,0,1,3.63-.47c.23,0,.45,0,.67.09a40.14,40.14,0,0,0,4,3.3Z'/%3e%3c/g%3e%3cpath%20class='cls-15'%20d='M138.73,114.42l-13.06,31.45a7.12,7.12,0,0,1-1.08,1.8,8.39,8.39,0,0,1-4.66,2.9h0a8.53,8.53,0,0,1-4.79-.25,7.39,7.39,0,0,1-5.12-8,7.27,7.27,0,0,1,.48-1.74L116.57,126l1-2.51,5.94-14.29a8.25,8.25,0,0,1,6.89-4.89,8.65,8.65,0,0,1,3.65.43,7.66,7.66,0,0,1,4.8,4.67A7,7,0,0,1,138.73,114.42Z'/%3e%3cpath%20class='cls-16'%20d='M138.89,109.38a7.48,7.48,0,0,1-.48,1.75l-12.55,30.22-.51,1.23a7,7,0,0,1-1.08,1.8h0a8.61,8.61,0,0,1-9.45,2.64,7.63,7.63,0,0,1-4.8-4.67,7,7,0,0,1,.16-5l5-12,1.1-2.65a15.38,15.38,0,0,1,1.36.78l5.94-14.29a8.25,8.25,0,0,1,6.89-4.89,8.65,8.65,0,0,1,3.65.43A7.66,7.66,0,0,1,138.89,109.38Z'/%3e%3cpath%20class='cls-16'%20d='M126.87,136c0,.56,0,1.11-.08,1.66h0A16.85,16.85,0,0,1,124.9,144h0A17,17,0,0,1,120,149.7h0a17.06,17.06,0,0,1-20.41,0,17,17,0,0,1-6.81-12h0c0-.55-.08-1.1-.08-1.66a17.06,17.06,0,0,1,6.59-13.48c.41-.33.84-.63,1.28-.92a17.1,17.1,0,0,1,18.46,0,14.15,14.15,0,0,1,1.28.91A17,17,0,0,1,126.87,136Z'/%3e%3cpath%20class='cls-18'%20d='M130,107.62v.09l-.66,4.52a21.05,21.05,0,0,1-3.2,6.61c-3.65,5.13-9.57,8.94-16.37,8.94-11.32,0-20.23-10.58-20.23-20.16s8.91-14.53,20.23-14.53S130,98,130,107.62Z'/%3e%3cg%20class='cls-17'%3e%3cpath%20class='cls-9'%20d='M138.89,109.41a7,7,0,0,1-.46,1.69,7.72,7.72,0,0,0-4-3.09,8.55,8.55,0,0,0-3.63-.44,8.65,8.65,0,0,0-4.85,2.08,16,16,0,0,0,0-1.84v-.09a41.4,41.4,0,0,0,3.91-3.35c.22,0,.44-.07.67-.09a8.61,8.61,0,0,1,3.64.43,10,10,0,0,1,1.11.48,3.83,3.83,0,0,1,.44.25,7,7,0,0,1,.82.56l.09.07c.14.12.28.24.4.36a3.05,3.05,0,0,1,.36.36c.14.15.26.29.37.43s.22.28.32.42.19.29.28.45l.21.37.1.2a3.92,3.92,0,0,1,.16.36C138.8,109.15,138.85,109.28,138.89,109.41Z'/%3e%3c/g%3e%3cpath%20class='cls-19'%20d='M150.39,70.52c0,.81,0,1.62-.06,2.42-1.2,22.48-18.93,40.38-40.56,40.38A38.65,38.65,0,0,1,92.09,109a39.91,39.91,0,0,1-6.77-4.37A43.51,43.51,0,0,1,69.22,73q-.06-1.2-.06-2.43a7,7,0,0,1,14,0c0,15.94,11.94,28.9,26.61,28.9s26.62-13,26.62-28.9a7,7,0,0,1,14,0Z'/%3e%3cg%20class='cls-20'%3e%3cpath%20class='cls-4'%20d='M150.39,70.52c0,23.6-18.22,42.8-40.62,42.8A38.65,38.65,0,0,1,92.09,109a39.91,39.91,0,0,1-6.77-4.37A43.57,43.57,0,0,1,69.16,70.52a6.15,6.15,0,0,1,.06-.87,43.51,43.51,0,0,0,16.1,31.72,39.91,39.91,0,0,0,6.77,4.37A38.65,38.65,0,0,0,109.77,110c21.63,0,39.36-17.9,40.56-40.38A6.4,6.4,0,0,1,150.39,70.52Z'/%3e%3c/g%3e%3cpath%20class='cls-19'%20d='M130,107.62l-4,27.87c-.89,5.4-5.06,9.31-9.92,9.31H103.48c-4.86,0-9-3.91-9.92-9.31l-3.73-25.83-.29-2Z'/%3e%3cg%20class='cls-20'%3e%3cpath%20class='cls-4'%20d='M130,107.62v.09l-.66,4.52L126,135.49c-.89,5.4-5.06,9.31-9.92,9.31h-2.25c4.86,0,9-3.91,9.92-9.31l2.4-16.65,1.62-11.22Z'/%3e%3c/g%3e%3cpath%20class='cls-21'%20d='M124.17,90.48a14.62,14.62,0,1,1-29.24,0,13.53,13.53,0,0,1,.12-1.81,14.61,14.61,0,0,1,29,0A13.53,13.53,0,0,1,124.17,90.48Z'/%3e%3cpath%20class='cls-22'%20d='M123.71,87.23a13.53,13.53,0,0,1-.12,1.81,14.1,14.1,0,0,0-28.08,0,15.43,15.43,0,0,1-.11-1.81,14.16,14.16,0,1,1,28.31,0Z'/%3e%3cellipse%20class='cls-23'%20cx='109.55'%20cy='88.67'%20rx='14.5'%20ry='12.81'/%3e%3cpath%20class='cls-9'%20d='M106.6,90.18V88.44h.46l0,.17a.86.86,0,0,1,.27-.14,1,1,0,0,1,.34-.07.66.66,0,0,1,.5.17.64.64,0,0,1,.16.49v1.12h-.49V89.09a.34.34,0,0,0-.08-.25s-.13-.07-.26-.07a.48.48,0,0,0-.23,0,.53.53,0,0,0-.19.13v1.23Z'/%3e%3cpath%20class='cls-9'%20d='M105.52,90.22a1.09,1.09,0,0,1-.72-.23.87.87,0,0,1-.26-.68.92.92,0,0,1,.22-.66.87.87,0,0,1,.66-.25.85.85,0,0,1,.62.22.75.75,0,0,1,.22.55v.31H105a.39.39,0,0,0,.19.29,1,1,0,0,0,.43.08,1.27,1.27,0,0,0,.28,0,1.09,1.09,0,0,0,.25-.07v.36a1.58,1.58,0,0,1-.28.08A1.9,1.9,0,0,1,105.52,90.22Zm-.52-1h.82v-.1a.32.32,0,0,0-.08-.23.41.41,0,0,0-.3-.09.49.49,0,0,0-.35.1A.47.47,0,0,0,105,89.18Z'/%3e%3cpath%20class='cls-9'%20d='M102.45,91V88.44h.43l0,.16a.72.72,0,0,1,.24-.14.83.83,0,0,1,.32-.06.79.79,0,0,1,.59.21.94.94,0,0,1,.21.68,1,1,0,0,1-.22.7.82.82,0,0,1-.61.23.86.86,0,0,1-.49-.14V91Zm.87-1.12a.39.39,0,0,0,.33-.13.65.65,0,0,0,.12-.43.62.62,0,0,0-.11-.4.39.39,0,0,0-.33-.12.49.49,0,0,0-.38.16v.79l.16.1A.66.66,0,0,0,103.32,89.85Z'/%3e%3cpath%20class='cls-9'%20d='M101,90.22c-.77,0-1.15-.41-1.15-1.21a1.31,1.31,0,0,1,.29-.94,1.18,1.18,0,0,1,.86-.29,1.19,1.19,0,0,1,.86.29,1.31,1.31,0,0,1,.29.94C102.11,89.81,101.72,90.22,101,90.22Zm0-.43a.6.6,0,0,0,.49-.19,1,1,0,0,0,.15-.59,1,1,0,0,0-.15-.62.6.6,0,0,0-.49-.19.57.57,0,0,0-.49.19.91.91,0,0,0-.16.62.89.89,0,0,0,.16.59A.57.57,0,0,0,101,89.79Z'/%3e%3cpath%20class='cls-9'%20d='M118.66,90.18V88.44h.27l0,.2a.92.92,0,0,1,.29-.17,1.13,1.13,0,0,1,.39-.07.55.55,0,0,1,.63.64v1.14H120V89.05a.39.39,0,0,0-.1-.31.49.49,0,0,0-.35-.09.73.73,0,0,0-.3.06.6.6,0,0,0-.25.16v1.31Z'/%3e%3cpath%20class='cls-9'%20d='M117.29,90.18l-.68-1.74h.31l.54,1.46.54-1.46h.31l-.68,1.74Z'/%3e%3cpath%20class='cls-9'%20d='M116,90.18v-.25h.28v.25Z'/%3e%3cpath%20class='cls-9'%20d='M113.94,91V88.44h.25l0,.18a.8.8,0,0,1,.26-.16.9.9,0,0,1,.34-.06.78.78,0,0,1,.58.21.9.9,0,0,1,.21.67,1,1,0,0,1-.21.7.74.74,0,0,1-.58.24,1,1,0,0,1-.58-.17V91Zm.8-1a.53.53,0,0,0,.43-.16.84.84,0,0,0,.14-.53.74.74,0,0,0-.13-.48.56.56,0,0,0-.44-.15.59.59,0,0,0-.27,0,.46.46,0,0,0-.23.16v.94a.57.57,0,0,0,.21.13A.88.88,0,0,0,114.74,90Z'/%3e%3cpath%20class='cls-9'%20d='M112.49,90.22a.73.73,0,0,1-.3-.06A.58.58,0,0,1,112,90a.56.56,0,0,1,.08-.68.71.71,0,0,1,.51-.15h.61V89a.62.62,0,0,0,0-.22.28.28,0,0,0-.15-.13,1.19,1.19,0,0,0-.31,0l-.3,0-.28.07V88.5a1.63,1.63,0,0,1,.28-.07,1.79,1.79,0,0,1,.34,0,.89.89,0,0,1,.56.15.61.61,0,0,1,.18.49v1.14h-.25l0-.2a.75.75,0,0,1-.28.18A1.16,1.16,0,0,1,112.49,90.22Zm.08-.25a.74.74,0,0,0,.34-.07.72.72,0,0,0,.25-.18v-.34h-.6a.42.42,0,0,0-.29.08.29.29,0,0,0-.09.23.23.23,0,0,0,.1.22A.6.6,0,0,0,112.57,90Z'/%3e%3cpath%20class='cls-9'%20d='M109.2,90.18V87.82h.32l.8,1.64.8-1.64h.32v2.36h-.3V88.29l-.72,1.48h-.2l-.73-1.48v1.89Z'/%3e%3c/g%3e%3c/g%3e%3c/svg%3e";var II={exports:{}},Kre=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Jre=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],l8=function(e){var n=e,i=e.indexOf("["),r=e.indexOf("]");i!=-1&&r!=-1&&(e=e.substring(0,i)+e.substring(i,r).replace(/:/g,";")+e.substring(r,e.length));for(var a=Kre.exec(e||""),u={},l=14;l--;)u[Jre[l]]=a[l]||"";return i!=-1&&r!=-1&&(u.source=n,u.host=u.host.substring(1,u.host.length-1).replace(/;/g,":"),u.authority=u.authority.replace("[","").replace("]","").replace(/;/g,":"),u.ipv6uri=!0),u},RI={exports:{}},LI={exports:{}},ex=1e3,tx=ex*60,nx=tx*60,ix=nx*24,Qre=ix*365.25,ese=function(t,e){return e=e||{},typeof t=="string"?tse(t):e.long?ise(t):nse(t)};function tse(t){if(t=""+t,!(t.length>1e4)){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(e){var n=parseFloat(e[1]),i=(e[2]||"ms").toLowerCase();switch(i){case"years":case"year":case"yrs":case"yr":case"y":return n*Qre;case"days":case"day":case"d":return n*ix;case"hours":case"hour":case"hrs":case"hr":case"h":return n*nx;case"minutes":case"minute":case"mins":case"min":case"m":return n*tx;case"seconds":case"second":case"secs":case"sec":case"s":return n*ex;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n}}}}function nse(t){return t>=ix?Math.round(t/ix)+"d":t>=nx?Math.round(t/nx)+"h":t>=tx?Math.round(t/tx)+"m":t>=ex?Math.round(t/ex)+"s":t+"ms"}function ise(t){return l2(t,ix,"day")||l2(t,nx,"hour")||l2(t,tx,"minute")||l2(t,ex,"second")||t+" ms"}function l2(t,e,n){if(!(t<e))return t<e*1.5?Math.floor(t/e)+" "+n:Math.ceil(t/e)+" "+n+"s"}(function(t,e){e=t.exports=a,e.coerce=g,e.disable=l,e.enable=u,e.enabled=f,e.humanize=ese,e.names=[],e.skips=[],e.formatters={};var n=0,i;function r(){return e.colors[n++%e.colors.length]}function a(y){function S(){}S.enabled=!1;function b(){var I=b,D=+new Date,L=D-(i||D);I.diff=L,I.prev=i,I.curr=D,i=D,I.useColors==null&&(I.useColors=e.useColors()),I.color==null&&I.useColors&&(I.color=r());var P=Array.prototype.slice.call(arguments);P[0]=e.coerce(P[0]),typeof P[0]!="string"&&(P=["%o"].concat(P));var N=0;P[0]=P[0].replace(/%([a-z%])/g,function($,K){if($==="%%")return $;N++;var q=e.formatters[K];if(typeof q=="function"){var W=P[N];$=q.call(I,W),P.splice(N,1),N--}return $}),typeof e.formatArgs=="function"&&(P=e.formatArgs.apply(I,P));var B=b.log||e.log||console.log.bind(console);B.apply(I,P)}b.enabled=!0;var A=e.enabled(y)?b:S;return A.namespace=y,A}function u(y){e.save(y);for(var S=(y||"").split(/[\s,]+/),b=S.length,A=0;A<b;A++)S[A]&&(y=S[A].replace(/\*/g,".*?"),y[0]==="-"?e.skips.push(new RegExp("^"+y.substr(1)+"$")):e.names.push(new RegExp("^"+y+"$")))}function l(){e.enable("")}function f(y){var S,b;for(S=0,b=e.skips.length;S<b;S++)if(e.skips[S].test(y))return!1;for(S=0,b=e.names.length;S<b;S++)if(e.names[S].test(y))return!0;return!1}function g(y){return y instanceof Error?y.stack||y.message:y}})(LI,LI.exports);var rse=LI.exports;(function(t,e){e=t.exports=rse,e.log=r,e.formatArgs=i,e.save=a,e.load=u,e.useColors=n,e.storage=typeof chrome<"u"&&typeof chrome.storage<"u"?chrome.storage.local:l(),e.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"];function n(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}e.formatters.j=function(f){return JSON.stringify(f)};function i(){var f=arguments,g=this.useColors;if(f[0]=(g?"%c":"")+this.namespace+(g?" %c":" ")+f[0]+(g?"%c ":" ")+"+"+e.humanize(this.diff),!g)return f;var y="color: "+this.color;f=[f[0],y,"color: inherit"].concat(Array.prototype.slice.call(f,1));var S=0,b=0;return f[0].replace(/%[a-z%]/g,function(A){A!=="%%"&&(S++,A==="%c"&&(b=S))}),f.splice(b,0,y),f}function r(){return typeof console=="object"&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function a(f){try{f==null?e.storage.removeItem("debug"):e.storage.debug=f}catch{}}function u(){var f;try{f=e.storage.debug}catch{}return f}e.enable(u());function l(){try{return window.localStorage}catch{}}})(RI,RI.exports);var c2=RI.exports,sse=l8,c8=c2("socket.io-client:url"),ose=ase;function ase(t,i){var n=t,i=i||Dn.location;t==null&&(t=i.protocol+"//"+i.host),typeof t=="string"&&(t.charAt(0)=="/"&&(t.charAt(1)=="/"?t=i.protocol+t:t=i.host+t),/^(https?|wss?):\/\//.test(t)||(c8("protocol-less url %s",t),typeof i<"u"?t=i.protocol+"//"+t:t="https://"+t),c8("parse %s",t),n=sse(t)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";var r=n.host.indexOf(":")!==-1,a=r?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+a+":"+n.port,n.href=n.protocol+"://"+a+(i&&i.port==n.port?"":":"+n.port),n}var u2={},kI={exports:{}},DI={exports:{}},rx=1e3,sx=rx*60,ox=sx*60,ax=ox*24,lse=ax*365.25,cse=function(t,e){return e=e||{},typeof t=="string"?use(t):e.long?dse(t):hse(t)};function use(t){if(t=""+t,!(t.length>1e4)){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(e){var n=parseFloat(e[1]),i=(e[2]||"ms").toLowerCase();switch(i){case"years":case"year":case"yrs":case"yr":case"y":return n*lse;case"days":case"day":case"d":return n*ax;case"hours":case"hour":case"hrs":case"hr":case"h":return n*ox;case"minutes":case"minute":case"mins":case"min":case"m":return n*sx;case"seconds":case"second":case"secs":case"sec":case"s":return n*rx;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n}}}}function hse(t){return t>=ax?Math.round(t/ax)+"d":t>=ox?Math.round(t/ox)+"h":t>=sx?Math.round(t/sx)+"m":t>=rx?Math.round(t/rx)+"s":t+"ms"}function dse(t){return h2(t,ax,"day")||h2(t,ox,"hour")||h2(t,sx,"minute")||h2(t,rx,"second")||t+" ms"}function h2(t,e,n){if(!(t<e))return t<e*1.5?Math.floor(t/e)+" "+n:Math.ceil(t/e)+" "+n+"s"}(function(t,e){e=t.exports=a,e.coerce=g,e.disable=l,e.enable=u,e.enabled=f,e.humanize=cse,e.names=[],e.skips=[],e.formatters={};var n=0,i;function r(){return e.colors[n++%e.colors.length]}function a(y){function S(){}S.enabled=!1;function b(){var I=b,D=+new Date,L=D-(i||D);I.diff=L,I.prev=i,I.curr=D,i=D,I.useColors==null&&(I.useColors=e.useColors()),I.color==null&&I.useColors&&(I.color=r());var P=Array.prototype.slice.call(arguments);P[0]=e.coerce(P[0]),typeof P[0]!="string"&&(P=["%o"].concat(P));var N=0;P[0]=P[0].replace(/%([a-z%])/g,function($,K){if($==="%%")return $;N++;var q=e.formatters[K];if(typeof q=="function"){var W=P[N];$=q.call(I,W),P.splice(N,1),N--}return $}),typeof e.formatArgs=="function"&&(P=e.formatArgs.apply(I,P));var B=b.log||e.log||console.log.bind(console);B.apply(I,P)}b.enabled=!0;var A=e.enabled(y)?b:S;return A.namespace=y,A}function u(y){e.save(y);for(var S=(y||"").split(/[\s,]+/),b=S.length,A=0;A<b;A++)S[A]&&(y=S[A].replace(/\*/g,".*?"),y[0]==="-"?e.skips.push(new RegExp("^"+y.substr(1)+"$")):e.names.push(new RegExp("^"+y+"$")))}function l(){e.enable("")}function f(y){var S,b;for(S=0,b=e.skips.length;S<b;S++)if(e.skips[S].test(y))return!1;for(S=0,b=e.names.length;S<b;S++)if(e.names[S].test(y))return!0;return!1}function g(y){return y instanceof Error?y.stack||y.message:y}})(DI,DI.exports);var fse=DI.exports;(function(t,e){e=t.exports=fse,e.log=r,e.formatArgs=i,e.save=a,e.load=u,e.useColors=n,e.storage=typeof chrome<"u"&&typeof chrome.storage<"u"?chrome.storage.local:l(),e.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"];function n(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}e.formatters.j=function(f){return JSON.stringify(f)};function i(){var f=arguments,g=this.useColors;if(f[0]=(g?"%c":"")+this.namespace+(g?" %c":" ")+f[0]+(g?"%c ":" ")+"+"+e.humanize(this.diff),!g)return f;var y="color: "+this.color;f=[f[0],y,"color: inherit"].concat(Array.prototype.slice.call(f,1));var S=0,b=0;return f[0].replace(/%[a-z%]/g,function(A){A!=="%%"&&(S++,A==="%c"&&(b=S))}),f.splice(b,0,y),f}function r(){return typeof console=="object"&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function a(f){try{f==null?e.storage.removeItem("debug"):e.storage.debug=f}catch{}}function u(){var f;try{f=e.storage.debug}catch{}return f}e.enable(u());function l(){try{return window.localStorage}catch{}}})(kI,kI.exports);var pse=kI.exports,d2={exports:{}};/*! JSON v3.3.2 | http://bestiejs.github.io/json3 | Copyright 2012-2014, Kit Cambridge | http://kit.mit-license.org */d2.exports,function(t,e){(function(){var n={function:!0,object:!0},i=e&&!e.nodeType&&e,r=n[typeof window]&&window||this,a=i&&n.object&&t&&!t.nodeType&&typeof Dn=="object"&&Dn;a&&(a.global===a||a.window===a||a.self===a)&&(r=a);function u(S,b){S||(S=r.Object()),b||(b=r.Object());var A=S.Number||r.Number,I=S.String||r.String,D=S.Object||r.Object,L=S.Date||r.Date,P=S.SyntaxError||r.SyntaxError,N=S.TypeError||r.TypeError,B=S.Math||r.Math,$=S.JSON||r.JSON;typeof $=="object"&&$&&(b.stringify=$.stringify,b.parse=$.parse);var K=D.prototype,q=K.toString,W,ie,Z,X=new L(-0xc782b5b800cec);try{X=X.getUTCFullYear()==-109252&&X.getUTCMonth()===0&&X.getUTCDate()===1&&X.getUTCHours()==10&&X.getUTCMinutes()==37&&X.getUTCSeconds()==6&&X.getUTCMilliseconds()==708}catch{}function se(xt){if(se[xt]!==Z)return se[xt];var Pt;if(xt=="bug-string-char-index")Pt=!1;else if(xt=="json")Pt=se("json-stringify")&&se("json-parse");else{var mt,ve='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if(xt=="json-stringify"){var re=b.stringify,Xe=typeof re=="function"&&X;if(Xe){(mt=function(){return 1}).toJSON=mt;try{Xe=re(0)==="0"&&re(new A)==="0"&&re(new I)=='""'&&re(q)===Z&&re(Z)===Z&&re()===Z&&re(mt)==="1"&&re([mt])=="[1]"&&re([Z])=="[null]"&&re(null)=="null"&&re([Z,q,null])=="[null,null,null]"&&re({a:[mt,!0,!1,null,`\0\b
\f\r	`]})==ve&&re(null,mt)==="1"&&re([1,2],null,1)==`[
 1,
 2
]`&&re(new L(-864e13))=='"-271821-04-20T00:00:00.000Z"'&&re(new L(864e13))=='"+275760-09-13T00:00:00.000Z"'&&re(new L(-621987552e5))=='"-000001-01-01T00:00:00.000Z"'&&re(new L(-1))=='"1969-12-31T23:59:59.999Z"'}catch{Xe=!1}}Pt=Xe}if(xt=="json-parse"){var Ge=b.parse;if(typeof Ge=="function")try{if(Ge("0")===0&&!Ge(!1)){mt=Ge(ve);var st=mt.a.length==5&&mt.a[0]===1;if(st){try{st=!Ge('"	"')}catch{}if(st)try{st=Ge("01")!==1}catch{}if(st)try{st=Ge("1.")!==1}catch{}}}}catch{st=!1}Pt=st}}return se[xt]=!!Pt}if(!se("json")){var De="[object Function]",Se="[object Date]",Me="[object Number]",Ye="[object String]",ye="[object Array]",Ce="[object Boolean]",ge=se("bug-string-char-index");if(!X)var Be=B.floor,Ze=[0,31,59,90,120,151,181,212,243,273,304,334],je=function(xt,Pt){return Ze[Pt]+365*(xt-1970)+Be((xt-1969+(Pt=+(Pt>1)))/4)-Be((xt-1901+Pt)/100)+Be((xt-1601+Pt)/400)};if((W=K.hasOwnProperty)||(W=function(xt){var Pt={},mt;return(Pt.__proto__=null,Pt.__proto__={toString:1},Pt).toString!=q?W=function(ve){var re=this.__proto__,Xe=ve in(this.__proto__=null,this);return this.__proto__=re,Xe}:(mt=Pt.constructor,W=function(ve){var re=(this.constructor||mt).prototype;return ve in this&&!(ve in re&&this[ve]===re[ve])}),Pt=null,W.call(this,xt)}),ie=function(xt,Pt){var mt=0,ve,re,Xe;(ve=function(){this.valueOf=0}).prototype.valueOf=0,re=new ve;for(Xe in re)W.call(re,Xe)&&mt++;return ve=re=null,mt?mt==2?ie=function(Ge,st){var ft={},Ht=q.call(Ge)==De,$t;for($t in Ge)!(Ht&&$t=="prototype")&&!W.call(ft,$t)&&(ft[$t]=1)&&W.call(Ge,$t)&&st($t)}:ie=function(Ge,st){var ft=q.call(Ge)==De,Ht,$t;for(Ht in Ge)!(ft&&Ht=="prototype")&&W.call(Ge,Ht)&&!($t=Ht==="constructor")&&st(Ht);($t||W.call(Ge,Ht="constructor"))&&st(Ht)}:(re=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],ie=function(Ge,st){var ft=q.call(Ge)==De,Ht,$t,it=!ft&&typeof Ge.constructor!="function"&&n[typeof Ge.hasOwnProperty]&&Ge.hasOwnProperty||W;for(Ht in Ge)!(ft&&Ht=="prototype")&&it.call(Ge,Ht)&&st(Ht);for($t=re.length;Ht=re[--$t];it.call(Ge,Ht)&&st(Ht));}),ie(xt,Pt)},!se("json-stringify")){var wt={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},Xt="000000",Ke=function(xt,Pt){return(Xt+(Pt||0)).slice(-xt)},_t="\\u00",zt=function(xt){for(var Pt='"',mt=0,ve=xt.length,re=!ge||ve>10,Xe=re&&(ge?xt.split(""):xt);mt<ve;mt++){var Ge=xt.charCodeAt(mt);switch(Ge){case 8:case 9:case 10:case 12:case 13:case 34:case 92:Pt+=wt[Ge];break;default:if(Ge<32){Pt+=_t+Ke(2,Ge.toString(16));break}Pt+=re?Xe[mt]:xt.charAt(mt)}}return Pt+'"'},Rt=function(xt,Pt,mt,ve,re,Xe,Ge){var st,ft,Ht,$t,it,On,Nt,on,Wn,yt,Tt,Vt,kn,ii,Ne,Gt;try{st=Pt[xt]}catch{}if(typeof st=="object"&&st)if(ft=q.call(st),ft==Se&&!W.call(st,"toJSON"))if(st>-1/0&&st<1/0){if(je){for(it=Be(st/864e5),Ht=Be(it/365.2425)+1970-1;je(Ht+1,0)<=it;Ht++);for($t=Be((it-je(Ht,0))/30.42);je(Ht,$t+1)<=it;$t++);it=1+it-je(Ht,$t),On=(st%864e5+864e5)%864e5,Nt=Be(On/36e5)%24,on=Be(On/6e4)%60,Wn=Be(On/1e3)%60,yt=On%1e3}else Ht=st.getUTCFullYear(),$t=st.getUTCMonth(),it=st.getUTCDate(),Nt=st.getUTCHours(),on=st.getUTCMinutes(),Wn=st.getUTCSeconds(),yt=st.getUTCMilliseconds();st=(Ht<=0||Ht>=1e4?(Ht<0?"-":"+")+Ke(6,Ht<0?-Ht:Ht):Ke(4,Ht))+"-"+Ke(2,$t+1)+"-"+Ke(2,it)+"T"+Ke(2,Nt)+":"+Ke(2,on)+":"+Ke(2,Wn)+"."+Ke(3,yt)+"Z"}else st=null;else typeof st.toJSON=="function"&&(ft!=Me&&ft!=Ye&&ft!=ye||W.call(st,"toJSON"))&&(st=st.toJSON(xt));if(mt&&(st=mt.call(Pt,xt,st)),st===null)return"null";if(ft=q.call(st),ft==Ce)return""+st;if(ft==Me)return st>-1/0&&st<1/0?""+st:"null";if(ft==Ye)return zt(""+st);if(typeof st=="object"){for(ii=Ge.length;ii--;)if(Ge[ii]===st)throw N();if(Ge.push(st),Tt=[],Ne=Xe,Xe+=re,ft==ye){for(kn=0,ii=st.length;kn<ii;kn++)Vt=Rt(kn,st,mt,ve,re,Xe,Ge),Tt.push(Vt===Z?"null":Vt);Gt=Tt.length?re?`[
`+Xe+Tt.join(`,
`+Xe)+`
`+Ne+"]":"["+Tt.join(",")+"]":"[]"}else ie(ve||st,function(Et){var Ct=Rt(Et,st,mt,ve,re,Xe,Ge);Ct!==Z&&Tt.push(zt(Et)+":"+(re?" ":"")+Ct)}),Gt=Tt.length?re?`{
`+Xe+Tt.join(`,
`+Xe)+`
`+Ne+"}":"{"+Tt.join(",")+"}":"{}";return Ge.pop(),Gt}};b.stringify=function(xt,Pt,mt){var ve,re,Xe,Ge;if(n[typeof Pt]&&Pt){if((Ge=q.call(Pt))==De)re=Pt;else if(Ge==ye){Xe={};for(var st=0,ft=Pt.length,Ht;st<ft;Ht=Pt[st++],Ge=q.call(Ht),(Ge==Ye||Ge==Me)&&(Xe[Ht]=1));}}if(mt)if((Ge=q.call(mt))==Me){if((mt-=mt%1)>0)for(ve="",mt>10&&(mt=10);ve.length<mt;ve+=" ");}else Ge==Ye&&(ve=mt.length<=10?mt:mt.slice(0,10));return Rt("",(Ht={},Ht[""]=xt,Ht),re,Xe,ve,"",[])}}if(!se("json-parse")){var fn=I.fromCharCode,Mn={92:"\\",34:'"',47:"/",98:"\b",116:"	",110:`
`,102:"\f",114:"\r"},Bt,Kn,Re=function(){throw Bt=Kn=null,P()},Jn=function(){for(var xt=Kn,Pt=xt.length,mt,ve,re,Xe,Ge;Bt<Pt;)switch(Ge=xt.charCodeAt(Bt),Ge){case 9:case 10:case 13:case 32:Bt++;break;case 123:case 125:case 91:case 93:case 58:case 44:return mt=ge?xt.charAt(Bt):xt[Bt],Bt++,mt;case 34:for(mt="@",Bt++;Bt<Pt;)if(Ge=xt.charCodeAt(Bt),Ge<32)Re();else if(Ge==92)switch(Ge=xt.charCodeAt(++Bt),Ge){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:mt+=Mn[Ge],Bt++;break;case 117:for(ve=++Bt,re=Bt+4;Bt<re;Bt++)Ge=xt.charCodeAt(Bt),Ge>=48&&Ge<=57||Ge>=97&&Ge<=102||Ge>=65&&Ge<=70||Re();mt+=fn("0x"+xt.slice(ve,Bt));break;default:Re()}else{if(Ge==34)break;for(Ge=xt.charCodeAt(Bt),ve=Bt;Ge>=32&&Ge!=92&&Ge!=34;)Ge=xt.charCodeAt(++Bt);mt+=xt.slice(ve,Bt)}if(xt.charCodeAt(Bt)==34)return Bt++,mt;Re();default:if(ve=Bt,Ge==45&&(Xe=!0,Ge=xt.charCodeAt(++Bt)),Ge>=48&&Ge<=57){for(Ge==48&&(Ge=xt.charCodeAt(Bt+1),Ge>=48&&Ge<=57)&&Re(),Xe=!1;Bt<Pt&&(Ge=xt.charCodeAt(Bt),Ge>=48&&Ge<=57);Bt++);if(xt.charCodeAt(Bt)==46){for(re=++Bt;re<Pt&&(Ge=xt.charCodeAt(re),Ge>=48&&Ge<=57);re++);re==Bt&&Re(),Bt=re}if(Ge=xt.charCodeAt(Bt),Ge==101||Ge==69){for(Ge=xt.charCodeAt(++Bt),(Ge==43||Ge==45)&&Bt++,re=Bt;re<Pt&&(Ge=xt.charCodeAt(re),Ge>=48&&Ge<=57);re++);re==Bt&&Re(),Bt=re}return+xt.slice(ve,Bt)}if(Xe&&Re(),xt.slice(Bt,Bt+4)=="true")return Bt+=4,!0;if(xt.slice(Bt,Bt+5)=="false")return Bt+=5,!1;if(xt.slice(Bt,Bt+4)=="null")return Bt+=4,null;Re()}return"$"},Ln=function(xt){var Pt,mt;if(xt=="$"&&Re(),typeof xt=="string"){if((ge?xt.charAt(0):xt[0])=="@")return xt.slice(1);if(xt=="["){for(Pt=[];xt=Jn(),xt!="]";mt||(mt=!0))mt&&(xt==","?(xt=Jn(),xt=="]"&&Re()):Re()),xt==","&&Re(),Pt.push(Ln(xt));return Pt}else if(xt=="{"){for(Pt={};xt=Jn(),xt!="}";mt||(mt=!0))mt&&(xt==","?(xt=Jn(),xt=="}"&&Re()):Re()),(xt==","||typeof xt!="string"||(ge?xt.charAt(0):xt[0])!="@"||Jn()!=":")&&Re(),Pt[xt.slice(1)]=Ln(Jn());return Pt}Re()}return xt},Cn=function(xt,Pt,mt){var ve=Ue(xt,Pt,mt);ve===Z?delete xt[Pt]:xt[Pt]=ve},Ue=function(xt,Pt,mt){var ve=xt[Pt],re;if(typeof ve=="object"&&ve)if(q.call(ve)==ye)for(re=ve.length;re--;)Cn(ve,re,mt);else ie(ve,function(Xe){Cn(ve,Xe,mt)});return mt.call(xt,Pt,ve)};b.parse=function(xt,Pt){var mt,ve;return Bt=0,Kn=""+xt,mt=Ln(Jn()),Jn()!="$"&&Re(),Bt=Kn=null,Pt&&q.call(Pt)==De?Ue((ve={},ve[""]=mt,ve),"",Pt):mt}}}return b.runInContext=u,b}if(i)u(r,i);else{var l=r.JSON,f=r.JSON3,g=!1,y=u(r,r.JSON3={noConflict:function(){return g||(g=!0,r.JSON=l,r.JSON3=f,l=f=null),y}});r.JSON={parse:y.parse,stringify:y.stringify}}}).call(Dn)}(d2,d2.exports);var mse=d2.exports,OI=Array.isArray||function(t){return Object.prototype.toString.call(t)=="[object Array]"},f2=el;function el(t){if(t)return gse(t)}function gse(t){for(var e in el.prototype)t[e]=el.prototype[e];return t}el.prototype.on=el.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks[t]=this._callbacks[t]||[]).push(e),this},el.prototype.once=function(t,e){var n=this;this._callbacks=this._callbacks||{};function i(){n.off(t,i),e.apply(this,arguments)}return i.fn=e,this.on(t,i),this},el.prototype.off=el.prototype.removeListener=el.prototype.removeAllListeners=el.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var n=this._callbacks[t];if(!n)return this;if(arguments.length==1)return delete this._callbacks[t],this;for(var i,r=0;r<n.length;r++)if(i=n[r],i===e||i.fn===e){n.splice(r,1);break}return this},el.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),n=this._callbacks[t];if(n){n=n.slice(0);for(var i=0,r=n.length;i<r;++i)n[i].apply(this,e)}return this},el.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks[t]||[]},el.prototype.hasListeners=function(t){return!!this.listeners(t).length};var p2={},u8=vse;function vse(t){return Dn.Buffer&&Dn.Buffer.isBuffer(t)||Dn.ArrayBuffer&&t instanceof ArrayBuffer}var FI=OI,h8=u8;p2.deconstructPacket=function(t){var e=[],n=t.data;function i(a){if(!a)return a;if(h8(a)){var u={_placeholder:!0,num:e.length};return e.push(a),u}else if(FI(a)){for(var l=new Array(a.length),f=0;f<a.length;f++)l[f]=i(a[f]);return l}else if(typeof a=="object"&&!(a instanceof Date)){var l={};for(var g in a)l[g]=i(a[g]);return l}return a}var r=t;return r.data=i(n),r.attachments=e.length,{packet:r,buffers:e}},p2.reconstructPacket=function(t,e){function n(i){if(i&&i._placeholder){var r=e[i.num];return r}else if(FI(i)){for(var a=0;a<i.length;a++)i[a]=n(i[a]);return i}else if(i&&typeof i=="object"){for(var u in i)i[u]=n(i[u]);return i}return i}return t.data=n(t.data),t.attachments=void 0,t},p2.removeBlobs=function(t,e){function n(a,u,l){if(!a)return a;if(Dn.Blob&&a instanceof Blob||Dn.File&&a instanceof File){i++;var f=new FileReader;f.onload=function(){l?l[u]=this.result:r=this.result,--i||e(r)},f.readAsArrayBuffer(a)}else if(FI(a))for(var g=0;g<a.length;g++)n(a[g],g,a);else if(a&&typeof a=="object"&&!h8(a))for(var y in a)n(a[y],y,a)}var i=0,r=t;n(r),i||e(r)},function(t){var e=pse("socket.io-parser"),n=mse,i=f2,r=p2,a=u8;t.protocol=4,t.types=["CONNECT","DISCONNECT","EVENT","BINARY_EVENT","ACK","BINARY_ACK","ERROR"],t.CONNECT=0,t.DISCONNECT=1,t.EVENT=2,t.ACK=3,t.ERROR=4,t.BINARY_EVENT=5,t.BINARY_ACK=6,t.Encoder=u,t.Decoder=g;function u(){}u.prototype.encode=function(A,I){if(e("encoding packet %j",A),t.BINARY_EVENT==A.type||t.BINARY_ACK==A.type)f(A,I);else{var D=l(A);I([D])}};function l(A){var I="",D=!1;return I+=A.type,(t.BINARY_EVENT==A.type||t.BINARY_ACK==A.type)&&(I+=A.attachments,I+="-"),A.nsp&&A.nsp!="/"&&(D=!0,I+=A.nsp),A.id!=null&&(D&&(I+=",",D=!1),I+=A.id),A.data!=null&&(D&&(I+=","),I+=n.stringify(A.data)),e("encoded %j as %s",A,I),I}function f(A,I){function D(L){var P=r.deconstructPacket(L),N=l(P.packet),B=P.buffers;B.unshift(N),I(B)}r.removeBlobs(A,D)}function g(){this.reconstructor=null}i(g.prototype),g.prototype.add=function(A){var I;if(typeof A=="string")I=y(A),t.BINARY_EVENT==I.type||t.BINARY_ACK==I.type?(this.reconstructor=new S(I),this.reconstructor.reconPack.attachments===0&&this.emit("decoded",I)):this.emit("decoded",I);else if(a(A)||A.base64)if(this.reconstructor)I=this.reconstructor.takeBinaryData(A),I&&(this.reconstructor=null,this.emit("decoded",I));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+A)};function y(A){var I={},D=0;if(I.type=Number(A.charAt(0)),t.types[I.type]==null)return b();if(t.BINARY_EVENT==I.type||t.BINARY_ACK==I.type){for(var L="";A.charAt(++D)!="-"&&(L+=A.charAt(D),D!=A.length););if(L!=Number(L)||A.charAt(D)!="-")throw new Error("Illegal attachments");I.attachments=Number(L)}if(A.charAt(D+1)=="/")for(I.nsp="";++D;){var P=A.charAt(D);if(P==","||(I.nsp+=P,D==A.length))break}else I.nsp="/";var N=A.charAt(D+1);if(N!==""&&Number(N)==N){for(I.id="";++D;){var P=A.charAt(D);if(P==null||Number(P)!=P){--D;break}if(I.id+=A.charAt(D),D==A.length)break}I.id=Number(I.id)}if(A.charAt(++D))try{I.data=n.parse(A.substr(D))}catch{return b()}return e("decoded %s as %j",A,I),I}g.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()};function S(A){this.reconPack=A,this.buffers=[]}S.prototype.takeBinaryData=function(A){if(this.buffers.push(A),this.buffers.length==this.reconPack.attachments){var I=r.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),I}return null},S.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]};function b(A){return{type:t.ERROR,data:"parser error"}}}(u2);var zI={exports:{}},m2={},NI={exports:{}};try{NI.exports=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{NI.exports=!1}var yse=NI.exports,_se=yse,BI=function(t){var e=t.xdomain,n=t.xscheme,i=t.enablesXDR;try{if(typeof XMLHttpRequest<"u"&&(!e||_se))return new XMLHttpRequest}catch{}try{if(typeof XDomainRequest<"u"&&!n&&i)return new XDomainRequest}catch{}if(!e)try{return new ActiveXObject("Microsoft.XMLHTTP")}catch{}},UI={exports:{}},Fp={},xse=Object.keys||function(e){var n=[],i=Object.prototype.hasOwnProperty;for(var r in e)i.call(e,r)&&n.push(r);return n},bse=OI,wse=Sse;function Sse(t){function e(n){if(!n)return!1;if(Dn.Buffer&&Dn.Buffer.isBuffer(n)||Dn.ArrayBuffer&&n instanceof ArrayBuffer||Dn.Blob&&n instanceof Blob||Dn.File&&n instanceof File)return!0;if(bse(n)){for(var i=0;i<n.length;i++)if(e(n[i]))return!0}else if(n&&typeof n=="object"){n.toJSON&&(n=n.toJSON());for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)&&e(n[r]))return!0}return!1}return e(t)}var Ese=function(t,e,n){var i=t.byteLength;if(e=e||0,n=n||i,t.slice)return t.slice(e,n);if(e<0&&(e+=i),n<0&&(n+=i),n>i&&(n=i),e>=i||e>=n||i===0)return new ArrayBuffer(0);for(var r=new Uint8Array(t),a=new Uint8Array(n-e),u=e,l=0;u<n;u++,l++)a[l]=r[u];return a.buffer},VI={};(function(t){VI.encode=function(e){var n=new Uint8Array(e),i,r=n.length,a="";for(i=0;i<r;i+=3)a+=t[n[i]>>2],a+=t[(n[i]&3)<<4|n[i+1]>>4],a+=t[(n[i+1]&15)<<2|n[i+2]>>6],a+=t[n[i+2]&63];return r%3===2?a=a.substring(0,a.length-1)+"=":r%3===1&&(a=a.substring(0,a.length-2)+"=="),a},VI.decode=function(e){var n=e.length*.75,i=e.length,r,a=0,u,l,f,g;e[e.length-1]==="="&&(n--,e[e.length-2]==="="&&n--);var y=new ArrayBuffer(n),S=new Uint8Array(y);for(r=0;r<i;r+=4)u=t.indexOf(e[r]),l=t.indexOf(e[r+1]),f=t.indexOf(e[r+2]),g=t.indexOf(e[r+3]),S[a++]=u<<2|l>>4,S[a++]=(l&15)<<4|f>>2,S[a++]=(f&3)<<6|g&63;return y}})("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/");var Mse=Cse;function Cse(t,e,n){var i=!1;return n=n||Tse,r.count=t,t===0?e():r;function r(a,u){if(r.count<=0)throw new Error("after called too many times");--r.count,a?(i=!0,e(a),e=n):r.count===0&&!i&&e(null,u)}}function Tse(){}var g2={exports:{}};/*! https://mths.be/utf8js v2.0.0 by @mathias */g2.exports,function(t,e){(function(n){var i=e,r=t&&t.exports==i&&t,a=typeof Dn=="object"&&Dn;(a.global===a||a.window===a)&&(n=a);var u=String.fromCharCode;function l(W){for(var ie=[],Z=0,X=W.length,se,De;Z<X;)se=W.charCodeAt(Z++),se>=55296&&se<=56319&&Z<X?(De=W.charCodeAt(Z++),(De&64512)==56320?ie.push(((se&1023)<<10)+(De&1023)+65536):(ie.push(se),Z--)):ie.push(se);return ie}function f(W){for(var ie=W.length,Z=-1,X,se="";++Z<ie;)X=W[Z],X>65535&&(X-=65536,se+=u(X>>>10&1023|55296),X=56320|X&1023),se+=u(X);return se}function g(W){if(W>=55296&&W<=57343)throw Error("Lone surrogate U+"+W.toString(16).toUpperCase()+" is not a scalar value")}function y(W,ie){return u(W>>ie&63|128)}function S(W){if(!(W&4294967168))return u(W);var ie="";return W&4294965248?W&4294901760?W&4292870144||(ie=u(W>>18&7|240),ie+=y(W,12),ie+=y(W,6)):(g(W),ie=u(W>>12&15|224),ie+=y(W,6)):ie=u(W>>6&31|192),ie+=u(W&63|128),ie}function b(W){for(var ie=l(W),Z=ie.length,X=-1,se,De="";++X<Z;)se=ie[X],De+=S(se);return De}function A(){if(P>=L)throw Error("Invalid byte index");var W=D[P]&255;if(P++,(W&192)==128)return W&63;throw Error("Invalid continuation byte")}function I(){var W,ie,Z,X,se;if(P>L)throw Error("Invalid byte index");if(P==L)return!1;if(W=D[P]&255,P++,!(W&128))return W;if((W&224)==192){var ie=A();if(se=(W&31)<<6|ie,se>=128)return se;throw Error("Invalid continuation byte")}if((W&240)==224){if(ie=A(),Z=A(),se=(W&15)<<12|ie<<6|Z,se>=2048)return g(se),se;throw Error("Invalid continuation byte")}if((W&248)==240&&(ie=A(),Z=A(),X=A(),se=(W&15)<<18|ie<<12|Z<<6|X,se>=65536&&se<=1114111))return se;throw Error("Invalid UTF-8 detected")}var D,L,P;function N(W){D=l(W),L=D.length,P=0;for(var ie=[],Z;(Z=I())!==!1;)ie.push(Z);return f(ie)}var B={version:"2.0.0",encode:b,decode:N};if(i&&!i.nodeType)if(r)r.exports=B;else{var $={},K=$.hasOwnProperty;for(var q in B)K.call(B,q)&&(i[q]=B[q])}else n.utf8=B})(Dn)}(g2,g2.exports);var Ase=g2.exports,$I,d8;function Pse(){if(d8)return $I;d8=1;var t=Dn.BlobBuilder||Dn.WebKitBlobBuilder||Dn.MSBlobBuilder||Dn.MozBlobBuilder,e=function(){try{var l=new Blob(["hi"]);return l.size===2}catch{return!1}}(),n=e&&function(){try{var l=new Blob([new Uint8Array([1,2])]);return l.size===2}catch{return!1}}(),i=t&&t.prototype.append&&t.prototype.getBlob;function r(l){for(var f=0;f<l.length;f++){var g=l[f];if(g.buffer instanceof ArrayBuffer){var y=g.buffer;if(g.byteLength!==y.byteLength){var S=new Uint8Array(g.byteLength);S.set(new Uint8Array(y,g.byteOffset,g.byteLength)),y=S.buffer}l[f]=y}}}function a(l,f){f=f||{};var g=new t;r(l);for(var y=0;y<l.length;y++)g.append(l[y]);return f.type?g.getBlob(f.type):g.getBlob()}function u(l,f){return r(l),new Blob(l,f||{})}return $I=function(){return e?n?Dn.Blob:u:i?a:void 0}(),$I}(function(t){var e=xse,n=wse,i=Ese,r=VI,a=Mse,u=Ase,l=navigator.userAgent.match(/Android/i),f=/PhantomJS/i.test(navigator.userAgent),g=l||f;t.protocol=3;var y=t.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},S=e(y),b={type:"error",data:"parser error"},A=Pse();t.encodePacket=function(B,$,K,q){typeof $=="function"&&(q=$,$=!1),typeof K=="function"&&(q=K,K=null);var W=B.data===void 0?void 0:B.data.buffer||B.data;if(Dn.ArrayBuffer&&W instanceof ArrayBuffer)return D(B,$,q);if(A&&W instanceof Dn.Blob)return P(B,$,q);if(W&&W.base64)return I(B,q);var ie=y[B.type];return B.data!==void 0&&(ie+=K?u.encode(String(B.data)):String(B.data)),q(""+ie)};function I(B,$){var K="b"+t.packets[B.type]+B.data.data;return $(K)}function D(B,$,K){if(!$)return t.encodeBase64Packet(B,K);var q=B.data,W=new Uint8Array(q),ie=new Uint8Array(1+q.byteLength);ie[0]=y[B.type];for(var Z=0;Z<W.length;Z++)ie[Z+1]=W[Z];return K(ie.buffer)}function L(B,$,K){if(!$)return t.encodeBase64Packet(B,K);var q=new FileReader;return q.onload=function(){B.data=q.result,t.encodePacket(B,$,!0,K)},q.readAsArrayBuffer(B.data)}function P(B,$,K){if(!$)return t.encodeBase64Packet(B,K);if(g)return L(B,$,K);var q=new Uint8Array(1);q[0]=y[B.type];var W=new A([q.buffer,B.data]);return K(W)}t.encodeBase64Packet=function(B,$){var K="b"+t.packets[B.type];if(A&&B.data instanceof Dn.Blob){var q=new FileReader;return q.onload=function(){var se=q.result.split(",")[1];$(K+se)},q.readAsDataURL(B.data)}var W;try{W=String.fromCharCode.apply(null,new Uint8Array(B.data))}catch{for(var ie=new Uint8Array(B.data),Z=new Array(ie.length),X=0;X<ie.length;X++)Z[X]=ie[X];W=String.fromCharCode.apply(null,Z)}return K+=Dn.btoa(W),$(K)},t.decodePacket=function(B,$,K){if(typeof B=="string"||B===void 0){if(B.charAt(0)=="b")return t.decodeBase64Packet(B.substr(1),$);if(K)try{B=u.decode(B)}catch{return b}var W=B.charAt(0);return Number(W)!=W||!S[W]?b:B.length>1?{type:S[W],data:B.substring(1)}:{type:S[W]}}var q=new Uint8Array(B),W=q[0],ie=i(B,1);return A&&$==="blob"&&(ie=new A([ie])),{type:S[W],data:ie}},t.decodeBase64Packet=function(B,$){var K=S[B.charAt(0)];if(!Dn.ArrayBuffer)return{type:K,data:{base64:!0,data:B.substr(1)}};var q=r.decode(B.substr(1));return $==="blob"&&A&&(q=new A([q])),{type:K,data:q}},t.encodePayload=function(B,$,K){typeof $=="function"&&(K=$,$=null);var q=n(B);if($&&q)return A&&!g?t.encodePayloadAsBlob(B,K):t.encodePayloadAsArrayBuffer(B,K);if(!B.length)return K("0:");function W(Z){return Z.length+":"+Z}function ie(Z,X){t.encodePacket(Z,q?$:!1,!0,function(se){X(null,W(se))})}N(B,ie,function(Z,X){return K(X.join(""))})};function N(B,$,K){for(var q=new Array(B.length),W=a(B.length,K),ie=function(X,se,De){$(se,function(Se,Me){q[X]=Me,De(Se,q)})},Z=0;Z<B.length;Z++)ie(Z,B[Z],W)}t.decodePayload=function(B,$,K){if(typeof B!="string")return t.decodePayloadAsBinary(B,$,K);typeof $=="function"&&(K=$,$=null);var q;if(B=="")return K(b,0,1);for(var W="",ie,Z,X=0,se=B.length;X<se;X++){var De=B.charAt(X);if(De!=":")W+=De;else{if(W==""||W!=(ie=Number(W))||(Z=B.substr(X+1,ie),W!=Z.length))return K(b,0,1);if(Z.length){if(q=t.decodePacket(Z,$,!0),b.type==q.type&&b.data==q.data)return K(b,0,1);var Se=K(q,X+ie,se);if(Se===!1)return}X+=ie,W=""}}if(W!="")return K(b,0,1)},t.encodePayloadAsArrayBuffer=function(B,$){if(!B.length)return $(new ArrayBuffer(0));function K(q,W){t.encodePacket(q,!0,!0,function(ie){return W(null,ie)})}N(B,K,function(q,W){var ie=W.reduce(function(se,De){var Se;return typeof De=="string"?Se=De.length:Se=De.byteLength,se+Se.toString().length+Se+2},0),Z=new Uint8Array(ie),X=0;return W.forEach(function(se){var De=typeof se=="string",Se=se;if(De){for(var ye=new Uint8Array(se.length),Me=0;Me<se.length;Me++)ye[Me]=se.charCodeAt(Me);Se=ye.buffer}De?Z[X++]=0:Z[X++]=1;for(var Ye=Se.byteLength.toString(),Me=0;Me<Ye.length;Me++)Z[X++]=parseInt(Ye[Me]);Z[X++]=255;for(var ye=new Uint8Array(Se),Me=0;Me<ye.length;Me++)Z[X++]=ye[Me]}),$(Z.buffer)})},t.encodePayloadAsBlob=function(B,$){function K(q,W){t.encodePacket(q,!0,!0,function(ie){var Z=new Uint8Array(1);if(Z[0]=1,typeof ie=="string"){for(var X=new Uint8Array(ie.length),se=0;se<ie.length;se++)X[se]=ie.charCodeAt(se);ie=X.buffer,Z[0]=0}for(var De=ie instanceof ArrayBuffer?ie.byteLength:ie.size,Se=De.toString(),Me=new Uint8Array(Se.length+1),se=0;se<Se.length;se++)Me[se]=parseInt(Se[se]);if(Me[Se.length]=255,A){var Ye=new A([Z.buffer,Me.buffer,ie]);W(null,Ye)}})}N(B,K,function(q,W){return $(new A(W))})},t.decodePayloadAsBinary=function(B,$,K){typeof $=="function"&&(K=$,$=null);for(var q=B,W=[],ie=!1;q.byteLength>0;){for(var Z=new Uint8Array(q),X=Z[0]===0,se="",De=1;Z[De]!=255;De++){if(se.length>310){ie=!0;break}se+=Z[De]}if(ie)return K(b,0,1);q=i(q,2+se.length),se=parseInt(se);var Se=i(q,0,se);if(X)try{Se=String.fromCharCode.apply(null,new Uint8Array(Se))}catch{var Me=new Uint8Array(Se);Se="";for(var De=0;De<Me.length;De++)Se+=String.fromCharCode(Me[De])}W.push(Se),q=i(q,se)}var Ye=W.length;W.forEach(function(ye,Ce){K(t.decodePacket(ye,$,!0),Ce,Ye)})}})(Fp);var HI,f8;function GI(){if(f8)return HI;f8=1;var t=Fp,e=f2;HI=n;function n(i){this.path=i.path,this.hostname=i.hostname,this.port=i.port,this.secure=i.secure,this.query=i.query,this.timestampParam=i.timestampParam,this.timestampRequests=i.timestampRequests,this.readyState="",this.agent=i.agent||!1,this.socket=i.socket,this.enablesXDR=i.enablesXDR,this.pfx=i.pfx,this.key=i.key,this.passphrase=i.passphrase,this.cert=i.cert,this.ca=i.ca,this.ciphers=i.ciphers,this.rejectUnauthorized=i.rejectUnauthorized,this.extraHeaders=i.extraHeaders}return e(n.prototype),n.prototype.onError=function(i,r){var a=new Error(i);return a.type="TransportError",a.description=r,this.emit("error",a),this},n.prototype.open=function(){return(this.readyState=="closed"||this.readyState=="")&&(this.readyState="opening",this.doOpen()),this},n.prototype.close=function(){return(this.readyState=="opening"||this.readyState=="open")&&(this.doClose(),this.onClose()),this},n.prototype.send=function(i){if(this.readyState=="open")this.write(i);else throw new Error("Transport not open")},n.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},n.prototype.onData=function(i){var r=t.decodePacket(i,this.socket.binaryType);this.onPacket(r)},n.prototype.onPacket=function(i){this.emit("packet",i)},n.prototype.onClose=function(){this.readyState="closed",this.emit("close")},HI}var lx={};lx.encode=function(t){var e="";for(var n in t)t.hasOwnProperty(n)&&(e.length&&(e+="&"),e+=encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e},lx.decode=function(t){for(var e={},n=t.split("&"),i=0,r=n.length;i<r;i++){var a=n[i].split("=");e[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}return e};var v2=function(t,e){var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t},p8="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),y2=64,m8={},g8=0,nf=0,v8;function WI(t){var e="";do e=p8[t%y2]+e,t=Math.floor(t/y2);while(t>0);return e}function Ise(t){var e=0;for(nf=0;nf<t.length;nf++)e=e*y2+m8[t.charAt(nf)];return e}function jI(){var t=WI(+new Date);return t!==v8?(g8=0,v8=t):t+"."+WI(g8++)}for(;nf<y2;nf++)m8[p8[nf]]=nf;jI.encode=WI,jI.decode=Ise;var y8=jI,qI={exports:{}},XI={exports:{}},cx=1e3,ux=cx*60,hx=ux*60,dx=hx*24,Rse=dx*365.25,Lse=function(t,e){return e=e||{},typeof t=="string"?kse(t):e.long?Ose(t):Dse(t)};function kse(t){if(t=""+t,!(t.length>1e4)){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(e){var n=parseFloat(e[1]),i=(e[2]||"ms").toLowerCase();switch(i){case"years":case"year":case"yrs":case"yr":case"y":return n*Rse;case"days":case"day":case"d":return n*dx;case"hours":case"hour":case"hrs":case"hr":case"h":return n*hx;case"minutes":case"minute":case"mins":case"min":case"m":return n*ux;case"seconds":case"second":case"secs":case"sec":case"s":return n*cx;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n}}}}function Dse(t){return t>=dx?Math.round(t/dx)+"d":t>=hx?Math.round(t/hx)+"h":t>=ux?Math.round(t/ux)+"m":t>=cx?Math.round(t/cx)+"s":t+"ms"}function Ose(t){return _2(t,dx,"day")||_2(t,hx,"hour")||_2(t,ux,"minute")||_2(t,cx,"second")||t+" ms"}function _2(t,e,n){if(!(t<e))return t<e*1.5?Math.floor(t/e)+" "+n:Math.ceil(t/e)+" "+n+"s"}(function(t,e){e=t.exports=a,e.coerce=g,e.disable=l,e.enable=u,e.enabled=f,e.humanize=Lse,e.names=[],e.skips=[],e.formatters={};var n=0,i;function r(){return e.colors[n++%e.colors.length]}function a(y){function S(){}S.enabled=!1;function b(){var I=b,D=+new Date,L=D-(i||D);I.diff=L,I.prev=i,I.curr=D,i=D,I.useColors==null&&(I.useColors=e.useColors()),I.color==null&&I.useColors&&(I.color=r());var P=Array.prototype.slice.call(arguments);P[0]=e.coerce(P[0]),typeof P[0]!="string"&&(P=["%o"].concat(P));var N=0;P[0]=P[0].replace(/%([a-z%])/g,function($,K){if($==="%%")return $;N++;var q=e.formatters[K];if(typeof q=="function"){var W=P[N];$=q.call(I,W),P.splice(N,1),N--}return $}),typeof e.formatArgs=="function"&&(P=e.formatArgs.apply(I,P));var B=b.log||e.log||console.log.bind(console);B.apply(I,P)}b.enabled=!0;var A=e.enabled(y)?b:S;return A.namespace=y,A}function u(y){e.save(y);for(var S=(y||"").split(/[\s,]+/),b=S.length,A=0;A<b;A++)S[A]&&(y=S[A].replace(/\*/g,".*?"),y[0]==="-"?e.skips.push(new RegExp("^"+y.substr(1)+"$")):e.names.push(new RegExp("^"+y+"$")))}function l(){e.enable("")}function f(y){var S,b;for(S=0,b=e.skips.length;S<b;S++)if(e.skips[S].test(y))return!1;for(S=0,b=e.names.length;S<b;S++)if(e.names[S].test(y))return!0;return!1}function g(y){return y instanceof Error?y.stack||y.message:y}})(XI,XI.exports);var Fse=XI.exports;(function(t,e){e=t.exports=Fse,e.log=r,e.formatArgs=i,e.save=a,e.load=u,e.useColors=n,e.storage=typeof chrome<"u"&&typeof chrome.storage<"u"?chrome.storage.local:l(),e.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"];function n(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}e.formatters.j=function(f){return JSON.stringify(f)};function i(){var f=arguments,g=this.useColors;if(f[0]=(g?"%c":"")+this.namespace+(g?" %c":" ")+f[0]+(g?"%c ":" ")+"+"+e.humanize(this.diff),!g)return f;var y="color: "+this.color;f=[f[0],y,"color: inherit"].concat(Array.prototype.slice.call(f,1));var S=0,b=0;return f[0].replace(/%[a-z%]/g,function(A){A!=="%%"&&(S++,A==="%c"&&(b=S))}),f.splice(b,0,y),f}function r(){return typeof console=="object"&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function a(f){try{f==null?e.storage.removeItem("debug"):e.storage.debug=f}catch{}}function u(){var f;try{f=e.storage.debug}catch{}return f}e.enable(u());function l(){try{return window.localStorage}catch{}}})(qI,qI.exports);var x2=qI.exports,_8=GI(),zse=lx,x8=Fp,Nse=v2,Bse=y8,Mc=x2("engine.io-client:polling"),b8=hu,Use=function(){var t=BI,e=new t({xdomain:!1});return e.responseType!=null}();function hu(t){var e=t&&t.forceBase64;(!Use||e)&&(this.supportsBinary=!1),_8.call(this,t)}Nse(hu,_8),hu.prototype.name="polling",hu.prototype.doOpen=function(){this.poll()},hu.prototype.pause=function(t){var e=this;this.readyState="pausing";function n(){Mc("paused"),e.readyState="paused",t()}if(this.polling||!this.writable){var i=0;this.polling&&(Mc("we are currently polling - waiting to pause"),i++,this.once("pollComplete",function(){Mc("pre-pause polling complete"),--i||n()})),this.writable||(Mc("we are currently writing - waiting to pause"),i++,this.once("drain",function(){Mc("pre-pause writing complete"),--i||n()}))}else n()},hu.prototype.poll=function(){Mc("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},hu.prototype.onData=function(t){var e=this;Mc("polling got data %s",t);var n=function(i,r,a){if(e.readyState=="opening"&&e.onOpen(),i.type=="close")return e.onClose(),!1;e.onPacket(i)};x8.decodePayload(t,this.socket.binaryType,n),this.readyState!="closed"&&(this.polling=!1,this.emit("pollComplete"),this.readyState=="open"?this.poll():Mc('ignoring poll - transport state "%s"',this.readyState))},hu.prototype.doClose=function(){var t=this;function e(){Mc("writing close packet"),t.write([{type:"close"}])}this.readyState=="open"?(Mc("transport open - closing"),e()):(Mc("transport not open - deferring close"),this.once("open",e))},hu.prototype.write=function(t){var n=this;this.writable=!1;var e=function(){n.writable=!0,n.emit("drain")},n=this;x8.encodePayload(t,this.supportsBinary,function(i){n.doWrite(i,e)})},hu.prototype.uri=function(){var t=this.query||{},e=this.secure?"https":"http",n="";this.timestampRequests!==!1&&(t[this.timestampParam]=Bse()),!this.supportsBinary&&!t.sid&&(t.b64=1),t=zse.encode(t),this.port&&(e=="https"&&this.port!=443||e=="http"&&this.port!=80)&&(n=":"+this.port),t.length&&(t="?"+t);var i=this.hostname.indexOf(":")!==-1;return e+"://"+(i?"["+this.hostname+"]":this.hostname)+n+this.path+t};var Vse=BI,w8=b8,$se=f2,Hse=v2,ZI=x2("engine.io-client:polling-xhr");UI.exports=Uv,UI.exports.Request=Ls;function S8(){}function Uv(t){if(w8.call(this,t),Dn.location){var e=location.protocol=="https:",n=location.port;n||(n=e?443:80),this.xd=t.hostname!=Dn.location.hostname||n!=t.port,this.xs=t.secure!=e}else this.extraHeaders=t.extraHeaders}Hse(Uv,w8),Uv.prototype.supportsBinary=!0,Uv.prototype.request=function(t){return t=t||{},t.uri=this.uri(),t.xd=this.xd,t.xs=this.xs,t.agent=this.agent||!1,t.supportsBinary=this.supportsBinary,t.enablesXDR=this.enablesXDR,t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized,t.extraHeaders=this.extraHeaders,new Ls(t)},Uv.prototype.doWrite=function(t,e){var n=typeof t!="string"&&t!==void 0,i=this.request({method:"POST",data:t,isBinary:n}),r=this;i.on("success",e),i.on("error",function(a){r.onError("xhr post error",a)}),this.sendXhr=i},Uv.prototype.doPoll=function(){ZI("xhr poll");var t=this.request(),e=this;t.on("data",function(n){e.onData(n)}),t.on("error",function(n){e.onError("xhr poll error",n)}),this.pollXhr=t};function Ls(t){this.method=t.method||"GET",this.uri=t.uri,this.xd=!!t.xd,this.xs=!!t.xs,this.async=t.async!==!1,this.data=t.data!=null?t.data:null,this.agent=t.agent,this.isBinary=t.isBinary,this.supportsBinary=t.supportsBinary,this.enablesXDR=t.enablesXDR,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.extraHeaders=t.extraHeaders,this.create()}$se(Ls.prototype),Ls.prototype.create=function(){var t={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized;var e=this.xhr=new Vse(t),n=this;try{ZI("xhr open %s: %s",this.method,this.uri),e.open(this.method,this.uri,this.async);try{if(this.extraHeaders){e.setDisableHeaderCheck(!0);for(var i in this.extraHeaders)this.extraHeaders.hasOwnProperty(i)&&e.setRequestHeader(i,this.extraHeaders[i])}}catch{}if(this.supportsBinary&&(e.responseType="arraybuffer"),this.method=="POST")try{this.isBinary?e.setRequestHeader("Content-type","application/octet-stream"):e.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}"withCredentials"in e&&(e.withCredentials=!0),this.hasXDR()?(e.onload=function(){n.onLoad()},e.onerror=function(){n.onError(e.responseText)}):e.onreadystatechange=function(){e.readyState==4&&(e.status==200||e.status==1223?n.onLoad():setTimeout(function(){n.onError(e.status)},0))},ZI("xhr data %s",this.data),e.send(this.data)}catch(r){setTimeout(function(){n.onError(r)},0);return}Dn.document&&(this.index=Ls.requestsCount++,Ls.requests[this.index]=this)},Ls.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},Ls.prototype.onData=function(t){this.emit("data",t),this.onSuccess()},Ls.prototype.onError=function(t){this.emit("error",t),this.cleanup(!0)},Ls.prototype.cleanup=function(t){if(!(typeof this.xhr>"u"||this.xhr===null)){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=S8:this.xhr.onreadystatechange=S8,t)try{this.xhr.abort()}catch{}Dn.document&&delete Ls.requests[this.index],this.xhr=null}},Ls.prototype.onLoad=function(){var t;try{var e;try{e=this.xhr.getResponseHeader("Content-Type").split(";")[0]}catch{}if(e==="application/octet-stream")t=this.xhr.response;else if(!this.supportsBinary)t=this.xhr.responseText;else try{t=String.fromCharCode.apply(null,new Uint8Array(this.xhr.response))}catch{for(var n=new Uint8Array(this.xhr.response),i=[],r=0,a=n.length;r<a;r++)i.push(n[r]);t=String.fromCharCode.apply(null,i)}}catch(u){this.onError(u)}t!=null&&this.onData(t)},Ls.prototype.hasXDR=function(){return typeof Dn.XDomainRequest<"u"&&!this.xs&&this.enablesXDR},Ls.prototype.abort=function(){this.cleanup()},Dn.document&&(Ls.requestsCount=0,Ls.requests={},Dn.attachEvent?Dn.attachEvent("onunload",E8):Dn.addEventListener&&Dn.addEventListener("beforeunload",E8,!1));function E8(){for(var t in Ls.requests)Ls.requests.hasOwnProperty(t)&&Ls.requests[t].abort()}var Gse=UI.exports,YI=b8,Wse=v2,jse=Vv,qse=/\n/g,Xse=/\\n/g,b2;function Zse(){}function Vv(t){YI.call(this,t),this.query=this.query||{},b2||(Dn.___eio||(Dn.___eio=[]),b2=Dn.___eio),this.index=b2.length;var e=this;b2.push(function(n){e.onData(n)}),this.query.j=this.index,Dn.document&&Dn.addEventListener&&Dn.addEventListener("beforeunload",function(){e.script&&(e.script.onerror=Zse)},!1)}Wse(Vv,YI),Vv.prototype.supportsBinary=!1,Vv.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),YI.prototype.doClose.call(this)},Vv.prototype.doPoll=function(){var t=this,e=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),e.async=!0,e.src=this.uri(),e.onerror=function(r){t.onError("jsonp poll error",r)};var n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(e,n):(document.head||document.body).appendChild(e),this.script=e;var i=typeof navigator<"u"&&/gecko/i.test(navigator.userAgent);i&&setTimeout(function(){var r=document.createElement("iframe");document.body.appendChild(r),document.body.removeChild(r)},100)},Vv.prototype.doWrite=function(t,e){var n=this;if(!this.form){var i=document.createElement("form"),r=document.createElement("textarea"),a=this.iframeId="eio_iframe_"+this.index,u;i.className="socketio",i.style.position="absolute",i.style.top="-1000px",i.style.left="-1000px",i.target=a,i.method="POST",i.setAttribute("accept-charset","utf-8"),r.name="d",i.appendChild(r),document.body.appendChild(i),this.form=i,this.area=r}this.form.action=this.uri();function l(){f(),e()}function f(){if(n.iframe)try{n.form.removeChild(n.iframe)}catch(y){n.onError("jsonp polling iframe removal error",y)}try{var g='<iframe src="javascript:0" name="'+n.iframeId+'">';u=document.createElement(g)}catch{u=document.createElement("iframe"),u.name=n.iframeId,u.src="javascript:0"}u.id=n.iframeId,n.form.appendChild(u),n.iframe=u}f(),t=t.replace(Xse,`\\
`),this.area.value=t.replace(qse,"\\n");try{this.form.submit()}catch{}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){n.iframe.readyState=="complete"&&l()}:this.iframe.onload=l};const Yse=pj(Object.freeze(Object.defineProperty({__proto__:null,default:{}},Symbol.toStringTag,{value:"Module"})));var w2=GI(),Kse=Fp,Jse=lx,Qse=v2,eoe=y8,toe=x2("engine.io-client:websocket"),S2=Dn.WebSocket||Dn.MozWebSocket,E2=S2||(typeof window<"u"?null:Yse),noe=tl;function tl(t){var e=t&&t.forceBase64;e&&(this.supportsBinary=!1),this.perMessageDeflate=t.perMessageDeflate,w2.call(this,t)}Qse(tl,w2),tl.prototype.name="websocket",tl.prototype.supportsBinary=!0,tl.prototype.doOpen=function(){if(this.check()){var t=this.uri(),e=void 0,n={agent:this.agent,perMessageDeflate:this.perMessageDeflate};n.pfx=this.pfx,n.key=this.key,n.passphrase=this.passphrase,n.cert=this.cert,n.ca=this.ca,n.ciphers=this.ciphers,n.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(n.headers=this.extraHeaders),this.ws=S2?new E2(t):new E2(t,e,n),this.ws.binaryType===void 0&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="buffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},tl.prototype.addEventListeners=function(){var t=this;this.ws.onopen=function(){t.onOpen()},this.ws.onclose=function(){t.onClose()},this.ws.onmessage=function(e){t.onData(e.data)},this.ws.onerror=function(e){t.onError("websocket error",e)}},typeof navigator<"u"&&/iPad|iPhone|iPod/i.test(navigator.userAgent)&&(tl.prototype.onData=function(t){var e=this;setTimeout(function(){w2.prototype.onData.call(e,t)},0)}),tl.prototype.write=function(t){var e=this;this.writable=!1;for(var n=t.length,i=0,r=n;i<r;i++)(function(u){Kse.encodePacket(u,e.supportsBinary,function(l){if(!S2){var f={};if(u.options&&(f.compress=u.options.compress),e.perMessageDeflate){var g=typeof l=="string"?Dn.Buffer.byteLength(l):l.length;g<e.perMessageDeflate.threshold&&(f.compress=!1)}}try{S2?e.ws.send(l):e.ws.send(l,f)}catch{toe("websocket closed before onclose event")}--n||a()})})(t[i]);function a(){e.emit("flush"),setTimeout(function(){e.writable=!0,e.emit("drain")},0)}},tl.prototype.onClose=function(){w2.prototype.onClose.call(this)},tl.prototype.doClose=function(){typeof this.ws<"u"&&this.ws.close()},tl.prototype.uri=function(){var t=this.query||{},e=this.secure?"wss":"ws",n="";this.port&&(e=="wss"&&this.port!=443||e=="ws"&&this.port!=80)&&(n=":"+this.port),this.timestampRequests&&(t[this.timestampParam]=eoe()),this.supportsBinary||(t.b64=1),t=Jse.encode(t),t.length&&(t="?"+t);var i=this.hostname.indexOf(":")!==-1;return e+"://"+(i?"["+this.hostname+"]":this.hostname)+n+this.path+t},tl.prototype.check=function(){return!!E2&&!("__initialize"in E2&&this.name===tl.prototype.name)};var ioe=BI,roe=Gse,soe=jse,ooe=noe;m2.polling=aoe,m2.websocket=ooe;function aoe(t){var e,n=!1,i=!1,r=t.jsonp!==!1;if(Dn.location){var a=location.protocol=="https:",u=location.port;u||(u=a?443:80),n=t.hostname!=location.hostname||u!=t.port,i=t.secure!=a}if(t.xdomain=n,t.xscheme=i,e=new ioe(t),"open"in e&&!t.forceJSONP)return new roe(t);if(!r)throw new Error("JSONP disabled");return new soe(t)}var loe=[].indexOf,M8=function(t,e){if(loe)return t.indexOf(e);for(var n=0;n<t.length;++n)if(t[n]===e)return n;return-1},coe=/^[\],:{}\s]*$/,uoe=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,hoe=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,doe=/(?:^|:|,)(?:\s*\[)+/g,foe=/^\s+/,poe=/\s+$/,moe=function(e){if(typeof e!="string"||!e)return null;if(e=e.replace(foe,"").replace(poe,""),Dn.JSON&&JSON.parse)return JSON.parse(e);if(coe.test(e.replace(uoe,"@").replace(hoe,"]").replace(doe,"")))return new Function("return "+e)()},goe=m2,voe=f2,gs=x2("engine.io-client:socket"),yoe=M8,C8=Fp,T8=l8,_oe=moe,xoe=lx,boe=ki;function ki(t,e){if(!(this instanceof ki))return new ki(t,e);e=e||{},t&&typeof t=="object"&&(e=t,t=null),t?(t=T8(t),e.hostname=t.host,e.secure=t.protocol=="https"||t.protocol=="wss",e.port=t.port,t.query&&(e.query=t.query)):e.host&&(e.hostname=T8(e.host).host),this.secure=e.secure!=null?e.secure:Dn.location&&location.protocol=="https:",e.hostname&&!e.port&&(e.port=this.secure?"443":"80"),this.agent=e.agent||!1,this.hostname=e.hostname||(Dn.location?location.hostname:"localhost"),this.port=e.port||(Dn.location&&location.port?location.port:this.secure?443:80),this.query=e.query||{},typeof this.query=="string"&&(this.query=xoe.decode(this.query)),this.upgrade=e.upgrade!==!1,this.path=(e.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!e.forceJSONP,this.jsonp=e.jsonp!==!1,this.forceBase64=!!e.forceBase64,this.enablesXDR=!!e.enablesXDR,this.timestampParam=e.timestampParam||"t",this.timestampRequests=e.timestampRequests,this.transports=e.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.policyPort=e.policyPort||843,this.rememberUpgrade=e.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=e.onlyBinaryUpgrades,this.perMessageDeflate=e.perMessageDeflate!==!1?e.perMessageDeflate||{}:!1,this.perMessageDeflate===!0&&(this.perMessageDeflate={}),this.perMessageDeflate&&this.perMessageDeflate.threshold==null&&(this.perMessageDeflate.threshold=1024),this.pfx=e.pfx||null,this.key=e.key||null,this.passphrase=e.passphrase||null,this.cert=e.cert||null,this.ca=e.ca||null,this.ciphers=e.ciphers||null,this.rejectUnauthorized=e.rejectUnauthorized===void 0?null:e.rejectUnauthorized;var n=typeof Dn=="object"&&Dn;n.global===n&&e.extraHeaders&&Object.keys(e.extraHeaders).length>0&&(this.extraHeaders=e.extraHeaders),this.open()}ki.priorWebsocketSuccess=!1,voe(ki.prototype),ki.protocol=C8.protocol,ki.Socket=ki,ki.Transport=GI(),ki.transports=m2,ki.parser=Fp,ki.prototype.createTransport=function(t){gs('creating transport "%s"',t);var e=woe(this.query);e.EIO=C8.protocol,e.transport=t,this.id&&(e.sid=this.id);var n=new goe[t]({agent:this.agent,hostname:this.hostname,port:this.port,secure:this.secure,path:this.path,query:e,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this,pfx:this.pfx,key:this.key,passphrase:this.passphrase,cert:this.cert,ca:this.ca,ciphers:this.ciphers,rejectUnauthorized:this.rejectUnauthorized,perMessageDeflate:this.perMessageDeflate,extraHeaders:this.extraHeaders});return n};function woe(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}ki.prototype.open=function(){var t;if(this.rememberUpgrade&&ki.priorWebsocketSuccess&&this.transports.indexOf("websocket")!=-1)t="websocket";else if(this.transports.length===0){var e=this;setTimeout(function(){e.emit("error","No transports available")},0);return}else t=this.transports[0];this.readyState="opening";try{t=this.createTransport(t)}catch{this.transports.shift(),this.open();return}t.open(),this.setTransport(t)},ki.prototype.setTransport=function(t){gs("setting transport %s",t.name);var e=this;this.transport&&(gs("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=t,t.on("drain",function(){e.onDrain()}).on("packet",function(n){e.onPacket(n)}).on("error",function(n){e.onError(n)}).on("close",function(){e.onClose("transport close")})},ki.prototype.probe=function(t){gs('probing transport "%s"',t);var e=this.createTransport(t,{probe:1}),n=!1,i=this;ki.priorWebsocketSuccess=!1;function r(){if(i.onlyBinaryUpgrades){var S=!this.supportsBinary&&i.transport.supportsBinary;n=n||S}n||(gs('probe transport "%s" opened',t),e.send([{type:"ping",data:"probe"}]),e.once("packet",function(b){if(!n)if(b.type=="pong"&&b.data=="probe"){if(gs('probe transport "%s" pong',t),i.upgrading=!0,i.emit("upgrading",e),!e)return;ki.priorWebsocketSuccess=e.name=="websocket",gs('pausing current transport "%s"',i.transport.name),i.transport.pause(function(){n||i.readyState!="closed"&&(gs("changing transport and sending upgrade packet"),y(),i.setTransport(e),e.send([{type:"upgrade"}]),i.emit("upgrade",e),e=null,i.upgrading=!1,i.flush())})}else{gs('probe transport "%s" failed',t);var A=new Error("probe error");A.transport=e.name,i.emit("upgradeError",A)}}))}function a(){n||(n=!0,y(),e.close(),e=null)}function u(S){var b=new Error("probe error: "+S);b.transport=e.name,a(),gs('probe transport "%s" failed because of error: %s',t,S),i.emit("upgradeError",b)}function l(){u("transport closed")}function f(){u("socket closed")}function g(S){e&&S.name!=e.name&&(gs('"%s" works - aborting "%s"',S.name,e.name),a())}function y(){e.removeListener("open",r),e.removeListener("error",u),e.removeListener("close",l),i.removeListener("close",f),i.removeListener("upgrading",g)}e.once("open",r),e.once("error",u),e.once("close",l),this.once("close",f),this.once("upgrading",g),e.open()},ki.prototype.onOpen=function(){if(gs("socket open"),this.readyState="open",ki.priorWebsocketSuccess=this.transport.name=="websocket",this.emit("open"),this.flush(),this.readyState=="open"&&this.upgrade&&this.transport.pause){gs("starting upgrade probes");for(var t=0,e=this.upgrades.length;t<e;t++)this.probe(this.upgrades[t])}},ki.prototype.onPacket=function(t){if(this.readyState=="opening"||this.readyState=="open")switch(gs('socket receive: type "%s", data "%s"',t.type,t.data),this.emit("packet",t),this.emit("heartbeat"),t.type){case"open":this.onHandshake(_oe(t.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var e=new Error("server error");e.code=t.data,this.onError(e);break;case"message":this.emit("data",t.data),this.emit("message",t.data);break}else gs('packet received with socket readyState "%s"',this.readyState)},ki.prototype.onHandshake=function(t){this.emit("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.onOpen(),this.readyState!="closed"&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},ki.prototype.onHeartbeat=function(t){clearTimeout(this.pingTimeoutTimer);var e=this;e.pingTimeoutTimer=setTimeout(function(){e.readyState!="closed"&&e.onClose("ping timeout")},t||e.pingInterval+e.pingTimeout)},ki.prototype.setPing=function(){var t=this;clearTimeout(t.pingIntervalTimer),t.pingIntervalTimer=setTimeout(function(){gs("writing ping packet - expecting pong within %sms",t.pingTimeout),t.ping(),t.onHeartbeat(t.pingTimeout)},t.pingInterval)},ki.prototype.ping=function(){var t=this;this.sendPacket("ping",function(){t.emit("ping")})},ki.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,this.writeBuffer.length===0?this.emit("drain"):this.flush()},ki.prototype.flush=function(){this.readyState!="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(gs("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},ki.prototype.write=ki.prototype.send=function(t,e,n){return this.sendPacket("message",t,e,n),this},ki.prototype.sendPacket=function(t,e,n,i){if(typeof e=="function"&&(i=e,e=void 0),typeof n=="function"&&(i=n,n=null),!(this.readyState=="closing"||this.readyState=="closed")){n=n||{},n.compress=n.compress!==!1;var r={type:t,data:e,options:n};this.emit("packetCreate",r),this.writeBuffer.push(r),i&&this.once("flush",i),this.flush()}},ki.prototype.close=function(){if(this.readyState=="opening"||this.readyState=="open"){this.readyState="closing";var t=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?i():e()}):this.upgrading?i():e()}function e(){t.onClose("forced close"),gs("socket closing - telling transport to close"),t.transport.close()}function n(){t.removeListener("upgrade",n),t.removeListener("upgradeError",n),e()}function i(){t.once("upgrade",n),t.once("upgradeError",n)}return this},ki.prototype.onError=function(t){gs("socket error %j",t),ki.priorWebsocketSuccess=!1,this.emit("error",t),this.onClose("transport error",t)},ki.prototype.onClose=function(t,e){if(this.readyState=="opening"||this.readyState=="open"||this.readyState=="closing"){gs('socket close with reason: "%s"',t);var n=this;clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",t,e),n.writeBuffer=[],n.prevBufferLen=0}},ki.prototype.filterUpgrades=function(t){for(var e=[],n=0,i=t.length;n<i;n++)~yoe(this.transports,t[n])&&e.push(t[n]);return e},zI.exports=boe,zI.exports.parser=Fp;var Soe=zI.exports,Eoe=Soe,A8={exports:{}},P8=nl;function nl(t){if(t)return Moe(t)}function Moe(t){for(var e in nl.prototype)t[e]=nl.prototype[e];return t}nl.prototype.on=nl.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},nl.prototype.once=function(t,e){function n(){this.off(t,n),e.apply(this,arguments)}return n.fn=e,this.on(t,n),this},nl.prototype.off=nl.prototype.removeListener=nl.prototype.removeAllListeners=nl.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var n=this._callbacks["$"+t];if(!n)return this;if(arguments.length==1)return delete this._callbacks["$"+t],this;for(var i,r=0;r<n.length;r++)if(i=n[r],i===e||i.fn===e){n.splice(r,1);break}return this},nl.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),n=this._callbacks["$"+t];if(n){n=n.slice(0);for(var i=0,r=n.length;i<r;++i)n[i].apply(this,e)}return this},nl.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},nl.prototype.hasListeners=function(t){return!!this.listeners(t).length};var Coe=Toe;function Toe(t,e){var n=[];e=e||0;for(var i=e||0;i<t.length;i++)n[i-e]=t[i];return n}var I8=Aoe;function Aoe(t,e,n){return t.on(e,n),{destroy:function(){t.removeListener(e,n)}}}var R8=[].slice,L8=function(t,e){if(typeof e=="string"&&(e=t[e]),typeof e!="function")throw new Error("bind() requires a function");var n=R8.call(arguments,2);return function(){return e.apply(t,n.concat(R8.call(arguments)))}},Poe=OI,Ioe=Roe;function Roe(t){function e(n){if(!n)return!1;if(Dn.Buffer&&Dn.Buffer.isBuffer&&Dn.Buffer.isBuffer(n)||Dn.ArrayBuffer&&n instanceof ArrayBuffer||Dn.Blob&&n instanceof Blob||Dn.File&&n instanceof File)return!0;if(Poe(n)){for(var i=0;i<n.length;i++)if(e(n[i]))return!0}else if(n&&typeof n=="object"){n.toJSON&&typeof n.toJSON=="function"&&(n=n.toJSON());for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)&&e(n[r]))return!0}return!1}return e(t)}(function(t,e){var n=u2,i=P8,r=Coe,a=I8,u=L8,l=c2("socket.io-client:socket"),f=Ioe;t.exports=S;var g={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},y=i.prototype.emit;function S(b,A){this.io=b,this.nsp=A,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.io.autoConnect&&this.open()}i(S.prototype),S.prototype.subEvents=function(){if(!this.subs){var b=this.io;this.subs=[a(b,"open",u(this,"onopen")),a(b,"packet",u(this,"onpacket")),a(b,"close",u(this,"onclose"))]}},S.prototype.open=S.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),this.io.readyState=="open"&&this.onopen(),this.emit("connecting"),this)},S.prototype.send=function(){var b=r(arguments);return b.unshift("message"),this.emit.apply(this,b),this},S.prototype.emit=function(b){if(g.hasOwnProperty(b))return y.apply(this,arguments),this;var A=r(arguments),I=n.EVENT;f(A)&&(I=n.BINARY_EVENT);var D={type:I,data:A};return D.options={},D.options.compress=!this.flags||this.flags.compress!==!1,typeof A[A.length-1]=="function"&&(l("emitting packet with ack id %d",this.ids),this.acks[this.ids]=A.pop(),D.id=this.ids++),this.connected?this.packet(D):this.sendBuffer.push(D),delete this.flags,this},S.prototype.packet=function(b){b.nsp=this.nsp,this.io.packet(b)},S.prototype.onopen=function(){l("transport is open - connecting"),this.nsp!="/"&&this.packet({type:n.CONNECT})},S.prototype.onclose=function(b){l("close (%s)",b),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",b)},S.prototype.onpacket=function(b){if(b.nsp==this.nsp)switch(b.type){case n.CONNECT:this.onconnect();break;case n.EVENT:this.onevent(b);break;case n.BINARY_EVENT:this.onevent(b);break;case n.ACK:this.onack(b);break;case n.BINARY_ACK:this.onack(b);break;case n.DISCONNECT:this.ondisconnect();break;case n.ERROR:this.emit("error",b.data);break}},S.prototype.onevent=function(b){var A=b.data||[];l("emitting event %j",A),b.id!=null&&(l("attaching ack callback to event"),A.push(this.ack(b.id))),this.connected?y.apply(this,A):this.receiveBuffer.push(A)},S.prototype.ack=function(b){var A=this,I=!1;return function(){if(!I){I=!0;var D=r(arguments);l("sending ack %j",D);var L=f(D)?n.BINARY_ACK:n.ACK;A.packet({type:L,id:b,data:D})}}},S.prototype.onack=function(b){var A=this.acks[b.id];typeof A=="function"?(l("calling ack %s with %j",b.id,b.data),A.apply(this,b.data),delete this.acks[b.id]):l("bad ack %s",b.id)},S.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},S.prototype.emitBuffered=function(){var b;for(b=0;b<this.receiveBuffer.length;b++)y.apply(this,this.receiveBuffer[b]);for(this.receiveBuffer=[],b=0;b<this.sendBuffer.length;b++)this.packet(this.sendBuffer[b]);this.sendBuffer=[]},S.prototype.ondisconnect=function(){l("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},S.prototype.destroy=function(){if(this.subs){for(var b=0;b<this.subs.length;b++)this.subs[b].destroy();this.subs=null}this.io.destroy(this)},S.prototype.close=S.prototype.disconnect=function(){return this.connected&&(l("performing disconnect (%s)",this.nsp),this.packet({type:n.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},S.prototype.compress=function(b){return this.flags=this.flags||{},this.flags.compress=b,this}})(A8);var k8=A8.exports,Loe=$v;function $v(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}$v.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),n=Math.floor(e*this.jitter*t);t=Math.floor(e*10)&1?t+n:t-n}return Math.min(t,this.max)|0},$v.prototype.reset=function(){this.attempts=0},$v.prototype.setMin=function(t){this.ms=t},$v.prototype.setMax=function(t){this.max=t},$v.prototype.setJitter=function(t){this.jitter=t};var koe=Eoe,Doe=k8,Ooe=P8,D8=u2,rf=I8,Hv=L8,Ro=c2("socket.io-client:manager"),O8=M8,Foe=Loe,F8=Object.prototype.hasOwnProperty,z8=Ji;function Ji(t,e){if(!(this instanceof Ji))return new Ji(t,e);t&&typeof t=="object"&&(e=t,t=void 0),e=e||{},e.path=e.path||"/socket.io",this.nsps={},this.subs=[],this.opts=e,this.reconnection(e.reconnection!==!1),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor(e.randomizationFactor||.5),this.backoff=new Foe({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(e.timeout==null?2e4:e.timeout),this.readyState="closed",this.uri=t,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[],this.encoder=new D8.Encoder,this.decoder=new D8.Decoder,this.autoConnect=e.autoConnect!==!1,this.autoConnect&&this.open()}Ji.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var t in this.nsps)F8.call(this.nsps,t)&&this.nsps[t].emit.apply(this.nsps[t],arguments)},Ji.prototype.updateSocketIds=function(){for(var t in this.nsps)F8.call(this.nsps,t)&&(this.nsps[t].id=this.engine.id)},Ooe(Ji.prototype),Ji.prototype.reconnection=function(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection},Ji.prototype.reconnectionAttempts=function(t){return arguments.length?(this._reconnectionAttempts=t,this):this._reconnectionAttempts},Ji.prototype.reconnectionDelay=function(t){return arguments.length?(this._reconnectionDelay=t,this.backoff&&this.backoff.setMin(t),this):this._reconnectionDelay},Ji.prototype.randomizationFactor=function(t){return arguments.length?(this._randomizationFactor=t,this.backoff&&this.backoff.setJitter(t),this):this._randomizationFactor},Ji.prototype.reconnectionDelayMax=function(t){return arguments.length?(this._reconnectionDelayMax=t,this.backoff&&this.backoff.setMax(t),this):this._reconnectionDelayMax},Ji.prototype.timeout=function(t){return arguments.length?(this._timeout=t,this):this._timeout},Ji.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()},Ji.prototype.open=Ji.prototype.connect=function(t){if(Ro("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;Ro("opening %s",this.uri),this.engine=koe(this.uri,this.opts);var e=this.engine,n=this;this.readyState="opening",this.skipReconnect=!1;var i=rf(e,"open",function(){n.onopen(),t&&t()}),r=rf(e,"error",function(l){if(Ro("connect_error"),n.cleanup(),n.readyState="closed",n.emitAll("connect_error",l),t){var f=new Error("Connection error");f.data=l,t(f)}else n.maybeReconnectOnOpen()});if(this._timeout!==!1){var a=this._timeout;Ro("connect attempt will timeout after %d",a);var u=setTimeout(function(){Ro("connect attempt timed out after %d",a),i.destroy(),e.close(),e.emit("error","timeout"),n.emitAll("connect_timeout",a)},a);this.subs.push({destroy:function(){clearTimeout(u)}})}return this.subs.push(i),this.subs.push(r),this},Ji.prototype.onopen=function(){Ro("open"),this.cleanup(),this.readyState="open",this.emit("open");var t=this.engine;this.subs.push(rf(t,"data",Hv(this,"ondata"))),this.subs.push(rf(t,"ping",Hv(this,"onping"))),this.subs.push(rf(t,"pong",Hv(this,"onpong"))),this.subs.push(rf(t,"error",Hv(this,"onerror"))),this.subs.push(rf(t,"close",Hv(this,"onclose"))),this.subs.push(rf(this.decoder,"decoded",Hv(this,"ondecoded")))},Ji.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},Ji.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},Ji.prototype.ondata=function(t){this.decoder.add(t)},Ji.prototype.ondecoded=function(t){this.emit("packet",t)},Ji.prototype.onerror=function(t){Ro("error",t),this.emitAll("error",t)},Ji.prototype.socket=function(t){var e=this.nsps[t];if(!e){e=new Doe(this,t),this.nsps[t]=e;var n=this;e.on("connecting",i),e.on("connect",function(){e.id=n.engine.id}),this.autoConnect&&i()}function i(){~O8(n.connecting,e)||n.connecting.push(e)}return e},Ji.prototype.destroy=function(t){var e=O8(this.connecting,t);~e&&this.connecting.splice(e,1),!this.connecting.length&&this.close()},Ji.prototype.packet=function(t){Ro("writing packet %j",t);var e=this;e.encoding?e.packetBuffer.push(t):(e.encoding=!0,this.encoder.encode(t,function(n){for(var i=0;i<n.length;i++)e.engine.write(n[i],t.options);e.encoding=!1,e.processPacketQueue()}))},Ji.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var t=this.packetBuffer.shift();this.packet(t)}},Ji.prototype.cleanup=function(){Ro("cleanup");for(var t;t=this.subs.shift();)t.destroy();this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},Ji.prototype.close=Ji.prototype.disconnect=function(){Ro("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,this.readyState=="opening"&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},Ji.prototype.onclose=function(t){Ro("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",t),this._reconnection&&!this.skipReconnect&&this.reconnect()},Ji.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var t=this;if(this.backoff.attempts>=this._reconnectionAttempts)Ro("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var e=this.backoff.duration();Ro("will wait %dms before reconnect attempt",e),this.reconnecting=!0;var n=setTimeout(function(){t.skipReconnect||(Ro("attempting reconnect"),t.emitAll("reconnect_attempt",t.backoff.attempts),t.emitAll("reconnecting",t.backoff.attempts),!t.skipReconnect&&t.open(function(i){i?(Ro("reconnect attempt error"),t.reconnecting=!1,t.reconnect(),t.emitAll("reconnect_error",i.data)):(Ro("reconnect success"),t.onreconnect())}))},e);this.subs.push({destroy:function(){clearTimeout(n)}})}},Ji.prototype.onreconnect=function(){var t=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",t)},function(t,e){var n=ose,i=u2,r=z8,a=c2("socket.io-client");t.exports=e=l;var u=e.managers={};function l(f,g){typeof f=="object"&&(g=f,f=void 0),g=g||{};var y=n(f),S=y.source,b=y.id,A=y.path,I=u[b]&&A in u[b].nsps,D=g.forceNew||g["force new connection"]||g.multiplex===!1||I,L;return D?(a("ignoring socket cache for %s",S),L=r(S,g)):(u[b]||(a("new io instance for %s",S),u[b]=r(S,g)),L=u[b]),L.socket(y.path)}e.protocol=i.protocol,e.connect=l,e.Manager=z8,e.Socket=k8}(II,II.exports);var zoe=II.exports;class Noe extends da{constructor(e,n){super(e,{}),this.plugin=n}}class KI extends sp{constructor(n,i){super(n,i);yn(this,"component");yn(this,"hoveredStateId");yn(this,"map");this.showVehicle=!0,this.data=[],this.oldData=[],this.interval=null,this.sourceId="vehicle-tracking",this.layerId="vehicle-tracking-layer",this.motoImageId="motorcycle",this.secondForReload=10,this.iconWidth=48,this.component=new Noe(this.viewer,this)}init(){this.map=this.viewer.getPlugin(tf).getMap(),this.map.once("load",()=>{const n=new Image(this.iconWidth,this.iconWidth);n.onload=()=>this.map.addImage(this.motoImageId,n),n.src=Yre,this.map.addSource(this.sourceId,{type:"geojson",data:{type:"FeatureCollection",features:[]}}),this.map.addLayer({id:this.layerId,type:"symbol",source:this.sourceId,paint:{"text-color":"#fff","text-halo-color":"#202","text-halo-width":2},layout:{"text-allow-overlap":!0,"text-ignore-placement":!0,"icon-allow-overlap":!0,"icon-ignore-placement":!0,"icon-image":["get","category"],"icon-rotate":["get","course"],"text-field":["get","license_plates"],"text-size":10,"text-font":["Open Sans Semibold","Arial Unicode MS Bold"],"text-offset":[0,1.25],"text-anchor":"top"}}),this.initSocket()})}initSocket(){var r,a,u;const n=zoe.io(`${qU}?apiKey=${((r=this.config)==null?void 0:r.apiKey)||((u=(a=this.viewer)==null?void 0:a._config)==null?void 0:u.apiKey)}`,{connected:!1,loading:!0,socketId:"connecting..",server:qU,config:{path:"/socket.io",forceNew:!0,reconnectionAttempts:3,timeout:2e3},errors:[],reconnection:!1}),i=()=>{window.timeoutReconect&&clearTimeout(window.timeoutReconect),window.timeoutReconect=setTimeout(()=>{n.io.open(l=>{l&&i()})},2e3)};n.io.on("close",i),n.on("tracking",l=>{this.oldData=[...this.data],this.data=l,this.refreshVehicle()}),n.on("connection",()=>{console.log("Socket Connected!")}),n.on("connect_error",l=>{console.log("SOCKET error: ",l)}),this.fetchData()}fetchData(){var n,i,r;this.showVehicle&&fetch(`${Mre}?apiKey=${((n=this.config)==null?void 0:n.apiKey)||((r=(i=this.viewer)==null?void 0:i._config)==null?void 0:r.apiKey)}`).then(a=>a.json()).then(a=>{this.oldData=[...this.data],this.data=a,this.refreshVehicle()}).catch(()=>{})}refreshVehicle(){this.showVehicle?(this.map.setLayoutProperty(this.layerId,"visibility","visible"),this.animateVehicle()):(clearInterval(this.interval),this.map.setLayoutProperty(this.layerId,"visibility","none"))}setSourceData(n){this.map.getSource(this.sourceId).setData({type:"FeatureCollection",features:n.map(i=>({type:"Feature",geometry:{type:"Point",coordinates:[i.lng,i.lat]},properties:i}))})}animateVehicle(){let n=!1,i;const r=a=>{i===void 0&&(i=a);const u=a-i;u>(this.secondForReload-1)*1e3&&(n=!0);const l=this.oldData.length?this.data.map((f,g)=>{const y=u/((this.secondForReload-1)*1e3),S=f.lat-this.oldData[g].lat,b=f.lng-this.oldData[g].lng,A=f.course-this.oldData[g].course;return{...f,course:this.oldData[g].course+y*A,lat:this.oldData[g].lat+y*S,lng:this.oldData[g].lng+y*b}}):this.data;this.setSourceData(l),n||window.requestAnimationFrame(r)};window.requestAnimationFrame(r)}setShowVehicle(n=!0){!this.showVehicle&&n&&this.init(),this.showVehicle=n,this.refreshVehicle()}}yn(KI,"id","vehicle"),yn(KI,"configParser",zn.getConfigParser({color:null,apiKey:null}));const Boe={baseUrl:"https://www.streetview.vn/loader_hd.png",width:1280,cols:2,rows:1,tileUrl:()=>null};class Uoe extends xg{constructor(n){n={navbar:!1,panorama:Boe,loadingImg:"https://www.streetview.vn/logo.svg",...n,lang:{zoom:"Thu phng",zoomOut:"Thu nh",zoomIn:"Phng to",moveUp:"Tin",moveDown:"Li",moveLeft:"Tri",moveRight:"Phi",description:"Chi tit",download:"Ti xung",fullscreen:"Ton mn hnh",loading:"ang ti...",menu:"Danh mc",close:"ng",twoFingers:"S dng 2 ngn tay  iu hng",ctrlZoom:"S dng Ctrl + scroll  thu phng nh",loadError:"Khng th ti hnh nh 360 lc ny",hintWheel:"Ko hoc vut",webglError:"Trnh duyt ca bn khng h tr WebGL",hintWheelMid:"Tri - Phi -Trn - Di",hintWheelBottom:" xem nh 360 ",...n.lang||{}}};super(n);yn(this,"_config");yn(this,"hintContainer");yn(this,"_logoContainer",null);yn(this,"addHintWheel",()=>{var u,l,f,g,y,S;this.hintContainer=document.createElement("div"),this.hintContainer.className="psv-hint__container";const n=document.createElement("div");n.className="psv-hint__content",n.innerHTML='<img class="psv-hint__icon" src="https://www.streetview.vn/Draggiff.gif" />';const i=document.createElement("div");i.className="psv-hint__text",i.id="psv-text__content-id",i.innerText=(l=(u=this._config)==null?void 0:u.lang)==null?void 0:l.hintWheel;const r=document.createElement("div");r.className="psv-hint__text_mid",r.id="psv-text__content-id-mid",r.innerText=(g=(f=this._config)==null?void 0:f.lang)==null?void 0:g.hintWheelMid;const a=document.createElement("div");a.className="psv-hint__text",a.id="psv-text__content-id-bottom",a.innerText=(S=(y=this._config)==null?void 0:y.lang)==null?void 0:S.hintWheelBottom,n.appendChild(i),n.appendChild(r),n.appendChild(a),this.hintContainer.appendChild(n),this.container.appendChild(this.hintContainer)});yn(this,"addCopyright",()=>{this._logoContainer=document.createElement("div"),this._logoContainer.className=`psv-logo__container ${pd.CAPTURE_EVENTS_CLASS}`,this.container.appendChild(this._logoContainer),this.renderCopyright(),window.addEventListener("resize",this.renderCopyright)});yn(this,"renderCopyright",()=>{if(!this._logoContainer)return;const n=Wr.t("Terms"),i=Wr.t("Privacy"),r=Wr.t("Disclaimer"),a=CU()?`
      <div class="logo-footer-right">
        <div class="logo-footer-right-text">
          <span class="copyright-text">
           2025 
             <a href="https://44plus.vn" target="_blank" rel="noopener noreferrer">44+ Technologies</a>
          </span> 
        </div>
      </div>
    `:`
      <div class="logo-footer-right">
        <div class="logo-footer-right-text">
          <span class="copyright-text">
           2025 
             <a href="https://44plus.vn" target="_blank" rel="noopener noreferrer">44+ Technologies</a> |
            <a href="https://enterprise.streetview.vn/terms-of-use" target="_blank" rel="noopener noreferrer">${n||"Terms"}</a> | 
            <a href="https://enterprise.streetview.vn/privacy-policy" target="_blank" rel="noopener noreferrer">${i||"Privacy"}</a> | 
            <a href="https://enterprise.streetview.vn/disclaimer" target="_blank" rel="noopener noreferrer">${r||"Disclaimer"}</a>
          </span> 
        </div>
      </div>
    `;this._logoContainer.innerHTML=a,this._logoContainer.addEventListener("click",this.logoOnClick)});yn(this,"logoOnClick",()=>{var r;const n=this.getPlugin(Sh);((r=n==null?void 0:n.getCurrentNode())==null?void 0:r.id)&&window.open("https://44plus.vn","_blank")});this._config=n,this.addEventListener(Pi.BeforeRotateEvent.type,this._onRollUpdated.bind(this)),this.addCopyright(),this.addHintWheel(),Wr.on("languageChanged",()=>{this.renderCopyright()})}_onRollUpdated(n){var i,r;this.hintContainer&&(this.container.removeChild(this.hintContainer),this.hintContainer=null),(i=this._config)!=null&&i.onChangePosition&&((r=this._config)==null||r.onChangePosition(n==null?void 0:n.position))}setHigherContrast(n){this.renderer.renderer.toneMapping=n?3:0,this.renderer.renderer.toneMappingExposure=n?2:1,this.needsUpdate()}setLang(n){var i,r,a,u,l,f;this._config.lang={...this._config.lang,...n},document.getElementById("psv-text__content-id").innerHTML=(r=(i=this._config)==null?void 0:i.lang)==null?void 0:r.hintWheel,document.getElementById("psv-text__content-id-mid").innerHTML=(u=(a=this._config)==null?void 0:a.lang)==null?void 0:u.hintWheelMid,document.getElementById("psv-text__content-id-bottom").innerHTML=(f=(l=this._config)==null?void 0:l.lang)==null?void 0:f.hintWheelBottom}}return{version:{version:"1.0.1"}.version,Photo:Uoe,plugins:{PlanPlugin:tf,CompassPlugin:n2,VirtualTourPlugin:Sh,TrackPlugin:s2,VehiclePlugin:KI,ViewModePlugin:Nv},adapter:{PhotoAdapter:Ere}}});
