<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lokalizi</title>

    <!-- Google Fonts (Lexend matches your game) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@300;500;700;900&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="./assets/homepage/index.css">
    <link rel="icon" href="./assets/icon.png">
</head>

<body>

    <div id="scene-container"></div>

    <h1>
    </h1>

    <div id="btnGroup">
        <button id="playBtn" onclick="GoSingleplayer(1)">Singleplayer Moving</button>
        <button id="playBtn" onclick="GoSingleplayer(0)">Singleplayer No Moving</button>
    </div>


    <div id="topbar">
        <div id="logo">
            <img src="./assets/icon_big.png">
        </div>
        <div style="cursor: pointer; margin-left: 50px; font-size: x-large;" onclick="SwitchChangelog(true)">Changelog
        </div>
    </div>


    <footer id="img-credit">
        Background by <a
            href="https://unsplash.com/@nasa?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText">NASA</a>
        on <a
            href="https://unsplash.com/photos/aerial-photo-of-coastline-6-jTZysYY_U?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText">Unsplash</a>

    </footer>

    <div id="changelog">
        <div id="background">
            <div style="display: flex;justify-content: space-between;">
                <h1>Changelog</h1>
                <button id="closeBtn" onclick="SwitchChangelog(false)">X</button>
            </div>
            <div id="content">
                <h2>v0.1</h2>
                <ul>
                    <li>Added Singleplayer</li>
                    <li>Integrated Mapillary, Mapy.cz, and OpenMap.vn</li>
                    <li>Finished Website Prototype Developing</li>
                </ul>
            </div>
        </div>
    </div>


    <script type="importmap">
			{
				"imports": {
					"three": "https://cdn.jsdelivr.net/npm/three@0.182.0/build/three.module.js",
					"three/addons/": "https://cdn.jsdelivr.net/npm/three@0.182.0/examples/jsm/"
				}
			}
	</script>

    <script>
        function GoSingleplayer(moving) {
            window.location = `./game.html?moving=${moving}`
        }

        function SwitchChangelog(active) {
            document.getElementById("changelog").style.display = active ? "block" : "none"
        }
    </script>

    <script type="module">
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';
        import { GLTFLoader } from 'three/addons/loaders/GLTFLoader.js';
        import { DRACOLoader } from 'three/addons/loaders/DRACOLoader.js';
        import * as THREE from 'three';
        // ─── Scene Setup ────────────────────────────────────────
        const scene = new THREE.Scene();

        const camera = new THREE.PerspectiveCamera(50, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.set(1.5, 0.7, 2);

        const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(window.devicePixelRatio);
        document.getElementById('scene-container').appendChild(renderer.domElement);

        // ─── Low-Poly Earth ─────────────────────────────────────
        const loader = new GLTFLoader();
        const dracoLoader = new DRACOLoader();
        dracoLoader.setDecoderPath('https://cdn.jsdelivr.net/npm/three/examples/jsm/libs/draco/');
        loader.setDRACOLoader(dracoLoader);
        const gltf = await loader.loadAsync('assets/homepage/earth.glb');
        const earth = gltf.scene;
        scene.add(earth);


        // ─── Simple low-poly clouds layer ───────────────────────
        const cloudsGeo = new THREE.IcosahedronGeometry(1.05, 2);
        const cloudsMat = new THREE.MeshPhongMaterial({
            color: 0xffffff,
            transparent: true,
            opacity: 0.18,
            flatShading: true
        });
        const clouds = new THREE.Mesh(cloudsGeo, cloudsMat);
        scene.add(clouds);

        // ─── Lights ─────────────────────────────────────────────
        scene.add(new THREE.AmbientLight(0xffffff, 0.7));

        const sun = new THREE.DirectionalLight(0xfff8e8, 1.4);
        sun.position.set(4, 5, 3);
        scene.add(sun);

        // ─── Floating Pin ───────────────────────────────────────
        const pinGLTF = await loader.loadAsync('assets/homepage/pin.glb');
        const pin = pinGLTF.scene;

        pin.position.set(.7, .9, .5);
        pin.scale.set(.05, .05, .05)
        pin.rotation.set(Math.PI / 18, 0, -Math.PI / 6)
        scene.add(pin);

        // ─── Animation Loop ─────────────────────────────────────
        function animate() {
            requestAnimationFrame(animate);

            earth.rotation.y += 0.0012;
            clouds.rotation.y += 0.00145;

            // gentle float
            pin.position.x = .7 + Math.sin(Date.now() * 0.0009) * 0.02;
            pin.position.y = .9 + Math.sin(Date.now() * 0.0009) * 0.02;

            renderer.render(scene, camera);
        }
        animate();

        camera.position.set(0.000763359 * window.innerWidth + 0.4, .7, 2)

        // ─── Resize ─────────────────────────────────────────────
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
            //0.000763359x+0.236641
            camera.position.set(0.000763359 * window.innerWidth + 0.4, .7, 2)
        });

    </script>
</body>

</html>